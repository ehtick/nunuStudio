!function(n,o){"object"==typeof exports&&"object"==typeof module?module.exports=o():"function"==typeof define&&define.amd?define([],o):"object"==typeof exports?exports.Nunu=o():n.Nunu=o()}(self,()=>(()=>{var __webpack_modules__={872:(n,o,l)=>{"use strict";l(590),l(435),l(806);var x=l(808);o.fG=x.StaticPair},590:(n,o,l)=>{"use strict";Object.defineProperty(o,"__esModule",{value:!0});const x=l(546),N=l(285);o.Decoder=class{constructor(U=[],G,A={}){this.dict=U,this.progressive=G,this.options=A}decode(U){U instanceof x||(U=x.wrap(U));const G=U.littleEndian;try{const A=this.decodeValue(U.LE());return U.littleEndian=G,A}catch(A){throw U.littleEndian=G,A}}decodeValue(U){let G=U.readUint8();if(G<=N.MAX)return x.zigZagDecode32(G);switch(G){case N.NULL:return null;case N.TRUE:return!0;case N.FALSE:return!1;case N.EOBJECT:return{};case N.EARRAY:return[];case N.ESTRING:return"";case N.OBJECT:G=U.readVarint32();const A={};for(;--G>=0;)A[this.decodeValue(U)]=this.decodeValue(U);return A;case N.ARRAY:G=U.readVarint32();const P=[];for(;--G>=0;)P.push(this.decodeValue(U));return P;case N.INTEGER:return U.readVarint32ZigZag();case N.LONG:const de=U.readVarint64ZigZag();return de.lessThanOrEqual(Number.MAX_SAFE_INTEGER)&&de.greaterThanOrEqual(Number.MIN_SAFE_INTEGER)?de.toNumber():de;case N.FLOAT:return U.readFloat32();case N.DOUBLE:return U.readFloat64();case N.STRING:return U.readVString();case N.STRING_ADD:const be=U.readVString();return this.dict.push(be),be;case N.STRING_GET:return this.dict[U.readVarint32()];case N.BINARY:G=U.readVarint32();const te=U.slice(U.offset,U.offset+G);return U.offset+=G,te;default:throw new Error(`Illegal type at ${U.offset}: ${G}`)}}}},435:(n,o,l)=>{"use strict";Object.defineProperty(o,"__esModule",{value:!0});const x=l(546),N=l(285),U=l(734),G=new x(4);G.compact(0,4),o.Encoder=class{constructor(A=[],P,de){if(this.progressive=P,this.dict=new Map,this.next=0,A)for(;this.next<A.length;)this.dict.set(A[this.next],this.next++)}encode(A,P){let de=!1;P||(P=new x,de=!0);const be=P.littleEndian;try{return this.encodeValue(A,P.LE()),P.littleEndian=be,de?P.flip():P}catch(te){throw P.littleEndian=be,te}}encodeValue(A,P){if(null!==A)switch(typeof A){case"function":A=A.toString();case"string":0===A.length?P.writeUint8(N.ESTRING):this.dict.has(A)?(P.writeUint8(N.STRING_GET),P.writeVarint32(this.dict.get(A))):(P.writeUint8(N.STRING),P.writeVString(A));break;case"number":if(A%1==0)if(A<=2147483647&&A>=-2147483648){const be=x.zigZagEncode32(A);be<=N.MAX?P.writeUint8(be):(P.writeUint8(N.INTEGER),P.writeVarint32ZigZag(A))}else P.writeUint8(N.LONG),P.writeVarint64ZigZag(A);else G.writeFloat32(A,0),A===G.readFloat32(0)?(P.writeUint8(N.FLOAT),P.writeFloat32(A)):(P.writeUint8(N.DOUBLE),P.writeFloat64(A));break;case"boolean":P.writeUint8(A?N.TRUE:N.FALSE);break;case"object":let de;if(Array.isArray(A))if(0===A.length)P.writeUint8(N.EARRAY);else for(P.writeUint8(N.ARRAY),P.writeVarint32(A.length),de=0;de<A.length;de++)this.encodeValue(A[de],P);else if(A instanceof U)P.writeUint8(N.LONG),P.writeVarint64ZigZag(A);else if(A instanceof Buffer||A instanceof ArrayBuffer||A instanceof Uint8Array||A instanceof x)A=x.wrap(A),P.writeUint8(N.BINARY),P.writeVarint32(A.remaining()),P.append(A);else{const be=Object.keys(A);let te=0;for(de=0;de<be.length;de++)void 0!==A[be[de]]&&te++;if(0===te)P.writeUint8(N.EOBJECT);else for(P.writeUint8(N.OBJECT),P.writeVarint32(te),de=0;de<be.length;de++){const ce=be[de];void 0!==A[ce]&&(this.dict.has(ce)?(P.writeUint8(N.STRING_GET),P.writeVarint32(this.dict.get(ce))):(this.progressive?(this.dict.set(ce,this.next++),P.writeUint8(N.STRING_ADD)):P.writeUint8(N.STRING),P.writeVString(ce)),this.encodeValue(A[ce],P))}}break;case"undefined":P.writeUint8(N.NULL)}else P.writeUint8(N.NULL)}}},606:(n,o)=>{"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.Pair=class{encode(l){return this.encoder.encode(l)}toArrayBuffer(l){return this.encoder.encode(l).toArrayBuffer()}toBuffer(l){return this.encoder.encode(l).toBuffer()}decode(l){return this.decoder.decode(l)}}},806:(n,o,l)=>{"use strict";Object.defineProperty(o,"__esModule",{value:!0});const x=l(606),N=l(435),U=l(590);o.ProgressivePair=class G extends x.Pair{constructor(P,de){super(),this.encoder=new N.Encoder(P,!0,de),this.decoder=new U.Decoder(P,!0,de)}}},808:(n,o,l)=>{"use strict";Object.defineProperty(o,"__esModule",{value:!0});const x=l(606),N=l(435),U=l(590);o.StaticPair=class G extends x.Pair{constructor(P,de){super(),this.encoder=new N.Encoder(P,!1,de),this.decoder=new U.Decoder(P,!1,de)}}},285:(n,o)=>{"use strict";Object.defineProperty(o,"__esModule",{value:!0}),o.ZERO=0,o.MAX=239,o.NULL=240,o.TRUE=241,o.FALSE=242,o.EOBJECT=243,o.EARRAY=244,o.ESTRING=245,o.OBJECT=246,o.ARRAY=247,o.INTEGER=248,o.LONG=249,o.FLOAT=250,o.DOUBLE=251,o.STRING=252,o.STRING_ADD=253,o.STRING_GET=254,o.BINARY=255},175:(n,o,l)=>{"use strict";l.r(o),l.d(o,{ACESFilmicToneMapping:()=>Zr,AddEquation:()=>Ae,AddOperation:()=>ir,AdditiveAnimationBlendMode:()=>Yu,AdditiveBlending:()=>F,AlphaFormat:()=>dp,AlwaysDepth:()=>$n,AlwaysStencilFunc:()=>na,AmbientLight:()=>Rd,AmbientLightProbe:()=>Gm,AnimationClip:()=>Tt,AnimationLoader:()=>dr,AnimationMixer:()=>of,AnimationObjectGroup:()=>jf,AnimationUtils:()=>Oe,ArcCurve:()=>Lu,ArrayCamera:()=>Kd,ArrowHelper:()=>A_,Audio:()=>ym,AudioAnalyser:()=>fd,AudioContext:()=>_m,AudioListener:()=>Wm,AudioLoader:()=>rc,AxesHelper:()=>m_,AxisHelper:()=>t,BackSide:()=>le,BasicDepthPacking:()=>W,BasicShadowMap:()=>be,BinaryTextureLoader:()=>I,Bone:()=>ks,BooleanKeyframeTrack:()=>vt,BoundingBoxHelper:()=>u,Box2:()=>_d,Box3:()=>Vi,Box3Helper:()=>T_,BoxBufferGeometry:()=>Wl,BoxGeometry:()=>Wl,BoxHelper:()=>d_,BufferAttribute:()=>zi,BufferGeometry:()=>br,BufferGeometryLoader:()=>dm,ByteType:()=>kl,Cache:()=>un,Camera:()=>Al,CameraHelper:()=>E_,CanvasRenderer:()=>J,CanvasTexture:()=>_f,CatmullRomCurve3:()=>hh,CineonToneMapping:()=>Nr,CircleBufferGeometry:()=>Wp,CircleGeometry:()=>Wp,ClampToEdgeWrapping:()=>Xr,Clock:()=>vm,Color:()=>tr,ColorKeyframeTrack:()=>Lt,CompressedTexture:()=>Ds,CompressedTextureLoader:()=>Mr,ConeBufferGeometry:()=>Cc,ConeGeometry:()=>Cc,CubeCamera:()=>ol,CubeReflectionMapping:()=>bi,CubeRefractionMapping:()=>So,CubeTexture:()=>ql,CubeTextureLoader:()=>so,CubeUVReflectionMapping:()=>Di,CubeUVRefractionMapping:()=>Eo,CubicBezierCurve:()=>ap,CubicBezierCurve3:()=>lp,CubicInterpolant:()=>ke,CullFaceBack:()=>A,CullFaceFront:()=>P,CullFaceFrontBack:()=>de,CullFaceNone:()=>G,Curve:()=>pa,CurvePath:()=>Uo,CustomBlending:()=>ve,CustomToneMapping:()=>Vr,CylinderBufferGeometry:()=>Ih,CylinderGeometry:()=>Ih,Cylindrical:()=>Vf,DataTexture:()=>Fs,DataTexture2DArray:()=>Nl,DataTexture3D:()=>ns,DataTextureLoader:()=>ao,DataUtils:()=>C_,DecrementStencilOp:()=>At,DecrementWrapStencilOp:()=>fn,DefaultLoadingManager:()=>wr,DepthFormat:()=>To,DepthStencilFormat:()=>Ws,DepthTexture:()=>$c,DirectionalLight:()=>Pf,DirectionalLightHelper:()=>p_,DiscreteInterpolant:()=>rt,DodecahedronBufferGeometry:()=>ad,DodecahedronGeometry:()=>ad,DoubleSide:()=>pe,DstAlphaFactor:()=>rn,DstColorFactor:()=>Tn,DynamicBufferAttribute:()=>z_,DynamicCopyUsage:()=>ra,DynamicDrawUsage:()=>Lr,DynamicReadUsage:()=>Yi,EdgesGeometry:()=>Hr,EdgesHelper:()=>m,EllipseCurve:()=>Lc,EqualDepth:()=>or,EqualStencilFunc:()=>Er,EquirectangularReflectionMapping:()=>Gs,EquirectangularRefractionMapping:()=>Ks,Euler:()=>co,EventDispatcher:()=>Ps,ExtrudeBufferGeometry:()=>Il,ExtrudeGeometry:()=>Il,FaceColors:()=>R_,FileLoader:()=>Kn,FlatShading:()=>T,Float16BufferAttribute:()=>Yr,Float32Attribute:()=>Y_,Float32BufferAttribute:()=>dn,Float64Attribute:()=>J_,Float64BufferAttribute:()=>Gc,FloatType:()=>Vo,Fog:()=>Xo,FogExp2:()=>Gp,Font:()=>zm,FontLoader:()=>x_,FrontSide:()=>_e,Frustum:()=>Dr,GLBufferAttribute:()=>xf,GLSL1:()=>ia,GLSL3:()=>Ui,GammaEncoding:()=>Gl,GreaterDepth:()=>sr,GreaterEqualDepth:()=>hr,GreaterEqualStencilFunc:()=>Ko,GreaterStencilFunc:()=>Ar,GridHelper:()=>Em,Group:()=>jp,HalfFloatType:()=>ds,HemisphereLight:()=>qa,HemisphereLightHelper:()=>h_,HemisphereLightProbe:()=>jm,IcosahedronBufferGeometry:()=>Iu,IcosahedronGeometry:()=>Iu,ImageBitmapLoader:()=>n_,ImageLoader:()=>di,ImageUtils:()=>Ts,ImmediateRenderObject:()=>hp,IncrementStencilOp:()=>Et,IncrementWrapStencilOp:()=>Xt,InstancedBufferAttribute:()=>Pl,InstancedBufferGeometry:()=>Of,InstancedInterleavedBuffer:()=>Zs,InstancedMesh:()=>Ph,Int16Attribute:()=>V_,Int16BufferAttribute:()=>Ku,Int32Attribute:()=>q_,Int32BufferAttribute:()=>wa,Int8Attribute:()=>j_,Int8BufferAttribute:()=>jd,IntType:()=>Zp,InterleavedBuffer:()=>Nh,InterleavedBufferAttribute:()=>Rl,Interpolant:()=>Ge,InterpolateDiscrete:()=>zl,InterpolateLinear:()=>jl,InterpolateSmooth:()=>qu,InvertStencilOp:()=>In,JSONLoader:()=>Y,KeepStencilOp:()=>Ve,KeyframeTrack:()=>ut,LOD:()=>Ma,LatheBufferGeometry:()=>Ol,LatheGeometry:()=>Ol,Layers:()=>qs,LensFlare:()=>me,LessDepth:()=>gn,LessEqualDepth:()=>ur,LessEqualStencilFunc:()=>Kr,LessStencilFunc:()=>xn,Light:()=>Bo,LightProbe:()=>If,Line:()=>Oo,Line3:()=>wf,LineBasicMaterial:()=>ji,LineCurve:()=>Js,LineCurve3:()=>ph,LineDashedMaterial:()=>Pe,LineLoop:()=>tf,LinePieces:()=>B_,LineSegments:()=>Fo,LineStrip:()=>L_,LinearEncoding:()=>Qi,LinearFilter:()=>ii,LinearInterpolant:()=>et,LinearMipMapLinearFilter:()=>Jp,LinearMipMapNearestFilter:()=>Uh,LinearMipmapLinearFilter:()=>Ya,LinearMipmapNearestFilter:()=>Pc,LinearToneMapping:()=>pi,Loader:()=>Yn,LoaderUtils:()=>gf,LoadingManager:()=>Mn,LogLuvEncoding:()=>Yh,LoopOnce:()=>_u,LoopPingPong:()=>lc,LoopRepeat:()=>Pa,LuminanceAlphaFormat:()=>Uu,LuminanceFormat:()=>Oc,MOUSE:()=>N,Material:()=>As,MaterialLoader:()=>Pd,Math:()=>vu,MathUtils:()=>vu,Matrix3:()=>ot,Matrix4:()=>Qt,MaxEquation:()=>Ke,Mesh:()=>Po,MeshBasicMaterial:()=>nl,MeshDepthMaterial:()=>Up,MeshDistanceMaterial:()=>rd,MeshFaceMaterial:()=>I_,MeshLambertMaterial:()=>Se,MeshMatcapMaterial:()=>Ce,MeshNormalMaterial:()=>we,MeshPhongMaterial:()=>ne,MeshPhysicalMaterial:()=>oe,MeshStandardMaterial:()=>X,MeshToonMaterial:()=>ge,MinEquation:()=>qe,MirroredRepeatWrapping:()=>ss,MixOperation:()=>ci,MultiMaterial:()=>O_,MultiplyBlending:()=>K,MultiplyOperation:()=>Jr,NearestFilter:()=>Or,NearestMipMapLinearFilter:()=>Hs,NearestMipMapNearestFilter:()=>Fu,NearestMipmapLinearFilter:()=>ps,NearestMipmapNearestFilter:()=>Na,NeverDepth:()=>Pn,NeverStencilFunc:()=>nn,NoBlending:()=>q,NoColors:()=>N_,NoToneMapping:()=>vr,NormalAnimationBlendMode:()=>Xu,NormalBlending:()=>ee,NotEqualDepth:()=>ei,NotEqualStencilFunc:()=>ms,NumberKeyframeTrack:()=>Kt,Object3D:()=>Ir,ObjectLoader:()=>Um,ObjectSpaceNormalMap:()=>Le,OctahedronBufferGeometry:()=>fl,OctahedronGeometry:()=>fl,OneFactor:()=>at,OneMinusDstAlphaFactor:()=>ft,OneMinusDstColorFactor:()=>Cn,OneMinusSrcAlphaFactor:()=>Ot,OneMinusSrcColorFactor:()=>wt,OrthographicCamera:()=>Xl,PCFShadowMap:()=>te,PCFSoftShadowMap:()=>ce,PMREMGenerator:()=>je,ParametricBufferGeometry:()=>ld,ParametricGeometry:()=>ld,Particle:()=>F_,ParticleBasicMaterial:()=>e_,ParticleSystem:()=>g_,ParticleSystemMaterial:()=>D_,Path:()=>hs,PerspectiveCamera:()=>Io,Plane:()=>Sa,PlaneBufferGeometry:()=>Su,PlaneGeometry:()=>Su,PlaneHelper:()=>M_,PointCloud:()=>k_,PointCloudMaterial:()=>v_,PointLight:()=>Bd,PointLightHelper:()=>Sm,Points:()=>Qr,PointsMaterial:()=>Co,PolarGridHelper:()=>S_,PolyhedronBufferGeometry:()=>ha,PolyhedronGeometry:()=>ha,PositionalAudio:()=>vf,PropertyBinding:()=>mo,PropertyMixer:()=>Df,QuadraticBezierCurve:()=>qi,QuadraticBezierCurve3:()=>da,Quaternion:()=>Li,QuaternionKeyframeTrack:()=>Bt,QuaternionLinearInterpolant:()=>zt,REVISION:()=>x,RGBADepthPacking:()=>ue,RGBAFormat:()=>lo,RGBAIntegerFormat:()=>vh,RGBA_ASTC_10x10_Format:()=>Qa,RGBA_ASTC_10x5_Format:()=>Hu,RGBA_ASTC_10x6_Format:()=>Za,RGBA_ASTC_10x8_Format:()=>Hh,RGBA_ASTC_12x10_Format:()=>Vh,RGBA_ASTC_12x12_Format:()=>Vu,RGBA_ASTC_4x4_Format:()=>ju,RGBA_ASTC_5x4_Format:()=>_p,RGBA_ASTC_5x5_Format:()=>gp,RGBA_ASTC_6x5_Format:()=>kc,RGBA_ASTC_6x6_Format:()=>oc,RGBA_ASTC_8x5_Format:()=>bh,RGBA_ASTC_8x6_Format:()=>vp,RGBA_ASTC_8x8_Format:()=>Gu,RGBA_BPTC_Format:()=>sc,RGBA_ETC2_EAC_Format:()=>Dl,RGBA_PVRTC_2BPPV1_Format:()=>Fl,RGBA_PVRTC_4BPPV1_Format:()=>yl,RGBA_S3TC_DXT1_Format:()=>ic,RGBA_S3TC_DXT3_Format:()=>jh,RGBA_S3TC_DXT5_Format:()=>yh,RGBDEncoding:()=>gu,RGBEEncoding:()=>Uc,RGBEFormat:()=>gh,RGBFormat:()=>Rs,RGBIntegerFormat:()=>mp,RGBM16Encoding:()=>Ju,RGBM7Encoding:()=>cc,RGB_ETC1_Format:()=>zu,RGB_ETC2_Format:()=>fs,RGB_PVRTC_2BPPV1_Format:()=>vl,RGB_PVRTC_4BPPV1_Format:()=>Gh,RGB_S3TC_DXT1_Format:()=>zh,RGFormat:()=>fu,RGIntegerFormat:()=>fp,RawShaderMaterial:()=>Tu,Ray:()=>_n,Raycaster:()=>Ca,RectAreaLight:()=>pd,RedFormat:()=>Qp,RedIntegerFormat:()=>Ja,ReinhardToneMapping:()=>go,RepeatWrapping:()=>vo,ReplaceStencilOp:()=>Qe,ReverseSubtractEquation:()=>Ee,RingBufferGeometry:()=>Hn,RingGeometry:()=>Hn,SRGB8_ALPHA8_ASTC_10x10_Format:()=>wp,SRGB8_ALPHA8_ASTC_10x5_Format:()=>bp,SRGB8_ALPHA8_ASTC_10x6_Format:()=>Wh,SRGB8_ALPHA8_ASTC_10x8_Format:()=>xp,SRGB8_ALPHA8_ASTC_12x10_Format:()=>qh,SRGB8_ALPHA8_ASTC_12x12_Format:()=>Kp,SRGB8_ALPHA8_ASTC_4x4_Format:()=>ac,SRGB8_ALPHA8_ASTC_5x4_Format:()=>xh,SRGB8_ALPHA8_ASTC_5x5_Format:()=>mu,SRGB8_ALPHA8_ASTC_6x5_Format:()=>Fc,SRGB8_ALPHA8_ASTC_6x6_Format:()=>yp,SRGB8_ALPHA8_ASTC_8x5_Format:()=>Dc,SRGB8_ALPHA8_ASTC_8x6_Format:()=>Wu,SRGB8_ALPHA8_ASTC_8x8_Format:()=>Ul,Scene:()=>Qc,SceneUtils:()=>Z,ShaderChunk:()=>li,ShaderLib:()=>Ll,ShaderMaterial:()=>Ns,ShadowMaterial:()=>H,Shape:()=>is,ShapeBufferGeometry:()=>rs,ShapeGeometry:()=>rs,ShapePath:()=>r_,ShapeUtils:()=>Ci,ShortType:()=>Ra,Skeleton:()=>Va,SkeletonHelper:()=>Sf,SkinnedMesh:()=>Aa,SmoothShading:()=>B,Sphere:()=>xo,SphereBufferGeometry:()=>a,SphereGeometry:()=>a,Spherical:()=>Hf,SphericalHarmonics3:()=>pm,SplineCurve:()=>pl,SpotLight:()=>hd,SpotLightHelper:()=>u_,Sprite:()=>Ql,SpriteMaterial:()=>ah,SrcAlphaFactor:()=>Ft,SrcAlphaSaturateFactor:()=>mn,SrcColorFactor:()=>Ct,StaticCopyUsage:()=>uc,StaticDrawUsage:()=>_i,StaticReadUsage:()=>Xi,StereoCamera:()=>Hm,StreamCopyUsage:()=>el,StreamDrawUsage:()=>Ia,StreamReadUsage:()=>Jh,StringKeyframeTrack:()=>$t,SubtractEquation:()=>Fe,SubtractiveBlending:()=>Be,TOUCH:()=>U,TangentSpaceNormalMap:()=>Te,TetrahedronBufferGeometry:()=>r,TetrahedronGeometry:()=>r,TextBufferGeometry:()=>h,TextGeometry:()=>h,Texture:()=>Ms,TextureLoader:()=>Do,TorusBufferGeometry:()=>d,TorusGeometry:()=>d,TorusKnotBufferGeometry:()=>y,TorusKnotGeometry:()=>y,Triangle:()=>eo,TriangleFanDrawMode:()=>Ep,TriangleStripDrawMode:()=>Sp,TrianglesDrawMode:()=>Xh,TubeBufferGeometry:()=>b,TubeGeometry:()=>b,UVMapping:()=>fi,Uint16Attribute:()=>W_,Uint16BufferAttribute:()=>eh,Uint32Attribute:()=>X_,Uint32BufferAttribute:()=>oi,Uint8Attribute:()=>G_,Uint8BufferAttribute:()=>Cp,Uint8ClampedAttribute:()=>H_,Uint8ClampedBufferAttribute:()=>xa,Uniform:()=>sf,UniformsLib:()=>ar,UniformsUtils:()=>Bs,UnsignedByteType:()=>ea,UnsignedInt248Type:()=>Es,UnsignedIntType:()=>Vs,UnsignedShort4444Type:()=>Du,UnsignedShort5551Type:()=>pu,UnsignedShort565Type:()=>du,UnsignedShortType:()=>Ic,VSMShadowMap:()=>fe,Vector2:()=>Un,Vector3:()=>lt,Vector4:()=>Hi,VectorKeyframeTrack:()=>ht,Vertex:()=>U_,VertexColors:()=>P_,VideoTexture:()=>iu,WebGL1Renderer:()=>cn,WebGLCubeRenderTarget:()=>xc,WebGLMultipleRenderTargets:()=>ti,WebGLMultisampleRenderTarget:()=>zc,WebGLRenderTarget:()=>io,WebGLRenderTargetCube:()=>V,WebGLRenderer:()=>Qn,WebGLUtils:()=>Qd,WireframeGeometry:()=>R,WireframeHelper:()=>g,WrapAroundEnding:()=>xl,XHRLoader:()=>E,ZeroCurvatureEnding:()=>va,ZeroFactor:()=>gt,ZeroSlopeEnding:()=>ta,ZeroStencilOp:()=>He,sRGBEncoding:()=>Ka});const x="132",N={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},U={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},G=0,A=1,P=2,de=3,be=0,te=1,ce=2,fe=3,_e=0,le=1,pe=2,T=1,B=2,q=0,ee=1,F=2,Be=3,K=4,ve=5,Ae=100,Fe=101,Ee=102,qe=103,Ke=104,gt=200,at=201,Ct=202,wt=203,Ft=204,Ot=205,rn=206,ft=207,Tn=208,Cn=209,mn=210,Pn=0,$n=1,gn=2,ur=3,or=4,hr=5,sr=6,ei=7,Jr=0,ci=1,ir=2,vr=0,pi=1,go=2,Nr=3,Zr=4,Vr=5,fi=300,bi=301,So=302,Gs=303,Ks=304,Di=306,Eo=307,vo=1e3,Xr=1001,ss=1002,Or=1003,Na=1004,Fu=1004,ps=1005,Hs=1005,ii=1006,Pc=1007,Uh=1007,Ya=1008,Jp=1008,ea=1009,kl=1010,Ra=1011,Ic=1012,Zp=1013,Vs=1014,Vo=1015,ds=1016,Du=1017,pu=1018,du=1019,Es=1020,dp=1021,Rs=1022,lo=1023,Oc=1024,Uu=1025,gh=lo,To=1026,Ws=1027,Qp=1028,Ja=1029,fu=1030,fp=1031,mp=1032,vh=1033,zh=33776,ic=33777,jh=33778,yh=33779,Gh=35840,vl=35841,yl=35842,Fl=35843,zu=36196,fs=37492,Dl=37496,ju=37808,_p=37809,gp=37810,kc=37811,oc=37812,bh=37813,vp=37814,Gu=37815,Hu=37816,Za=37817,Hh=37818,Qa=37819,Vh=37820,Vu=37821,sc=36492,ac=37840,xh=37841,mu=37842,Fc=37843,yp=37844,Dc=37845,Wu=37846,Ul=37847,bp=37848,Wh=37849,xp=37850,wp=37851,qh=37852,Kp=37853,_u=2200,Pa=2201,lc=2202,zl=2300,jl=2301,qu=2302,va=2400,ta=2401,xl=2402,Xu=2500,Yu=2501,Xh=0,Sp=1,Ep=2,Qi=3e3,Ka=3001,Gl=3007,Uc=3002,Yh=3003,cc=3004,Ju=3005,gu=3006,W=3200,ue=3201,Te=0,Le=1,He=0,Ve=7680,Qe=7681,Et=7682,At=7683,Xt=34055,fn=34056,In=5386,nn=512,xn=513,Er=514,Kr=515,Ar=516,ms=517,Ko=518,na=519,_i=35044,Lr=35048,Ia=35040,Xi=35045,Yi=35049,Jh=35041,uc=35046,ra=35050,el=35042,ia="100",Ui="300 es";class Ps{addEventListener(e,c){void 0===this._listeners&&(this._listeners={});const p=this._listeners;void 0===p[e]&&(p[e]=[]),-1===p[e].indexOf(c)&&p[e].push(c)}hasEventListener(e,c){if(void 0===this._listeners)return!1;const p=this._listeners;return void 0!==p[e]&&-1!==p[e].indexOf(c)}removeEventListener(e,c){if(void 0===this._listeners)return;const p=this._listeners[e];if(void 0!==p){const _=p.indexOf(c);-1!==_&&p.splice(_,1)}}dispatchEvent(e){if(void 0===this._listeners)return;const c=this._listeners[e.type];if(void 0!==c){e.target=this;const p=c.slice(0);for(let _=0,w=p.length;_<w;_++)p[_].call(this,e);e.target=null}}}const rr=[];for(let S=0;S<256;S++)rr[S]=(S<16?"0":"")+S.toString(16);let wn=1234567;const jo=Math.PI/180,as=180/Math.PI;function Ki(){const S=4294967295*Math.random()|0,e=4294967295*Math.random()|0,c=4294967295*Math.random()|0,p=4294967295*Math.random()|0;return(rr[255&S]+rr[S>>8&255]+rr[S>>16&255]+rr[S>>24&255]+"-"+rr[255&e]+rr[e>>8&255]+"-"+rr[e>>16&15|64]+rr[e>>24&255]+"-"+rr[63&c|128]+rr[c>>8&255]+"-"+rr[c>>16&255]+rr[c>>24&255]+rr[255&p]+rr[p>>8&255]+rr[p>>16&255]+rr[p>>24&255]).toUpperCase()}function jr(S,e,c){return Math.max(e,Math.min(c,S))}function ui(S,e){return(S%e+e)%e}function gi(S,e,c){return(1-c)*S+c*e}function Is(S){return!(S&S-1)&&0!==S}function Zh(S){return Math.pow(2,Math.ceil(Math.log(S)/Math.LN2))}function yo(S){return Math.pow(2,Math.floor(Math.log(S)/Math.LN2))}var vu=Object.freeze({__proto__:null,DEG2RAD:jo,RAD2DEG:as,generateUUID:Ki,clamp:jr,euclideanModulo:ui,mapLinear:function(S,e,c,p,_){return p+(S-e)*(_-p)/(c-e)},inverseLerp:function(S,e,c){return S!==e?(c-S)/(e-S):0},lerp:gi,damp:function(S,e,c,p){return gi(S,e,1-Math.exp(-c*p))},pingpong:function(S,e=1){return e-Math.abs(ui(S,2*e)-e)},smoothstep:function(S,e,c){return S<=e?0:S>=c?1:(S=(S-e)/(c-e))*S*(3-2*S)},smootherstep:function(S,e,c){return S<=e?0:S>=c?1:(S=(S-e)/(c-e))*S*S*(S*(6*S-15)+10)},randInt:function(S,e){return S+Math.floor(Math.random()*(e-S+1))},randFloat:function(S,e){return S+Math.random()*(e-S)},randFloatSpread:function(S){return S*(.5-Math.random())},seededRandom:function(S){return void 0!==S&&(wn=S%2147483647),wn=16807*wn%2147483647,(wn-1)/2147483646},degToRad:function(S){return S*jo},radToDeg:function(S){return S*as},isPowerOfTwo:Is,ceilPowerOfTwo:Zh,floorPowerOfTwo:yo,setQuaternionFromProperEuler:function(S,e,c,p,_){const w=Math.cos,L=Math.sin,O=w(c/2),D=L(c/2),z=w((e+p)/2),Q=L((e+p)/2),ae=w((e-p)/2),ie=L((e-p)/2),he=w((p-e)/2),ye=L((p-e)/2);switch(_){case"XYX":S.set(O*Q,D*ae,D*ie,O*z);break;case"YZY":S.set(D*ie,O*Q,D*ae,O*z);break;case"ZXZ":S.set(D*ae,D*ie,O*Q,O*z);break;case"XZX":S.set(O*Q,D*ye,D*he,O*z);break;case"YXY":S.set(D*he,O*Q,D*ye,O*z);break;case"ZYZ":S.set(D*ye,D*he,O*Q,O*z);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+_)}}});class Un{constructor(e=0,c=0){this.x=e,this.y=c}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,c){return this.x=e,this.y=c,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,c){switch(e){case 0:this.x=c;break;case 1:this.y=c;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e,c){return void 0!==c?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,c)):(this.x+=e.x,this.y+=e.y,this)}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,c){return this.x=e.x+c.x,this.y=e.y+c.y,this}addScaledVector(e,c){return this.x+=e.x*c,this.y+=e.y*c,this}sub(e,c){return void 0!==c?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,c)):(this.x-=e.x,this.y-=e.y,this)}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,c){return this.x=e.x-c.x,this.y=e.y-c.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const c=this.x,p=this.y,_=e.elements;return this.x=_[0]*c+_[3]*p+_[6],this.y=_[1]*c+_[4]*p+_[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,c){return this.x=Math.max(e.x,Math.min(c.x,this.x)),this.y=Math.max(e.y,Math.min(c.y,this.y)),this}clampScalar(e,c){return this.x=Math.max(e,Math.min(c,this.x)),this.y=Math.max(e,Math.min(c,this.y)),this}clampLength(e,c){const p=this.length();return this.divideScalar(p||1).multiplyScalar(Math.max(e,Math.min(c,p)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const c=this.x-e.x,p=this.y-e.y;return c*c+p*p}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,c){return this.x+=(e.x-this.x)*c,this.y+=(e.y-this.y)*c,this}lerpVectors(e,c,p){return this.x=e.x+(c.x-e.x)*p,this.y=e.y+(c.y-e.y)*p,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,c=0){return this.x=e[c],this.y=e[c+1],this}toArray(e=[],c=0){return e[c]=this.x,e[c+1]=this.y,e}fromBufferAttribute(e,c,p){return void 0!==p&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(c),this.y=e.getY(c),this}rotateAround(e,c){const p=Math.cos(c),_=Math.sin(c),w=this.x-e.x,L=this.y-e.y;return this.x=w*p-L*_+e.x,this.y=w*_+L*p+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}}Un.prototype.isVector2=!0;class ot{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(e,c,p,_,w,L,O,D,z){const Q=this.elements;return Q[0]=e,Q[1]=_,Q[2]=O,Q[3]=c,Q[4]=w,Q[5]=D,Q[6]=p,Q[7]=L,Q[8]=z,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const c=this.elements,p=e.elements;return c[0]=p[0],c[1]=p[1],c[2]=p[2],c[3]=p[3],c[4]=p[4],c[5]=p[5],c[6]=p[6],c[7]=p[7],c[8]=p[8],this}extractBasis(e,c,p){return e.setFromMatrix3Column(this,0),c.setFromMatrix3Column(this,1),p.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const c=e.elements;return this.set(c[0],c[4],c[8],c[1],c[5],c[9],c[2],c[6],c[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,c){const p=e.elements,_=c.elements,w=this.elements,L=p[0],O=p[3],D=p[6],z=p[1],Q=p[4],ae=p[7],ie=p[2],he=p[5],ye=p[8],Me=_[0],Ne=_[3],$e=_[6],ze=_[1],Ye=_[4],We=_[7],nt=_[2],it=_[5],mt=_[8];return w[0]=L*Me+O*ze+D*nt,w[3]=L*Ne+O*Ye+D*it,w[6]=L*$e+O*We+D*mt,w[1]=z*Me+Q*ze+ae*nt,w[4]=z*Ne+Q*Ye+ae*it,w[7]=z*$e+Q*We+ae*mt,w[2]=ie*Me+he*ze+ye*nt,w[5]=ie*Ne+he*Ye+ye*it,w[8]=ie*$e+he*We+ye*mt,this}multiplyScalar(e){const c=this.elements;return c[0]*=e,c[3]*=e,c[6]*=e,c[1]*=e,c[4]*=e,c[7]*=e,c[2]*=e,c[5]*=e,c[8]*=e,this}determinant(){const e=this.elements,c=e[0],p=e[1],_=e[2],w=e[3],L=e[4],O=e[5],D=e[6],z=e[7],Q=e[8];return c*L*Q-c*O*z-p*w*Q+p*O*D+_*w*z-_*L*D}invert(){const e=this.elements,c=e[0],p=e[1],_=e[2],w=e[3],L=e[4],O=e[5],D=e[6],z=e[7],Q=e[8],ae=Q*L-O*z,ie=O*D-Q*w,he=z*w-L*D,ye=c*ae+p*ie+_*he;if(0===ye)return this.set(0,0,0,0,0,0,0,0,0);const Me=1/ye;return e[0]=ae*Me,e[1]=(_*z-Q*p)*Me,e[2]=(O*p-_*L)*Me,e[3]=ie*Me,e[4]=(Q*c-_*D)*Me,e[5]=(_*w-O*c)*Me,e[6]=he*Me,e[7]=(p*D-z*c)*Me,e[8]=(L*c-p*w)*Me,this}transpose(){let e;const c=this.elements;return e=c[1],c[1]=c[3],c[3]=e,e=c[2],c[2]=c[6],c[6]=e,e=c[5],c[5]=c[7],c[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const c=this.elements;return e[0]=c[0],e[1]=c[3],e[2]=c[6],e[3]=c[1],e[4]=c[4],e[5]=c[7],e[6]=c[2],e[7]=c[5],e[8]=c[8],this}setUvTransform(e,c,p,_,w,L,O){const D=Math.cos(w),z=Math.sin(w);return this.set(p*D,p*z,-p*(D*L+z*O)+L+e,-_*z,_*D,-_*(-z*L+D*O)+O+c,0,0,1),this}scale(e,c){const p=this.elements;return p[0]*=e,p[3]*=e,p[6]*=e,p[1]*=c,p[4]*=c,p[7]*=c,this}rotate(e){const c=Math.cos(e),p=Math.sin(e),_=this.elements,w=_[0],L=_[3],O=_[6],D=_[1],z=_[4],Q=_[7];return _[0]=c*w+p*D,_[3]=c*L+p*z,_[6]=c*O+p*Q,_[1]=-p*w+c*D,_[4]=-p*L+c*z,_[7]=-p*O+c*Q,this}translate(e,c){const p=this.elements;return p[0]+=e*p[2],p[3]+=e*p[5],p[6]+=e*p[8],p[1]+=c*p[2],p[4]+=c*p[5],p[7]+=c*p[8],this}equals(e){const c=this.elements,p=e.elements;for(let _=0;_<9;_++)if(c[_]!==p[_])return!1;return!0}fromArray(e,c=0){for(let p=0;p<9;p++)this.elements[p]=e[p+c];return this}toArray(e=[],c=0){const p=this.elements;return e[c]=p[0],e[c+1]=p[1],e[c+2]=p[2],e[c+3]=p[3],e[c+4]=p[4],e[c+5]=p[5],e[c+6]=p[6],e[c+7]=p[7],e[c+8]=p[8],e}clone(){return(new this.constructor).fromArray(this.elements)}}let wl;ot.prototype.isMatrix3=!0;class Ts{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let c;if(e instanceof HTMLCanvasElement)c=e;else{void 0===wl&&(wl=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),wl.width=e.width,wl.height=e.height;const p=wl.getContext("2d");e instanceof ImageData?p.putImageData(e,0,0):p.drawImage(e,0,0,e.width,e.height),c=wl}return c.width>2048||c.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),c.toDataURL("image/jpeg",.6)):c.toDataURL("image/png")}}let Tp=0;class Ms extends Ps{constructor(e=Ms.DEFAULT_IMAGE,c=Ms.DEFAULT_MAPPING,p=Xr,_=Xr,w=ii,L=Ya,O=lo,D=ea,z=1,Q=Qi){super(),Object.defineProperty(this,"id",{value:Tp++}),this.uuid=Ki(),this.name="",this.image=e,this.mipmaps=[],this.mapping=c,this.wrapS=p,this.wrapT=_,this.magFilter=w,this.minFilter=L,this.anisotropy=z,this.format=O,this.internalFormat=null,this.type=D,this.offset=new Un(0,0),this.repeat=new Un(1,1),this.center=new Un(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ot,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=Q,this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this}toJSON(e){const c=void 0===e||"string"==typeof e;if(!c&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];const p={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){const _=this.image;if(void 0===_.uuid&&(_.uuid=Ki()),!c&&void 0===e.images[_.uuid]){let w;if(Array.isArray(_)){w=[];for(let L=0,O=_.length;L<O;L++)w.push(hc(_[L].isDataTexture?_[L].image:_[L]))}else w=hc(_);e.images[_.uuid]={uuid:_.uuid,url:w}}p.image=_.uuid}return c||(e.textures[this.uuid]=p),p}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==fi)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case vo:e.x=e.x-Math.floor(e.x);break;case Xr:e.x=e.x<0?0:1;break;case ss:e.x=1===Math.abs(Math.floor(e.x)%2)?Math.ceil(e.x)-e.x:e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case vo:e.y=e.y-Math.floor(e.y);break;case Xr:e.y=e.y<0?0:1;break;case ss:e.y=1===Math.abs(Math.floor(e.y)%2)?Math.ceil(e.y)-e.y:e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&this.version++}}function hc(S){return typeof HTMLImageElement<"u"&&S instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&S instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&S instanceof ImageBitmap?Ts.getDataURL(S):S.data?{data:Array.prototype.slice.call(S.data),width:S.width,height:S.height,type:S.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}Ms.DEFAULT_IMAGE=void 0,Ms.DEFAULT_MAPPING=fi,Ms.prototype.isTexture=!0;class Hi{constructor(e=0,c=0,p=0,_=1){this.x=e,this.y=c,this.z=p,this.w=_}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,c,p,_){return this.x=e,this.y=c,this.z=p,this.w=_,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,c){switch(e){case 0:this.x=c;break;case 1:this.y=c;break;case 2:this.z=c;break;case 3:this.w=c;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e,c){return void 0!==c?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,c)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,c){return this.x=e.x+c.x,this.y=e.y+c.y,this.z=e.z+c.z,this.w=e.w+c.w,this}addScaledVector(e,c){return this.x+=e.x*c,this.y+=e.y*c,this.z+=e.z*c,this.w+=e.w*c,this}sub(e,c){return void 0!==c?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,c)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,c){return this.x=e.x-c.x,this.y=e.y-c.y,this.z=e.z-c.z,this.w=e.w-c.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const c=this.x,p=this.y,_=this.z,w=this.w,L=e.elements;return this.x=L[0]*c+L[4]*p+L[8]*_+L[12]*w,this.y=L[1]*c+L[5]*p+L[9]*_+L[13]*w,this.z=L[2]*c+L[6]*p+L[10]*_+L[14]*w,this.w=L[3]*c+L[7]*p+L[11]*_+L[15]*w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const c=Math.sqrt(1-e.w*e.w);return c<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/c,this.y=e.y/c,this.z=e.z/c),this}setAxisAngleFromRotationMatrix(e){let c,p,_,w;const D=e.elements,z=D[0],Q=D[4],ae=D[8],ie=D[1],he=D[5],ye=D[9],Me=D[2],Ne=D[6],$e=D[10];if(Math.abs(Q-ie)<.01&&Math.abs(ae-Me)<.01&&Math.abs(ye-Ne)<.01){if(Math.abs(Q+ie)<.1&&Math.abs(ae+Me)<.1&&Math.abs(ye+Ne)<.1&&Math.abs(z+he+$e-3)<.1)return this.set(1,0,0,0),this;c=Math.PI;const Ye=(z+1)/2,We=(he+1)/2,nt=($e+1)/2,it=(Q+ie)/4,mt=(ae+Me)/4,xt=(ye+Ne)/4;return Ye>We&&Ye>nt?Ye<.01?(p=0,_=.707106781,w=.707106781):(p=Math.sqrt(Ye),_=it/p,w=mt/p):We>nt?We<.01?(p=.707106781,_=0,w=.707106781):(_=Math.sqrt(We),p=it/_,w=xt/_):nt<.01?(p=.707106781,_=.707106781,w=0):(w=Math.sqrt(nt),p=mt/w,_=xt/w),this.set(p,_,w,c),this}let ze=Math.sqrt((Ne-ye)*(Ne-ye)+(ae-Me)*(ae-Me)+(ie-Q)*(ie-Q));return Math.abs(ze)<.001&&(ze=1),this.x=(Ne-ye)/ze,this.y=(ae-Me)/ze,this.z=(ie-Q)/ze,this.w=Math.acos((z+he+$e-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,c){return this.x=Math.max(e.x,Math.min(c.x,this.x)),this.y=Math.max(e.y,Math.min(c.y,this.y)),this.z=Math.max(e.z,Math.min(c.z,this.z)),this.w=Math.max(e.w,Math.min(c.w,this.w)),this}clampScalar(e,c){return this.x=Math.max(e,Math.min(c,this.x)),this.y=Math.max(e,Math.min(c,this.y)),this.z=Math.max(e,Math.min(c,this.z)),this.w=Math.max(e,Math.min(c,this.w)),this}clampLength(e,c){const p=this.length();return this.divideScalar(p||1).multiplyScalar(Math.max(e,Math.min(c,p)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,c){return this.x+=(e.x-this.x)*c,this.y+=(e.y-this.y)*c,this.z+=(e.z-this.z)*c,this.w+=(e.w-this.w)*c,this}lerpVectors(e,c,p){return this.x=e.x+(c.x-e.x)*p,this.y=e.y+(c.y-e.y)*p,this.z=e.z+(c.z-e.z)*p,this.w=e.w+(c.w-e.w)*p,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,c=0){return this.x=e[c],this.y=e[c+1],this.z=e[c+2],this.w=e[c+3],this}toArray(e=[],c=0){return e[c]=this.x,e[c+1]=this.y,e[c+2]=this.z,e[c+3]=this.w,e}fromBufferAttribute(e,c,p){return void 0!==p&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(c),this.y=e.getY(c),this.z=e.getZ(c),this.w=e.getW(c),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}Hi.prototype.isVector4=!0;class io extends Ps{constructor(e,c,p={}){super(),this.width=e,this.height=c,this.depth=1,this.scissor=new Hi(0,0,e,c),this.scissorTest=!1,this.viewport=new Hi(0,0,e,c),this.texture=new Ms(void 0,p.mapping,p.wrapS,p.wrapT,p.magFilter,p.minFilter,p.format,p.type,p.anisotropy,p.encoding),this.texture.isRenderTargetTexture=!0,this.texture.image={width:e,height:c,depth:1},this.texture.generateMipmaps=void 0!==p.generateMipmaps&&p.generateMipmaps,this.texture.internalFormat=void 0!==p.internalFormat?p.internalFormat:null,this.texture.minFilter=void 0!==p.minFilter?p.minFilter:ii,this.depthBuffer=void 0===p.depthBuffer||p.depthBuffer,this.stencilBuffer=void 0!==p.stencilBuffer&&p.stencilBuffer,this.depthTexture=void 0!==p.depthTexture?p.depthTexture:null}setTexture(e){e.image={width:this.width,height:this.height,depth:this.depth},this.texture=e}setSize(e,c,p=1){this.width===e&&this.height===c&&this.depth===p||(this.width=e,this.height=c,this.depth=p,this.texture.image.width=e,this.texture.image.height=c,this.texture.image.depth=p,this.dispose()),this.viewport.set(0,0,e,c),this.scissor.set(0,0,e,c)}clone(){return(new this.constructor).copy(this)}copy(e){return this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.image={...this.texture.image},this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}}io.prototype.isWebGLRenderTarget=!0;class ti extends io{constructor(e,c,p){super(e,c);const _=this.texture;this.texture=[];for(let w=0;w<p;w++)this.texture[w]=_.clone()}setSize(e,c,p=1){if(this.width!==e||this.height!==c||this.depth!==p){this.width=e,this.height=c,this.depth=p;for(let _=0,w=this.texture.length;_<w;_++)this.texture[_].image.width=e,this.texture[_].image.height=c,this.texture[_].image.depth=p;this.dispose()}return this.viewport.set(0,0,e,c),this.scissor.set(0,0,e,c),this}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this.texture.length=0;for(let c=0,p=e.texture.length;c<p;c++)this.texture[c]=e.texture[c].clone();return this}}ti.prototype.isWebGLMultipleRenderTargets=!0;class zc extends io{constructor(e,c,p){super(e,c,p),this.samples=4}copy(e){return super.copy.call(this,e),this.samples=e.samples,this}}zc.prototype.isWebGLMultisampleRenderTarget=!0;class Li{constructor(e=0,c=0,p=0,_=1){this._x=e,this._y=c,this._z=p,this._w=_}static slerp(e,c,p,_){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),p.slerpQuaternions(e,c,_)}static slerpFlat(e,c,p,_,w,L,O){let D=p[_+0],z=p[_+1],Q=p[_+2],ae=p[_+3];const ie=w[L+0],he=w[L+1],ye=w[L+2],Me=w[L+3];if(0===O)return e[c+0]=D,e[c+1]=z,e[c+2]=Q,void(e[c+3]=ae);if(1===O)return e[c+0]=ie,e[c+1]=he,e[c+2]=ye,void(e[c+3]=Me);if(ae!==Me||D!==ie||z!==he||Q!==ye){let Ne=1-O;const $e=D*ie+z*he+Q*ye+ae*Me,ze=$e>=0?1:-1,Ye=1-$e*$e;if(Ye>Number.EPSILON){const nt=Math.sqrt(Ye),it=Math.atan2(nt,$e*ze);Ne=Math.sin(Ne*it)/nt,O=Math.sin(O*it)/nt}const We=O*ze;if(D=D*Ne+ie*We,z=z*Ne+he*We,Q=Q*Ne+ye*We,ae=ae*Ne+Me*We,Ne===1-O){const nt=1/Math.sqrt(D*D+z*z+Q*Q+ae*ae);D*=nt,z*=nt,Q*=nt,ae*=nt}}e[c]=D,e[c+1]=z,e[c+2]=Q,e[c+3]=ae}static multiplyQuaternionsFlat(e,c,p,_,w,L){const O=p[_],D=p[_+1],z=p[_+2],Q=p[_+3],ae=w[L],ie=w[L+1],he=w[L+2],ye=w[L+3];return e[c]=O*ye+Q*ae+D*he-z*ie,e[c+1]=D*ye+Q*ie+z*ae-O*he,e[c+2]=z*ye+Q*he+O*ie-D*ae,e[c+3]=Q*ye-O*ae-D*ie-z*he,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,c,p,_){return this._x=e,this._y=c,this._z=p,this._w=_,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,c){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const p=e._x,_=e._y,w=e._z,L=e._order,O=Math.cos,D=Math.sin,z=O(p/2),Q=O(_/2),ae=O(w/2),ie=D(p/2),he=D(_/2),ye=D(w/2);switch(L){case"XYZ":this._x=ie*Q*ae+z*he*ye,this._y=z*he*ae-ie*Q*ye,this._z=z*Q*ye+ie*he*ae,this._w=z*Q*ae-ie*he*ye;break;case"YXZ":this._x=ie*Q*ae+z*he*ye,this._y=z*he*ae-ie*Q*ye,this._z=z*Q*ye-ie*he*ae,this._w=z*Q*ae+ie*he*ye;break;case"ZXY":this._x=ie*Q*ae-z*he*ye,this._y=z*he*ae+ie*Q*ye,this._z=z*Q*ye+ie*he*ae,this._w=z*Q*ae-ie*he*ye;break;case"ZYX":this._x=ie*Q*ae-z*he*ye,this._y=z*he*ae+ie*Q*ye,this._z=z*Q*ye-ie*he*ae,this._w=z*Q*ae+ie*he*ye;break;case"YZX":this._x=ie*Q*ae+z*he*ye,this._y=z*he*ae+ie*Q*ye,this._z=z*Q*ye-ie*he*ae,this._w=z*Q*ae-ie*he*ye;break;case"XZY":this._x=ie*Q*ae-z*he*ye,this._y=z*he*ae-ie*Q*ye,this._z=z*Q*ye+ie*he*ae,this._w=z*Q*ae+ie*he*ye;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+L)}return!1!==c&&this._onChangeCallback(),this}setFromAxisAngle(e,c){const p=c/2,_=Math.sin(p);return this._x=e.x*_,this._y=e.y*_,this._z=e.z*_,this._w=Math.cos(p),this._onChangeCallback(),this}setFromRotationMatrix(e){const c=e.elements,p=c[0],_=c[4],w=c[8],L=c[1],O=c[5],D=c[9],z=c[2],Q=c[6],ae=c[10],ie=p+O+ae;if(ie>0){const he=.5/Math.sqrt(ie+1);this._w=.25/he,this._x=(Q-D)*he,this._y=(w-z)*he,this._z=(L-_)*he}else if(p>O&&p>ae){const he=2*Math.sqrt(1+p-O-ae);this._w=(Q-D)/he,this._x=.25*he,this._y=(_+L)/he,this._z=(w+z)/he}else if(O>ae){const he=2*Math.sqrt(1+O-p-ae);this._w=(w-z)/he,this._x=(_+L)/he,this._y=.25*he,this._z=(D+Q)/he}else{const he=2*Math.sqrt(1+ae-p-O);this._w=(L-_)/he,this._x=(w+z)/he,this._y=(D+Q)/he,this._z=.25*he}return this._onChangeCallback(),this}setFromUnitVectors(e,c){let p=e.dot(c)+1;return p<Number.EPSILON?(p=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=p):(this._x=0,this._y=-e.z,this._z=e.y,this._w=p)):(this._x=e.y*c.z-e.z*c.y,this._y=e.z*c.x-e.x*c.z,this._z=e.x*c.y-e.y*c.x,this._w=p),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(jr(this.dot(e),-1,1)))}rotateTowards(e,c){const p=this.angleTo(e);if(0===p)return this;const _=Math.min(1,c/p);return this.slerp(e,_),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e,c){return void 0!==c?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,c)):this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,c){const p=e._x,_=e._y,w=e._z,L=e._w,O=c._x,D=c._y,z=c._z,Q=c._w;return this._x=p*Q+L*O+_*z-w*D,this._y=_*Q+L*D+w*O-p*z,this._z=w*Q+L*z+p*D-_*O,this._w=L*Q-p*O-_*D-w*z,this._onChangeCallback(),this}slerp(e,c){if(0===c)return this;if(1===c)return this.copy(e);const p=this._x,_=this._y,w=this._z,L=this._w;let O=L*e._w+p*e._x+_*e._y+w*e._z;if(O<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,O=-O):this.copy(e),O>=1)return this._w=L,this._x=p,this._y=_,this._z=w,this;const D=1-O*O;if(D<=Number.EPSILON){const he=1-c;return this._w=he*L+c*this._w,this._x=he*p+c*this._x,this._y=he*_+c*this._y,this._z=he*w+c*this._z,this.normalize(),this._onChangeCallback(),this}const z=Math.sqrt(D),Q=Math.atan2(z,O),ae=Math.sin((1-c)*Q)/z,ie=Math.sin(c*Q)/z;return this._w=L*ae+this._w*ie,this._x=p*ae+this._x*ie,this._y=_*ae+this._y*ie,this._z=w*ae+this._z*ie,this._onChangeCallback(),this}slerpQuaternions(e,c,p){this.copy(e).slerp(c,p)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,c=0){return this._x=e[c],this._y=e[c+1],this._z=e[c+2],this._w=e[c+3],this._onChangeCallback(),this}toArray(e=[],c=0){return e[c]=this._x,e[c+1]=this._y,e[c+2]=this._z,e[c+3]=this._w,e}fromBufferAttribute(e,c){return this._x=e.getX(c),this._y=e.getY(c),this._z=e.getZ(c),this._w=e.getW(c),this}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}Li.prototype.isQuaternion=!0;class lt{constructor(e=0,c=0,p=0){this.x=e,this.y=c,this.z=p}set(e,c,p){return void 0===p&&(p=this.z),this.x=e,this.y=c,this.z=p,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,c){switch(e){case 0:this.x=c;break;case 1:this.y=c;break;case 2:this.z=c;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e,c){return void 0!==c?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,c)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,c){return this.x=e.x+c.x,this.y=e.y+c.y,this.z=e.z+c.z,this}addScaledVector(e,c){return this.x+=e.x*c,this.y+=e.y*c,this.z+=e.z*c,this}sub(e,c){return void 0!==c?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,c)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,c){return this.x=e.x-c.x,this.y=e.y-c.y,this.z=e.z-c.z,this}multiply(e,c){return void 0!==c?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,c)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,c){return this.x=e.x*c.x,this.y=e.y*c.y,this.z=e.z*c.z,this}applyEuler(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Mp.setFromEuler(e))}applyAxisAngle(e,c){return this.applyQuaternion(Mp.setFromAxisAngle(e,c))}applyMatrix3(e){const c=this.x,p=this.y,_=this.z,w=e.elements;return this.x=w[0]*c+w[3]*p+w[6]*_,this.y=w[1]*c+w[4]*p+w[7]*_,this.z=w[2]*c+w[5]*p+w[8]*_,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const c=this.x,p=this.y,_=this.z,w=e.elements,L=1/(w[3]*c+w[7]*p+w[11]*_+w[15]);return this.x=(w[0]*c+w[4]*p+w[8]*_+w[12])*L,this.y=(w[1]*c+w[5]*p+w[9]*_+w[13])*L,this.z=(w[2]*c+w[6]*p+w[10]*_+w[14])*L,this}applyQuaternion(e){const c=this.x,p=this.y,_=this.z,w=e.x,L=e.y,O=e.z,D=e.w,z=D*c+L*_-O*p,Q=D*p+O*c-w*_,ae=D*_+w*p-L*c,ie=-w*c-L*p-O*_;return this.x=z*D+ie*-w+Q*-O-ae*-L,this.y=Q*D+ie*-L+ae*-w-z*-O,this.z=ae*D+ie*-O+z*-L-Q*-w,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const c=this.x,p=this.y,_=this.z,w=e.elements;return this.x=w[0]*c+w[4]*p+w[8]*_,this.y=w[1]*c+w[5]*p+w[9]*_,this.z=w[2]*c+w[6]*p+w[10]*_,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,c){return this.x=Math.max(e.x,Math.min(c.x,this.x)),this.y=Math.max(e.y,Math.min(c.y,this.y)),this.z=Math.max(e.z,Math.min(c.z,this.z)),this}clampScalar(e,c){return this.x=Math.max(e,Math.min(c,this.x)),this.y=Math.max(e,Math.min(c,this.y)),this.z=Math.max(e,Math.min(c,this.z)),this}clampLength(e,c){const p=this.length();return this.divideScalar(p||1).multiplyScalar(Math.max(e,Math.min(c,p)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,c){return this.x+=(e.x-this.x)*c,this.y+=(e.y-this.y)*c,this.z+=(e.z-this.z)*c,this}lerpVectors(e,c,p){return this.x=e.x+(c.x-e.x)*p,this.y=e.y+(c.y-e.y)*p,this.z=e.z+(c.z-e.z)*p,this}cross(e,c){return void 0!==c?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,c)):this.crossVectors(this,e)}crossVectors(e,c){const p=e.x,_=e.y,w=e.z,L=c.x,O=c.y,D=c.z;return this.x=_*D-w*O,this.y=w*L-p*D,this.z=p*O-_*L,this}projectOnVector(e){const c=e.lengthSq();if(0===c)return this.set(0,0,0);const p=e.dot(this)/c;return this.copy(e).multiplyScalar(p)}projectOnPlane(e){return yu.copy(this).projectOnVector(e),this.sub(yu)}reflect(e){return this.sub(yu.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const c=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===c)return Math.PI/2;const p=this.dot(e)/c;return Math.acos(jr(p,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const c=this.x-e.x,p=this.y-e.y,_=this.z-e.z;return c*c+p*p+_*_}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,c,p){const _=Math.sin(c)*e;return this.x=_*Math.sin(p),this.y=Math.cos(c)*e,this.z=_*Math.cos(p),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,c,p){return this.x=e*Math.sin(c),this.y=p,this.z=e*Math.cos(c),this}setFromMatrixPosition(e){const c=e.elements;return this.x=c[12],this.y=c[13],this.z=c[14],this}setFromMatrixScale(e){const c=this.setFromMatrixColumn(e,0).length(),p=this.setFromMatrixColumn(e,1).length(),_=this.setFromMatrixColumn(e,2).length();return this.x=c,this.y=p,this.z=_,this}setFromMatrixColumn(e,c){return this.fromArray(e.elements,4*c)}setFromMatrix3Column(e,c){return this.fromArray(e.elements,3*c)}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,c=0){return this.x=e[c],this.y=e[c+1],this.z=e[c+2],this}toArray(e=[],c=0){return e[c]=this.x,e[c+1]=this.y,e[c+2]=this.z,e}fromBufferAttribute(e,c,p){return void 0!==p&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(c),this.y=e.getY(c),this.z=e.getZ(c),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}lt.prototype.isVector3=!0;const yu=new lt,Mp=new Li;class Vi{constructor(e=new lt(1/0,1/0,1/0),c=new lt(-1/0,-1/0,-1/0)){this.min=e,this.max=c}set(e,c){return this.min.copy(e),this.max.copy(c),this}setFromArray(e){let c=1/0,p=1/0,_=1/0,w=-1/0,L=-1/0,O=-1/0;for(let D=0,z=e.length;D<z;D+=3){const Q=e[D],ae=e[D+1],ie=e[D+2];Q<c&&(c=Q),ae<p&&(p=ae),ie<_&&(_=ie),Q>w&&(w=Q),ae>L&&(L=ae),ie>O&&(O=ie)}return this.min.set(c,p,_),this.max.set(w,L,O),this}setFromBufferAttribute(e){let c=1/0,p=1/0,_=1/0,w=-1/0,L=-1/0,O=-1/0;for(let D=0,z=e.count;D<z;D++){const Q=e.getX(D),ae=e.getY(D),ie=e.getZ(D);Q<c&&(c=Q),ae<p&&(p=ae),ie<_&&(_=ie),Q>w&&(w=Q),ae>L&&(L=ae),ie>O&&(O=ie)}return this.min.set(c,p,_),this.max.set(w,L,O),this}setFromPoints(e){this.makeEmpty();for(let c=0,p=e.length;c<p;c++)this.expandByPoint(e[c]);return this}setFromCenterAndSize(e,c){const p=Wr.copy(c).multiplyScalar(.5);return this.min.copy(e).sub(p),this.max.copy(e).add(p),this}setFromObject(e){return this.makeEmpty(),this.expandByObject(e)}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e){e.updateWorldMatrix(!1,!1);const c=e.geometry;void 0!==c&&(null===c.boundingBox&&c.computeBoundingBox(),Oa.copy(c.boundingBox),Oa.applyMatrix4(e.matrixWorld),this.union(Oa));const p=e.children;for(let _=0,w=p.length;_<w;_++)this.expandByObject(p[_]);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,c){return c.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Wr),Wr.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let c,p;return e.normal.x>0?(c=e.normal.x*this.min.x,p=e.normal.x*this.max.x):(c=e.normal.x*this.max.x,p=e.normal.x*this.min.x),e.normal.y>0?(c+=e.normal.y*this.min.y,p+=e.normal.y*this.max.y):(c+=e.normal.y*this.max.y,p+=e.normal.y*this.min.y),e.normal.z>0?(c+=e.normal.z*this.min.z,p+=e.normal.z*this.max.z):(c+=e.normal.z*this.max.z,p+=e.normal.z*this.min.z),c<=-e.constant&&p>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(wh),dc.subVectors(this.max,wh),bo.subVectors(e.a,wh),oa.subVectors(e.b,wh),bu.subVectors(e.c,wh),pc.subVectors(oa,bo),jc.subVectors(bu,oa),xu.subVectors(bo,bu);let c=[0,-pc.z,pc.y,0,-jc.z,jc.y,0,-xu.z,xu.y,pc.z,0,-pc.x,jc.z,0,-jc.x,xu.z,0,-xu.x,-pc.y,pc.x,0,-jc.y,jc.x,0,-xu.y,xu.x,0];return!!ka(c,bo,oa,bu,dc)&&(c=[1,0,0,0,1,0,0,0,1],!!ka(c,bo,oa,bu,dc)&&(er.crossVectors(pc,jc),c=[er.x,er.y,er.z],ka(c,bo,oa,bu,dc)))}clampPoint(e,c){return c.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return Wr.copy(e).clamp(this.min,this.max).sub(e).length()}getBoundingSphere(e){return this.getCenter(e.center),e.radius=.5*this.getSize(Wr).length(),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(kr[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),kr[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),kr[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),kr[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),kr[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),kr[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),kr[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),kr[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(kr)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}Vi.prototype.isBox3=!0;const kr=[new lt,new lt,new lt,new lt,new lt,new lt,new lt,new lt],Wr=new lt,Oa=new Vi,bo=new lt,oa=new lt,bu=new lt,pc=new lt,jc=new lt,xu=new lt,wh=new lt,dc=new lt,er=new lt,Sl=new lt;function ka(S,e,c,p,_){for(let w=0,L=S.length-3;w<=L;w+=3){Sl.fromArray(S,w);const O=_.x*Math.abs(Sl.x)+_.y*Math.abs(Sl.y)+_.z*Math.abs(Sl.z),D=e.dot(Sl),z=c.dot(Sl),Q=p.dot(Sl);if(Math.max(-Math.max(D,z,Q),Math.min(D,z,Q))>O)return!1}return!0}const ya=new Vi,Hl=new lt,wu=new lt,ba=new lt;class xo{constructor(e=new lt,c=-1){this.center=e,this.radius=c}set(e,c){return this.center.copy(e),this.radius=c,this}setFromPoints(e,c){const p=this.center;void 0!==c?p.copy(c):ya.setFromPoints(e).getCenter(p);let _=0;for(let w=0,L=e.length;w<L;w++)_=Math.max(_,p.distanceToSquared(e[w]));return this.radius=Math.sqrt(_),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const c=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=c*c}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,c){const p=this.center.distanceToSquared(e);return c.copy(e),p>this.radius*this.radius&&(c.sub(this.center).normalize(),c.multiplyScalar(this.radius).add(this.center)),c}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){ba.subVectors(e,this.center);const c=ba.lengthSq();if(c>this.radius*this.radius){const p=Math.sqrt(c),_=.5*(p-this.radius);this.center.add(ba.multiplyScalar(_/p)),this.radius+=_}return this}union(e){return wu.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(Hl.copy(e.center).add(wu)),this.expandByPoint(Hl.copy(e.center).sub(wu)),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Os=new lt,mc=new lt,tt=new lt,bt=new lt,kt=new lt,vn=new lt,qt=new lt;class _n{constructor(e=new lt,c=new lt(0,0,-1)){this.origin=e,this.direction=c}set(e,c){return this.origin.copy(e),this.direction.copy(c),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,c){return c.copy(this.direction).multiplyScalar(e).add(this.origin)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,Os)),this}closestPointToPoint(e,c){c.subVectors(e,this.origin);const p=c.dot(this.direction);return p<0?c.copy(this.origin):c.copy(this.direction).multiplyScalar(p).add(this.origin)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const c=Os.subVectors(e,this.origin).dot(this.direction);return c<0?this.origin.distanceToSquared(e):(Os.copy(this.direction).multiplyScalar(c).add(this.origin),Os.distanceToSquared(e))}distanceSqToSegment(e,c,p,_){mc.copy(e).add(c).multiplyScalar(.5),tt.copy(c).sub(e).normalize(),bt.copy(this.origin).sub(mc);const w=.5*e.distanceTo(c),L=-this.direction.dot(tt),O=bt.dot(this.direction),D=-bt.dot(tt),z=bt.lengthSq(),Q=Math.abs(1-L*L);let ae,ie,he,ye;if(Q>0)if(ae=L*D-O,ie=L*O-D,ye=w*Q,ae>=0)if(ie>=-ye)if(ie<=ye){const Me=1/Q;ae*=Me,ie*=Me,he=ae*(ae+L*ie+2*O)+ie*(L*ae+ie+2*D)+z}else ie=w,ae=Math.max(0,-(L*ie+O)),he=-ae*ae+ie*(ie+2*D)+z;else ie=-w,ae=Math.max(0,-(L*ie+O)),he=-ae*ae+ie*(ie+2*D)+z;else ie<=-ye?(ae=Math.max(0,-(-L*w+O)),ie=ae>0?-w:Math.min(Math.max(-w,-D),w),he=-ae*ae+ie*(ie+2*D)+z):ie<=ye?(ae=0,ie=Math.min(Math.max(-w,-D),w),he=ie*(ie+2*D)+z):(ae=Math.max(0,-(L*w+O)),ie=ae>0?w:Math.min(Math.max(-w,-D),w),he=-ae*ae+ie*(ie+2*D)+z);else ie=L>0?-w:w,ae=Math.max(0,-(L*ie+O)),he=-ae*ae+ie*(ie+2*D)+z;return p&&p.copy(this.direction).multiplyScalar(ae).add(this.origin),_&&_.copy(tt).multiplyScalar(ie).add(mc),he}intersectSphere(e,c){Os.subVectors(e.center,this.origin);const p=Os.dot(this.direction),_=Os.dot(Os)-p*p,w=e.radius*e.radius;if(_>w)return null;const L=Math.sqrt(w-_),O=p-L,D=p+L;return O<0&&D<0?null:this.at(O<0?D:O,c)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const c=e.normal.dot(this.direction);if(0===c)return 0===e.distanceToPoint(this.origin)?0:null;const p=-(this.origin.dot(e.normal)+e.constant)/c;return p>=0?p:null}intersectPlane(e,c){const p=this.distanceToPlane(e);return null===p?null:this.at(p,c)}intersectsPlane(e){const c=e.distanceToPoint(this.origin);return 0===c||e.normal.dot(this.direction)*c<0}intersectBox(e,c){let p,_,w,L,O,D;const z=1/this.direction.x,Q=1/this.direction.y,ae=1/this.direction.z,ie=this.origin;return z>=0?(p=(e.min.x-ie.x)*z,_=(e.max.x-ie.x)*z):(p=(e.max.x-ie.x)*z,_=(e.min.x-ie.x)*z),Q>=0?(w=(e.min.y-ie.y)*Q,L=(e.max.y-ie.y)*Q):(w=(e.max.y-ie.y)*Q,L=(e.min.y-ie.y)*Q),p>L||w>_?null:((w>p||p!=p)&&(p=w),(L<_||_!=_)&&(_=L),ae>=0?(O=(e.min.z-ie.z)*ae,D=(e.max.z-ie.z)*ae):(O=(e.max.z-ie.z)*ae,D=(e.min.z-ie.z)*ae),p>D||O>_?null:((O>p||p!=p)&&(p=O),(D<_||_!=_)&&(_=D),_<0?null:this.at(p>=0?p:_,c)))}intersectsBox(e){return null!==this.intersectBox(e,Os)}intersectTriangle(e,c,p,_,w){kt.subVectors(c,e),vn.subVectors(p,e),qt.crossVectors(kt,vn);let L,O=this.direction.dot(qt);if(O>0){if(_)return null;L=1}else{if(!(O<0))return null;L=-1,O=-O}bt.subVectors(this.origin,e);const D=L*this.direction.dot(vn.crossVectors(bt,vn));if(D<0)return null;const z=L*this.direction.dot(kt.cross(bt));if(z<0||D+z>O)return null;const Q=-L*bt.dot(qt);return Q<0?null:this.at(Q/O,w)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class Qt{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(e,c,p,_,w,L,O,D,z,Q,ae,ie,he,ye,Me,Ne){const $e=this.elements;return $e[0]=e,$e[4]=c,$e[8]=p,$e[12]=_,$e[1]=w,$e[5]=L,$e[9]=O,$e[13]=D,$e[2]=z,$e[6]=Q,$e[10]=ae,$e[14]=ie,$e[3]=he,$e[7]=ye,$e[11]=Me,$e[15]=Ne,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new Qt).fromArray(this.elements)}copy(e){const c=this.elements,p=e.elements;return c[0]=p[0],c[1]=p[1],c[2]=p[2],c[3]=p[3],c[4]=p[4],c[5]=p[5],c[6]=p[6],c[7]=p[7],c[8]=p[8],c[9]=p[9],c[10]=p[10],c[11]=p[11],c[12]=p[12],c[13]=p[13],c[14]=p[14],c[15]=p[15],this}copyPosition(e){const c=this.elements,p=e.elements;return c[12]=p[12],c[13]=p[13],c[14]=p[14],this}setFromMatrix3(e){const c=e.elements;return this.set(c[0],c[3],c[6],0,c[1],c[4],c[7],0,c[2],c[5],c[8],0,0,0,0,1),this}extractBasis(e,c,p){return e.setFromMatrixColumn(this,0),c.setFromMatrixColumn(this,1),p.setFromMatrixColumn(this,2),this}makeBasis(e,c,p){return this.set(e.x,c.x,p.x,0,e.y,c.y,p.y,0,e.z,c.z,p.z,0,0,0,0,1),this}extractRotation(e){const c=this.elements,p=e.elements,_=1/Jn.setFromMatrixColumn(e,0).length(),w=1/Jn.setFromMatrixColumn(e,1).length(),L=1/Jn.setFromMatrixColumn(e,2).length();return c[0]=p[0]*_,c[1]=p[1]*_,c[2]=p[2]*_,c[3]=0,c[4]=p[4]*w,c[5]=p[5]*w,c[6]=p[6]*w,c[7]=0,c[8]=p[8]*L,c[9]=p[9]*L,c[10]=p[10]*L,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,this}makeRotationFromEuler(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const c=this.elements,p=e.x,_=e.y,w=e.z,L=Math.cos(p),O=Math.sin(p),D=Math.cos(_),z=Math.sin(_),Q=Math.cos(w),ae=Math.sin(w);if("XYZ"===e.order){const ie=L*Q,he=L*ae,ye=O*Q,Me=O*ae;c[0]=D*Q,c[4]=-D*ae,c[8]=z,c[1]=he+ye*z,c[5]=ie-Me*z,c[9]=-O*D,c[2]=Me-ie*z,c[6]=ye+he*z,c[10]=L*D}else if("YXZ"===e.order){const ie=D*Q,he=D*ae,ye=z*Q,Me=z*ae;c[0]=ie+Me*O,c[4]=ye*O-he,c[8]=L*z,c[1]=L*ae,c[5]=L*Q,c[9]=-O,c[2]=he*O-ye,c[6]=Me+ie*O,c[10]=L*D}else if("ZXY"===e.order){const ie=D*Q,he=D*ae,ye=z*Q,Me=z*ae;c[0]=ie-Me*O,c[4]=-L*ae,c[8]=ye+he*O,c[1]=he+ye*O,c[5]=L*Q,c[9]=Me-ie*O,c[2]=-L*z,c[6]=O,c[10]=L*D}else if("ZYX"===e.order){const ie=L*Q,he=L*ae,ye=O*Q,Me=O*ae;c[0]=D*Q,c[4]=ye*z-he,c[8]=ie*z+Me,c[1]=D*ae,c[5]=Me*z+ie,c[9]=he*z-ye,c[2]=-z,c[6]=O*D,c[10]=L*D}else if("YZX"===e.order){const ie=L*D,he=L*z,ye=O*D,Me=O*z;c[0]=D*Q,c[4]=Me-ie*ae,c[8]=ye*ae+he,c[1]=ae,c[5]=L*Q,c[9]=-O*Q,c[2]=-z*Q,c[6]=he*ae+ye,c[10]=ie-Me*ae}else if("XZY"===e.order){const ie=L*D,he=L*z,ye=O*D,Me=O*z;c[0]=D*Q,c[4]=-ae,c[8]=z*Q,c[1]=ie*ae+Me,c[5]=L*Q,c[9]=he*ae-ye,c[2]=ye*ae-he,c[6]=O*Q,c[10]=Me*ae+ie}return c[3]=0,c[7]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,this}makeRotationFromQuaternion(e){return this.compose(Sr,e,$r)}lookAt(e,c,p){const _=this.elements;return hi.subVectors(e,c),0===hi.lengthSq()&&(hi.z=1),hi.normalize(),yr.crossVectors(p,hi),0===yr.lengthSq()&&(1===Math.abs(p.z)?hi.x+=1e-4:hi.z+=1e-4,hi.normalize(),yr.crossVectors(p,hi)),yr.normalize(),qr.crossVectors(hi,yr),_[0]=yr.x,_[4]=qr.x,_[8]=hi.x,_[1]=yr.y,_[5]=qr.y,_[9]=hi.y,_[2]=yr.z,_[6]=qr.z,_[10]=hi.z,this}multiply(e,c){return void 0!==c?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,c)):this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,c){const p=e.elements,_=c.elements,w=this.elements,L=p[0],O=p[4],D=p[8],z=p[12],Q=p[1],ae=p[5],ie=p[9],he=p[13],ye=p[2],Me=p[6],Ne=p[10],$e=p[14],ze=p[3],Ye=p[7],We=p[11],nt=p[15],it=_[0],mt=_[4],xt=_[8],Dt=_[12],Ht=_[1],Je=_[5],pt=_[9],Vt=_[13],Nt=_[2],ct=_[6],Yt=_[10],St=_[14],jt=_[3],It=_[7],an=_[11],Ze=_[15];return w[0]=L*it+O*Ht+D*Nt+z*jt,w[4]=L*mt+O*Je+D*ct+z*It,w[8]=L*xt+O*pt+D*Yt+z*an,w[12]=L*Dt+O*Vt+D*St+z*Ze,w[1]=Q*it+ae*Ht+ie*Nt+he*jt,w[5]=Q*mt+ae*Je+ie*ct+he*It,w[9]=Q*xt+ae*pt+ie*Yt+he*an,w[13]=Q*Dt+ae*Vt+ie*St+he*Ze,w[2]=ye*it+Me*Ht+Ne*Nt+$e*jt,w[6]=ye*mt+Me*Je+Ne*ct+$e*It,w[10]=ye*xt+Me*pt+Ne*Yt+$e*an,w[14]=ye*Dt+Me*Vt+Ne*St+$e*Ze,w[3]=ze*it+Ye*Ht+We*Nt+nt*jt,w[7]=ze*mt+Ye*Je+We*ct+nt*It,w[11]=ze*xt+Ye*pt+We*Yt+nt*an,w[15]=ze*Dt+Ye*Vt+We*St+nt*Ze,this}multiplyScalar(e){const c=this.elements;return c[0]*=e,c[4]*=e,c[8]*=e,c[12]*=e,c[1]*=e,c[5]*=e,c[9]*=e,c[13]*=e,c[2]*=e,c[6]*=e,c[10]*=e,c[14]*=e,c[3]*=e,c[7]*=e,c[11]*=e,c[15]*=e,this}determinant(){const e=this.elements,c=e[0],p=e[4],_=e[8],w=e[12],L=e[1],O=e[5],D=e[9],z=e[13],Q=e[2],ae=e[6],ie=e[10],he=e[14];return e[3]*(+w*D*ae-_*z*ae-w*O*ie+p*z*ie+_*O*he-p*D*he)+e[7]*(+c*D*he-c*z*ie+w*L*ie-_*L*he+_*z*Q-w*D*Q)+e[11]*(+c*z*ae-c*O*he-w*L*ae+p*L*he+w*O*Q-p*z*Q)+e[15]*(-_*O*Q-c*D*ae+c*O*ie+_*L*ae-p*L*ie+p*D*Q)}transpose(){const e=this.elements;let c;return c=e[1],e[1]=e[4],e[4]=c,c=e[2],e[2]=e[8],e[8]=c,c=e[6],e[6]=e[9],e[9]=c,c=e[3],e[3]=e[12],e[12]=c,c=e[7],e[7]=e[13],e[13]=c,c=e[11],e[11]=e[14],e[14]=c,this}setPosition(e,c,p){const _=this.elements;return e.isVector3?(_[12]=e.x,_[13]=e.y,_[14]=e.z):(_[12]=e,_[13]=c,_[14]=p),this}invert(){const e=this.elements,c=e[0],p=e[1],_=e[2],w=e[3],L=e[4],O=e[5],D=e[6],z=e[7],Q=e[8],ae=e[9],ie=e[10],he=e[11],ye=e[12],Me=e[13],Ne=e[14],$e=e[15],ze=ae*Ne*z-Me*ie*z+Me*D*he-O*Ne*he-ae*D*$e+O*ie*$e,Ye=ye*ie*z-Q*Ne*z-ye*D*he+L*Ne*he+Q*D*$e-L*ie*$e,We=Q*Me*z-ye*ae*z+ye*O*he-L*Me*he-Q*O*$e+L*ae*$e,nt=ye*ae*D-Q*Me*D-ye*O*ie+L*Me*ie+Q*O*Ne-L*ae*Ne,it=c*ze+p*Ye+_*We+w*nt;if(0===it)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const mt=1/it;return e[0]=ze*mt,e[1]=(Me*ie*w-ae*Ne*w-Me*_*he+p*Ne*he+ae*_*$e-p*ie*$e)*mt,e[2]=(O*Ne*w-Me*D*w+Me*_*z-p*Ne*z-O*_*$e+p*D*$e)*mt,e[3]=(ae*D*w-O*ie*w-ae*_*z+p*ie*z+O*_*he-p*D*he)*mt,e[4]=Ye*mt,e[5]=(Q*Ne*w-ye*ie*w+ye*_*he-c*Ne*he-Q*_*$e+c*ie*$e)*mt,e[6]=(ye*D*w-L*Ne*w-ye*_*z+c*Ne*z+L*_*$e-c*D*$e)*mt,e[7]=(L*ie*w-Q*D*w+Q*_*z-c*ie*z-L*_*he+c*D*he)*mt,e[8]=We*mt,e[9]=(ye*ae*w-Q*Me*w-ye*p*he+c*Me*he+Q*p*$e-c*ae*$e)*mt,e[10]=(L*Me*w-ye*O*w+ye*p*z-c*Me*z-L*p*$e+c*O*$e)*mt,e[11]=(Q*O*w-L*ae*w-Q*p*z+c*ae*z+L*p*he-c*O*he)*mt,e[12]=nt*mt,e[13]=(Q*Me*_-ye*ae*_+ye*p*ie-c*Me*ie-Q*p*Ne+c*ae*Ne)*mt,e[14]=(ye*O*_-L*Me*_-ye*p*D+c*Me*D+L*p*Ne-c*O*Ne)*mt,e[15]=(L*ae*_-Q*O*_+Q*p*D-c*ae*D-L*p*ie+c*O*ie)*mt,this}scale(e){const c=this.elements,p=e.x,_=e.y,w=e.z;return c[0]*=p,c[4]*=_,c[8]*=w,c[1]*=p,c[5]*=_,c[9]*=w,c[2]*=p,c[6]*=_,c[10]*=w,c[3]*=p,c[7]*=_,c[11]*=w,this}getMaxScaleOnAxis(){const e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,c,p){return this.set(1,0,0,e,0,1,0,c,0,0,1,p,0,0,0,1),this}makeRotationX(e){const c=Math.cos(e),p=Math.sin(e);return this.set(1,0,0,0,0,c,-p,0,0,p,c,0,0,0,0,1),this}makeRotationY(e){const c=Math.cos(e),p=Math.sin(e);return this.set(c,0,p,0,0,1,0,0,-p,0,c,0,0,0,0,1),this}makeRotationZ(e){const c=Math.cos(e),p=Math.sin(e);return this.set(c,-p,0,0,p,c,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,c){const p=Math.cos(c),_=Math.sin(c),w=1-p,L=e.x,O=e.y,D=e.z,z=w*L,Q=w*O;return this.set(z*L+p,z*O-_*D,z*D+_*O,0,z*O+_*D,Q*O+p,Q*D-_*L,0,z*D-_*O,Q*D+_*L,w*D*D+p,0,0,0,0,1),this}makeScale(e,c,p){return this.set(e,0,0,0,0,c,0,0,0,0,p,0,0,0,0,1),this}makeShear(e,c,p,_,w,L){return this.set(1,p,w,0,e,1,L,0,c,_,1,0,0,0,0,1),this}compose(e,c,p){const _=this.elements,w=c._x,L=c._y,O=c._z,D=c._w,z=w+w,Q=L+L,ae=O+O,ie=w*z,he=w*Q,ye=w*ae,Me=L*Q,Ne=L*ae,$e=O*ae,ze=D*z,Ye=D*Q,We=D*ae,nt=p.x,it=p.y,mt=p.z;return _[0]=(1-(Me+$e))*nt,_[1]=(he+We)*nt,_[2]=(ye-Ye)*nt,_[3]=0,_[4]=(he-We)*it,_[5]=(1-(ie+$e))*it,_[6]=(Ne+ze)*it,_[7]=0,_[8]=(ye+Ye)*mt,_[9]=(Ne-ze)*mt,_[10]=(1-(ie+Me))*mt,_[11]=0,_[12]=e.x,_[13]=e.y,_[14]=e.z,_[15]=1,this}decompose(e,c,p){const _=this.elements;let w=Jn.set(_[0],_[1],_[2]).length();const L=Jn.set(_[4],_[5],_[6]).length(),O=Jn.set(_[8],_[9],_[10]).length();this.determinant()<0&&(w=-w),e.x=_[12],e.y=_[13],e.z=_[14],zn.copy(this);const D=1/w,z=1/L,Q=1/O;return zn.elements[0]*=D,zn.elements[1]*=D,zn.elements[2]*=D,zn.elements[4]*=z,zn.elements[5]*=z,zn.elements[6]*=z,zn.elements[8]*=Q,zn.elements[9]*=Q,zn.elements[10]*=Q,c.setFromRotationMatrix(zn),p.x=w,p.y=L,p.z=O,this}makePerspective(e,c,p,_,w,L){void 0===L&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const O=this.elements,z=2*w/(p-_),Q=(c+e)/(c-e),ae=(p+_)/(p-_),ie=-(L+w)/(L-w),he=-2*L*w/(L-w);return O[0]=2*w/(c-e),O[4]=0,O[8]=Q,O[12]=0,O[1]=0,O[5]=z,O[9]=ae,O[13]=0,O[2]=0,O[6]=0,O[10]=ie,O[14]=he,O[3]=0,O[7]=0,O[11]=-1,O[15]=0,this}makeOrthographic(e,c,p,_,w,L){const O=this.elements,D=1/(c-e),z=1/(p-_),Q=1/(L-w),ae=(c+e)*D,ie=(p+_)*z,he=(L+w)*Q;return O[0]=2*D,O[4]=0,O[8]=0,O[12]=-ae,O[1]=0,O[5]=2*z,O[9]=0,O[13]=-ie,O[2]=0,O[6]=0,O[10]=-2*Q,O[14]=-he,O[3]=0,O[7]=0,O[11]=0,O[15]=1,this}equals(e){const c=this.elements,p=e.elements;for(let _=0;_<16;_++)if(c[_]!==p[_])return!1;return!0}fromArray(e,c=0){for(let p=0;p<16;p++)this.elements[p]=e[p+c];return this}toArray(e=[],c=0){const p=this.elements;return e[c]=p[0],e[c+1]=p[1],e[c+2]=p[2],e[c+3]=p[3],e[c+4]=p[4],e[c+5]=p[5],e[c+6]=p[6],e[c+7]=p[7],e[c+8]=p[8],e[c+9]=p[9],e[c+10]=p[10],e[c+11]=p[11],e[c+12]=p[12],e[c+13]=p[13],e[c+14]=p[14],e[c+15]=p[15],e}}Qt.prototype.isMatrix4=!0;const Jn=new lt,zn=new Qt,Sr=new lt(0,0,0),$r=new lt(1,1,1),yr=new lt,qr=new lt,hi=new lt,Rr=new Qt,es=new Li;class co{constructor(e=0,c=0,p=0,_=co.DefaultOrder){this._x=e,this._y=c,this._z=p,this._order=_}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,c,p,_=this._order){return this._x=e,this._y=c,this._z=p,this._order=_,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,c=this._order,p=!0){const _=e.elements,w=_[0],L=_[4],O=_[8],D=_[1],z=_[5],Q=_[9],ae=_[2],ie=_[6],he=_[10];switch(c){case"XYZ":this._y=Math.asin(jr(O,-1,1)),Math.abs(O)<.9999999?(this._x=Math.atan2(-Q,he),this._z=Math.atan2(-L,w)):(this._x=Math.atan2(ie,z),this._z=0);break;case"YXZ":this._x=Math.asin(-jr(Q,-1,1)),Math.abs(Q)<.9999999?(this._y=Math.atan2(O,he),this._z=Math.atan2(D,z)):(this._y=Math.atan2(-ae,w),this._z=0);break;case"ZXY":this._x=Math.asin(jr(ie,-1,1)),Math.abs(ie)<.9999999?(this._y=Math.atan2(-ae,he),this._z=Math.atan2(-L,z)):(this._y=0,this._z=Math.atan2(D,w));break;case"ZYX":this._y=Math.asin(-jr(ae,-1,1)),Math.abs(ae)<.9999999?(this._x=Math.atan2(ie,he),this._z=Math.atan2(D,w)):(this._x=0,this._z=Math.atan2(-L,z));break;case"YZX":this._z=Math.asin(jr(D,-1,1)),Math.abs(D)<.9999999?(this._x=Math.atan2(-Q,z),this._y=Math.atan2(-ae,w)):(this._x=0,this._y=Math.atan2(O,he));break;case"XZY":this._z=Math.asin(-jr(L,-1,1)),Math.abs(L)<.9999999?(this._x=Math.atan2(ie,z),this._y=Math.atan2(O,w)):(this._x=Math.atan2(-Q,he),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+c)}return this._order=c,!0===p&&this._onChangeCallback(),this}setFromQuaternion(e,c,p){return Rr.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Rr,c,p)}setFromVector3(e,c=this._order){return this.set(e.x,e.y,e.z,c)}reorder(e){return es.setFromEuler(this),this.setFromQuaternion(es,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],c=0){return e[c]=this._x,e[c+1]=this._y,e[c+2]=this._z,e[c+3]=this._order,e}toVector3(e){return e?e.set(this._x,this._y,this._z):new lt(this._x,this._y,this._z)}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}}co.prototype.isEuler=!0,co.DefaultOrder="XYZ",co.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class qs{constructor(){this.mask=1}set(e){this.mask=1<<e}enable(e){this.mask|=1<<e}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e}disable(e){this.mask&=~(1<<e)}disableAll(){this.mask=0}test(e){return!!(this.mask&e.mask)}}let No=0;const Vl=new lt,Wo=new Li,Ji=new Qt,_c=new lt,Qh=new lt,Zu=new lt,Ap=new Li,Sh=new lt(1,0,0),bd=new lt(0,1,0),Eh=new lt(0,0,1),zd={type:"added"},xd={type:"removed"};class Ir extends Ps{constructor(){super(),Object.defineProperty(this,"id",{value:No++}),this.uuid=Ki(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Ir.DefaultUp.clone();const e=new lt,c=new co,p=new Li,_=new lt(1,1,1);c._onChange(function(){p.setFromEuler(c,!1)}),p._onChange(function(){c.setFromQuaternion(p,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:c},quaternion:{configurable:!0,enumerable:!0,value:p},scale:{configurable:!0,enumerable:!0,value:_},modelViewMatrix:{value:new Qt},normalMatrix:{value:new ot}}),this.matrix=new Qt,this.matrixWorld=new Qt,this.matrixAutoUpdate=Ir.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new qs,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,c){this.quaternion.setFromAxisAngle(e,c)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,c){return Wo.setFromAxisAngle(e,c),this.quaternion.multiply(Wo),this}rotateOnWorldAxis(e,c){return Wo.setFromAxisAngle(e,c),this.quaternion.premultiply(Wo),this}rotateX(e){return this.rotateOnAxis(Sh,e)}rotateY(e){return this.rotateOnAxis(bd,e)}rotateZ(e){return this.rotateOnAxis(Eh,e)}translateOnAxis(e,c){return Vl.copy(e).applyQuaternion(this.quaternion),this.position.add(Vl.multiplyScalar(c)),this}translateX(e){return this.translateOnAxis(Sh,e)}translateY(e){return this.translateOnAxis(bd,e)}translateZ(e){return this.translateOnAxis(Eh,e)}localToWorld(e){return e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return e.applyMatrix4(Ji.copy(this.matrixWorld).invert())}lookAt(e,c,p){e.isVector3?_c.copy(e):_c.set(e,c,p);const _=this.parent;this.updateWorldMatrix(!0,!1),Qh.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Ji.lookAt(Qh,_c,this.up):Ji.lookAt(_c,Qh,this.up),this.quaternion.setFromRotationMatrix(Ji),_&&(Ji.extractRotation(_.matrixWorld),Wo.setFromRotationMatrix(Ji),this.quaternion.premultiply(Wo.invert()))}add(e){if(arguments.length>1){for(let c=0;c<arguments.length;c++)this.add(arguments[c]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(zd)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let p=0;p<arguments.length;p++)this.remove(arguments[p]);return this}const c=this.children.indexOf(e);return-1!==c&&(e.parent=null,this.children.splice(c,1),e.dispatchEvent(xd)),this}removeFromParent(){const e=this.parent;return null!==e&&e.remove(this),this}clear(){for(let e=0;e<this.children.length;e++){const c=this.children[e];c.parent=null,c.dispatchEvent(xd)}return this.children.length=0,this}attach(e){return this.updateWorldMatrix(!0,!1),Ji.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),Ji.multiply(e.parent.matrixWorld)),e.applyMatrix4(Ji),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,c){if(this[e]===c)return this;for(let p=0,_=this.children.length;p<_;p++){const w=this.children[p].getObjectByProperty(e,c);if(void 0!==w)return w}}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Qh,e,Zu),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Qh,Ap,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const c=this.matrixWorld.elements;return e.set(c[8],c[9],c[10]).normalize()}raycast(){}traverse(e){e(this);const c=this.children;for(let p=0,_=c.length;p<_;p++)c[p].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);const c=this.children;for(let p=0,_=c.length;p<_;p++)c[p].traverseVisible(e)}traverseAncestors(e){const c=this.parent;null!==c&&(e(c),c.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const c=this.children;for(let p=0,_=c.length;p<_;p++)c[p].updateMatrixWorld(e)}updateWorldMatrix(e,c){const p=this.parent;if(!0===e&&null!==p&&p.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===c){const _=this.children;for(let w=0,L=_.length;w<L;w++)_[w].updateWorldMatrix(!1,!0)}}toJSON(e){const c=void 0===e||"string"==typeof e,p={};c&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},p.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const _={};function w(O,D){return void 0===O[D.uuid]&&(O[D.uuid]=D.toJSON(e)),D.uuid}if(_.uuid=this.uuid,_.type=this.type,""!==this.name&&(_.name=this.name),!0===this.castShadow&&(_.castShadow=!0),!0===this.receiveShadow&&(_.receiveShadow=!0),!1===this.visible&&(_.visible=!1),!1===this.frustumCulled&&(_.frustumCulled=!1),0!==this.renderOrder&&(_.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(_.userData=this.userData),_.layers=this.layers.mask,_.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(_.matrixAutoUpdate=!1),this.isInstancedMesh&&(_.type="InstancedMesh",_.count=this.count,_.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(_.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?_.background=this.background.toJSON():this.background.isTexture&&(_.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&(_.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){_.geometry=w(e.geometries,this.geometry);const O=this.geometry.parameters;if(void 0!==O&&void 0!==O.shapes){const D=O.shapes;if(Array.isArray(D))for(let z=0,Q=D.length;z<Q;z++)w(e.shapes,D[z]);else w(e.shapes,D)}}if(this.isSkinnedMesh&&(_.bindMode=this.bindMode,_.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(w(e.skeletons,this.skeleton),_.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const O=[];for(let D=0,z=this.material.length;D<z;D++)O.push(w(e.materials,this.material[D]));_.material=O}else _.material=w(e.materials,this.material);if(this.children.length>0){_.children=[];for(let O=0;O<this.children.length;O++)_.children.push(this.children[O].toJSON(e).object)}if(this.animations.length>0){_.animations=[];for(let O=0;O<this.animations.length;O++)_.animations.push(w(e.animations,this.animations[O]))}if(c){const O=L(e.geometries),D=L(e.materials),z=L(e.textures),Q=L(e.images),ae=L(e.shapes),ie=L(e.skeletons),he=L(e.animations);O.length>0&&(p.geometries=O),D.length>0&&(p.materials=D),z.length>0&&(p.textures=z),Q.length>0&&(p.images=Q),ae.length>0&&(p.shapes=ae),ie.length>0&&(p.skeletons=ie),he.length>0&&(p.animations=he)}return p.object=_,p;function L(O){const D=[];for(const z in O){const Q=O[z];delete Q.metadata,D.push(Q)}return D}}clone(e){return(new this.constructor).copy(this,e)}copy(e,c=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===c)for(let p=0;p<e.children.length;p++)this.add(e.children[p].clone());return this}}Ir.DefaultUp=new lt(0,1,0),Ir.DefaultMatrixAutoUpdate=!0,Ir.prototype.isObject3D=!0;const vc=new lt,Xs=new lt,$p=new lt,lr=new lt,El=new lt,Th=new lt,Kh=new lt,sa=new lt,wd=new lt,Ur=new lt;class eo{constructor(e=new lt,c=new lt,p=new lt){this.a=e,this.b=c,this.c=p}static getNormal(e,c,p,_){_.subVectors(p,c),vc.subVectors(e,c),_.cross(vc);const w=_.lengthSq();return w>0?_.multiplyScalar(1/Math.sqrt(w)):_.set(0,0,0)}static getBarycoord(e,c,p,_,w){vc.subVectors(_,c),Xs.subVectors(p,c),$p.subVectors(e,c);const L=vc.dot(vc),O=vc.dot(Xs),D=vc.dot($p),z=Xs.dot(Xs),Q=Xs.dot($p),ae=L*z-O*O;if(0===ae)return w.set(-2,-1,-1);const ie=1/ae,he=(z*D-O*Q)*ie,ye=(L*Q-O*D)*ie;return w.set(1-he-ye,ye,he)}static containsPoint(e,c,p,_){return this.getBarycoord(e,c,p,_,lr),lr.x>=0&&lr.y>=0&&lr.x+lr.y<=1}static getUV(e,c,p,_,w,L,O,D){return this.getBarycoord(e,c,p,_,lr),D.set(0,0),D.addScaledVector(w,lr.x),D.addScaledVector(L,lr.y),D.addScaledVector(O,lr.z),D}static isFrontFacing(e,c,p,_){return vc.subVectors(p,c),Xs.subVectors(e,c),vc.cross(Xs).dot(_)<0}set(e,c,p){return this.a.copy(e),this.b.copy(c),this.c.copy(p),this}setFromPointsAndIndices(e,c,p,_){return this.a.copy(e[c]),this.b.copy(e[p]),this.c.copy(e[_]),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return vc.subVectors(this.c,this.b),Xs.subVectors(this.a,this.b),.5*vc.cross(Xs).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(.3333333333333333)}getNormal(e){return eo.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,c){return eo.getBarycoord(e,this.a,this.b,this.c,c)}getUV(e,c,p,_,w){return eo.getUV(e,this.a,this.b,this.c,c,p,_,w)}containsPoint(e){return eo.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return eo.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,c){const p=this.a,_=this.b,w=this.c;let L,O;El.subVectors(_,p),Th.subVectors(w,p),sa.subVectors(e,p);const D=El.dot(sa),z=Th.dot(sa);if(D<=0&&z<=0)return c.copy(p);wd.subVectors(e,_);const Q=El.dot(wd),ae=Th.dot(wd);if(Q>=0&&ae<=Q)return c.copy(_);const ie=D*ae-Q*z;if(ie<=0&&D>=0&&Q<=0)return L=D/(D-Q),c.copy(p).addScaledVector(El,L);Ur.subVectors(e,w);const he=El.dot(Ur),ye=Th.dot(Ur);if(ye>=0&&he<=ye)return c.copy(w);const Me=he*z-D*ye;if(Me<=0&&z>=0&&ye<=0)return O=z/(z-ye),c.copy(p).addScaledVector(Th,O);const Ne=Q*ye-he*ae;if(Ne<=0&&ae-Q>=0&&he-ye>=0)return Kh.subVectors(w,_),O=(ae-Q)/(ae-Q+(he-ye)),c.copy(_).addScaledVector(Kh,O);const $e=1/(Ne+Me+ie);return L=Me*$e,O=ie*$e,c.copy(p).addScaledVector(El,L).addScaledVector(Th,O)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let Ro=0;class As extends Ps{constructor(){super(),Object.defineProperty(this,"id",{value:Ro++}),this.uuid=Ki(),this.name="",this.type="Material",this.fog=!0,this.blending=ee,this.side=_e,this.vertexColors=!1,this.opacity=1,this.format=lo,this.transparent=!1,this.blendSrc=Ft,this.blendDst=Ot,this.blendEquation=Ae,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=ur,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=na,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Ve,this.stencilZFail=Ve,this.stencilZPass=Ve,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(const c in e){const p=e[c];if(void 0===p){console.warn("THREE.Material: '"+c+"' parameter is undefined.");continue}if("shading"===c){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=p===T;continue}const _=this[c];void 0!==_?_&&_.isColor?_.set(p):_&&_.isVector3&&p&&p.isVector3?_.copy(p):this[c]=p:console.warn("THREE."+this.type+": '"+c+"' is not a property of this material.")}}toJSON(e){const c=void 0===e||"string"==typeof e;c&&(e={textures:{},images:{}});const p={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function _(w){const L=[];for(const O in w){const D=w[O];delete D.metadata,L.push(D)}return L}if(p.uuid=this.uuid,p.type=this.type,""!==this.name&&(p.name=this.name),this.color&&this.color.isColor&&(p.color=this.color.getHex()),void 0!==this.roughness&&(p.roughness=this.roughness),void 0!==this.metalness&&(p.metalness=this.metalness),this.sheenTint&&this.sheenTint.isColor&&(p.sheenTint=this.sheenTint.getHex()),this.emissive&&this.emissive.isColor&&(p.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(p.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(p.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(p.specularIntensity=this.specularIntensity),this.specularTint&&this.specularTint.isColor&&(p.specularTint=this.specularTint.getHex()),void 0!==this.shininess&&(p.shininess=this.shininess),void 0!==this.clearcoat&&(p.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(p.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(p.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(p.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(p.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,p.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(p.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(p.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(p.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(p.lightMap=this.lightMap.toJSON(e).uuid,p.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(p.aoMap=this.aoMap.toJSON(e).uuid,p.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(p.bumpMap=this.bumpMap.toJSON(e).uuid,p.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(p.normalMap=this.normalMap.toJSON(e).uuid,p.normalMapType=this.normalMapType,p.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(p.displacementMap=this.displacementMap.toJSON(e).uuid,p.displacementScale=this.displacementScale,p.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(p.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(p.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(p.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(p.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(p.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularTintMap&&this.specularTintMap.isTexture&&(p.specularTintMap=this.specularTintMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(p.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(p.combine=this.combine)),void 0!==this.envMapIntensity&&(p.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(p.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(p.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(p.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(p.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(p.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(p.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(p.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&(p.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationTint&&(p.attenuationTint=this.attenuationTint.getHex()),void 0!==this.size&&(p.size=this.size),null!==this.shadowSide&&(p.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(p.sizeAttenuation=this.sizeAttenuation),this.blending!==ee&&(p.blending=this.blending),this.side!==_e&&(p.side=this.side),this.vertexColors&&(p.vertexColors=!0),this.opacity<1&&(p.opacity=this.opacity),this.format!==lo&&(p.format=this.format),!0===this.transparent&&(p.transparent=this.transparent),p.depthFunc=this.depthFunc,p.depthTest=this.depthTest,p.depthWrite=this.depthWrite,p.colorWrite=this.colorWrite,p.stencilWrite=this.stencilWrite,p.stencilWriteMask=this.stencilWriteMask,p.stencilFunc=this.stencilFunc,p.stencilRef=this.stencilRef,p.stencilFuncMask=this.stencilFuncMask,p.stencilFail=this.stencilFail,p.stencilZFail=this.stencilZFail,p.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(p.rotation=this.rotation),!0===this.polygonOffset&&(p.polygonOffset=!0),0!==this.polygonOffsetFactor&&(p.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(p.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(p.linewidth=this.linewidth),void 0!==this.dashSize&&(p.dashSize=this.dashSize),void 0!==this.gapSize&&(p.gapSize=this.gapSize),void 0!==this.scale&&(p.scale=this.scale),!0===this.dithering&&(p.dithering=!0),this.alphaTest>0&&(p.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(p.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(p.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(p.wireframe=this.wireframe),this.wireframeLinewidth>1&&(p.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(p.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(p.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(p.flatShading=this.flatShading),!1===this.visible&&(p.visible=!1),!1===this.toneMapped&&(p.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(p.userData=this.userData),c){const w=_(e.textures),L=_(e.images);w.length>0&&(p.textures=w),L.length>0&&(p.images=L)}return p}clone(){return(new this.constructor).copy(this)}copy(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.format=e.format,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const c=e.clippingPlanes;let p=null;if(null!==c){const _=c.length;p=new Array(_);for(let w=0;w!==_;++w)p[w]=c[w].clone()}return this.clippingPlanes=p,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}As.prototype.isMaterial=!0;const Gr={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},tl={h:0,s:0,l:0},yc={h:0,s:0,l:0};function Qu(S,e,c){return c<0&&(c+=1),c>1&&(c-=1),c<.16666666666666666?S+6*(e-S)*c:c<.5?e:c<.6666666666666666?S+6*(e-S)*(.6666666666666666-c):S}function ep(S){return S<.04045?.0773993808*S:Math.pow(.9478672986*S+.0521327014,2.4)}function Tl(S){return S<.0031308?12.92*S:1.055*Math.pow(S,.41666)-.055}class tr{constructor(e,c,p){return void 0===c&&void 0===p?this.set(e):this.setRGB(e,c,p)}set(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this}setRGB(e,c,p){return this.r=e,this.g=c,this.b=p,this}setHSL(e,c,p){if(e=ui(e,1),c=jr(c,0,1),p=jr(p,0,1),0===c)this.r=this.g=this.b=p;else{const _=p<=.5?p*(1+c):p+c-p*c,w=2*p-_;this.r=Qu(w,_,e+.3333333333333333),this.g=Qu(w,_,e),this.b=Qu(w,_,e-.3333333333333333)}return this}setStyle(e){function c(_){void 0!==_&&parseFloat(_)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let p;if(p=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){let _;const L=p[2];switch(p[1]){case"rgb":case"rgba":if(_=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(L))return this.r=Math.min(255,parseInt(_[1],10))/255,this.g=Math.min(255,parseInt(_[2],10))/255,this.b=Math.min(255,parseInt(_[3],10))/255,c(_[4]),this;if(_=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(L))return this.r=Math.min(100,parseInt(_[1],10))/100,this.g=Math.min(100,parseInt(_[2],10))/100,this.b=Math.min(100,parseInt(_[3],10))/100,c(_[4]),this;break;case"hsl":case"hsla":if(_=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(L)){const O=parseFloat(_[1])/360,D=parseInt(_[2],10)/100,z=parseInt(_[3],10)/100;return c(_[4]),this.setHSL(O,D,z)}}}else if(p=/^\#([A-Fa-f\d]+)$/.exec(e)){const _=p[1],w=_.length;if(3===w)return this.r=parseInt(_.charAt(0)+_.charAt(0),16)/255,this.g=parseInt(_.charAt(1)+_.charAt(1),16)/255,this.b=parseInt(_.charAt(2)+_.charAt(2),16)/255,this;if(6===w)return this.r=parseInt(_.charAt(0)+_.charAt(1),16)/255,this.g=parseInt(_.charAt(2)+_.charAt(3),16)/255,this.b=parseInt(_.charAt(4)+_.charAt(5),16)/255,this}return e&&e.length>0?this.setColorName(e):this}setColorName(e){const c=Gr[e.toLowerCase()];return void 0!==c?this.setHex(c):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copyGammaToLinear(e,c=2){return this.r=Math.pow(e.r,c),this.g=Math.pow(e.g,c),this.b=Math.pow(e.b,c),this}copyLinearToGamma(e,c=2){const p=c>0?1/c:1;return this.r=Math.pow(e.r,p),this.g=Math.pow(e.g,p),this.b=Math.pow(e.b,p),this}convertGammaToLinear(e){return this.copyGammaToLinear(this,e),this}convertLinearToGamma(e){return this.copyLinearToGamma(this,e),this}copySRGBToLinear(e){return this.r=ep(e.r),this.g=ep(e.g),this.b=ep(e.b),this}copyLinearToSRGB(e){return this.r=Tl(e.r),this.g=Tl(e.g),this.b=Tl(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return 255*this.r<<16^255*this.g<<8^255*this.b}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(e){const c=this.r,p=this.g,_=this.b,w=Math.max(c,p,_),L=Math.min(c,p,_);let O,D;const z=(L+w)/2;if(L===w)O=0,D=0;else{const Q=w-L;switch(D=z<=.5?Q/(w+L):Q/(2-w-L),w){case c:O=(p-_)/Q+(p<_?6:0);break;case p:O=(_-c)/Q+2;break;case _:O=(c-p)/Q+4}O/=6}return e.h=O,e.s=D,e.l=z,e}getStyle(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}offsetHSL(e,c,p){return this.getHSL(tl),tl.h+=e,tl.s+=c,tl.l+=p,this.setHSL(tl.h,tl.s,tl.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,c){return this.r=e.r+c.r,this.g=e.g+c.g,this.b=e.b+c.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,c){return this.r+=(e.r-this.r)*c,this.g+=(e.g-this.g)*c,this.b+=(e.b-this.b)*c,this}lerpColors(e,c,p){return this.r=e.r+(c.r-e.r)*p,this.g=e.g+(c.g-e.g)*p,this.b=e.b+(c.b-e.b)*p,this}lerpHSL(e,c){this.getHSL(tl),e.getHSL(yc);const p=gi(tl.h,yc.h,c),_=gi(tl.s,yc.s,c),w=gi(tl.l,yc.l,c);return this.setHSL(p,_,w),this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,c=0){return this.r=e[c],this.g=e[c+1],this.b=e[c+2],this}toArray(e=[],c=0){return e[c]=this.r,e[c+1]=this.g,e[c+2]=this.b,e}fromBufferAttribute(e,c){return this.r=e.getX(c),this.g=e.getY(c),this.b=e.getZ(c),!0===e.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}tr.NAMES=Gr,tr.prototype.isColor=!0,tr.prototype.r=1,tr.prototype.g=1,tr.prototype.b=1;class nl extends As{constructor(e){super(),this.type="MeshBasicMaterial",this.color=new tr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Jr,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}nl.prototype.isMeshBasicMaterial=!0;const Fn=new lt,Ml=new Un;class zi{constructor(e,c,p){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=c,this.count=void 0!==e?e.length/c:0,this.normalized=!0===p,this.usage=_i,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this}copyAt(e,c,p){e*=this.itemSize,p*=c.itemSize;for(let _=0,w=this.itemSize;_<w;_++)this.array[e+_]=c.array[p+_];return this}copyArray(e){return this.array.set(e),this}copyColorsArray(e){const c=this.array;let p=0;for(let _=0,w=e.length;_<w;_++){let L=e[_];void 0===L&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",_),L=new tr),c[p++]=L.r,c[p++]=L.g,c[p++]=L.b}return this}copyVector2sArray(e){const c=this.array;let p=0;for(let _=0,w=e.length;_<w;_++){let L=e[_];void 0===L&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",_),L=new Un),c[p++]=L.x,c[p++]=L.y}return this}copyVector3sArray(e){const c=this.array;let p=0;for(let _=0,w=e.length;_<w;_++){let L=e[_];void 0===L&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",_),L=new lt),c[p++]=L.x,c[p++]=L.y,c[p++]=L.z}return this}copyVector4sArray(e){const c=this.array;let p=0;for(let _=0,w=e.length;_<w;_++){let L=e[_];void 0===L&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",_),L=new Hi),c[p++]=L.x,c[p++]=L.y,c[p++]=L.z,c[p++]=L.w}return this}applyMatrix3(e){if(2===this.itemSize)for(let c=0,p=this.count;c<p;c++)Ml.fromBufferAttribute(this,c),Ml.applyMatrix3(e),this.setXY(c,Ml.x,Ml.y);else if(3===this.itemSize)for(let c=0,p=this.count;c<p;c++)Fn.fromBufferAttribute(this,c),Fn.applyMatrix3(e),this.setXYZ(c,Fn.x,Fn.y,Fn.z);return this}applyMatrix4(e){for(let c=0,p=this.count;c<p;c++)Fn.x=this.getX(c),Fn.y=this.getY(c),Fn.z=this.getZ(c),Fn.applyMatrix4(e),this.setXYZ(c,Fn.x,Fn.y,Fn.z);return this}applyNormalMatrix(e){for(let c=0,p=this.count;c<p;c++)Fn.x=this.getX(c),Fn.y=this.getY(c),Fn.z=this.getZ(c),Fn.applyNormalMatrix(e),this.setXYZ(c,Fn.x,Fn.y,Fn.z);return this}transformDirection(e){for(let c=0,p=this.count;c<p;c++)Fn.x=this.getX(c),Fn.y=this.getY(c),Fn.z=this.getZ(c),Fn.transformDirection(e),this.setXYZ(c,Fn.x,Fn.y,Fn.z);return this}set(e,c=0){return this.array.set(e,c),this}getX(e){return this.array[e*this.itemSize]}setX(e,c){return this.array[e*this.itemSize]=c,this}getY(e){return this.array[e*this.itemSize+1]}setY(e,c){return this.array[e*this.itemSize+1]=c,this}getZ(e){return this.array[e*this.itemSize+2]}setZ(e,c){return this.array[e*this.itemSize+2]=c,this}getW(e){return this.array[e*this.itemSize+3]}setW(e,c){return this.array[e*this.itemSize+3]=c,this}setXY(e,c,p){return this.array[0+(e*=this.itemSize)]=c,this.array[e+1]=p,this}setXYZ(e,c,p,_){return this.array[0+(e*=this.itemSize)]=c,this.array[e+1]=p,this.array[e+2]=_,this}setXYZW(e,c,p,_,w){return this.array[0+(e*=this.itemSize)]=c,this.array[e+1]=p,this.array[e+2]=_,this.array[e+3]=w,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==_i&&(e.usage=this.usage),0===this.updateRange.offset&&-1===this.updateRange.count||(e.updateRange=this.updateRange),e}}zi.prototype.isBufferAttribute=!0;class jd extends zi{constructor(e,c,p){super(new Int8Array(e),c,p)}}class Cp extends zi{constructor(e,c,p){super(new Uint8Array(e),c,p)}}class xa extends zi{constructor(e,c,p){super(new Uint8ClampedArray(e),c,p)}}class Ku extends zi{constructor(e,c,p){super(new Int16Array(e),c,p)}}class eh extends zi{constructor(e,c,p){super(new Uint16Array(e),c,p)}}class wa extends zi{constructor(e,c,p){super(new Int32Array(e),c,p)}}class oi extends zi{constructor(e,c,p){super(new Uint32Array(e),c,p)}}class Yr extends zi{constructor(e,c,p){super(new Uint16Array(e),c,p)}}Yr.prototype.isFloat16BufferAttribute=!0;class dn extends zi{constructor(e,c,p){super(new Float32Array(e),c,p)}}class Gc extends zi{constructor(e,c,p){super(new Float64Array(e),c,p)}}function ai(S){if(0===S.length)return-1/0;let e=S[0];for(let c=1,p=S.length;c<p;++c)S[c]>e&&(e=S[c]);return e}const aa={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Fa(S,e){return new aa[S](e)}let Bn=0;const vi=new Qt,gs=new Ir,vs=new lt,$s=new Vi,ni=new Vi,Tr=new lt;class br extends Ps{constructor(){super(),Object.defineProperty(this,"id",{value:Bn++}),this.uuid=Ki(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return this.index=Array.isArray(e)?new(ai(e)>65535?oi:eh)(e,1):e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,c){return this.attributes[e]=c,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,c,p=0){this.groups.push({start:e,count:c,materialIndex:p})}clearGroups(){this.groups=[]}setDrawRange(e,c){this.drawRange.start=e,this.drawRange.count=c}applyMatrix4(e){const c=this.attributes.position;void 0!==c&&(c.applyMatrix4(e),c.needsUpdate=!0);const p=this.attributes.normal;if(void 0!==p){const w=(new ot).getNormalMatrix(e);p.applyNormalMatrix(w),p.needsUpdate=!0}const _=this.attributes.tangent;return void 0!==_&&(_.transformDirection(e),_.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return vi.makeRotationFromQuaternion(e),this.applyMatrix4(vi),this}rotateX(e){return vi.makeRotationX(e),this.applyMatrix4(vi),this}rotateY(e){return vi.makeRotationY(e),this.applyMatrix4(vi),this}rotateZ(e){return vi.makeRotationZ(e),this.applyMatrix4(vi),this}translate(e,c,p){return vi.makeTranslation(e,c,p),this.applyMatrix4(vi),this}scale(e,c,p){return vi.makeScale(e,c,p),this.applyMatrix4(vi),this}lookAt(e){return gs.lookAt(e),gs.updateMatrix(),this.applyMatrix4(gs.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(vs).negate(),this.translate(vs.x,vs.y,vs.z),this}setFromPoints(e){const c=[];for(let p=0,_=e.length;p<_;p++){const w=e[p];c.push(w.x,w.y,w.z||0)}return this.setAttribute("position",new dn(c,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Vi);const e=this.attributes.position,c=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new lt(-1/0,-1/0,-1/0),new lt(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),c)for(let p=0,_=c.length;p<_;p++)$s.setFromBufferAttribute(c[p]),this.morphTargetsRelative?(Tr.addVectors(this.boundingBox.min,$s.min),this.boundingBox.expandByPoint(Tr),Tr.addVectors(this.boundingBox.max,$s.max),this.boundingBox.expandByPoint(Tr)):(this.boundingBox.expandByPoint($s.min),this.boundingBox.expandByPoint($s.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new xo);const e=this.attributes.position,c=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new lt,1/0);if(e){const p=this.boundingSphere.center;if($s.setFromBufferAttribute(e),c)for(let w=0,L=c.length;w<L;w++)ni.setFromBufferAttribute(c[w]),this.morphTargetsRelative?(Tr.addVectors($s.min,ni.min),$s.expandByPoint(Tr),Tr.addVectors($s.max,ni.max),$s.expandByPoint(Tr)):($s.expandByPoint(ni.min),$s.expandByPoint(ni.max));$s.getCenter(p);let _=0;for(let w=0,L=e.count;w<L;w++)Tr.fromBufferAttribute(e,w),_=Math.max(_,p.distanceToSquared(Tr));if(c)for(let w=0,L=c.length;w<L;w++){const O=c[w],D=this.morphTargetsRelative;for(let z=0,Q=O.count;z<Q;z++)Tr.fromBufferAttribute(O,z),D&&(vs.fromBufferAttribute(e,z),Tr.add(vs)),_=Math.max(_,p.distanceToSquared(Tr))}this.boundingSphere.radius=Math.sqrt(_),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,c=this.attributes;if(null===e||void 0===c.position||void 0===c.normal||void 0===c.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const p=e.array,_=c.position.array,w=c.normal.array,L=c.uv.array,O=_.length/3;void 0===c.tangent&&this.setAttribute("tangent",new zi(new Float32Array(4*O),4));const D=c.tangent.array,z=[],Q=[];for(let Ht=0;Ht<O;Ht++)z[Ht]=new lt,Q[Ht]=new lt;const ae=new lt,ie=new lt,he=new lt,ye=new Un,Me=new Un,Ne=new Un,$e=new lt,ze=new lt;function Ye(Ht,Je,pt){ae.fromArray(_,3*Ht),ie.fromArray(_,3*Je),he.fromArray(_,3*pt),ye.fromArray(L,2*Ht),Me.fromArray(L,2*Je),Ne.fromArray(L,2*pt),ie.sub(ae),he.sub(ae),Me.sub(ye),Ne.sub(ye);const Vt=1/(Me.x*Ne.y-Ne.x*Me.y);isFinite(Vt)&&($e.copy(ie).multiplyScalar(Ne.y).addScaledVector(he,-Me.y).multiplyScalar(Vt),ze.copy(he).multiplyScalar(Me.x).addScaledVector(ie,-Ne.x).multiplyScalar(Vt),z[Ht].add($e),z[Je].add($e),z[pt].add($e),Q[Ht].add(ze),Q[Je].add(ze),Q[pt].add(ze))}let We=this.groups;0===We.length&&(We=[{start:0,count:p.length}]);for(let Ht=0,Je=We.length;Ht<Je;++Ht){const pt=We[Ht],Vt=pt.start;for(let Nt=Vt,ct=Vt+pt.count;Nt<ct;Nt+=3)Ye(p[Nt+0],p[Nt+1],p[Nt+2])}const nt=new lt,it=new lt,mt=new lt,xt=new lt;function Dt(Ht){mt.fromArray(w,3*Ht),xt.copy(mt);const Je=z[Ht];nt.copy(Je),nt.sub(mt.multiplyScalar(mt.dot(Je))).normalize(),it.crossVectors(xt,Je);const pt=it.dot(Q[Ht])<0?-1:1;D[4*Ht]=nt.x,D[4*Ht+1]=nt.y,D[4*Ht+2]=nt.z,D[4*Ht+3]=pt}for(let Ht=0,Je=We.length;Ht<Je;++Ht){const pt=We[Ht],Vt=pt.start;for(let Nt=Vt,ct=Vt+pt.count;Nt<ct;Nt+=3)Dt(p[Nt+0]),Dt(p[Nt+1]),Dt(p[Nt+2])}}computeVertexNormals(){const e=this.index,c=this.getAttribute("position");if(void 0!==c){let p=this.getAttribute("normal");if(void 0===p)p=new zi(new Float32Array(3*c.count),3),this.setAttribute("normal",p);else for(let ie=0,he=p.count;ie<he;ie++)p.setXYZ(ie,0,0,0);const _=new lt,w=new lt,L=new lt,O=new lt,D=new lt,z=new lt,Q=new lt,ae=new lt;if(e)for(let ie=0,he=e.count;ie<he;ie+=3){const ye=e.getX(ie+0),Me=e.getX(ie+1),Ne=e.getX(ie+2);_.fromBufferAttribute(c,ye),w.fromBufferAttribute(c,Me),L.fromBufferAttribute(c,Ne),Q.subVectors(L,w),ae.subVectors(_,w),Q.cross(ae),O.fromBufferAttribute(p,ye),D.fromBufferAttribute(p,Me),z.fromBufferAttribute(p,Ne),O.add(Q),D.add(Q),z.add(Q),p.setXYZ(ye,O.x,O.y,O.z),p.setXYZ(Me,D.x,D.y,D.z),p.setXYZ(Ne,z.x,z.y,z.z)}else for(let ie=0,he=c.count;ie<he;ie+=3)_.fromBufferAttribute(c,ie+0),w.fromBufferAttribute(c,ie+1),L.fromBufferAttribute(c,ie+2),Q.subVectors(L,w),ae.subVectors(_,w),Q.cross(ae),p.setXYZ(ie+0,Q.x,Q.y,Q.z),p.setXYZ(ie+1,Q.x,Q.y,Q.z),p.setXYZ(ie+2,Q.x,Q.y,Q.z);this.normalizeNormals(),p.needsUpdate=!0}}merge(e,c){if(!e||!e.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e);void 0===c&&(c=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const p=this.attributes;for(const _ in p){if(void 0===e.attributes[_])continue;const w=p[_].array,L=e.attributes[_],O=L.array,D=L.itemSize*c,z=Math.min(O.length,w.length-D);for(let Q=0,ae=D;Q<z;Q++,ae++)w[ae]=O[Q]}return this}normalizeNormals(){const e=this.attributes.normal;for(let c=0,p=e.count;c<p;c++)Tr.fromBufferAttribute(e,c),Tr.normalize(),e.setXYZ(c,Tr.x,Tr.y,Tr.z)}toNonIndexed(){function e(O,D){const z=O.array,Q=O.itemSize,ae=O.normalized,ie=new z.constructor(D.length*Q);let he=0,ye=0;for(let Me=0,Ne=D.length;Me<Ne;Me++){he=O.isInterleavedBufferAttribute?D[Me]*O.data.stride+O.offset:D[Me]*Q;for(let $e=0;$e<Q;$e++)ie[ye++]=z[he++]}return new zi(ie,Q,ae)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const c=new br,p=this.index.array,_=this.attributes;for(const O in _){const D=e(_[O],p);c.setAttribute(O,D)}const w=this.morphAttributes;for(const O in w){const D=[],z=w[O];for(let Q=0,ae=z.length;Q<ae;Q++){const ie=e(z[Q],p);D.push(ie)}c.morphAttributes[O]=D}c.morphTargetsRelative=this.morphTargetsRelative;const L=this.groups;for(let O=0,D=L.length;O<D;O++){const z=L[O];c.addGroup(z.start,z.count,z.materialIndex)}return c}toJSON(){const e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){const D=this.parameters;for(const z in D)void 0!==D[z]&&(e[z]=D[z]);return e}e.data={attributes:{}};const c=this.index;null!==c&&(e.data.index={type:c.array.constructor.name,array:Array.prototype.slice.call(c.array)});const p=this.attributes;for(const D in p)e.data.attributes[D]=p[D].toJSON(e.data);const _={};let w=!1;for(const D in this.morphAttributes){const z=this.morphAttributes[D],Q=[];for(let ae=0,ie=z.length;ae<ie;ae++)Q.push(z[ae].toJSON(e.data));Q.length>0&&(_[D]=Q,w=!0)}w&&(e.data.morphAttributes=_,e.data.morphTargetsRelative=this.morphTargetsRelative);const L=this.groups;L.length>0&&(e.data.groups=JSON.parse(JSON.stringify(L)));const O=this.boundingSphere;return null!==O&&(e.data.boundingSphere={center:O.center.toArray(),radius:O.radius}),e}clone(){return(new br).copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const c={};this.name=e.name;const p=e.index;null!==p&&this.setIndex(p.clone(c));const _=e.attributes;for(const z in _)this.setAttribute(z,_[z].clone(c));const w=e.morphAttributes;for(const z in w){const Q=[],ae=w[z];for(let ie=0,he=ae.length;ie<he;ie++)Q.push(ae[ie].clone(c));this.morphAttributes[z]=Q}this.morphTargetsRelative=e.morphTargetsRelative;const L=e.groups;for(let z=0,Q=L.length;z<Q;z++){const ae=L[z];this.addGroup(ae.start,ae.count,ae.materialIndex)}const O=e.boundingBox;null!==O&&(this.boundingBox=O.clone());const D=e.boundingSphere;return null!==D&&(this.boundingSphere=D.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}br.prototype.isBufferGeometry=!0;const rl=new Qt,bc=new _n,th=new xo,Da=new lt,ts=new lt,Bi=new lt,tp=new lt,Mh=new lt,np=new lt,fr=new lt,qo=new lt,il=new lt,Fr=new Un,Cs=new Un,nh=new Un,Hc=new lt,Ls=new lt;class Po extends Ir{constructor(e=new br,c=new nl){super(),this.type="Mesh",this.geometry=e,this.material=c,this.updateMorphTargets()}copy(e){return super.copy(e),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const c=e.morphAttributes,p=Object.keys(c);if(p.length>0){const _=c[p[0]];if(void 0!==_){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let w=0,L=_.length;w<L;w++){const O=_[w].name||String(w);this.morphTargetInfluences.push(0),this.morphTargetDictionary[O]=w}}}}else{const c=e.morphTargets;void 0!==c&&c.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(e,c){const p=this.geometry,_=this.material,w=this.matrixWorld;if(void 0===_||(null===p.boundingSphere&&p.computeBoundingSphere(),th.copy(p.boundingSphere),th.applyMatrix4(w),!1===e.ray.intersectsSphere(th))||(rl.copy(w).invert(),bc.copy(e.ray).applyMatrix4(rl),null!==p.boundingBox&&!1===bc.intersectsBox(p.boundingBox)))return;let L;if(p.isBufferGeometry){const O=p.index,D=p.attributes.position,z=p.morphAttributes.position,Q=p.morphTargetsRelative,ae=p.attributes.uv,ie=p.attributes.uv2,he=p.groups,ye=p.drawRange;if(null!==O)if(Array.isArray(_))for(let Me=0,Ne=he.length;Me<Ne;Me++){const $e=he[Me],ze=_[$e.materialIndex];for(let Ye=Math.max($e.start,ye.start),We=Math.min($e.start+$e.count,ye.start+ye.count);Ye<We;Ye+=3){const nt=O.getX(Ye),it=O.getX(Ye+1),mt=O.getX(Ye+2);L=rp(this,ze,e,bc,D,z,Q,ae,ie,nt,it,mt),L&&(L.faceIndex=Math.floor(Ye/3),L.face.materialIndex=$e.materialIndex,c.push(L))}}else for(let Me=Math.max(0,ye.start),Ne=Math.min(O.count,ye.start+ye.count);Me<Ne;Me+=3){const $e=O.getX(Me),ze=O.getX(Me+1),Ye=O.getX(Me+2);L=rp(this,_,e,bc,D,z,Q,ae,ie,$e,ze,Ye),L&&(L.faceIndex=Math.floor(Me/3),c.push(L))}else if(void 0!==D)if(Array.isArray(_))for(let Me=0,Ne=he.length;Me<Ne;Me++){const $e=he[Me],ze=_[$e.materialIndex];for(let Ye=Math.max($e.start,ye.start),We=Math.min($e.start+$e.count,ye.start+ye.count);Ye<We;Ye+=3)L=rp(this,ze,e,bc,D,z,Q,ae,ie,Ye,Ye+1,Ye+2),L&&(L.faceIndex=Math.floor(Ye/3),L.face.materialIndex=$e.materialIndex,c.push(L))}else for(let Me=Math.max(0,ye.start),Ne=Math.min(D.count,ye.start+ye.count);Me<Ne;Me+=3)L=rp(this,_,e,bc,D,z,Q,ae,ie,Me,Me+1,Me+2),L&&(L.faceIndex=Math.floor(Me/3),c.push(L))}else p.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}function rp(S,e,c,p,_,w,L,O,D,z,Q,ae){Da.fromBufferAttribute(_,z),ts.fromBufferAttribute(_,Q),Bi.fromBufferAttribute(_,ae);const ie=S.morphTargetInfluences;if(w&&ie){fr.set(0,0,0),qo.set(0,0,0),il.set(0,0,0);for(let ye=0,Me=w.length;ye<Me;ye++){const Ne=ie[ye],$e=w[ye];0!==Ne&&(tp.fromBufferAttribute($e,z),Mh.fromBufferAttribute($e,Q),np.fromBufferAttribute($e,ae),L?(fr.addScaledVector(tp,Ne),qo.addScaledVector(Mh,Ne),il.addScaledVector(np,Ne)):(fr.addScaledVector(tp.sub(Da),Ne),qo.addScaledVector(Mh.sub(ts),Ne),il.addScaledVector(np.sub(Bi),Ne)))}Da.add(fr),ts.add(qo),Bi.add(il)}S.isSkinnedMesh&&(S.boneTransform(z,Da),S.boneTransform(Q,ts),S.boneTransform(ae,Bi));const he=function(ye,Me,Ne,$e,ze,Ye,We,nt){let it;if(it=Me.side===le?$e.intersectTriangle(We,Ye,ze,!0,nt):$e.intersectTriangle(ze,Ye,We,Me.side!==pe,nt),null===it)return null;Ls.copy(nt),Ls.applyMatrix4(ye.matrixWorld);const mt=Ne.ray.origin.distanceTo(Ls);return mt<Ne.near||mt>Ne.far?null:{distance:mt,point:Ls.clone(),object:ye}}(S,e,c,p,Da,ts,Bi,Hc);if(he){O&&(Fr.fromBufferAttribute(O,z),Cs.fromBufferAttribute(O,Q),nh.fromBufferAttribute(O,ae),he.uv=eo.getUV(Hc,Da,ts,Bi,Fr,Cs,nh,new Un)),D&&(Fr.fromBufferAttribute(D,z),Cs.fromBufferAttribute(D,Q),nh.fromBufferAttribute(D,ae),he.uv2=eo.getUV(Hc,Da,ts,Bi,Fr,Cs,nh,new Un));const ye={a:z,b:Q,c:ae,normal:new lt,materialIndex:0};eo.getNormal(Da,ts,Bi,ye.normal),he.face=ye}return he}Po.prototype.isMesh=!0;class Wl extends br{constructor(e=1,c=1,p=1,_=1,w=1,L=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:c,depth:p,widthSegments:_,heightSegments:w,depthSegments:L};const O=this;_=Math.floor(_),w=Math.floor(w),L=Math.floor(L);const D=[],z=[],Q=[],ae=[];let ie=0,he=0;function ye(Me,Ne,$e,ze,Ye,We,nt,it,mt,xt,Dt){const Ht=We/mt,Je=nt/xt,pt=We/2,Vt=nt/2,Nt=it/2,ct=mt+1,Yt=xt+1;let St=0,jt=0;const It=new lt;for(let an=0;an<Yt;an++){const Ze=an*Je-Vt;for(let st=0;st<ct;st++)It[Me]=(st*Ht-pt)*ze,It[Ne]=Ze*Ye,It[$e]=Nt,z.push(It.x,It.y,It.z),It[Me]=0,It[Ne]=0,It[$e]=it>0?1:-1,Q.push(It.x,It.y,It.z),ae.push(st/mt),ae.push(1-an/xt),St+=1}for(let an=0;an<xt;an++)for(let Ze=0;Ze<mt;Ze++){const Rt=ie+Ze+ct*(an+1),Gt=ie+(Ze+1)+ct*(an+1),tn=ie+(Ze+1)+ct*an;D.push(ie+Ze+ct*an,Rt,tn),D.push(Rt,Gt,tn),jt+=6}O.addGroup(he,jt,Dt),he+=jt,ie+=St}ye("z","y","x",-1,-1,p,c,e,L,w,0),ye("z","y","x",1,-1,p,c,-e,L,w,1),ye("x","z","y",1,1,e,p,c,_,L,2),ye("x","z","y",1,-1,e,p,-c,_,L,3),ye("x","y","z",1,-1,e,c,p,_,w,4),ye("x","y","z",-1,-1,e,c,-p,_,w,5),this.setIndex(D),this.setAttribute("position",new dn(z,3)),this.setAttribute("normal",new dn(Q,3)),this.setAttribute("uv",new dn(ae,2))}static fromJSON(e){return new Wl(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function uo(S){const e={};for(const c in S){e[c]={};for(const p in S[c]){const _=S[c][p];e[c][p]=_&&(_.isColor||_.isMatrix3||_.isMatrix4||_.isVector2||_.isVector3||_.isVector4||_.isTexture||_.isQuaternion)?_.clone():Array.isArray(_)?_.slice():_}}return e}function Mi(S){const e={};for(let c=0;c<S.length;c++){const p=uo(S[c]);for(const _ in p)e[_]=p[_]}return e}const Bs={clone:uo,merge:Mi};class Ns extends As{constructor(e){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=uo(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const c=super.toJSON(e);c.glslVersion=this.glslVersion,c.uniforms={};for(const _ in this.uniforms){const w=this.uniforms[_].value;c.uniforms[_]=w&&w.isTexture?{type:"t",value:w.toJSON(e).uuid}:w&&w.isColor?{type:"c",value:w.getHex()}:w&&w.isVector2?{type:"v2",value:w.toArray()}:w&&w.isVector3?{type:"v3",value:w.toArray()}:w&&w.isVector4?{type:"v4",value:w.toArray()}:w&&w.isMatrix3?{type:"m3",value:w.toArray()}:w&&w.isMatrix4?{type:"m4",value:w.toArray()}:{value:w}}Object.keys(this.defines).length>0&&(c.defines=this.defines),c.vertexShader=this.vertexShader,c.fragmentShader=this.fragmentShader;const p={};for(const _ in this.extensions)!0===this.extensions[_]&&(p[_]=!0);return Object.keys(p).length>0&&(c.extensions=p),c}}Ns.prototype.isShaderMaterial=!0;class Al extends Ir{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new Qt,this.projectionMatrix=new Qt,this.projectionMatrixInverse=new Qt}copy(e,c){return super.copy(e,c),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const c=this.matrixWorld.elements;return e.set(-c[8],-c[9],-c[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,c){super.updateWorldMatrix(e,c),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}Al.prototype.isCamera=!0;class Io extends Al{constructor(e=50,c=1,p=.1,_=2e3){super(),this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=p,this.far=_,this.focus=10,this.aspect=c,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,c){return super.copy(e,c),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const c=.5*this.getFilmHeight()/e;this.fov=2*as*Math.atan(c),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(.5*jo*this.fov);return.5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*as*Math.atan(Math.tan(.5*jo*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,c,p,_,w,L){this.aspect=e/c,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=c,this.view.offsetX=p,this.view.offsetY=_,this.view.width=w,this.view.height=L,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let c=e*Math.tan(.5*jo*this.fov)/this.zoom,p=2*c,_=this.aspect*p,w=-.5*_;const L=this.view;if(null!==this.view&&this.view.enabled){const D=L.fullWidth,z=L.fullHeight;w+=L.offsetX*_/D,c-=L.offsetY*p/z,_*=L.width/D,p*=L.height/z}const O=this.filmOffset;0!==O&&(w+=e*O/this.getFilmWidth()),this.projectionMatrix.makePerspective(w,w+_,c,c-p,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const c=super.toJSON(e);return c.object.fov=this.fov,c.object.zoom=this.zoom,c.object.near=this.near,c.object.far=this.far,c.object.focus=this.focus,c.object.aspect=this.aspect,null!==this.view&&(c.object.view=Object.assign({},this.view)),c.object.filmGauge=this.filmGauge,c.object.filmOffset=this.filmOffset,c}}Io.prototype.isPerspectiveCamera=!0;class ol extends Ir{constructor(e,c,p){if(super(),this.type="CubeCamera",!0!==p.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=p;const _=new Io(90,1,e,c);_.layers=this.layers,_.up.set(0,-1,0),_.lookAt(new lt(1,0,0)),this.add(_);const w=new Io(90,1,e,c);w.layers=this.layers,w.up.set(0,-1,0),w.lookAt(new lt(-1,0,0)),this.add(w);const L=new Io(90,1,e,c);L.layers=this.layers,L.up.set(0,0,1),L.lookAt(new lt(0,1,0)),this.add(L);const O=new Io(90,1,e,c);O.layers=this.layers,O.up.set(0,0,-1),O.lookAt(new lt(0,-1,0)),this.add(O);const D=new Io(90,1,e,c);D.layers=this.layers,D.up.set(0,-1,0),D.lookAt(new lt(0,0,1)),this.add(D);const z=new Io(90,1,e,c);z.layers=this.layers,z.up.set(0,-1,0),z.lookAt(new lt(0,0,-1)),this.add(z)}update(e,c){null===this.parent&&this.updateMatrixWorld();const p=this.renderTarget,[_,w,L,O,D,z]=this.children,Q=e.xr.enabled,ae=e.getRenderTarget();e.xr.enabled=!1;const ie=p.texture.generateMipmaps;p.texture.generateMipmaps=!1,e.setRenderTarget(p,0),e.render(c,_),e.setRenderTarget(p,1),e.render(c,w),e.setRenderTarget(p,2),e.render(c,L),e.setRenderTarget(p,3),e.render(c,O),e.setRenderTarget(p,4),e.render(c,D),p.texture.generateMipmaps=ie,e.setRenderTarget(p,5),e.render(c,z),e.setRenderTarget(ae),e.xr.enabled=Q}}class ql extends Ms{constructor(e,c,p,_,w,L,O,D,z,Q){super(e=void 0!==e?e:[],c=void 0!==c?c:bi,p,_,w,L,O=void 0!==O?O:Rs,D,z,Q),this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}ql.prototype.isCubeTexture=!0;class xc extends io{constructor(e,c,p){Number.isInteger(c)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),c=p),super(e,e,c),this.texture=new ql(void 0,(c=c||{}).mapping,c.wrapS,c.wrapT,c.magFilter,c.minFilter,c.format,c.type,c.anisotropy,c.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==c.generateMipmaps&&c.generateMipmaps,this.texture.minFilter=void 0!==c.minFilter?c.minFilter:ii,this.texture._needsFlipEnvMap=!1}fromEquirectangularTexture(e,c){this.texture.type=c.type,this.texture.format=lo,this.texture.encoding=c.encoding,this.texture.generateMipmaps=c.generateMipmaps,this.texture.minFilter=c.minFilter,this.texture.magFilter=c.magFilter;const L=new Wl(5,5,5),O=new Ns({name:"CubemapFromEquirect",uniforms:uo({tEquirect:{value:null}}),vertexShader:"\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",side:le,blending:q});O.uniforms.tEquirect.value=c;const D=new Po(L,O),z=c.minFilter;return c.minFilter===Ya&&(c.minFilter=ii),new ol(1,10,this).update(e,D),c.minFilter=z,D.geometry.dispose(),D.material.dispose(),this}clear(e,c,p,_){const w=e.getRenderTarget();for(let L=0;L<6;L++)e.setRenderTarget(this,L),e.clear(c,p,_);e.setRenderTarget(w)}}xc.prototype.isWebGLCubeRenderTarget=!0;const Vc=new lt,pr=new lt,Lp=new ot;class Sa{constructor(e=new lt(1,0,0),c=0){this.normal=e,this.constant=c}set(e,c){return this.normal.copy(e),this.constant=c,this}setComponents(e,c,p,_){return this.normal.set(e,c,p),this.constant=_,this}setFromNormalAndCoplanarPoint(e,c){return this.normal.copy(e),this.constant=-c.dot(this.normal),this}setFromCoplanarPoints(e,c,p){const _=Vc.subVectors(p,c).cross(pr.subVectors(e,c)).normalize();return this.setFromNormalAndCoplanarPoint(_,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,c){return c.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}intersectLine(e,c){const p=e.delta(Vc),_=this.normal.dot(p);if(0===_)return 0===this.distanceToPoint(e.start)?c.copy(e.start):null;const w=-(e.start.dot(this.normal)+this.constant)/_;return w<0||w>1?null:c.copy(p).multiplyScalar(w).add(e.start)}intersectsLine(e){const c=this.distanceToPoint(e.start),p=this.distanceToPoint(e.end);return c<0&&p>0||p<0&&c>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,c){const p=c||Lp.getNormalMatrix(e),_=this.coplanarPoint(Vc).applyMatrix4(e),w=this.normal.applyMatrix3(p).normalize();return this.constant=-_.dot(w),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return(new this.constructor).copy(this)}}Sa.prototype.isPlane=!0;const Ua=new xo,Cl=new lt;class Dr{constructor(e=new Sa,c=new Sa,p=new Sa,_=new Sa,w=new Sa,L=new Sa){this.planes=[e,c,p,_,w,L]}set(e,c,p,_,w,L){const O=this.planes;return O[0].copy(e),O[1].copy(c),O[2].copy(p),O[3].copy(_),O[4].copy(w),O[5].copy(L),this}copy(e){const c=this.planes;for(let p=0;p<6;p++)c[p].copy(e.planes[p]);return this}setFromProjectionMatrix(e){const c=this.planes,p=e.elements,_=p[0],w=p[1],L=p[2],O=p[3],D=p[4],z=p[5],Q=p[6],ae=p[7],ie=p[8],he=p[9],ye=p[10],Me=p[11],Ne=p[12],$e=p[13],ze=p[14],Ye=p[15];return c[0].setComponents(O-_,ae-D,Me-ie,Ye-Ne).normalize(),c[1].setComponents(O+_,ae+D,Me+ie,Ye+Ne).normalize(),c[2].setComponents(O+w,ae+z,Me+he,Ye+$e).normalize(),c[3].setComponents(O-w,ae-z,Me-he,Ye-$e).normalize(),c[4].setComponents(O-L,ae-Q,Me-ye,Ye-ze).normalize(),c[5].setComponents(O+L,ae+Q,Me+ye,Ye+ze).normalize(),this}intersectsObject(e){const c=e.geometry;return null===c.boundingSphere&&c.computeBoundingSphere(),Ua.copy(c.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Ua)}intersectsSprite(e){return Ua.center.set(0,0,0),Ua.radius=.7071067811865476,Ua.applyMatrix4(e.matrixWorld),this.intersectsSphere(Ua)}intersectsSphere(e){const c=this.planes,p=e.center,_=-e.radius;for(let w=0;w<6;w++)if(c[w].distanceToPoint(p)<_)return!1;return!0}intersectsBox(e){const c=this.planes;for(let p=0;p<6;p++){const _=c[p];if(Cl.x=_.normal.x>0?e.max.x:e.min.x,Cl.y=_.normal.y>0?e.max.y:e.min.y,Cl.z=_.normal.z>0?e.max.z:e.min.z,_.distanceToPoint(Cl)<0)return!1}return!0}containsPoint(e){const c=this.planes;for(let p=0;p<6;p++)if(c[p].distanceToPoint(e)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function wc(){let S=null,e=!1,c=null,p=null;function _(w,L){c(w,L),p=S.requestAnimationFrame(_)}return{start:function(){!0!==e&&null!==c&&(p=S.requestAnimationFrame(_),e=!0)},stop:function(){S.cancelAnimationFrame(p),e=!1},setAnimationLoop:function(w){c=w},setContext:function(w){S=w}}}function ed(S,e){const c=e.isWebGL2,p=new WeakMap;return{get:function(_){return _.isInterleavedBufferAttribute&&(_=_.data),p.get(_)},remove:function(_){_.isInterleavedBufferAttribute&&(_=_.data);const w=p.get(_);w&&(S.deleteBuffer(w.buffer),p.delete(_))},update:function(_,w){if(_.isGLBufferAttribute){const O=p.get(_);return void((!O||O.version<_.version)&&p.set(_,{buffer:_.buffer,type:_.type,bytesPerElement:_.elementSize,version:_.version}))}_.isInterleavedBufferAttribute&&(_=_.data);const L=p.get(_);void 0===L?p.set(_,function(O,D){const z=O.array,Q=O.usage,ae=S.createBuffer();S.bindBuffer(D,ae),S.bufferData(D,z,Q),O.onUploadCallback();let ie=5126;return z instanceof Float32Array?ie=5126:z instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):z instanceof Uint16Array?O.isFloat16BufferAttribute?c?ie=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):ie=5123:z instanceof Int16Array?ie=5122:z instanceof Uint32Array?ie=5125:z instanceof Int32Array?ie=5124:z instanceof Int8Array?ie=5120:(z instanceof Uint8Array||z instanceof Uint8ClampedArray)&&(ie=5121),{buffer:ae,type:ie,bytesPerElement:z.BYTES_PER_ELEMENT,version:O.version}}(_,w)):L.version<_.version&&(function(O,D,z){const Q=D.array,ae=D.updateRange;S.bindBuffer(z,O),-1===ae.count?S.bufferSubData(z,0,Q):(c?S.bufferSubData(z,ae.offset*Q.BYTES_PER_ELEMENT,Q,ae.offset,ae.count):S.bufferSubData(z,ae.offset*Q.BYTES_PER_ELEMENT,Q.subarray(ae.offset,ae.offset+ae.count)),ae.count=-1)}(L.buffer,_,w),L.version=_.version)}}}class Su extends br{constructor(e=1,c=1,p=1,_=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:c,widthSegments:p,heightSegments:_};const w=e/2,L=c/2,O=Math.floor(p),D=Math.floor(_),z=O+1,Q=D+1,ae=e/O,ie=c/D,he=[],ye=[],Me=[],Ne=[];for(let $e=0;$e<Q;$e++){const ze=$e*ie-L;for(let Ye=0;Ye<z;Ye++)ye.push(Ye*ae-w,-ze,0),Me.push(0,0,1),Ne.push(Ye/O),Ne.push(1-$e/D)}for(let $e=0;$e<D;$e++)for(let ze=0;ze<O;ze++){const We=ze+z*($e+1),nt=ze+1+z*($e+1),it=ze+1+z*$e;he.push(ze+z*$e,We,it),he.push(We,nt,it)}this.setIndex(he),this.setAttribute("position",new dn(ye,3)),this.setAttribute("normal",new dn(Me,3)),this.setAttribute("uv",new dn(Ne,2))}static fromJSON(e){return new Su(e.width,e.height,e.widthSegments,e.heightSegments)}}const li={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotVH = saturate( dot( geometry.viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float NoH ) {\n\tfloat invAlpha = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float NoV, float NoL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( NoL + NoV - NoL * NoV ) ) );\n}\nvec3 BRDF_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );\n\t\tvec2 f = fract( uv );\n\t\tuv += 0.5 - f;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t}\n\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\t\tuv *= texelSize;\n\t\tvec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x += texelSize;\n\t\tvec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.y += texelSize;\n\t\tvec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x -= texelSize;\n\t\tvec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tvec3 tm = mix( tl, tr, f.x );\n\t\tvec3 bm = mix( bl, br, f.x );\n\t\treturn mix( tm, bm, f.y );\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value ) {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getIBLIrradiance( const in GeometricContext geometry ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec;\n\t\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\t\treflectVec = reflect( - viewDir, normal );\n\t\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\t#else\n\t\t\t\treflectVec = refract( - viewDir, normal, refractionRatio );\n\t\t\t#endif\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tlightMapIrradiance *= PI;\n\t#endif\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularTintFactor = specularTint;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARTINTMAP\n\t\t\tspecularTintFactor *= specularTintMapTexelToLinear( texture2D( specularTintMap, vUv ) ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularTintFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularTintFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenTint = sheenTint;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenTint;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\tvec3 FssEss = specularColor * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += irradiance * BRDF_Sheen( material.roughness, directLight.direction, geometry, material.sheenTint );\n\t#else\n\t\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\t\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\t\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tfloat transmissionAlpha = 1.0;\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationTint, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\n\ttransmissionAlpha = transmission.a;\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationTint;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( vec3 n, vec3 v, float thickness, float ior, mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( float roughness, float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( vec2 fragCoord, float roughness, float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( vec3 radiance, float transmissionDistance, vec3 attenuationColor, float attenuationDistance ) {\n\t\tif ( attenuationDistance == 0.0 ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( vec3 n, vec3 v, float roughness, vec3 diffuseColor, vec3 specularColor, float specularF90,\n\t\tvec3 position, mat4 modelMatrix, mat4 viewMatrix, mat4 projMatrix, float ior, float thickness,\n\t\tvec3 attenuationColor, float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularTint;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARTINTMAP\n\t\tuniform sampler2D specularTintMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenTint;\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - clearcoat * Fcc ) + clearcoatSpecular * clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},ar={common:{diffuse:{value:new tr(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new ot},uv2Transform:{value:new ot},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Un(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new tr(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new tr(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new ot}},sprite:{diffuse:{value:new tr(16777215)},opacity:{value:1},center:{value:new Un(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new ot}}},Ll={basic:{uniforms:Mi([ar.common,ar.specularmap,ar.envmap,ar.aomap,ar.lightmap,ar.fog]),vertexShader:li.meshbasic_vert,fragmentShader:li.meshbasic_frag},lambert:{uniforms:Mi([ar.common,ar.specularmap,ar.envmap,ar.aomap,ar.lightmap,ar.emissivemap,ar.fog,ar.lights,{emissive:{value:new tr(0)}}]),vertexShader:li.meshlambert_vert,fragmentShader:li.meshlambert_frag},phong:{uniforms:Mi([ar.common,ar.specularmap,ar.envmap,ar.aomap,ar.lightmap,ar.emissivemap,ar.bumpmap,ar.normalmap,ar.displacementmap,ar.fog,ar.lights,{emissive:{value:new tr(0)},specular:{value:new tr(1118481)},shininess:{value:30}}]),vertexShader:li.meshphong_vert,fragmentShader:li.meshphong_frag},standard:{uniforms:Mi([ar.common,ar.envmap,ar.aomap,ar.lightmap,ar.emissivemap,ar.bumpmap,ar.normalmap,ar.displacementmap,ar.roughnessmap,ar.metalnessmap,ar.fog,ar.lights,{emissive:{value:new tr(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:li.meshphysical_vert,fragmentShader:li.meshphysical_frag},toon:{uniforms:Mi([ar.common,ar.aomap,ar.lightmap,ar.emissivemap,ar.bumpmap,ar.normalmap,ar.displacementmap,ar.gradientmap,ar.fog,ar.lights,{emissive:{value:new tr(0)}}]),vertexShader:li.meshtoon_vert,fragmentShader:li.meshtoon_frag},matcap:{uniforms:Mi([ar.common,ar.bumpmap,ar.normalmap,ar.displacementmap,ar.fog,{matcap:{value:null}}]),vertexShader:li.meshmatcap_vert,fragmentShader:li.meshmatcap_frag},points:{uniforms:Mi([ar.points,ar.fog]),vertexShader:li.points_vert,fragmentShader:li.points_frag},dashed:{uniforms:Mi([ar.common,ar.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:li.linedashed_vert,fragmentShader:li.linedashed_frag},depth:{uniforms:Mi([ar.common,ar.displacementmap]),vertexShader:li.depth_vert,fragmentShader:li.depth_frag},normal:{uniforms:Mi([ar.common,ar.bumpmap,ar.normalmap,ar.displacementmap,{opacity:{value:1}}]),vertexShader:li.meshnormal_vert,fragmentShader:li.meshnormal_frag},sprite:{uniforms:Mi([ar.sprite,ar.fog]),vertexShader:li.sprite_vert,fragmentShader:li.sprite_frag},background:{uniforms:{uvTransform:{value:new ot},t2D:{value:null}},vertexShader:li.background_vert,fragmentShader:li.background_frag},cube:{uniforms:Mi([ar.envmap,{opacity:{value:1}}]),vertexShader:li.cube_vert,fragmentShader:li.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:li.equirect_vert,fragmentShader:li.equirect_frag},distanceRGBA:{uniforms:Mi([ar.common,ar.displacementmap,{referencePosition:{value:new lt},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:li.distanceRGBA_vert,fragmentShader:li.distanceRGBA_frag},shadow:{uniforms:Mi([ar.lights,ar.fog,{color:{value:new tr(0)},opacity:{value:1}}]),vertexShader:li.shadow_vert,fragmentShader:li.shadow_frag}};function Wc(S,e,c,p,_){const w=new tr(0);let L,O,D=0,z=null,Q=0,ae=null;function ie(he,ye){c.buffers.color.setClear(he.r,he.g,he.b,ye,_)}return{getClearColor:function(){return w},setClearColor:function(he,ye=1){w.set(he),D=ye,ie(w,D)},getClearAlpha:function(){return D},setClearAlpha:function(he){D=he,ie(w,D)},render:function(he,ye){let Me=!1,Ne=!0===ye.isScene?ye.background:null;Ne&&Ne.isTexture&&(Ne=e.get(Ne));const $e=S.xr,ze=$e.getSession&&$e.getSession();ze&&"additive"===ze.environmentBlendMode&&(Ne=null),null===Ne?ie(w,D):Ne&&Ne.isColor&&(ie(Ne,1),Me=!0),(S.autoClear||Me)&&S.clear(S.autoClearColor,S.autoClearDepth,S.autoClearStencil),Ne&&(Ne.isCubeTexture||Ne.mapping===Di)?(void 0===O&&(O=new Po(new Wl(1,1,1),new Ns({name:"BackgroundCubeMaterial",uniforms:uo(Ll.cube.uniforms),vertexShader:Ll.cube.vertexShader,fragmentShader:Ll.cube.fragmentShader,side:le,depthTest:!1,depthWrite:!1,fog:!1})),O.geometry.deleteAttribute("normal"),O.geometry.deleteAttribute("uv"),O.onBeforeRender=function(Ye,We,nt){this.matrixWorld.copyPosition(nt.matrixWorld)},Object.defineProperty(O.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),p.update(O)),O.material.uniforms.envMap.value=Ne,O.material.uniforms.flipEnvMap.value=Ne.isCubeTexture&&!1===Ne.isRenderTargetTexture?-1:1,z===Ne&&Q===Ne.version&&ae===S.toneMapping||(O.material.needsUpdate=!0,z=Ne,Q=Ne.version,ae=S.toneMapping),he.unshift(O,O.geometry,O.material,0,0,null)):Ne&&Ne.isTexture&&(void 0===L&&(L=new Po(new Su(2,2),new Ns({name:"BackgroundMaterial",uniforms:uo(Ll.background.uniforms),vertexShader:Ll.background.vertexShader,fragmentShader:Ll.background.fragmentShader,side:_e,depthTest:!1,depthWrite:!1,fog:!1})),L.geometry.deleteAttribute("normal"),Object.defineProperty(L.material,"map",{get:function(){return this.uniforms.t2D.value}}),p.update(L)),L.material.uniforms.t2D.value=Ne,!0===Ne.matrixAutoUpdate&&Ne.updateMatrix(),L.material.uniforms.uvTransform.value.copy(Ne.matrix),z===Ne&&Q===Ne.version&&ae===S.toneMapping||(L.material.needsUpdate=!0,z=Ne,Q=Ne.version,ae=S.toneMapping),he.unshift(L,L.geometry,L.material,0,0,null))}}}function Mo(S,e,c,p){const _=S.getParameter(34921),w=p.isWebGL2?null:e.get("OES_vertex_array_object"),L=p.isWebGL2||null!==w,O={},D=ie(null);let z=D;function Q(We){return p.isWebGL2?S.bindVertexArray(We):w.bindVertexArrayOES(We)}function ae(We){return p.isWebGL2?S.deleteVertexArray(We):w.deleteVertexArrayOES(We)}function ie(We){const nt=[],it=[],mt=[];for(let xt=0;xt<_;xt++)nt[xt]=0,it[xt]=0,mt[xt]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:nt,enabledAttributes:it,attributeDivisors:mt,object:We,attributes:{},index:null}}function he(){const We=z.newAttributes;for(let nt=0,it=We.length;nt<it;nt++)We[nt]=0}function ye(We){Me(We,0)}function Me(We,nt){const mt=z.enabledAttributes,xt=z.attributeDivisors;z.newAttributes[We]=1,0===mt[We]&&(S.enableVertexAttribArray(We),mt[We]=1),xt[We]!==nt&&((p.isWebGL2?S:e.get("ANGLE_instanced_arrays"))[p.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](We,nt),xt[We]=nt)}function Ne(){const We=z.newAttributes,nt=z.enabledAttributes;for(let it=0,mt=nt.length;it<mt;it++)nt[it]!==We[it]&&(S.disableVertexAttribArray(it),nt[it]=0)}function $e(We,nt,it,mt,xt,Dt){!0!==p.isWebGL2||5124!==it&&5125!==it?S.vertexAttribPointer(We,nt,it,mt,xt,Dt):S.vertexAttribIPointer(We,nt,it,xt,Dt)}function ze(){Ye(),z!==D&&(z=D,Q(z.object))}function Ye(){D.geometry=null,D.program=null,D.wireframe=!1}return{setup:function(We,nt,it,mt,xt){let Dt=!1;if(L){const Ht=function(Je,pt,Vt){const Nt=!0===Vt.wireframe;let ct=O[Je.id];void 0===ct&&(ct={},O[Je.id]=ct);let Yt=ct[pt.id];void 0===Yt&&(Yt={},ct[pt.id]=Yt);let St=Yt[Nt];return void 0===St&&(St=ie(p.isWebGL2?S.createVertexArray():w.createVertexArrayOES()),Yt[Nt]=St),St}(mt,it,nt);z!==Ht&&(z=Ht,Q(z.object)),Dt=function(Je,pt){const Vt=z.attributes,Nt=Je.attributes;let ct=0;for(const Yt in Nt){const St=Vt[Yt],jt=Nt[Yt];if(void 0===St||St.attribute!==jt||St.data!==jt.data)return!0;ct++}return z.attributesNum!==ct||z.index!==pt}(mt,xt),Dt&&function(Je,pt){const Vt={},Nt=Je.attributes;let ct=0;for(const Yt in Nt){const St=Nt[Yt],jt={};jt.attribute=St,St.data&&(jt.data=St.data),Vt[Yt]=jt,ct++}z.attributes=Vt,z.attributesNum=ct,z.index=pt}(mt,xt)}else{const Ht=!0===nt.wireframe;z.geometry===mt.id&&z.program===it.id&&z.wireframe===Ht||(z.geometry=mt.id,z.program=it.id,z.wireframe=Ht,Dt=!0)}!0===We.isInstancedMesh&&(Dt=!0),null!==xt&&c.update(xt,34963),Dt&&(function(Ht,Je,pt,Vt){if(!1===p.isWebGL2&&(Ht.isInstancedMesh||Vt.isInstancedBufferGeometry)&&null===e.get("ANGLE_instanced_arrays"))return;he();const Nt=Vt.attributes,ct=pt.getAttributes(),Yt=Je.defaultAttributeValues;for(const St in ct){const jt=ct[St];if(jt.location>=0){let It=Nt[St];if(void 0===It&&("instanceMatrix"===St&&Ht.instanceMatrix&&(It=Ht.instanceMatrix),"instanceColor"===St&&Ht.instanceColor&&(It=Ht.instanceColor)),void 0!==It){const an=It.normalized,Ze=It.itemSize,st=c.get(It);if(void 0===st)continue;const Rt=st.buffer,Gt=st.type,tn=st.bytesPerElement;if(It.isInterleavedBufferAttribute){const En=It.data,Zn=En.stride,qn=It.offset;if(En&&En.isInstancedInterleavedBuffer){for(let on=0;on<jt.locationSize;on++)Me(jt.location+on,En.meshPerAttribute);!0!==Ht.isInstancedMesh&&void 0===Vt._maxInstanceCount&&(Vt._maxInstanceCount=En.meshPerAttribute*En.count)}else for(let on=0;on<jt.locationSize;on++)ye(jt.location+on);S.bindBuffer(34962,Rt);for(let on=0;on<jt.locationSize;on++)$e(jt.location+on,Ze/jt.locationSize,Gt,an,Zn*tn,(qn+Ze/jt.locationSize*on)*tn)}else{if(It.isInstancedBufferAttribute){for(let En=0;En<jt.locationSize;En++)Me(jt.location+En,It.meshPerAttribute);!0!==Ht.isInstancedMesh&&void 0===Vt._maxInstanceCount&&(Vt._maxInstanceCount=It.meshPerAttribute*It.count)}else for(let En=0;En<jt.locationSize;En++)ye(jt.location+En);S.bindBuffer(34962,Rt);for(let En=0;En<jt.locationSize;En++)$e(jt.location+En,Ze/jt.locationSize,Gt,an,Ze*tn,Ze/jt.locationSize*En*tn)}}else if(void 0!==Yt){const an=Yt[St];if(void 0!==an)switch(an.length){case 2:S.vertexAttrib2fv(jt.location,an);break;case 3:S.vertexAttrib3fv(jt.location,an);break;case 4:S.vertexAttrib4fv(jt.location,an);break;default:S.vertexAttrib1fv(jt.location,an)}}}}Ne()}(We,nt,it,mt),null!==xt&&S.bindBuffer(34963,c.get(xt).buffer))},reset:ze,resetDefaultState:Ye,dispose:function(){ze();for(const We in O){const nt=O[We];for(const it in nt){const mt=nt[it];for(const xt in mt)ae(mt[xt].object),delete mt[xt];delete nt[it]}delete O[We]}},releaseStatesOfGeometry:function(We){if(void 0===O[We.id])return;const nt=O[We.id];for(const it in nt){const mt=nt[it];for(const xt in mt)ae(mt[xt].object),delete mt[xt];delete nt[it]}delete O[We.id]},releaseStatesOfProgram:function(We){for(const nt in O){const it=O[nt];if(void 0===it[We.id])continue;const mt=it[We.id];for(const xt in mt)ae(mt[xt].object),delete mt[xt];delete it[We.id]}},initAttributes:he,enableAttribute:ye,disableUnusedAttributes:Ne}}function Xn(S,e,c,p){const _=p.isWebGL2;let w;this.setMode=function(L){w=L},this.render=function(L,O){S.drawArrays(w,L,O),c.update(O,w,1)},this.renderInstances=function(L,O,D){if(0===D)return;let z,Q;if(_)z=S,Q="drawArraysInstanced";else if(z=e.get("ANGLE_instanced_arrays"),Q="drawArraysInstancedANGLE",null===z)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");z[Q](w,L,O,D),c.update(O,w,D)}}function qc(S,e,c){let p;function _(We){if("highp"===We){if(S.getShaderPrecisionFormat(35633,36338).precision>0&&S.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";We="mediump"}return"mediump"===We&&S.getShaderPrecisionFormat(35633,36337).precision>0&&S.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const w=typeof WebGL2RenderingContext<"u"&&S instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&S instanceof WebGL2ComputeRenderingContext;let L=void 0!==c.precision?c.precision:"highp";const O=_(L);O!==L&&(console.warn("THREE.WebGLRenderer:",L,"not supported, using",O,"instead."),L=O);const D=w||e.has("WEBGL_draw_buffers"),z=!0===c.logarithmicDepthBuffer,Q=S.getParameter(34930),ae=S.getParameter(35660),ie=S.getParameter(3379),he=S.getParameter(34076),ye=S.getParameter(34921),Me=S.getParameter(36347),Ne=S.getParameter(36348),$e=S.getParameter(36349),ze=ae>0,Ye=w||e.has("OES_texture_float");return{isWebGL2:w,drawBuffers:D,getMaxAnisotropy:function(){if(void 0!==p)return p;if(!0===e.has("EXT_texture_filter_anisotropic")){const We=e.get("EXT_texture_filter_anisotropic");p=S.getParameter(We.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else p=0;return p},getMaxPrecision:_,precision:L,logarithmicDepthBuffer:z,maxTextures:Q,maxVertexTextures:ae,maxTextureSize:ie,maxCubemapSize:he,maxAttributes:ye,maxVertexUniforms:Me,maxVaryings:Ne,maxFragmentUniforms:$e,vertexTextures:ze,floatFragmentTextures:Ye,floatVertexTextures:ze&&Ye,maxSamples:w?S.getParameter(36183):0}}function Eu(S){const e=this;let c=null,p=0,_=!1,w=!1;const L=new Sa,O=new ot,D={value:null,needsUpdate:!1};function z(){D.value!==c&&(D.value=c,D.needsUpdate=p>0),e.numPlanes=p,e.numIntersection=0}function Q(ae,ie,he,ye){const Me=null!==ae?ae.length:0;let Ne=null;if(0!==Me){if(Ne=D.value,!0!==ye||null===Ne){const $e=he+4*Me,ze=ie.matrixWorldInverse;O.getNormalMatrix(ze),(null===Ne||Ne.length<$e)&&(Ne=new Float32Array($e));for(let Ye=0,We=he;Ye!==Me;++Ye,We+=4)L.copy(ae[Ye]).applyMatrix4(ze,O),L.normal.toArray(Ne,We),Ne[We+3]=L.constant}D.value=Ne,D.needsUpdate=!0}return e.numPlanes=Me,e.numIntersection=0,Ne}this.uniform=D,this.numPlanes=0,this.numIntersection=0,this.init=function(ae,ie,he){const ye=0!==ae.length||ie||0!==p||_;return _=ie,c=Q(ae,he,0),p=ae.length,ye},this.beginShadows=function(){w=!0,Q(null)},this.endShadows=function(){w=!1,z()},this.setState=function(ae,ie,he){const ye=ae.clippingPlanes,Me=ae.clipIntersection,Ne=ae.clipShadows,$e=S.get(ae);if(!_||null===ye||0===ye.length||w&&!Ne)w?Q(null):z();else{const ze=w?0:p,Ye=4*ze;let We=$e.clippingState||null;D.value=We,We=Q(ye,ie,Ye,he);for(let nt=0;nt!==Ye;++nt)We[nt]=c[nt];$e.clippingState=We,this.numIntersection=Me?this.numPlanes:0,this.numPlanes+=ze}}}function sl(S){let e=new WeakMap;function c(_,w){return w===Gs?_.mapping=bi:w===Ks&&(_.mapping=So),_}function p(_){const w=_.target;w.removeEventListener("dispose",p);const L=e.get(w);void 0!==L&&(e.delete(w),L.dispose())}return{get:function(_){if(_&&_.isTexture&&!1===_.isRenderTargetTexture){const w=_.mapping;if(w===Gs||w===Ks){if(e.has(_))return c(e.get(_).texture,_.mapping);{const L=_.image;if(L&&L.height>0){const O=S.getRenderTarget(),D=new xc(L.height/2);return D.fromEquirectangularTexture(S,_),e.set(_,D),S.setRenderTarget(O),_.addEventListener("dispose",p),c(D.texture,_.mapping)}return null}}}return _},dispose:function(){e=new WeakMap}}}Ll.physical={uniforms:Mi([Ll.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Un(1,1)},clearcoatNormalMap:{value:null},sheenTint:{value:new tr(0)},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new Un},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationTint:{value:new tr(0)},specularIntensity:{value:0},specularIntensityMap:{value:null},specularTint:{value:new tr(1,1,1)},specularTintMap:{value:null}}]),vertexShader:li.meshphysical_vert,fragmentShader:li.meshphysical_frag};class Xl extends Al{constructor(e=-1,c=1,p=1,_=-1,w=.1,L=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=c,this.top=p,this.bottom=_,this.near=w,this.far=L,this.updateProjectionMatrix()}copy(e,c){return super.copy(e,c),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,c,p,_,w,L){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=c,this.view.offsetX=p,this.view.offsetY=_,this.view.width=w,this.view.height=L,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),c=(this.top-this.bottom)/(2*this.zoom),p=(this.right+this.left)/2,_=(this.top+this.bottom)/2;let w=p-e,L=p+e,O=_+c,D=_-c;if(null!==this.view&&this.view.enabled){const z=(this.right-this.left)/this.view.fullWidth/this.zoom,Q=(this.top-this.bottom)/this.view.fullHeight/this.zoom;w+=z*this.view.offsetX,L=w+z*this.view.width,O-=Q*this.view.offsetY,D=O-Q*this.view.height}this.projectionMatrix.makeOrthographic(w,L,O,D,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const c=super.toJSON(e);return c.object.zoom=this.zoom,c.object.left=this.left,c.object.right=this.right,c.object.top=this.top,c.object.bottom=this.bottom,c.object.near=this.near,c.object.far=this.far,null!==this.view&&(c.object.view=Object.assign({},this.view)),c}}Xl.prototype.isOrthographicCamera=!0;class Tu extends Ns{constructor(e){super(e),this.type="RawShaderMaterial"}}Tu.prototype.isRawShaderMaterial=!0;const ls=Math.pow(2,8),za=[.125,.215,.35,.446,.526,.582],Mu=5+za.length,Ea={[Qi]:0,[Ka]:1,[Uc]:2,[cc]:3,[Ju]:4,[gu]:5,[Gl]:6},td=new Xl,{_lodPlanes:Bp,_sizeLods:ip,_sigmas:Xc}=function xe(){const S=[],e=[],c=[];let p=8;for(let _=0;_<Mu;_++){const w=Math.pow(2,p);e.push(w);let L=1/w;_>4?L=za[_-8+4-1]:0==_&&(L=0),c.push(L);const O=1/(w-1),D=-O/2,z=1+O/2,Q=[D,D,z,D,z,z,D,D,z,z,D,z],ae=6,ie=6,he=3,ye=2,Me=1,Ne=new Float32Array(he*ie*ae),$e=new Float32Array(ye*ie*ae),ze=new Float32Array(Me*ie*ae);for(let We=0;We<ae;We++){const nt=We%3*2/3-1,it=We>2?0:-1;Ne.set([nt,it,0,nt+2/3,it,0,nt+2/3,it+1,0,nt,it,0,nt+2/3,it+1,0,nt,it+1,0],he*ie*We),$e.set(Q,ye*ie*We),ze.set([We,We,We,We,We,We],Me*ie*We)}const Ye=new br;Ye.setAttribute("position",new zi(Ne,he)),Ye.setAttribute("uv",new zi($e,ye)),Ye.setAttribute("faceIndex",new zi(ze,Me)),S.push(Ye),p>4&&p--}return{_lodPlanes:S,_sizeLods:e,_sigmas:c}}(),rh=new tr;let ll=null;const Sc=(1+Math.sqrt(5))/2,ys=1/Sc,Ie=[new lt(1,1,1),new lt(-1,1,1),new lt(1,1,-1),new lt(-1,1,-1),new lt(0,Sc,ys),new lt(0,Sc,-ys),new lt(ys,0,Sc),new lt(-ys,0,Sc),new lt(Sc,ys,0),new lt(-Sc,ys,0)];class je{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._blurMaterial=function(){const c=new Float32Array(20),p=new lt(0,1,0);return new Tu({name:"SphericalGaussianBlur",defines:{n:20},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:c},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:p},inputEncoding:{value:Ea[Qi]},outputEncoding:{value:Ea[Qi]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:q,depthTest:!1,depthWrite:!1})}(),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}fromScene(e,c=0,p=.1,_=100){ll=this._renderer.getRenderTarget();const w=this._allocateTargets();return this._sceneToCubeUV(e,p,_,w),c>0&&this._blur(w,0,0,c),this._applyPMREM(w),this._cleanup(w),w}fromEquirectangular(e){return this._fromTexture(e)}fromCubemap(e){return this._fromTexture(e)}compileCubemapShader(){null===this._cubemapShader&&(this._cubemapShader=Pt(),this._compileMaterial(this._cubemapShader))}compileEquirectangularShader(){null===this._equirectShader&&(this._equirectShader=yt(),this._compileMaterial(this._equirectShader))}dispose(){this._blurMaterial.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(let e=0;e<Bp.length;e++)Bp[e].dispose()}_cleanup(e){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(ll),e.scissorTest=!1,Xe(e,0,0,e.width,e.height)}_fromTexture(e){ll=this._renderer.getRenderTarget();const c=this._allocateTargets(e);return this._textureToCubeUV(e,c),this._applyPMREM(c),this._cleanup(c),c}_allocateTargets(e){const c={magFilter:Or,minFilter:Or,generateMipmaps:!1,type:ea,format:gh,encoding:(S=e,void 0===S||S.type!==ea||S.encoding!==Qi&&S.encoding!==Ka&&S.encoding!==Gl?Uc:e.encoding),depthBuffer:!1},p=Ue(c);var S;return p.depthBuffer=!e,this._pingPongRenderTarget=Ue(c),p}_compileMaterial(e){const c=new Po(Bp[0],e);this._renderer.compile(c,td)}_sceneToCubeUV(e,c,p,_){const w=new Io(90,1,c,p),L=[1,-1,1,1,1,1],O=[1,1,1,-1,-1,-1],D=this._renderer,z=D.autoClear,Q=D.outputEncoding,ae=D.toneMapping;D.getClearColor(rh),D.toneMapping=vr,D.outputEncoding=Qi,D.autoClear=!1;const ie=new nl({name:"PMREM.Background",side:le,depthWrite:!1,depthTest:!1}),he=new Po(new Wl,ie);let ye=!1;const Me=e.background;Me?Me.isColor&&(ie.color.copy(Me),e.background=null,ye=!0):(ie.color.copy(rh),ye=!0);for(let Ne=0;Ne<6;Ne++){const $e=Ne%3;0==$e?(w.up.set(0,L[Ne],0),w.lookAt(O[Ne],0,0)):1==$e?(w.up.set(0,0,L[Ne]),w.lookAt(0,O[Ne],0)):(w.up.set(0,L[Ne],0),w.lookAt(0,0,O[Ne])),Xe(_,$e*ls,Ne>2?ls:0,ls,ls),D.setRenderTarget(_),ye&&D.render(he,w),D.render(e,w)}he.geometry.dispose(),he.material.dispose(),D.toneMapping=ae,D.outputEncoding=Q,D.autoClear=z,e.background=Me}_textureToCubeUV(e,c){const p=this._renderer;e.isCubeTexture?null==this._cubemapShader&&(this._cubemapShader=Pt()):null==this._equirectShader&&(this._equirectShader=yt());const _=e.isCubeTexture?this._cubemapShader:this._equirectShader,w=new Po(Bp[0],_),L=_.uniforms;L.envMap.value=e,e.isCubeTexture||L.texelSize.value.set(1/e.image.width,1/e.image.height),L.inputEncoding.value=Ea[e.encoding],L.outputEncoding.value=Ea[c.texture.encoding],Xe(c,0,0,3*ls,2*ls),p.setRenderTarget(c),p.render(w,td)}_applyPMREM(e){const c=this._renderer,p=c.autoClear;c.autoClear=!1;for(let _=1;_<Mu;_++){const w=Math.sqrt(Xc[_]*Xc[_]-Xc[_-1]*Xc[_-1]);this._blur(e,_-1,_,w,Ie[(_-1)%Ie.length])}c.autoClear=p}_blur(e,c,p,_,w){const L=this._pingPongRenderTarget;this._halfBlur(e,L,c,p,_,"latitudinal",w),this._halfBlur(L,e,p,p,_,"longitudinal",w)}_halfBlur(e,c,p,_,w,L,O){const D=this._renderer,z=this._blurMaterial;"latitudinal"!==L&&"longitudinal"!==L&&console.error("blur direction must be either latitudinal or longitudinal!");const Q=new Po(Bp[_],z),ae=z.uniforms,ie=ip[p]-1,he=isFinite(w)?Math.PI/(2*ie):2*Math.PI/39,ye=w/he,Me=isFinite(w)?1+Math.floor(3*ye):20;Me>20&&console.warn(`sigmaRadians, ${w}, is too large and will clip, as it requested ${Me} samples when the maximum is set to 20`);const Ne=[];let $e=0;for(let Ye=0;Ye<20;++Ye){const We=Ye/ye,nt=Math.exp(-We*We/2);Ne.push(nt),0==Ye?$e+=nt:Ye<Me&&($e+=2*nt)}for(let Ye=0;Ye<Ne.length;Ye++)Ne[Ye]=Ne[Ye]/$e;ae.envMap.value=e.texture,ae.samples.value=Me,ae.weights.value=Ne,ae.latitudinal.value="latitudinal"===L,O&&(ae.poleAxis.value=O),ae.dTheta.value=he,ae.mipInt.value=8-p,ae.inputEncoding.value=Ea[e.texture.encoding],ae.outputEncoding.value=Ea[e.texture.encoding];const ze=ip[_];Xe(c,3*Math.max(0,ls-2*ze),(0===_?0:2*ls)+2*ze*(_>4?_-8+4:0),3*ze,2*ze),D.setRenderTarget(c),D.render(Q,td)}}function Ue(S){const e=new io(3*ls,3*ls,S);return e.texture.mapping=Di,e.texture.name="PMREM.cubeUv",e.scissorTest=!0,e}function Xe(S,e,c,p,_){S.viewport.set(e,c,p,_),S.scissor.set(e,c,p,_)}function yt(){const S=new Un(1,1);return new Tu({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:S},inputEncoding:{value:Ea[Qi]},outputEncoding:{value:Ea[Qi]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tvec2 f = fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -= f * texelSize;\n\t\t\t\tvec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x += texelSize.x;\n\t\t\t\tvec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.y += texelSize.y;\n\t\t\t\tvec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x -= texelSize.x;\n\t\t\t\tvec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\n\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb = mix( tm, bm, f.y );\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:q,depthTest:!1,depthWrite:!1})}function Pt(){return new Tu({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:Ea[Qi]},outputEncoding:{value:Ea[Qi]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:q,depthTest:!1,depthWrite:!1})}function Jt(S){let e=new WeakMap,c=null;function p(_){const w=_.target;w.removeEventListener("dispose",p);const L=e.get(w);void 0!==L&&(e.delete(w),L.dispose())}return{get:function(_){if(_&&_.isTexture&&!1===_.isRenderTargetTexture){const w=_.mapping,L=w===Gs||w===Ks,O=w===bi||w===So;if(L||O){if(e.has(_))return e.get(_).texture;{const D=_.image;if(L&&D&&D.height>0||O&&D&&function(z){let Q=0;for(let ae=0;ae<6;ae++)void 0!==z[ae]&&Q++;return 6===Q}(D)){const z=S.getRenderTarget();null===c&&(c=new je(S));const Q=L?c.fromEquirectangular(_):c.fromCubemap(_);return e.set(_,Q),S.setRenderTarget(z),_.addEventListener("dispose",p),Q.texture}return null}}}return _},dispose:function(){e=new WeakMap,null!==c&&(c.dispose(),c=null)}}}function An(S){const e={};function c(p){if(void 0!==e[p])return e[p];let _;switch(p){case"WEBGL_depth_texture":_=S.getExtension("WEBGL_depth_texture")||S.getExtension("MOZ_WEBGL_depth_texture")||S.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":_=S.getExtension("EXT_texture_filter_anisotropic")||S.getExtension("MOZ_EXT_texture_filter_anisotropic")||S.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":_=S.getExtension("WEBGL_compressed_texture_s3tc")||S.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||S.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":_=S.getExtension("WEBGL_compressed_texture_pvrtc")||S.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:_=S.getExtension(p)}return e[p]=_,_}return{has:function(p){return null!==c(p)},init:function(p){p.isWebGL2?c("EXT_color_buffer_float"):(c("WEBGL_depth_texture"),c("OES_texture_float"),c("OES_texture_half_float"),c("OES_texture_half_float_linear"),c("OES_standard_derivatives"),c("OES_element_index_uint"),c("OES_vertex_array_object"),c("ANGLE_instanced_arrays")),c("OES_texture_float_linear"),c("EXT_color_buffer_half_float")},get:function(p){const _=c(p);return null===_&&console.warn("THREE.WebGLRenderer: "+p+" extension not supported."),_}}}function Wn(S,e,c,p){const _={},w=new WeakMap;function L(D){const z=D.target;null!==z.index&&e.remove(z.index);for(const ae in z.attributes)e.remove(z.attributes[ae]);z.removeEventListener("dispose",L),delete _[z.id];const Q=w.get(z);Q&&(e.remove(Q),w.delete(z)),p.releaseStatesOfGeometry(z),!0===z.isInstancedBufferGeometry&&delete z._maxInstanceCount,c.memory.geometries--}function O(D){const z=[],Q=D.index,ae=D.attributes.position;let ie=0;if(null!==Q){const Me=Q.array;ie=Q.version;for(let Ne=0,$e=Me.length;Ne<$e;Ne+=3){const ze=Me[Ne+0],Ye=Me[Ne+1],We=Me[Ne+2];z.push(ze,Ye,Ye,We,We,ze)}}else{ie=ae.version;for(let Ne=0,$e=ae.array.length/3-1;Ne<$e;Ne+=3){const ze=Ne+0,Ye=Ne+1,We=Ne+2;z.push(ze,Ye,Ye,We,We,ze)}}const he=new(ai(z)>65535?oi:eh)(z,1);he.version=ie;const ye=w.get(D);ye&&e.remove(ye),w.set(D,he)}return{get:function(D,z){return!0===_[z.id]||(z.addEventListener("dispose",L),_[z.id]=!0,c.memory.geometries++),z},update:function(D){const z=D.attributes;for(const ae in z)e.update(z[ae],34962);const Q=D.morphAttributes;for(const ae in Q){const ie=Q[ae];for(let he=0,ye=ie.length;he<ye;he++)e.update(ie[he],34962)}},getWireframeAttribute:function(D){const z=w.get(D);if(z){const Q=D.index;null!==Q&&z.version<Q.version&&O(D)}else O(D);return w.get(D)}}}function Dn(S,e,c,p){const _=p.isWebGL2;let w,L,O;this.setMode=function(D){w=D},this.setIndex=function(D){L=D.type,O=D.bytesPerElement},this.render=function(D,z){S.drawElements(w,z,L,D*O),c.update(z,w,1)},this.renderInstances=function(D,z,Q){if(0===Q)return;let ae,ie;if(_)ae=S,ie="drawElementsInstanced";else if(ae=e.get("ANGLE_instanced_arrays"),ie="drawElementsInstancedANGLE",null===ae)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");ae[ie](w,z,L,D*O,Q),c.update(z,w,Q)}}function cr(S){const e={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:e,programs:null,autoReset:!0,reset:function(){e.frame++,e.calls=0,e.triangles=0,e.points=0,e.lines=0},update:function(c,p,_){switch(e.calls++,p){case 4:e.triangles+=_*(c/3);break;case 1:e.lines+=_*(c/2);break;case 3:e.lines+=_*(c-1);break;case 2:e.lines+=_*c;break;case 0:e.points+=_*c;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",p)}}}}function Pr(S,e){return S[0]-e[0]}function Gn(S,e){return Math.abs(e[1])-Math.abs(S[1])}function Zi(S){const e={},c=new Float32Array(8),p=[];for(let _=0;_<8;_++)p[_]=[_,0];return{update:function(_,w,L,O){const D=_.morphTargetInfluences,z=void 0===D?0:D.length;let Q=e[w.id];if(void 0===Q||Q.length!==z){Q=[];for(let Me=0;Me<z;Me++)Q[Me]=[Me,0];e[w.id]=Q}for(let Me=0;Me<z;Me++){const Ne=Q[Me];Ne[0]=Me,Ne[1]=D[Me]}Q.sort(Gn);for(let Me=0;Me<8;Me++)Me<z&&Q[Me][1]?(p[Me][0]=Q[Me][0],p[Me][1]=Q[Me][1]):(p[Me][0]=Number.MAX_SAFE_INTEGER,p[Me][1]=0);p.sort(Pr);const ae=w.morphAttributes.position,ie=w.morphAttributes.normal;let he=0;for(let Me=0;Me<8;Me++){const Ne=p[Me],$e=Ne[0],ze=Ne[1];$e!==Number.MAX_SAFE_INTEGER&&ze?(ae&&w.getAttribute("morphTarget"+Me)!==ae[$e]&&w.setAttribute("morphTarget"+Me,ae[$e]),ie&&w.getAttribute("morphNormal"+Me)!==ie[$e]&&w.setAttribute("morphNormal"+Me,ie[$e]),c[Me]=ze,he+=ze):(ae&&!0===w.hasAttribute("morphTarget"+Me)&&w.deleteAttribute("morphTarget"+Me),ie&&!0===w.hasAttribute("morphNormal"+Me)&&w.deleteAttribute("morphNormal"+Me),c[Me]=0)}const ye=w.morphTargetsRelative?1:1-he;O.getUniforms().setValue(S,"morphTargetBaseInfluence",ye),O.getUniforms().setValue(S,"morphTargetInfluences",c)}}}function Bl(S,e,c,p){let _=new WeakMap;function w(L){const O=L.target;O.removeEventListener("dispose",w),c.remove(O.instanceMatrix),null!==O.instanceColor&&c.remove(O.instanceColor)}return{update:function(L){const O=p.render.frame,z=e.get(L,L.geometry);return _.get(z)!==O&&(e.update(z),_.set(z,O)),L.isInstancedMesh&&(!1===L.hasEventListener("dispose",w)&&L.addEventListener("dispose",w),c.update(L.instanceMatrix,34962),null!==L.instanceColor&&c.update(L.instanceColor,34962)),z},dispose:function(){_=new WeakMap}}}class Nl extends Ms{constructor(e=null,c=1,p=1,_=1){super(null),this.image={data:e,width:c,height:p,depth:_},this.magFilter=Or,this.minFilter=Or,this.wrapR=Xr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}Nl.prototype.isDataTexture2DArray=!0;class ns extends Ms{constructor(e=null,c=1,p=1,_=1){super(null),this.image={data:e,width:c,height:p,depth:_},this.magFilter=Or,this.minFilter=Or,this.wrapR=Xr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}ns.prototype.isDataTexture3D=!0;const ln=new Ms,cl=new Nl,Gd=new ns,Mf=new ql,xi=[],Ln=[],Yf=new Float32Array(16),Jf=new Float32Array(9),gr=new Float32Array(4);function Np(S,e,c){const p=S[0];if(p<=0||p>0)return S;const _=e*c;let w=xi[_];if(void 0===w&&(w=new Float32Array(_),xi[_]=w),0!==e){p.toArray(w,0);for(let L=1,O=0;L!==e;++L)O+=c,S[L].toArray(w,O)}return w}function ul(S,e){if(S.length!==e.length)return!1;for(let c=0,p=S.length;c<p;c++)if(S[c]!==e[c])return!1;return!0}function hl(S,e){for(let c=0,p=e.length;c<p;c++)S[c]=e[c]}function Au(S,e){let c=Ln[e];void 0===c&&(c=new Int32Array(e),Ln[e]=c);for(let p=0;p!==e;++p)c[p]=S.allocateTextureUnit();return c}function Zf(S,e){const c=this.cache;c[0]!==e&&(S.uniform1f(this.addr,e),c[0]=e)}function Ta(S,e){const c=this.cache;if(void 0!==e.x)c[0]===e.x&&c[1]===e.y||(S.uniform2f(this.addr,e.x,e.y),c[0]=e.x,c[1]=e.y);else{if(ul(c,e))return;S.uniform2fv(this.addr,e),hl(c,e)}}function ih(S,e){const c=this.cache;if(void 0!==e.x)c[0]===e.x&&c[1]===e.y&&c[2]===e.z||(S.uniform3f(this.addr,e.x,e.y,e.z),c[0]=e.x,c[1]=e.y,c[2]=e.z);else if(void 0!==e.r)c[0]===e.r&&c[1]===e.g&&c[2]===e.b||(S.uniform3f(this.addr,e.r,e.g,e.b),c[0]=e.r,c[1]=e.g,c[2]=e.b);else{if(ul(c,e))return;S.uniform3fv(this.addr,e),hl(c,e)}}function oh(S,e){const c=this.cache;if(void 0!==e.x)c[0]===e.x&&c[1]===e.y&&c[2]===e.z&&c[3]===e.w||(S.uniform4f(this.addr,e.x,e.y,e.z,e.w),c[0]=e.x,c[1]=e.y,c[2]=e.z,c[3]=e.w);else{if(ul(c,e))return;S.uniform4fv(this.addr,e),hl(c,e)}}function Hd(S,e){const c=this.cache,p=e.elements;if(void 0===p){if(ul(c,e))return;S.uniformMatrix2fv(this.addr,!1,e),hl(c,e)}else{if(ul(c,p))return;gr.set(p),S.uniformMatrix2fv(this.addr,!1,gr),hl(c,p)}}function cf(S,e){const c=this.cache,p=e.elements;if(void 0===p){if(ul(c,e))return;S.uniformMatrix3fv(this.addr,!1,e),hl(c,e)}else{if(ul(c,p))return;Jf.set(p),S.uniformMatrix3fv(this.addr,!1,Jf),hl(c,p)}}function $m(S,e){const c=this.cache,p=e.elements;if(void 0===p){if(ul(c,e))return;S.uniformMatrix4fv(this.addr,!1,e),hl(c,e)}else{if(ul(c,p))return;Yf.set(p),S.uniformMatrix4fv(this.addr,!1,Yf),hl(c,p)}}function Rp(S,e){const c=this.cache;c[0]!==e&&(S.uniform1i(this.addr,e),c[0]=e)}function Qf(S,e){const c=this.cache;ul(c,e)||(S.uniform2iv(this.addr,e),hl(c,e))}function Cm(S,e){const c=this.cache;ul(c,e)||(S.uniform3iv(this.addr,e),hl(c,e))}function Kf(S,e){const c=this.cache;ul(c,e)||(S.uniform4iv(this.addr,e),hl(c,e))}function em(S,e){const c=this.cache;c[0]!==e&&(S.uniform1ui(this.addr,e),c[0]=e)}function Vd(S,e){const c=this.cache;ul(c,e)||(S.uniform2uiv(this.addr,e),hl(c,e))}function Lm(S,e){const c=this.cache;ul(c,e)||(S.uniform3uiv(this.addr,e),hl(c,e))}function Bm(S,e){const c=this.cache;ul(c,e)||(S.uniform4uiv(this.addr,e),hl(c,e))}function Wd(S,e,c){const p=this.cache,_=c.allocateTextureUnit();p[0]!==_&&(S.uniform1i(this.addr,_),p[0]=_),c.safeSetTexture2D(e||ln,_)}function tm(S,e,c){const p=this.cache,_=c.allocateTextureUnit();p[0]!==_&&(S.uniform1i(this.addr,_),p[0]=_),c.setTexture3D(e||Gd,_)}function nm(S,e,c){const p=this.cache,_=c.allocateTextureUnit();p[0]!==_&&(S.uniform1i(this.addr,_),p[0]=_),c.safeSetTextureCube(e||Mf,_)}function Nm(S,e,c){const p=this.cache,_=c.allocateTextureUnit();p[0]!==_&&(S.uniform1i(this.addr,_),p[0]=_),c.setTexture2DArray(e||cl,_)}function Af(S,e){S.uniform1fv(this.addr,e)}function qd(S,e){const c=Np(e,this.size,2);S.uniform2fv(this.addr,c)}function Rm(S,e){const c=Np(e,this.size,3);S.uniform3fv(this.addr,c)}function Xd(S,e){const c=Np(e,this.size,4);S.uniform4fv(this.addr,c)}function Pp(S,e){const c=Np(e,this.size,4);S.uniformMatrix2fv(this.addr,!1,c)}function Pm(S,e){const c=Np(e,this.size,9);S.uniformMatrix3fv(this.addr,!1,c)}function rm(S,e){const c=Np(e,this.size,16);S.uniformMatrix4fv(this.addr,!1,c)}function im(S,e){S.uniform1iv(this.addr,e)}function Im(S,e){S.uniform2iv(this.addr,e)}function Om(S,e){S.uniform3iv(this.addr,e)}function uf(S,e){S.uniform4iv(this.addr,e)}function km(S,e){S.uniform1uiv(this.addr,e)}function Fm(S,e){S.uniform2uiv(this.addr,e)}function Yl(S,e){S.uniform3uiv(this.addr,e)}function $f(S,e){S.uniform4uiv(this.addr,e)}function om(S,e,c){const p=e.length,_=Au(c,p);S.uniform1iv(this.addr,_);for(let w=0;w!==p;++w)c.safeSetTexture2D(e[w]||ln,_[w])}function sm(S,e,c){const p=e.length,_=Au(c,p);S.uniform1iv(this.addr,_);for(let w=0;w!==p;++w)c.safeSetTextureCube(e[w]||Mf,_[w])}function Cf(S,e,c){this.id=S,this.addr=c,this.cache=[],this.setValue=function(p){switch(p){case 5126:return Zf;case 35664:return Ta;case 35665:return ih;case 35666:return oh;case 35674:return Hd;case 35675:return cf;case 35676:return $m;case 5124:case 35670:return Rp;case 35667:case 35671:return Qf;case 35668:case 35672:return Cm;case 35669:case 35673:return Kf;case 5125:return em;case 36294:return Vd;case 36295:return Lm;case 36296:return Bm;case 35678:case 36198:case 36298:case 36306:case 35682:return Wd;case 35679:case 36299:case 36307:return tm;case 35680:case 36300:case 36308:case 36293:return nm;case 36289:case 36303:case 36311:case 36292:return Nm}}(e.type)}function am(S,e,c){this.id=S,this.addr=c,this.cache=[],this.size=e.size,this.setValue=function(p){switch(p){case 5126:return Af;case 35664:return qd;case 35665:return Rm;case 35666:return Xd;case 35674:return Pp;case 35675:return Pm;case 35676:return rm;case 5124:case 35670:return im;case 35667:case 35671:return Im;case 35668:case 35672:return Om;case 35669:case 35673:return uf;case 5125:return km;case 36294:return Fm;case 36295:return Yl;case 36296:return $f;case 35678:case 36198:case 36298:case 36306:case 35682:return om;case 35680:case 36300:case 36308:case 36293:return sm}}(e.type)}function hf(S){this.id=S,this.seq=[],this.map={}}am.prototype.updateCache=function(S){const e=this.cache;S instanceof Float32Array&&e.length!==S.length&&(this.cache=new Float32Array(S.length)),hl(e,S)},hf.prototype.setValue=function(S,e,c){const p=this.seq;for(let _=0,w=p.length;_!==w;++_){const L=p[_];L.setValue(S,e[L.id],c)}};const Lf=/(\w+)(\])?(\[|\.)?/g;function sh(S,e){S.seq.push(e),S.map[e.id]=e}function Ip(S,e,c){const p=S.name,_=p.length;for(Lf.lastIndex=0;;){const w=Lf.exec(p);let O=w[1];const z=w[3];if("]"===w[2]&&(O|=0),void 0===z||"["===z&&Lf.lastIndex+2===_){sh(c,void 0===z?new Cf(O,S,e):new am(O,S,e));break}{let Q=c.map[O];void 0===Q&&(Q=new hf(O),sh(c,Q)),c=Q}}}function Ah(S,e){this.seq=[],this.map={};const c=S.getProgramParameter(e,35718);for(let p=0;p<c;++p){const _=S.getActiveUniform(e,p);Ip(_,S.getUniformLocation(e,_.name),this)}}function Yd(S,e,c){const p=S.createShader(e);return S.shaderSource(p,c),S.compileShader(p),p}Ah.prototype.setValue=function(S,e,c,p){const _=this.map[e];void 0!==_&&_.setValue(S,c,p)},Ah.prototype.setOptional=function(S,e,c){const p=e[c];void 0!==p&&this.setValue(S,c,p)},Ah.upload=function(S,e,c,p){for(let _=0,w=e.length;_!==w;++_){const L=e[_],O=c[L.id];!1!==O.needsUpdate&&L.setValue(S,O.value,p)}},Ah.seqWithValue=function(S,e){const c=[];for(let p=0,_=S.length;p!==_;++p){const w=S[p];w.id in e&&c.push(w)}return c};let lm=0;function Yc(S){switch(S){case Qi:return["Linear","( value )"];case Ka:return["sRGB","( value )"];case Uc:return["RGBE","( value )"];case cc:return["RGBM","( value, 7.0 )"];case Ju:return["RGBM","( value, 16.0 )"];case gu:return["RGBD","( value, 256.0 )"];case Gl:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case Yh:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",S),["Linear","( value )"]}}function $h(S,e,c){const p=S.getShaderParameter(e,35713),_=S.getShaderInfoLog(e).trim();return p&&""===_?"":c.toUpperCase()+"\n\n"+_+"\n\n"+function(w){const L=w.split("\n");for(let O=0;O<L.length;O++)L[O]=O+1+": "+L[O];return L.join("\n")}(S.getShaderSource(e))}function la(S,e){const c=Yc(e);return"vec4 "+S+"( vec4 value ) { return "+c[0]+"ToLinear"+c[1]+"; }"}function Ch(S,e){const c=Yc(e);return"vec4 "+S+"( vec4 value ) { return LinearTo"+c[0]+c[1]+"; }"}function Ys(S,e){let c;switch(e){case pi:c="Linear";break;case go:c="Reinhard";break;case Nr:c="OptimizedCineon";break;case Zr:c="ACESFilmic";break;case Vr:c="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),c="Linear"}return"vec3 "+S+"( vec3 color ) { return "+c+"ToneMapping( color ); }"}function Ec(S){return""!==S}function Jd(S,e){return S.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function Bf(S,e){return S.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const $u=/^[ \t]*#include +<([\w\d./]+)>/gm;function Op(S){return S.replace($u,Sd)}function Sd(S,e){const c=li[e];if(void 0===c)throw new Error("Can not resolve #include <"+e+">");return Op(c)}const pf=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Jc=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function kp(S){return S.replace(Jc,Lh).replace(pf,Fp)}function Fp(S,e,c,p){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Lh(0,e,c,p)}function Lh(S,e,c,p){let _="";for(let w=parseInt(e);w<parseInt(c);w++)_+=p.replace(/\[\s*i\s*\]/g,"[ "+w+" ]").replace(/UNROLLED_LOOP_INDEX/g,w);return _}function Zc(S){let e="precision "+S.precision+" float;\nprecision "+S.precision+" int;";return"highp"===S.precision?e+="\n#define HIGH_PRECISION":"mediump"===S.precision?e+="\n#define MEDIUM_PRECISION":"lowp"===S.precision&&(e+="\n#define LOW_PRECISION"),e}function Bh(S,e,c,p){const _=S.getContext(),w=c.defines;let L=c.vertexShader,O=c.fragmentShader;const D=function(xt){let Dt="SHADOWMAP_TYPE_BASIC";return xt.shadowMapType===te?Dt="SHADOWMAP_TYPE_PCF":xt.shadowMapType===ce?Dt="SHADOWMAP_TYPE_PCF_SOFT":xt.shadowMapType===fe&&(Dt="SHADOWMAP_TYPE_VSM"),Dt}(c),z=function(xt){let Dt="ENVMAP_TYPE_CUBE";if(xt.envMap)switch(xt.envMapMode){case bi:case So:Dt="ENVMAP_TYPE_CUBE";break;case Di:case Eo:Dt="ENVMAP_TYPE_CUBE_UV"}return Dt}(c),Q=function(xt){let Dt="ENVMAP_MODE_REFLECTION";if(xt.envMap)switch(xt.envMapMode){case So:case Eo:Dt="ENVMAP_MODE_REFRACTION"}return Dt}(c),ae=function(xt){let Dt="ENVMAP_BLENDING_NONE";if(xt.envMap)switch(xt.combine){case Jr:Dt="ENVMAP_BLENDING_MULTIPLY";break;case ci:Dt="ENVMAP_BLENDING_MIX";break;case ir:Dt="ENVMAP_BLENDING_ADD"}return Dt}(c),ie=S.gammaFactor>0?S.gammaFactor:1,he=c.isWebGL2?"":[(xt=c).extensionDerivatives||xt.envMapCubeUV||xt.bumpMap||xt.tangentSpaceNormalMap||xt.clearcoatNormalMap||xt.flatShading||"physical"===xt.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(xt.extensionFragDepth||xt.logarithmicDepthBuffer)&&xt.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",xt.extensionDrawBuffers&&xt.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(xt.extensionShaderTextureLOD||xt.envMap||xt.transmission)&&xt.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Ec).join("\n"),ye=function(xt){const Dt=[];for(const Ht in xt){const Je=xt[Ht];!1!==Je&&Dt.push("#define "+Ht+" "+Je)}return Dt.join("\n")}(w),Me=_.createProgram();var xt;let Ne,$e,ze=c.glslVersion?"#version "+c.glslVersion+"\n":"";c.isRawShaderMaterial?(Ne=[ye].filter(Ec).join("\n"),Ne.length>0&&(Ne+="\n"),$e=[he,ye].filter(Ec).join("\n"),$e.length>0&&($e+="\n")):(Ne=[Zc(c),"#define SHADER_NAME "+c.shaderName,ye,c.instancing?"#define USE_INSTANCING":"",c.instancingColor?"#define USE_INSTANCING_COLOR":"",c.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+ie,"#define MAX_BONES "+c.maxBones,c.useFog&&c.fog?"#define USE_FOG":"",c.useFog&&c.fogExp2?"#define FOG_EXP2":"",c.map?"#define USE_MAP":"",c.envMap?"#define USE_ENVMAP":"",c.envMap?"#define "+Q:"",c.lightMap?"#define USE_LIGHTMAP":"",c.aoMap?"#define USE_AOMAP":"",c.emissiveMap?"#define USE_EMISSIVEMAP":"",c.bumpMap?"#define USE_BUMPMAP":"",c.normalMap?"#define USE_NORMALMAP":"",c.normalMap&&c.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",c.normalMap&&c.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",c.clearcoatMap?"#define USE_CLEARCOATMAP":"",c.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",c.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",c.displacementMap&&c.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",c.specularMap?"#define USE_SPECULARMAP":"",c.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",c.specularTintMap?"#define USE_SPECULARTINTMAP":"",c.roughnessMap?"#define USE_ROUGHNESSMAP":"",c.metalnessMap?"#define USE_METALNESSMAP":"",c.alphaMap?"#define USE_ALPHAMAP":"",c.transmission?"#define USE_TRANSMISSION":"",c.transmissionMap?"#define USE_TRANSMISSIONMAP":"",c.thicknessMap?"#define USE_THICKNESSMAP":"",c.vertexTangents?"#define USE_TANGENT":"",c.vertexColors?"#define USE_COLOR":"",c.vertexAlphas?"#define USE_COLOR_ALPHA":"",c.vertexUvs?"#define USE_UV":"",c.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",c.flatShading?"#define FLAT_SHADED":"",c.skinning?"#define USE_SKINNING":"",c.useVertexTexture?"#define BONE_TEXTURE":"",c.morphTargets?"#define USE_MORPHTARGETS":"",c.morphNormals&&!1===c.flatShading?"#define USE_MORPHNORMALS":"",c.doubleSided?"#define DOUBLE_SIDED":"",c.flipSided?"#define FLIP_SIDED":"",c.shadowMapEnabled?"#define USE_SHADOWMAP":"",c.shadowMapEnabled?"#define "+D:"",c.sizeAttenuation?"#define USE_SIZEATTENUATION":"",c.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",c.logarithmicDepthBuffer&&c.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Ec).join("\n"),$e=[he,Zc(c),"#define SHADER_NAME "+c.shaderName,ye,"#define GAMMA_FACTOR "+ie,c.useFog&&c.fog?"#define USE_FOG":"",c.useFog&&c.fogExp2?"#define FOG_EXP2":"",c.map?"#define USE_MAP":"",c.matcap?"#define USE_MATCAP":"",c.envMap?"#define USE_ENVMAP":"",c.envMap?"#define "+z:"",c.envMap?"#define "+Q:"",c.envMap?"#define "+ae:"",c.lightMap?"#define USE_LIGHTMAP":"",c.aoMap?"#define USE_AOMAP":"",c.emissiveMap?"#define USE_EMISSIVEMAP":"",c.bumpMap?"#define USE_BUMPMAP":"",c.normalMap?"#define USE_NORMALMAP":"",c.normalMap&&c.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",c.normalMap&&c.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",c.clearcoat?"#define USE_CLEARCOAT":"",c.clearcoatMap?"#define USE_CLEARCOATMAP":"",c.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",c.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",c.specularMap?"#define USE_SPECULARMAP":"",c.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",c.specularTintMap?"#define USE_SPECULARTINTMAP":"",c.roughnessMap?"#define USE_ROUGHNESSMAP":"",c.metalnessMap?"#define USE_METALNESSMAP":"",c.alphaMap?"#define USE_ALPHAMAP":"",c.alphaTest?"#define USE_ALPHATEST":"",c.sheenTint?"#define USE_SHEEN":"",c.transmission?"#define USE_TRANSMISSION":"",c.transmissionMap?"#define USE_TRANSMISSIONMAP":"",c.thicknessMap?"#define USE_THICKNESSMAP":"",c.vertexTangents?"#define USE_TANGENT":"",c.vertexColors||c.instancingColor?"#define USE_COLOR":"",c.vertexAlphas?"#define USE_COLOR_ALPHA":"",c.vertexUvs?"#define USE_UV":"",c.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",c.gradientMap?"#define USE_GRADIENTMAP":"",c.flatShading?"#define FLAT_SHADED":"",c.doubleSided?"#define DOUBLE_SIDED":"",c.flipSided?"#define FLIP_SIDED":"",c.shadowMapEnabled?"#define USE_SHADOWMAP":"",c.shadowMapEnabled?"#define "+D:"",c.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",c.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",c.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",c.logarithmicDepthBuffer&&c.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(c.extensionShaderTextureLOD||c.envMap)&&c.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",c.toneMapping!==vr?"#define TONE_MAPPING":"",c.toneMapping!==vr?li.tonemapping_pars_fragment:"",c.toneMapping!==vr?Ys("toneMapping",c.toneMapping):"",c.dithering?"#define DITHERING":"",c.format===Rs?"#define OPAQUE":"",li.encodings_pars_fragment,c.map?la("mapTexelToLinear",c.mapEncoding):"",c.matcap?la("matcapTexelToLinear",c.matcapEncoding):"",c.envMap?la("envMapTexelToLinear",c.envMapEncoding):"",c.emissiveMap?la("emissiveMapTexelToLinear",c.emissiveMapEncoding):"",c.specularTintMap?la("specularTintMapTexelToLinear",c.specularTintMapEncoding):"",c.lightMap?la("lightMapTexelToLinear",c.lightMapEncoding):"",Ch("linearToOutputTexel",c.outputEncoding),c.depthPacking?"#define DEPTH_PACKING "+c.depthPacking:"","\n"].filter(Ec).join("\n")),L=Op(L),L=Jd(L,c),L=Bf(L,c),O=Op(O),O=Jd(O,c),O=Bf(O,c),L=kp(L),O=kp(O),c.isWebGL2&&!0!==c.isRawShaderMaterial&&(ze="#version 300 es\n",Ne=["#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+Ne,$e=["#define varying in",c.glslVersion===Ui?"":"out highp vec4 pc_fragColor;",c.glslVersion===Ui?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+$e);const Ye=ze+$e+O,We=Yd(_,35633,ze+Ne+L),nt=Yd(_,35632,Ye);if(_.attachShader(Me,We),_.attachShader(Me,nt),void 0!==c.index0AttributeName?_.bindAttribLocation(Me,0,c.index0AttributeName):!0===c.morphTargets&&_.bindAttribLocation(Me,0,"position"),_.linkProgram(Me),S.debug.checkShaderErrors){const xt=_.getProgramInfoLog(Me).trim(),Dt=_.getShaderInfoLog(We).trim(),Ht=_.getShaderInfoLog(nt).trim();let Je=!0,pt=!0;if(!1===_.getProgramParameter(Me,35714)){Je=!1;const Vt=$h(_,We,"vertex"),Nt=$h(_,nt,"fragment");console.error("THREE.WebGLProgram: Shader Error "+_.getError()+" - VALIDATE_STATUS "+_.getProgramParameter(Me,35715)+"\n\nProgram Info Log: "+xt+"\n"+Vt+"\n"+Nt)}else""!==xt?console.warn("THREE.WebGLProgram: Program Info Log:",xt):""!==Dt&&""!==Ht||(pt=!1);pt&&(this.diagnostics={runnable:Je,programLog:xt,vertexShader:{log:Dt,prefix:Ne},fragmentShader:{log:Ht,prefix:$e}})}let it,mt;return _.deleteShader(We),_.deleteShader(nt),this.getUniforms=function(){return void 0===it&&(it=new Ah(_,Me)),it},this.getAttributes=function(){return void 0===mt&&(mt=function(xt,Dt){const Ht={},Je=xt.getProgramParameter(Dt,35721);for(let pt=0;pt<Je;pt++){const Vt=xt.getActiveAttrib(Dt,pt),Nt=Vt.name;let ct=1;35674===Vt.type&&(ct=2),35675===Vt.type&&(ct=3),35676===Vt.type&&(ct=4),Ht[Nt]={type:Vt.type,location:xt.getAttribLocation(Dt,Nt),locationSize:ct}}return Ht}(_,Me)),mt},this.destroy=function(){p.releaseStatesOfProgram(this),_.deleteProgram(Me),this.program=void 0},this.name=c.shaderName,this.id=lm++,this.cacheKey=e,this.usedTimes=1,this.program=Me,this.vertexShader=We,this.fragmentShader=nt,this}function Dp(S,e,c,p,_,w,L){const O=[],D=_.isWebGL2,z=_.logarithmicDepthBuffer,Q=_.floatVertexTextures,ae=_.maxVertexUniforms,ie=_.vertexTextures;let he=_.precision;const ye={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},Me=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoat","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","specularIntensityMap","specularTintMap","specularTintMapEncoding","roughnessMap","metalnessMap","gradientMap","alphaMap","alphaTest","combine","vertexColors","vertexAlphas","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","format","sheenTint","transmission","transmissionMap","thicknessMap"];function Ne($e){let ze;return $e&&$e.isTexture?ze=$e.encoding:$e&&$e.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),ze=$e.texture.encoding):ze=Qi,ze}return{getParameters:function($e,ze,Ye,We,nt){const it=We.fog,xt=($e.isMeshStandardMaterial?c:e).get($e.envMap||($e.isMeshStandardMaterial?We.environment:null)),Dt=ye[$e.type],Ht=nt.isSkinnedMesh?function(Yt){const St=Yt.skeleton.bones;if(Q)return 1024;{const It=Math.floor((ae-20)/4),an=Math.min(It,St.length);return an<St.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+St.length+" bones. This GPU supports "+an+"."),0):an}}(nt):0;let Je,pt;if(null!==$e.precision&&(he=_.getMaxPrecision($e.precision),he!==$e.precision&&console.warn("THREE.WebGLProgram.getParameters:",$e.precision,"not supported, using",he,"instead.")),Dt){const Yt=Ll[Dt];Je=Yt.vertexShader,pt=Yt.fragmentShader}else Je=$e.vertexShader,pt=$e.fragmentShader;const Vt=S.getRenderTarget(),Nt=$e.alphaTest>0,ct=$e.clearcoat>0;return{isWebGL2:D,shaderID:Dt,shaderName:$e.type,vertexShader:Je,fragmentShader:pt,defines:$e.defines,isRawShaderMaterial:!0===$e.isRawShaderMaterial,glslVersion:$e.glslVersion,precision:he,instancing:!0===nt.isInstancedMesh,instancingColor:!0===nt.isInstancedMesh&&null!==nt.instanceColor,supportsVertexTextures:ie,outputEncoding:null!==Vt?Ne(Vt.texture):S.outputEncoding,map:!!$e.map,mapEncoding:Ne($e.map),matcap:!!$e.matcap,matcapEncoding:Ne($e.matcap),envMap:!!xt,envMapMode:xt&&xt.mapping,envMapEncoding:Ne(xt),envMapCubeUV:!!xt&&(xt.mapping===Di||xt.mapping===Eo),lightMap:!!$e.lightMap,lightMapEncoding:Ne($e.lightMap),aoMap:!!$e.aoMap,emissiveMap:!!$e.emissiveMap,emissiveMapEncoding:Ne($e.emissiveMap),bumpMap:!!$e.bumpMap,normalMap:!!$e.normalMap,objectSpaceNormalMap:$e.normalMapType===Le,tangentSpaceNormalMap:$e.normalMapType===Te,clearcoat:ct,clearcoatMap:ct&&!!$e.clearcoatMap,clearcoatRoughnessMap:ct&&!!$e.clearcoatRoughnessMap,clearcoatNormalMap:ct&&!!$e.clearcoatNormalMap,displacementMap:!!$e.displacementMap,roughnessMap:!!$e.roughnessMap,metalnessMap:!!$e.metalnessMap,specularMap:!!$e.specularMap,specularIntensityMap:!!$e.specularIntensityMap,specularTintMap:!!$e.specularTintMap,specularTintMapEncoding:Ne($e.specularTintMap),alphaMap:!!$e.alphaMap,alphaTest:Nt,gradientMap:!!$e.gradientMap,sheenTint:!!$e.sheenTint&&($e.sheenTint.r>0||$e.sheenTint.g>0||$e.sheenTint.b>0),transmission:$e.transmission>0,transmissionMap:!!$e.transmissionMap,thicknessMap:!!$e.thicknessMap,combine:$e.combine,vertexTangents:!!$e.normalMap&&!!nt.geometry&&!!nt.geometry.attributes.tangent,vertexColors:$e.vertexColors,vertexAlphas:!0===$e.vertexColors&&!!nt.geometry&&!!nt.geometry.attributes.color&&4===nt.geometry.attributes.color.itemSize,vertexUvs:!!($e.map||$e.bumpMap||$e.normalMap||$e.specularMap||$e.alphaMap||$e.emissiveMap||$e.roughnessMap||$e.metalnessMap||$e.clearcoatMap||$e.clearcoatRoughnessMap||$e.clearcoatNormalMap||$e.displacementMap||$e.transmissionMap||$e.thicknessMap||$e.specularIntensityMap||$e.specularTintMap),uvsVertexOnly:!($e.map||$e.bumpMap||$e.normalMap||$e.specularMap||$e.alphaMap||$e.emissiveMap||$e.roughnessMap||$e.metalnessMap||$e.clearcoatNormalMap||$e.transmission>0||$e.transmissionMap||$e.thicknessMap||$e.specularIntensityMap||$e.specularTintMap||!$e.displacementMap),fog:!!it,useFog:$e.fog,fogExp2:it&&it.isFogExp2,flatShading:!!$e.flatShading,sizeAttenuation:$e.sizeAttenuation,logarithmicDepthBuffer:z,skinning:!0===nt.isSkinnedMesh&&Ht>0,maxBones:Ht,useVertexTexture:Q,morphTargets:!!nt.geometry&&!!nt.geometry.morphAttributes.position,morphNormals:!!nt.geometry&&!!nt.geometry.morphAttributes.normal,numDirLights:ze.directional.length,numPointLights:ze.point.length,numSpotLights:ze.spot.length,numRectAreaLights:ze.rectArea.length,numHemiLights:ze.hemi.length,numDirLightShadows:ze.directionalShadowMap.length,numPointLightShadows:ze.pointShadowMap.length,numSpotLightShadows:ze.spotShadowMap.length,numClippingPlanes:L.numPlanes,numClipIntersection:L.numIntersection,format:$e.format,dithering:$e.dithering,shadowMapEnabled:S.shadowMap.enabled&&Ye.length>0,shadowMapType:S.shadowMap.type,toneMapping:$e.toneMapped?S.toneMapping:vr,physicallyCorrectLights:S.physicallyCorrectLights,premultipliedAlpha:$e.premultipliedAlpha,doubleSided:$e.side===pe,flipSided:$e.side===le,depthPacking:void 0!==$e.depthPacking&&$e.depthPacking,index0AttributeName:$e.index0AttributeName,extensionDerivatives:$e.extensions&&$e.extensions.derivatives,extensionFragDepth:$e.extensions&&$e.extensions.fragDepth,extensionDrawBuffers:$e.extensions&&$e.extensions.drawBuffers,extensionShaderTextureLOD:$e.extensions&&$e.extensions.shaderTextureLOD,rendererExtensionFragDepth:D||p.has("EXT_frag_depth"),rendererExtensionDrawBuffers:D||p.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:D||p.has("EXT_shader_texture_lod"),customProgramCacheKey:$e.customProgramCacheKey()}},getProgramCacheKey:function($e){const ze=[];if($e.shaderID?ze.push($e.shaderID):(ze.push($e.fragmentShader),ze.push($e.vertexShader)),void 0!==$e.defines)for(const Ye in $e.defines)ze.push(Ye),ze.push($e.defines[Ye]);if(!1===$e.isRawShaderMaterial){for(let Ye=0;Ye<Me.length;Ye++)ze.push($e[Me[Ye]]);ze.push(S.outputEncoding),ze.push(S.gammaFactor)}return ze.push($e.customProgramCacheKey),ze.join()},getUniforms:function($e){const ze=ye[$e.type];let Ye;return Ye=ze?Bs.clone(Ll[ze].uniforms):$e.uniforms,Ye},acquireProgram:function($e,ze){let Ye;for(let We=0,nt=O.length;We<nt;We++){const it=O[We];if(it.cacheKey===ze){Ye=it,++Ye.usedTimes;break}}return void 0===Ye&&(Ye=new Bh(S,ze,$e,w),O.push(Ye)),Ye},releaseProgram:function($e){if(0==--$e.usedTimes){const ze=O.indexOf($e);O[ze]=O[O.length-1],O.pop(),$e.destroy()}},programs:O}}function wi(){let S=new WeakMap;return{get:function(e){let c=S.get(e);return void 0===c&&(c={},S.set(e,c)),c},remove:function(e){S.delete(e)},update:function(e,c,p){S.get(e)[c]=p},dispose:function(){S=new WeakMap}}}function Ed(S,e){return S.groupOrder!==e.groupOrder?S.groupOrder-e.groupOrder:S.renderOrder!==e.renderOrder?S.renderOrder-e.renderOrder:S.program!==e.program?S.program.id-e.program.id:S.material.id!==e.material.id?S.material.id-e.material.id:S.z!==e.z?S.z-e.z:S.id-e.id}function Td(S,e){return S.groupOrder!==e.groupOrder?S.groupOrder-e.groupOrder:S.renderOrder!==e.renderOrder?S.renderOrder-e.renderOrder:S.z!==e.z?e.z-S.z:S.id-e.id}function df(S){const e=[];let c=0;const p=[],_=[],w=[],L={id:-1};function O(D,z,Q,ae,ie,he){let ye=e[c];const Me=S.get(Q);return void 0===ye?(ye={id:D.id,object:D,geometry:z,material:Q,program:Me.program||L,groupOrder:ae,renderOrder:D.renderOrder,z:ie,group:he},e[c]=ye):(ye.id=D.id,ye.object=D,ye.geometry=z,ye.material=Q,ye.program=Me.program||L,ye.groupOrder=ae,ye.renderOrder=D.renderOrder,ye.z=ie,ye.group=he),c++,ye}return{opaque:p,transmissive:_,transparent:w,init:function(){c=0,p.length=0,_.length=0,w.length=0},push:function(D,z,Q,ae,ie,he){const ye=O(D,z,Q,ae,ie,he);Q.transmission>0?_.push(ye):!0===Q.transparent?w.push(ye):p.push(ye)},unshift:function(D,z,Q,ae,ie,he){const ye=O(D,z,Q,ae,ie,he);Q.transmission>0?_.unshift(ye):!0===Q.transparent?w.unshift(ye):p.unshift(ye)},finish:function(){for(let D=c,z=e.length;D<z;D++){const Q=e[D];if(null===Q.id)break;Q.id=null,Q.object=null,Q.geometry=null,Q.material=null,Q.program=null,Q.group=null}},sort:function(D,z){p.length>1&&p.sort(D||Ed),_.length>1&&_.sort(z||Td),w.length>1&&w.sort(z||Td)}}}function ff(S){let e=new WeakMap;return{get:function(c,p){let _;return!1===e.has(c)?(_=new df(S),e.set(c,[_])):p>=e.get(c).length?(_=new df(S),e.get(c).push(_)):_=e.get(c)[p],_},dispose:function(){e=new WeakMap}}}function nd(){const S={};return{get:function(e){if(void 0!==S[e.id])return S[e.id];let c;switch(e.type){case"DirectionalLight":c={direction:new lt,color:new tr};break;case"SpotLight":c={position:new lt,direction:new lt,color:new tr,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":c={position:new lt,color:new tr,distance:0,decay:0};break;case"HemisphereLight":c={direction:new lt,skyColor:new tr,groundColor:new tr};break;case"RectAreaLight":c={color:new tr,position:new lt,halfWidth:new lt,halfHeight:new lt}}return S[e.id]=c,c}}}let mf=0;function Jl(S,e){return(e.castShadow?1:0)-(S.castShadow?1:0)}function Nf(S,e){const c=new nd,p=function(){const D={};return{get:function(z){if(void 0!==D[z.id])return D[z.id];let Q;switch(z.type){case"DirectionalLight":case"SpotLight":Q={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Un};break;case"PointLight":Q={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Un,shadowCameraNear:1,shadowCameraFar:1e3}}return D[z.id]=Q,Q}}}(),_={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let D=0;D<9;D++)_.probe.push(new lt);const w=new lt,L=new Qt,O=new Qt;return{setup:function(D,z){let Q=0,ae=0,ie=0;for(let mt=0;mt<9;mt++)_.probe[mt].set(0,0,0);let he=0,ye=0,Me=0,Ne=0,$e=0,ze=0,Ye=0,We=0;D.sort(Jl);const nt=!0!==z?Math.PI:1;for(let mt=0,xt=D.length;mt<xt;mt++){const Dt=D[mt],Ht=Dt.color,Je=Dt.intensity,pt=Dt.distance,Vt=Dt.shadow&&Dt.shadow.map?Dt.shadow.map.texture:null;if(Dt.isAmbientLight)Q+=Ht.r*Je*nt,ae+=Ht.g*Je*nt,ie+=Ht.b*Je*nt;else if(Dt.isLightProbe)for(let Nt=0;Nt<9;Nt++)_.probe[Nt].addScaledVector(Dt.sh.coefficients[Nt],Je);else if(Dt.isDirectionalLight){const Nt=c.get(Dt);if(Nt.color.copy(Dt.color).multiplyScalar(Dt.intensity*nt),Dt.castShadow){const ct=Dt.shadow,Yt=p.get(Dt);Yt.shadowBias=ct.bias,Yt.shadowNormalBias=ct.normalBias,Yt.shadowRadius=ct.radius,Yt.shadowMapSize=ct.mapSize,_.directionalShadow[he]=Yt,_.directionalShadowMap[he]=Vt,_.directionalShadowMatrix[he]=Dt.shadow.matrix,ze++}_.directional[he]=Nt,he++}else if(Dt.isSpotLight){const Nt=c.get(Dt);if(Nt.position.setFromMatrixPosition(Dt.matrixWorld),Nt.color.copy(Ht).multiplyScalar(Je*nt),Nt.distance=pt,Nt.coneCos=Math.cos(Dt.angle),Nt.penumbraCos=Math.cos(Dt.angle*(1-Dt.penumbra)),Nt.decay=Dt.decay,Dt.castShadow){const ct=Dt.shadow,Yt=p.get(Dt);Yt.shadowBias=ct.bias,Yt.shadowNormalBias=ct.normalBias,Yt.shadowRadius=ct.radius,Yt.shadowMapSize=ct.mapSize,_.spotShadow[Me]=Yt,_.spotShadowMap[Me]=Vt,_.spotShadowMatrix[Me]=Dt.shadow.matrix,We++}_.spot[Me]=Nt,Me++}else if(Dt.isRectAreaLight){const Nt=c.get(Dt);Nt.color.copy(Ht).multiplyScalar(Je),Nt.halfWidth.set(.5*Dt.width,0,0),Nt.halfHeight.set(0,.5*Dt.height,0),_.rectArea[Ne]=Nt,Ne++}else if(Dt.isPointLight){const Nt=c.get(Dt);if(Nt.color.copy(Dt.color).multiplyScalar(Dt.intensity*nt),Nt.distance=Dt.distance,Nt.decay=Dt.decay,Dt.castShadow){const ct=Dt.shadow,Yt=p.get(Dt);Yt.shadowBias=ct.bias,Yt.shadowNormalBias=ct.normalBias,Yt.shadowRadius=ct.radius,Yt.shadowMapSize=ct.mapSize,Yt.shadowCameraNear=ct.camera.near,Yt.shadowCameraFar=ct.camera.far,_.pointShadow[ye]=Yt,_.pointShadowMap[ye]=Vt,_.pointShadowMatrix[ye]=Dt.shadow.matrix,Ye++}_.point[ye]=Nt,ye++}else if(Dt.isHemisphereLight){const Nt=c.get(Dt);Nt.skyColor.copy(Dt.color).multiplyScalar(Je*nt),Nt.groundColor.copy(Dt.groundColor).multiplyScalar(Je*nt),_.hemi[$e]=Nt,$e++}}Ne>0&&(e.isWebGL2||!0===S.has("OES_texture_float_linear")?(_.rectAreaLTC1=ar.LTC_FLOAT_1,_.rectAreaLTC2=ar.LTC_FLOAT_2):!0===S.has("OES_texture_half_float_linear")?(_.rectAreaLTC1=ar.LTC_HALF_1,_.rectAreaLTC2=ar.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),_.ambient[0]=Q,_.ambient[1]=ae,_.ambient[2]=ie;const it=_.hash;it.directionalLength===he&&it.pointLength===ye&&it.spotLength===Me&&it.rectAreaLength===Ne&&it.hemiLength===$e&&it.numDirectionalShadows===ze&&it.numPointShadows===Ye&&it.numSpotShadows===We||(_.directional.length=he,_.spot.length=Me,_.rectArea.length=Ne,_.point.length=ye,_.hemi.length=$e,_.directionalShadow.length=ze,_.directionalShadowMap.length=ze,_.pointShadow.length=Ye,_.pointShadowMap.length=Ye,_.spotShadow.length=We,_.spotShadowMap.length=We,_.directionalShadowMatrix.length=ze,_.pointShadowMatrix.length=Ye,_.spotShadowMatrix.length=We,it.directionalLength=he,it.pointLength=ye,it.spotLength=Me,it.rectAreaLength=Ne,it.hemiLength=$e,it.numDirectionalShadows=ze,it.numPointShadows=Ye,it.numSpotShadows=We,_.version=mf++)},setupView:function(D,z){let Q=0,ae=0,ie=0,he=0,ye=0;const Me=z.matrixWorldInverse;for(let Ne=0,$e=D.length;Ne<$e;Ne++){const ze=D[Ne];if(ze.isDirectionalLight){const Ye=_.directional[Q];Ye.direction.setFromMatrixPosition(ze.matrixWorld),w.setFromMatrixPosition(ze.target.matrixWorld),Ye.direction.sub(w),Ye.direction.transformDirection(Me),Q++}else if(ze.isSpotLight){const Ye=_.spot[ie];Ye.position.setFromMatrixPosition(ze.matrixWorld),Ye.position.applyMatrix4(Me),Ye.direction.setFromMatrixPosition(ze.matrixWorld),w.setFromMatrixPosition(ze.target.matrixWorld),Ye.direction.sub(w),Ye.direction.transformDirection(Me),ie++}else if(ze.isRectAreaLight){const Ye=_.rectArea[he];Ye.position.setFromMatrixPosition(ze.matrixWorld),Ye.position.applyMatrix4(Me),O.identity(),L.copy(ze.matrixWorld),L.premultiply(Me),O.extractRotation(L),Ye.halfWidth.set(.5*ze.width,0,0),Ye.halfHeight.set(0,.5*ze.height,0),Ye.halfWidth.applyMatrix4(O),Ye.halfHeight.applyMatrix4(O),he++}else if(ze.isPointLight){const Ye=_.point[ae];Ye.position.setFromMatrixPosition(ze.matrixWorld),Ye.position.applyMatrix4(Me),ae++}else if(ze.isHemisphereLight){const Ye=_.hemi[ye];Ye.direction.setFromMatrixPosition(ze.matrixWorld),Ye.direction.transformDirection(Me),Ye.direction.normalize(),ye++}}},state:_}}function Rf(S,e){const c=new Nf(S,e),p=[],_=[];return{init:function(){p.length=0,_.length=0},state:{lightsArray:p,shadowsArray:_,lights:c},setupLights:function(w){c.setup(p,w)},setupLightsView:function(w){c.setupView(p,w)},pushLight:function(w){p.push(w)},pushShadow:function(w){_.push(w)}}}function Zd(S,e){let c=new WeakMap;return{get:function(p,_=0){let w;return!1===c.has(p)?(w=new Rf(S,e),c.set(p,[w])):_>=c.get(p).length?(w=new Rf(S,e),c.get(p).push(w)):w=c.get(p)[_],w},dispose:function(){c=new WeakMap}}}class Up extends As{constructor(e){super(),this.type="MeshDepthMaterial",this.depthPacking=W,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}Up.prototype.isMeshDepthMaterial=!0;class rd extends As{constructor(e){super(),this.type="MeshDistanceMaterial",this.referencePosition=new lt,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}copy(e){return super.copy(e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}rd.prototype.isMeshDistanceMaterial=!0;var cm="uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\nuniform float samples;\n#include <packing>\nvoid main() {\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}",ja="void main() {\n\tgl_Position = vec4( position, 1.0 );\n}";function zp(S,e,c){let p=new Dr;const _=new Un,w=new Un,L=new Hi,O=new Up({depthPacking:ue}),D=new rd,z={},Q=c.maxTextureSize,ae={0:le,1:_e,2:pe},ie=new Ns({uniforms:{shadow_pass:{value:null},resolution:{value:new Un},radius:{value:4},samples:{value:8}},vertexShader:ja,fragmentShader:cm}),he=ie.clone();he.defines.HORIZONTAL_PASS=1;const ye=new br;ye.setAttribute("position",new zi(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const Me=new Po(ye,ie),Ne=this;function $e(We,nt){const it=e.update(Me);ie.uniforms.shadow_pass.value=We.map.texture,ie.uniforms.resolution.value=We.mapSize,ie.uniforms.radius.value=We.radius,ie.uniforms.samples.value=We.blurSamples,S.setRenderTarget(We.mapPass),S.clear(),S.renderBufferDirect(nt,null,it,ie,Me,null),he.uniforms.shadow_pass.value=We.mapPass.texture,he.uniforms.resolution.value=We.mapSize,he.uniforms.radius.value=We.radius,he.uniforms.samples.value=We.blurSamples,S.setRenderTarget(We.map),S.clear(),S.renderBufferDirect(nt,null,it,he,Me,null)}function ze(We,nt,it,mt,xt,Dt,Ht){let Je=null;const pt=!0===mt.isPointLight?We.customDistanceMaterial:We.customDepthMaterial;if(Je=void 0!==pt?pt:!0===mt.isPointLight?D:O,S.localClippingEnabled&&!0===it.clipShadows&&0!==it.clippingPlanes.length||it.displacementMap&&0!==it.displacementScale||it.alphaMap&&it.alphaTest>0){const Vt=Je.uuid,Nt=it.uuid;let ct=z[Vt];void 0===ct&&(ct={},z[Vt]=ct);let Yt=ct[Nt];void 0===Yt&&(Yt=Je.clone(),ct[Nt]=Yt),Je=Yt}return Je.visible=it.visible,Je.wireframe=it.wireframe,Je.side=Ht===fe?null!==it.shadowSide?it.shadowSide:it.side:null!==it.shadowSide?it.shadowSide:ae[it.side],Je.alphaMap=it.alphaMap,Je.alphaTest=it.alphaTest,Je.clipShadows=it.clipShadows,Je.clippingPlanes=it.clippingPlanes,Je.clipIntersection=it.clipIntersection,Je.displacementMap=it.displacementMap,Je.displacementScale=it.displacementScale,Je.displacementBias=it.displacementBias,Je.wireframeLinewidth=it.wireframeLinewidth,Je.linewidth=it.linewidth,!0===mt.isPointLight&&!0===Je.isMeshDistanceMaterial&&(Je.referencePosition.setFromMatrixPosition(mt.matrixWorld),Je.nearDistance=xt,Je.farDistance=Dt),Je}function Ye(We,nt,it,mt,xt){if(!1===We.visible)return;if(We.layers.test(nt.layers)&&(We.isMesh||We.isLine||We.isPoints)&&(We.castShadow||We.receiveShadow&&xt===fe)&&(!We.frustumCulled||p.intersectsObject(We))){We.modelViewMatrix.multiplyMatrices(it.matrixWorldInverse,We.matrixWorld);const Ht=e.update(We),Je=We.material;if(Array.isArray(Je)){const pt=Ht.groups;for(let Vt=0,Nt=pt.length;Vt<Nt;Vt++){const ct=pt[Vt],Yt=Je[ct.materialIndex];if(Yt&&Yt.visible){const St=ze(We,0,Yt,mt,it.near,it.far,xt);S.renderBufferDirect(it,null,Ht,St,We,ct)}}}else if(Je.visible){const pt=ze(We,0,Je,mt,it.near,it.far,xt);S.renderBufferDirect(it,null,Ht,pt,We,null)}}const Dt=We.children;for(let Ht=0,Je=Dt.length;Ht<Je;Ht++)Ye(Dt[Ht],nt,it,mt,xt)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=te,this.render=function(We,nt,it){if(!1===Ne.enabled||!1===Ne.autoUpdate&&!1===Ne.needsUpdate||0===We.length)return;const mt=S.getRenderTarget(),xt=S.getActiveCubeFace(),Dt=S.getActiveMipmapLevel(),Ht=S.state;Ht.setBlending(q),Ht.buffers.color.setClear(1,1,1,1),Ht.buffers.depth.setTest(!0),Ht.setScissorTest(!1);for(let Je=0,pt=We.length;Je<pt;Je++){const Vt=We[Je],Nt=Vt.shadow;if(void 0===Nt){console.warn("THREE.WebGLShadowMap:",Vt,"has no shadow.");continue}if(!1===Nt.autoUpdate&&!1===Nt.needsUpdate)continue;_.copy(Nt.mapSize);const ct=Nt.getFrameExtents();if(_.multiply(ct),w.copy(Nt.mapSize),(_.x>Q||_.y>Q)&&(_.x>Q&&(w.x=Math.floor(Q/ct.x),_.x=w.x*ct.x,Nt.mapSize.x=w.x),_.y>Q&&(w.y=Math.floor(Q/ct.y),_.y=w.y*ct.y,Nt.mapSize.y=w.y)),null===Nt.map&&!Nt.isPointLightShadow&&this.type===fe){const St={minFilter:ii,magFilter:ii,format:lo};Nt.map=new io(_.x,_.y,St),Nt.map.texture.name=Vt.name+".shadowMap",Nt.mapPass=new io(_.x,_.y,St),Nt.camera.updateProjectionMatrix()}null===Nt.map&&(Nt.map=new io(_.x,_.y,{minFilter:Or,magFilter:Or,format:lo}),Nt.map.texture.name=Vt.name+".shadowMap",Nt.camera.updateProjectionMatrix()),S.setRenderTarget(Nt.map),S.clear();const Yt=Nt.getViewportCount();for(let St=0;St<Yt;St++){const jt=Nt.getViewport(St);L.set(w.x*jt.x,w.y*jt.y,w.x*jt.z,w.y*jt.w),Ht.viewport(L),Nt.updateMatrices(Vt,St),p=Nt.getFrustum(),Ye(nt,it,Nt.camera,Vt,this.type)}Nt.isPointLightShadow||this.type!==fe||$e(Nt,it),Nt.needsUpdate=!1}Ne.needsUpdate=!1,S.setRenderTarget(mt,xt,Dt)}}function um(S,e,c){const p=c.isWebGL2,_=new function(){let dt=!1;const sn=new Hi;let Sn=null;const hn=new Hi(0,0,0,0);return{setMask:function(Wt){Sn===Wt||dt||(S.colorMask(Wt,Wt,Wt,Wt),Sn=Wt)},setLocked:function(Wt){dt=Wt},setClear:function(Wt,xr,mr,Br,Gi){!0===Gi&&(Wt*=Br,xr*=Br,mr*=Br),sn.set(Wt,xr,mr,Br),!1===hn.equals(sn)&&(S.clearColor(Wt,xr,mr,Br),hn.copy(sn))},reset:function(){dt=!1,Sn=null,hn.set(-1,0,0,0)}}},w=new function(){let dt=!1,sn=null,Sn=null,hn=null;return{setTest:function(Wt){Wt?Ze(2929):st(2929)},setMask:function(Wt){sn===Wt||dt||(S.depthMask(Wt),sn=Wt)},setFunc:function(Wt){if(Sn!==Wt){if(Wt)switch(Wt){case Pn:S.depthFunc(512);break;case $n:S.depthFunc(519);break;case gn:S.depthFunc(513);break;case ur:S.depthFunc(515);break;case or:S.depthFunc(514);break;case hr:S.depthFunc(518);break;case sr:S.depthFunc(516);break;case ei:S.depthFunc(517);break;default:S.depthFunc(515)}else S.depthFunc(515);Sn=Wt}},setLocked:function(Wt){dt=Wt},setClear:function(Wt){hn!==Wt&&(S.clearDepth(Wt),hn=Wt)},reset:function(){dt=!1,sn=null,Sn=null,hn=null}}},L=new function(){let dt=!1,sn=null,Sn=null,hn=null,Wt=null,xr=null,mr=null,Br=null,Gi=null;return{setTest:function(_o){dt||(_o?Ze(2960):st(2960))},setMask:function(_o){sn===_o||dt||(S.stencilMask(_o),sn=_o)},setFunc:function(_o,ml,Ho){Sn===_o&&hn===ml&&Wt===Ho||(S.stencilFunc(_o,ml,Ho),Sn=_o,hn=ml,Wt=Ho)},setOp:function(_o,ml,Ho){xr===_o&&mr===ml&&Br===Ho||(S.stencilOp(_o,ml,Ho),xr=_o,mr=ml,Br=Ho)},setLocked:function(_o){dt=_o},setClear:function(_o){Gi!==_o&&(S.clearStencil(_o),Gi=_o)},reset:function(){dt=!1,sn=null,Sn=null,hn=null,Wt=null,xr=null,mr=null,Br=null,Gi=null}}};let O={},D=null,z={},Q=null,ae=!1,ie=null,he=null,ye=null,Me=null,Ne=null,$e=null,ze=null,Ye=!1,We=null,nt=null,it=null,mt=null,xt=null;const Dt=S.getParameter(35661);let Ht=!1,Je=0;const pt=S.getParameter(7938);-1!==pt.indexOf("WebGL")?(Je=parseFloat(/^WebGL (\d)/.exec(pt)[1]),Ht=Je>=1):-1!==pt.indexOf("OpenGL ES")&&(Je=parseFloat(/^OpenGL ES (\d)/.exec(pt)[1]),Ht=Je>=2);let Vt=null,Nt={};const ct=S.getParameter(3088),Yt=S.getParameter(2978),St=(new Hi).fromArray(ct),jt=(new Hi).fromArray(Yt);function It(dt,sn,Sn){const hn=new Uint8Array(4),Wt=S.createTexture();S.bindTexture(dt,Wt),S.texParameteri(dt,10241,9728),S.texParameteri(dt,10240,9728);for(let xr=0;xr<Sn;xr++)S.texImage2D(sn+xr,0,6408,1,1,0,6408,5121,hn);return Wt}const an={};function Ze(dt){!0!==O[dt]&&(S.enable(dt),O[dt]=!0)}function st(dt){!1!==O[dt]&&(S.disable(dt),O[dt]=!1)}an[3553]=It(3553,3553,1),an[34067]=It(34067,34069,6),_.setClear(0,0,0,1),w.setClear(1),L.setClear(0),Ze(2929),w.setFunc(ur),En(!1),Zn(A),Ze(2884),tn(q);const Rt={[Ae]:32774,[Fe]:32778,[Ee]:32779};if(p)Rt[qe]=32775,Rt[Ke]=32776;else{const dt=e.get("EXT_blend_minmax");null!==dt&&(Rt[qe]=dt.MIN_EXT,Rt[Ke]=dt.MAX_EXT)}const Gt={[gt]:0,[at]:1,[Ct]:768,[Ft]:770,[mn]:776,[Tn]:774,[rn]:772,[wt]:769,[Ot]:771,[Cn]:775,[ft]:773};function tn(dt,sn,Sn,hn,Wt,xr,mr,Br){if(dt!==q){if(!1===ae&&(Ze(3042),ae=!0),dt===ve)Wt=Wt||sn,xr=xr||Sn,mr=mr||hn,sn===he&&Wt===Ne||(S.blendEquationSeparate(Rt[sn],Rt[Wt]),he=sn,Ne=Wt),Sn===ye&&hn===Me&&xr===$e&&mr===ze||(S.blendFuncSeparate(Gt[Sn],Gt[hn],Gt[xr],Gt[mr]),ye=Sn,Me=hn,$e=xr,ze=mr),ie=dt,Ye=null;else if(dt!==ie||Br!==Ye){if(he===Ae&&Ne===Ae||(S.blendEquation(32774),he=Ae,Ne=Ae),Br)switch(dt){case ee:S.blendFuncSeparate(1,771,1,771);break;case F:S.blendFunc(1,1);break;case Be:S.blendFuncSeparate(0,0,769,771);break;case K:S.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",dt)}else switch(dt){case ee:S.blendFuncSeparate(770,771,1,771);break;case F:S.blendFunc(770,1);break;case Be:S.blendFunc(0,769);break;case K:S.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",dt)}ye=null,Me=null,$e=null,ze=null,ie=dt,Ye=Br}}else!0===ae&&(st(3042),ae=!1)}function En(dt){We!==dt&&(S.frontFace(dt?2304:2305),We=dt)}function Zn(dt){dt!==G?(Ze(2884),dt!==nt&&S.cullFace(dt===A?1029:dt===P?1028:1032)):st(2884),nt=dt}function qn(dt,sn,Sn){dt?(Ze(32823),mt===sn&&xt===Sn||(S.polygonOffset(sn,Sn),mt=sn,xt=Sn)):st(32823)}function on(dt){void 0===dt&&(dt=33984+Dt-1),Vt!==dt&&(S.activeTexture(dt),Vt=dt)}return{buffers:{color:_,depth:w,stencil:L},enable:Ze,disable:st,bindFramebuffer:function(dt,sn){return null===sn&&null!==D&&(sn=D),z[dt]!==sn&&(S.bindFramebuffer(dt,sn),z[dt]=sn,p&&(36009===dt&&(z[36160]=sn),36160===dt&&(z[36009]=sn)),!0)},bindXRFramebuffer:function(dt){dt!==D&&(S.bindFramebuffer(36160,dt),D=dt)},useProgram:function(dt){return Q!==dt&&(S.useProgram(dt),Q=dt,!0)},setBlending:tn,setMaterial:function(dt,sn){dt.side===pe?st(2884):Ze(2884);let Sn=dt.side===le;sn&&(Sn=!Sn),En(Sn),dt.blending===ee&&!1===dt.transparent?tn(q):tn(dt.blending,dt.blendEquation,dt.blendSrc,dt.blendDst,dt.blendEquationAlpha,dt.blendSrcAlpha,dt.blendDstAlpha,dt.premultipliedAlpha),w.setFunc(dt.depthFunc),w.setTest(dt.depthTest),w.setMask(dt.depthWrite),_.setMask(dt.colorWrite);const hn=dt.stencilWrite;L.setTest(hn),hn&&(L.setMask(dt.stencilWriteMask),L.setFunc(dt.stencilFunc,dt.stencilRef,dt.stencilFuncMask),L.setOp(dt.stencilFail,dt.stencilZFail,dt.stencilZPass)),qn(dt.polygonOffset,dt.polygonOffsetFactor,dt.polygonOffsetUnits),!0===dt.alphaToCoverage?Ze(32926):st(32926)},setFlipSided:En,setCullFace:Zn,setLineWidth:function(dt){dt!==it&&(Ht&&S.lineWidth(dt),it=dt)},setPolygonOffset:qn,setScissorTest:function(dt){dt?Ze(3089):st(3089)},activeTexture:on,bindTexture:function(dt,sn){null===Vt&&on();let Sn=Nt[Vt];void 0===Sn&&(Sn={type:void 0,texture:void 0},Nt[Vt]=Sn),Sn.type===dt&&Sn.texture===sn||(S.bindTexture(dt,sn||an[dt]),Sn.type=dt,Sn.texture=sn)},unbindTexture:function(){const dt=Nt[Vt];void 0!==dt&&void 0!==dt.type&&(S.bindTexture(dt.type,null),dt.type=void 0,dt.texture=void 0)},compressedTexImage2D:function(){try{S.compressedTexImage2D.apply(S,arguments)}catch(dt){console.error("THREE.WebGLState:",dt)}},texImage2D:function(){try{S.texImage2D.apply(S,arguments)}catch(dt){console.error("THREE.WebGLState:",dt)}},texImage3D:function(){try{S.texImage3D.apply(S,arguments)}catch(dt){console.error("THREE.WebGLState:",dt)}},scissor:function(dt){!1===St.equals(dt)&&(S.scissor(dt.x,dt.y,dt.z,dt.w),St.copy(dt))},viewport:function(dt){!1===jt.equals(dt)&&(S.viewport(dt.x,dt.y,dt.z,dt.w),jt.copy(dt))},reset:function(){S.disable(3042),S.disable(2884),S.disable(2929),S.disable(32823),S.disable(3089),S.disable(2960),S.disable(32926),S.blendEquation(32774),S.blendFunc(1,0),S.blendFuncSeparate(1,0,1,0),S.colorMask(!0,!0,!0,!0),S.clearColor(0,0,0,0),S.depthMask(!0),S.depthFunc(513),S.clearDepth(1),S.stencilMask(4294967295),S.stencilFunc(519,0,4294967295),S.stencilOp(7680,7680,7680),S.clearStencil(0),S.cullFace(1029),S.frontFace(2305),S.polygonOffset(0,0),S.activeTexture(33984),S.bindFramebuffer(36160,null),!0===p&&(S.bindFramebuffer(36009,null),S.bindFramebuffer(36008,null)),S.useProgram(null),S.lineWidth(1),S.scissor(0,0,S.canvas.width,S.canvas.height),S.viewport(0,0,S.canvas.width,S.canvas.height),O={},Vt=null,Nt={},D=null,z={},Q=null,ae=!1,ie=null,he=null,ye=null,Me=null,Ne=null,$e=null,ze=null,Ye=!1,We=null,nt=null,it=null,mt=null,xt=null,St.set(0,0,S.canvas.width,S.canvas.height),jt.set(0,0,S.canvas.width,S.canvas.height),_.reset(),w.reset(),L.reset()}}}function Dm(S,e,c,p,_,w,L){const O=_.isWebGL2,D=_.maxTextures,z=_.maxCubemapSize,Q=_.maxTextureSize,ae=_.maxSamples,ie=new WeakMap;let he,ye=!1;try{ye=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function Me(Ze,st){return ye?new OffscreenCanvas(Ze,st):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function Ne(Ze,st,Rt,Gt){let tn=1;if((Ze.width>Gt||Ze.height>Gt)&&(tn=Gt/Math.max(Ze.width,Ze.height)),tn<1||!0===st){if(typeof HTMLImageElement<"u"&&Ze instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Ze instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Ze instanceof ImageBitmap){const En=st?yo:Math.floor,Zn=En(tn*Ze.width),qn=En(tn*Ze.height);void 0===he&&(he=Me(Zn,qn));const on=Rt?Me(Zn,qn):he;return on.width=Zn,on.height=qn,on.getContext("2d").drawImage(Ze,0,0,Zn,qn),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Ze.width+"x"+Ze.height+") to ("+Zn+"x"+qn+")."),on}return"data"in Ze&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Ze.width+"x"+Ze.height+")."),Ze}return Ze}function $e(Ze){return Is(Ze.width)&&Is(Ze.height)}function ze(Ze,st){return Ze.generateMipmaps&&st&&Ze.minFilter!==Or&&Ze.minFilter!==ii}function Ye(Ze,st,Rt,Gt,tn=1){S.generateMipmap(Ze),p.get(st).__maxMipLevel=Math.log2(Math.max(Rt,Gt,tn))}function We(Ze,st,Rt){if(!1===O)return st;if(null!==Ze){if(void 0!==S[Ze])return S[Ze];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Ze+"'")}let Gt=st;return 6403===st&&(5126===Rt&&(Gt=33326),5131===Rt&&(Gt=33325),5121===Rt&&(Gt=33321)),6407===st&&(5126===Rt&&(Gt=34837),5131===Rt&&(Gt=34843),5121===Rt&&(Gt=32849)),6408===st&&(5126===Rt&&(Gt=34836),5131===Rt&&(Gt=34842),5121===Rt&&(Gt=32856)),33325!==Gt&&33326!==Gt&&34842!==Gt&&34836!==Gt||e.get("EXT_color_buffer_float"),Gt}function nt(Ze){return Ze===Or||Ze===Na||Ze===ps?9728:9729}function it(Ze){const st=Ze.target;st.removeEventListener("dispose",it),function(Rt){const Gt=p.get(Rt);void 0!==Gt.__webglInit&&(S.deleteTexture(Gt.__webglTexture),p.remove(Rt))}(st),st.isVideoTexture&&ie.delete(st),L.memory.textures--}function mt(Ze){const st=Ze.target;st.removeEventListener("dispose",mt),function(Rt){const Gt=Rt.texture,tn=p.get(Rt),En=p.get(Gt);if(Rt){if(void 0!==En.__webglTexture&&(S.deleteTexture(En.__webglTexture),L.memory.textures--),Rt.depthTexture&&Rt.depthTexture.dispose(),Rt.isWebGLCubeRenderTarget)for(let Zn=0;Zn<6;Zn++)S.deleteFramebuffer(tn.__webglFramebuffer[Zn]),tn.__webglDepthbuffer&&S.deleteRenderbuffer(tn.__webglDepthbuffer[Zn]);else S.deleteFramebuffer(tn.__webglFramebuffer),tn.__webglDepthbuffer&&S.deleteRenderbuffer(tn.__webglDepthbuffer),tn.__webglMultisampledFramebuffer&&S.deleteFramebuffer(tn.__webglMultisampledFramebuffer),tn.__webglColorRenderbuffer&&S.deleteRenderbuffer(tn.__webglColorRenderbuffer),tn.__webglDepthRenderbuffer&&S.deleteRenderbuffer(tn.__webglDepthRenderbuffer);if(Rt.isWebGLMultipleRenderTargets)for(let Zn=0,qn=Gt.length;Zn<qn;Zn++){const on=p.get(Gt[Zn]);on.__webglTexture&&(S.deleteTexture(on.__webglTexture),L.memory.textures--),p.remove(Gt[Zn])}p.remove(Gt),p.remove(Rt)}}(st)}let xt=0;function Dt(Ze,st){const Rt=p.get(Ze);if(Ze.isVideoTexture&&function(Gt){const tn=L.render.frame;ie.get(Gt)!==tn&&(ie.set(Gt,tn),Gt.update())}(Ze),Ze.version>0&&Rt.__version!==Ze.version){const Gt=Ze.image;if(void 0===Gt)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==Gt.complete)return void ct(Rt,Ze,st);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}c.activeTexture(33984+st),c.bindTexture(3553,Rt.__webglTexture)}function Ht(Ze,st){const Rt=p.get(Ze);Ze.version>0&&Rt.__version!==Ze.version?function(Gt,tn,En){if(6!==tn.image.length)return;Nt(Gt,tn),c.activeTexture(33984+En),c.bindTexture(34067,Gt.__webglTexture),S.pixelStorei(37440,tn.flipY),S.pixelStorei(37441,tn.premultiplyAlpha),S.pixelStorei(3317,tn.unpackAlignment),S.pixelStorei(37443,0);const Zn=tn&&(tn.isCompressedTexture||tn.image[0].isCompressedTexture),qn=tn.image[0]&&tn.image[0].isDataTexture,on=[];for(let mr=0;mr<6;mr++)on[mr]=Zn||qn?qn?tn.image[mr].image:tn.image[mr]:Ne(tn.image[mr],!1,!0,z);const dt=on[0],sn=$e(dt)||O,Sn=w.convert(tn.format),hn=w.convert(tn.type),Wt=We(tn.internalFormat,Sn,hn);let xr;if(Vt(34067,tn,sn),Zn){for(let mr=0;mr<6;mr++){xr=on[mr].mipmaps;for(let Br=0;Br<xr.length;Br++){const Gi=xr[Br];tn.format!==lo&&tn.format!==Rs?null!==Sn?c.compressedTexImage2D(34069+mr,Br,Wt,Gi.width,Gi.height,0,Gi.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):c.texImage2D(34069+mr,Br,Wt,Gi.width,Gi.height,0,Sn,hn,Gi.data)}}Gt.__maxMipLevel=xr.length-1}else{xr=tn.mipmaps;for(let mr=0;mr<6;mr++)if(qn){c.texImage2D(34069+mr,0,Wt,on[mr].width,on[mr].height,0,Sn,hn,on[mr].data);for(let Br=0;Br<xr.length;Br++){const Gi=xr[Br].image[mr].image;c.texImage2D(34069+mr,Br+1,Wt,Gi.width,Gi.height,0,Sn,hn,Gi.data)}}else{c.texImage2D(34069+mr,0,Wt,Sn,hn,on[mr]);for(let Br=0;Br<xr.length;Br++)c.texImage2D(34069+mr,Br+1,Wt,Sn,hn,xr[Br].image[mr])}Gt.__maxMipLevel=xr.length}ze(tn,sn)&&Ye(34067,tn,dt.width,dt.height),Gt.__version=tn.version,tn.onUpdate&&tn.onUpdate(tn)}(Rt,Ze,st):(c.activeTexture(33984+st),c.bindTexture(34067,Rt.__webglTexture))}const Je={[vo]:10497,[Xr]:33071,[ss]:33648},pt={[Or]:9728,[Na]:9984,[ps]:9986,[ii]:9729,[Pc]:9985,[Ya]:9987};function Vt(Ze,st,Rt){if(Rt?(S.texParameteri(Ze,10242,Je[st.wrapS]),S.texParameteri(Ze,10243,Je[st.wrapT]),32879!==Ze&&35866!==Ze||S.texParameteri(Ze,32882,Je[st.wrapR]),S.texParameteri(Ze,10240,pt[st.magFilter]),S.texParameteri(Ze,10241,pt[st.minFilter])):(S.texParameteri(Ze,10242,33071),S.texParameteri(Ze,10243,33071),32879!==Ze&&35866!==Ze||S.texParameteri(Ze,32882,33071),st.wrapS===Xr&&st.wrapT===Xr||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),S.texParameteri(Ze,10240,nt(st.magFilter)),S.texParameteri(Ze,10241,nt(st.minFilter)),st.minFilter!==Or&&st.minFilter!==ii&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===e.has("EXT_texture_filter_anisotropic")){const Gt=e.get("EXT_texture_filter_anisotropic");if(st.type===Vo&&!1===e.has("OES_texture_float_linear")||!1===O&&st.type===ds&&!1===e.has("OES_texture_half_float_linear"))return;(st.anisotropy>1||p.get(st).__currentAnisotropy)&&(S.texParameterf(Ze,Gt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(st.anisotropy,_.getMaxAnisotropy())),p.get(st).__currentAnisotropy=st.anisotropy)}}function Nt(Ze,st){void 0===Ze.__webglInit&&(Ze.__webglInit=!0,st.addEventListener("dispose",it),Ze.__webglTexture=S.createTexture(),L.memory.textures++)}function ct(Ze,st,Rt){let Gt=3553;st.isDataTexture2DArray&&(Gt=35866),st.isDataTexture3D&&(Gt=32879),Nt(Ze,st),c.activeTexture(33984+Rt),c.bindTexture(Gt,Ze.__webglTexture),S.pixelStorei(37440,st.flipY),S.pixelStorei(37441,st.premultiplyAlpha),S.pixelStorei(3317,st.unpackAlignment),S.pixelStorei(37443,0);const tn=(hn=st,!O&&(hn.wrapS!==Xr||hn.wrapT!==Xr||hn.minFilter!==Or&&hn.minFilter!==ii)&&!1===$e(st.image)),En=Ne(st.image,tn,!1,Q),Zn=$e(En)||O,qn=w.convert(st.format);var hn;let on,dt=w.convert(st.type),sn=We(st.internalFormat,qn,dt);Vt(Gt,st,Zn);const Sn=st.mipmaps;if(st.isDepthTexture)sn=6402,O?sn=st.type===Vo?36012:st.type===Vs?33190:st.type===Es?35056:33189:st.type===Vo&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),st.format===To&&6402===sn&&st.type!==Ic&&st.type!==Vs&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),st.type=Ic,dt=w.convert(st.type)),st.format===Ws&&6402===sn&&(sn=34041,st.type!==Es&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),st.type=Es,dt=w.convert(st.type))),c.texImage2D(3553,0,sn,En.width,En.height,0,qn,dt,null);else if(st.isDataTexture)if(Sn.length>0&&Zn){for(let hn=0,Wt=Sn.length;hn<Wt;hn++)on=Sn[hn],c.texImage2D(3553,hn,sn,on.width,on.height,0,qn,dt,on.data);st.generateMipmaps=!1,Ze.__maxMipLevel=Sn.length-1}else c.texImage2D(3553,0,sn,En.width,En.height,0,qn,dt,En.data),Ze.__maxMipLevel=0;else if(st.isCompressedTexture){for(let hn=0,Wt=Sn.length;hn<Wt;hn++)on=Sn[hn],st.format!==lo&&st.format!==Rs?null!==qn?c.compressedTexImage2D(3553,hn,sn,on.width,on.height,0,on.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):c.texImage2D(3553,hn,sn,on.width,on.height,0,qn,dt,on.data);Ze.__maxMipLevel=Sn.length-1}else if(st.isDataTexture2DArray)c.texImage3D(35866,0,sn,En.width,En.height,En.depth,0,qn,dt,En.data),Ze.__maxMipLevel=0;else if(st.isDataTexture3D)c.texImage3D(32879,0,sn,En.width,En.height,En.depth,0,qn,dt,En.data),Ze.__maxMipLevel=0;else if(Sn.length>0&&Zn){for(let hn=0,Wt=Sn.length;hn<Wt;hn++)on=Sn[hn],c.texImage2D(3553,hn,sn,qn,dt,on);st.generateMipmaps=!1,Ze.__maxMipLevel=Sn.length-1}else c.texImage2D(3553,0,sn,qn,dt,En),Ze.__maxMipLevel=0;ze(st,Zn)&&Ye(Gt,st,En.width,En.height),Ze.__version=st.version,st.onUpdate&&st.onUpdate(st)}function Yt(Ze,st,Rt,Gt,tn){const En=w.convert(Rt.format),Zn=w.convert(Rt.type),qn=We(Rt.internalFormat,En,Zn);32879===tn||35866===tn?c.texImage3D(tn,0,qn,st.width,st.height,st.depth,0,En,Zn,null):c.texImage2D(tn,0,qn,st.width,st.height,0,En,Zn,null),c.bindFramebuffer(36160,Ze),S.framebufferTexture2D(36160,Gt,tn,p.get(Rt).__webglTexture,0),c.bindFramebuffer(36160,null)}function St(Ze,st,Rt){if(S.bindRenderbuffer(36161,Ze),st.depthBuffer&&!st.stencilBuffer){let Gt=33189;if(Rt){const tn=st.depthTexture;tn&&tn.isDepthTexture&&(tn.type===Vo?Gt=36012:tn.type===Vs&&(Gt=33190));const En=jt(st);S.renderbufferStorageMultisample(36161,En,Gt,st.width,st.height)}else S.renderbufferStorage(36161,Gt,st.width,st.height);S.framebufferRenderbuffer(36160,36096,36161,Ze)}else if(st.depthBuffer&&st.stencilBuffer){if(Rt){const Gt=jt(st);S.renderbufferStorageMultisample(36161,Gt,35056,st.width,st.height)}else S.renderbufferStorage(36161,34041,st.width,st.height);S.framebufferRenderbuffer(36160,33306,36161,Ze)}else{const Gt=!0===st.isWebGLMultipleRenderTargets?st.texture[0]:st.texture,tn=w.convert(Gt.format),En=w.convert(Gt.type),Zn=We(Gt.internalFormat,tn,En);if(Rt){const qn=jt(st);S.renderbufferStorageMultisample(36161,qn,Zn,st.width,st.height)}else S.renderbufferStorage(36161,Zn,st.width,st.height)}S.bindRenderbuffer(36161,null)}function jt(Ze){return O&&Ze.isWebGLMultisampleRenderTarget?Math.min(ae,Ze.samples):0}let It=!1,an=!1;this.allocateTextureUnit=function(){const Ze=xt;return Ze>=D&&console.warn("THREE.WebGLTextures: Trying to use "+Ze+" texture units while this GPU supports only "+D),xt+=1,Ze},this.resetTextureUnits=function(){xt=0},this.setTexture2D=Dt,this.setTexture2DArray=function(Ze,st){const Rt=p.get(Ze);Ze.version>0&&Rt.__version!==Ze.version?ct(Rt,Ze,st):(c.activeTexture(33984+st),c.bindTexture(35866,Rt.__webglTexture))},this.setTexture3D=function(Ze,st){const Rt=p.get(Ze);Ze.version>0&&Rt.__version!==Ze.version?ct(Rt,Ze,st):(c.activeTexture(33984+st),c.bindTexture(32879,Rt.__webglTexture))},this.setTextureCube=Ht,this.setupRenderTarget=function(Ze){const st=Ze.texture,Rt=p.get(Ze),Gt=p.get(st);Ze.addEventListener("dispose",mt),!0!==Ze.isWebGLMultipleRenderTargets&&(Gt.__webglTexture=S.createTexture(),Gt.__version=st.version,L.memory.textures++);const tn=!0===Ze.isWebGLCubeRenderTarget,En=!0===Ze.isWebGLMultipleRenderTargets,Zn=!0===Ze.isWebGLMultisampleRenderTarget,qn=st.isDataTexture3D||st.isDataTexture2DArray,on=$e(Ze)||O;if(!O||st.format!==Rs||st.type!==Vo&&st.type!==ds||(st.format=lo,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),tn){Rt.__webglFramebuffer=[];for(let dt=0;dt<6;dt++)Rt.__webglFramebuffer[dt]=S.createFramebuffer()}else if(Rt.__webglFramebuffer=S.createFramebuffer(),En)if(_.drawBuffers){const dt=Ze.texture;for(let sn=0,Sn=dt.length;sn<Sn;sn++){const hn=p.get(dt[sn]);void 0===hn.__webglTexture&&(hn.__webglTexture=S.createTexture(),L.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(Zn)if(O){Rt.__webglMultisampledFramebuffer=S.createFramebuffer(),Rt.__webglColorRenderbuffer=S.createRenderbuffer(),S.bindRenderbuffer(36161,Rt.__webglColorRenderbuffer);const dt=w.convert(st.format),sn=w.convert(st.type),Sn=We(st.internalFormat,dt,sn),hn=jt(Ze);S.renderbufferStorageMultisample(36161,hn,Sn,Ze.width,Ze.height),c.bindFramebuffer(36160,Rt.__webglMultisampledFramebuffer),S.framebufferRenderbuffer(36160,36064,36161,Rt.__webglColorRenderbuffer),S.bindRenderbuffer(36161,null),Ze.depthBuffer&&(Rt.__webglDepthRenderbuffer=S.createRenderbuffer(),St(Rt.__webglDepthRenderbuffer,Ze,!0)),c.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(tn){c.bindTexture(34067,Gt.__webglTexture),Vt(34067,st,on);for(let dt=0;dt<6;dt++)Yt(Rt.__webglFramebuffer[dt],Ze,st,36064,34069+dt);ze(st,on)&&Ye(34067,st,Ze.width,Ze.height),c.unbindTexture()}else if(En){const dt=Ze.texture;for(let sn=0,Sn=dt.length;sn<Sn;sn++){const hn=dt[sn],Wt=p.get(hn);c.bindTexture(3553,Wt.__webglTexture),Vt(3553,hn,on),Yt(Rt.__webglFramebuffer,Ze,hn,36064+sn,3553),ze(hn,on)&&Ye(3553,hn,Ze.width,Ze.height)}c.unbindTexture()}else{let dt=3553;qn&&(O?dt=st.isDataTexture3D?32879:35866:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),c.bindTexture(dt,Gt.__webglTexture),Vt(dt,st,on),Yt(Rt.__webglFramebuffer,Ze,st,36064,dt),ze(st,on)&&Ye(dt,st,Ze.width,Ze.height,Ze.depth),c.unbindTexture()}Ze.depthBuffer&&function(dt){const sn=p.get(dt),Sn=!0===dt.isWebGLCubeRenderTarget;if(dt.depthTexture){if(Sn)throw new Error("target.depthTexture not supported in Cube render targets");!function(hn,Wt){if(Wt&&Wt.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(c.bindFramebuffer(36160,hn),!Wt.depthTexture||!Wt.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");p.get(Wt.depthTexture).__webglTexture&&Wt.depthTexture.image.width===Wt.width&&Wt.depthTexture.image.height===Wt.height||(Wt.depthTexture.image.width=Wt.width,Wt.depthTexture.image.height=Wt.height,Wt.depthTexture.needsUpdate=!0),Dt(Wt.depthTexture,0);const xr=p.get(Wt.depthTexture).__webglTexture;if(Wt.depthTexture.format===To)S.framebufferTexture2D(36160,36096,3553,xr,0);else{if(Wt.depthTexture.format!==Ws)throw new Error("Unknown depthTexture format");S.framebufferTexture2D(36160,33306,3553,xr,0)}}(sn.__webglFramebuffer,dt)}else if(Sn){sn.__webglDepthbuffer=[];for(let hn=0;hn<6;hn++)c.bindFramebuffer(36160,sn.__webglFramebuffer[hn]),sn.__webglDepthbuffer[hn]=S.createRenderbuffer(),St(sn.__webglDepthbuffer[hn],dt,!1)}else c.bindFramebuffer(36160,sn.__webglFramebuffer),sn.__webglDepthbuffer=S.createRenderbuffer(),St(sn.__webglDepthbuffer,dt,!1);c.bindFramebuffer(36160,null)}(Ze)},this.updateRenderTargetMipmap=function(Ze){const st=$e(Ze)||O,Rt=!0===Ze.isWebGLMultipleRenderTargets?Ze.texture:[Ze.texture];for(let Gt=0,tn=Rt.length;Gt<tn;Gt++){const En=Rt[Gt];if(ze(En,st)){const Zn=Ze.isWebGLCubeRenderTarget?34067:3553,qn=p.get(En).__webglTexture;c.bindTexture(Zn,qn),Ye(Zn,En,Ze.width,Ze.height),c.unbindTexture()}}},this.updateMultisampleRenderTarget=function(Ze){if(Ze.isWebGLMultisampleRenderTarget)if(O){const st=Ze.width,Rt=Ze.height;let Gt=16384;Ze.depthBuffer&&(Gt|=256),Ze.stencilBuffer&&(Gt|=1024);const tn=p.get(Ze);c.bindFramebuffer(36008,tn.__webglMultisampledFramebuffer),c.bindFramebuffer(36009,tn.__webglFramebuffer),S.blitFramebuffer(0,0,st,Rt,0,0,st,Rt,Gt,9728),c.bindFramebuffer(36008,null),c.bindFramebuffer(36009,tn.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(Ze,st){Ze&&Ze.isWebGLRenderTarget&&(!1===It&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),It=!0),Ze=Ze.texture),Dt(Ze,st)},this.safeSetTextureCube=function(Ze,st){Ze&&Ze.isWebGLCubeRenderTarget&&(!1===an&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),an=!0),Ze=Ze.texture),Ht(Ze,st)}}function Qd(S,e,c){const p=c.isWebGL2;return{convert:function(_){let w;if(_===ea)return 5121;if(_===Du)return 32819;if(_===pu)return 32820;if(_===du)return 33635;if(_===kl)return 5120;if(_===Ra)return 5122;if(_===Ic)return 5123;if(_===Zp)return 5124;if(_===Vs)return 5125;if(_===Vo)return 5126;if(_===ds)return p?5131:(w=e.get("OES_texture_half_float"),null!==w?w.HALF_FLOAT_OES:null);if(_===dp)return 6406;if(_===Rs)return 6407;if(_===lo)return 6408;if(_===Oc)return 6409;if(_===Uu)return 6410;if(_===To)return 6402;if(_===Ws)return 34041;if(_===Qp)return 6403;if(_===Ja)return 36244;if(_===fu)return 33319;if(_===fp)return 33320;if(_===mp)return 36248;if(_===vh)return 36249;if(_===zh||_===ic||_===jh||_===yh){if(w=e.get("WEBGL_compressed_texture_s3tc"),null===w)return null;if(_===zh)return w.COMPRESSED_RGB_S3TC_DXT1_EXT;if(_===ic)return w.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(_===jh)return w.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(_===yh)return w.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(_===Gh||_===vl||_===yl||_===Fl){if(w=e.get("WEBGL_compressed_texture_pvrtc"),null===w)return null;if(_===Gh)return w.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(_===vl)return w.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(_===yl)return w.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(_===Fl)return w.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(_===zu)return w=e.get("WEBGL_compressed_texture_etc1"),null!==w?w.COMPRESSED_RGB_ETC1_WEBGL:null;if((_===fs||_===Dl)&&(w=e.get("WEBGL_compressed_texture_etc"),null!==w)){if(_===fs)return w.COMPRESSED_RGB8_ETC2;if(_===Dl)return w.COMPRESSED_RGBA8_ETC2_EAC}return _===ju||_===_p||_===gp||_===kc||_===oc||_===bh||_===vp||_===Gu||_===Hu||_===Za||_===Hh||_===Qa||_===Vh||_===Vu||_===ac||_===xh||_===mu||_===Fc||_===yp||_===Dc||_===Wu||_===Ul||_===bp||_===Wh||_===xp||_===wp||_===qh||_===Kp?(w=e.get("WEBGL_compressed_texture_astc"),null!==w?_:null):_===sc?(w=e.get("EXT_texture_compression_bptc"),null!==w?_:null):_===Es?p?34042:(w=e.get("WEBGL_depth_texture"),null!==w?w.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}class Kd extends Io{constructor(e=[]){super(),this.cameras=e}}Kd.prototype.isArrayCamera=!0;class jp extends Ir{constructor(){super(),this.type="Group"}}jp.prototype.isGroup=!0;const hm={type:"move"};class Md{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new jp,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new jp,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new lt,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new lt),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new jp,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new lt,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new lt),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,c,p){let _=null,w=null,L=null;const O=this._targetRay,D=this._grip,z=this._hand;if(e&&"visible-blurred"!==c.session.visibilityState)if(null!==O&&(_=c.getPose(e.targetRaySpace,p),null!==_&&(O.matrix.fromArray(_.transform.matrix),O.matrix.decompose(O.position,O.rotation,O.scale),_.linearVelocity?(O.hasLinearVelocity=!0,O.linearVelocity.copy(_.linearVelocity)):O.hasLinearVelocity=!1,_.angularVelocity?(O.hasAngularVelocity=!0,O.angularVelocity.copy(_.angularVelocity)):O.hasAngularVelocity=!1,this.dispatchEvent(hm))),z&&e.hand){L=!0;for(const Me of e.hand.values()){const Ne=c.getJointPose(Me,p);if(void 0===z.joints[Me.jointName]){const ze=new jp;ze.matrixAutoUpdate=!1,ze.visible=!1,z.joints[Me.jointName]=ze,z.add(ze)}const $e=z.joints[Me.jointName];null!==Ne&&($e.matrix.fromArray(Ne.transform.matrix),$e.matrix.decompose($e.position,$e.rotation,$e.scale),$e.jointRadius=Ne.radius),$e.visible=null!==Ne}const ie=z.joints["index-finger-tip"].position.distanceTo(z.joints["thumb-tip"].position),he=.02,ye=.005;z.inputState.pinching&&ie>he+ye?(z.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!z.inputState.pinching&&ie<=he-ye&&(z.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==D&&e.gripSpace&&(w=c.getPose(e.gripSpace,p),null!==w&&(D.matrix.fromArray(w.transform.matrix),D.matrix.decompose(D.position,D.rotation,D.scale),w.linearVelocity?(D.hasLinearVelocity=!0,D.linearVelocity.copy(w.linearVelocity)):D.hasLinearVelocity=!1,w.angularVelocity?(D.hasAngularVelocity=!0,D.angularVelocity.copy(w.angularVelocity)):D.hasAngularVelocity=!1));return null!==O&&(O.visible=null!==_),null!==D&&(D.visible=null!==w),null!==z&&(z.visible=null!==L),this}}class Tc extends Ps{constructor(e,c){super();const p=this,_=e.state;let w=null,L=1,O=null,D="local-floor",z=null,Q=null,ae=null,ie=null,he=null,ye=!1,Me=null,Ne=null,$e=null,ze=null,Ye=null,We=null;const nt=[],it=new Map,mt=new Io;mt.layers.enable(1),mt.viewport=new Hi;const xt=new Io;xt.layers.enable(2),xt.viewport=new Hi;const Dt=[mt,xt],Ht=new Kd;Ht.layers.enable(1),Ht.layers.enable(2);let Je=null,pt=null;function Vt(Ze){const st=it.get(Ze.inputSource);st&&st.dispatchEvent({type:Ze.type,data:Ze.inputSource})}function Nt(){it.forEach(function(Ze,st){Ze.disconnect(st)}),it.clear(),Je=null,pt=null,_.bindXRFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),ae&&c.deleteFramebuffer(ae),Me&&c.deleteFramebuffer(Me),Ne&&c.deleteRenderbuffer(Ne),$e&&c.deleteRenderbuffer($e),ae=null,Me=null,Ne=null,$e=null,he=null,ie=null,Q=null,w=null,an.stop(),p.isPresenting=!1,p.dispatchEvent({type:"sessionend"})}function ct(Ze){const st=w.inputSources;for(let Rt=0;Rt<nt.length;Rt++)it.set(st[Rt],nt[Rt]);for(let Rt=0;Rt<Ze.removed.length;Rt++){const Gt=Ze.removed[Rt],tn=it.get(Gt);tn&&(tn.dispatchEvent({type:"disconnected",data:Gt}),it.delete(Gt))}for(let Rt=0;Rt<Ze.added.length;Rt++){const Gt=Ze.added[Rt],tn=it.get(Gt);tn&&tn.dispatchEvent({type:"connected",data:Gt})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Ze){let st=nt[Ze];return void 0===st&&(st=new Md,nt[Ze]=st),st.getTargetRaySpace()},this.getControllerGrip=function(Ze){let st=nt[Ze];return void 0===st&&(st=new Md,nt[Ze]=st),st.getGripSpace()},this.getHand=function(Ze){let st=nt[Ze];return void 0===st&&(st=new Md,nt[Ze]=st),st.getHandSpace()},this.setFramebufferScaleFactor=function(Ze){L=Ze,!0===p.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Ze){D=Ze,!0===p.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return O},this.getBaseLayer=function(){return null!==ie?ie:he},this.getBinding=function(){return Q},this.getFrame=function(){return ze},this.getSession=function(){return w},this.setSession=async function(Ze){if(w=Ze,null!==w){w.addEventListener("select",Vt),w.addEventListener("selectstart",Vt),w.addEventListener("selectend",Vt),w.addEventListener("squeeze",Vt),w.addEventListener("squeezestart",Vt),w.addEventListener("squeezeend",Vt),w.addEventListener("end",Nt),w.addEventListener("inputsourceschange",ct);const st=c.getContextAttributes();if(!0!==st.xrCompatible&&await c.makeXRCompatible(),void 0===w.renderState.layers)he=new XRWebGLLayer(w,c,{antialias:st.antialias,alpha:st.alpha,depth:st.depth,stencil:st.stencil,framebufferScaleFactor:L}),w.updateRenderState({baseLayer:he});else if(c instanceof WebGLRenderingContext)he=new XRWebGLLayer(w,c,{antialias:!0,alpha:st.alpha,depth:st.depth,stencil:st.stencil,framebufferScaleFactor:L}),w.updateRenderState({layers:[he]});else{ye=st.antialias;let Rt=null;st.depth&&(We=256,st.stencil&&(We|=1024),Ye=st.stencil?33306:36096,Rt=st.stencil?35056:33190);const Gt={colorFormat:st.alpha?32856:32849,depthFormat:Rt,scaleFactor:L};Q=new XRWebGLBinding(w,c),ie=Q.createProjectionLayer(Gt),ae=c.createFramebuffer(),w.updateRenderState({layers:[ie]}),ye&&(Me=c.createFramebuffer(),Ne=c.createRenderbuffer(),c.bindRenderbuffer(36161,Ne),c.renderbufferStorageMultisample(36161,4,32856,ie.textureWidth,ie.textureHeight),_.bindFramebuffer(36160,Me),c.framebufferRenderbuffer(36160,36064,36161,Ne),c.bindRenderbuffer(36161,null),null!==Rt&&($e=c.createRenderbuffer(),c.bindRenderbuffer(36161,$e),c.renderbufferStorageMultisample(36161,4,Rt,ie.textureWidth,ie.textureHeight),c.framebufferRenderbuffer(36160,Ye,36161,$e),c.bindRenderbuffer(36161,null)),_.bindFramebuffer(36160,null))}O=await w.requestReferenceSpace(D),an.setContext(w),an.start(),p.isPresenting=!0,p.dispatchEvent({type:"sessionstart"})}};const Yt=new lt,St=new lt;function jt(Ze,st){null===st?Ze.matrixWorld.copy(Ze.matrix):Ze.matrixWorld.multiplyMatrices(st.matrixWorld,Ze.matrix),Ze.matrixWorldInverse.copy(Ze.matrixWorld).invert()}this.updateCamera=function(Ze){if(null===w)return;Ht.near=xt.near=mt.near=Ze.near,Ht.far=xt.far=mt.far=Ze.far,Je===Ht.near&&pt===Ht.far||(w.updateRenderState({depthNear:Ht.near,depthFar:Ht.far}),Je=Ht.near,pt=Ht.far);const st=Ze.parent,Rt=Ht.cameras;jt(Ht,st);for(let tn=0;tn<Rt.length;tn++)jt(Rt[tn],st);Ht.matrixWorld.decompose(Ht.position,Ht.quaternion,Ht.scale),Ze.position.copy(Ht.position),Ze.quaternion.copy(Ht.quaternion),Ze.scale.copy(Ht.scale),Ze.matrix.copy(Ht.matrix),Ze.matrixWorld.copy(Ht.matrixWorld);const Gt=Ze.children;for(let tn=0,En=Gt.length;tn<En;tn++)Gt[tn].updateMatrixWorld(!0);2===Rt.length?function(tn,En,Zn){Yt.setFromMatrixPosition(En.matrixWorld),St.setFromMatrixPosition(Zn.matrixWorld);const qn=Yt.distanceTo(St),on=En.projectionMatrix.elements,dt=Zn.projectionMatrix.elements,sn=on[14]/(on[10]-1),Sn=on[14]/(on[10]+1),hn=(on[9]+1)/on[5],Wt=(on[9]-1)/on[5],xr=(on[8]-1)/on[0],mr=(dt[8]+1)/dt[0],Br=sn*xr,Gi=sn*mr,_o=qn/(-xr+mr),ml=_o*-xr;En.matrixWorld.decompose(tn.position,tn.quaternion,tn.scale),tn.translateX(ml),tn.translateZ(_o),tn.matrixWorld.compose(tn.position,tn.quaternion,tn.scale),tn.matrixWorldInverse.copy(tn.matrixWorld).invert();const Ho=sn+_o,_l=Sn+_o;tn.projectionMatrix.makePerspective(Br-ml,Gi+(qn-ml),hn*Sn/_l*Ho,Wt*Sn/_l*Ho,Ho,_l)}(Ht,mt,xt):Ht.projectionMatrix.copy(mt.projectionMatrix)},this.getCamera=function(){return Ht},this.getFoveation=function(){return null!==ie?ie.fixedFoveation:null!==he?he.fixedFoveation:void 0},this.setFoveation=function(Ze){null!==ie&&(ie.fixedFoveation=Ze),null!==he&&void 0!==he.fixedFoveation&&(he.fixedFoveation=Ze)};let It=null;const an=new wc;an.setAnimationLoop(function(Ze,st){if(z=st.getViewerPose(O),ze=st,null!==z){const Gt=z.views;null!==he&&_.bindXRFramebuffer(he.framebuffer);let tn=!1;Gt.length!==Ht.cameras.length&&(Ht.cameras.length=0,tn=!0);for(let En=0;En<Gt.length;En++){const Zn=Gt[En];let qn=null;if(null!==he)qn=he.getViewport(Zn);else{const dt=Q.getViewSubImage(ie,Zn);_.bindXRFramebuffer(ae),void 0!==dt.depthStencilTexture&&c.framebufferTexture2D(36160,Ye,3553,dt.depthStencilTexture,0),c.framebufferTexture2D(36160,36064,3553,dt.colorTexture,0),qn=dt.viewport}const on=Dt[En];on.matrix.fromArray(Zn.transform.matrix),on.projectionMatrix.fromArray(Zn.projectionMatrix),on.viewport.set(qn.x,qn.y,qn.width,qn.height),0===En&&Ht.matrix.copy(on.matrix),!0===tn&&Ht.cameras.push(on)}ye&&(_.bindXRFramebuffer(Me),null!==We&&c.clear(We))}const Rt=w.inputSources;for(let Gt=0;Gt<nt.length;Gt++)nt[Gt].update(Rt[Gt],st,O);if(It&&It(Ze,st),ye){const Gt=ie.textureWidth,tn=ie.textureHeight;_.bindFramebuffer(36008,Me),_.bindFramebuffer(36009,ae),c.invalidateFramebuffer(36008,[Ye]),c.invalidateFramebuffer(36009,[Ye]),c.blitFramebuffer(0,0,Gt,tn,0,0,Gt,tn,16384,9728),c.invalidateFramebuffer(36008,[36064]),_.bindFramebuffer(36008,null),_.bindFramebuffer(36009,null),_.bindFramebuffer(36160,Me)}ze=null}),this.setAnimationLoop=function(Ze){It=Ze},this.dispose=function(){}}}function Ad(S){function e(p,_){p.opacity.value=_.opacity,_.color&&p.diffuse.value.copy(_.color),_.emissive&&p.emissive.value.copy(_.emissive).multiplyScalar(_.emissiveIntensity),_.map&&(p.map.value=_.map),_.alphaMap&&(p.alphaMap.value=_.alphaMap),_.specularMap&&(p.specularMap.value=_.specularMap),_.alphaTest>0&&(p.alphaTest.value=_.alphaTest);const w=S.get(_).envMap;if(w){p.envMap.value=w,p.flipEnvMap.value=w.isCubeTexture&&!1===w.isRenderTargetTexture?-1:1,p.reflectivity.value=_.reflectivity,p.ior.value=_.ior,p.refractionRatio.value=_.refractionRatio;const D=S.get(w).__maxMipLevel;void 0!==D&&(p.maxMipLevel.value=D)}let L,O;_.lightMap&&(p.lightMap.value=_.lightMap,p.lightMapIntensity.value=_.lightMapIntensity),_.aoMap&&(p.aoMap.value=_.aoMap,p.aoMapIntensity.value=_.aoMapIntensity),_.map?L=_.map:_.specularMap?L=_.specularMap:_.displacementMap?L=_.displacementMap:_.normalMap?L=_.normalMap:_.bumpMap?L=_.bumpMap:_.roughnessMap?L=_.roughnessMap:_.metalnessMap?L=_.metalnessMap:_.alphaMap?L=_.alphaMap:_.emissiveMap?L=_.emissiveMap:_.clearcoatMap?L=_.clearcoatMap:_.clearcoatNormalMap?L=_.clearcoatNormalMap:_.clearcoatRoughnessMap?L=_.clearcoatRoughnessMap:_.specularIntensityMap?L=_.specularIntensityMap:_.specularTintMap?L=_.specularTintMap:_.transmissionMap?L=_.transmissionMap:_.thicknessMap&&(L=_.thicknessMap),void 0!==L&&(L.isWebGLRenderTarget&&(L=L.texture),!0===L.matrixAutoUpdate&&L.updateMatrix(),p.uvTransform.value.copy(L.matrix)),_.aoMap?O=_.aoMap:_.lightMap&&(O=_.lightMap),void 0!==O&&(O.isWebGLRenderTarget&&(O=O.texture),!0===O.matrixAutoUpdate&&O.updateMatrix(),p.uv2Transform.value.copy(O.matrix))}function c(p,_){p.roughness.value=_.roughness,p.metalness.value=_.metalness,_.roughnessMap&&(p.roughnessMap.value=_.roughnessMap),_.metalnessMap&&(p.metalnessMap.value=_.metalnessMap),_.emissiveMap&&(p.emissiveMap.value=_.emissiveMap),_.bumpMap&&(p.bumpMap.value=_.bumpMap,p.bumpScale.value=_.bumpScale,_.side===le&&(p.bumpScale.value*=-1)),_.normalMap&&(p.normalMap.value=_.normalMap,p.normalScale.value.copy(_.normalScale),_.side===le&&p.normalScale.value.negate()),_.displacementMap&&(p.displacementMap.value=_.displacementMap,p.displacementScale.value=_.displacementScale,p.displacementBias.value=_.displacementBias),S.get(_).envMap&&(p.envMapIntensity.value=_.envMapIntensity)}return{refreshFogUniforms:function(p,_){p.fogColor.value.copy(_.color),_.isFog?(p.fogNear.value=_.near,p.fogFar.value=_.far):_.isFogExp2&&(p.fogDensity.value=_.density)},refreshMaterialUniforms:function(p,_,w,L,O){var z;_.isMeshBasicMaterial?e(p,_):_.isMeshLambertMaterial?(e(p,_),(z=_).emissiveMap&&(p.emissiveMap.value=z.emissiveMap)):_.isMeshToonMaterial?(e(p,_),function(D,z){z.gradientMap&&(D.gradientMap.value=z.gradientMap),z.emissiveMap&&(D.emissiveMap.value=z.emissiveMap),z.bumpMap&&(D.bumpMap.value=z.bumpMap,D.bumpScale.value=z.bumpScale,z.side===le&&(D.bumpScale.value*=-1)),z.normalMap&&(D.normalMap.value=z.normalMap,D.normalScale.value.copy(z.normalScale),z.side===le&&D.normalScale.value.negate()),z.displacementMap&&(D.displacementMap.value=z.displacementMap,D.displacementScale.value=z.displacementScale,D.displacementBias.value=z.displacementBias)}(p,_)):_.isMeshPhongMaterial?(e(p,_),function(D,z){D.specular.value.copy(z.specular),D.shininess.value=Math.max(z.shininess,1e-4),z.emissiveMap&&(D.emissiveMap.value=z.emissiveMap),z.bumpMap&&(D.bumpMap.value=z.bumpMap,D.bumpScale.value=z.bumpScale,z.side===le&&(D.bumpScale.value*=-1)),z.normalMap&&(D.normalMap.value=z.normalMap,D.normalScale.value.copy(z.normalScale),z.side===le&&D.normalScale.value.negate()),z.displacementMap&&(D.displacementMap.value=z.displacementMap,D.displacementScale.value=z.displacementScale,D.displacementBias.value=z.displacementBias)}(p,_)):_.isMeshStandardMaterial?(e(p,_),_.isMeshPhysicalMaterial?function(D,z,Q){c(D,z),D.ior.value=z.ior,z.sheenTint&&D.sheenTint.value.copy(z.sheenTint),z.clearcoat>0&&(D.clearcoat.value=z.clearcoat,D.clearcoatRoughness.value=z.clearcoatRoughness,z.clearcoatMap&&(D.clearcoatMap.value=z.clearcoatMap),z.clearcoatRoughnessMap&&(D.clearcoatRoughnessMap.value=z.clearcoatRoughnessMap),z.clearcoatNormalMap&&(D.clearcoatNormalScale.value.copy(z.clearcoatNormalScale),D.clearcoatNormalMap.value=z.clearcoatNormalMap,z.side===le&&D.clearcoatNormalScale.value.negate())),z.transmission>0&&(D.transmission.value=z.transmission,D.transmissionSamplerMap.value=Q.texture,D.transmissionSamplerSize.value.set(Q.width,Q.height),z.transmissionMap&&(D.transmissionMap.value=z.transmissionMap),D.thickness.value=z.thickness,z.thicknessMap&&(D.thicknessMap.value=z.thicknessMap),D.attenuationDistance.value=z.attenuationDistance,D.attenuationTint.value.copy(z.attenuationTint)),D.specularIntensity.value=z.specularIntensity,D.specularTint.value.copy(z.specularTint),z.specularIntensityMap&&(D.specularIntensityMap.value=z.specularIntensityMap),z.specularTintMap&&(D.specularTintMap.value=z.specularTintMap)}(p,_,O):c(p,_)):_.isMeshMatcapMaterial?(e(p,_),function(D,z){z.matcap&&(D.matcap.value=z.matcap),z.bumpMap&&(D.bumpMap.value=z.bumpMap,D.bumpScale.value=z.bumpScale,z.side===le&&(D.bumpScale.value*=-1)),z.normalMap&&(D.normalMap.value=z.normalMap,D.normalScale.value.copy(z.normalScale),z.side===le&&D.normalScale.value.negate()),z.displacementMap&&(D.displacementMap.value=z.displacementMap,D.displacementScale.value=z.displacementScale,D.displacementBias.value=z.displacementBias)}(p,_)):_.isMeshDepthMaterial?(e(p,_),function(D,z){z.displacementMap&&(D.displacementMap.value=z.displacementMap,D.displacementScale.value=z.displacementScale,D.displacementBias.value=z.displacementBias)}(p,_)):_.isMeshDistanceMaterial?(e(p,_),function(D,z){z.displacementMap&&(D.displacementMap.value=z.displacementMap,D.displacementScale.value=z.displacementScale,D.displacementBias.value=z.displacementBias),D.referencePosition.value.copy(z.referencePosition),D.nearDistance.value=z.nearDistance,D.farDistance.value=z.farDistance}(p,_)):_.isMeshNormalMaterial?(e(p,_),function(D,z){z.bumpMap&&(D.bumpMap.value=z.bumpMap,D.bumpScale.value=z.bumpScale,z.side===le&&(D.bumpScale.value*=-1)),z.normalMap&&(D.normalMap.value=z.normalMap,D.normalScale.value.copy(z.normalScale),z.side===le&&D.normalScale.value.negate()),z.displacementMap&&(D.displacementMap.value=z.displacementMap,D.displacementScale.value=z.displacementScale,D.displacementBias.value=z.displacementBias)}(p,_)):_.isLineBasicMaterial?(function(D,z){D.diffuse.value.copy(z.color),D.opacity.value=z.opacity}(p,_),_.isLineDashedMaterial&&function(D,z){D.dashSize.value=z.dashSize,D.totalSize.value=z.dashSize+z.gapSize,D.scale.value=z.scale}(p,_)):_.isPointsMaterial?function(D,z,Q,ae){let ie;D.diffuse.value.copy(z.color),D.opacity.value=z.opacity,D.size.value=z.size*Q,D.scale.value=.5*ae,z.map&&(D.map.value=z.map),z.alphaMap&&(D.alphaMap.value=z.alphaMap),z.alphaTest>0&&(D.alphaTest.value=z.alphaTest),z.map?ie=z.map:z.alphaMap&&(ie=z.alphaMap),void 0!==ie&&(!0===ie.matrixAutoUpdate&&ie.updateMatrix(),D.uvTransform.value.copy(ie.matrix))}(p,_,w,L):_.isSpriteMaterial?function(D,z){let Q;D.diffuse.value.copy(z.color),D.opacity.value=z.opacity,D.rotation.value=z.rotation,z.map&&(D.map.value=z.map),z.alphaMap&&(D.alphaMap.value=z.alphaMap),z.alphaTest>0&&(D.alphaTest.value=z.alphaTest),z.map?Q=z.map:z.alphaMap&&(Q=z.alphaMap),void 0!==Q&&(!0===Q.matrixAutoUpdate&&Q.updateMatrix(),D.uvTransform.value.copy(Q.matrix))}(p,_):_.isShadowMaterial?(p.color.value.copy(_.color),p.opacity.value=_.opacity):_.isShaderMaterial&&(_.uniformsNeedUpdate=!1)}}}function Qn(S={}){const e=void 0!==S.canvas?S.canvas:function(){const _t=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return _t.style.display="block",_t}(),c=void 0!==S.context?S.context:null,p=void 0!==S.alpha&&S.alpha,_=void 0===S.depth||S.depth,w=void 0===S.stencil||S.stencil,L=void 0!==S.antialias&&S.antialias,O=void 0===S.premultipliedAlpha||S.premultipliedAlpha,D=void 0!==S.preserveDrawingBuffer&&S.preserveDrawingBuffer,z=void 0!==S.powerPreference?S.powerPreference:"default",Q=void 0!==S.failIfMajorPerformanceCaveat&&S.failIfMajorPerformanceCaveat;let ae=null,ie=null;const he=[],ye=[];this.domElement=e,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=Qi,this.physicallyCorrectLights=!1,this.toneMapping=vr,this.toneMappingExposure=1;const Me=this;let Ne=!1,$e=0,ze=0,Ye=null,We=-1,nt=null;const it=new Hi,mt=new Hi;let xt=null,Dt=e.width,Ht=e.height,Je=1,pt=null,Vt=null;const Nt=new Hi(0,0,Dt,Ht),ct=new Hi(0,0,Dt,Ht);let Yt=!1;const St=[],jt=new Dr;let It=!1,an=!1,Ze=null;const st=new Qt,Rt=new lt,Gt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function tn(){return null===Ye?Je:1}let En,Zn,qn,on,dt,sn,Sn,hn,Wt,xr,mr,Br,Gi,_o,ml,Ho,_l,uu,pp,Fd,Dd,_h,gl,Vn=c;function Mt(_t,bn){for(let en=0;en<_t.length;en++){const jn=e.getContext(_t[en],bn);if(null!==jn)return jn}return null}try{const _t={alpha:p,depth:_,stencil:w,antialias:L,premultipliedAlpha:O,preserveDrawingBuffer:D,powerPreference:z,failIfMajorPerformanceCaveat:Q};if(e.addEventListener("webglcontextlost",kn,!1),e.addEventListener("webglcontextrestored",_r,!1),null===Vn){const bn=["webgl2","webgl","experimental-webgl"];if(!0===Me.isWebGL1Renderer&&bn.shift(),Vn=Mt(bn,_t),null===Vn)throw Mt(bn)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===Vn.getShaderPrecisionFormat&&(Vn.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(_t){throw console.error("THREE.WebGLRenderer: "+_t.message),_t}function Rn(){En=new An(Vn),Zn=new qc(Vn,En,S),En.init(Zn),_h=new Qd(Vn,En,Zn),qn=new um(Vn,En,Zn),St[0]=1029,on=new cr(Vn),dt=new wi,sn=new Dm(Vn,En,qn,dt,Zn,_h,on),Sn=new sl(Me),hn=new Jt(Me),Wt=new ed(Vn,Zn),gl=new Mo(Vn,En,Wt,Zn),xr=new Wn(Vn,Wt,on,gl),mr=new Bl(Vn,xr,Wt,on),pp=new Zi(Vn),Ho=new Eu(dt),Br=new Dp(Me,Sn,hn,En,Zn,gl,Ho),Gi=new Ad(dt),_o=new ff(dt),ml=new Zd(En,Zn),uu=new Wc(Me,Sn,qn,mr,O),_l=new zp(Me,mr,Zn),Fd=new Xn(Vn,En,on,Zn),Dd=new Dn(Vn,En,on,Zn),on.programs=Br.programs,Me.capabilities=Zn,Me.extensions=En,Me.properties=dt,Me.renderLists=_o,Me.shadowMap=_l,Me.state=qn,Me.info=on}Rn();const pn=new Tc(Me,Vn);function kn(_t){_t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),Ne=!0}function _r(){console.log("THREE.WebGLRenderer: Context Restored."),Ne=!1;const _t=on.autoReset,bn=_l.enabled,en=_l.autoUpdate,yn=_l.needsUpdate,jn=_l.type;Rn(),on.autoReset=_t,_l.enabled=bn,_l.autoUpdate=en,_l.needsUpdate=yn,_l.type=jn}function Ti(_t){const bn=_t.target;var en;bn.removeEventListener("dispose",Ti),function(yn){const jn=dt.get(yn).programs;void 0!==jn&&jn.forEach(function(yi){Br.releaseProgram(yi)})}(en=bn),dt.remove(en)}this.xr=pn,this.getContext=function(){return Vn},this.getContextAttributes=function(){return Vn.getContextAttributes()},this.forceContextLoss=function(){const _t=En.get("WEBGL_lose_context");_t&&_t.loseContext()},this.forceContextRestore=function(){const _t=En.get("WEBGL_lose_context");_t&&_t.restoreContext()},this.getPixelRatio=function(){return Je},this.setPixelRatio=function(_t){void 0!==_t&&(Je=_t,this.setSize(Dt,Ht,!1))},this.getSize=function(_t){return _t.set(Dt,Ht)},this.setSize=function(_t,bn,en){pn.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(Dt=_t,Ht=bn,e.width=Math.floor(_t*Je),e.height=Math.floor(bn*Je),!1!==en&&(e.style.width=_t+"px",e.style.height=bn+"px"),this.setViewport(0,0,_t,bn))},this.getDrawingBufferSize=function(_t){return _t.set(Dt*Je,Ht*Je).floor()},this.setDrawingBufferSize=function(_t,bn,en){Dt=_t,Ht=bn,Je=en,e.width=Math.floor(_t*en),e.height=Math.floor(bn*en),this.setViewport(0,0,_t,bn)},this.getCurrentViewport=function(_t){return _t.copy(it)},this.getViewport=function(_t){return _t.copy(Nt)},this.setViewport=function(_t,bn,en,yn){_t.isVector4?Nt.set(_t.x,_t.y,_t.z,_t.w):Nt.set(_t,bn,en,yn),qn.viewport(it.copy(Nt).multiplyScalar(Je).floor())},this.getScissor=function(_t){return _t.copy(ct)},this.setScissor=function(_t,bn,en,yn){_t.isVector4?ct.set(_t.x,_t.y,_t.z,_t.w):ct.set(_t,bn,en,yn),qn.scissor(mt.copy(ct).multiplyScalar(Je).floor())},this.getScissorTest=function(){return Yt},this.setScissorTest=function(_t){qn.setScissorTest(Yt=_t)},this.setOpaqueSort=function(_t){pt=_t},this.setTransparentSort=function(_t){Vt=_t},this.getClearColor=function(_t){return _t.copy(uu.getClearColor())},this.setClearColor=function(){uu.setClearColor.apply(uu,arguments)},this.getClearAlpha=function(){return uu.getClearAlpha()},this.setClearAlpha=function(){uu.setClearAlpha.apply(uu,arguments)},this.clear=function(_t,bn,en){let yn=0;(void 0===_t||_t)&&(yn|=16384),(void 0===bn||bn)&&(yn|=256),(void 0===en||en)&&(yn|=1024),Vn.clear(yn)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",kn,!1),e.removeEventListener("webglcontextrestored",_r,!1),_o.dispose(),ml.dispose(),dt.dispose(),Sn.dispose(),hn.dispose(),mr.dispose(),gl.dispose(),pn.dispose(),pn.removeEventListener("sessionstart",ri),pn.removeEventListener("sessionend",xs),Ze&&(Ze.dispose(),Ze=null),os.stop()},this.renderBufferImmediate=function(_t,bn){gl.initAttributes();const en=dt.get(_t);_t.hasPositions&&!en.position&&(en.position=Vn.createBuffer()),_t.hasNormals&&!en.normal&&(en.normal=Vn.createBuffer()),_t.hasUvs&&!en.uv&&(en.uv=Vn.createBuffer()),_t.hasColors&&!en.color&&(en.color=Vn.createBuffer());const yn=bn.getAttributes();_t.hasPositions&&(Vn.bindBuffer(34962,en.position),Vn.bufferData(34962,_t.positionArray,35048),gl.enableAttribute(yn.position.location),Vn.vertexAttribPointer(yn.position.location,3,5126,!1,0,0)),_t.hasNormals&&(Vn.bindBuffer(34962,en.normal),Vn.bufferData(34962,_t.normalArray,35048),gl.enableAttribute(yn.normal.location),Vn.vertexAttribPointer(yn.normal.location,3,5126,!1,0,0)),_t.hasUvs&&(Vn.bindBuffer(34962,en.uv),Vn.bufferData(34962,_t.uvArray,35048),gl.enableAttribute(yn.uv.location),Vn.vertexAttribPointer(yn.uv.location,2,5126,!1,0,0)),_t.hasColors&&(Vn.bindBuffer(34962,en.color),Vn.bufferData(34962,_t.colorArray,35048),gl.enableAttribute(yn.color.location),Vn.vertexAttribPointer(yn.color.location,3,5126,!1,0,0)),gl.disableUnusedAttributes(),Vn.drawArrays(4,0,_t.count),_t.count=0},this.renderBufferDirect=function(_t,bn,en,yn,jn,yi){null===bn&&(bn=Gt);const zr=jn.isMesh&&jn.matrixWorld.determinant()<0,ki=hu(_t,bn,yn,jn);qn.setMaterial(yn,zr);let no=en.index;const Ss=en.attributes.position;if(null===no){if(void 0===Ss||0===Ss.count)return}else if(0===no.count)return;let zo,ro=1;!0===yn.wireframe&&(no=xr.getWireframeAttribute(en),ro=2),void 0===en.morphAttributes.position&&void 0===en.morphAttributes.normal||pp.update(jn,en,yn,ki),gl.setup(jn,yn,ki,en,no);let Fi=Fd;null!==no&&(zo=Wt.get(no),Fi=Dd,Fi.setIndex(zo));const qf=null!==no?no.count:Ss.count,Xa=en.drawRange.start*ro,Ef=en.drawRange.count*ro,gd=null!==yi?yi.start*ro:0,Xf=null!==yi?yi.count*ro:1/0,Tf=Math.max(Xa,gd),Rc=Math.min(qf,Xa+Ef,gd+Xf)-1,Ud=Math.max(0,Rc-Tf+1);if(0!==Ud){if(jn.isMesh)!0===yn.wireframe?(qn.setLineWidth(yn.wireframeLinewidth*tn()),Fi.setMode(1)):Fi.setMode(4);else if(jn.isLine){let ku=yn.linewidth;void 0===ku&&(ku=1),qn.setLineWidth(ku*tn()),Fi.setMode(jn.isLineSegments?1:jn.isLineLoop?2:3)}else jn.isPoints?Fi.setMode(0):jn.isSprite&&Fi.setMode(4);if(jn.isInstancedMesh)Fi.renderInstances(Tf,Ud,jn.count);else if(en.isInstancedBufferGeometry){const ku=Math.min(en.instanceCount,en._maxInstanceCount);Fi.renderInstances(Tf,Ud,ku)}else Fi.render(Tf,Ud)}},this.compile=function(_t,bn){ie=ml.get(_t),ie.init(),ye.push(ie),_t.traverseVisible(function(en){en.isLight&&en.layers.test(bn.layers)&&(ie.pushLight(en),en.castShadow&&ie.pushShadow(en))}),ie.setupLights(Me.physicallyCorrectLights),_t.traverse(function(en){const yn=en.material;if(yn)if(Array.isArray(yn))for(let jn=0;jn<yn.length;jn++)Ba(yn[jn],_t,en);else Ba(yn,_t,en)}),ye.pop(),ie=null};let Ii=null;function ri(){os.stop()}function xs(){os.start()}const os=new wc;function Qs(_t,bn,en,yn){if(!1===_t.visible)return;if(_t.layers.test(bn.layers))if(_t.isGroup)en=_t.renderOrder;else if(_t.isLOD)!0===_t.autoUpdate&&_t.update(bn);else if(_t.isLight)ie.pushLight(_t),_t.castShadow&&ie.pushShadow(_t);else if(_t.isSprite){if(!_t.frustumCulled||jt.intersectsSprite(_t)){yn&&Rt.setFromMatrixPosition(_t.matrixWorld).applyMatrix4(st);const yi=mr.update(_t),zr=_t.material;zr.visible&&ae.push(_t,yi,zr,en,Rt.z,null)}}else if(_t.isImmediateRenderObject)yn&&Rt.setFromMatrixPosition(_t.matrixWorld).applyMatrix4(st),ae.push(_t,null,_t.material,en,Rt.z,null);else if((_t.isMesh||_t.isLine||_t.isPoints)&&(_t.isSkinnedMesh&&_t.skeleton.frame!==on.render.frame&&(_t.skeleton.update(),_t.skeleton.frame=on.render.frame),!_t.frustumCulled||jt.intersectsObject(_t))){yn&&Rt.setFromMatrixPosition(_t.matrixWorld).applyMatrix4(st);const yi=mr.update(_t),zr=_t.material;if(Array.isArray(zr)){const ki=yi.groups;for(let no=0,Ss=ki.length;no<Ss;no++){const zo=ki[no],ro=zr[zo.materialIndex];ro&&ro.visible&&ae.push(_t,yi,ro,en,Rt.z,zo)}}else zr.visible&&ae.push(_t,yi,zr,en,Rt.z,null)}const jn=_t.children;for(let yi=0,zr=jn.length;yi<zr;yi++)Qs(jn[yi],bn,en,yn)}function ws(_t,bn,en,yn){const jn=_t.opaque,yi=_t.transmissive,zr=_t.transparent;ie.setupLightsView(en),yi.length>0&&function(ki,no,Ss){null===Ze&&(Ze=new(!0===L&&!0===Zn.isWebGL2?zc:io)(1024,1024,{generateMipmaps:!0,type:null!==_h.convert(ds)?ds:ea,minFilter:Ya,magFilter:Or,wrapS:Xr,wrapT:Xr}));const zo=Me.getRenderTarget();Me.setRenderTarget(Ze),Me.clear();const ro=Me.toneMapping;Me.toneMapping=vr,Oi(ki,no,Ss),Me.toneMapping=ro,sn.updateMultisampleRenderTarget(Ze),sn.updateRenderTargetMipmap(Ze),Me.setRenderTarget(zo)}(jn,bn,en),yn&&qn.viewport(it.copy(yn)),jn.length>0&&Oi(jn,bn,en),yi.length>0&&Oi(yi,bn,en),zr.length>0&&Oi(zr,bn,en)}function Oi(_t,bn,en){const yn=!0===bn.isScene?bn.overrideMaterial:null;for(let jn=0,yi=_t.length;jn<yi;jn++){const zr=_t[jn],ki=zr.object,no=zr.geometry,Ss=null===yn?zr.material:yn,zo=zr.group;ki.layers.test(en.layers)&&ga(ki,bn,en,no,Ss,zo)}}function ga(_t,bn,en,yn,jn,yi){if(_t.onBeforeRender(Me,bn,en,yn,jn,yi),_t.modelViewMatrix.multiplyMatrices(en.matrixWorldInverse,_t.matrixWorld),_t.normalMatrix.getNormalMatrix(_t.modelViewMatrix),_t.isImmediateRenderObject){const zr=hu(en,bn,jn,_t);qn.setMaterial(jn),gl.reset(),no=zr,_t.render(function(Ss){Me.renderBufferImmediate(Ss,no)})}else!0===jn.transparent&&jn.side===pe?(jn.side=le,jn.needsUpdate=!0,Me.renderBufferDirect(en,bn,yn,jn,_t,yi),jn.side=_e,jn.needsUpdate=!0,Me.renderBufferDirect(en,bn,yn,jn,_t,yi),jn.side=pe):Me.renderBufferDirect(en,bn,yn,jn,_t,yi);var no;_t.onAfterRender(Me,bn,en,yn,jn,yi)}function Ba(_t,bn,en){!0!==bn.isScene&&(bn=Gt);const yn=dt.get(_t),jn=ie.state.lights,zr=jn.state.version,ki=Br.getParameters(_t,jn.state,ie.state.shadowsArray,bn,en),no=Br.getProgramCacheKey(ki);let Ss=yn.programs;yn.environment=_t.isMeshStandardMaterial?bn.environment:null,yn.fog=bn.fog,yn.envMap=(_t.isMeshStandardMaterial?hn:Sn).get(_t.envMap||yn.environment),void 0===Ss&&(_t.addEventListener("dispose",Ti),Ss=new Map,yn.programs=Ss);let zo=Ss.get(no);if(void 0!==zo){if(yn.currentProgram===zo&&yn.lightsStateVersion===zr)return Qo(_t,ki),zo}else ki.uniforms=Br.getUniforms(_t),_t.onBuild(ki,Me),_t.onBeforeCompile(ki,Me),zo=Br.acquireProgram(ki,no),Ss.set(no,zo),yn.uniforms=ki.uniforms;const ro=yn.uniforms;var Xa;(_t.isShaderMaterial||_t.isRawShaderMaterial)&&!0!==_t.clipping||(ro.clippingPlanes=Ho.uniform),Qo(_t,ki),yn.needsLights=(Xa=_t).isMeshLambertMaterial||Xa.isMeshToonMaterial||Xa.isMeshPhongMaterial||Xa.isMeshStandardMaterial||Xa.isShadowMaterial||Xa.isShaderMaterial&&!0===Xa.lights,yn.lightsStateVersion=zr,yn.needsLights&&(ro.ambientLightColor.value=jn.state.ambient,ro.lightProbe.value=jn.state.probe,ro.directionalLights.value=jn.state.directional,ro.directionalLightShadows.value=jn.state.directionalShadow,ro.spotLights.value=jn.state.spot,ro.spotLightShadows.value=jn.state.spotShadow,ro.rectAreaLights.value=jn.state.rectArea,ro.ltc_1.value=jn.state.rectAreaLTC1,ro.ltc_2.value=jn.state.rectAreaLTC2,ro.pointLights.value=jn.state.point,ro.pointLightShadows.value=jn.state.pointShadow,ro.hemisphereLights.value=jn.state.hemi,ro.directionalShadowMap.value=jn.state.directionalShadowMap,ro.directionalShadowMatrix.value=jn.state.directionalShadowMatrix,ro.spotShadowMap.value=jn.state.spotShadowMap,ro.spotShadowMatrix.value=jn.state.spotShadowMatrix,ro.pointShadowMap.value=jn.state.pointShadowMap,ro.pointShadowMatrix.value=jn.state.pointShadowMatrix);const Fi=zo.getUniforms(),qf=Ah.seqWithValue(Fi.seq,ro);return yn.currentProgram=zo,yn.uniformsList=qf,zo}function Qo(_t,bn){const en=dt.get(_t);en.outputEncoding=bn.outputEncoding,en.instancing=bn.instancing,en.skinning=bn.skinning,en.morphTargets=bn.morphTargets,en.morphNormals=bn.morphNormals,en.numClippingPlanes=bn.numClippingPlanes,en.numIntersection=bn.numClipIntersection,en.vertexAlphas=bn.vertexAlphas,en.vertexTangents=bn.vertexTangents}function hu(_t,bn,en,yn){!0!==bn.isScene&&(bn=Gt),sn.resetTextureUnits();const jn=bn.fog,zr=null===Ye?Me.outputEncoding:Ye.texture.encoding,ki=(en.isMeshStandardMaterial?hn:Sn).get(en.envMap||(en.isMeshStandardMaterial?bn.environment:null)),no=!0===en.vertexColors&&!!yn.geometry&&!!yn.geometry.attributes.color&&4===yn.geometry.attributes.color.itemSize,Ss=!!yn.geometry&&!!yn.geometry.attributes.tangent,zo=!!yn.geometry&&!!yn.geometry.morphAttributes.position,ro=!!yn.geometry&&!!yn.geometry.morphAttributes.normal,Fi=dt.get(en),qf=ie.state.lights;!0!==It||!0!==an&&_t===nt||Ho.setState(en,_t,_t===nt&&en.id===We);let Xa=!1;en.version===Fi.__version?Fi.needsLights&&Fi.lightsStateVersion!==qf.state.version||Fi.outputEncoding!==zr||yn.isInstancedMesh&&!1===Fi.instancing?Xa=!0:yn.isInstancedMesh||!0!==Fi.instancing?yn.isSkinnedMesh&&!1===Fi.skinning?Xa=!0:yn.isSkinnedMesh||!0!==Fi.skinning?Fi.envMap!==ki||en.fog&&Fi.fog!==jn?Xa=!0:void 0===Fi.numClippingPlanes||Fi.numClippingPlanes===Ho.numPlanes&&Fi.numIntersection===Ho.numIntersection?(Fi.vertexAlphas!==no||Fi.vertexTangents!==Ss||Fi.morphTargets!==zo||Fi.morphNormals!==ro)&&(Xa=!0):Xa=!0:Xa=!0:Xa=!0:(Xa=!0,Fi.__version=en.version);let Ef=Fi.currentProgram;!0===Xa&&(Ef=Ba(en,bn,yn));let gd=!1,Xf=!1,Tf=!1;const Rc=Ef.getUniforms(),Ud=Fi.uniforms;if(qn.useProgram(Ef.program)&&(gd=!0,Xf=!0,Tf=!0),en.id!==We&&(We=en.id,Xf=!0),gd||nt!==_t){if(Rc.setValue(Vn,"projectionMatrix",_t.projectionMatrix),Zn.logarithmicDepthBuffer&&Rc.setValue(Vn,"logDepthBufFC",2/(Math.log(_t.far+1)/Math.LN2)),nt!==_t&&(nt=_t,Xf=!0,Tf=!0),en.isShaderMaterial||en.isMeshPhongMaterial||en.isMeshToonMaterial||en.isMeshStandardMaterial||en.envMap){const yd=Rc.map.cameraPosition;void 0!==yd&&yd.setValue(Vn,Rt.setFromMatrixPosition(_t.matrixWorld))}(en.isMeshPhongMaterial||en.isMeshToonMaterial||en.isMeshLambertMaterial||en.isMeshBasicMaterial||en.isMeshStandardMaterial||en.isShaderMaterial)&&Rc.setValue(Vn,"isOrthographic",!0===_t.isOrthographicCamera),(en.isMeshPhongMaterial||en.isMeshToonMaterial||en.isMeshLambertMaterial||en.isMeshBasicMaterial||en.isMeshStandardMaterial||en.isShaderMaterial||en.isShadowMaterial||yn.isSkinnedMesh)&&Rc.setValue(Vn,"viewMatrix",_t.matrixWorldInverse)}if(yn.isSkinnedMesh){Rc.setOptional(Vn,yn,"bindMatrix"),Rc.setOptional(Vn,yn,"bindMatrixInverse");const yd=yn.skeleton;yd&&(Zn.floatVertexTextures?(null===yd.boneTexture&&yd.computeBoneTexture(),Rc.setValue(Vn,"boneTexture",yd.boneTexture,sn),Rc.setValue(Vn,"boneTextureSize",yd.boneTextureSize)):Rc.setOptional(Vn,yd,"boneMatrices"))}var ku,vd;return(Xf||Fi.receiveShadow!==yn.receiveShadow)&&(Fi.receiveShadow=yn.receiveShadow,Rc.setValue(Vn,"receiveShadow",yn.receiveShadow)),Xf&&(Rc.setValue(Vn,"toneMappingExposure",Me.toneMappingExposure),Fi.needsLights&&((ku=Ud).ambientLightColor.needsUpdate=vd=Tf,ku.lightProbe.needsUpdate=vd,ku.directionalLights.needsUpdate=vd,ku.directionalLightShadows.needsUpdate=vd,ku.pointLights.needsUpdate=vd,ku.pointLightShadows.needsUpdate=vd,ku.spotLights.needsUpdate=vd,ku.spotLightShadows.needsUpdate=vd,ku.rectAreaLights.needsUpdate=vd,ku.hemisphereLights.needsUpdate=vd),jn&&en.fog&&Gi.refreshFogUniforms(Ud,jn),Gi.refreshMaterialUniforms(Ud,en,Je,Ht,Ze),Ah.upload(Vn,Fi.uniformsList,Ud,sn)),en.isShaderMaterial&&!0===en.uniformsNeedUpdate&&(Ah.upload(Vn,Fi.uniformsList,Ud,sn),en.uniformsNeedUpdate=!1),en.isSpriteMaterial&&Rc.setValue(Vn,"center",yn.center),Rc.setValue(Vn,"modelViewMatrix",yn.modelViewMatrix),Rc.setValue(Vn,"normalMatrix",yn.normalMatrix),Rc.setValue(Vn,"modelMatrix",yn.matrixWorld),Ef}os.setAnimationLoop(function(_t){Ii&&Ii(_t)}),typeof window<"u"&&os.setContext(window),this.setAnimationLoop=function(_t){Ii=_t,pn.setAnimationLoop(_t),null===_t?os.stop():os.start()},pn.addEventListener("sessionstart",ri),pn.addEventListener("sessionend",xs),this.render=function(_t,bn){if(void 0===bn||!0===bn.isCamera){if(!0!==Ne){if(!0===_t.autoUpdate&&_t.updateMatrixWorld(),null===bn.parent&&bn.updateMatrixWorld(),!0===pn.enabled&&!0===pn.isPresenting&&(!0===pn.cameraAutoUpdate&&pn.updateCamera(bn),bn=pn.getCamera()),!0===_t.isScene&&_t.onBeforeRender(Me,_t,bn,Ye),ie=ml.get(_t,ye.length),ie.init(),ye.push(ie),st.multiplyMatrices(bn.projectionMatrix,bn.matrixWorldInverse),jt.setFromProjectionMatrix(st),an=this.localClippingEnabled,It=Ho.init(this.clippingPlanes,an,bn),ae=_o.get(_t,he.length),ae.init(),he.push(ae),Qs(_t,bn,0,Me.sortObjects),ae.finish(),!0===Me.sortObjects&&ae.sort(pt,Vt),!0===It&&Ho.beginShadows(),_l.render(ie.state.shadowsArray,_t,bn),!0===It&&Ho.endShadows(),!0===this.info.autoReset&&this.info.reset(),uu.render(ae,_t),ie.setupLights(Me.physicallyCorrectLights),bn.isArrayCamera){const yn=bn.cameras;for(let jn=0,yi=yn.length;jn<yi;jn++){const zr=yn[jn];ws(ae,_t,zr,zr.viewport)}}else ws(ae,_t,bn);null!==Ye&&(sn.updateMultisampleRenderTarget(Ye),sn.updateRenderTargetMipmap(Ye)),!0===_t.isScene&&_t.onAfterRender(Me,_t,bn),qn.buffers.depth.setTest(!0),qn.buffers.depth.setMask(!0),qn.buffers.color.setMask(!0),qn.setPolygonOffset(!1),gl.resetDefaultState(),We=-1,nt=null,ye.pop(),ie=ye.length>0?ye[ye.length-1]:null,he.pop(),ae=he.length>0?he[he.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return $e},this.getActiveMipmapLevel=function(){return ze},this.getRenderTarget=function(){return Ye},this.setRenderTarget=function(_t,bn=0,en=0){Ye=_t,$e=bn,ze=en,_t&&void 0===dt.get(_t).__webglFramebuffer&&sn.setupRenderTarget(_t);let yn=null,jn=!1,yi=!1;if(_t){const zr=_t.texture;(zr.isDataTexture3D||zr.isDataTexture2DArray)&&(yi=!0);const ki=dt.get(_t).__webglFramebuffer;_t.isWebGLCubeRenderTarget?(yn=ki[bn],jn=!0):yn=_t.isWebGLMultisampleRenderTarget?dt.get(_t).__webglMultisampledFramebuffer:ki,it.copy(_t.viewport),mt.copy(_t.scissor),xt=_t.scissorTest}else it.copy(Nt).multiplyScalar(Je).floor(),mt.copy(ct).multiplyScalar(Je).floor(),xt=Yt;if(qn.bindFramebuffer(36160,yn)&&Zn.drawBuffers){let zr=!1;if(_t)if(_t.isWebGLMultipleRenderTargets){const ki=_t.texture;if(St.length!==ki.length||36064!==St[0]){for(let no=0,Ss=ki.length;no<Ss;no++)St[no]=36064+no;St.length=ki.length,zr=!0}}else 1===St.length&&36064===St[0]||(St[0]=36064,St.length=1,zr=!0);else 1===St.length&&1029===St[0]||(St[0]=1029,St.length=1,zr=!0);zr&&(Zn.isWebGL2?Vn.drawBuffers(St):En.get("WEBGL_draw_buffers").drawBuffersWEBGL(St))}if(qn.viewport(it),qn.scissor(mt),qn.setScissorTest(xt),jn){const zr=dt.get(_t.texture);Vn.framebufferTexture2D(36160,36064,34069+bn,zr.__webglTexture,en)}else if(yi){const zr=dt.get(_t.texture);Vn.framebufferTextureLayer(36160,36064,zr.__webglTexture,en||0,bn||0)}We=-1},this.readRenderTargetPixels=function(_t,bn,en,yn,jn,yi,zr){if(!_t||!_t.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let ki=dt.get(_t).__webglFramebuffer;if(_t.isWebGLCubeRenderTarget&&void 0!==zr&&(ki=ki[zr]),ki){qn.bindFramebuffer(36160,ki);try{const no=_t.texture,Ss=no.format,zo=no.type;if(Ss!==lo&&_h.convert(Ss)!==Vn.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const ro=zo===ds&&(En.has("EXT_color_buffer_half_float")||Zn.isWebGL2&&En.has("EXT_color_buffer_float"));if(!(zo===ea||_h.convert(zo)===Vn.getParameter(35738)||zo===Vo&&(Zn.isWebGL2||En.has("OES_texture_float")||En.has("WEBGL_color_buffer_float"))||ro))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===Vn.checkFramebufferStatus(36160)?bn>=0&&bn<=_t.width-yn&&en>=0&&en<=_t.height-jn&&Vn.readPixels(bn,en,yn,jn,_h.convert(Ss),_h.convert(zo),yi):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{const no=null!==Ye?dt.get(Ye).__webglFramebuffer:null;qn.bindFramebuffer(36160,no)}}},this.copyFramebufferToTexture=function(_t,bn,en=0){const yn=Math.pow(2,-en),jn=Math.floor(bn.image.width*yn),yi=Math.floor(bn.image.height*yn);let zr=_h.convert(bn.format);Zn.isWebGL2&&(6407===zr&&(zr=32849),6408===zr&&(zr=32856)),sn.setTexture2D(bn,0),Vn.copyTexImage2D(3553,en,zr,_t.x,_t.y,jn,yi,0),qn.unbindTexture()},this.copyTextureToTexture=function(_t,bn,en,yn=0){const jn=bn.image.width,yi=bn.image.height,zr=_h.convert(en.format),ki=_h.convert(en.type);sn.setTexture2D(en,0),Vn.pixelStorei(37440,en.flipY),Vn.pixelStorei(37441,en.premultiplyAlpha),Vn.pixelStorei(3317,en.unpackAlignment),bn.isDataTexture?Vn.texSubImage2D(3553,yn,_t.x,_t.y,jn,yi,zr,ki,bn.image.data):bn.isCompressedTexture?Vn.compressedTexSubImage2D(3553,yn,_t.x,_t.y,bn.mipmaps[0].width,bn.mipmaps[0].height,zr,bn.mipmaps[0].data):Vn.texSubImage2D(3553,yn,_t.x,_t.y,zr,ki,bn.image),0===yn&&en.generateMipmaps&&Vn.generateMipmap(3553),qn.unbindTexture()},this.copyTextureToTexture3D=function(_t,bn,en,yn,jn=0){if(Me.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const yi=_t.max.x-_t.min.x+1,zr=_t.max.y-_t.min.y+1,ki=_t.max.z-_t.min.z+1,no=_h.convert(yn.format),Ss=_h.convert(yn.type);let zo;if(yn.isDataTexture3D)sn.setTexture3D(yn,0),zo=32879;else{if(!yn.isDataTexture2DArray)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");sn.setTexture2DArray(yn,0),zo=35866}Vn.pixelStorei(37440,yn.flipY),Vn.pixelStorei(37441,yn.premultiplyAlpha),Vn.pixelStorei(3317,yn.unpackAlignment);const ro=Vn.getParameter(3314),Fi=Vn.getParameter(32878),qf=Vn.getParameter(3316),Xa=Vn.getParameter(3315),Ef=Vn.getParameter(32877),gd=en.isCompressedTexture?en.mipmaps[0]:en.image;Vn.pixelStorei(3314,gd.width),Vn.pixelStorei(32878,gd.height),Vn.pixelStorei(3316,_t.min.x),Vn.pixelStorei(3315,_t.min.y),Vn.pixelStorei(32877,_t.min.z),en.isDataTexture||en.isDataTexture3D?Vn.texSubImage3D(zo,jn,bn.x,bn.y,bn.z,yi,zr,ki,no,Ss,gd.data):en.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Vn.compressedTexSubImage3D(zo,jn,bn.x,bn.y,bn.z,yi,zr,ki,no,gd.data)):Vn.texSubImage3D(zo,jn,bn.x,bn.y,bn.z,yi,zr,ki,no,Ss,gd),Vn.pixelStorei(3314,ro),Vn.pixelStorei(32878,Fi),Vn.pixelStorei(3316,qf),Vn.pixelStorei(3315,Xa),Vn.pixelStorei(32877,Ef),0===jn&&yn.generateMipmaps&&Vn.generateMipmap(zo),qn.unbindTexture()},this.initTexture=function(_t){sn.setTexture2D(_t,0),qn.unbindTexture()},this.resetState=function(){$e=0,ze=0,Ye=null,qn.reset(),gl.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}class cn extends Qn{}cn.prototype.isWebGL1Renderer=!0;class Gp{constructor(e,c=25e-5){this.name="",this.color=new tr(e),this.density=c}clone(){return new Gp(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}Gp.prototype.isFogExp2=!0;class Xo{constructor(e,c=1,p=1e3){this.name="",this.color=new tr(e),this.near=c,this.far=p}clone(){return new Xo(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}Xo.prototype.isFog=!0;class Qc extends Ir{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,c){return super.copy(e,c),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const c=super.toJSON(e);return null!==this.fog&&(c.object.fog=this.fog.toJSON()),c}}Qc.prototype.isScene=!0;class Nh{constructor(e,c){this.array=e,this.stride=c,this.count=void 0!==e?e.length/c:0,this.usage=_i,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Ki()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,c,p){e*=this.stride,p*=c.stride;for(let _=0,w=this.stride;_<w;_++)this.array[e+_]=c.array[p+_];return this}set(e,c=0){return this.array.set(e,c),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Ki()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const c=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),p=new this.constructor(c,this.stride);return p.setUsage(this.usage),p}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Ki()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}Nh.prototype.isInterleavedBuffer=!0;const Ni=new lt;class Rl{constructor(e,c,p,_=!1){this.name="",this.data=e,this.itemSize=c,this.offset=p,this.normalized=!0===_}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let c=0,p=this.data.count;c<p;c++)Ni.x=this.getX(c),Ni.y=this.getY(c),Ni.z=this.getZ(c),Ni.applyMatrix4(e),this.setXYZ(c,Ni.x,Ni.y,Ni.z);return this}applyNormalMatrix(e){for(let c=0,p=this.count;c<p;c++)Ni.x=this.getX(c),Ni.y=this.getY(c),Ni.z=this.getZ(c),Ni.applyNormalMatrix(e),this.setXYZ(c,Ni.x,Ni.y,Ni.z);return this}transformDirection(e){for(let c=0,p=this.count;c<p;c++)Ni.x=this.getX(c),Ni.y=this.getY(c),Ni.z=this.getZ(c),Ni.transformDirection(e),this.setXYZ(c,Ni.x,Ni.y,Ni.z);return this}setX(e,c){return this.data.array[e*this.data.stride+this.offset]=c,this}setY(e,c){return this.data.array[e*this.data.stride+this.offset+1]=c,this}setZ(e,c){return this.data.array[e*this.data.stride+this.offset+2]=c,this}setW(e,c){return this.data.array[e*this.data.stride+this.offset+3]=c,this}getX(e){return this.data.array[e*this.data.stride+this.offset]}getY(e){return this.data.array[e*this.data.stride+this.offset+1]}getZ(e){return this.data.array[e*this.data.stride+this.offset+2]}getW(e){return this.data.array[e*this.data.stride+this.offset+3]}setXY(e,c,p){return this.data.array[(e=e*this.data.stride+this.offset)+0]=c,this.data.array[e+1]=p,this}setXYZ(e,c,p,_){return this.data.array[(e=e*this.data.stride+this.offset)+0]=c,this.data.array[e+1]=p,this.data.array[e+2]=_,this}setXYZW(e,c,p,_,w){return this.data.array[(e=e*this.data.stride+this.offset)+0]=c,this.data.array[e+1]=p,this.data.array[e+2]=_,this.data.array[e+3]=w,this}clone(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const c=[];for(let p=0;p<this.count;p++){const _=p*this.data.stride+this.offset;for(let w=0;w<this.itemSize;w++)c.push(this.data.array[_+w])}return new zi(new this.array.constructor(c),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Rl(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const c=[];for(let p=0;p<this.count;p++){const _=p*this.data.stride+this.offset;for(let w=0;w<this.itemSize;w++)c.push(this.data.array[_+w])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:c,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}Rl.prototype.isInterleavedBufferAttribute=!0;class ah extends As{constructor(e){super(),this.type="SpriteMaterial",this.color=new tr(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this}}let Wi;ah.prototype.isSpriteMaterial=!0;const Mc=new lt,ca=new lt,od=new lt,Ga=new Un,Hp=new Un,ef=new Qt,wo=new lt,Zl=new lt,Ha=new lt,sd=new Un,Cu=new Un,lh=new Un;class Ql extends Ir{constructor(e){if(super(),this.type="Sprite",void 0===Wi){Wi=new br;const c=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),p=new Nh(c,5);Wi.setIndex([0,1,2,0,2,3]),Wi.setAttribute("position",new Rl(p,3,0,!1)),Wi.setAttribute("uv",new Rl(p,2,3,!1))}this.geometry=Wi,this.material=void 0!==e?e:new ah,this.center=new Un(.5,.5)}raycast(e,c){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),ca.setFromMatrixScale(this.matrixWorld),ef.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),od.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&ca.multiplyScalar(-od.z);const p=this.material.rotation;let _,w;0!==p&&(w=Math.cos(p),_=Math.sin(p));const L=this.center;Kl(wo.set(-.5,-.5,0),od,L,ca,_,w),Kl(Zl.set(.5,-.5,0),od,L,ca,_,w),Kl(Ha.set(.5,.5,0),od,L,ca,_,w),sd.set(0,0),Cu.set(1,0),lh.set(1,1);let O=e.ray.intersectTriangle(wo,Zl,Ha,!1,Mc);if(null===O&&(Kl(Zl.set(-.5,.5,0),od,L,ca,_,w),Cu.set(0,1),O=e.ray.intersectTriangle(wo,Ha,Zl,!1,Mc),null===O))return;const D=e.ray.origin.distanceTo(Mc);D<e.near||D>e.far||c.push({distance:D,point:Mc.clone(),uv:eo.getUV(Mc,wo,Zl,Ha,sd,Cu,lh,new Un),face:null,object:this})}copy(e){return super.copy(e),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}function Kl(S,e,c,p,_,w){Ga.subVectors(S,c).addScalar(.5).multiply(p),void 0!==_?(Hp.x=w*Ga.x-_*Ga.y,Hp.y=_*Ga.x+w*Ga.y):Hp.copy(Ga),S.copy(e),S.x+=Hp.x,S.y+=Hp.y,S.applyMatrix4(ef)}Ql.prototype.isSprite=!0;const Ac=new lt,ch=new lt;class Ma extends Ir{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const c=e.levels;for(let p=0,_=c.length;p<_;p++){const w=c[p];this.addLevel(w.object.clone(),w.distance)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,c=0){c=Math.abs(c);const p=this.levels;let _;for(_=0;_<p.length&&!(c<p[_].distance);_++);return p.splice(_,0,{distance:c,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const c=this.levels;if(c.length>0){let p,_;for(p=1,_=c.length;p<_&&!(e<c[p].distance);p++);return c[p-1].object}return null}raycast(e,c){if(this.levels.length>0){Ac.setFromMatrixPosition(this.matrixWorld);const p=e.ray.origin.distanceTo(Ac);this.getObjectForDistance(p).raycast(e,c)}}update(e){const c=this.levels;if(c.length>1){Ac.setFromMatrixPosition(e.matrixWorld),ch.setFromMatrixPosition(this.matrixWorld);const p=Ac.distanceTo(ch)/e.zoom;let _,w;for(c[0].object.visible=!0,_=1,w=c.length;_<w&&p>=c[_].distance;_++)c[_-1].object.visible=!1,c[_].object.visible=!0;for(this._currentLevel=_-1;_<w;_++)c[_].object.visible=!1}}toJSON(e){const c=super.toJSON(e);!1===this.autoUpdate&&(c.object.autoUpdate=!1),c.object.levels=[];const p=this.levels;for(let _=0,w=p.length;_<w;_++){const L=p[_];c.object.levels.push({object:L.object.uuid,distance:L.distance})}return c}}const Kc=new lt,eu=new Hi,Rh=new Hi,uh=new lt,ua=new Qt;class Aa extends Po{constructor(e,c){super(e,c),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Qt,this.bindMatrixInverse=new Qt}copy(e){return super.copy(e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this}bind(e,c){this.skeleton=e,void 0===c&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),c=this.matrixWorld),this.bindMatrix.copy(c),this.bindMatrixInverse.copy(c).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new Hi,c=this.geometry.attributes.skinWeight;for(let p=0,_=c.count;p<_;p++){e.x=c.getX(p),e.y=c.getY(p),e.z=c.getZ(p),e.w=c.getW(p);const w=1/e.manhattanLength();w!==1/0?e.multiplyScalar(w):e.set(1,0,0,0),c.setXYZW(p,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(e,c){const p=this.skeleton,_=this.geometry;eu.fromBufferAttribute(_.attributes.skinIndex,e),Rh.fromBufferAttribute(_.attributes.skinWeight,e),Kc.fromBufferAttribute(_.attributes.position,e).applyMatrix4(this.bindMatrix),c.set(0,0,0);for(let w=0;w<4;w++){const L=Rh.getComponent(w);if(0!==L){const O=eu.getComponent(w);ua.multiplyMatrices(p.bones[O].matrixWorld,p.boneInverses[O]),c.addScaledVector(uh.copy(Kc).applyMatrix4(ua),L)}}return c.applyMatrix4(this.bindMatrixInverse)}}Aa.prototype.isSkinnedMesh=!0;class ks extends Ir{constructor(){super(),this.type="Bone"}}ks.prototype.isBone=!0;class Fs extends Ms{constructor(e=null,c=1,p=1,_,w,L,O,D,z=Or,Q=Or,ae,ie){super(null,L,O,D,z,Q,_,w,ae,ie),this.image={data:e,width:c,height:p},this.magFilter=z,this.minFilter=Q,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}}Fs.prototype.isDataTexture=!0;const tu=new Qt,ec=new Qt;class Va{constructor(e=[],c=[]){this.uuid=Ki(),this.bones=e.slice(0),this.boneInverses=c,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const e=this.bones,c=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===c.length)this.calculateInverses();else if(e.length!==c.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let p=0,_=this.bones.length;p<_;p++)this.boneInverses.push(new Qt)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,c=this.bones.length;e<c;e++){const p=new Qt;this.bones[e]&&p.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(p)}}pose(){for(let e=0,c=this.bones.length;e<c;e++){const p=this.bones[e];p&&p.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,c=this.bones.length;e<c;e++){const p=this.bones[e];p&&(p.parent&&p.parent.isBone?(p.matrix.copy(p.parent.matrixWorld).invert(),p.matrix.multiply(p.matrixWorld)):p.matrix.copy(p.matrixWorld),p.matrix.decompose(p.position,p.quaternion,p.scale))}}update(){const e=this.bones,c=this.boneInverses,p=this.boneMatrices,_=this.boneTexture;for(let w=0,L=e.length;w<L;w++)tu.multiplyMatrices(e[w]?e[w].matrixWorld:ec,c[w]),tu.toArray(p,16*w);null!==_&&(_.needsUpdate=!0)}clone(){return new Va(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=Zh(e),e=Math.max(e,4);const c=new Float32Array(e*e*4);c.set(this.boneMatrices);const p=new Fs(c,e,e,lo,Vo);return this.boneMatrices=c,this.boneTexture=p,this.boneTextureSize=e,this}getBoneByName(e){for(let c=0,p=this.bones.length;c<p;c++){const _=this.bones[c];if(_.name===e)return _}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,c){this.uuid=e.uuid;for(let p=0,_=e.bones.length;p<_;p++){const w=e.bones[p];let L=c[w];void 0===L&&(console.warn("THREE.Skeleton: No bone found with UUID:",w),L=new ks),this.bones.push(L),this.boneInverses.push((new Qt).fromArray(e.boneInverses[p]))}return this.init(),this}toJSON(){const e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const c=this.bones,p=this.boneInverses;for(let _=0,w=c.length;_<w;_++)e.bones.push(c[_].uuid),e.boneInverses.push(p[_].toArray());return e}}class Pl extends zi{constructor(e,c,p,_=1){"number"==typeof p&&(_=p,p=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(e,c,p),this.meshPerAttribute=_}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}Pl.prototype.isInstancedBufferAttribute=!0;const Ao=new Qt,Vp=new Qt,$d=[],nu=new Po;class Ph extends Po{constructor(e,c,p){super(e,c),this.instanceMatrix=new Pl(new Float32Array(16*p),16),this.instanceColor=null,this.count=p,this.frustumCulled=!1}copy(e){return super.copy(e),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this}getColorAt(e,c){c.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,c){c.fromArray(this.instanceMatrix.array,16*e)}raycast(e,c){const p=this.matrixWorld,_=this.count;if(nu.geometry=this.geometry,nu.material=this.material,void 0!==nu.material)for(let w=0;w<_;w++){this.getMatrixAt(w,Ao),Vp.multiplyMatrices(p,Ao),nu.matrixWorld=Vp,nu.raycast(e,$d);for(let L=0,O=$d.length;L<O;L++){const D=$d[L];D.instanceId=w,D.object=this,c.push(D)}$d.length=0}}setColorAt(e,c){null===this.instanceColor&&(this.instanceColor=new Pl(new Float32Array(3*this.instanceMatrix.count),3)),c.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,c){c.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}Ph.prototype.isInstancedMesh=!0;class ji extends As{constructor(e){super(),this.type="LineBasicMaterial",this.color=new tr(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this}}ji.prototype.isLineBasicMaterial=!0;const Yo=new lt,ru=new lt,Ut=new Qt,sp=new _n,Ri=new xo;class Oo extends Ir{constructor(e=new br,c=new ji){super(),this.type="Line",this.geometry=e,this.material=c,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(null===e.index){const c=e.attributes.position,p=[0];for(let _=1,w=c.count;_<w;_++)Yo.fromBufferAttribute(c,_-1),ru.fromBufferAttribute(c,_),p[_]=p[_-1],p[_]+=Yo.distanceTo(ru);e.setAttribute("lineDistance",new dn(p,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(e,c){const p=this.geometry,_=this.matrixWorld,w=e.params.Line.threshold,L=p.drawRange;if(null===p.boundingSphere&&p.computeBoundingSphere(),Ri.copy(p.boundingSphere),Ri.applyMatrix4(_),Ri.radius+=w,!1===e.ray.intersectsSphere(Ri))return;Ut.copy(_).invert(),sp.copy(e.ray).applyMatrix4(Ut);const O=w/((this.scale.x+this.scale.y+this.scale.z)/3),D=O*O,z=new lt,Q=new lt,ae=new lt,ie=new lt,he=this.isLineSegments?2:1;if(p.isBufferGeometry){const ye=p.index,Me=p.attributes.position;if(null!==ye)for(let Ne=Math.max(0,L.start),$e=Math.min(ye.count,L.start+L.count)-1;Ne<$e;Ne+=he){const ze=ye.getX(Ne),Ye=ye.getX(Ne+1);if(z.fromBufferAttribute(Me,ze),Q.fromBufferAttribute(Me,Ye),sp.distanceSqToSegment(z,Q,ie,ae)>D)continue;ie.applyMatrix4(this.matrixWorld);const We=e.ray.origin.distanceTo(ie);We<e.near||We>e.far||c.push({distance:We,point:ae.clone().applyMatrix4(this.matrixWorld),index:Ne,face:null,faceIndex:null,object:this})}else for(let Ne=Math.max(0,L.start),$e=Math.min(Me.count,L.start+L.count)-1;Ne<$e;Ne+=he){if(z.fromBufferAttribute(Me,Ne),Q.fromBufferAttribute(Me,Ne+1),sp.distanceSqToSegment(z,Q,ie,ae)>D)continue;ie.applyMatrix4(this.matrixWorld);const ze=e.ray.origin.distanceTo(ie);ze<e.near||ze>e.far||c.push({distance:ze,point:ae.clone().applyMatrix4(this.matrixWorld),index:Ne,face:null,faceIndex:null,object:this})}}else p.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const c=e.morphAttributes,p=Object.keys(c);if(p.length>0){const _=c[p[0]];if(void 0!==_){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let w=0,L=_.length;w<L;w++){const O=_[w].name||String(w);this.morphTargetInfluences.push(0),this.morphTargetDictionary[O]=w}}}}else{const c=e.morphTargets;void 0!==c&&c.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}Oo.prototype.isLine=!0;const $o=new lt,ko=new lt;class Fo extends Oo{constructor(e,c){super(e,c),this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.isBufferGeometry)if(null===e.index){const c=e.attributes.position,p=[];for(let _=0,w=c.count;_<w;_+=2)$o.fromBufferAttribute(c,_),ko.fromBufferAttribute(c,_+1),p[_]=0===_?0:p[_-1],p[_+1]=p[_]+$o.distanceTo(ko);e.setAttribute("lineDistance",new dn(p,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}Fo.prototype.isLineSegments=!0;class tf extends Oo{constructor(e,c){super(e,c),this.type="LineLoop"}}tf.prototype.isLineLoop=!0;class Co extends As{constructor(e){super(),this.type="PointsMaterial",this.color=new tr(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this}}Co.prototype.isPointsMaterial=!0;const Ai=new Qt,cs=new _n,mi=new xo,Lo=new lt;class Qr extends Ir{constructor(e=new br,c=new Co){super(),this.type="Points",this.geometry=e,this.material=c,this.updateMorphTargets()}copy(e){return super.copy(e),this.material=e.material,this.geometry=e.geometry,this}raycast(e,c){const p=this.geometry,_=this.matrixWorld,w=e.params.Points.threshold,L=p.drawRange;if(null===p.boundingSphere&&p.computeBoundingSphere(),mi.copy(p.boundingSphere),mi.applyMatrix4(_),mi.radius+=w,!1===e.ray.intersectsSphere(mi))return;Ai.copy(_).invert(),cs.copy(e.ray).applyMatrix4(Ai);const O=w/((this.scale.x+this.scale.y+this.scale.z)/3),D=O*O;if(p.isBufferGeometry){const z=p.index,Q=p.attributes.position;if(null!==z)for(let ae=Math.max(0,L.start),ie=Math.min(z.count,L.start+L.count);ae<ie;ae++){const he=z.getX(ae);Lo.fromBufferAttribute(Q,he),bs(Lo,he,D,_,e,c,this)}else for(let ae=Math.max(0,L.start),ie=Math.min(Q.count,L.start+L.count);ae<ie;ae++)Lo.fromBufferAttribute(Q,ae),bs(Lo,ae,D,_,e,c,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const e=this.geometry;if(e.isBufferGeometry){const c=e.morphAttributes,p=Object.keys(c);if(p.length>0){const _=c[p[0]];if(void 0!==_){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let w=0,L=_.length;w<L;w++){const O=_[w].name||String(w);this.morphTargetInfluences.push(0),this.morphTargetDictionary[O]=w}}}}else{const c=e.morphTargets;void 0!==c&&c.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}function bs(S,e,c,p,_,w,L){const O=cs.distanceSqToPoint(S);if(O<c){const D=new lt;cs.closestPointToPoint(S,D),D.applyMatrix4(p);const z=_.ray.origin.distanceTo(D);if(z<_.near||z>_.far)return;w.push({distance:z,distanceToRay:Math.sqrt(O),point:D,index:e,face:null,object:L})}}Qr.prototype.isPoints=!0;class iu extends Ms{constructor(e,c,p,_,w,L,O,D,z){super(e,c,p,_,w,L,O,D,z),this.format=void 0!==O?O:Rs,this.minFilter=void 0!==L?L:ii,this.magFilter=void 0!==w?w:ii,this.generateMipmaps=!1;const Q=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(function ae(){Q.needsUpdate=!0,e.requestVideoFrameCallback(ae)})}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;!("requestVideoFrameCallback"in e)&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}iu.prototype.isVideoTexture=!0;class Ds extends Ms{constructor(e,c,p,_,w,L,O,D,z,Q,ae,ie){super(null,L,O,D,z,Q,_,w,ae,ie),this.image={width:c,height:p},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}Ds.prototype.isCompressedTexture=!0;class _f extends Ms{constructor(e,c,p,_,w,L,O,D,z){super(e,c,p,_,w,L,O,D,z),this.needsUpdate=!0}}_f.prototype.isCanvasTexture=!0;class $c extends Ms{constructor(e,c,p,_,w,L,O,D,z,Q){if((Q=void 0!==Q?Q:To)!==To&&Q!==Ws)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===p&&Q===To&&(p=Ic),void 0===p&&Q===Ws&&(p=Es),super(null,_,w,L,O,D,Q,p,z),this.image={width:e,height:c},this.magFilter=void 0!==O?O:Or,this.minFilter=void 0!==D?D:Or,this.flipY=!1,this.generateMipmaps=!1}}$c.prototype.isDepthTexture=!0;class Wp extends br{constructor(e=1,c=8,p=0,_=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:c,thetaStart:p,thetaLength:_},c=Math.max(3,c);const w=[],L=[],O=[],D=[],z=new lt,Q=new Un;L.push(0,0,0),O.push(0,0,1),D.push(.5,.5);for(let ae=0,ie=3;ae<=c;ae++,ie+=3){const he=p+ae/c*_;z.x=e*Math.cos(he),z.y=e*Math.sin(he),L.push(z.x,z.y,z.z),O.push(0,0,1),Q.x=(L[ie]/e+1)/2,Q.y=(L[ie+1]/e+1)/2,D.push(Q.x,Q.y)}for(let ae=1;ae<=c;ae++)w.push(ae,ae+1,0);this.setIndex(w),this.setAttribute("position",new dn(L,3)),this.setAttribute("normal",new dn(O,3)),this.setAttribute("uv",new dn(D,2))}static fromJSON(e){return new Wp(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class Ih extends br{constructor(e=1,c=1,p=1,_=8,w=1,L=!1,O=0,D=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:c,height:p,radialSegments:_,heightSegments:w,openEnded:L,thetaStart:O,thetaLength:D};const z=this;_=Math.floor(_),w=Math.floor(w);const Q=[],ae=[],ie=[],he=[];let ye=0;const Me=[],Ne=p/2;let $e=0;function ze(Ye){const We=ye,nt=new Un,it=new lt;let mt=0;const xt=!0===Ye?e:c,Dt=!0===Ye?1:-1;for(let Je=1;Je<=_;Je++)ae.push(0,Ne*Dt,0),ie.push(0,Dt,0),he.push(.5,.5),ye++;const Ht=ye;for(let Je=0;Je<=_;Je++){const pt=Je/_*D+O,Vt=Math.cos(pt),Nt=Math.sin(pt);it.x=xt*Nt,it.y=Ne*Dt,it.z=xt*Vt,ae.push(it.x,it.y,it.z),ie.push(0,Dt,0),nt.x=.5*Vt+.5,nt.y=.5*Nt*Dt+.5,he.push(nt.x,nt.y),ye++}for(let Je=0;Je<_;Je++){const pt=We+Je,Vt=Ht+Je;!0===Ye?Q.push(Vt,Vt+1,pt):Q.push(Vt+1,Vt,pt),mt+=3}z.addGroup($e,mt,!0===Ye?1:2),$e+=mt}(function(){const Ye=new lt,We=new lt;let nt=0;const it=(c-e)/p;for(let mt=0;mt<=w;mt++){const xt=[],Dt=mt/w,Ht=Dt*(c-e)+e;for(let Je=0;Je<=_;Je++){const pt=Je/_,Vt=pt*D+O,Nt=Math.sin(Vt),ct=Math.cos(Vt);We.x=Ht*Nt,We.y=-Dt*p+Ne,We.z=Ht*ct,ae.push(We.x,We.y,We.z),Ye.set(Nt,it,ct).normalize(),ie.push(Ye.x,Ye.y,Ye.z),he.push(pt,1-Dt),xt.push(ye++)}Me.push(xt)}for(let mt=0;mt<_;mt++)for(let xt=0;xt<w;xt++){const Ht=Me[xt+1][mt],Je=Me[xt+1][mt+1],pt=Me[xt][mt+1];Q.push(Me[xt][mt],Ht,pt),Q.push(Ht,Je,pt),nt+=6}z.addGroup($e,nt,0),$e+=nt})(),!1===L&&(e>0&&ze(!0),c>0&&ze(!1)),this.setIndex(Q),this.setAttribute("position",new dn(ae,3)),this.setAttribute("normal",new dn(ie,3)),this.setAttribute("uv",new dn(he,2))}static fromJSON(e){return new Ih(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Cc extends Ih{constructor(e=1,c=1,p=8,_=1,w=!1,L=0,O=2*Math.PI){super(0,e,c,p,_,w,L,O),this.type="ConeGeometry",this.parameters={radius:e,height:c,radialSegments:p,heightSegments:_,openEnded:w,thetaStart:L,thetaLength:O}}static fromJSON(e){return new Cc(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class ha extends br{constructor(e,c,p=1,_=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:c,radius:p,detail:_};const w=[],L=[];function O(he,ye,Me,Ne){const $e=Ne+1,ze=[];for(let Ye=0;Ye<=$e;Ye++){ze[Ye]=[];const We=he.clone().lerp(Me,Ye/$e),nt=ye.clone().lerp(Me,Ye/$e),it=$e-Ye;for(let mt=0;mt<=it;mt++)ze[Ye][mt]=0===mt&&Ye===$e?We:We.clone().lerp(nt,mt/it)}for(let Ye=0;Ye<$e;Ye++)for(let We=0;We<2*($e-Ye)-1;We++){const nt=Math.floor(We/2);We%2==0?(D(ze[Ye][nt+1]),D(ze[Ye+1][nt]),D(ze[Ye][nt])):(D(ze[Ye][nt+1]),D(ze[Ye+1][nt+1]),D(ze[Ye+1][nt]))}}function D(he){w.push(he.x,he.y,he.z)}function z(he,ye){const Me=3*he;ye.x=e[Me+0],ye.y=e[Me+1],ye.z=e[Me+2]}function Q(he,ye,Me,Ne){Ne<0&&1===he.x&&(L[ye]=he.x-1),0===Me.x&&0===Me.z&&(L[ye]=Ne/2/Math.PI+.5)}function ae(he){return Math.atan2(he.z,-he.x)}function ie(he){return Math.atan2(-he.y,Math.sqrt(he.x*he.x+he.z*he.z))}(function(he){const ye=new lt,Me=new lt,Ne=new lt;for(let $e=0;$e<c.length;$e+=3)z(c[$e+0],ye),z(c[$e+1],Me),z(c[$e+2],Ne),O(ye,Me,Ne,he)})(_),function(he){const ye=new lt;for(let Me=0;Me<w.length;Me+=3)ye.x=w[Me+0],ye.y=w[Me+1],ye.z=w[Me+2],ye.normalize().multiplyScalar(he),w[Me+0]=ye.x,w[Me+1]=ye.y,w[Me+2]=ye.z}(p),function(){const he=new lt;for(let ye=0;ye<w.length;ye+=3){he.x=w[ye+0],he.y=w[ye+1],he.z=w[ye+2];const Me=ae(he)/2/Math.PI+.5,Ne=ie(he)/Math.PI+.5;L.push(Me,1-Ne)}(function(){const ye=new lt,Me=new lt,Ne=new lt,$e=new lt,ze=new Un,Ye=new Un,We=new Un;for(let nt=0,it=0;nt<w.length;nt+=9,it+=6){ye.set(w[nt+0],w[nt+1],w[nt+2]),Me.set(w[nt+3],w[nt+4],w[nt+5]),Ne.set(w[nt+6],w[nt+7],w[nt+8]),ze.set(L[it+0],L[it+1]),Ye.set(L[it+2],L[it+3]),We.set(L[it+4],L[it+5]),$e.copy(ye).add(Me).add(Ne).divideScalar(3);const mt=ae($e);Q(ze,it+0,ye,mt),Q(Ye,it+2,Me,mt),Q(We,it+4,Ne,mt)}})(),function(){for(let ye=0;ye<L.length;ye+=6){const Me=L[ye+0],Ne=L[ye+2],$e=L[ye+4],ze=Math.max(Me,Ne,$e),Ye=Math.min(Me,Ne,$e);ze>.9&&Ye<.1&&(Me<.2&&(L[ye+0]+=1),Ne<.2&&(L[ye+2]+=1),$e<.2&&(L[ye+4]+=1))}}()}(),this.setAttribute("position",new dn(w,3)),this.setAttribute("normal",new dn(w.slice(),3)),this.setAttribute("uv",new dn(L,2)),0===_?this.computeVertexNormals():this.normalizeNormals()}static fromJSON(e){return new ha(e.vertices,e.indices,e.radius,e.details)}}class ad extends ha{constructor(e=1,c=0){const p=(1+Math.sqrt(5))/2,_=1/p;super([-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-_,-p,0,-_,p,0,_,-p,0,_,p,-_,-p,0,-_,p,0,_,-p,0,_,p,0,-p,0,-_,p,0,-_,-p,0,_,p,0,_],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,c),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:c}}static fromJSON(e){return new ad(e.radius,e.detail)}}const Cd=new lt,Oh=new lt,ho=new lt,Cr=new eo;class Hr extends br{constructor(e,c){if(super(),this.type="EdgesGeometry",this.parameters={thresholdAngle:c},c=void 0!==c?c:1,!0===e.isGeometry)return void console.error("THREE.EdgesGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");const p=Math.pow(10,4),_=Math.cos(jo*c),w=e.getIndex(),L=e.getAttribute("position"),O=w?w.count:L.count,D=[0,0,0],z=["a","b","c"],Q=new Array(3),ae={},ie=[];for(let he=0;he<O;he+=3){w?(D[0]=w.getX(he),D[1]=w.getX(he+1),D[2]=w.getX(he+2)):(D[0]=he,D[1]=he+1,D[2]=he+2);const{a:ye,b:Me,c:Ne}=Cr;if(ye.fromBufferAttribute(L,D[0]),Me.fromBufferAttribute(L,D[1]),Ne.fromBufferAttribute(L,D[2]),Cr.getNormal(ho),Q[0]=`${Math.round(ye.x*p)},${Math.round(ye.y*p)},${Math.round(ye.z*p)}`,Q[1]=`${Math.round(Me.x*p)},${Math.round(Me.y*p)},${Math.round(Me.z*p)}`,Q[2]=`${Math.round(Ne.x*p)},${Math.round(Ne.y*p)},${Math.round(Ne.z*p)}`,Q[0]!==Q[1]&&Q[1]!==Q[2]&&Q[2]!==Q[0])for(let $e=0;$e<3;$e++){const ze=($e+1)%3,Ye=Q[$e],We=Q[ze],nt=Cr[z[$e]],it=Cr[z[ze]],mt=`${Ye}_${We}`,xt=`${We}_${Ye}`;xt in ae&&ae[xt]?(ho.dot(ae[xt].normal)<=_&&(ie.push(nt.x,nt.y,nt.z),ie.push(it.x,it.y,it.z)),ae[xt]=null):mt in ae||(ae[mt]={index0:D[$e],index1:D[ze],normal:ho.clone()})}}for(const he in ae)if(ae[he]){const{index0:ye,index1:Me}=ae[he];Cd.fromBufferAttribute(L,ye),Oh.fromBufferAttribute(L,Me),ie.push(Cd.x,Cd.y,Cd.z),ie.push(Oh.x,Oh.y,Oh.z)}this.setAttribute("position",new dn(ie,3))}}class pa{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,c){const p=this.getUtoTmapping(e);return this.getPoint(p,c)}getPoints(e=5){const c=[];for(let p=0;p<=e;p++)c.push(this.getPoint(p/e));return c}getSpacedPoints(e=5){const c=[];for(let p=0;p<=e;p++)c.push(this.getPointAt(p/e));return c}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const c=[];let p,_=this.getPoint(0),w=0;c.push(0);for(let L=1;L<=e;L++)p=this.getPoint(L/e),w+=p.distanceTo(_),c.push(w),_=p;return this.cacheArcLengths=c,c}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,c){const p=this.getLengths();let _=0;const w=p.length;let L;L=c||e*p[w-1];let O,D=0,z=w-1;for(;D<=z;)if(_=Math.floor(D+(z-D)/2),O=p[_]-L,O<0)D=_+1;else{if(!(O>0)){z=_;break}z=_-1}if(_=z,p[_]===L)return _/(w-1);const Q=p[_];return(_+(L-Q)/(p[_+1]-Q))/(w-1)}getTangent(e,c){let _=e-1e-4,w=e+1e-4;_<0&&(_=0),w>1&&(w=1);const L=this.getPoint(_),O=this.getPoint(w),D=c||(L.isVector2?new Un:new lt);return D.copy(O).sub(L).normalize(),D}getTangentAt(e,c){const p=this.getUtoTmapping(e);return this.getTangent(p,c)}computeFrenetFrames(e,c){const p=new lt,_=[],w=[],L=[],O=new lt,D=new Qt;for(let he=0;he<=e;he++)_[he]=this.getTangentAt(he/e,new lt),_[he].normalize();w[0]=new lt,L[0]=new lt;let z=Number.MAX_VALUE;const Q=Math.abs(_[0].x),ae=Math.abs(_[0].y),ie=Math.abs(_[0].z);Q<=z&&(z=Q,p.set(1,0,0)),ae<=z&&(z=ae,p.set(0,1,0)),ie<=z&&p.set(0,0,1),O.crossVectors(_[0],p).normalize(),w[0].crossVectors(_[0],O),L[0].crossVectors(_[0],w[0]);for(let he=1;he<=e;he++){if(w[he]=w[he-1].clone(),L[he]=L[he-1].clone(),O.crossVectors(_[he-1],_[he]),O.length()>Number.EPSILON){O.normalize();const ye=Math.acos(jr(_[he-1].dot(_[he]),-1,1));w[he].applyMatrix4(D.makeRotationAxis(O,ye))}L[he].crossVectors(_[he],w[he])}if(!0===c){let he=Math.acos(jr(w[0].dot(w[e]),-1,1));he/=e,_[0].dot(O.crossVectors(w[0],w[e]))>0&&(he=-he);for(let ye=1;ye<=e;ye++)w[ye].applyMatrix4(D.makeRotationAxis(_[ye],he*ye)),L[ye].crossVectors(_[ye],w[ye])}return{tangents:_,normals:w,binormals:L}}clone(){return(new this.constructor).copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class Lc extends pa{constructor(e=0,c=0,p=1,_=1,w=0,L=2*Math.PI,O=!1,D=0){super(),this.type="EllipseCurve",this.aX=e,this.aY=c,this.xRadius=p,this.yRadius=_,this.aStartAngle=w,this.aEndAngle=L,this.aClockwise=O,this.aRotation=D}getPoint(e,c){const p=c||new Un,_=2*Math.PI;let w=this.aEndAngle-this.aStartAngle;const L=Math.abs(w)<Number.EPSILON;for(;w<0;)w+=_;for(;w>_;)w-=_;w<Number.EPSILON&&(w=L?0:_),!0!==this.aClockwise||L||(w===_?w=-_:w-=_);const O=this.aStartAngle+e*w;let D=this.aX+this.xRadius*Math.cos(O),z=this.aY+this.yRadius*Math.sin(O);if(0!==this.aRotation){const Q=Math.cos(this.aRotation),ae=Math.sin(this.aRotation),ie=D-this.aX,he=z-this.aY;D=ie*Q-he*ae+this.aX,z=ie*ae+he*Q+this.aY}return p.set(D,z)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}Lc.prototype.isEllipseCurve=!0;class Lu extends Lc{constructor(e,c,p,_,w,L){super(e,c,p,p,_,w,L),this.type="ArcCurve"}}function kh(){let S=0,e=0,c=0,p=0;function _(w,L,O,D){S=w,e=O,c=-3*w+3*L-2*O-D,p=2*w-2*L+O+D}return{initCatmullRom:function(w,L,O,D,z){_(L,O,z*(O-w),z*(D-L))},initNonuniformCatmullRom:function(w,L,O,D,z,Q,ae){let ie=(L-w)/z-(O-w)/(z+Q)+(O-L)/Q,he=(O-L)/Q-(D-L)/(Q+ae)+(D-O)/ae;ie*=Q,he*=Q,_(L,O,ie,he)},calc:function(w){const L=w*w;return S+e*w+c*L+p*(L*w)}}}Lu.prototype.isArcCurve=!0;const Bu=new lt,ou=new kh,nr=new kh,Si=new kh;class hh extends pa{constructor(e=[],c=!1,p="centripetal",_=.5){super(),this.type="CatmullRomCurve3",this.points=e,this.closed=c,this.curveType=p,this.tension=_}getPoint(e,c=new lt){const p=c,_=this.points,w=_.length,L=(w-(this.closed?0:1))*e;let O,D,z=Math.floor(L),Q=L-z;this.closed?z+=z>0?0:(Math.floor(Math.abs(z)/w)+1)*w:0===Q&&z===w-1&&(z=w-2,Q=1),this.closed||z>0?O=_[(z-1)%w]:(Bu.subVectors(_[0],_[1]).add(_[0]),O=Bu);const ae=_[z%w],ie=_[(z+1)%w];if(this.closed||z+2<w?D=_[(z+2)%w]:(Bu.subVectors(_[w-1],_[w-2]).add(_[w-1]),D=Bu),"centripetal"===this.curveType||"chordal"===this.curveType){const he="chordal"===this.curveType?.5:.25;let ye=Math.pow(O.distanceToSquared(ae),he),Me=Math.pow(ae.distanceToSquared(ie),he),Ne=Math.pow(ie.distanceToSquared(D),he);Me<1e-4&&(Me=1),ye<1e-4&&(ye=Me),Ne<1e-4&&(Ne=Me),ou.initNonuniformCatmullRom(O.x,ae.x,ie.x,D.x,ye,Me,Ne),nr.initNonuniformCatmullRom(O.y,ae.y,ie.y,D.y,ye,Me,Ne),Si.initNonuniformCatmullRom(O.z,ae.z,ie.z,D.z,ye,Me,Ne)}else"catmullrom"===this.curveType&&(ou.initCatmullRom(O.x,ae.x,ie.x,D.x,this.tension),nr.initCatmullRom(O.y,ae.y,ie.y,D.y,this.tension),Si.initCatmullRom(O.z,ae.z,ie.z,D.z,this.tension));return p.set(ou.calc(Q),nr.calc(Q),Si.calc(Q)),p}copy(e){super.copy(e),this.points=[];for(let c=0,p=e.points.length;c<p;c++)this.points.push(e.points[c].clone());return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let c=0,p=this.points.length;c<p;c++)e.points.push(this.points[c].toArray());return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let c=0,p=e.points.length;c<p;c++){const _=e.points[c];this.points.push((new lt).fromArray(_))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function Nn(S,e,c,p,_){const w=.5*(p-e),L=.5*(_-c),O=S*S;return(2*c-2*p+w+L)*(S*O)+(-3*c+3*p-2*w-L)*O+w*S+c}function Jo(S,e,c,p){return function(_,w){const L=1-_;return L*L*w}(S,e)+2*(1-(_=S))*_*c+function(_,w){return _*_*w}(S,p);var _}function Pi(S,e,c,p,_){return function(w,L){const O=1-w;return O*O*O*L}(S,e)+function(w,L){const O=1-w;return 3*O*O*w*L}(S,c)+3*(1-(w=S))*w*w*p+function(w,L){return w*w*w*L}(S,_);var w}hh.prototype.isCatmullRomCurve3=!0;class ap extends pa{constructor(e=new Un,c=new Un,p=new Un,_=new Un){super(),this.type="CubicBezierCurve",this.v0=e,this.v1=c,this.v2=p,this.v3=_}getPoint(e,c=new Un){const p=c,_=this.v0,w=this.v1,L=this.v2,O=this.v3;return p.set(Pi(e,_.x,w.x,L.x,O.x),Pi(e,_.y,w.y,L.y,O.y)),p}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}ap.prototype.isCubicBezierCurve=!0;class lp extends pa{constructor(e=new lt,c=new lt,p=new lt,_=new lt){super(),this.type="CubicBezierCurve3",this.v0=e,this.v1=c,this.v2=p,this.v3=_}getPoint(e,c=new lt){const p=c,_=this.v0,w=this.v1,L=this.v2,O=this.v3;return p.set(Pi(e,_.x,w.x,L.x,O.x),Pi(e,_.y,w.y,L.y,O.y),Pi(e,_.z,w.z,L.z,O.z)),p}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}lp.prototype.isCubicBezierCurve3=!0;class Js extends pa{constructor(e=new Un,c=new Un){super(),this.type="LineCurve",this.v1=e,this.v2=c}getPoint(e,c=new Un){const p=c;return 1===e?p.copy(this.v2):(p.copy(this.v2).sub(this.v1),p.multiplyScalar(e).add(this.v1)),p}getPointAt(e,c){return this.getPoint(e,c)}getTangent(e,c){const p=c||new Un;return p.copy(this.v2).sub(this.v1).normalize(),p}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}Js.prototype.isLineCurve=!0;class ph extends pa{constructor(e=new lt,c=new lt){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=e,this.v2=c}getPoint(e,c=new lt){const p=c;return 1===e?p.copy(this.v2):(p.copy(this.v2).sub(this.v1),p.multiplyScalar(e).add(this.v1)),p}getPointAt(e,c){return this.getPoint(e,c)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class qi extends pa{constructor(e=new Un,c=new Un,p=new Un){super(),this.type="QuadraticBezierCurve",this.v0=e,this.v1=c,this.v2=p}getPoint(e,c=new Un){const p=c,_=this.v0,w=this.v1,L=this.v2;return p.set(Jo(e,_.x,w.x,L.x),Jo(e,_.y,w.y,L.y)),p}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}qi.prototype.isQuadraticBezierCurve=!0;class da extends pa{constructor(e=new lt,c=new lt,p=new lt){super(),this.type="QuadraticBezierCurve3",this.v0=e,this.v1=c,this.v2=p}getPoint(e,c=new lt){const p=c,_=this.v0,w=this.v1,L=this.v2;return p.set(Jo(e,_.x,w.x,L.x),Jo(e,_.y,w.y,L.y),Jo(e,_.z,w.z,L.z)),p}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}da.prototype.isQuadraticBezierCurve3=!0;class pl extends pa{constructor(e=[]){super(),this.type="SplineCurve",this.points=e}getPoint(e,c=new Un){const p=c,_=this.points,w=(_.length-1)*e,L=Math.floor(w),O=w-L,D=_[0===L?L:L-1],z=_[L],Q=_[L>_.length-2?_.length-1:L+1],ae=_[L>_.length-3?_.length-1:L+2];return p.set(Nn(O,D.x,z.x,Q.x,ae.x),Nn(O,D.y,z.y,Q.y,ae.y)),p}copy(e){super.copy(e),this.points=[];for(let c=0,p=e.points.length;c<p;c++)this.points.push(e.points[c].clone());return this}toJSON(){const e=super.toJSON();e.points=[];for(let c=0,p=this.points.length;c<p;c++)e.points.push(this.points[c].toArray());return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let c=0,p=e.points.length;c<p;c++){const _=e.points[c];this.points.push((new Un).fromArray(_))}return this}}pl.prototype.isSplineCurve=!0;var po=Object.freeze({__proto__:null,ArcCurve:Lu,CatmullRomCurve3:hh,CubicBezierCurve:ap,CubicBezierCurve3:lp,EllipseCurve:Lc,LineCurve:Js,LineCurve3:ph,QuadraticBezierCurve:qi,QuadraticBezierCurve3:da,SplineCurve:pl});function us(S,e,c,p,_){let w,L;if(_===function(O,D,z,Q){let ae=0;for(let ie=D,he=z-Q;ie<z;ie+=Q)ae+=(O[he]-O[ie])*(O[ie+1]+O[he+1]),he=ie;return ae}(S,e,c,p)>0)for(w=e;w<c;w+=p)L=Ei(w,S[w],S[w+1],L);else for(w=c-p;w>=e;w-=p)L=Ei(w,S[w],S[w+1],L);return L&&Nu(L,L.next)&&(fa(L),L=L.next),L}function Go(S,e){if(!S)return S;e||(e=S);let c,p=S;do{if(c=!1,p.steiner||!Nu(p,p.next)&&0!==$i(p.prev,p,p.next))p=p.next;else{if(fa(p),p=e=p.prev,p===p.next)break;c=!0}}while(c||p!==e);return e}function to(S,e,c,p,_,w,L){if(!S)return;!L&&w&&function(Q,ae,ie,he){let ye=Q;do{null===ye.z&&(ye.z=Bc(ye.x,ye.y,ae,ie,he)),ye.prevZ=ye.prev,ye.nextZ=ye.next,ye=ye.next}while(ye!==Q);ye.prevZ.nextZ=null,ye.prevZ=null,function(Me){let Ne,$e,ze,Ye,We,nt,it,mt,xt=1;do{for($e=Me,Me=null,We=null,nt=0;$e;){for(nt++,ze=$e,it=0,Ne=0;Ne<xt&&(it++,ze=ze.nextZ,ze);Ne++);for(mt=xt;it>0||mt>0&&ze;)0!==it&&(0===mt||!ze||$e.z<=ze.z)?(Ye=$e,$e=$e.nextZ,it--):(Ye=ze,ze=ze.nextZ,mt--),We?We.nextZ=Ye:Me=Ye,Ye.prevZ=We,We=Ye;$e=ze}We.nextZ=null,xt*=2}while(nt>1)}(ye)}(S,p,_,w);let O,D,z=S;for(;S.prev!==S.next;)if(O=S.prev,D=S.next,w?$a(S,p,_,w):Zo(S))e.push(O.i/c),e.push(S.i/c),e.push(D.i/c),fa(S),S=D.next,z=D.next;else if((S=D)===z){L?1===L?to(S=Fh(Go(S),e,c),e,c,p,_,w,2):2===L&&oo(S,e,c,p,_,w):to(Go(S),e,c,p,_,w,1);break}}function Zo(S){const e=S.prev,c=S,p=S.next;if($i(e,c,p)>=0)return!1;let _=S.next.next;for(;_!==S.prev;){if(dl(e.x,e.y,c.x,c.y,p.x,p.y,_.x,_.y)&&$i(_.prev,_,_.next)>=0)return!1;_=_.next}return!0}function $a(S,e,c,p){const _=S.prev,w=S,L=S.next;if($i(_,w,L)>=0)return!1;const z=_.x>w.x?_.x>L.x?_.x:L.x:w.x>L.x?w.x:L.x,Q=_.y>w.y?_.y>L.y?_.y:L.y:w.y>L.y?w.y:L.y,ae=Bc(_.x<w.x?_.x<L.x?_.x:L.x:w.x<L.x?w.x:L.x,_.y<w.y?_.y<L.y?_.y:L.y:w.y<L.y?w.y:L.y,e,c,p),ie=Bc(z,Q,e,c,p);let he=S.prevZ,ye=S.nextZ;for(;he&&he.z>=ae&&ye&&ye.z<=ie;){if(he!==S.prev&&he!==S.next&&dl(_.x,_.y,w.x,w.y,L.x,L.y,he.x,he.y)&&$i(he.prev,he,he.next)>=0||(he=he.prevZ,ye!==S.prev&&ye!==S.next&&dl(_.x,_.y,w.x,w.y,L.x,L.y,ye.x,ye.y)&&$i(ye.prev,ye,ye.next)>=0))return!1;ye=ye.nextZ}for(;he&&he.z>=ae;){if(he!==S.prev&&he!==S.next&&dl(_.x,_.y,w.x,w.y,L.x,L.y,he.x,he.y)&&$i(he.prev,he,he.next)>=0)return!1;he=he.prevZ}for(;ye&&ye.z<=ie;){if(ye!==S.prev&&ye!==S.next&&dl(_.x,_.y,w.x,w.y,L.x,L.y,ye.x,ye.y)&&$i(ye.prev,ye,ye.next)>=0)return!1;ye=ye.nextZ}return!0}function Fh(S,e,c){let p=S;do{const _=p.prev,w=p.next.next;!Nu(_,w)&&Nc(_,p,p.next,w)&&zs(_,w)&&zs(w,_)&&(e.push(_.i/c),e.push(p.i/c),e.push(w.i/c),fa(p),fa(p.next),p=S=w),p=p.next}while(p!==S);return Go(p)}function oo(S,e,c,p,_,w){let L=S;do{let O=L.next.next;for(;O!==L.prev;){if(L.i!==O.i&&nf(L,O)){let D=Pu(L,O);return L=Go(L,L.next),D=Go(D,D.next),to(L,e,c,p,_,w),void to(D,e,c,p,_,w)}O=O.next}L=L.next}while(L!==S)}function Us(S,e){return S.x-e.x}function dh(S,e){if(e=function(c,p){let _=p;const w=c.x,L=c.y;let O,D=-1/0;do{if(L<=_.y&&L>=_.next.y&&_.next.y!==_.y){const ye=_.x+(L-_.y)*(_.next.x-_.x)/(_.next.y-_.y);if(ye<=w&&ye>D){if(D=ye,ye===w){if(L===_.y)return _;if(L===_.next.y)return _.next}O=_.x<_.next.x?_:_.next}}_=_.next}while(_!==p);if(!O)return null;if(w===D)return O;const z=O,Q=O.x,ae=O.y;let ie,he=1/0;_=O;do{w>=_.x&&_.x>=Q&&w!==_.x&&dl(L<ae?w:D,L,Q,ae,L<ae?D:w,L,_.x,_.y)&&(ie=Math.abs(L-_.y)/(w-_.x),zs(_,c)&&(ie<he||ie===he&&(_.x>O.x||_.x===O.x&&Wa(O,_)))&&(O=_,he=ie)),_=_.next}while(_!==z);return O}(S,e)){const c=Pu(e,S);Go(e,e.next),Go(c,c.next)}}function Wa(S,e){return $i(S.prev,S,e.prev)<0&&$i(e.next,S,S.next)<0}function Bc(S,e,c,p,_){return(S=1431655765&((S=858993459&((S=252645135&((S=16711935&((S=32767*(S-c)*_)|S<<8))|S<<4))|S<<2))|S<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-p)*_)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function fo(S){let e=S,c=S;do{(e.x<c.x||e.x===c.x&&e.y<c.y)&&(c=e),e=e.next}while(e!==S);return c}function dl(S,e,c,p,_,w,L,O){return(_-L)*(e-O)-(S-L)*(w-O)>=0&&(S-L)*(p-O)-(c-L)*(e-O)>=0&&(c-L)*(w-O)-(_-L)*(p-O)>=0}function nf(S,e){return S.next.i!==e.i&&S.prev.i!==e.i&&!function(c,p){let _=c;do{if(_.i!==c.i&&_.next.i!==c.i&&_.i!==p.i&&_.next.i!==p.i&&Nc(_,_.next,c,p))return!0;_=_.next}while(_!==c);return!1}(S,e)&&(zs(S,e)&&zs(e,S)&&function(c,p){let _=c,w=!1;const L=(c.x+p.x)/2,O=(c.y+p.y)/2;do{_.y>O!=_.next.y>O&&_.next.y!==_.y&&L<(_.next.x-_.x)*(O-_.y)/(_.next.y-_.y)+_.x&&(w=!w),_=_.next}while(_!==c);return w}(S,e)&&($i(S.prev,S,e.prev)||$i(S,e.prev,e))||Nu(S,e)&&$i(S.prev,S,S.next)>0&&$i(e.prev,e,e.next)>0)}function $i(S,e,c){return(e.y-S.y)*(c.x-e.x)-(e.x-S.x)*(c.y-e.y)}function Nu(S,e){return S.x===e.x&&S.y===e.y}function Nc(S,e,c,p){const _=su($i(S,e,c)),w=su($i(S,e,p)),L=su($i(c,p,S)),O=su($i(c,p,e));return _!==w&&L!==O||!(0!==_||!Ru(S,c,e))||!(0!==w||!Ru(S,p,e))||!(0!==L||!Ru(c,S,p))||!(0!==O||!Ru(c,e,p))}function Ru(S,e,c){return e.x<=Math.max(S.x,c.x)&&e.x>=Math.min(S.x,c.x)&&e.y<=Math.max(S.y,c.y)&&e.y>=Math.min(S.y,c.y)}function su(S){return S>0?1:S<0?-1:0}function zs(S,e){return $i(S.prev,S,S.next)<0?$i(S,e,S.next)>=0&&$i(S,S.prev,e)>=0:$i(S,e,S.prev)<0||$i(S,S.next,e)<0}function Pu(S,e){const c=new rf(S.i,S.x,S.y),p=new rf(e.i,e.x,e.y),_=S.next,w=e.prev;return S.next=e,e.prev=S,c.next=_,_.prev=c,p.next=c,c.prev=p,w.next=p,p.prev=w,p}function Ei(S,e,c,p){const _=new rf(S,e,c);return p?(_.next=p.next,_.prev=p,p.next.prev=_,p.next=_):(_.prev=_,_.next=_),_}function fa(S){S.next.prev=S.prev,S.prev.next=S.next,S.prevZ&&(S.prevZ.nextZ=S.nextZ),S.nextZ&&(S.nextZ.prevZ=S.prevZ)}function rf(S,e,c){this.i=S,this.x=e,this.y=c,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}class Ci{static area(e){const c=e.length;let p=0;for(let _=c-1,w=0;w<c;_=w++)p+=e[_].x*e[w].y-e[w].x*e[_].y;return.5*p}static isClockWise(e){return Ci.area(e)<0}static triangulateShape(e,c){const p=[],_=[],w=[];ma(e),tc(p,e);let L=e.length;c.forEach(ma);for(let D=0;D<c.length;D++)_.push(L),L+=c[D].length,tc(p,c[D]);const O=function(D,z,Q=2){const ae=z&&z.length,ie=ae?z[0]*Q:D.length;let he=us(D,0,ie,Q,!0);const ye=[];if(!he||he.next===he.prev)return ye;let Me,Ne,$e,ze,Ye,We,nt;if(ae&&(he=function(it,mt,xt,Dt){const Ht=[];let Je,pt,Vt,Nt,ct;for(Je=0,pt=mt.length;Je<pt;Je++)Vt=mt[Je]*Dt,Nt=Je<pt-1?mt[Je+1]*Dt:it.length,ct=us(it,Vt,Nt,Dt,!1),ct===ct.next&&(ct.steiner=!0),Ht.push(fo(ct));for(Ht.sort(Us),Je=0;Je<Ht.length;Je++)dh(Ht[Je],xt),xt=Go(xt,xt.next);return xt}(D,z,he,Q)),D.length>80*Q){Me=$e=D[0],Ne=ze=D[1];for(let it=Q;it<ie;it+=Q)Ye=D[it],We=D[it+1],Ye<Me&&(Me=Ye),We<Ne&&(Ne=We),Ye>$e&&($e=Ye),We>ze&&(ze=We);nt=Math.max($e-Me,ze-Ne),nt=0!==nt?1/nt:0}return to(he,ye,Q,Me,Ne,nt),ye}(p,_);for(let D=0;D<O.length;D+=3)w.push(O.slice(D,D+3));return w}}function ma(S){const e=S.length;e>2&&S[e-1].equals(S[0])&&S.pop()}function tc(S,e){for(let c=0;c<e.length;c++)S.push(e[c].x),S.push(e[c].y)}class Il extends br{constructor(e,c){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:c},e=Array.isArray(e)?e:[e];const p=this,_=[],w=[];for(let O=0,D=e.length;O<D;O++)L(e[O]);function L(O){const D=[],z=void 0!==c.curveSegments?c.curveSegments:12,Q=void 0!==c.steps?c.steps:1;let ae=void 0!==c.depth?c.depth:100,ie=void 0===c.bevelEnabled||c.bevelEnabled,he=void 0!==c.bevelThickness?c.bevelThickness:6,ye=void 0!==c.bevelSize?c.bevelSize:he-2,Me=void 0!==c.bevelOffset?c.bevelOffset:0,Ne=void 0!==c.bevelSegments?c.bevelSegments:3;const $e=c.extrudePath,ze=void 0!==c.UVGenerator?c.UVGenerator:Ld;void 0!==c.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),ae=c.amount);let Ye,We,nt,it,mt,xt=!1;$e&&(Ye=$e.getSpacedPoints(Q),xt=!0,ie=!1,We=$e.computeFrenetFrames(Q,!1),nt=new lt,it=new lt,mt=new lt),ie||(Ne=0,he=0,ye=0,Me=0);const Dt=O.extractPoints(z);let Ht=Dt.shape;const Je=Dt.holes;if(!Ci.isClockWise(Ht)){Ht=Ht.reverse();for(let on=0,dt=Je.length;on<dt;on++){const sn=Je[on];Ci.isClockWise(sn)&&(Je[on]=sn.reverse())}}const pt=Ci.triangulateShape(Ht,Je),Vt=Ht;for(let on=0,dt=Je.length;on<dt;on++)Ht=Ht.concat(Je[on]);function Nt(on,dt,sn){return dt||console.error("THREE.ExtrudeGeometry: vec does not exist"),dt.clone().multiplyScalar(sn).add(on)}const ct=Ht.length,Yt=pt.length;function St(on,dt,sn){let Sn,hn,Wt;const xr=on.x-dt.x,mr=on.y-dt.y,Br=sn.x-on.x,Gi=sn.y-on.y,_o=xr*xr+mr*mr;if(Math.abs(xr*Gi-mr*Br)>Number.EPSILON){const Ho=Math.sqrt(_o),_l=Math.sqrt(Br*Br+Gi*Gi),uu=dt.x-mr/Ho,pp=dt.y+xr/Ho,Fd=((sn.x-Gi/_l-uu)*Gi-(sn.y+Br/_l-pp)*Br)/(xr*Gi-mr*Br);Sn=uu+xr*Fd-on.x,hn=pp+mr*Fd-on.y;const Dd=Sn*Sn+hn*hn;if(Dd<=2)return new Un(Sn,hn);Wt=Math.sqrt(Dd/2)}else{let Ho=!1;xr>Number.EPSILON?Br>Number.EPSILON&&(Ho=!0):xr<-Number.EPSILON?Br<-Number.EPSILON&&(Ho=!0):Math.sign(mr)===Math.sign(Gi)&&(Ho=!0),Ho?(Sn=-mr,hn=xr,Wt=Math.sqrt(_o)):(Sn=xr,hn=mr,Wt=Math.sqrt(_o/2))}return new Un(Sn/Wt,hn/Wt)}const jt=[];for(let on=0,dt=Vt.length,sn=dt-1,Sn=on+1;on<dt;on++,sn++,Sn++)sn===dt&&(sn=0),Sn===dt&&(Sn=0),jt[on]=St(Vt[on],Vt[sn],Vt[Sn]);const It=[];let an,Ze=jt.concat();for(let on=0,dt=Je.length;on<dt;on++){const sn=Je[on];an=[];for(let Sn=0,hn=sn.length,Wt=hn-1,xr=Sn+1;Sn<hn;Sn++,Wt++,xr++)Wt===hn&&(Wt=0),xr===hn&&(xr=0),an[Sn]=St(sn[Sn],sn[Wt],sn[xr]);It.push(an),Ze=Ze.concat(an)}for(let on=0;on<Ne;on++){const dt=on/Ne,sn=he*Math.cos(dt*Math.PI/2),Sn=ye*Math.sin(dt*Math.PI/2)+Me;for(let hn=0,Wt=Vt.length;hn<Wt;hn++){const xr=Nt(Vt[hn],jt[hn],Sn);Gt(xr.x,xr.y,-sn)}for(let hn=0,Wt=Je.length;hn<Wt;hn++){const xr=Je[hn];an=It[hn];for(let mr=0,Br=xr.length;mr<Br;mr++){const Gi=Nt(xr[mr],an[mr],Sn);Gt(Gi.x,Gi.y,-sn)}}}const st=ye+Me;for(let on=0;on<ct;on++){const dt=ie?Nt(Ht[on],Ze[on],st):Ht[on];xt?(it.copy(We.normals[0]).multiplyScalar(dt.x),nt.copy(We.binormals[0]).multiplyScalar(dt.y),mt.copy(Ye[0]).add(it).add(nt),Gt(mt.x,mt.y,mt.z)):Gt(dt.x,dt.y,0)}for(let on=1;on<=Q;on++)for(let dt=0;dt<ct;dt++){const sn=ie?Nt(Ht[dt],Ze[dt],st):Ht[dt];xt?(it.copy(We.normals[on]).multiplyScalar(sn.x),nt.copy(We.binormals[on]).multiplyScalar(sn.y),mt.copy(Ye[on]).add(it).add(nt),Gt(mt.x,mt.y,mt.z)):Gt(sn.x,sn.y,ae/Q*on)}for(let on=Ne-1;on>=0;on--){const dt=on/Ne,sn=he*Math.cos(dt*Math.PI/2),Sn=ye*Math.sin(dt*Math.PI/2)+Me;for(let hn=0,Wt=Vt.length;hn<Wt;hn++){const xr=Nt(Vt[hn],jt[hn],Sn);Gt(xr.x,xr.y,ae+sn)}for(let hn=0,Wt=Je.length;hn<Wt;hn++){const xr=Je[hn];an=It[hn];for(let mr=0,Br=xr.length;mr<Br;mr++){const Gi=Nt(xr[mr],an[mr],Sn);xt?Gt(Gi.x,Gi.y+Ye[Q-1].y,Ye[Q-1].x+sn):Gt(Gi.x,Gi.y,ae+sn)}}}function Rt(on,dt){let sn=on.length;for(;--sn>=0;){const Sn=sn;let hn=sn-1;hn<0&&(hn=on.length-1);for(let Wt=0,xr=Q+2*Ne;Wt<xr;Wt++){const mr=ct*Wt,Br=ct*(Wt+1);En(dt+Sn+mr,dt+hn+mr,dt+hn+Br,dt+Sn+Br)}}}function Gt(on,dt,sn){D.push(on),D.push(dt),D.push(sn)}function tn(on,dt,sn){Zn(on),Zn(dt),Zn(sn);const Sn=_.length/3,hn=ze.generateTopUV(p,_,Sn-3,Sn-2,Sn-1);qn(hn[0]),qn(hn[1]),qn(hn[2])}function En(on,dt,sn,Sn){Zn(on),Zn(dt),Zn(Sn),Zn(dt),Zn(sn),Zn(Sn);const hn=_.length/3,Wt=ze.generateSideWallUV(p,_,hn-6,hn-3,hn-2,hn-1);qn(Wt[0]),qn(Wt[1]),qn(Wt[3]),qn(Wt[1]),qn(Wt[2]),qn(Wt[3])}function Zn(on){_.push(D[3*on+0]),_.push(D[3*on+1]),_.push(D[3*on+2])}function qn(on){w.push(on.x),w.push(on.y)}(function(){const on=_.length/3;if(ie){let dt=0,sn=ct*dt;for(let Sn=0;Sn<Yt;Sn++){const hn=pt[Sn];tn(hn[2]+sn,hn[1]+sn,hn[0]+sn)}dt=Q+2*Ne,sn=ct*dt;for(let Sn=0;Sn<Yt;Sn++){const hn=pt[Sn];tn(hn[0]+sn,hn[1]+sn,hn[2]+sn)}}else{for(let dt=0;dt<Yt;dt++){const sn=pt[dt];tn(sn[2],sn[1],sn[0])}for(let dt=0;dt<Yt;dt++){const sn=pt[dt];tn(sn[0]+ct*Q,sn[1]+ct*Q,sn[2]+ct*Q)}}p.addGroup(on,_.length/3-on,0)})(),function(){const on=_.length/3;let dt=0;Rt(Vt,dt),dt+=Vt.length;for(let sn=0,Sn=Je.length;sn<Sn;sn++){const hn=Je[sn];Rt(hn,dt),dt+=hn.length}p.addGroup(on,_.length/3-on,1)}()}this.setAttribute("position",new dn(_,3)),this.setAttribute("uv",new dn(w,2)),this.computeVertexNormals()}toJSON(){const e=super.toJSON();return function(c,p,_){if(_.shapes=[],Array.isArray(c))for(let w=0,L=c.length;w<L;w++)_.shapes.push(c[w].uuid);else _.shapes.push(c.uuid);return void 0!==p.extrudePath&&(_.options.extrudePath=p.extrudePath.toJSON()),_}(this.parameters.shapes,this.parameters.options,e)}static fromJSON(e,c){const p=[];for(let w=0,L=e.shapes.length;w<L;w++)p.push(c[e.shapes[w]]);const _=e.options.extrudePath;return void 0!==_&&(e.options.extrudePath=(new po[_.type]).fromJSON(_)),new Il(p,e.options)}}const Ld={generateTopUV:function(S,e,c,p,_){const O=e[3*p],D=e[3*p+1],z=e[3*_],Q=e[3*_+1];return[new Un(e[3*c],e[3*c+1]),new Un(O,D),new Un(z,Q)]},generateSideWallUV:function(S,e,c,p,_,w){const L=e[3*c],O=e[3*c+1],D=e[3*c+2],z=e[3*p],Q=e[3*p+1],ae=e[3*p+2],ie=e[3*_],he=e[3*_+1],ye=e[3*_+2],Me=e[3*w],Ne=e[3*w+1],$e=e[3*w+2];return Math.abs(O-Q)<Math.abs(L-z)?[new Un(L,1-D),new Un(z,1-ae),new Un(ie,1-ye),new Un(Me,1-$e)]:[new Un(O,1-D),new Un(Q,1-ae),new Un(he,1-ye),new Un(Ne,1-$e)]}};class Iu extends ha{constructor(e=1,c=0){const p=(1+Math.sqrt(5))/2;super([-1,p,0,1,p,0,-1,-p,0,1,-p,0,0,-1,p,0,1,p,0,-1,-p,0,1,-p,p,0,-1,p,0,1,-p,0,-1,-p,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,c),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:c}}static fromJSON(e){return new Iu(e.radius,e.detail)}}class Ol extends br{constructor(e,c=12,p=0,_=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:e,segments:c,phiStart:p,phiLength:_},c=Math.floor(c),_=jr(_,0,2*Math.PI);const w=[],L=[],O=[],D=1/c,z=new lt,Q=new Un;for(let ae=0;ae<=c;ae++){const ie=p+ae*D*_,he=Math.sin(ie),ye=Math.cos(ie);for(let Me=0;Me<=e.length-1;Me++)z.x=e[Me].x*he,z.y=e[Me].y,z.z=e[Me].x*ye,L.push(z.x,z.y,z.z),Q.x=ae/c,Q.y=Me/(e.length-1),O.push(Q.x,Q.y)}for(let ae=0;ae<c;ae++)for(let ie=0;ie<e.length-1;ie++){const he=ie+ae*e.length,Me=he+e.length,Ne=he+e.length+1,$e=he+1;w.push(he,Me,$e),w.push(Me,Ne,$e)}if(this.setIndex(w),this.setAttribute("position",new dn(L,3)),this.setAttribute("uv",new dn(O,2)),this.computeVertexNormals(),_===2*Math.PI){const ae=this.attributes.normal.array,ie=new lt,he=new lt,ye=new lt,Me=c*e.length*3;for(let Ne=0,$e=0;Ne<e.length;Ne++,$e+=3)ie.x=ae[$e+0],ie.y=ae[$e+1],ie.z=ae[$e+2],he.x=ae[Me+$e+0],he.y=ae[Me+$e+1],he.z=ae[Me+$e+2],ye.addVectors(ie,he).normalize(),ae[$e+0]=ae[Me+$e+0]=ye.x,ae[$e+1]=ae[Me+$e+1]=ye.y,ae[$e+2]=ae[Me+$e+2]=ye.z}}static fromJSON(e){return new Ol(e.points,e.segments,e.phiStart,e.phiLength)}}class fl extends ha{constructor(e=1,c=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,c),this.type="OctahedronGeometry",this.parameters={radius:e,detail:c}}static fromJSON(e){return new fl(e.radius,e.detail)}}class ld extends br{constructor(e,c,p){super(),this.type="ParametricGeometry",this.parameters={func:e,slices:c,stacks:p};const _=[],w=[],L=[],O=[],D=1e-5,z=new lt,Q=new lt,ae=new lt,ie=new lt,he=new lt;e.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");const ye=c+1;for(let Me=0;Me<=p;Me++){const Ne=Me/p;for(let $e=0;$e<=c;$e++){const ze=$e/c;e(ze,Ne,Q),w.push(Q.x,Q.y,Q.z),ze-D>=0?(e(ze-D,Ne,ae),ie.subVectors(Q,ae)):(e(ze+D,Ne,ae),ie.subVectors(ae,Q)),Ne-D>=0?(e(ze,Ne-D,ae),he.subVectors(Q,ae)):(e(ze,Ne+D,ae),he.subVectors(ae,Q)),z.crossVectors(ie,he).normalize(),L.push(z.x,z.y,z.z),O.push(ze,Ne)}}for(let Me=0;Me<p;Me++)for(let Ne=0;Ne<c;Ne++){const ze=Me*ye+Ne+1,Ye=(Me+1)*ye+Ne+1,We=(Me+1)*ye+Ne;_.push(Me*ye+Ne,ze,We),_.push(ze,Ye,We)}this.setIndex(_),this.setAttribute("position",new dn(w,3)),this.setAttribute("normal",new dn(L,3)),this.setAttribute("uv",new dn(O,2))}}class Hn extends br{constructor(e=.5,c=1,p=8,_=1,w=0,L=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:c,thetaSegments:p,phiSegments:_,thetaStart:w,thetaLength:L},p=Math.max(3,p);const O=[],D=[],z=[],Q=[];let ae=e;const ie=(c-e)/(_=Math.max(1,_)),he=new lt,ye=new Un;for(let Me=0;Me<=_;Me++){for(let Ne=0;Ne<=p;Ne++){const $e=w+Ne/p*L;he.x=ae*Math.cos($e),he.y=ae*Math.sin($e),D.push(he.x,he.y,he.z),z.push(0,0,1),ye.x=(he.x/c+1)/2,ye.y=(he.y/c+1)/2,Q.push(ye.x,ye.y)}ae+=ie}for(let Me=0;Me<_;Me++){const Ne=Me*(p+1);for(let $e=0;$e<p;$e++){const ze=$e+Ne,We=ze+p+1,nt=ze+p+2,it=ze+1;O.push(ze,We,it),O.push(We,nt,it)}}this.setIndex(O),this.setAttribute("position",new dn(D,3)),this.setAttribute("normal",new dn(z,3)),this.setAttribute("uv",new dn(Q,2))}static fromJSON(e){return new Hn(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class rs extends br{constructor(e,c=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:c};const p=[],_=[],w=[],L=[];let O=0,D=0;if(!1===Array.isArray(e))z(e);else for(let Q=0;Q<e.length;Q++)z(e[Q]),this.addGroup(O,D,Q),O+=D,D=0;function z(Q){const ae=_.length/3,ie=Q.extractPoints(c);let he=ie.shape;const ye=ie.holes;!1===Ci.isClockWise(he)&&(he=he.reverse());for(let Ne=0,$e=ye.length;Ne<$e;Ne++){const ze=ye[Ne];!0===Ci.isClockWise(ze)&&(ye[Ne]=ze.reverse())}const Me=Ci.triangulateShape(he,ye);for(let Ne=0,$e=ye.length;Ne<$e;Ne++)he=he.concat(ye[Ne]);for(let Ne=0,$e=he.length;Ne<$e;Ne++){const ze=he[Ne];_.push(ze.x,ze.y,0),w.push(0,0,1),L.push(ze.x,ze.y)}for(let Ne=0,$e=Me.length;Ne<$e;Ne++){const ze=Me[Ne];p.push(ze[0]+ae,ze[1]+ae,ze[2]+ae),D+=3}}this.setIndex(p),this.setAttribute("position",new dn(_,3)),this.setAttribute("normal",new dn(w,3)),this.setAttribute("uv",new dn(L,2))}toJSON(){const e=super.toJSON();return function(c,p){if(p.shapes=[],Array.isArray(c))for(let _=0,w=c.length;_<w;_++)p.shapes.push(c[_].uuid);else p.shapes.push(c.uuid);return p}(this.parameters.shapes,e)}static fromJSON(e,c){const p=[];for(let _=0,w=e.shapes.length;_<w;_++)p.push(c[e.shapes[_]]);return new rs(p,e.curveSegments)}}class a extends br{constructor(e=1,c=32,p=16,_=0,w=2*Math.PI,L=0,O=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:c,heightSegments:p,phiStart:_,phiLength:w,thetaStart:L,thetaLength:O},c=Math.max(3,Math.floor(c)),p=Math.max(2,Math.floor(p));const D=Math.min(L+O,Math.PI);let z=0;const Q=[],ae=new lt,ie=new lt,he=[],ye=[],Me=[],Ne=[];for(let $e=0;$e<=p;$e++){const ze=[],Ye=$e/p;let We=0;0==$e&&0==L?We=.5/c:$e==p&&D==Math.PI&&(We=-.5/c);for(let nt=0;nt<=c;nt++){const it=nt/c;ae.x=-e*Math.cos(_+it*w)*Math.sin(L+Ye*O),ae.y=e*Math.cos(L+Ye*O),ae.z=e*Math.sin(_+it*w)*Math.sin(L+Ye*O),ye.push(ae.x,ae.y,ae.z),ie.copy(ae).normalize(),Me.push(ie.x,ie.y,ie.z),Ne.push(it+We,1-Ye),ze.push(z++)}Q.push(ze)}for(let $e=0;$e<p;$e++)for(let ze=0;ze<c;ze++){const We=Q[$e][ze],nt=Q[$e+1][ze],it=Q[$e+1][ze+1];(0!==$e||L>0)&&he.push(Q[$e][ze+1],We,it),($e!==p-1||D<Math.PI)&&he.push(We,nt,it)}this.setIndex(he),this.setAttribute("position",new dn(ye,3)),this.setAttribute("normal",new dn(Me,3)),this.setAttribute("uv",new dn(Ne,2))}static fromJSON(e){return new a(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class r extends ha{constructor(e=1,c=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,c),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:c}}static fromJSON(e){return new r(e.radius,e.detail)}}class h extends Il{constructor(e,c={}){const p=c.font;if(!p||!p.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new br;const _=p.generateShapes(e,c.size);c.depth=void 0!==c.height?c.height:50,void 0===c.bevelThickness&&(c.bevelThickness=10),void 0===c.bevelSize&&(c.bevelSize=8),void 0===c.bevelEnabled&&(c.bevelEnabled=!1),super(_,c),this.type="TextGeometry"}}class d extends br{constructor(e=1,c=.4,p=8,_=6,w=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:c,radialSegments:p,tubularSegments:_,arc:w},p=Math.floor(p),_=Math.floor(_);const L=[],O=[],D=[],z=[],Q=new lt,ae=new lt,ie=new lt;for(let he=0;he<=p;he++)for(let ye=0;ye<=_;ye++){const Me=ye/_*w,Ne=he/p*Math.PI*2;ae.x=(e+c*Math.cos(Ne))*Math.cos(Me),ae.y=(e+c*Math.cos(Ne))*Math.sin(Me),ae.z=c*Math.sin(Ne),O.push(ae.x,ae.y,ae.z),Q.x=e*Math.cos(Me),Q.y=e*Math.sin(Me),ie.subVectors(ae,Q).normalize(),D.push(ie.x,ie.y,ie.z),z.push(ye/_),z.push(he/p)}for(let he=1;he<=p;he++)for(let ye=1;ye<=_;ye++){const Ne=(_+1)*(he-1)+ye-1,$e=(_+1)*(he-1)+ye,ze=(_+1)*he+ye;L.push((_+1)*he+ye-1,Ne,ze),L.push(Ne,$e,ze)}this.setIndex(L),this.setAttribute("position",new dn(O,3)),this.setAttribute("normal",new dn(D,3)),this.setAttribute("uv",new dn(z,2))}static fromJSON(e){return new d(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class y extends br{constructor(e=1,c=.4,p=64,_=8,w=2,L=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:c,tubularSegments:p,radialSegments:_,p:w,q:L},p=Math.floor(p),_=Math.floor(_);const O=[],D=[],z=[],Q=[],ae=new lt,ie=new lt,he=new lt,ye=new lt,Me=new lt,Ne=new lt,$e=new lt;for(let Ye=0;Ye<=p;++Ye){const We=Ye/p*w*Math.PI*2;ze(We,w,L,e,he),ze(We+.01,w,L,e,ye),Ne.subVectors(ye,he),$e.addVectors(ye,he),Me.crossVectors(Ne,$e),$e.crossVectors(Me,Ne),Me.normalize(),$e.normalize();for(let nt=0;nt<=_;++nt){const it=nt/_*Math.PI*2,mt=-c*Math.cos(it),xt=c*Math.sin(it);ae.x=he.x+(mt*$e.x+xt*Me.x),ae.y=he.y+(mt*$e.y+xt*Me.y),ae.z=he.z+(mt*$e.z+xt*Me.z),D.push(ae.x,ae.y,ae.z),ie.subVectors(ae,he).normalize(),z.push(ie.x,ie.y,ie.z),Q.push(Ye/p),Q.push(nt/_)}}for(let Ye=1;Ye<=p;Ye++)for(let We=1;We<=_;We++){const it=(_+1)*Ye+(We-1),mt=(_+1)*Ye+We,xt=(_+1)*(Ye-1)+We;O.push((_+1)*(Ye-1)+(We-1),it,xt),O.push(it,mt,xt)}function ze(Ye,We,nt,it,mt){const xt=Math.cos(Ye),Dt=Math.sin(Ye),Ht=nt/We*Ye,Je=Math.cos(Ht);mt.x=it*(2+Je)*.5*xt,mt.y=it*(2+Je)*Dt*.5,mt.z=it*Math.sin(Ht)*.5}this.setIndex(O),this.setAttribute("position",new dn(D,3)),this.setAttribute("normal",new dn(z,3)),this.setAttribute("uv",new dn(Q,2))}static fromJSON(e){return new y(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class b extends br{constructor(e,c=64,p=1,_=8,w=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:c,radius:p,radialSegments:_,closed:w};const L=e.computeFrenetFrames(c,w);this.tangents=L.tangents,this.normals=L.normals,this.binormals=L.binormals;const O=new lt,D=new lt,z=new Un;let Q=new lt;const ae=[],ie=[],he=[],ye=[];function Me(Ne){Q=e.getPointAt(Ne/c,Q);const $e=L.normals[Ne],ze=L.binormals[Ne];for(let Ye=0;Ye<=_;Ye++){const We=Ye/_*Math.PI*2,nt=Math.sin(We),it=-Math.cos(We);D.x=it*$e.x+nt*ze.x,D.y=it*$e.y+nt*ze.y,D.z=it*$e.z+nt*ze.z,D.normalize(),ie.push(D.x,D.y,D.z),O.x=Q.x+p*D.x,O.y=Q.y+p*D.y,O.z=Q.z+p*D.z,ae.push(O.x,O.y,O.z)}}(function(){for(let Ne=0;Ne<c;Ne++)Me(Ne);Me(!1===w?c:0),function(){for(let Ne=0;Ne<=c;Ne++)for(let $e=0;$e<=_;$e++)z.x=Ne/c,z.y=$e/_,he.push(z.x,z.y)}(),function(){for(let Ne=1;Ne<=c;Ne++)for(let $e=1;$e<=_;$e++){const Ye=(_+1)*Ne+($e-1),We=(_+1)*Ne+$e,nt=(_+1)*(Ne-1)+$e;ye.push((_+1)*(Ne-1)+($e-1),Ye,nt),ye.push(Ye,We,nt)}}()})(),this.setIndex(ye),this.setAttribute("position",new dn(ae,3)),this.setAttribute("normal",new dn(ie,3)),this.setAttribute("uv",new dn(he,2))}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new b((new po[e.path.type]).fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class R extends br{constructor(e){if(super(),this.type="WireframeGeometry",!0===e.isGeometry)return void console.error("THREE.WireframeGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");const c=[],p=new Set,_=new lt,w=new lt;if(null!==e.index){const L=e.attributes.position,O=e.index;let D=e.groups;0===D.length&&(D=[{start:0,count:O.count,materialIndex:0}]);for(let z=0,Q=D.length;z<Q;++z){const ae=D[z],ie=ae.start;for(let he=ie,ye=ie+ae.count;he<ye;he+=3)for(let Me=0;Me<3;Me++){const Ne=O.getX(he+Me),$e=O.getX(he+(Me+1)%3);_.fromBufferAttribute(L,Ne),w.fromBufferAttribute(L,$e),!0===k(_,w,p)&&(c.push(_.x,_.y,_.z),c.push(w.x,w.y,w.z))}}}else{const L=e.attributes.position;for(let O=0,D=L.count/3;O<D;O++)for(let z=0;z<3;z++){const ae=3*O+(z+1)%3;_.fromBufferAttribute(L,3*O+z),w.fromBufferAttribute(L,ae),!0===k(_,w,p)&&(c.push(_.x,_.y,_.z),c.push(w.x,w.y,w.z))}}this.setAttribute("position",new dn(c,3))}}function k(S,e,c){const p=`${S.x},${S.y},${S.z}-${e.x},${e.y},${e.z}`,_=`${e.x},${e.y},${e.z}-${S.x},${S.y},${S.z}`;return!0!==c.has(p)&&!0!==c.has(_)&&(c.add(p,_),!0)}var M=Object.freeze({__proto__:null,BoxGeometry:Wl,BoxBufferGeometry:Wl,CircleGeometry:Wp,CircleBufferGeometry:Wp,ConeGeometry:Cc,ConeBufferGeometry:Cc,CylinderGeometry:Ih,CylinderBufferGeometry:Ih,DodecahedronGeometry:ad,DodecahedronBufferGeometry:ad,EdgesGeometry:Hr,ExtrudeGeometry:Il,ExtrudeBufferGeometry:Il,IcosahedronGeometry:Iu,IcosahedronBufferGeometry:Iu,LatheGeometry:Ol,LatheBufferGeometry:Ol,OctahedronGeometry:fl,OctahedronBufferGeometry:fl,ParametricGeometry:ld,ParametricBufferGeometry:ld,PlaneGeometry:Su,PlaneBufferGeometry:Su,PolyhedronGeometry:ha,PolyhedronBufferGeometry:ha,RingGeometry:Hn,RingBufferGeometry:Hn,ShapeGeometry:rs,ShapeBufferGeometry:rs,SphereGeometry:a,SphereBufferGeometry:a,TetrahedronGeometry:r,TetrahedronBufferGeometry:r,TextGeometry:h,TextBufferGeometry:h,TorusGeometry:d,TorusBufferGeometry:d,TorusKnotGeometry:y,TorusKnotBufferGeometry:y,TubeGeometry:b,TubeBufferGeometry:b,WireframeGeometry:R});class H extends As{constructor(e){super(),this.type="ShadowMaterial",this.color=new tr(0),this.transparent=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this}}H.prototype.isShadowMaterial=!0;class X extends As{constructor(e){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new tr(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new tr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Te,this.normalScale=new Un(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}X.prototype.isMeshStandardMaterial=!0;class oe extends X{constructor(e){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Un(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return jr(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(c){this.ior=(1+.4*c)/(1-.4*c)}}),this.sheenTint=new tr(0),this.transmission=0,this.transmissionMap=null,this.thickness=.01,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationTint=new tr(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularTint=new tr(1,1,1),this.specularTintMap=null,this._clearcoat=0,this._transmission=0,this.setValues(e)}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.sheenTint.copy(e.sheenTint),this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationTint.copy(e.attenuationTint),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularTint.copy(e.specularTint),this.specularTintMap=e.specularTintMap,this}}oe.prototype.isMeshPhysicalMaterial=!0;class ne extends As{constructor(e){super(),this.type="MeshPhongMaterial",this.color=new tr(16777215),this.specular=new tr(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new tr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Te,this.normalScale=new Un(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Jr,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this}}ne.prototype.isMeshPhongMaterial=!0;class ge extends As{constructor(e){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new tr(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new tr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Te,this.normalScale=new Un(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}ge.prototype.isMeshToonMaterial=!0;class we extends As{constructor(e){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Te,this.normalScale=new Un(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}we.prototype.isMeshNormalMaterial=!0;class Se extends As{constructor(e){super(),this.type="MeshLambertMaterial",this.color=new tr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new tr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Jr,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this}}Se.prototype.isMeshLambertMaterial=!0;class Ce extends As{constructor(e){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new tr(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Te,this.normalScale=new Un(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this}}Ce.prototype.isMeshMatcapMaterial=!0;class Pe extends ji{constructor(e){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}Pe.prototype.isLineDashedMaterial=!0;var Re=Object.freeze({__proto__:null,ShadowMaterial:H,SpriteMaterial:ah,RawShaderMaterial:Tu,ShaderMaterial:Ns,PointsMaterial:Co,MeshPhysicalMaterial:oe,MeshStandardMaterial:X,MeshPhongMaterial:ne,MeshToonMaterial:ge,MeshNormalMaterial:we,MeshLambertMaterial:Se,MeshDepthMaterial:Up,MeshDistanceMaterial:rd,MeshBasicMaterial:nl,MeshMatcapMaterial:Ce,LineDashedMaterial:Pe,LineBasicMaterial:ji,Material:As});const Oe={arraySlice:function(S,e,c){return Oe.isTypedArray(S)?new S.constructor(S.subarray(e,void 0!==c?c:S.length)):S.slice(e,c)},convertArray:function(S,e,c){return!S||!c&&S.constructor===e?S:"number"==typeof e.BYTES_PER_ELEMENT?new e(S):Array.prototype.slice.call(S)},isTypedArray:function(S){return ArrayBuffer.isView(S)&&!(S instanceof DataView)},getKeyframeOrder:function(S){const e=S.length,c=new Array(e);for(let p=0;p!==e;++p)c[p]=p;return c.sort(function(p,_){return S[p]-S[_]}),c},sortedArray:function(S,e,c){const p=S.length,_=new S.constructor(p);for(let w=0,L=0;L!==p;++w){const O=c[w]*e;for(let D=0;D!==e;++D)_[L++]=S[O+D]}return _},flattenJSON:function(S,e,c,p){let _=1,w=S[0];for(;void 0!==w&&void 0===w[p];)w=S[_++];if(void 0===w)return;let L=w[p];if(void 0!==L)if(Array.isArray(L))do{L=w[p],void 0!==L&&(e.push(w.time),c.push.apply(c,L)),w=S[_++]}while(void 0!==w);else if(void 0!==L.toArray)do{L=w[p],void 0!==L&&(e.push(w.time),L.toArray(c,c.length)),w=S[_++]}while(void 0!==w);else do{L=w[p],void 0!==L&&(e.push(w.time),c.push(L)),w=S[_++]}while(void 0!==w)},subclip:function(S,e,c,p,_=30){const w=S.clone();w.name=e;const L=[];for(let D=0;D<w.tracks.length;++D){const z=w.tracks[D],Q=z.getValueSize(),ae=[],ie=[];for(let he=0;he<z.times.length;++he){const ye=z.times[he]*_;if(!(ye<c||ye>=p)){ae.push(z.times[he]);for(let Me=0;Me<Q;++Me)ie.push(z.values[he*Q+Me])}}0!==ae.length&&(z.times=Oe.convertArray(ae,z.times.constructor),z.values=Oe.convertArray(ie,z.values.constructor),L.push(z))}w.tracks=L;let O=1/0;for(let D=0;D<w.tracks.length;++D)O>w.tracks[D].times[0]&&(O=w.tracks[D].times[0]);for(let D=0;D<w.tracks.length;++D)w.tracks[D].shift(-1*O);return w.resetDuration(),w},makeClipAdditive:function(S,e=0,c=S,p=30){p<=0&&(p=30);const _=c.tracks.length,w=e/p;for(let L=0;L<_;++L){const O=c.tracks[L],D=O.ValueTypeName;if("bool"===D||"string"===D)continue;const z=S.tracks.find(function($e){return $e.name===O.name&&$e.ValueTypeName===D});if(void 0===z)continue;let Q=0;const ae=O.getValueSize();O.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(Q=ae/3);let ie=0;const he=z.getValueSize();z.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(ie=he/3);const ye=O.times.length-1;let Me;if(w<=O.times[0])Me=Oe.arraySlice(O.values,Q,ae-Q);else if(w>=O.times[ye]){const $e=ye*ae+Q;Me=Oe.arraySlice(O.values,$e,$e+ae-Q)}else{const $e=O.createInterpolant(),ze=Q,Ye=ae-Q;$e.evaluate(w),Me=Oe.arraySlice($e.resultBuffer,ze,Ye)}"quaternion"===D&&(new Li).fromArray(Me).normalize().conjugate().toArray(Me);const Ne=z.times.length;for(let $e=0;$e<Ne;++$e){const ze=$e*he+ie;if("quaternion"===D)Li.multiplyQuaternionsFlat(z.values,ze,Me,0,z.values,ze);else{const Ye=he-2*ie;for(let We=0;We<Ye;++We)z.values[ze+We]-=Me[We]}}}return S.blendMode=Yu,S}};class Ge{constructor(e,c,p,_){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==_?_:new c.constructor(p),this.sampleValues=c,this.valueSize=p,this.settings=null,this.DefaultSettings_={}}evaluate(e){const c=this.parameterPositions;let p=this._cachedIndex,_=c[p],w=c[p-1];e:{t:{let L;n:{r:if(!(e<_)){for(let O=p+2;;){if(void 0===_){if(e<w)break r;return p=c.length,this._cachedIndex=p,this.afterEnd_(p-1,e,w)}if(p===O)break;if(w=_,_=c[++p],e<_)break t}L=c.length;break n}if(e>=w)break e;{const O=c[1];e<O&&(p=2,w=O);for(let D=p-2;;){if(void 0===w)return this._cachedIndex=0,this.beforeStart_(0,e,_);if(p===D)break;if(_=w,w=c[--p-1],e>=w)break t}L=p,p=0}}for(;p<L;){const O=p+L>>>1;e<c[O]?L=O:p=O+1}if(_=c[p],w=c[p-1],void 0===w)return this._cachedIndex=0,this.beforeStart_(0,e,_);if(void 0===_)return p=c.length,this._cachedIndex=p,this.afterEnd_(p-1,w,e)}this._cachedIndex=p,this.intervalChanged_(p,w,_)}return this.interpolate_(p,w,e,_)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const c=this.resultBuffer,p=this.sampleValues,_=this.valueSize,w=e*_;for(let L=0;L!==_;++L)c[L]=p[w+L];return c}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}Ge.prototype.beforeStart_=Ge.prototype.copySampleValue_,Ge.prototype.afterEnd_=Ge.prototype.copySampleValue_;class ke extends Ge{constructor(e,c,p,_){super(e,c,p,_),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:va,endingEnd:va}}intervalChanged_(e,c,p){const _=this.parameterPositions;let w=e-2,L=e+1,O=_[w],D=_[L];if(void 0===O)switch(this.getSettings_().endingStart){case ta:w=e,O=2*c-p;break;case xl:w=_.length-2,O=c+_[w]-_[w+1];break;default:w=e,O=p}if(void 0===D)switch(this.getSettings_().endingEnd){case ta:L=e,D=2*p-c;break;case xl:L=1,D=p+_[1]-_[0];break;default:L=e-1,D=c}const z=.5*(p-c),Q=this.valueSize;this._weightPrev=z/(c-O),this._weightNext=z/(D-p),this._offsetPrev=w*Q,this._offsetNext=L*Q}interpolate_(e,c,p,_){const w=this.resultBuffer,L=this.sampleValues,O=this.valueSize,D=e*O,z=D-O,Q=this._offsetPrev,ae=this._offsetNext,ie=this._weightPrev,he=this._weightNext,ye=(p-c)/(_-c),Me=ye*ye,Ne=Me*ye,$e=-ie*Ne+2*ie*Me-ie*ye,ze=(1+ie)*Ne+(-1.5-2*ie)*Me+(-.5+ie)*ye+1,Ye=(-1-he)*Ne+(1.5+he)*Me+.5*ye,We=he*Ne-he*Me;for(let nt=0;nt!==O;++nt)w[nt]=$e*L[Q+nt]+ze*L[z+nt]+Ye*L[D+nt]+We*L[ae+nt];return w}}class et extends Ge{constructor(e,c,p,_){super(e,c,p,_)}interpolate_(e,c,p,_){const w=this.resultBuffer,L=this.sampleValues,O=this.valueSize,D=e*O,z=D-O,Q=(p-c)/(_-c),ae=1-Q;for(let ie=0;ie!==O;++ie)w[ie]=L[z+ie]*ae+L[D+ie]*Q;return w}}class rt extends Ge{constructor(e,c,p,_){super(e,c,p,_)}interpolate_(e){return this.copySampleValue_(e-1)}}class ut{constructor(e,c,p,_){if(void 0===e)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===c||0===c.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Oe.convertArray(c,this.TimeBufferType),this.values=Oe.convertArray(p,this.ValueBufferType),this.setInterpolation(_||this.DefaultInterpolation)}static toJSON(e){const c=e.constructor;let p;if(c.toJSON!==this.toJSON)p=c.toJSON(e);else{p={name:e.name,times:Oe.convertArray(e.times,Array),values:Oe.convertArray(e.values,Array)};const _=e.getInterpolation();_!==e.DefaultInterpolation&&(p.interpolation=_)}return p.type=e.ValueTypeName,p}InterpolantFactoryMethodDiscrete(e){return new rt(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new et(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new ke(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let c;switch(e){case zl:c=this.InterpolantFactoryMethodDiscrete;break;case jl:c=this.InterpolantFactoryMethodLinear;break;case qu:c=this.InterpolantFactoryMethodSmooth}if(void 0===c){const p="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(p);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",p),this}return this.createInterpolant=c,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return zl;case this.InterpolantFactoryMethodLinear:return jl;case this.InterpolantFactoryMethodSmooth:return qu}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){const c=this.times;for(let p=0,_=c.length;p!==_;++p)c[p]+=e}return this}scale(e){if(1!==e){const c=this.times;for(let p=0,_=c.length;p!==_;++p)c[p]*=e}return this}trim(e,c){const p=this.times,_=p.length;let w=0,L=_-1;for(;w!==_&&p[w]<e;)++w;for(;-1!==L&&p[L]>c;)--L;if(++L,0!==w||L!==_){w>=L&&(L=Math.max(L,1),w=L-1);const O=this.getValueSize();this.times=Oe.arraySlice(p,w,L),this.values=Oe.arraySlice(this.values,w*O,L*O)}return this}validate(){let e=!0;const c=this.getValueSize();c-Math.floor(c)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const p=this.times,_=this.values,w=p.length;0===w&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let L=null;for(let O=0;O!==w;O++){const D=p[O];if("number"==typeof D&&isNaN(D)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,O,D),e=!1;break}if(null!==L&&L>D){console.error("THREE.KeyframeTrack: Out of order keys.",this,O,D,L),e=!1;break}L=D}if(void 0!==_&&Oe.isTypedArray(_))for(let O=0,D=_.length;O!==D;++O){const z=_[O];if(isNaN(z)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,O,z),e=!1;break}}return e}optimize(){const e=Oe.arraySlice(this.times),c=Oe.arraySlice(this.values),p=this.getValueSize(),_=this.getInterpolation()===qu,w=e.length-1;let L=1;for(let O=1;O<w;++O){let D=!1;const z=e[O];if(z!==e[O+1]&&(1!==O||z!==e[0]))if(_)D=!0;else{const Q=O*p,ae=Q-p,ie=Q+p;for(let he=0;he!==p;++he){const ye=c[Q+he];if(ye!==c[ae+he]||ye!==c[ie+he]){D=!0;break}}}if(D){if(O!==L){e[L]=e[O];const Q=O*p,ae=L*p;for(let ie=0;ie!==p;++ie)c[ae+ie]=c[Q+ie]}++L}}if(w>0){e[L]=e[w];for(let O=w*p,D=L*p,z=0;z!==p;++z)c[D+z]=c[O+z];++L}return L!==e.length?(this.times=Oe.arraySlice(e,0,L),this.values=Oe.arraySlice(c,0,L*p)):(this.times=e,this.values=c),this}clone(){const e=Oe.arraySlice(this.times,0),c=Oe.arraySlice(this.values,0),p=new this.constructor(this.name,e,c);return p.createInterpolant=this.createInterpolant,p}}ut.prototype.TimeBufferType=Float32Array,ut.prototype.ValueBufferType=Float32Array,ut.prototype.DefaultInterpolation=jl;class vt extends ut{}vt.prototype.ValueTypeName="bool",vt.prototype.ValueBufferType=Array,vt.prototype.DefaultInterpolation=zl,vt.prototype.InterpolantFactoryMethodLinear=void 0,vt.prototype.InterpolantFactoryMethodSmooth=void 0;class Lt extends ut{}Lt.prototype.ValueTypeName="color";class Kt extends ut{}Kt.prototype.ValueTypeName="number";class zt extends Ge{constructor(e,c,p,_){super(e,c,p,_)}interpolate_(e,c,p,_){const w=this.resultBuffer,L=this.sampleValues,O=this.valueSize,D=(p-c)/(_-c);let z=e*O;for(let Q=z+O;z!==Q;z+=4)Li.slerpFlat(w,0,L,z-O,L,z,D);return w}}class Bt extends ut{InterpolantFactoryMethodLinear(e){return new zt(this.times,this.values,this.getValueSize(),e)}}Bt.prototype.ValueTypeName="quaternion",Bt.prototype.DefaultInterpolation=jl,Bt.prototype.InterpolantFactoryMethodSmooth=void 0;class $t extends ut{}$t.prototype.ValueTypeName="string",$t.prototype.ValueBufferType=Array,$t.prototype.DefaultInterpolation=zl,$t.prototype.InterpolantFactoryMethodLinear=void 0,$t.prototype.InterpolantFactoryMethodSmooth=void 0;class ht extends ut{}ht.prototype.ValueTypeName="vector";class Tt{constructor(e,c=-1,p,_=Xu){this.name=e,this.tracks=p,this.duration=c,this.blendMode=_,this.uuid=Ki(),this.duration<0&&this.resetDuration()}static parse(e){const c=[],p=e.tracks,_=1/(e.fps||1);for(let L=0,O=p.length;L!==O;++L)c.push(Zt(p[L]).scale(_));const w=new this(e.name,e.duration,c,e.blendMode);return w.uuid=e.uuid,w}static toJSON(e){const c=[],p=e.tracks,_={name:e.name,duration:e.duration,tracks:c,uuid:e.uuid,blendMode:e.blendMode};for(let w=0,L=p.length;w!==L;++w)c.push(ut.toJSON(p[w]));return _}static CreateFromMorphTargetSequence(e,c,p,_){const w=c.length,L=[];for(let O=0;O<w;O++){let D=[],z=[];D.push((O+w-1)%w,O,(O+1)%w),z.push(0,1,0);const Q=Oe.getKeyframeOrder(D);D=Oe.sortedArray(D,1,Q),z=Oe.sortedArray(z,1,Q),_||0!==D[0]||(D.push(w),z.push(z[0])),L.push(new Kt(".morphTargetInfluences["+c[O].name+"]",D,z).scale(1/p))}return new this(e,-1,L)}static findByName(e,c){let p=e;Array.isArray(e)||(p=e.geometry&&e.geometry.animations||e.animations);for(let _=0;_<p.length;_++)if(p[_].name===c)return p[_];return null}static CreateClipsFromMorphTargetSequences(e,c,p){const _={},w=/^([\w-]*?)([\d]+)$/;for(let O=0,D=e.length;O<D;O++){const z=e[O],Q=z.name.match(w);if(Q&&Q.length>1){const ae=Q[1];let ie=_[ae];ie||(_[ae]=ie=[]),ie.push(z)}}const L=[];for(const O in _)L.push(this.CreateFromMorphTargetSequence(O,_[O],c,p));return L}static parseAnimation(e,c){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const p=function(Q,ae,ie,he,ye){if(0!==ie.length){const Me=[],Ne=[];Oe.flattenJSON(ie,Me,Ne,he),0!==Me.length&&ye.push(new Q(ae,Me,Ne))}},_=[],w=e.name||"default",L=e.fps||30,O=e.blendMode;let D=e.length||-1;const z=e.hierarchy||[];for(let Q=0;Q<z.length;Q++){const ae=z[Q].keys;if(ae&&0!==ae.length)if(ae[0].morphTargets){const ie={};let he;for(he=0;he<ae.length;he++)if(ae[he].morphTargets)for(let ye=0;ye<ae[he].morphTargets.length;ye++)ie[ae[he].morphTargets[ye]]=-1;for(const ye in ie){const Me=[],Ne=[];for(let $e=0;$e!==ae[he].morphTargets.length;++$e){const ze=ae[he];Me.push(ze.time),Ne.push(ze.morphTarget===ye?1:0)}_.push(new Kt(".morphTargetInfluence["+ye+"]",Me,Ne))}D=ie.length*(L||1)}else{const ie=".bones["+c[Q].name+"]";p(ht,ie+".position",ae,"pos",_),p(Bt,ie+".quaternion",ae,"rot",_),p(ht,ie+".scale",ae,"scl",_)}}return 0===_.length?null:new this(w,D,_,O)}resetDuration(){let e=0;for(let c=0,p=this.tracks.length;c!==p;++c){const _=this.tracks[c];e=Math.max(e,_.times[_.times.length-1])}return this.duration=e,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let c=0;c<this.tracks.length;c++)e=e&&this.tracks[c].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let c=0;c<this.tracks.length;c++)e.push(this.tracks[c].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Zt(S){if(void 0===S.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=function(c){switch(c.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Kt;case"vector":case"vector2":case"vector3":case"vector4":return ht;case"color":return Lt;case"quaternion":return Bt;case"bool":case"boolean":return vt;case"string":return $t}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+c)}(S.type);if(void 0===S.times){const c=[],p=[];Oe.flattenJSON(S.keys,c,p,"value"),S.times=c,S.values=p}return void 0!==e.parse?e.parse(S):new e(S.name,S.times,S.values,S.interpolation)}const un={enabled:!1,files:{},add:function(S,e){!1!==this.enabled&&(this.files[S]=e)},get:function(S){if(!1!==this.enabled)return this.files[S]},remove:function(S){delete this.files[S]},clear:function(){this.files={}}};class Mn{constructor(e,c,p){const _=this;let w,L=!1,O=0,D=0;const z=[];this.onStart=void 0,this.onLoad=e,this.onProgress=c,this.onError=p,this.itemStart=function(Q){D++,!1===L&&void 0!==_.onStart&&_.onStart(Q,O,D),L=!0},this.itemEnd=function(Q){O++,void 0!==_.onProgress&&_.onProgress(Q,O,D),O===D&&(L=!1,void 0!==_.onLoad&&_.onLoad())},this.itemError=function(Q){void 0!==_.onError&&_.onError(Q)},this.resolveURL=function(Q){return w?w(Q):Q},this.setURLModifier=function(Q){return w=Q,this},this.addHandler=function(Q,ae){return z.push(Q,ae),this},this.removeHandler=function(Q){const ae=z.indexOf(Q);return-1!==ae&&z.splice(ae,2),this},this.getHandler=function(Q){for(let ae=0,ie=z.length;ae<ie;ae+=2){const he=z[ae],ye=z[ae+1];if(he.global&&(he.lastIndex=0),he.test(Q))return ye}return null}}}const wr=new Mn;class Yn{constructor(e){this.manager=void 0!==e?e:wr,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,c){const p=this;return new Promise(function(_,w){p.load(e,_,c,w)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}const On={};class Kn extends Yn{constructor(e){super(e)}load(e,c,p,_){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const w=this,L=un.get(e);if(void 0!==L)return w.manager.itemStart(e),setTimeout(function(){c&&c(L),w.manager.itemEnd(e)},0),L;if(void 0!==On[e])return void On[e].push({onLoad:c,onProgress:p,onError:_});const O=e.match(/^data:(.*?)(;base64)?,(.*)$/);let D;if(O){const z=O[1],Q=!!O[2];let ae=O[3];ae=decodeURIComponent(ae),Q&&(ae=atob(ae));try{let ie;const he=(this.responseType||"").toLowerCase();switch(he){case"arraybuffer":case"blob":const ye=new Uint8Array(ae.length);for(let Ne=0;Ne<ae.length;Ne++)ye[Ne]=ae.charCodeAt(Ne);ie="blob"===he?new Blob([ye.buffer],{type:z}):ye.buffer;break;case"document":ie=(new DOMParser).parseFromString(ae,z);break;case"json":ie=JSON.parse(ae);break;default:ie=ae}setTimeout(function(){c&&c(ie),w.manager.itemEnd(e)},0)}catch(ie){setTimeout(function(){_&&_(ie),w.manager.itemError(e),w.manager.itemEnd(e)},0)}}else{On[e]=[],On[e].push({onLoad:c,onProgress:p,onError:_}),D=new XMLHttpRequest,D.open("GET",e,!0),D.addEventListener("load",function(z){const Q=this.response,ae=On[e];if(delete On[e],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),un.add(e,Q);for(let ie=0,he=ae.length;ie<he;ie++){const ye=ae[ie];ye.onLoad&&ye.onLoad(Q)}w.manager.itemEnd(e)}else{for(let ie=0,he=ae.length;ie<he;ie++){const ye=ae[ie];ye.onError&&ye.onError(z)}w.manager.itemError(e),w.manager.itemEnd(e)}},!1),D.addEventListener("progress",function(z){const Q=On[e];for(let ae=0,ie=Q.length;ae<ie;ae++){const he=Q[ae];he.onProgress&&he.onProgress(z)}},!1),D.addEventListener("error",function(z){const Q=On[e];delete On[e];for(let ae=0,ie=Q.length;ae<ie;ae++){const he=Q[ae];he.onError&&he.onError(z)}w.manager.itemError(e),w.manager.itemEnd(e)},!1),D.addEventListener("abort",function(z){const Q=On[e];delete On[e];for(let ae=0,ie=Q.length;ae<ie;ae++){const he=Q[ae];he.onError&&he.onError(z)}w.manager.itemError(e),w.manager.itemEnd(e)},!1),void 0!==this.responseType&&(D.responseType=this.responseType),void 0!==this.withCredentials&&(D.withCredentials=this.withCredentials),D.overrideMimeType&&D.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain");for(const z in this.requestHeader)D.setRequestHeader(z,this.requestHeader[z]);D.send(null)}return w.manager.itemStart(e),D}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class dr extends Yn{constructor(e){super(e)}load(e,c,p,_){const w=this,L=new Kn(this.manager);L.setPath(this.path),L.setRequestHeader(this.requestHeader),L.setWithCredentials(this.withCredentials),L.load(e,function(O){try{c(w.parse(JSON.parse(O)))}catch(D){_?_(D):console.error(D),w.manager.itemError(e)}},p,_)}parse(e){const c=[];for(let p=0;p<e.length;p++){const _=Tt.parse(e[p]);c.push(_)}return c}}class Mr extends Yn{constructor(e){super(e)}load(e,c,p,_){const w=this,L=[],O=new Ds,D=new Kn(this.manager);D.setPath(this.path),D.setResponseType("arraybuffer"),D.setRequestHeader(this.requestHeader),D.setWithCredentials(w.withCredentials);let z=0;function Q(ae){D.load(e[ae],function(ie){const he=w.parse(ie,!0);L[ae]={width:he.width,height:he.height,format:he.format,mipmaps:he.mipmaps},z+=1,6===z&&(1===he.mipmapCount&&(O.minFilter=ii),O.image=L,O.format=he.format,O.needsUpdate=!0,c&&c(O))},p,_)}if(Array.isArray(e))for(let ae=0,ie=e.length;ae<ie;++ae)Q(ae);else D.load(e,function(ae){const ie=w.parse(ae,!0);if(ie.isCubemap){const he=ie.mipmaps.length/ie.mipmapCount;for(let ye=0;ye<he;ye++){L[ye]={mipmaps:[]};for(let Me=0;Me<ie.mipmapCount;Me++)L[ye].mipmaps.push(ie.mipmaps[ye*ie.mipmapCount+Me]),L[ye].format=ie.format,L[ye].width=ie.width,L[ye].height=ie.height}O.image=L}else O.image.width=ie.width,O.image.height=ie.height,O.mipmaps=ie.mipmaps;1===ie.mipmapCount&&(O.minFilter=ii),O.format=ie.format,O.needsUpdate=!0,c&&c(O)},p,_);return O}}class di extends Yn{constructor(e){super(e)}load(e,c,p,_){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const w=this,L=un.get(e);if(void 0!==L)return w.manager.itemStart(e),setTimeout(function(){c&&c(L),w.manager.itemEnd(e)},0),L;const O=document.createElementNS("http://www.w3.org/1999/xhtml","img");function D(){O.removeEventListener("load",D,!1),O.removeEventListener("error",z,!1),un.add(e,this),c&&c(this),w.manager.itemEnd(e)}function z(Q){O.removeEventListener("load",D,!1),O.removeEventListener("error",z,!1),_&&_(Q),w.manager.itemError(e),w.manager.itemEnd(e)}return O.addEventListener("load",D,!1),O.addEventListener("error",z,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(O.crossOrigin=this.crossOrigin),w.manager.itemStart(e),O.src=e,O}}class so extends Yn{constructor(e){super(e)}load(e,c,p,_){const w=new ql,L=new di(this.manager);L.setCrossOrigin(this.crossOrigin),L.setPath(this.path);let O=0;function D(z){L.load(e[z],function(Q){w.images[z]=Q,O++,6===O&&(w.needsUpdate=!0,c&&c(w))},void 0,_)}for(let z=0;z<e.length;++z)D(z);return w}}class ao extends Yn{constructor(e){super(e)}load(e,c,p,_){const w=this,L=new Fs,O=new Kn(this.manager);return O.setResponseType("arraybuffer"),O.setRequestHeader(this.requestHeader),O.setPath(this.path),O.setWithCredentials(w.withCredentials),O.load(e,function(D){const z=w.parse(D);z&&(void 0!==z.image?L.image=z.image:void 0!==z.data&&(L.image.width=z.width,L.image.height=z.height,L.image.data=z.data),L.wrapS=void 0!==z.wrapS?z.wrapS:Xr,L.wrapT=void 0!==z.wrapT?z.wrapT:Xr,L.magFilter=void 0!==z.magFilter?z.magFilter:ii,L.minFilter=void 0!==z.minFilter?z.minFilter:ii,L.anisotropy=void 0!==z.anisotropy?z.anisotropy:1,void 0!==z.encoding&&(L.encoding=z.encoding),void 0!==z.flipY&&(L.flipY=z.flipY),void 0!==z.format&&(L.format=z.format),void 0!==z.type&&(L.type=z.type),void 0!==z.mipmaps&&(L.mipmaps=z.mipmaps,L.minFilter=Ya),1===z.mipmapCount&&(L.minFilter=ii),void 0!==z.generateMipmaps&&(L.generateMipmaps=z.generateMipmaps),L.needsUpdate=!0,c&&c(L,z))},p,_),L}}class Do extends Yn{constructor(e){super(e)}load(e,c,p,_){const w=new Ms,L=new di(this.manager);return L.setCrossOrigin(this.crossOrigin),L.setPath(this.path),L.load(e,function(O){w.image=O;const D=e.search(/\.jpe?g($|\?)/i)>0||0===e.search(/^data\:image\/jpeg/);w.format=D?Rs:lo,w.needsUpdate=!0,void 0!==c&&c(w)},p,_),w}}class Uo extends pa{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),c=this.curves[this.curves.length-1].getPoint(1);e.equals(c)||this.curves.push(new Js(c,e))}getPoint(e){const c=e*this.getLength(),p=this.getCurveLengths();let _=0;for(;_<p.length;){if(p[_]>=c){const w=p[_]-c,L=this.curves[_],O=L.getLength();return L.getPointAt(0===O?0:1-w/O)}_++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let c=0;for(let p=0,_=this.curves.length;p<_;p++)c+=this.curves[p].getLength(),e.push(c);return this.cacheLengths=e,e}getSpacedPoints(e=40){const c=[];for(let p=0;p<=e;p++)c.push(this.getPoint(p/e));return this.autoClose&&c.push(c[0]),c}getPoints(e=12){const c=[];let p;for(let _=0,w=this.curves;_<w.length;_++){const L=w[_],D=L.getPoints(L&&L.isEllipseCurve?2*e:L&&(L.isLineCurve||L.isLineCurve3)?1:L&&L.isSplineCurve?e*L.points.length:e);for(let z=0;z<D.length;z++){const Q=D[z];p&&p.equals(Q)||(c.push(Q),p=Q)}}return this.autoClose&&c.length>1&&!c[c.length-1].equals(c[0])&&c.push(c[0]),c}copy(e){super.copy(e),this.curves=[];for(let c=0,p=e.curves.length;c<p;c++)this.curves.push(e.curves[c].clone());return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let c=0,p=this.curves.length;c<p;c++)e.curves.push(this.curves[c].toJSON());return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let c=0,p=e.curves.length;c<p;c++){const _=e.curves[c];this.curves.push((new po[_.type]).fromJSON(_))}return this}}class hs extends Uo{constructor(e){super(),this.type="Path",this.currentPoint=new Un,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let c=1,p=e.length;c<p;c++)this.lineTo(e[c].x,e[c].y);return this}moveTo(e,c){return this.currentPoint.set(e,c),this}lineTo(e,c){const p=new Js(this.currentPoint.clone(),new Un(e,c));return this.curves.push(p),this.currentPoint.set(e,c),this}quadraticCurveTo(e,c,p,_){const w=new qi(this.currentPoint.clone(),new Un(e,c),new Un(p,_));return this.curves.push(w),this.currentPoint.set(p,_),this}bezierCurveTo(e,c,p,_,w,L){const O=new ap(this.currentPoint.clone(),new Un(e,c),new Un(p,_),new Un(w,L));return this.curves.push(O),this.currentPoint.set(w,L),this}splineThru(e){const c=[this.currentPoint.clone()].concat(e),p=new pl(c);return this.curves.push(p),this.currentPoint.copy(e[e.length-1]),this}arc(e,c,p,_,w,L){return this.absarc(e+this.currentPoint.x,c+this.currentPoint.y,p,_,w,L),this}absarc(e,c,p,_,w,L){return this.absellipse(e,c,p,p,_,w,L),this}ellipse(e,c,p,_,w,L,O,D){return this.absellipse(e+this.currentPoint.x,c+this.currentPoint.y,p,_,w,L,O,D),this}absellipse(e,c,p,_,w,L,O,D){const z=new Lc(e,c,p,_,w,L,O,D);if(this.curves.length>0){const ae=z.getPoint(0);ae.equals(this.currentPoint)||this.lineTo(ae.x,ae.y)}this.curves.push(z);const Q=z.getPoint(1);return this.currentPoint.copy(Q),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class is extends hs{constructor(e){super(e),this.uuid=Ki(),this.type="Shape",this.holes=[]}getPointsHoles(e){const c=[];for(let p=0,_=this.holes.length;p<_;p++)c[p]=this.holes[p].getPoints(e);return c}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let c=0,p=e.holes.length;c<p;c++)this.holes.push(e.holes[c].clone());return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let c=0,p=this.holes.length;c<p;c++)e.holes.push(this.holes[c].toJSON());return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let c=0,p=e.holes.length;c<p;c++){const _=e.holes[c];this.holes.push((new hs).fromJSON(_))}return this}}class Bo extends Ir{constructor(e,c=1){super(),this.type="Light",this.color=new tr(e),this.intensity=c}dispose(){}copy(e){return super.copy(e),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const c=super.toJSON(e);return c.object.color=this.color.getHex(),c.object.intensity=this.intensity,void 0!==this.groundColor&&(c.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(c.object.distance=this.distance),void 0!==this.angle&&(c.object.angle=this.angle),void 0!==this.decay&&(c.object.decay=this.decay),void 0!==this.penumbra&&(c.object.penumbra=this.penumbra),void 0!==this.shadow&&(c.object.shadow=this.shadow.toJSON()),c}}Bo.prototype.isLight=!0;class qa extends Bo{constructor(e,c,p){super(e,p),this.type="HemisphereLight",this.position.copy(Ir.DefaultUp),this.updateMatrix(),this.groundColor=new tr(c)}copy(e){return Bo.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}qa.prototype.isHemisphereLight=!0;const Ou=new Qt,qp=new lt,cd=new lt;class Dh{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Un(512,512),this.map=null,this.mapPass=null,this.matrix=new Qt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Dr,this._frameExtents=new Un(1,1),this._viewportCount=1,this._viewports=[new Hi(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const c=this.camera,p=this.matrix;qp.setFromMatrixPosition(e.matrixWorld),c.position.copy(qp),cd.setFromMatrixPosition(e.target.matrixWorld),c.lookAt(cd),c.updateMatrixWorld(),Ou.multiplyMatrices(c.projectionMatrix,c.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Ou),p.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),p.multiply(c.projectionMatrix),p.multiply(c.matrixWorldInverse)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class ud extends Dh{constructor(){super(new Io(50,1,.5,500)),this.focus=1}updateMatrices(e){const c=this.camera,p=2*as*e.angle*this.focus,_=this.mapSize.width/this.mapSize.height,w=e.distance||c.far;p===c.fov&&_===c.aspect&&w===c.far||(c.fov=p,c.aspect=_,c.far=w,c.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}ud.prototype.isSpotLightShadow=!0;class hd extends Bo{constructor(e,c,p=0,_=Math.PI/3,w=0,L=1){super(e,c),this.type="SpotLight",this.position.copy(Ir.DefaultUp),this.updateMatrix(),this.target=new Ir,this.distance=p,this.angle=_,this.penumbra=w,this.decay=L,this.shadow=new ud}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}hd.prototype.isSpotLight=!0;const au=new Qt,lu=new lt,nc=new lt;class cu extends Dh{constructor(){super(new Io(90,1,.5,500)),this._frameExtents=new Un(4,2),this._viewportCount=6,this._viewports=[new Hi(2,1,1,1),new Hi(0,1,1,1),new Hi(3,1,1,1),new Hi(1,1,1,1),new Hi(3,0,1,1),new Hi(1,0,1,1)],this._cubeDirections=[new lt(1,0,0),new lt(-1,0,0),new lt(0,0,1),new lt(0,0,-1),new lt(0,1,0),new lt(0,-1,0)],this._cubeUps=[new lt(0,1,0),new lt(0,1,0),new lt(0,1,0),new lt(0,1,0),new lt(0,0,1),new lt(0,0,-1)]}updateMatrices(e,c=0){const p=this.camera,_=this.matrix,w=e.distance||p.far;w!==p.far&&(p.far=w,p.updateProjectionMatrix()),lu.setFromMatrixPosition(e.matrixWorld),p.position.copy(lu),nc.copy(p.position),nc.add(this._cubeDirections[c]),p.up.copy(this._cubeUps[c]),p.lookAt(nc),p.updateMatrixWorld(),_.makeTranslation(-lu.x,-lu.y,-lu.z),au.multiplyMatrices(p.projectionMatrix,p.matrixWorldInverse),this._frustum.setFromProjectionMatrix(au)}}cu.prototype.isPointLightShadow=!0;class Bd extends Bo{constructor(e,c,p=0,_=1){super(e,c),this.type="PointLight",this.distance=p,this.decay=_,this.shadow=new cu}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}Bd.prototype.isPointLight=!0;class Nd extends Dh{constructor(){super(new Xl(-5,5,5,-5,.5,500))}}Nd.prototype.isDirectionalLightShadow=!0;class Pf extends Bo{constructor(e,c){super(e,c),this.type="DirectionalLight",this.position.copy(Ir.DefaultUp),this.updateMatrix(),this.target=new Ir,this.shadow=new Nd}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}Pf.prototype.isDirectionalLight=!0;class Rd extends Bo{constructor(e,c){super(e,c),this.type="AmbientLight"}}Rd.prototype.isAmbientLight=!0;class pd extends Bo{constructor(e,c,p=10,_=10){super(e,c),this.type="RectAreaLight",this.width=p,this.height=_}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const c=super.toJSON(e);return c.object.width=this.width,c.object.height=this.height,c}}pd.prototype.isRectAreaLight=!0;class pm{constructor(){this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new lt)}set(e){for(let c=0;c<9;c++)this.coefficients[c].copy(e[c]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,c){const p=e.x,_=e.y,w=e.z,L=this.coefficients;return c.copy(L[0]).multiplyScalar(.282095),c.addScaledVector(L[1],.488603*_),c.addScaledVector(L[2],.488603*w),c.addScaledVector(L[3],.488603*p),c.addScaledVector(L[4],p*_*1.092548),c.addScaledVector(L[5],_*w*1.092548),c.addScaledVector(L[6],.315392*(3*w*w-1)),c.addScaledVector(L[7],p*w*1.092548),c.addScaledVector(L[8],.546274*(p*p-_*_)),c}getIrradianceAt(e,c){const p=e.x,_=e.y,w=e.z,L=this.coefficients;return c.copy(L[0]).multiplyScalar(.886227),c.addScaledVector(L[1],1.023328*_),c.addScaledVector(L[2],1.023328*w),c.addScaledVector(L[3],1.023328*p),c.addScaledVector(L[4],.858086*p*_),c.addScaledVector(L[5],.858086*_*w),c.addScaledVector(L[6],.743125*w*w-.247708),c.addScaledVector(L[7],.858086*p*w),c.addScaledVector(L[8],.429043*(p*p-_*_)),c}add(e){for(let c=0;c<9;c++)this.coefficients[c].add(e.coefficients[c]);return this}addScaledSH(e,c){for(let p=0;p<9;p++)this.coefficients[p].addScaledVector(e.coefficients[p],c);return this}scale(e){for(let c=0;c<9;c++)this.coefficients[c].multiplyScalar(e);return this}lerp(e,c){for(let p=0;p<9;p++)this.coefficients[p].lerp(e.coefficients[p],c);return this}equals(e){for(let c=0;c<9;c++)if(!this.coefficients[c].equals(e.coefficients[c]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(e,c=0){const p=this.coefficients;for(let _=0;_<9;_++)p[_].fromArray(e,c+3*_);return this}toArray(e=[],c=0){const p=this.coefficients;for(let _=0;_<9;_++)p[_].toArray(e,c+3*_);return e}static getBasisAt(e,c){const p=e.x,_=e.y,w=e.z;c[0]=.282095,c[1]=.488603*_,c[2]=.488603*w,c[3]=.488603*p,c[4]=1.092548*p*_,c[5]=1.092548*_*w,c[6]=.315392*(3*w*w-1),c[7]=1.092548*p*w,c[8]=.546274*(p*p-_*_)}}pm.prototype.isSphericalHarmonics3=!0;class If extends Bo{constructor(e=new pm,c=1){super(void 0,c),this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const c=super.toJSON(e);return c.object.sh=this.sh.toArray(),c}}If.prototype.isLightProbe=!0;class Pd extends Yn{constructor(e){super(e),this.textures={}}load(e,c,p,_){const w=this,L=new Kn(w.manager);L.setPath(w.path),L.setRequestHeader(w.requestHeader),L.setWithCredentials(w.withCredentials),L.load(e,function(O){try{c(w.parse(JSON.parse(O)))}catch(D){_?_(D):console.error(D),w.manager.itemError(e)}},p,_)}parse(e){const c=this.textures;function p(w){return void 0===c[w]&&console.warn("THREE.MaterialLoader: Undefined texture",w),c[w]}const _=new Re[e.type];if(void 0!==e.uuid&&(_.uuid=e.uuid),void 0!==e.name&&(_.name=e.name),void 0!==e.color&&void 0!==_.color&&_.color.setHex(e.color),void 0!==e.roughness&&(_.roughness=e.roughness),void 0!==e.metalness&&(_.metalness=e.metalness),void 0!==e.sheenTint&&(_.sheenTint=(new tr).setHex(e.sheenTint)),void 0!==e.emissive&&void 0!==_.emissive&&_.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==_.specular&&_.specular.setHex(e.specular),void 0!==e.specularIntensity&&(_.specularIntensity=e.specularIntensity),void 0!==e.specularTint&&void 0!==_.specularTint&&_.specularTint.setHex(e.specularTint),void 0!==e.shininess&&(_.shininess=e.shininess),void 0!==e.clearcoat&&(_.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(_.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.transmission&&(_.transmission=e.transmission),void 0!==e.thickness&&(_.thickness=e.thickness),void 0!==e.attenuationDistance&&(_.attenuationDistance=e.attenuationDistance),void 0!==e.attenuationTint&&void 0!==_.attenuationTint&&_.attenuationTint.setHex(e.attenuationTint),void 0!==e.fog&&(_.fog=e.fog),void 0!==e.flatShading&&(_.flatShading=e.flatShading),void 0!==e.blending&&(_.blending=e.blending),void 0!==e.combine&&(_.combine=e.combine),void 0!==e.side&&(_.side=e.side),void 0!==e.shadowSide&&(_.shadowSide=e.shadowSide),void 0!==e.opacity&&(_.opacity=e.opacity),void 0!==e.format&&(_.format=e.format),void 0!==e.transparent&&(_.transparent=e.transparent),void 0!==e.alphaTest&&(_.alphaTest=e.alphaTest),void 0!==e.depthTest&&(_.depthTest=e.depthTest),void 0!==e.depthWrite&&(_.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(_.colorWrite=e.colorWrite),void 0!==e.stencilWrite&&(_.stencilWrite=e.stencilWrite),void 0!==e.stencilWriteMask&&(_.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(_.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(_.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(_.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(_.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(_.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(_.stencilZPass=e.stencilZPass),void 0!==e.wireframe&&(_.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(_.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(_.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(_.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(_.rotation=e.rotation),1!==e.linewidth&&(_.linewidth=e.linewidth),void 0!==e.dashSize&&(_.dashSize=e.dashSize),void 0!==e.gapSize&&(_.gapSize=e.gapSize),void 0!==e.scale&&(_.scale=e.scale),void 0!==e.polygonOffset&&(_.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(_.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(_.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.dithering&&(_.dithering=e.dithering),void 0!==e.alphaToCoverage&&(_.alphaToCoverage=e.alphaToCoverage),void 0!==e.premultipliedAlpha&&(_.premultipliedAlpha=e.premultipliedAlpha),void 0!==e.visible&&(_.visible=e.visible),void 0!==e.toneMapped&&(_.toneMapped=e.toneMapped),void 0!==e.userData&&(_.userData=e.userData),void 0!==e.vertexColors&&(_.vertexColors="number"==typeof e.vertexColors?e.vertexColors>0:e.vertexColors),void 0!==e.uniforms)for(const w in e.uniforms){const L=e.uniforms[w];switch(_.uniforms[w]={},L.type){case"t":_.uniforms[w].value=p(L.value);break;case"c":_.uniforms[w].value=(new tr).setHex(L.value);break;case"v2":_.uniforms[w].value=(new Un).fromArray(L.value);break;case"v3":_.uniforms[w].value=(new lt).fromArray(L.value);break;case"v4":_.uniforms[w].value=(new Hi).fromArray(L.value);break;case"m3":_.uniforms[w].value=(new ot).fromArray(L.value);break;case"m4":_.uniforms[w].value=(new Qt).fromArray(L.value);break;default:_.uniforms[w].value=L.value}}if(void 0!==e.defines&&(_.defines=e.defines),void 0!==e.vertexShader&&(_.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(_.fragmentShader=e.fragmentShader),void 0!==e.extensions)for(const w in e.extensions)_.extensions[w]=e.extensions[w];if(void 0!==e.shading&&(_.flatShading=1===e.shading),void 0!==e.size&&(_.size=e.size),void 0!==e.sizeAttenuation&&(_.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(_.map=p(e.map)),void 0!==e.matcap&&(_.matcap=p(e.matcap)),void 0!==e.alphaMap&&(_.alphaMap=p(e.alphaMap)),void 0!==e.bumpMap&&(_.bumpMap=p(e.bumpMap)),void 0!==e.bumpScale&&(_.bumpScale=e.bumpScale),void 0!==e.normalMap&&(_.normalMap=p(e.normalMap)),void 0!==e.normalMapType&&(_.normalMapType=e.normalMapType),void 0!==e.normalScale){let w=e.normalScale;!1===Array.isArray(w)&&(w=[w,w]),_.normalScale=(new Un).fromArray(w)}return void 0!==e.displacementMap&&(_.displacementMap=p(e.displacementMap)),void 0!==e.displacementScale&&(_.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(_.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(_.roughnessMap=p(e.roughnessMap)),void 0!==e.metalnessMap&&(_.metalnessMap=p(e.metalnessMap)),void 0!==e.emissiveMap&&(_.emissiveMap=p(e.emissiveMap)),void 0!==e.emissiveIntensity&&(_.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(_.specularMap=p(e.specularMap)),void 0!==e.specularIntensityMap&&(_.specularIntensityMap=p(e.specularIntensityMap)),void 0!==e.specularTintMap&&(_.specularTintMap=p(e.specularTintMap)),void 0!==e.envMap&&(_.envMap=p(e.envMap)),void 0!==e.envMapIntensity&&(_.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(_.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(_.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(_.lightMap=p(e.lightMap)),void 0!==e.lightMapIntensity&&(_.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(_.aoMap=p(e.aoMap)),void 0!==e.aoMapIntensity&&(_.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(_.gradientMap=p(e.gradientMap)),void 0!==e.clearcoatMap&&(_.clearcoatMap=p(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(_.clearcoatRoughnessMap=p(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(_.clearcoatNormalMap=p(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(_.clearcoatNormalScale=(new Un).fromArray(e.clearcoatNormalScale)),void 0!==e.transmissionMap&&(_.transmissionMap=p(e.transmissionMap)),void 0!==e.thicknessMap&&(_.thicknessMap=p(e.thicknessMap)),_}setTextures(e){return this.textures=e,this}}class gf{static decodeText(e){if(typeof TextDecoder<"u")return(new TextDecoder).decode(e);let c="";for(let p=0,_=e.length;p<_;p++)c+=String.fromCharCode(e[p]);try{return decodeURIComponent(escape(c))}catch{return c}}static extractUrlBase(e){const c=e.lastIndexOf("/");return-1===c?"./":e.substr(0,c+1)}}class Of extends br{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}clone(){return(new this.constructor).copy(this)}toJSON(){const e=super.toJSON(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}Of.prototype.isInstancedBufferGeometry=!0;class dm extends Yn{constructor(e){super(e)}load(e,c,p,_){const w=this,L=new Kn(w.manager);L.setPath(w.path),L.setRequestHeader(w.requestHeader),L.setWithCredentials(w.withCredentials),L.load(e,function(O){try{c(w.parse(JSON.parse(O)))}catch(D){_?_(D):console.error(D),w.manager.itemError(e)}},p,_)}parse(e){const c={},p={};function _(ae,ie){if(void 0!==c[ie])return c[ie];const he=ae.interleavedBuffers[ie],ye=function($e,ze){if(void 0!==p[ze])return p[ze];const We=new Uint32Array($e.arrayBuffers[ze]).buffer;return p[ze]=We,We}(ae,he.buffer),Me=Fa(he.type,ye),Ne=new Nh(Me,he.stride);return Ne.uuid=he.uuid,c[ie]=Ne,Ne}const w=e.isInstancedBufferGeometry?new Of:new br,L=e.data.index;if(void 0!==L){const ae=Fa(L.type,L.array);w.setIndex(new zi(ae,1))}const O=e.data.attributes;for(const ae in O){const ie=O[ae];let he;if(ie.isInterleavedBufferAttribute){const ye=_(e.data,ie.data);he=new Rl(ye,ie.itemSize,ie.offset,ie.normalized)}else{const ye=Fa(ie.type,ie.array);he=new(ie.isInstancedBufferAttribute?Pl:zi)(ye,ie.itemSize,ie.normalized)}void 0!==ie.name&&(he.name=ie.name),void 0!==ie.usage&&he.setUsage(ie.usage),void 0!==ie.updateRange&&(he.updateRange.offset=ie.updateRange.offset,he.updateRange.count=ie.updateRange.count),w.setAttribute(ae,he)}const D=e.data.morphAttributes;if(D)for(const ae in D){const ie=D[ae],he=[];for(let ye=0,Me=ie.length;ye<Me;ye++){const Ne=ie[ye];let $e;if(Ne.isInterleavedBufferAttribute){const ze=_(e.data,Ne.data);$e=new Rl(ze,Ne.itemSize,Ne.offset,Ne.normalized)}else{const ze=Fa(Ne.type,Ne.array);$e=new zi(ze,Ne.itemSize,Ne.normalized)}void 0!==Ne.name&&($e.name=Ne.name),he.push($e)}w.morphAttributes[ae]=he}e.data.morphTargetsRelative&&(w.morphTargetsRelative=!0);const z=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==z)for(let ae=0,ie=z.length;ae!==ie;++ae){const he=z[ae];w.addGroup(he.start,he.count,he.materialIndex)}const Q=e.data.boundingSphere;if(void 0!==Q){const ae=new lt;void 0!==Q.center&&ae.fromArray(Q.center),w.boundingSphere=new xo(ae,Q.radius)}return e.name&&(w.name=e.name),e.userData&&(w.userData=e.userData),w}}class Um extends Yn{constructor(e){super(e)}load(e,c,p,_){const w=this,L=""===this.path?gf.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||L;const O=new Kn(this.manager);O.setPath(this.path),O.setRequestHeader(this.requestHeader),O.setWithCredentials(this.withCredentials),O.load(e,function(D){let z=null;try{z=JSON.parse(D)}catch(ae){return void 0!==_&&_(ae),void console.error("THREE:ObjectLoader: Can't parse "+e+".",ae.message)}const Q=z.metadata;void 0!==Q&&void 0!==Q.type&&"geometry"!==Q.type.toLowerCase()?w.parse(z,c):console.error("THREE.ObjectLoader: Can't load "+e)},p,_)}async loadAsync(e,c){const p=""===this.path?gf.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||p;const _=new Kn(this.manager);_.setPath(this.path),_.setRequestHeader(this.requestHeader),_.setWithCredentials(this.withCredentials);const w=await _.loadAsync(e,c),L=JSON.parse(w),O=L.metadata;if(void 0===O||void 0===O.type||"geometry"===O.type.toLowerCase())throw new Error("THREE.ObjectLoader: Can't load "+e);return await this.parseAsync(L)}parse(e,c){const p=this.parseAnimations(e.animations),_=this.parseShapes(e.shapes),w=this.parseGeometries(e.geometries,_),L=this.parseImages(e.images,function(){void 0!==c&&c(z)}),O=this.parseTextures(e.textures,L),D=this.parseMaterials(e.materials,O),z=this.parseObject(e.object,w,D,O,p),Q=this.parseSkeletons(e.skeletons,z);if(this.bindSkeletons(z,Q),void 0!==c){let ae=!1;for(const ie in L)if(L[ie]instanceof HTMLImageElement){ae=!0;break}!1===ae&&c(z)}return z}async parseAsync(e){const c=this.parseAnimations(e.animations),p=this.parseShapes(e.shapes),_=this.parseGeometries(e.geometries,p),w=await this.parseImagesAsync(e.images),L=this.parseTextures(e.textures,w),O=this.parseMaterials(e.materials,L),D=this.parseObject(e.object,_,O,L,c),z=this.parseSkeletons(e.skeletons,D);return this.bindSkeletons(D,z),D}parseShapes(e){const c={};if(void 0!==e)for(let p=0,_=e.length;p<_;p++){const w=(new is).fromJSON(e[p]);c[w.uuid]=w}return c}parseSkeletons(e,c){const p={},_={};if(c.traverse(function(w){w.isBone&&(_[w.uuid]=w)}),void 0!==e)for(let w=0,L=e.length;w<L;w++){const O=(new Va).fromJSON(e[w],_);p[O.uuid]=O}return p}parseGeometries(e,c){const p={};if(void 0!==e){const _=new dm;for(let w=0,L=e.length;w<L;w++){let O;const D=e[w];switch(D.type){case"BufferGeometry":case"InstancedBufferGeometry":O=_.parse(D);break;case"Geometry":console.error("THREE.ObjectLoader: The legacy Geometry type is no longer supported.");break;default:D.type in M?O=M[D.type].fromJSON(D,c):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${D.type}"`)}O.uuid=D.uuid,void 0!==D.name&&(O.name=D.name),!0===O.isBufferGeometry&&void 0!==D.userData&&(O.userData=D.userData),p[D.uuid]=O}}return p}parseMaterials(e,c){const p={},_={};if(void 0!==e){const w=new Pd;w.setTextures(c);for(let L=0,O=e.length;L<O;L++){const D=e[L];if("MultiMaterial"===D.type){const z=[];for(let Q=0;Q<D.materials.length;Q++){const ae=D.materials[Q];void 0===p[ae.uuid]&&(p[ae.uuid]=w.parse(ae)),z.push(p[ae.uuid])}_[D.uuid]=z}else void 0===p[D.uuid]&&(p[D.uuid]=w.parse(D)),_[D.uuid]=p[D.uuid]}}return _}parseAnimations(e){const c={};if(void 0!==e)for(let p=0;p<e.length;p++){const w=Tt.parse(e[p]);c[w.uuid]=w}return c}parseImages(e,c){const p=this,_={};let w;function L(O){if("string"==typeof O){const D=O;return z=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(D)?D:p.resourcePath+D,p.manager.itemStart(z),w.load(z,function(){p.manager.itemEnd(z)},void 0,function(){p.manager.itemError(z),p.manager.itemEnd(z)})}var z;return O.data?{data:Fa(O.type,O.data),width:O.width,height:O.height}:null}if(void 0!==e&&e.length>0){const O=new Mn(c);w=new di(O),w.setCrossOrigin(this.crossOrigin);for(let D=0,z=e.length;D<z;D++){const Q=e[D],ae=Q.url;if(Array.isArray(ae)){_[Q.uuid]=[];for(let ie=0,he=ae.length;ie<he;ie++){const ye=L(ae[ie]);null!==ye&&(ye instanceof HTMLImageElement?_[Q.uuid].push(ye):_[Q.uuid].push(new Fs(ye.data,ye.width,ye.height)))}}else{const ie=L(Q.url);null!==ie&&(_[Q.uuid]=ie)}}}return _}async parseImagesAsync(e){const c=this,p={};let _;async function w(L){if("string"==typeof L){const O=L,D=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(O)?O:c.resourcePath+O;return await _.loadAsync(D)}return L.data?{data:Fa(L.type,L.data),width:L.width,height:L.height}:null}if(void 0!==e&&e.length>0){_=new di(this.manager),_.setCrossOrigin(this.crossOrigin);for(let L=0,O=e.length;L<O;L++){const D=e[L],z=D.url;if(Array.isArray(z)){p[D.uuid]=[];for(let Q=0,ae=z.length;Q<ae;Q++){const ie=z[Q],he=await w(ie);null!==he&&(he instanceof HTMLImageElement?p[D.uuid].push(he):p[D.uuid].push(new Fs(he.data,he.width,he.height)))}}else{const Q=await w(D.url);null!==Q&&(p[D.uuid]=Q)}}}return p}parseTextures(e,c){function p(w,L){return"number"==typeof w?w:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",w),L[w])}const _={};if(void 0!==e)for(let w=0,L=e.length;w<L;w++){const O=e[w];let D;void 0===O.image&&console.warn('THREE.ObjectLoader: No "image" specified for',O.uuid),void 0===c[O.image]&&console.warn("THREE.ObjectLoader: Undefined image",O.image);const z=c[O.image];Array.isArray(z)?(D=new ql(z),6===z.length&&(D.needsUpdate=!0)):(D=z&&z.data?new Fs(z.data,z.width,z.height):new Ms(z),z&&(D.needsUpdate=!0)),D.uuid=O.uuid,void 0!==O.name&&(D.name=O.name),void 0!==O.mapping&&(D.mapping=p(O.mapping,y_)),void 0!==O.offset&&D.offset.fromArray(O.offset),void 0!==O.repeat&&D.repeat.fromArray(O.repeat),void 0!==O.center&&D.center.fromArray(O.center),void 0!==O.rotation&&(D.rotation=O.rotation),void 0!==O.wrap&&(D.wrapS=p(O.wrap[0],fm),D.wrapT=p(O.wrap[1],fm)),void 0!==O.format&&(D.format=O.format),void 0!==O.type&&(D.type=O.type),void 0!==O.encoding&&(D.encoding=O.encoding),void 0!==O.minFilter&&(D.minFilter=p(O.minFilter,t_)),void 0!==O.magFilter&&(D.magFilter=p(O.magFilter,t_)),void 0!==O.anisotropy&&(D.anisotropy=O.anisotropy),void 0!==O.flipY&&(D.flipY=O.flipY),void 0!==O.premultiplyAlpha&&(D.premultiplyAlpha=O.premultiplyAlpha),void 0!==O.unpackAlignment&&(D.unpackAlignment=O.unpackAlignment),_[O.uuid]=D}return _}parseObject(e,c,p,_,w){let L,O,D;function z(ie){return void 0===c[ie]&&console.warn("THREE.ObjectLoader: Undefined geometry",ie),c[ie]}function Q(ie){if(void 0!==ie){if(Array.isArray(ie)){const he=[];for(let ye=0,Me=ie.length;ye<Me;ye++){const Ne=ie[ye];void 0===p[Ne]&&console.warn("THREE.ObjectLoader: Undefined material",Ne),he.push(p[Ne])}return he}return void 0===p[ie]&&console.warn("THREE.ObjectLoader: Undefined material",ie),p[ie]}}function ae(ie){return void 0===_[ie]&&console.warn("THREE.ObjectLoader: Undefined texture",ie),_[ie]}switch(e.type){case"Scene":L=new Qc,void 0!==e.background&&(L.background=Number.isInteger(e.background)?new tr(e.background):ae(e.background)),void 0!==e.environment&&(L.environment=ae(e.environment)),void 0!==e.fog&&("Fog"===e.fog.type?L.fog=new Xo(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(L.fog=new Gp(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":L=new Io(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(L.focus=e.focus),void 0!==e.zoom&&(L.zoom=e.zoom),void 0!==e.filmGauge&&(L.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(L.filmOffset=e.filmOffset),void 0!==e.view&&(L.view=Object.assign({},e.view));break;case"OrthographicCamera":L=new Xl(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(L.zoom=e.zoom),void 0!==e.view&&(L.view=Object.assign({},e.view));break;case"AmbientLight":L=new Rd(e.color,e.intensity);break;case"DirectionalLight":L=new Pf(e.color,e.intensity);break;case"PointLight":L=new Bd(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":L=new pd(e.color,e.intensity,e.width,e.height);break;case"SpotLight":L=new hd(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":L=new qa(e.color,e.groundColor,e.intensity);break;case"LightProbe":L=(new If).fromJSON(e);break;case"SkinnedMesh":O=z(e.geometry),D=Q(e.material),L=new Aa(O,D),void 0!==e.bindMode&&(L.bindMode=e.bindMode),void 0!==e.bindMatrix&&L.bindMatrix.fromArray(e.bindMatrix),void 0!==e.skeleton&&(L.skeleton=e.skeleton);break;case"Mesh":O=z(e.geometry),D=Q(e.material),L=new Po(O,D);break;case"InstancedMesh":O=z(e.geometry),D=Q(e.material);const he=e.instanceMatrix,ye=e.instanceColor;L=new Ph(O,D,e.count),L.instanceMatrix=new Pl(new Float32Array(he.array),16),void 0!==ye&&(L.instanceColor=new Pl(new Float32Array(ye.array),ye.itemSize));break;case"LOD":L=new Ma;break;case"Line":L=new Oo(z(e.geometry),Q(e.material));break;case"LineLoop":L=new tf(z(e.geometry),Q(e.material));break;case"LineSegments":L=new Fo(z(e.geometry),Q(e.material));break;case"PointCloud":case"Points":L=new Qr(z(e.geometry),Q(e.material));break;case"Sprite":L=new Ql(Q(e.material));break;case"Group":L=new jp;break;case"Bone":L=new ks;break;default:L=new Ir}if(L.uuid=e.uuid,void 0!==e.name&&(L.name=e.name),void 0!==e.matrix?(L.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(L.matrixAutoUpdate=e.matrixAutoUpdate),L.matrixAutoUpdate&&L.matrix.decompose(L.position,L.quaternion,L.scale)):(void 0!==e.position&&L.position.fromArray(e.position),void 0!==e.rotation&&L.rotation.fromArray(e.rotation),void 0!==e.quaternion&&L.quaternion.fromArray(e.quaternion),void 0!==e.scale&&L.scale.fromArray(e.scale)),void 0!==e.castShadow&&(L.castShadow=e.castShadow),void 0!==e.receiveShadow&&(L.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(L.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(L.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(L.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&L.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(L.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(L.visible=e.visible),void 0!==e.frustumCulled&&(L.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(L.renderOrder=e.renderOrder),void 0!==e.userData&&(L.userData=e.userData),void 0!==e.layers&&(L.layers.mask=e.layers),void 0!==e.children){const ie=e.children;for(let he=0;he<ie.length;he++)L.add(this.parseObject(ie[he],c,p,_,w))}if(void 0!==e.animations){const ie=e.animations;for(let he=0;he<ie.length;he++)L.animations.push(w[ie[he]])}if("LOD"===e.type){void 0!==e.autoUpdate&&(L.autoUpdate=e.autoUpdate);const ie=e.levels;for(let he=0;he<ie.length;he++){const ye=ie[he],Me=L.getObjectByProperty("uuid",ye.object);void 0!==Me&&L.addLevel(Me,ye.distance)}}return L}bindSkeletons(e,c){0!==Object.keys(c).length&&e.traverse(function(p){if(!0===p.isSkinnedMesh&&void 0!==p.skeleton){const _=c[p.skeleton];void 0===_?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",p.skeleton):p.bind(_,p.bindMatrix)}})}setTexturePath(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}const y_={UVMapping:fi,CubeReflectionMapping:bi,CubeRefractionMapping:So,EquirectangularReflectionMapping:Gs,EquirectangularRefractionMapping:Ks,CubeUVReflectionMapping:Di,CubeUVRefractionMapping:Eo},fm={RepeatWrapping:vo,ClampToEdgeWrapping:Xr,MirroredRepeatWrapping:ss},t_={NearestFilter:Or,NearestMipmapNearestFilter:Na,NearestMipmapLinearFilter:ps,LinearFilter:ii,LinearMipmapNearestFilter:Pc,LinearMipmapLinearFilter:Ya};class n_ extends Yn{constructor(e){super(e),typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,c,p,_){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);const w=this,L=un.get(e);if(void 0!==L)return w.manager.itemStart(e),setTimeout(function(){c&&c(L),w.manager.itemEnd(e)},0),L;const O={};O.credentials="anonymous"===this.crossOrigin?"same-origin":"include",O.headers=this.requestHeader,fetch(e,O).then(function(D){return D.blob()}).then(function(D){return createImageBitmap(D,Object.assign(w.options,{colorSpaceConversion:"none"}))}).then(function(D){un.add(e,D),c&&c(D),w.manager.itemEnd(e)}).catch(function(D){_&&_(D),w.manager.itemError(e),w.manager.itemEnd(e)}),w.manager.itemStart(e)}}n_.prototype.isImageBitmapLoader=!0;class r_{constructor(){this.type="ShapePath",this.color=new tr,this.subPaths=[],this.currentPath=null}moveTo(e,c){return this.currentPath=new hs,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,c),this}lineTo(e,c){return this.currentPath.lineTo(e,c),this}quadraticCurveTo(e,c,p,_){return this.currentPath.quadraticCurveTo(e,c,p,_),this}bezierCurveTo(e,c,p,_,w,L){return this.currentPath.bezierCurveTo(e,c,p,_,w,L),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e,c){function p(ze){const Ye=[];for(let We=0,nt=ze.length;We<nt;We++){const it=ze[We],mt=new is;mt.curves=it.curves,Ye.push(mt)}return Ye}function _(ze,Ye){const We=Ye.length;let nt=!1;for(let it=We-1,mt=0;mt<We;it=mt++){let xt=Ye[it],Dt=Ye[mt],Ht=Dt.x-xt.x,Je=Dt.y-xt.y;if(Math.abs(Je)>Number.EPSILON){if(Je<0&&(xt=Ye[mt],Ht=-Ht,Dt=Ye[it],Je=-Je),ze.y<xt.y||ze.y>Dt.y)continue;if(ze.y===xt.y){if(ze.x===xt.x)return!0}else{const pt=Je*(ze.x-xt.x)-Ht*(ze.y-xt.y);if(0===pt)return!0;if(pt<0)continue;nt=!nt}}else{if(ze.y!==xt.y)continue;if(Dt.x<=ze.x&&ze.x<=xt.x||xt.x<=ze.x&&ze.x<=Dt.x)return!0}}return nt}const w=Ci.isClockWise,L=this.subPaths;if(0===L.length)return[];if(!0===c)return p(L);let O,D,z;const Q=[];if(1===L.length)return D=L[0],z=new is,z.curves=D.curves,Q.push(z),Q;let ae=!w(L[0].getPoints());ae=e?!ae:ae;const ie=[],he=[];let ye,Me,Ne=[],$e=0;he[$e]=void 0,Ne[$e]=[];for(let ze=0,Ye=L.length;ze<Ye;ze++)D=L[ze],ye=D.getPoints(),O=w(ye),O=e?!O:O,O?(!ae&&he[$e]&&$e++,he[$e]={s:new is,p:ye},he[$e].s.curves=D.curves,ae&&$e++,Ne[$e]=[]):Ne[$e].push({h:D,p:ye[0]});if(!he[0])return p(L);if(he.length>1){let ze=!1;const Ye=[];for(let We=0,nt=he.length;We<nt;We++)ie[We]=[];for(let We=0,nt=he.length;We<nt;We++){const it=Ne[We];for(let mt=0;mt<it.length;mt++){const xt=it[mt];let Dt=!0;for(let Ht=0;Ht<he.length;Ht++)_(xt.p,he[Ht].p)&&(We!==Ht&&Ye.push({froms:We,tos:Ht,hole:mt}),Dt?(Dt=!1,ie[Ht].push(xt)):ze=!0);Dt&&ie[We].push(xt)}}Ye.length>0&&(ze||(Ne=ie))}for(let ze=0,Ye=he.length;ze<Ye;ze++){z=he[ze].s,Q.push(z),Me=Ne[ze];for(let We=0,nt=Me.length;We<nt;We++)z.holes.push(Me[We].h)}return Q}}class zm{constructor(e){this.type="Font",this.data=e}generateShapes(e,c=100){const p=[],_=function(w,L,O){const D=Array.from(w),z=L/O.resolution,Q=(O.boundingBox.yMax-O.boundingBox.yMin+O.underlineThickness)*z,ae=[];let ie=0,he=0;for(let ye=0;ye<D.length;ye++){const Me=D[ye];if("\n"===Me)ie=0,he-=Q;else{const Ne=b_(Me,z,ie,he,O);ie+=Ne.offsetX,ae.push(Ne.path)}}return ae}(e,c,this.data);for(let w=0,L=_.length;w<L;w++)Array.prototype.push.apply(p,_[w].toShapes());return p}}function b_(S,e,c,p,_){const w=_.glyphs[S]||_.glyphs["?"];if(!w)return void console.error('THREE.Font: character "'+S+'" does not exists in font family '+_.familyName+".");const L=new r_;let O,D,z,Q,ae,ie,he,ye;if(w.o){const Me=w._cachedOutline||(w._cachedOutline=w.o.split(" "));for(let Ne=0,$e=Me.length;Ne<$e;)switch(Me[Ne++]){case"m":O=Me[Ne++]*e+c,D=Me[Ne++]*e+p,L.moveTo(O,D);break;case"l":O=Me[Ne++]*e+c,D=Me[Ne++]*e+p,L.lineTo(O,D);break;case"q":z=Me[Ne++]*e+c,Q=Me[Ne++]*e+p,ae=Me[Ne++]*e+c,ie=Me[Ne++]*e+p,L.quadraticCurveTo(ae,ie,z,Q);break;case"b":z=Me[Ne++]*e+c,Q=Me[Ne++]*e+p,ae=Me[Ne++]*e+c,ie=Me[Ne++]*e+p,he=Me[Ne++]*e+c,ye=Me[Ne++]*e+p,L.bezierCurveTo(ae,ie,he,ye,z,Q)}}return{offsetX:w.ha*e,path:L}}zm.prototype.isFont=!0;class x_ extends Yn{constructor(e){super(e)}load(e,c,p,_){const w=this,L=new Kn(this.manager);L.setPath(this.path),L.setRequestHeader(this.requestHeader),L.setWithCredentials(w.withCredentials),L.load(e,function(O){let D;try{D=JSON.parse(O)}catch{console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),D=JSON.parse(O.substring(65,O.length-2))}const z=w.parse(D);c&&c(z)},p,_)}parse(e){return new zm(e)}}let mm;const _m={getContext:function(){return void 0===mm&&(mm=new(window.AudioContext||window.webkitAudioContext)),mm},setContext:function(S){mm=S}};class rc extends Yn{constructor(e){super(e)}load(e,c,p,_){const w=this,L=new Kn(this.manager);L.setResponseType("arraybuffer"),L.setPath(this.path),L.setRequestHeader(this.requestHeader),L.setWithCredentials(this.withCredentials),L.load(e,function(O){try{const D=O.slice(0);_m.getContext().decodeAudioData(D,function(z){c(z)})}catch(D){_?_(D):console.error(D),w.manager.itemError(e)}},p,_)}}class jm extends If{constructor(e,c,p=1){super(void 0,p);const _=(new tr).set(e),w=(new tr).set(c),L=new lt(_.r,_.g,_.b),O=new lt(w.r,w.g,w.b),D=Math.sqrt(Math.PI),z=D*Math.sqrt(.75);this.sh.coefficients[0].copy(L).add(O).multiplyScalar(D),this.sh.coefficients[1].copy(L).sub(O).multiplyScalar(z)}}jm.prototype.isHemisphereLightProbe=!0;class Gm extends If{constructor(e,c=1){super(void 0,c);const p=(new tr).set(e);this.sh.coefficients[0].set(p.r,p.g,p.b).multiplyScalar(2*Math.sqrt(Math.PI))}}Gm.prototype.isAmbientLightProbe=!0;const gm=new Qt,kf=new Qt;class Hm{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Io,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Io,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const c=this._cache;if(c.focus!==e.focus||c.fov!==e.fov||c.aspect!==e.aspect*this.aspect||c.near!==e.near||c.far!==e.far||c.zoom!==e.zoom||c.eyeSep!==this.eyeSep){c.focus=e.focus,c.fov=e.fov,c.aspect=e.aspect*this.aspect,c.near=e.near,c.far=e.far,c.zoom=e.zoom,c.eyeSep=this.eyeSep;const p=e.projectionMatrix.clone(),_=c.eyeSep/2,w=_*c.near/c.focus,L=c.near*Math.tan(jo*c.fov*.5)/c.zoom;let O,D;kf.elements[12]=-_,gm.elements[12]=_,O=-L*c.aspect+w,D=L*c.aspect+w,p.elements[0]=2*c.near/(D-O),p.elements[8]=(D+O)/(D-O),this.cameraL.projectionMatrix.copy(p),O=-L*c.aspect-w,D=L*c.aspect-w,p.elements[0]=2*c.near/(D-O),p.elements[8]=(D+O)/(D-O),this.cameraR.projectionMatrix.copy(p)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(kf),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(gm)}}class vm{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=Vm(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const c=Vm();e=(c-this.oldTime)/1e3,this.oldTime=c,this.elapsedTime+=e}return e}}function Vm(){return(typeof performance>"u"?Date:performance).now()}const dd=new lt,i_=new Li,o_=new lt,Id=new lt;class Wm extends Ir{constructor(){super(),this.type="AudioListener",this.context=_m.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new vm}getInput(){return this.gain}removeFilter(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const c=this.context.listener,p=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(dd,i_,o_),Id.set(0,0,-1).applyQuaternion(i_),c.positionX){const _=this.context.currentTime+this.timeDelta;c.positionX.linearRampToValueAtTime(dd.x,_),c.positionY.linearRampToValueAtTime(dd.y,_),c.positionZ.linearRampToValueAtTime(dd.z,_),c.forwardX.linearRampToValueAtTime(Id.x,_),c.forwardY.linearRampToValueAtTime(Id.y,_),c.forwardZ.linearRampToValueAtTime(Id.z,_),c.upX.linearRampToValueAtTime(p.x,_),c.upY.linearRampToValueAtTime(p.y,_),c.upZ.linearRampToValueAtTime(p.z,_)}else c.setPosition(dd.x,dd.y,dd.z),c.setOrientation(Id.x,Id.y,Id.z,p.x,p.y,p.z)}}class ym extends Ir{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+e;const c=this.context.createBufferSource();return c.buffer=this.buffer,c.loop=this.loop,c.loopStart=this.loopStart,c.loopEnd=this.loopEnd,c.onended=this.onEnded.bind(this),c.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=c,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,c=this.filters.length;e<c;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,c=this.filters.length;e<c;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const Xp=new lt,bm=new Li,Ff=new lt,Od=new lt;class vf extends ym{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,c,p){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=c,this.panner.coneOuterGain=p,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(Xp,bm,Ff),Od.set(0,0,1).applyQuaternion(bm);const c=this.panner;if(c.positionX){const p=this.context.currentTime+this.listener.timeDelta;c.positionX.linearRampToValueAtTime(Xp.x,p),c.positionY.linearRampToValueAtTime(Xp.y,p),c.positionZ.linearRampToValueAtTime(Xp.z,p),c.orientationX.linearRampToValueAtTime(Od.x,p),c.orientationY.linearRampToValueAtTime(Od.y,p),c.orientationZ.linearRampToValueAtTime(Od.z,p)}else c.setPosition(Xp.x,Xp.y,Xp.z),c.setOrientation(Od.x,Od.y,Od.z)}}class fd{constructor(e,c=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=c,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const c=this.getFrequencyData();for(let p=0;p<c.length;p++)e+=c[p];return e/c.length}}class Df{constructor(e,c,p){let _,w,L;switch(this.binding=e,this.valueSize=p,c){case"quaternion":_=this._slerp,w=this._slerpAdditive,L=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*p),this._workIndex=5;break;case"string":case"bool":_=this._select,w=this._select,L=this._setAdditiveIdentityOther,this.buffer=new Array(5*p);break;default:_=this._lerp,w=this._lerpAdditive,L=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*p)}this._mixBufferRegion=_,this._mixBufferRegionAdditive=w,this._setIdentity=L,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,c){const p=this.buffer,_=this.valueSize,w=e*_+_;let L=this.cumulativeWeight;if(0===L){for(let O=0;O!==_;++O)p[w+O]=p[O];L=c}else L+=c,this._mixBufferRegion(p,w,0,c/L,_);this.cumulativeWeight=L}accumulateAdditive(e){const c=this.buffer,p=this.valueSize,_=p*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(c,_,0,e,p),this.cumulativeWeightAdditive+=e}apply(e){const c=this.valueSize,p=this.buffer,_=e*c+c,w=this.cumulativeWeight,L=this.cumulativeWeightAdditive,O=this.binding;this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,w<1&&this._mixBufferRegion(p,_,c*this._origIndex,1-w,c),L>0&&this._mixBufferRegionAdditive(p,_,this._addIndex*c,1,c);for(let D=c,z=c+c;D!==z;++D)if(p[D]!==p[D+c]){O.setValue(p,_);break}}saveOriginalState(){const c=this.buffer,p=this.valueSize,_=p*this._origIndex;this.binding.getValue(c,_);for(let w=p,L=_;w!==L;++w)c[w]=c[_+w%p];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){this.binding.setValue(this.buffer,3*this.valueSize)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,c=e+this.valueSize;for(let p=e;p<c;p++)this.buffer[p]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,c=this._addIndex*this.valueSize;for(let p=0;p<this.valueSize;p++)this.buffer[c+p]=this.buffer[e+p]}_select(e,c,p,_,w){if(_>=.5)for(let L=0;L!==w;++L)e[c+L]=e[p+L]}_slerp(e,c,p,_){Li.slerpFlat(e,c,e,c,e,p,_)}_slerpAdditive(e,c,p,_,w){const L=this._workIndex*w;Li.multiplyQuaternionsFlat(e,L,e,c,e,p),Li.slerpFlat(e,c,e,c,e,L,_)}_lerp(e,c,p,_,w){const L=1-_;for(let O=0;O!==w;++O){const D=c+O;e[D]=e[D]*L+e[p+O]*_}}_lerpAdditive(e,c,p,_,w){for(let L=0;L!==w;++L){const O=c+L;e[O]=e[O]+e[p+L]*_}}}const Uf="\\[\\]\\.:\\/",s_=new RegExp("["+Uf+"]","g"),md="[^"+Uf+"]",yf="[^"+Uf.replace("\\.","")+"]",w_=/((?:WC+[\/:])*)/.source.replace("WC",md),a_=/(WCOD+)?/.source.replace("WCOD",yf),l_=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",md),bf=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",md),zf=new RegExp("^"+w_+a_+l_+bf+"$"),xm=["material","materials","bones"];class mo{constructor(e,c,p){this.path=c,this.parsedPath=p||mo.parseTrackName(c),this.node=mo.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,c,p){return e&&e.isAnimationObjectGroup?new mo.Composite(e,c,p):new mo(e,c,p)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(s_,"")}static parseTrackName(e){const c=zf.exec(e);if(!c)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const p={nodeName:c[2],objectName:c[3],objectIndex:c[4],propertyName:c[5],propertyIndex:c[6]},_=p.nodeName&&p.nodeName.lastIndexOf(".");if(void 0!==_&&-1!==_){const w=p.nodeName.substring(_+1);-1!==xm.indexOf(w)&&(p.nodeName=p.nodeName.substring(0,_),p.objectName=w)}if(null===p.propertyName||0===p.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return p}static findNode(e,c){if(!c||""===c||"."===c||-1===c||c===e.name||c===e.uuid)return e;if(e.skeleton){const p=e.skeleton.getBoneByName(c);if(void 0!==p)return p}if(e.children){const p=function(w){for(let L=0;L<w.length;L++){const O=w[L];if(O.name===c||O.uuid===c)return O;const D=p(O.children);if(D)return D}return null},_=p(e.children);if(_)return _}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,c){e[c]=this.targetObject[this.propertyName]}_getValue_array(e,c){const p=this.resolvedProperty;for(let _=0,w=p.length;_!==w;++_)e[c++]=p[_]}_getValue_arrayElement(e,c){e[c]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,c){this.resolvedProperty.toArray(e,c)}_setValue_direct(e,c){this.targetObject[this.propertyName]=e[c]}_setValue_direct_setNeedsUpdate(e,c){this.targetObject[this.propertyName]=e[c],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,c){this.targetObject[this.propertyName]=e[c],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,c){const p=this.resolvedProperty;for(let _=0,w=p.length;_!==w;++_)p[_]=e[c++]}_setValue_array_setNeedsUpdate(e,c){const p=this.resolvedProperty;for(let _=0,w=p.length;_!==w;++_)p[_]=e[c++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,c){const p=this.resolvedProperty;for(let _=0,w=p.length;_!==w;++_)p[_]=e[c++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,c){this.resolvedProperty[this.propertyIndex]=e[c]}_setValue_arrayElement_setNeedsUpdate(e,c){this.resolvedProperty[this.propertyIndex]=e[c],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,c){this.resolvedProperty[this.propertyIndex]=e[c],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,c){this.resolvedProperty.fromArray(e,c)}_setValue_fromArray_setNeedsUpdate(e,c){this.resolvedProperty.fromArray(e,c),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,c){this.resolvedProperty.fromArray(e,c),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,c){this.bind(),this.getValue(e,c)}_setValue_unbound(e,c){this.bind(),this.setValue(e,c)}bind(){let e=this.node;const c=this.parsedPath,p=c.objectName,_=c.propertyName;let w=c.propertyIndex;if(e||(e=mo.findNode(this.rootNode,c.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(p){let z=c.objectIndex;switch(p){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(let Q=0;Q<e.length;Q++)if(e[Q].name===z){z=Q;break}break;default:if(void 0===e[p])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[p]}if(void 0!==z){if(void 0===e[z])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[z]}}const L=e[_];if(void 0===L)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+c.nodeName+"."+_+" but it wasn't found.",e);let O=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?O=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(O=this.Versioning.MatrixWorldNeedsUpdate);let D=this.BindingType.Direct;if(void 0!==w){if("morphTargetInfluences"===_){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[w]&&(w=e.morphTargetDictionary[w])}D=this.BindingType.ArrayElement,this.resolvedProperty=L,this.propertyIndex=w}else void 0!==L.fromArray&&void 0!==L.toArray?(D=this.BindingType.HasFromToArray,this.resolvedProperty=L):Array.isArray(L)?(D=this.BindingType.EntireArray,this.resolvedProperty=L):this.propertyName=_;this.getValue=this.GetterByBindingType[D],this.setValue=this.SetterByBindingTypeAndVersioning[D][O]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}mo.Composite=class{constructor(S,e,c){const p=c||mo.parseTrackName(e);this._targetGroup=S,this._bindings=S.subscribe_(e,p)}getValue(S,e){this.bind();const p=this._bindings[this._targetGroup.nCachedObjects_];void 0!==p&&p.getValue(S,e)}setValue(S,e){const c=this._bindings;for(let p=this._targetGroup.nCachedObjects_,_=c.length;p!==_;++p)c[p].setValue(S,e)}bind(){const S=this._bindings;for(let e=this._targetGroup.nCachedObjects_,c=S.length;e!==c;++e)S[e].bind()}unbind(){const S=this._bindings;for(let e=this._targetGroup.nCachedObjects_,c=S.length;e!==c;++e)S[e].unbind()}},mo.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},mo.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},mo.prototype.GetterByBindingType=[mo.prototype._getValue_direct,mo.prototype._getValue_array,mo.prototype._getValue_arrayElement,mo.prototype._getValue_toArray],mo.prototype.SetterByBindingTypeAndVersioning=[[mo.prototype._setValue_direct,mo.prototype._setValue_direct_setNeedsUpdate,mo.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[mo.prototype._setValue_array,mo.prototype._setValue_array_setNeedsUpdate,mo.prototype._setValue_array_setMatrixWorldNeedsUpdate],[mo.prototype._setValue_arrayElement,mo.prototype._setValue_arrayElement_setNeedsUpdate,mo.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[mo.prototype._setValue_fromArray,mo.prototype._setValue_fromArray_setNeedsUpdate,mo.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class jf{constructor(){this.uuid=Ki(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let p=0,_=arguments.length;p!==_;++p)e[arguments[p].uuid]=p;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const c=this;this.stats={objects:{get total(){return c._objects.length},get inUse(){return this.total-c.nCachedObjects_}},get bindingsPerObject(){return c._bindings.length}}}add(){const e=this._objects,c=this._indicesByUUID,p=this._paths,_=this._parsedPaths,w=this._bindings,L=w.length;let O,D=e.length,z=this.nCachedObjects_;for(let Q=0,ae=arguments.length;Q!==ae;++Q){const ie=arguments[Q],he=ie.uuid;let ye=c[he];if(void 0===ye){ye=D++,c[he]=ye,e.push(ie);for(let Me=0,Ne=L;Me!==Ne;++Me)w[Me].push(new mo(ie,p[Me],_[Me]))}else if(ye<z){O=e[ye];const Me=--z,Ne=e[Me];c[Ne.uuid]=ye,e[ye]=Ne,c[he]=Me,e[Me]=ie;for(let $e=0,ze=L;$e!==ze;++$e){const Ye=w[$e];let nt=Ye[ye];Ye[ye]=Ye[Me],void 0===nt&&(nt=new mo(ie,p[$e],_[$e])),Ye[Me]=nt}}else e[ye]!==O&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=z}remove(){const e=this._objects,c=this._indicesByUUID,p=this._bindings,_=p.length;let w=this.nCachedObjects_;for(let L=0,O=arguments.length;L!==O;++L){const D=arguments[L],z=D.uuid,Q=c[z];if(void 0!==Q&&Q>=w){const ae=w++,ie=e[ae];c[ie.uuid]=Q,e[Q]=ie,c[z]=ae,e[ae]=D;for(let he=0,ye=_;he!==ye;++he){const Me=p[he],$e=Me[Q];Me[Q]=Me[ae],Me[ae]=$e}}}this.nCachedObjects_=w}uncache(){const e=this._objects,c=this._indicesByUUID,p=this._bindings,_=p.length;let w=this.nCachedObjects_,L=e.length;for(let O=0,D=arguments.length;O!==D;++O){const z=arguments[O].uuid,Q=c[z];if(void 0!==Q)if(delete c[z],Q<w){const ae=--w,ie=e[ae],he=--L,ye=e[he];c[ie.uuid]=Q,e[Q]=ie,c[ye.uuid]=ae,e[ae]=ye,e.pop();for(let Me=0,Ne=_;Me!==Ne;++Me){const $e=p[Me],Ye=$e[he];$e[Q]=$e[ae],$e[ae]=Ye,$e.pop()}}else{const ae=--L,ie=e[ae];ae>0&&(c[ie.uuid]=Q),e[Q]=ie,e.pop();for(let he=0,ye=_;he!==ye;++he){const Me=p[he];Me[Q]=Me[ae],Me.pop()}}}this.nCachedObjects_=w}subscribe_(e,c){const p=this._bindingsIndicesByPath;let _=p[e];const w=this._bindings;if(void 0!==_)return w[_];const L=this._paths,O=this._parsedPaths,D=this._objects,Q=this.nCachedObjects_,ae=new Array(D.length);_=w.length,p[e]=_,L.push(e),O.push(c),w.push(ae);for(let ie=Q,he=D.length;ie!==he;++ie)ae[ie]=new mo(D[ie],e,c);return ae}unsubscribe_(e){const c=this._bindingsIndicesByPath,p=c[e];if(void 0!==p){const _=this._paths,w=this._parsedPaths,L=this._bindings,O=L.length-1,D=L[O];c[e[O]]=p,L[p]=D,L.pop(),w[p]=w[O],w.pop(),_[p]=_[O],_.pop()}}}jf.prototype.isAnimationObjectGroup=!0;class c_{constructor(e,c,p=null,_=c.blendMode){this._mixer=e,this._clip=c,this._localRoot=p,this.blendMode=_;const w=c.tracks,L=w.length,O=new Array(L),D={endingStart:va,endingEnd:va};for(let z=0;z!==L;++z){const Q=w[z].createInterpolant(null);O[z]=Q,Q.settings=D}this._interpolantSettings=D,this._interpolants=O,this._propertyBindings=new Array(L),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Pa,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,c){return this.loop=e,this.repetitions=c,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,c,p){if(e.fadeOut(c),this.fadeIn(c),p){const _=this._clip.duration,w=e._clip.duration,O=_/w;e.warp(1,w/_,c),this.warp(O,1,c)}return this}crossFadeTo(e,c,p){return e.crossFadeFrom(this,c,p)}stopFading(){const e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,c,p){const _=this._mixer,w=_.time,L=this.timeScale;let O=this._timeScaleInterpolant;null===O&&(O=_._lendControlInterpolant(),this._timeScaleInterpolant=O);const D=O.parameterPositions,z=O.sampleValues;return D[0]=w,D[1]=w+p,z[0]=e/L,z[1]=c/L,this}stopWarping(){const e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,c,p,_){if(!this.enabled)return void this._updateWeight(e);const w=this._startTime;if(null!==w){const D=(e-w)*p;if(D<0||0===p)return;this._startTime=null,c=p*D}c*=this._updateTimeScale(e);const L=this._updateTime(c),O=this._updateWeight(e);if(O>0){const D=this._interpolants,z=this._propertyBindings;if(this.blendMode===Yu)for(let Q=0,ae=D.length;Q!==ae;++Q)D[Q].evaluate(L),z[Q].accumulateAdditive(O);else for(let Q=0,ae=D.length;Q!==ae;++Q)D[Q].evaluate(L),z[Q].accumulate(_,O)}}_updateWeight(e){let c=0;if(this.enabled){c=this.weight;const p=this._weightInterpolant;if(null!==p){const _=p.evaluate(e)[0];c*=_,e>p.parameterPositions[1]&&(this.stopFading(),0===_&&(this.enabled=!1))}}return this._effectiveWeight=c,c}_updateTimeScale(e){let c=0;if(!this.paused){c=this.timeScale;const p=this._timeScaleInterpolant;null!==p&&(c*=p.evaluate(e)[0],e>p.parameterPositions[1]&&(this.stopWarping(),0===c?this.paused=!0:this.timeScale=c))}return this._effectiveTimeScale=c,c}_updateTime(e){const c=this._clip.duration,p=this.loop;let _=this.time+e,w=this._loopCount;const L=p===lc;if(0===e)return-1===w||!L||1&~w?_:c-_;if(p===_u){-1===w&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(_>=c)_=c;else{if(!(_<0)){this.time=_;break e}_=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=_,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===w&&(e>=0?(w=0,this._setEndings(!0,0===this.repetitions,L)):this._setEndings(0===this.repetitions,!0,L)),_>=c||_<0){const O=Math.floor(_/c);_-=c*O,w+=Math.abs(O);const D=this.repetitions-w;if(D<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,_=e>0?c:0,this.time=_,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===D){const z=e<0;this._setEndings(z,!z,L)}else this._setEndings(!1,!1,L);this._loopCount=w,this.time=_,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:O})}}else this.time=_;if(L&&!(1&~w))return c-_}return _}_setEndings(e,c,p){const _=this._interpolantSettings;p?(_.endingStart=ta,_.endingEnd=ta):(_.endingStart=e?this.zeroSlopeAtStart?ta:va:xl,_.endingEnd=c?this.zeroSlopeAtEnd?ta:va:xl)}_scheduleFading(e,c,p){const _=this._mixer,w=_.time;let L=this._weightInterpolant;null===L&&(L=_._lendControlInterpolant(),this._weightInterpolant=L);const O=L.parameterPositions,D=L.sampleValues;return O[0]=w,D[0]=c,O[1]=w+e,D[1]=p,this}}class of extends Ps{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,c){const p=e._localRoot||this._root,_=e._clip.tracks,w=_.length,L=e._propertyBindings,O=e._interpolants,D=p.uuid,z=this._bindingsByRootAndName;let Q=z[D];void 0===Q&&(Q={},z[D]=Q);for(let ae=0;ae!==w;++ae){const ie=_[ae],he=ie.name;let ye=Q[he];if(void 0!==ye)L[ae]=ye;else{if(ye=L[ae],void 0!==ye){null===ye._cacheIndex&&(++ye.referenceCount,this._addInactiveBinding(ye,D,he));continue}ye=new Df(mo.create(p,he,c&&c._propertyBindings[ae].binding.parsedPath),ie.ValueTypeName,ie.getValueSize()),++ye.referenceCount,this._addInactiveBinding(ye,D,he),L[ae]=ye}O[ae].resultBuffer=ye.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){const p=(e._localRoot||this._root).uuid,_=e._clip.uuid,w=this._actionsByClip[_];this._bindAction(e,w&&w.knownActions[0]),this._addInactiveAction(e,_,p)}const c=e._propertyBindings;for(let p=0,_=c.length;p!==_;++p){const w=c[p];0==w.useCount++&&(this._lendBinding(w),w.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const c=e._propertyBindings;for(let p=0,_=c.length;p!==_;++p){const w=c[p];0==--w.useCount&&(w.restoreOriginalState(),this._takeBackBinding(w))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const c=e._cacheIndex;return null!==c&&c<this._nActiveActions}_addInactiveAction(e,c,p){const _=this._actions,w=this._actionsByClip;let L=w[c];if(void 0===L)L={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,w[c]=L;else{const O=L.knownActions;e._byClipCacheIndex=O.length,O.push(e)}e._cacheIndex=_.length,_.push(e),L.actionByRoot[p]=e}_removeInactiveAction(e){const c=this._actions,p=c[c.length-1],_=e._cacheIndex;p._cacheIndex=_,c[_]=p,c.pop(),e._cacheIndex=null;const w=e._clip.uuid,L=this._actionsByClip,O=L[w],D=O.knownActions,z=D[D.length-1],Q=e._byClipCacheIndex;z._byClipCacheIndex=Q,D[Q]=z,D.pop(),e._byClipCacheIndex=null,delete O.actionByRoot[(e._localRoot||this._root).uuid],0===D.length&&delete L[w],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const c=e._propertyBindings;for(let p=0,_=c.length;p!==_;++p){const w=c[p];0==--w.referenceCount&&this._removeInactiveBinding(w)}}_lendAction(e){const c=this._actions,p=e._cacheIndex,_=this._nActiveActions++,w=c[_];e._cacheIndex=_,c[_]=e,w._cacheIndex=p,c[p]=w}_takeBackAction(e){const c=this._actions,p=e._cacheIndex,_=--this._nActiveActions,w=c[_];e._cacheIndex=_,c[_]=e,w._cacheIndex=p,c[p]=w}_addInactiveBinding(e,c,p){const _=this._bindingsByRootAndName,w=this._bindings;let L=_[c];void 0===L&&(L={},_[c]=L),L[p]=e,e._cacheIndex=w.length,w.push(e)}_removeInactiveBinding(e){const c=this._bindings,p=e.binding,_=p.rootNode.uuid,w=p.path,L=this._bindingsByRootAndName,O=L[_],D=c[c.length-1],z=e._cacheIndex;D._cacheIndex=z,c[z]=D,c.pop(),delete O[w],0===Object.keys(O).length&&delete L[_]}_lendBinding(e){const c=this._bindings,p=e._cacheIndex,_=this._nActiveBindings++,w=c[_];e._cacheIndex=_,c[_]=e,w._cacheIndex=p,c[p]=w}_takeBackBinding(e){const c=this._bindings,p=e._cacheIndex,_=--this._nActiveBindings,w=c[_];e._cacheIndex=_,c[_]=e,w._cacheIndex=p,c[p]=w}_lendControlInterpolant(){const e=this._controlInterpolants,c=this._nActiveControlInterpolants++;let p=e[c];return void 0===p&&(p=new et(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),p.__cacheIndex=c,e[c]=p),p}_takeBackControlInterpolant(e){const c=this._controlInterpolants,p=e.__cacheIndex,_=--this._nActiveControlInterpolants,w=c[_];e.__cacheIndex=_,c[_]=e,w.__cacheIndex=p,c[p]=w}clipAction(e,c,p){const _=c||this._root,w=_.uuid;let L="string"==typeof e?Tt.findByName(_,e):e;const O=null!==L?L.uuid:e,D=this._actionsByClip[O];let z=null;if(void 0===p&&(p=null!==L?L.blendMode:Xu),void 0!==D){const ae=D.actionByRoot[w];if(void 0!==ae&&ae.blendMode===p)return ae;z=D.knownActions[0],null===L&&(L=z._clip)}if(null===L)return null;const Q=new c_(this,L,c,p);return this._bindAction(Q,z),this._addInactiveAction(Q,O,w),Q}existingAction(e,c){const p=c||this._root,_=p.uuid,w="string"==typeof e?Tt.findByName(p,e):e,O=this._actionsByClip[w?w.uuid:e];return void 0!==O&&O.actionByRoot[_]||null}stopAllAction(){const e=this._actions;for(let c=this._nActiveActions-1;c>=0;--c)e[c].stop();return this}update(e){const c=this._actions,p=this._nActiveActions,_=this.time+=e*=this.timeScale,w=Math.sign(e),L=this._accuIndex^=1;for(let z=0;z!==p;++z)c[z]._update(_,e,w,L);const O=this._bindings,D=this._nActiveBindings;for(let z=0;z!==D;++z)O[z].apply(L);return this}setTime(e){this.time=0;for(let c=0;c<this._actions.length;c++)this._actions[c].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const c=this._actions,p=e.uuid,_=this._actionsByClip,w=_[p];if(void 0!==w){const L=w.knownActions;for(let O=0,D=L.length;O!==D;++O){const z=L[O];this._deactivateAction(z);const Q=z._cacheIndex,ae=c[c.length-1];z._cacheIndex=null,z._byClipCacheIndex=null,ae._cacheIndex=Q,c[Q]=ae,c.pop(),this._removeInactiveBindingsForAction(z)}delete _[p]}}uncacheRoot(e){const c=e.uuid,p=this._actionsByClip;for(const w in p){const L=p[w].actionByRoot[c];void 0!==L&&(this._deactivateAction(L),this._removeInactiveAction(L))}const _=this._bindingsByRootAndName[c];if(void 0!==_)for(const w in _){const L=_[w];L.restoreOriginalState(),this._removeInactiveBinding(L)}}uncacheAction(e,c){const p=this.existingAction(e,c);null!==p&&(this._deactivateAction(p),this._removeInactiveAction(p))}}of.prototype._controlInterpolantsResultBuffer=new Float32Array(1);class sf{constructor(e){"string"==typeof e&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=arguments[1]),this.value=e}clone(){return new sf(void 0===this.value.clone?this.value:this.value.clone())}}class Zs extends Nh{constructor(e,c,p=1){super(e,c),this.meshPerAttribute=p}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const c=super.clone(e);return c.meshPerAttribute=this.meshPerAttribute,c}toJSON(e){const c=super.toJSON(e);return c.isInstancedInterleavedBuffer=!0,c.meshPerAttribute=this.meshPerAttribute,c}}Zs.prototype.isInstancedInterleavedBuffer=!0;class xf{constructor(e,c,p,_,w){this.buffer=e,this.type=c,this.itemSize=p,this.elementSize=_,this.count=w,this.version=0}set needsUpdate(e){!0===e&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,c){return this.type=e,this.elementSize=c,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}xf.prototype.isGLBufferAttribute=!0;class Ca{constructor(e,c,p=0,_=1/0){this.ray=new _n(e,c),this.near=p,this.far=_,this.camera=null,this.layers=new qs,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,c){this.ray.set(e,c)}setFromCamera(e,c){c&&c.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(c.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(c).sub(this.ray.origin).normalize(),this.camera=c):c&&c.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(c.near+c.far)/(c.near-c.far)).unproject(c),this.ray.direction.set(0,0,-1).transformDirection(c.matrixWorld),this.camera=c):console.error("THREE.Raycaster: Unsupported camera type: "+c.type)}intersectObject(e,c=!1,p=[]){return Yp(e,this,p,c),p.sort(Gf),p}intersectObjects(e,c=!1,p=[]){for(let _=0,w=e.length;_<w;_++)Yp(e[_],this,p,c);return p.sort(Gf),p}}function Gf(S,e){return S.distance-e.distance}function Yp(S,e,c,p){if(S.layers.test(e.layers)&&S.raycast(e,c),!0===p){const _=S.children;for(let w=0,L=_.length;w<L;w++)Yp(_[w],e,c,!0)}}class Hf{constructor(e=1,c=0,p=0){return this.radius=e,this.phi=c,this.theta=p,this}set(e,c,p){return this.radius=e,this.phi=c,this.theta=p,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,c,p){return this.radius=Math.sqrt(e*e+c*c+p*p),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,p),this.phi=Math.acos(jr(c/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}class Vf{constructor(e=1,c=0,p=0){return this.radius=e,this.theta=c,this.y=p,this}set(e,c,p){return this.radius=e,this.theta=c,this.y=p,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,c,p){return this.radius=Math.sqrt(e*e+p*p),this.theta=Math.atan2(e,p),this.y=c,this}clone(){return(new this.constructor).copy(this)}}const qm=new Un;class _d{constructor(e=new Un(1/0,1/0),c=new Un(-1/0,-1/0)){this.min=e,this.max=c}set(e,c){return this.min.copy(e),this.max.copy(c),this}setFromPoints(e){this.makeEmpty();for(let c=0,p=e.length;c<p;c++)this.expandByPoint(e[c]);return this}setFromCenterAndSize(e,c){const p=qm.copy(c).multiplyScalar(.5);return this.min.copy(e).sub(p),this.max.copy(e).add(p),this}clone(){return(new this.constructor).copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,c){return c.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,c){return c.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return qm.copy(e).clamp(this.min,this.max).sub(e).length()}intersect(e){return this.min.max(e.min),this.max.min(e.max),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}_d.prototype.isBox2=!0;const wm=new lt,up=new lt;class wf{constructor(e=new lt,c=new lt){this.start=e,this.end=c}set(e,c){return this.start.copy(e),this.end.copy(c),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,c){return this.delta(c).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,c){wm.subVectors(e,this.start),up.subVectors(this.end,this.start);const p=up.dot(up);let _=up.dot(wm)/p;return c&&(_=jr(_,0,1)),_}closestPointToPoint(e,c,p){const _=this.closestPointToPointParameter(e,c);return this.delta(p).multiplyScalar(_).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return(new this.constructor).copy(this)}}class hp extends Ir{constructor(e){super(),this.material=e,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}}hp.prototype.isImmediateRenderObject=!0;const Xm=new lt;class u_ extends Ir{constructor(e,c){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=c;const p=new br,_=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let L=0,O=1,D=32;L<D;L++,O++){const z=L/D*Math.PI*2,Q=O/D*Math.PI*2;_.push(Math.cos(z),Math.sin(z),1,Math.cos(Q),Math.sin(Q),1)}p.setAttribute("position",new dn(_,3));const w=new ji({fog:!1,toneMapped:!1});this.cone=new Fo(p,w),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateMatrixWorld();const e=this.light.distance?this.light.distance:1e3,c=e*Math.tan(this.light.angle);this.cone.scale.set(c,c,e),Xm.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Xm),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const fh=new lt,mh=new Qt,Wf=new Qt;class Sf extends Fo{constructor(e){const c=Ym(e),p=new br,_=[],w=[],L=new tr(0,0,1),O=new tr(0,1,0);for(let D=0;D<c.length;D++){const z=c[D];z.parent&&z.parent.isBone&&(_.push(0,0,0),_.push(0,0,0),w.push(L.r,L.g,L.b),w.push(O.r,O.g,O.b))}p.setAttribute("position",new dn(_,3)),p.setAttribute("color",new dn(w,3)),super(p,new ji({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=e,this.bones=c,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const c=this.bones,p=this.geometry,_=p.getAttribute("position");Wf.copy(this.root.matrixWorld).invert();for(let w=0,L=0;w<c.length;w++){const O=c[w];O.parent&&O.parent.isBone&&(mh.multiplyMatrices(Wf,O.matrixWorld),fh.setFromMatrixPosition(mh),_.setXYZ(L,fh.x,fh.y,fh.z),mh.multiplyMatrices(Wf,O.parent.matrixWorld),fh.setFromMatrixPosition(mh),_.setXYZ(L+1,fh.x,fh.y,fh.z),L+=2)}p.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}}function Ym(S){const e=[];S&&S.isBone&&e.push(S);for(let c=0;c<S.children.length;c++)e.push.apply(e,Ym(S.children[c]));return e}class Sm extends Po{constructor(e,c,p){super(new a(c,4,2),new nl({wireframe:!0,fog:!1,toneMapped:!1})),this.light=e,this.light.updateMatrixWorld(),this.color=p,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const Jm=new lt,kd=new tr,af=new tr;class h_ extends Ir{constructor(e,c,p){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=p;const _=new fl(c);_.rotateY(.5*Math.PI),this.material=new nl({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const w=_.getAttribute("position"),L=new Float32Array(3*w.count);_.setAttribute("color",new zi(L,3)),this.add(new Po(_,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const c=e.geometry.getAttribute("color");kd.copy(this.light.color),af.copy(this.light.groundColor);for(let p=0,_=c.count;p<_;p++){const w=p<_/2?kd:af;c.setXYZ(p,w.r,w.g,w.b)}c.needsUpdate=!0}e.lookAt(Jm.setFromMatrixPosition(this.light.matrixWorld).negate())}}class Em extends Fo{constructor(e=10,c=10,p=4473924,_=8947848){p=new tr(p),_=new tr(_);const w=c/2,L=e/c,O=e/2,D=[],z=[];for(let ae=0,ie=0,he=-O;ae<=c;ae++,he+=L){D.push(-O,0,he,O,0,he),D.push(he,0,-O,he,0,O);const ye=ae===w?p:_;ye.toArray(z,ie),ie+=3,ye.toArray(z,ie),ie+=3,ye.toArray(z,ie),ie+=3,ye.toArray(z,ie),ie+=3}const Q=new br;Q.setAttribute("position",new dn(D,3)),Q.setAttribute("color",new dn(z,3)),super(Q,new ji({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}class S_ extends Fo{constructor(e=10,c=16,p=8,_=64,w=4473924,L=8947848){w=new tr(w),L=new tr(L);const O=[],D=[];for(let Q=0;Q<=c;Q++){const ae=Q/c*(2*Math.PI),ie=Math.sin(ae)*e,he=Math.cos(ae)*e;O.push(0,0,0),O.push(ie,0,he);const ye=1&Q?w:L;D.push(ye.r,ye.g,ye.b),D.push(ye.r,ye.g,ye.b)}for(let Q=0;Q<=p;Q++){const ae=1&Q?w:L,ie=e-e/p*Q;for(let he=0;he<_;he++){let ye=he/_*(2*Math.PI),Me=Math.sin(ye)*ie,Ne=Math.cos(ye)*ie;O.push(Me,0,Ne),D.push(ae.r,ae.g,ae.b),ye=(he+1)/_*(2*Math.PI),Me=Math.sin(ye)*ie,Ne=Math.cos(ye)*ie,O.push(Me,0,Ne),D.push(ae.r,ae.g,ae.b)}}const z=new br;z.setAttribute("position",new dn(O,3)),z.setAttribute("color",new dn(D,3)),super(z,new ji({vertexColors:!0,toneMapped:!1})),this.type="PolarGridHelper"}}const Zm=new lt,lf=new lt,Qm=new lt;class p_ extends Ir{constructor(e,c,p){super(),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=p,void 0===c&&(c=1);let _=new br;_.setAttribute("position",new dn([-c,c,0,c,c,0,c,-c,0,-c,-c,0,-c,c,0],3));const w=new ji({fog:!1,toneMapped:!1});this.lightPlane=new Oo(_,w),this.add(this.lightPlane),_=new br,_.setAttribute("position",new dn([0,0,0,0,0,1],3)),this.targetLine=new Oo(_,w),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){Zm.setFromMatrixPosition(this.light.matrixWorld),lf.setFromMatrixPosition(this.light.target.matrixWorld),Qm.subVectors(lf,Zm),this.lightPlane.lookAt(lf),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(lf),this.targetLine.scale.z=Qm.length()}}const Tm=new lt,_a=new Al;class E_ extends Fo{constructor(e){const c=new br,p=new ji({color:16777215,vertexColors:!0,toneMapped:!1}),_=[],w=[],L={},O=new tr(16755200),D=new tr(16711680),z=new tr(43775),Q=new tr(16777215),ae=new tr(3355443);function ie(ye,Me,Ne){he(ye,Ne),he(Me,Ne)}function he(ye,Me){_.push(0,0,0),w.push(Me.r,Me.g,Me.b),void 0===L[ye]&&(L[ye]=[]),L[ye].push(_.length/3-1)}ie("n1","n2",O),ie("n2","n4",O),ie("n4","n3",O),ie("n3","n1",O),ie("f1","f2",O),ie("f2","f4",O),ie("f4","f3",O),ie("f3","f1",O),ie("n1","f1",O),ie("n2","f2",O),ie("n3","f3",O),ie("n4","f4",O),ie("p","n1",D),ie("p","n2",D),ie("p","n3",D),ie("p","n4",D),ie("u1","u2",z),ie("u2","u3",z),ie("u3","u1",z),ie("c","t",Q),ie("p","c",ae),ie("cn1","cn2",ae),ie("cn3","cn4",ae),ie("cf1","cf2",ae),ie("cf3","cf4",ae),c.setAttribute("position",new dn(_,3)),c.setAttribute("color",new dn(w,3)),super(c,p),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=L,this.update()}update(){const e=this.geometry,c=this.pointMap;_a.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),La("c",c,e,_a,0,0,-1),La("t",c,e,_a,0,0,1),La("n1",c,e,_a,-1,-1,-1),La("n2",c,e,_a,1,-1,-1),La("n3",c,e,_a,-1,1,-1),La("n4",c,e,_a,1,1,-1),La("f1",c,e,_a,-1,-1,1),La("f2",c,e,_a,1,-1,1),La("f3",c,e,_a,-1,1,1),La("f4",c,e,_a,1,1,1),La("u1",c,e,_a,.7,1.1,-1),La("u2",c,e,_a,-.7,1.1,-1),La("u3",c,e,_a,0,2,-1),La("cf1",c,e,_a,-1,0,1),La("cf2",c,e,_a,1,0,1),La("cf3",c,e,_a,0,-1,1),La("cf4",c,e,_a,0,1,1),La("cn1",c,e,_a,-1,0,-1),La("cn2",c,e,_a,1,0,-1),La("cn3",c,e,_a,0,-1,-1),La("cn4",c,e,_a,0,1,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function La(S,e,c,p,_,w,L){Tm.set(_,w,L).unproject(p);const O=e[S];if(void 0!==O){const D=c.getAttribute("position");for(let z=0,Q=O.length;z<Q;z++)D.setXYZ(O[z],Tm.x,Tm.y,Tm.z)}}const Mm=new Vi;class d_ extends Fo{constructor(e,c=16776960){const p=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),_=new Float32Array(24),w=new br;w.setIndex(new zi(p,1)),w.setAttribute("position",new zi(_,3)),super(w,new ji({color:c,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&Mm.setFromObject(this.object),Mm.isEmpty())return;const c=Mm.min,p=Mm.max,_=this.geometry.attributes.position,w=_.array;w[0]=p.x,w[1]=p.y,w[2]=p.z,w[3]=c.x,w[4]=p.y,w[5]=p.z,w[6]=c.x,w[7]=c.y,w[8]=p.z,w[9]=p.x,w[10]=c.y,w[11]=p.z,w[12]=p.x,w[13]=p.y,w[14]=c.z,w[15]=c.x,w[16]=p.y,w[17]=c.z,w[18]=c.x,w[19]=c.y,w[20]=c.z,w[21]=p.x,w[22]=c.y,w[23]=c.z,_.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e){return Fo.prototype.copy.call(this,e),this.object=e.object,this}}class T_ extends Fo{constructor(e,c=16776960){const p=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),_=new br;_.setIndex(new zi(p,1)),_.setAttribute("position",new dn([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(_,new ji({color:c,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const c=this.box;c.isEmpty()||(c.getCenter(this.position),c.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}}class M_ extends Oo{constructor(e,c=1,p=16776960){const _=p,w=new br;w.setAttribute("position",new dn([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),w.computeBoundingSphere(),super(w,new ji({color:_,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=c;const L=new br;L.setAttribute("position",new dn([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),L.computeBoundingSphere(),this.add(new Po(L,new nl({color:_,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){let c=-this.plane.constant;Math.abs(c)<1e-8&&(c=1e-8),this.scale.set(.5*this.size,.5*this.size,c),this.children[0].material.side=c<0?le:_e,this.lookAt(this.plane.normal),super.updateMatrixWorld(e)}}const f_=new lt;let Am,Km;class A_ extends Ir{constructor(e=new lt(0,0,1),c=new lt(0,0,0),p=1,_=16776960,w=.2*p,L=.2*w){super(),this.type="ArrowHelper",void 0===Am&&(Am=new br,Am.setAttribute("position",new dn([0,0,0,0,1,0],3)),Km=new Ih(0,.5,1,5,1),Km.translate(0,-.5,0)),this.position.copy(c),this.line=new Oo(Am,new ji({color:_,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Po(Km,new nl({color:_,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(p,w,L)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{f_.set(e.z,0,-e.x).normalize();const c=Math.acos(e.y);this.quaternion.setFromAxisAngle(f_,c)}}setLength(e,c=.2*e,p=.2*c){this.line.scale.set(1,Math.max(1e-4,e-c),1),this.line.updateMatrix(),this.cone.scale.set(p,c,p),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}}class m_ extends Fo{constructor(e=1){const c=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],p=new br;p.setAttribute("position",new dn(c,3)),p.setAttribute("color",new dn([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),super(p,new ji({vertexColors:!0,toneMapped:!1})),this.type="AxesHelper"}setColors(e,c,p){const _=new tr,w=this.geometry.attributes.color.array;return _.set(e),_.toArray(w,0),_.toArray(w,3),_.set(c),_.toArray(w,6),_.toArray(w,9),_.set(p),_.toArray(w,12),_.toArray(w,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}const __=new Float32Array(1),$_=new Int32Array(__.buffer);class C_{static toHalfFloat(e){__[0]=e;const c=$_[0];let p=c>>16&32768,_=c>>12&2047;const w=c>>23&255;return w<103?p:w>142?(p|=31744,p|=(255==w?0:1)&&8388607&c,p):w<113?(_|=2048,p|=(_>>114-w)+(_>>113-w&1),p):(p|=w-112<<10|_>>1,p+=1&_,p)}}const L_=0,B_=1,N_=0,R_=1,P_=2;function I_(S){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),S}function O_(S=[]){return console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),S.isMultiMaterial=!0,S.materials=S,S.clone=function(){return S.slice()},S}function k_(S,e){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new Qr(S,e)}function F_(S){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new Ql(S)}function g_(S,e){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new Qr(S,e)}function v_(S){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new Co(S)}function e_(S){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new Co(S)}function D_(S){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new Co(S)}function U_(S,e,c){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new lt(S,e,c)}function z_(S,e){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new zi(S,e).setUsage(Lr)}function j_(S,e){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new jd(S,e)}function G_(S,e){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new Cp(S,e)}function H_(S,e){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new xa(S,e)}function V_(S,e){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new Ku(S,e)}function W_(S,e){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new eh(S,e)}function q_(S,e){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new wa(S,e)}function X_(S,e){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new oi(S,e)}function Y_(S,e){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new dn(S,e)}function J_(S,e){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new Gc(S,e)}function t(S){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new m_(S)}function u(S,e){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new d_(S,e)}function m(S,e){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new Fo(new Hr(S.geometry),new ji({color:void 0!==e?e:16777215}))}function g(S,e){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new Fo(new R(S.geometry),new ji({color:void 0!==e?e:16777215}))}function E(S){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Kn(S)}function I(S){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new ao(S)}function V(S,e,c){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new xc(S,c)}function J(){console.error("THREE.CanvasRenderer has been removed")}function Y(){console.error("THREE.JSONLoader has been removed.")}pa.create=function(S,e){return console.log("THREE.Curve.create() has been deprecated"),S.prototype=Object.create(pa.prototype),S.prototype.constructor=S,S.prototype.getPoint=e,S},hs.prototype.fromPoints=function(S){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(S)},Em.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Sf.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Yn.prototype.extractUrlBase=function(S){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),gf.extractUrlBase(S)},Yn.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},_d.prototype.center=function(S){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(S)},_d.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},_d.prototype.isIntersectionBox=function(S){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(S)},_d.prototype.size=function(S){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(S)},Vi.prototype.center=function(S){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(S)},Vi.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Vi.prototype.isIntersectionBox=function(S){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(S)},Vi.prototype.isIntersectionSphere=function(S){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(S)},Vi.prototype.size=function(S){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(S)},xo.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Dr.prototype.setFromMatrix=function(S){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(S)},wf.prototype.center=function(S){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(S)},ot.prototype.flattenToArrayOffset=function(S,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(S,e)},ot.prototype.multiplyVector3=function(S){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),S.applyMatrix3(this)},ot.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},ot.prototype.applyToBufferAttribute=function(S){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),S.applyMatrix3(this)},ot.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},ot.prototype.getInverse=function(S){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(S).invert()},Qt.prototype.extractPosition=function(S){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(S)},Qt.prototype.flattenToArrayOffset=function(S,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(S,e)},Qt.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new lt).setFromMatrixColumn(this,3)},Qt.prototype.setRotationFromQuaternion=function(S){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(S)},Qt.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},Qt.prototype.multiplyVector3=function(S){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),S.applyMatrix4(this)},Qt.prototype.multiplyVector4=function(S){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),S.applyMatrix4(this)},Qt.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},Qt.prototype.rotateAxis=function(S){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),S.transformDirection(this)},Qt.prototype.crossVector=function(S){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),S.applyMatrix4(this)},Qt.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},Qt.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},Qt.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},Qt.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},Qt.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},Qt.prototype.applyToBufferAttribute=function(S){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),S.applyMatrix4(this)},Qt.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},Qt.prototype.makeFrustum=function(S,e,c,p,_,w){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(S,e,p,c,_,w)},Qt.prototype.getInverse=function(S){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(S).invert()},Sa.prototype.isIntersectionLine=function(S){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(S)},Li.prototype.multiplyVector3=function(S){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),S.applyQuaternion(this)},Li.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},_n.prototype.isIntersectionBox=function(S){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(S)},_n.prototype.isIntersectionPlane=function(S){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(S)},_n.prototype.isIntersectionSphere=function(S){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(S)},eo.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},eo.prototype.barycoordFromPoint=function(S,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(S,e)},eo.prototype.midpoint=function(S){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(S)},eo.prototypenormal=function(S){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(S)},eo.prototype.plane=function(S){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(S)},eo.barycoordFromPoint=function(S,e,c,p,_){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),eo.getBarycoord(S,e,c,p,_)},eo.normal=function(S,e,c,p){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),eo.getNormal(S,e,c,p)},is.prototype.extractAllPoints=function(S){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(S)},is.prototype.extrude=function(S){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Il(this,S)},is.prototype.makeGeometry=function(S){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new rs(this,S)},Un.prototype.fromAttribute=function(S,e,c){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(S,e,c)},Un.prototype.distanceToManhattan=function(S){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(S)},Un.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},lt.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},lt.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},lt.prototype.getPositionFromMatrix=function(S){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(S)},lt.prototype.getScaleFromMatrix=function(S){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(S)},lt.prototype.getColumnFromMatrix=function(S,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,S)},lt.prototype.applyProjection=function(S){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(S)},lt.prototype.fromAttribute=function(S,e,c){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(S,e,c)},lt.prototype.distanceToManhattan=function(S){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(S)},lt.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Hi.prototype.fromAttribute=function(S,e,c){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(S,e,c)},Hi.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Ir.prototype.getChildByName=function(S){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(S)},Ir.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},Ir.prototype.translate=function(S,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,S)},Ir.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},Ir.prototype.applyMatrix=function(S){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(S)},Object.defineProperties(Ir.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(S){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=S}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Po.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(Po.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),Xh},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Aa.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Io.prototype.setLens=function(S,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(S)},Object.defineProperties(Bo.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(S){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=S}},shadowCameraLeft:{set:function(S){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=S}},shadowCameraRight:{set:function(S){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=S}},shadowCameraTop:{set:function(S){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=S}},shadowCameraBottom:{set:function(S){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=S}},shadowCameraNear:{set:function(S){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=S}},shadowCameraFar:{set:function(S){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=S}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(S){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=S}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(S){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=S}},shadowMapHeight:{set:function(S){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=S}}}),Object.defineProperties(zi.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Lr},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Lr)}}}),zi.prototype.setDynamic=function(S){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===S?Lr:_i),this},zi.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},zi.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},br.prototype.addIndex=function(S){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(S)},br.prototype.addAttribute=function(S,e){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===S?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(e),this):this.setAttribute(S,e):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(S,new zi(arguments[1],arguments[2])))},br.prototype.addDrawCall=function(S,e,c){void 0!==c&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(S,e)},br.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},br.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},br.prototype.removeAttribute=function(S){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(S)},br.prototype.applyMatrix=function(S){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(S)},Object.defineProperties(br.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Nh.prototype.setDynamic=function(S){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===S?Lr:_i),this},Nh.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Il.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},Il.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},Il.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},Qc.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},sf.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(As.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new tr}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(S){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=S===T}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(S){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=S}},vertexTangents:{get:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")},set:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}}),Object.defineProperties(Ns.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(S){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=S}}}),Qn.prototype.clearTarget=function(S,e,c,p){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(S),this.clear(e,c,p)},Qn.prototype.animate=function(S){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(S)},Qn.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},Qn.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},Qn.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},Qn.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},Qn.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},Qn.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},Qn.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},Qn.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},Qn.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},Qn.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},Qn.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},Qn.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},Qn.prototype.enableScissorTest=function(S){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(S)},Qn.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},Qn.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},Qn.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},Qn.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},Qn.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},Qn.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},Qn.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},Qn.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},Qn.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},Qn.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(Qn.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(S){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=S}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(S){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=S}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(S){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===S?Ka:Qi}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(zp.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(io.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(S){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=S}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(S){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=S}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(S){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=S}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(S){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=S}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(S){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=S}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(S){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=S}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(S){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=S}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(S){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=S}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(S){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=S}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(S){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=S}}}),ym.prototype.load=function(S){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const e=this;return(new rc).load(S,function(c){e.setBuffer(c)}),this},fd.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},ol.prototype.updateCubeMap=function(S,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(S,e)},ol.prototype.clear=function(S,e,c,p){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(S,e,c,p)},Ts.crossOrigin=void 0,Ts.loadTexture=function(S,e,c,p){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const _=new Do;_.setCrossOrigin(this.crossOrigin);const w=_.load(S,c,void 0,p);return e&&(w.mapping=e),w},Ts.loadTextureCube=function(S,e,c,p){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const _=new so;_.setCrossOrigin(this.crossOrigin);const w=_.load(S,c,void 0,p);return e&&(w.mapping=e),w},Ts.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Ts.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};const Z={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};function me(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:x}})),typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=x)},980:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__,factory;factory=function(){var process={release:{name:""}},__BRYTHON__=__BRYTHON__||{};try{eval("async function* f(){}")}catch(n){console.warn("Your browser is not fully supported. If you are using Microsoft Edge, please upgrade to the latest version")}(function(n){var o;n.isWebWorker=typeof WorkerGlobalScope<"u"&&"function"==typeof importScripts&&navigator instanceof WorkerNavigator,n.isNode=void 0!==process&&"node"===process.release.name;var l,x=(o=n.isNode?{location:{href:"",origin:"",pathname:""},navigator:{userLanguage:""}}:self).location.href;if(n.protocol=x.split(":")[0],n.BigInt=o.BigInt,void 0===n.brython_path){var N;if(n.isWebWorker)(N=o.location.href).startsWith("blob:")&&(N=N.substr(5));else{var U=document.getElementsByTagName("script");N=U[U.length-1].src}var G=N.split("/");G.pop(),l=n.brython_path=G.join("/")+"/"}else n.brython_path.endsWith("/")||(n.brython_path+="/"),l=n.brython_path;var A=(o.location.origin+o.location.pathname).split("/");A.pop();var P=n.script_dir=A.join("/");if(n.__ARGV=[],n.webworkers={},n.$py_module_path={},n.file_cache={},n.$py_src={},n.path=[l+"Lib",l+"libs",P,l+"Lib/site-packages"],n.async_enabled=!1,n.async_enabled&&(n.block={}),n.imported={},n.precompiled={},n.frames_stack=[],n.builtins={},n.builtins_scope={id:"__builtins__",module:"__builtins__",binding:{}},n.builtin_funcs={},n.builtin_classes=[],n.__getattr__=function(de){return this[de]},n.__setattr__=function(de,be){if(!(["debug","stdout","stderr"].indexOf(de)>-1))throw n.builtins.AttributeError.$factory("__BRYTHON__ object has no attribute "+de);n[de]=be},n.language=o.navigator.userLanguage||o.navigator.language,n.locale="C",n.charset=n.isWebWorker?"utf-8":document.characterSet||document.inputEncoding||"utf-8",n.max_int=Math.pow(2,53)-1,n.min_int=-n.max_int,n.$py_next_hash=Math.pow(2,53)-1,n.$py_UUID=0,n.lambda_magic=Math.random().toString(36).substr(2,8),n.set_func_names=function(de,be){if(de.$infos){var te=de.$infos.__name__;de.$infos.__module__=be,de.$infos.__qualname__=te}else de.$infos={__name__:te=de.__name__,__module__:be,__qualname__:te};for(var ce in de.__module__=be,de)"function"==typeof de[ce]&&(de[ce].$infos={__doc__:de[ce].__doc__||"",__module__:be,__qualname__:te+"."+ce,__name__:ce},"classmethod"==de[ce].$type&&(de[ce].__class__=n.method))},typeof Storage<"u"){n.has_local_storage=!1;try{localStorage&&(n.local_storage=localStorage,n.has_local_storage=!0)}catch{}n.has_session_storage=!1;try{sessionStorage&&(n.session_storage=sessionStorage,n.has_session_storage=!0)}catch{}}else n.has_local_storage=!1,n.has_session_storage=!1;n.globals=function(){return n.frames_stack[n.frames_stack.length-1][3]},n.scripts={},n.$options={},n.update_VFS=function(de){n.VFS=n.VFS||{};var be=de.$timestamp;for(var te in void 0!==be&&delete de.$timestamp,de)n.VFS.hasOwnProperty(te)&&console.warn("Virtual File System: duplicate entry "+te),n.VFS[te]=de[te],n.VFS[te].timestamp=be},n.add_files=function(de){for(var be in n.files=n.files||{},de)n.files[be]=de[be]},n.python_to_js=function(de,be){return n.meta_path=n.$meta_path.slice(),n.use_VFS||n.meta_path.shift(),void 0===be&&(be="__main__"),"(function() {\n var $locals_"+be+" = {}\n"+__BRYTHON__.py2js(de,be,be).to_js()+"\n}())"},o.py=function(de){var be=n.py2js(de[0],"script","script").to_js();n.set_import_paths(),new Function("$locals_script",be)({})}})(__BRYTHON__),__BRYTHON__.implementation=[3,8,10,"final",0],__BRYTHON__.__MAGIC__="3.8.10",__BRYTHON__.version_info=[3,8,0,"final",0],__BRYTHON__.compiled_date="2020-10-06 14:56:18.181563",__BRYTHON__.timestamp=1601988978181,__BRYTHON__.builtin_module_names=["_aio","_ajax","_base64","_binascii","_io_classes","_json","_jsre","_locale","_multiprocessing","_posixsubprocess","_profile","_sre_utils","_string","_strptime","_svg","_warnings","_webcomponent","_webworker","_zlib_utils","array","builtins","dis","hashlib","long_int","marshal","math","math1","modulefinder","posix","random","unicodedata"],function($B){var js,$pos,res,$op;Number.isInteger=Number.isInteger||function(n){return"number"==typeof n&&isFinite(n)&&Math.floor(n)===n},Number.isSafeInteger=Number.isSafeInteger||function(n){return Number.isInteger(n)&&Math.abs(n)<=Number.MAX_SAFE_INTEGER};var _b_=$B.builtins,_window;_window=$B.isNode?{location:{href:"",origin:"",pathname:""}}:self,$B.parser={};var clone=$B.clone=function(n){var o={};for(var l in n)o[l]=n[l];return o};$B.last=function(n){return void 0===n&&console.log($B.frames_stack.slice()),n[n.length-1]},$B.list2obj=function(n,o){var l={},x=n.length;for(void 0===o&&(o=!0);x-- >0;)l[n[x]]=o;return l},$B.op2method={operations:{"**":"pow","//":"floordiv","<<":"lshift",">>":"rshift","+":"add","-":"sub","*":"mul","/":"truediv","%":"mod","@":"matmul"},augmented_assigns:{"//=":"ifloordiv",">>=":"irshift","<<=":"ilshift","**=":"ipow","+=":"iadd","-=":"isub","*=":"imul","/=":"itruediv","%=":"imod","&=":"iand","|=":"ior","^=":"ixor","@=":"imatmul"},binary:{"&":"and","|":"or","~":"invert","^":"xor"},comparisons:{"<":"lt",">":"gt","<=":"le",">=":"ge","==":"eq","!=":"ne"},boolean:{or:"or",and:"and",in:"in",not:"not",is:"is",not_in:"not_in",is_not:"is_not"},subset:function(){var n={},o=[];if("all"==arguments[0])(o=Object.keys($B.op2method)).splice(o.indexOf("subset"),1);else for(var l=0,x=arguments.length;l<x;l++)o.push(arguments[l]);for(l=0,x=o.length;l<x;l++){var N=o[l],U=$B.op2method[N];if(void 0===U)throw Error(N);for(var G in U)n[G]=U[G]}return n}};var $operators=$B.op2method.subset("all"),$augmented_assigns=$B.augmented_assigns=$B.op2method.augmented_assigns,noassign=$B.list2obj(["True","False","None","__debug__"]),$op_order=[["or"],["and"],["not"],["in","not_in"],["<","<=",">",">=","!=","==","is","is_not"],["|"],["^"],["&"],[">>","<<"],["+"],["-"],["*","@","/","//","%"],["unary_neg","unary_inv","unary_pos"],["**"]],$op_weight={},$weight=1;$op_order.forEach(function(n){n.forEach(function(o){$op_weight[o]=$weight}),$weight++});var $loop_num=0,create_temp_name=$B.parser.create_temp_name=function(n){return(n||"$temp")+$loop_num++},replace_node=$B.parser.replace_node=function(n,o){var l=n.parent,x=get_rank_in_parent(n);l.children[x]=o,o.parent=l,o.bindings=n.bindings},get_rank_in_parent=$B.parser.get_rank_in_parent=function(n){return n.parent.children.indexOf(n)},add_identnode=$B.parser.add_identnode=function(n,o,l,x){var N=new $Node;N.parent=n,N.locals=n.locals,N.module=n.module;var U=new $NodeCtx(N),G=new $ExprCtx(U,"id",!0),A=(new $IdCtx(G,l),new $AssignCtx(G));return-1===o?n.add(N):n.insert(o,N),A.tree[1]=x,N},chained_comp_num=0,$_SyntaxError=$B.parser.$_SyntaxError=function(n,o,l){for(var x=n;"node"!==x.type;)x=x.parent;for(var N=x.node,U=N;void 0!==U.parent;)U=U.parent;var G=N.module,A=U.src,P=N.line_num;if(A&&(P=A.substr(0,$pos).split("\n").length),U.line_info&&(P=U.line_info),void 0!==l&&"number"==typeof l)throw $B.$IndentationError(G,o,A,$pos,P,U);Array.isArray(o)&&$B.$SyntaxError(G,o[0],A,$pos,P,U),"Triple string end not found"===o&&$B.$SyntaxError(G,"invalid syntax : triple string end not found",A,$pos,P,U);var de="invalid syntax";o.startsWith("token ")||(de+=" ("+o+")"),$B.$SyntaxError(G,de,A,$pos,P,U)};function SyntaxWarning(n,o){var l=$get_node(n),x=$get_module(n),N=x.src.split("\n"),U=`Module ${x.module}line ${l.line_num}:${o}\n    `+N[l.line_num-1];$B.$getattr($B.stderr,"write")(U)}function check_assignment(n){for(var o=n,l=["assert","del","import","raise","return"];o;)l.indexOf(o.type)>-1?$_SyntaxError(n,"invalid syntax - assign"):"expr"==o.type&&"op"==o.tree[0].type&&$_SyntaxError(n,void 0!==$B.op2method.comparisons[o.tree[0].op]?["cannot assign to comparison"]:["cannot assign to operator"]),o=o.parent}var $Node=$B.parser.$Node=function(n){this.type=n,this.children=[]};$Node.prototype.add=function(n){this.children[this.children.length]=n,n.parent=this,n.module=this.module},$Node.prototype.insert=function(n,o){this.children.splice(n,0,o),o.parent=this,o.module=this.module},$Node.prototype.toString=function(){return"<object 'Node'>"},$Node.prototype.show=function(n){var o="";return"module"===this.type?(this.children.forEach(function(l){o+=l.show(n)}),o):(o+=" ".repeat(n=n||0),o+=this.C,this.children.length>0&&(o+="{"),o+="\n",this.children.forEach(function(l){o+="["+i+"] "+l.show(n+4)}),this.children.length>0&&(o+=" ".repeat(n),o+="}\n"),o)},$Node.prototype.to_js=function(n){if(void 0!==this.js)return this.js;if(this.res=[],this.unbound=[],"module"===this.type)return this.children.forEach(function(l){this.res.push(l.to_js())},this),this.js=this.res.join(""),this.js;n=n||0;var o=this.C.to_js();return o&&(this.res.push(" ".repeat(n)),this.res.push(o),this.children.length>0&&this.res.push("{"),this.res.push("\n"),this.children.forEach(function(l){this.res.push(l.to_js(n+4))},this),this.children.length>0&&(this.res.push(" ".repeat(n)),this.res.push("}\n"))),this.js=this.res.join(""),this.js},$Node.prototype.transform=function(n){if(this.has_await)return this.parent.insert(n,$NodeJS("var save_stack = $B.save_stack()")),this.parent.insert(n+2,$NodeJS("$B.restore_stack(save_stack, $locals)")),this.has_await=!1,1;if(this.has_yield&&!this.has_yield.transformed){var o=this.parent;if(this.has_yield.from){var l=new $Node,x=new $NodeCtx(l),N=new $ExprCtx(x,"js",!1),U=new $RawJSCtx(N,`var _i${this.has_yield.from_num}`),G=new $AssignCtx(N);new $ExprCtx(G).tree=this.has_yield.tree,o.insert(n,l),$get_node(this.has_yield);var A=this.has_yield.from_num;return o.insert(n+1,$NodeJS(`$B.$import("sys",[],{})\n_i${A}=_b_.iter(_i${A})\nvar $failed${A}=false\ntry{var _y${A}=_b_.next(_i${A})}catch(_e){$B.set_exc(_e)\n$failed${A}=true\n$B.pmframe=$B.last($B.frames_stack)\n_e=$B.exception(_e)\nif(_e.__class__===_b_.StopIteration){var _r${A}=$B.$getattr(_e,"value")}else{throw _e}}\nif(! $failed${A}){while(true){var $failed1${A}=false\ntry{$B.leave_frame({$locals})\nvar _s${A}=yield _y${A}\n$B.frames_stack.push($top_frame)}catch(_e){if(_e.__class__===_b_.GeneratorExit){var $failed2${A}=false\ntry{var _m${A}=$B.$geatttr(_i${A},"close")}catch(_e1){$failed2${A}=true\nif(_e1.__class__ !==_b_.AttributeError){throw _e1}}\nif(! $failed2${A}){$B.$call(_m${A})()}\nthrow _e}else if($B.is_exc(_e,[_b_.BaseException])){var _x=$B.$call($B.$getattr($locals.sys,"exc_info"))()\nvar $failed3${A}=false\ntry{var _m${A}=$B.$getattr(_i${A},"throw")}catch(err){$failed3${A}=true\nif($B.is_exc(err,[_b_.AttributeError])){throw err}}\nif(! $failed3${A}){try{_y${A}=$B.$call(_m${A}).apply(null,_b_.list.$factory(_x${A}))}catch(err){if($B.$is_exc(err,[_b_.StopIteration])){_r${A}=$B.$getattr(err,"value")\nbreak}\nthrow err}}}}\nif(! $failed1${A}){try{if(_s${A}===_b_.None){_y${A}=_b_.next(_i${A})}else{_y${A}=$B.$call($B.$getattr(_i${A},"send"))(_s${A})}}catch(err){if($B.is_exc(err,[_b_.StopIteration])){_r${A}=$B.$getattr(err,"value")\nbreak}\nthrow err}}}}`)),3}o.children.splice(n,1),"abstract_expr"===this.has_yield.tree[0].type?l=$NodeJS("var result = _b_.None"):(l=new $Node,x=new $NodeCtx(l),N=new $ExprCtx(x,"js",!1),U=new $RawJSCtx(N,"var result"),(G=new $AssignCtx(N)).tree[1]=this.has_yield.tree[0],U.parent=G),l.line_num=this.line_num,o.insert(n,l);var de=new $NodeJS("try");de.add($NodeJS("$B.leave_frame({$locals})")),de.add(this),o.insert(n+1,de),this.has_yield.to_js=function(){return"yield result"},this.has_yield.transformed=!0;for(var be=0;be<de.children.length;)void 0===(_e=de.children[be].transform(be))&&(_e=1),be+=_e;var te=$NodeJS(`catch(err${this.line_num})`);return te.add($NodeJS("$B.frames_stack.push($top_frame)")),te.add($NodeJS(`throw err${this.line_num}`)),o.insert(n+2,te),o.insert(n+3,$NodeJS("$B.frames_stack.push($top_frame)")),2}if("module"!==this.type){var ce,fe=this.C.tree[0];for(void 0===fe&&console.log(this),void 0!==fe.transform&&(ce=fe.transform(this,n)),be=0;be<this.children.length;)void 0===(_e=this.children[be].transform(be))&&(_e=1),be+=_e;return void 0===ce&&(ce=1),ce}for(this.__doc__=$get_docstring(this),be=0;be<this.children.length;){var _e;void 0===(_e=this.children[be].transform(be))&&(_e=1),be+=_e}},$Node.prototype.clone=function(){var n=new $Node(this.type);for(var o in this)n[o]=this[o];return n},$Node.prototype.clone_tree=function(){var n=new $Node(this.type);for(var o in this)n[o]=this[o];n.children=[];for(var l=0,x=this.children.length;l<x;l++)n.add(this.children[l].clone_tree());return n};var $AbstractExprCtx=$B.parser.$AbstractExprCtx=function(n,o){this.type="abstract_expr",this.with_commas=o,this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$AbstractExprCtx.prototype.toString=function(){return"(abstract_expr "+this.with_commas+") "+this.tree},$AbstractExprCtx.prototype.transition=function(n,o){var l=this,x=l.packed,N=l.is_await,U=l.assign;if(!U)switch(n){case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case".":case"not":case"lambda":case"yield":l.parent.tree.pop();var G=l.with_commas;(l=l.parent).packed=x,l.is_await=N,U&&(console.log("set assign to parent",l),l.assign=U)}switch(n){case"await":return new $AwaitCtx(l);case"id":return new $IdCtx(new $ExprCtx(l,"id",G),o);case"str":return new $StringCtx(new $ExprCtx(l,"str",G),o);case"bytes":return new $StringCtx(new $ExprCtx(l,"bytes",G),o);case"int":return new $NumberCtx("int",new $ExprCtx(l,"int",G),o);case"float":return new $NumberCtx("float",new $ExprCtx(l,"float",G),o);case"imaginary":return new $NumberCtx("imaginary",new $ExprCtx(l,"imaginary",G),o);case"(":return new $ListOrTupleCtx(new $ExprCtx(l,"tuple",G),"tuple");case"[":return new $ListOrTupleCtx(new $ExprCtx(l,"list",G),"list");case"{":return new $DictOrSetCtx(new $ExprCtx(l,"dict_or_set",G));case".":return new $EllipsisCtx(new $ExprCtx(l,"ellipsis",G));case"not":return"op"==l.type&&"is"==l.op?(l.op="is_not",l):new $NotCtx(new $ExprCtx(l,"not",G));case"lambda":return new $LambdaCtx(new $ExprCtx(l,"lambda",G));case"op":var A=o;switch(A){case"*":return l.parent.tree.pop(),G=l.with_commas,new $PackedCtx(new $ExprCtx(l=l.parent,"expr",G));case"-":case"~":case"+":l.parent.tree.pop();var P=new $UnaryCtx(l.parent,A);if("-"==A)var de=new $OpCtx(P,"unary_neg");else de=new $OpCtx(P,"+"==A?"unary_pos":"unary_inv");return new $AbstractExprCtx(de,!1);case"not":return l.parent.tree.pop(),G=l.with_commas,new $NotCtx(new $ExprCtx(l=l.parent,"not",G))}$_SyntaxError(l,"token "+n+" after "+l);case"=":$_SyntaxError(l,"token "+n+" after "+l);case"yield":return new $AbstractExprCtx(new $YieldCtx(l),!0);case":":return"sub"==l.parent.type||"list_or_tuple"==l.parent.type&&"sub"==l.parent.parent.type?new $AbstractExprCtx(new $SliceCtx(l.parent),!1):$transition(l.parent,n,o);case")":case",":switch(l.parent.type){case"list_or_tuple":case"slice":case"call_arg":case"op":case"yield":break;case"annotation":$_SyntaxError(l,"empty annotation");default:$_SyntaxError(l,n)}}return $transition(l.parent,n,o)},$AbstractExprCtx.prototype.to_js=function(){return this.js_processed=!0,"list"===this.type?"["+$to_js(this.tree)+"]":$to_js(this.tree)};var $AliasCtx=$B.parser.$AliasCtx=function(n){this.type="ctx_manager_alias",this.parent=n,this.tree=[],n.tree[n.tree.length-1].alias=this};$AliasCtx.prototype.transition=function(n,o){var l=this;switch(n){case",":case":":return l.parent.set_alias(l.tree[0].tree[0]),$transition(l.parent,n,o)}$_SyntaxError(l,"token "+n+" after "+l)};var $AnnotationCtx=$B.parser.$AnnotationCtx=function(n){this.type="annotation",this.parent=n,this.tree=[],n.annotation=this;var o=$get_scope(n);if(void 0===o.binding.__annotations__&&(o.binding.__annotations__=!0,n.create_annotations=!0),"def"==o.ntype&&n.tree&&n.tree.length>0&&"id"==n.tree[0].type){var l=n.tree[0].value;o.globals&&o.globals.has(l)>-1&&$_SyntaxError(n,["annotated name '"+l+"' can't be global"]),o.annotations=o.annotations||new Set,o.annotations.add(l),n.$in_parens||(o.binding=o.binding||{},o.binding[l]=!0)}};$AnnotationCtx.prototype.toString=function(){return"(annotation) "+this.tree},$AnnotationCtx.prototype.transition=function(n,o){var l=this;return"eol"==n&&1==l.tree.length&&0==l.tree[0].tree.length?$_SyntaxError(l,"empty annotation"):":"==n&&"def"!=l.parent.type?$_SyntaxError(l,"more than one annotation"):"augm_assign"==n?$_SyntaxError(l,"augmented assign as annotation"):"op"==n&&$_SyntaxError(l,"operator as annotation"),$transition(l.parent,n)},$AnnotationCtx.prototype.to_js=function(){return $to_js(this.tree)};var $AssertCtx=$B.parser.$AssertCtx=function(n){this.type="assert",this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$AssertCtx.prototype.toString=function(){return"(assert) "+this.tree},$AssertCtx.prototype.transition=function(n,o){var l=this;return","==n?(this.tree.length>1&&$_SyntaxError(l,"too many commas after assert"),new $AbstractExprCtx(this,!1)):"eol"==n?$transition(l.parent,n):void $_SyntaxError(l,n)},$AssertCtx.prototype.transform=function(n,o){if(this.tree.length>1)var l=this.tree[0],x=this.tree[1];else l=this.tree[0],x=null;"expr"==this.tree[0].type&&"tuple"==this.tree[0].name&&this.tree[0].tree[0].tree.length>1&&SyntaxWarning(this,"assertion is always true, perhaps remove parentheses?");var N=new $ConditionCtx(n.C,"if");new $NotCtx(N).tree=[l],n.C=N;var U=new $Node,G="throw _b_.AssertionError.$factory()";null!==x&&(G="throw _b_.AssertionError.$factory(_b_.str.$factory("+x.to_js()+"))"),new $NodeJSCtx(U,G),n.add(U)};var $AssignCtx=$B.parser.$AssignCtx=function(n,o){check_assignment(n),"expr"==n.type&&"lambda"==n.tree[0].type&&$_SyntaxError(n,["cannot assign to lambda"]),this.type="assign","expression"==o&&(this.expression=!0,console.log("parent of assign expr",n.parent)),n.parent.tree.pop(),n.parent.tree[n.parent.tree.length]=this,this.parent=n.parent,this.tree=[n];var l=$get_scope(this);if("expr"==n.type&&"call"==n.tree[0].type)$_SyntaxError(n,["cannot assign to function call "]);else if("list_or_tuple"==n.type||"expr"==n.type&&"list_or_tuple"==n.tree[0].type)"expr"==n.type&&(n=n.tree[0]),n.bind_ids(l);else if("assign"==n.type)n.tree.forEach(function(U){var G=U.tree[0];"id"==G.type&&$bind(G.value,l,this)},this);else{var x=n.tree[0];if(x&&"id"==x.type)if(!0===noassign[x.value]&&$_SyntaxError(n,["cannot assign to keyword"]),x.bound=!0,l.globals&&l.globals.has(x.value)){var N=$get_module(n);x.global_module=N.module,$bind(x.value,N,this)}else $get_node(this).bound_before=Object.keys(l.binding),$bind(x.value,l,this);else["str","int","float","complex"].indexOf(x.type)>-1?$_SyntaxError(n,["cannot assign to literal"]):"unary"==x.type&&$_SyntaxError(n,["cannot assign to operator"])}};$AssignCtx.prototype.guess_type=function(){},$AssignCtx.prototype.toString=function(){return"(assign) "+this.tree[0]+"="+this.tree[1]},$AssignCtx.prototype.transition=function(n,o){var l=this;if("eol"==n)return"abstract_expr"==l.tree[1].type&&$_SyntaxError(l,"token "+n+" after "+l),l.guess_type(),$transition(l.parent,"eol");$_SyntaxError(l,"token "+n+" after "+l)},$AssignCtx.prototype.transform=function(n,o){for(var l=$get_scope(this),x=this.tree[0],N=this.tree[1],U=[];"assign"==x.type;)U.push(x.tree[1]),x=x.tree[0];if(U.length>0){U.push(x);var G=n.C;G.tree=[];var A=new $RawJSCtx(G,"var $temp"+$loop_num);return A.tree=G.tree,new $AssignCtx(A).tree[1]=N,U.forEach(function(Be){"expr"==Be.type&&"list_or_tuple"==Be.tree[0].type&&"tuple"==Be.tree[0].real&&1==Be.tree[0].tree.length&&(Be=Be.tree[0].tree[0]);var K=new $Node,ve=new $NodeCtx(K);K.locals=n.locals,K.line_num=n.line_num,n.parent.insert(o+1,K),Be.parent=ve;var Ae=new $AssignCtx(Be);new $RawJSCtx(Ae,"$temp"+$loop_num)}),$loop_num++,void(this.tree[0]=x)}var P=null;switch(x.type){case"expr":x.tree.length>1?P=x.tree:"list_or_tuple"==x.tree[0].type||"target_list"==x.tree[0].type?P=x.tree[0].tree:"id"==x.tree[0].type&&(l.globals&&l.globals.has(x.tree[0].value)||(x.tree[0].bound=!0));break;case"target_list":case"list_or_tuple":P=x.tree}if(N=this.tree[1],null!==P){var be=null;if(("list"==N.type||"tuple"==N.type||"expr"==N.type&&N.tree.length>1)&&(be=N.tree),null!==be){if(be.length>P.length)throw Error("ValueError : too many values to unpack (expected "+P.length+")");if(be.length<P.length)throw Error("ValueError : need more than "+be.length+" to unpack");var te=[],ce=0;(pe=new $Node).line_num=n.line_num,new $NodeJSCtx(pe,"void(0)"),te[ce++]=pe;var fe="$temp"+$loop_num;(pe=new $Node).line_num=n.line_num,new $NodeJSCtx(pe,"var "+fe+" = [], $pos = 0"),te[ce++]=pe,be.forEach(function(Be){var K=fe+"[$pos++] = "+Be.to_js(),ve=new $Node;ve.line_num=n.line_num,new $NodeJSCtx(ve,K),te[ce++]=ve});var _e=$get_node(this);P.forEach(function(Be){var K=new $Node;K.id=_e.module,K.locals=_e.locals,K.line_num=n.line_num;var ve=new $NodeCtx(K);Be.parent=ve,new $AssignCtx(Be,!1).tree[1]=new $JSCode(fe+"["+le+"]"),te[ce++]=K},this),n.parent.children.splice(o,1);for(var le=te.length-1;le>=0;le--)n.parent.insert(o,te[le]);$loop_num++}else{n.parent.children.splice(o,1);var pe,T=create_temp_name("$right"),B=create_temp_name("$rlist");(pe=$NodeJS("var "+T+" = $B.$getattr($B.$iter("+N.to_js()+'), "__next__");')).line_num=n.line_num,n.parent.insert(o++,pe),n.parent.insert(o++,$NodeJS("var "+B+"=[], $pos=0;while(1){try{"+B+"[$pos++] = "+T+"()}catch(err){break}}"));var q=null,ee=P.length;for(le=0;le<P.length;le++){var F=P[le];if("packed"==F.type||"expr"==F.type&&"packed"==F.tree[0].type){q=le,ee--;break}}n.parent.insert(o++,$NodeJS("if("+B+".length<"+ee+'){throw _b_.ValueError.$factory("need more than " +'+B+'.length + " value" + ('+B+'.length > 1 ? "s" : "") + " to unpack")}')),null==q&&n.parent.insert(o++,$NodeJS("if("+B+".length>"+ee+'){throw _b_.ValueError.$factory("too many values to unpack (expected '+P.length+')")}')),P.forEach(function(Be,K){var ve=new $Node;ve.id=l.id,ve.line_num=n.line_num,n.parent.insert(o++,ve);var Ae=new $NodeCtx(ve);Be.parent=Ae;var Fe=new $AssignCtx(Be,!1),Ee=B;Fe.tree[1]=new $JSCode(Ee+=null==q||K<q?"["+K+"]":K==q?".slice("+K+","+B+".length-"+(P.length-K-1)+")":"["+B+".length-"+(P.length-K)+"]")}),$loop_num++}}else x.tree[0].bound&&"expr"==N.type&&"int"==N.name&&(n.bindings=n.bindings||{},n.bindings[x.tree[0].value]="int")},$AssignCtx.prototype.to_js=function(){if(this.js_processed=!0,"call"==this.parent.type)return'{$nat:"kw",name:'+this.tree[0].to_js()+",value:"+this.tree[1].to_js()+"}";for(var n=this.tree[0];"expr"==n.type&&!n.assign;)n=n.tree[0];var o=this.tree[1];if("attribute"==n.type||"sub"==n.type){var l=o.to_js(),x="",N="",U="$temp"+$loop_num;if("expr"!=o.type||void 0===o.tree[0]||"call"!=o.tree[0].type||"eval"!=o.tree[0].func.value&&"exec"!=o.tree[0].func.value?"expr"==o.type&&void 0!==o.tree[0]&&"sub"==o.tree[0].type?(x+="var "+U+" = "+l+";\n",N=U):N=l:(x+="var "+U+" = "+l+";\n",N=U),"attribute"==n.type){$loop_num++,n.func="setattr";var G=n.to_js();return n.func="getattr",n.assign_self?x+G[0]+N+G[1]+N+")":(x=(x+=G).substr(0,x.length-1))+","+N+");_b_.None;"}if("sub"==n.type){var A,P=n.value.to_js(),de="$temp"+$loop_num;return"id"==n.value.type&&(A=$get_node(this).locals[n.value.value]),$loop_num++,x="var "+de+" = "+P+"\n","list"!==A&&(x+="if(Array.isArray("+de+") && !"+de+".__class__){"),1==n.tree.length?x+="$B.set_list_key("+de+","+(n.tree[0].to_js()+""||"null")+","+o.to_js()+")":2==n.tree.length?x+="$B.set_list_slice("+de+","+(n.tree[0].to_js()+""||"null")+","+(n.tree[1].to_js()+""||"null")+","+o.to_js()+")":3==n.tree.length&&(x+="$B.set_list_slice_step("+de+","+(n.tree[0].to_js()+""||"null")+","+(n.tree[1].to_js()+""||"null")+","+(n.tree[2].to_js()+""||"null")+","+o.to_js()+")"),"list"==A||(x+="\n}else{",1==n.tree.length?x+="$B.$setitem("+n.value.to_js()+","+n.tree[0].to_js()+","+l+")};_b_.None;":(n.func="setitem",x=(x+=n.to_js()).substr(0,x.length-1),n.func="getitem",x+=","+l+")};_b_.None;")),x}}return n.to_js()+" = "+o.to_js()};var $AsyncCtx=$B.parser.$AsyncCtx=function(n){this.type="async",this.parent=n,n.async=!0};$AsyncCtx.prototype.toString=function(){return"(async)"},$AsyncCtx.prototype.transition=function(n,o){var l=this;if("def"==n)return $transition(l.parent,n,o);if("for"==n||"with"==n){var x=$get_scope(l).ntype;"def"!==x&&"generator"!=x&&$_SyntaxError(l,["'async "+n+"' outside async function"]);var N=$transition(l.parent,n,o);return N.parent.async=!0,N}$_SyntaxError(l,"token "+n+" after "+l)};var $AttrCtx=$B.parser.$AttrCtx=function(n){this.type="attribute",this.value=n.tree[0],this.parent=n,n.tree.pop(),n.tree[n.tree.length]=this,this.tree=[],this.func="getattr"};$AttrCtx.prototype.toString=function(){return"(attr) "+this.value+"."+this.name},$AttrCtx.prototype.transition=function(n,o){var l=this;if("id"===n){var x=o;return!0===noassign[x]&&$_SyntaxError(l,["cannot assign to "+x]),x=$mangle(x,l),l.name=x,l.parent}$_SyntaxError(l,n)},$AttrCtx.prototype.to_js=function(){this.js_processed=!0;var n=this.value.to_js();if("setattr"==this.func&&"id"==this.value.type){var o=$get_scope(this),l=o.parent;if("def"==o.ntype&&"class"==l.ntype&&this.value.value==o.C.tree[0].positional_list[0]&&l.C&&void 0===l.C.tree[0].args)return this.assign_self=!0,[n+".__class__ && "+n+".__dict__ && !"+n+".__class__.$has_setattr && ! "+n+".$is_class ? _b_.dict.$setitem("+n+".__dict__, '"+this.name+"', ",") : $B.$setattr("+n+', "'+this.name+'", ']}return"setattr"==this.func?"$B.$setattr("+n+',"'+this.name+'")':"$B.$getattr("+n+',"'+this.name+'")'};var $AugmentedAssignCtx=$B.parser.$AugmentedAssignCtx=function(n,o){check_assignment(n),this.type="augm_assign",this.C=n,this.parent=n.parent,n.parent.tree.pop(),n.parent.tree[n.parent.tree.length]=this,this.op=o,this.tree=[n];var l=this.scope=$get_scope(this);if("expr"==n.type){var x=n.tree[0];if("id"==x.type){var N=x.value;!0===noassign[N]?$_SyntaxError(n,["cannot assign to keyword"]):"def"!=l.ntype&&"generator"!=l.ntype||void 0!==l.binding[N]||void 0!==l.globals&&l.globals.has(N)||(x.unbound=!0)}else["str","int","float","complex"].indexOf(x.type)>-1&&$_SyntaxError(n,["cannot assign to literal"])}$get_node(this).bound_before=Object.keys(l.binding),this.module=l.module};$AugmentedAssignCtx.prototype.toString=function(){return"(augm assign) "+this.tree},$AugmentedAssignCtx.prototype.transition=function(n,o){var l=this;if("eol"==n)return"abstract_expr"==l.tree[1].type&&$_SyntaxError(l,"token "+n+" after "+l),$transition(l.parent,"eol");$_SyntaxError(l,"token "+n+" after "+l)},$AugmentedAssignCtx.prototype.transform=function(n,o){var l=this.C,x=this.op,N="__"+$operators[x]+"__",U=0,G=n.parent,A=n.line_num,P=!1;G.children.splice(o,1);var de="expr"==this.tree[0].type&&"id"==this.tree[0].tree[0].type;if(de){var be="int"==this.tree[0].tree[0].bindingType(this.scope);if(this.tree[0].tree[0].augm_assign=!0,$B.debug>0){var te=$NodeJS("if("+this.tree[0].to_js()+" === undefined){throw _b_.NameError.$factory(\"name '"+this.tree[0].tree[0].value+"' is not defined\")}");n.parent.insert(o,te),U++}var ce=this.tree[0].tree[0].value,fe=void 0!==this.scope.binding[ce],_e=this.tree[0].tree[0].unbound}var le="expr"==this.tree[1].type&&"int"==this.tree[1].tree[0].type;if(le){var pe=this.tree[1].tree[0].value,T=parseInt(pe[1],pe[0]);le=T>$B.min_int&&T<$B.max_int}var B=le?this.tree[1].tree[0].to_js():"$temp";if(!le){(Ee=new $Node).line_num=A,P=!0,new $NodeJSCtx(Ee,"var $temp,$left;"),G.insert(o,Ee),U++,(Ee=new $Node).id=this.scope.id;var q=new $NodeCtx(Ee),ee=new $ExprCtx(q,"js",!1),F=new $RawJSCtx(ee,"$temp"),Be=new $AssignCtx(ee);Be.tree[1]=this.tree[1],F.parent=Be,G.insert(o+U,Ee),U++}var K="",ve=!1;switch(x){case"+=":case"-=":case"*=":case"/=":if(de){var Ae=this.scope,Fe="$local_"+Ae.module.replace(/\./g,"_");switch(Ae.ntype){case"module":K=Fe;break;case"def":case"generator":K=Ae.globals&&Ae.globals.has(l.tree[0].value)?Fe:"$locals";break;case"class":var Ee=new $Node;P||(Ee.line_num=A,P=!0),new $NodeJSCtx(Ee,"var $left = "+l.to_js()),G.insert(o+U,Ee),ve=!0,U++}}}var qe=l.tree[0].to_js();if("id"==l.tree[0].type){var Ke=l.tree[0].firstBindingScopeId(),gt=l.tree[0].value;qe=Ke?"$locals_"+Ke.replace(/\./g,"_")+'["'+gt+'"]':'$locals["'+gt+'"]'}if(be&&le&&"//="!=x)return G.insert(o+U,$NodeJS(qe+" "+x+" "+B)),U++;K=K&&!l.tree[0].unknown_binding&&!_e;var at=x.charAt(0);if(K){var Ct=ve?"$left":qe;Ee=new $Node,P||(Ee.line_num=A,P=!0),Ft=le?"if(":'if(typeof $temp.valueOf() == "number" && ',Ft+=Ct+".constructor === Number",Ft+=" && Number.isSafeInteger("+qe+at+B+")){"+(le?"(":'(typeof $temp == "number" && ')+"typeof "+Ct+' == "number") ? ',Ft+=qe+x+B,new $NodeJSCtx(Ee,Ft+=" : "+qe+" = new Number("+qe+at+(le?B:B+".valueOf()")+")}"),G.insert(o+U,Ee),U++}if("sub"==l.tree[0].type&&("+="==x||"-="==x||"*="==x)&&1==l.tree[0].tree.length){var wt="$B.augm_item_"+{"+=":"add","-=":"sub","*=":"mul"}[x]+"("+l.tree[0].value.to_js()+","+l.tree[0].tree[0].to_js()+","+B+");_b_.None;";return Ee=new $Node,P||(Ee.line_num=A,P=!0),new $NodeJSCtx(Ee,wt),G.insert(o+U,Ee),void U++}Ee=new $Node,P||(Ee.line_num=A,P=!0);var Ft="";K&&(Ft+="else "),Ft+="if(! _b_.hasattr("+l.to_js()+',"'+N+'"))',new $NodeJSCtx(Ee,Ft),G.insert(o+U,Ee),U++;var Ot=new $Node;Ot.id=this.scope.id,Ot.line_num=n.line_num,Ee.add(Ot);var rn=new $NodeCtx(Ot),ft=new $ExprCtx(rn,"clone",!1);_e?new $RawJSCtx(ft,qe):(ft.tree=l.tree,ft.tree.forEach(function(or){or.parent=ft}));var Tn=new $AssignCtx(ft),Cn=new $OpCtx(ft,x.substr(0,x.length-1));Cn.parent=Tn,new $RawJSCtx(Cn,B),Tn.tree.push(Cn),ft.parent.tree.pop(),ft.parent.tree.push(Tn);var mn=$NodeJS("else");G.insert(o+U,mn);var Pn=new $Node;Pn.line_num=n.line_num,mn.add(Pn);var $n=new $NodeCtx(Pn),gn=new $ExprCtx($n,"clone",!1);_e?(Ft=qe,Ke||(Ft='$B.$local_search("'+gt+'");'+qe),new $RawJSCtx(gn,Ft)):(gn.tree=l.tree,gn.tree.forEach(function(or){or.parent=gn}));var ur=new $AssignCtx(gn);return ur.tree.push($NodeJS("$B.$getattr("+l.to_js()+',"'+N+'")('+B+")")),gn.parent.tree.pop(),gn.parent.tree.push(ur),!de||fe||this.scope.blurred||(this.scope.binding[ce]=void 0),U},$AugmentedAssignCtx.prototype.to_js=function(){return""};var $AwaitCtx=$B.parser.$AwaitCtx=function(n){this.type="await",this.parent=n,this.tree=[],n.tree.push(this);for(var o=n;o;)"list_or_tuple"==o.type&&(o.is_await=!0),o=o.parent};$AwaitCtx.prototype.transition=function(n,o){return this.parent.is_await=!0,$transition(this.parent,n,o)},$AwaitCtx.prototype.to_js=function(){return"var save_stack = $B.save_stack();await ($B.promise("+$to_js(this.tree)+"));$B.restore_stack(save_stack, $locals); "};var $BodyCtx=$B.parser.$BodyCtx=function(n){for(var o=n.parent;"node"!==o.type;)o=o.parent;var l=o.node,x=new $Node;return x.is_body_node=!0,x.line_num=l.line_num,l.insert(0,x),new $NodeCtx(x)},set_loop_context=$B.parser.set_loop_context=function(n,o){for(var l=n;"node"!==l.type;)l=l.parent;for(var x=l.node.parent,N=!1;;)if("module"==x.type)$_SyntaxError(n,o+" outside of a loop");else{var U=x.C.tree[0];if("condition"==U.type&&"while"==U.token){this.loop_ctx=U,U["has_"+o]=!0;break}switch(U.type){case"for":this.loop_ctx=U,U["has_"+o]=!0,N=!0;break;case"def":case"generator":case"class":$_SyntaxError(n,o+" outside of a loop");default:x=x.parent}if(N)break}},$BreakCtx=$B.parser.$BreakCtx=function(n){this.type="break",this.parent=n,n.tree[n.tree.length]=this,set_loop_context.apply(this,[n,"break"])};$BreakCtx.prototype.toString=function(){return"break "},$BreakCtx.prototype.transition=function(n,o){if("eol"==n)return $transition(this.parent,"eol");$_SyntaxError(this,n)},$BreakCtx.prototype.to_js=function(){return this.js_processed=!0,";$locals_"+$get_scope(this).id.replace(/\./g,"_")+'["$no_break'+this.loop_ctx.loop_num+'"] = false'+("asyncfor"!=this.loop_ctx.type?";break":";throw _b_.StopIteration.$factory("+this.loop_ctx.loop_num+")")};var $CallArgCtx=$B.parser.$CallArgCtx=function(n){this.type="call_arg",this.parent=n,this.start=$pos,this.tree=[],n.tree.push(this),this.expect="id"};$CallArgCtx.prototype.toString=function(){return"call_arg "+this.tree},$CallArgCtx.prototype.transition=function(n,o){var l=this;switch(n){case"await":case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case".":case"not":case"lambda":if("id"==l.expect){l.expect=",";var x=new $AbstractExprCtx(l,!1);return $transition(x,n,o)}break;case"=":if(","==l.expect)return new $ExprCtx(new $KwArgCtx(l),"kw_value",!1);break;case"for":this.parent.tree.length>1&&$_SyntaxError(l,"non-parenthesized generator expression");var N=new $ListOrTupleCtx(l,"gen_expr");N.vars=l.vars,N.locals=l.locals,N.intervals=[l.start],l.tree.pop(),N.expression=l.tree,l.tree=[N],N.tree=[];var U=new $ComprehensionCtx(N);return new $TargetListCtx(new $CompForCtx(U));case"op":if("id"==l.expect){var G=o;switch(l.expect=",",G){case"+":case"-":case"~":return $transition(new $AbstractExprCtx(l,!1),n,G);case"*":return new $StarArgCtx(l);case"**":return new $DoubleStarArgCtx(l)}}$_SyntaxError(l,"token "+n+" after "+l);case")":if(l.parent.kwargs&&$B.last(l.parent.tree).tree[0]&&-1==["kwarg","star_arg","double_star_arg"].indexOf($B.last(l.parent.tree).tree[0].type)&&$_SyntaxError(l,["non-keyword argument after keyword argument"]),l.tree.length>0){var A=l.tree[l.tree.length-1];"list_or_tuple"==A.type&&"gen_expr"==A.real&&A.intervals.push($pos)}return $transition(l.parent,n);case":":if(","==l.expect&&"lambda"==l.parent.parent.type)return $transition(l.parent.parent,n);break;case",":if(","==l.expect)return l.parent.kwargs&&-1==["kwarg","star_arg","double_star_arg"].indexOf($B.last(l.parent.tree).tree[0].type)&&$_SyntaxError(l,["non-keyword argument after keyword argument"]),$transition(l.parent,n,o)}console.log("token ",n," after ",l),$_SyntaxError(l,"token "+n+" after "+l)},$CallArgCtx.prototype.to_js=function(){return this.js_processed=!0,$to_js(this.tree)};var $CallCtx=$B.parser.$CallCtx=function(n){this.type="call",this.func=n.tree[0],void 0!==this.func&&(this.func.parent=this),this.parent=n,"class"!=n.type?(n.tree.pop(),n.tree[n.tree.length]=this):n.args=this,this.expect="id",this.tree=[],this.start=$pos,this.func&&"attribute"==this.func.type&&"wait"==this.func.name&&"id"==this.func.value.type&&"time"==this.func.value.value&&(console.log("call",this.func),$get_node(this).blocking={type:"wait",call:this}),this.func&&"input"==this.func.value&&($get_node(this).blocking={type:"input"})};$CallCtx.prototype.toString=function(){return"(call) "+this.func+"("+this.tree+")"},$CallCtx.prototype.transition=function(n,o){var l=this;switch(n){case",":return"id"==l.expect&&$_SyntaxError(l,n),l.expect="id",l;case"await":case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case".":case"not":case"lambda":return l.expect=",",$transition(new $CallArgCtx(l),n,o);case")":return l.end=$pos,l.parent;case"op":switch(l.expect=",",o){case"-":case"~":case"+":return l.expect=",",$transition(new $CallArgCtx(l),n,o);case"*":return l.has_star=!0,new $StarArgCtx(l);case"**":return l.has_dstar=!0,new $DoubleStarArgCtx(l)}$_SyntaxError(l,n);case"yield":$_SyntaxError(l,n)}return $transition(l.parent,n,o)},$CallCtx.prototype.to_js=function(){this.js_processed=!0,this.tree.length>0&&0==this.tree[this.tree.length-1].tree.length&&this.tree.pop();var n=this.func.to_js();if(void 0!==this.func){if("classmethod"===this.func.value)return"_b_.classmethod.$factory("+$to_js(this.tree)+")";if("unary"==this.func.type){var o="$B.$getattr("+$to_js(this.tree);switch(this.func.op){case"+":return o+',"__pos__")()';case"-":return o+',"__neg__")()';case"~":return o+',"__invert__")()'}}var l,x=[],N=[],U=!1,G=[];if(this.tree.forEach(function(fe){switch(fe.type){case"star_arg":U=!0,x.push([fe.tree[0].tree[0].to_js(),"*"]);break;case"double_star_arg":G.push(fe.tree[0].tree[0].to_js());break;case"id":x.push([fe.to_js(),"s"]);break;default:switch(fe.tree[0].type){case"expr":case"list_or_tuple":case"op":default:x.push([fe.to_js(),"s"]);break;case"kwarg":N.push(fe.tree[0].tree[0].value+":"+fe.tree[0].tree[1].to_js());break;case"star_arg":U=!0,x.push([fe.tree[0].tree[0].to_js(),"*"]);break;case"double_star_arg":G.push(fe.tree[0].tree[0].to_js())}}}),U){for(var A=[],P=0,de=x.length;P<de;P++)if(arg=x[P],"*"==arg[1])A.push("_b_.list.$factory("+arg[0]+")");else{var be=[x[P][0]];for(P++;P<de&&"s"==x[P][1];)be.push(x[P][0]),P++;P--,A.push("["+be.join(",")+"]")}for(l=A[0],P=1;P<A.length;P++)l+=".concat("+A[P]+")"}else{for(P=0,de=x.length;P<de;P++)x[P]=x[P][0];l=x.join(", ")}var te="{"+N.join(", ")+"}";te=G.length?'{$nat:"kw",kw:['+te+","+G.join(", ")+"]}":"{}"!=te?'{$nat:"kw",kw:'+te+"}":"",U&&te?l+=".concat(["+te+"])":l&&te?l+=","+te:l||(l=te);var ce="$B.$call("+n+")"+(l=U?".apply(null,"+l+")":"("+l+")");return this.tree.length>-1&&"id"==this.func.type&&this.func.is_builtin&&void 0!==$B.builtin_funcs[this.func.value]?-1==["complex","bytes","bytearray","object","memoryview","int","float","str","list","tuple","dict","set","frozenset","range","slice","zip","bool","type","classmethod","staticmethod","enumerate","reversed","property","$$super","zip","map","filter"].indexOf(this.func.value)?n+l:n+".$factory"+l:ce}};var $ClassCtx=$B.parser.$ClassCtx=function(n){this.type="class",this.parent=n,this.tree=[],n.tree[n.tree.length]=this,this.expect="id";var o=this.scope=$get_scope(this);this.parent.node.parent_block=o,this.parent.node.bound={},this.parent.node.binding={__annotations__:!0}};$ClassCtx.prototype.toString=function(){return"(class) "+this.name+" "+this.tree+" args "+this.args},$ClassCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":if("id"==l.expect)return l.set_name(o),l.expect="(:",l;break;case"(":return new $CallCtx(l);case":":return $BodyCtx(l)}$_SyntaxError(l,"token "+n+" after "+l)},$ClassCtx.prototype.set_name=function(n){var o=this.parent;this.random=$B.UUID(),this.name=n,this.id=o.node.module+"_"+n+"_"+this.random,this.binding={},this.parent.node.id=this.id;for(var l=this.scope,x=l,N=l,U=[];"class"==N.ntype;)U.splice(0,0,N.C.tree[0].name),N=N.parent;for(this.qualname=U.concat([n]).join(".");x.C&&"class"==x.C.tree[0].type;)x=x.parent;for(;x.C&&"def"!=x.C.tree[0].type&&"generator"!=x.C.tree[0].type;)x=x.parent;this.parent.node.parent_block=x,$bind(n,l,this),l.is_function&&-1==l.C.tree[0].locals.indexOf(n)&&l.C.tree[0].locals.push(n)},$ClassCtx.prototype.transform=function(n,o){this.doc_string=$get_docstring(n),this.module=$get_module(this).module.replace(/\./g,"_");var l="\n"+" ".repeat(n.indent+12),x=new $Node,N="$locals_"+this.id.replace(/\./g,"_");new $NodeJSCtx(x,A="var "+N+" = {__annotations__: $B.empty_dict()}, "+l+"$locals = "+N),n.insert(0,x);for(var U=this.scope;"__builtins__"!==U.parent_block.id;)U=U.parent_block;var G="$locals_"+U.id.replace(/\./g,"_"),A=" ".repeat(n.indent+4)+'$locals.$name = "'+this.name+'"'+l+'$locals.$qualname = "'+this.qualname+'"'+l+"$locals.$is_class = true; "+l+'$locals.$line_info = "'+n.line_num+","+this.module+'";'+l+'var $top_frame = ["'+N+'", $locals,"'+U.id+'", '+G+"]"+l+"$locals.$f_trace = $B.enter_frame($top_frame);"+l+"if($locals.$f_trace !== _b_.None){$locals.$f_trace = $B.trace_line()}";n.insert(1,$NodeJS(A)),n.add($NodeJS("if($locals.$f_trace !== _b_.None){$B.trace_return(_b_.None)}")),n.add($NodeJS("$B.leave_frame({$locals})"));var P=new $Node;new $NodeJSCtx(P,"return "+N+";"),n.insert(n.children.length,P);var de=new $Node;new $NodeJSCtx(de,")();"),n.parent.insert(o+1,de),o++,n.parent.insert(o+1,$NodeJS("$"+this.name+"_"+this.random+".__module__ = $locals_"+this.module+".__name__"));var te=$get_scope(this),ce=";$locals_"+te.id.replace(/\./g,"_"),fe=1;if((A=[(ce+='["'+this.name+'"]')+' = $B.$class_constructor("'+this.name])[fe++]='", $'+this.name+"_"+this.random,void 0!==this.args){var le=[],pe=[];this.args.tree.forEach(function(K){"kwarg"==K.tree[0].type?pe.push(K.tree[0]):le.push(K.to_js())}),A[fe++]=", _b_.tuple.$factory(["+le.join(",")+"]),[";var T=new RegExp('"',"g"),B=[],q=0;le.forEach(function(K){B[q++]='"'+K.replace(T,'\\"')+'"'}),A[fe++]=B.join(",")+"]",B=[],q=0,pe.forEach(function(K){B[q++]='["'+K.tree[0].value+'",'+K.tree[1].to_js()+"]"}),A[fe++]=",["+B.join(",")+"]"}else A[fe++]=", _b_.tuple.$factory([]),[],[]";A[fe++]=")";var ee=new $Node;new $NodeJSCtx(ee,A.join("")),o++,n.parent.insert(o+1,ee),o++;var F=new $Node;if(new $NodeJSCtx(F,A=ce+".__doc__ = "+(this.doc_string||"_b_.None")+";"),n.parent.insert(o+1,F),"module"==te.ntype){var Be=new $Node;new $NodeJSCtx(Be,'$locals["'+this.name+'"] = '+this.name)}n.parent.insert(o+2,$NodeJS("_b_.None;")),this.transformed=!0},$ClassCtx.prototype.to_js=function(){return this.js_processed=!0,"var $"+this.name+"_"+this.random+" = (function()"};var $CompIfCtx=$B.parser.$CompIfCtx=function(n){this.type="comp_if",n.parent.intervals.push($pos),this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$CompIfCtx.prototype.toString=function(){return"(comp if) "+this.tree},$CompIfCtx.prototype.transition=function(n,o){return $transition(this.parent,n,o)},$CompIfCtx.prototype.to_js=function(){return this.js_processed=!0,$to_js(this.tree)};var $ComprehensionCtx=$B.parser.$ComprehensionCtx=function(n){this.type="comprehension",this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$ComprehensionCtx.prototype.toString=function(){return"(comprehension) "+this.tree},$ComprehensionCtx.prototype.transition=function(n,o){var l=this;switch(n){case"if":return new $AbstractExprCtx(new $CompIfCtx(l),!1);case"for":return new $TargetListCtx(new $CompForCtx(l))}return $transition(l.parent,n,o)},$ComprehensionCtx.prototype.to_js=function(){this.js_processed=!0;var n=[];return this.tree.forEach(function(o){n.push(o.start)}),n};var $CompForCtx=$B.parser.$CompForCtx=function(n){this.type="comp_for",n.parent.intervals.push($pos),this.parent=n,this.tree=[],this.expect="in",n.tree[n.tree.length]=this};$CompForCtx.prototype.toString=function(){return"(comp for) "+this.tree},$CompForCtx.prototype.transition=function(n,o){var l=this;return"in"==n&&"in"==l.expect?(l.expect=null,new $AbstractExprCtx(new $CompIterableCtx(l),!0)):null===l.expect?$transition(l.parent,n,o):void $_SyntaxError(l,"token "+n+" after "+l)},$CompForCtx.prototype.to_js=function(){return this.js_processed=!0,$to_js(this.tree)};var $CompIterableCtx=$B.parser.$CompIterableCtx=function(n){this.type="comp_iterable",this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$CompIterableCtx.prototype.toString=function(){return"(comp iter) "+this.tree},$CompIterableCtx.prototype.transition=function(n,o){return $transition(this.parent,n,o)},$CompIterableCtx.prototype.to_js=function(){return this.js_processed=!0,$to_js(this.tree)};var $ConditionCtx=$B.parser.$ConditionCtx=function(n,o){this.type="condition",this.token=o,this.parent=n,this.tree=[],this.scope=$get_scope(this),"while"==o&&(this.loop_num=$loop_num++),n.tree[n.tree.length]=this};$ConditionCtx.prototype.toString=function(){return this.token+" "+this.tree},$ConditionCtx.prototype.transition=function(n,o){var l=this;if(":"==n)return"abstract_expr"==l.tree[0].type&&0==l.tree[0].tree.length&&$_SyntaxError(l,"token "+n+" after "+l),$BodyCtx(l);$_SyntaxError(l,"token "+n+" after "+l)},$ConditionCtx.prototype.transform=function(n,o){if($get_scope(this),"while"==this.token){n.parent.insert(o,$NodeJS('$locals["$no_break'+this.loop_num+'"] = true'));var l=$get_module(this).module;return"return"!=$B.last(n.children).C.tree[0].type&&n.add($NodeJS('$locals.$line_info = "'+n.line_num+","+l+'";if($locals.$f_trace !== _b_.None){$B.trace_line()};_b_.None;')),2}},$ConditionCtx.prototype.to_js=function(){this.js_processed=!0;var n=this.token;"elif"==n&&(n="else if");var o=[n+"($B.$bool("];if("while"==n)o.push('$locals["$no_break'+this.loop_num+'"] && ');else if("else if"==n){var l=$get_node(this).line_num+","+$get_scope(this).id;o.push('($B.set_line("'+l+'")) && ')}return 1==this.tree.length?o.push($to_js(this.tree)+"))"):(o.push(this.tree[0].to_js()+"))"),this.tree[1].tree.length>0&&o.push("{"+this.tree[1].to_js()+"}")),o.join("")};var $ContinueCtx=$B.parser.$ContinueCtx=function(n){this.type="continue",this.parent=n,$get_node(this).is_continue=!0,n.tree[n.tree.length]=this,set_loop_context.apply(this,[n,"continue"])};$ContinueCtx.prototype.toString=function(){return"(continue)"},$ContinueCtx.prototype.transition=function(n,o){var l=this;if("eol"==n)return l.parent;$_SyntaxError(l,"token "+n+" after "+l)},$ContinueCtx.prototype.to_js=function(){this.js_processed=!0;var n="continue";return this.loop_ctx.has_break&&(n=`$locals["$no_break${this.loop_ctx.loop_num}"]=true;${n}`),n};var $DebuggerCtx=$B.parser.$DebuggerCtx=function(n){this.type="continue",this.parent=n,n.tree[n.tree.length]=this};$DebuggerCtx.prototype.toString=function(){return"(debugger)"},$DebuggerCtx.prototype.transition=function(n,o){},$DebuggerCtx.prototype.to_js=function(){return this.js_processed=!0,"debugger"};var $DecoratorCtx=$B.parser.$DecoratorCtx=function(n){this.type="decorator",this.parent=n,n.tree[n.tree.length]=this,this.tree=[]};$DecoratorCtx.prototype.toString=function(){return"(decorator) "+this.tree},$DecoratorCtx.prototype.transition=function(n,o){var l=this;return"id"==n&&0==l.tree.length?$transition(new $AbstractExprCtx(l,!1),n,o):"eol"==n?$transition(l.parent,n):void $_SyntaxError(l,"token "+n+" after "+l)},$DecoratorCtx.prototype.transform=function(n,o){for(var l=o+1,x=n.parent.children,N=[this.tree];;)if(l>=x.length)$_SyntaxError(C,["decorator expects function"]);else if("node_js"==x[l].C.type)l++;else{if("decorator"!=x[l].C.tree[0].type)break;N.push(x[l].C.tree[0].tree),x.splice(l,1)}this.dec_ids=[],N.forEach(function(){this.dec_ids.push("$id"+$B.UUID())},this);var U=x[l].C.tree[0];"def"==U.type&&(U.decorated=!0,U.alias="$dec"+$B.UUID());var G="",A=$get_scope(this),P='$locals["';A.globals&&A.globals.has(U.name)&&(P="$locals_"+$get_module(this).id+'["');var de=(P+=U.name+'"]')+" = ";N.forEach(function(be,te){de+="$B.$call("+this.dec_ids[te]+")(",G+=")"},this),de+=(U.decorated?U.alias:P)+G+";",$bind(U.name,A,this),n.parent.insert(l+1,$NodeJS(de)),this.decorators=N},$DecoratorCtx.prototype.to_js=function(){this.js_processed=!0;var n=[];return this.decorators.forEach(function(o,l){n.push("var "+this.dec_ids[l]+" = "+$to_js(o)+";")},this),n.join("")};var $DefCtx=$B.parser.$DefCtx=function(n){this.type="def",this.name=null,this.parent=n,this.tree=[],this.async=n.async,this.locals=[],n.tree[n.tree.length]=this,this.enclosing=[];var o=this.scope=$get_scope(this);o.C&&"class"==o.C.tree[0].type&&(this.class_name=o.C.tree[0].name),n.node.binding={};for(var l=o;l.C&&"class"==l.C.tree[0].type;)l=l.parent;for(;l.C&&"def"!=l.C.tree[0].type;)l=l.parent;this.parent.node.parent_block=l;var x=l;for(this.is_comp=x.is_comp;x&&x.C;){if("def"==x.C.tree[0].type){this.inside_function=!0;break}x=x.parent_block}this.module=o.module,this.root=$get_module(this),this.num=$loop_num,$loop_num++,this.positional_list=[],this.default_list=[],this.other_args=null,this.other_kw=null,this.after_star=[]};$DefCtx.prototype.set_name=function(n){try{n=$mangle(n,this.parent.tree[0])}catch(x){throw console.log(x),console.log("parent",this.parent),x}var o=new $IdCtx(this,n);this.name=n,this.id=this.scope.id+"_"+n,this.id=this.id.replace(/\./g,"_"),this.id+="_"+$B.UUID(),this.parent.node.id=this.id,this.parent.node.module=this.module,this.binding={};var l=this.scope;void 0!==l.globals&&l.globals.has(n)?$bind(n,this.root,this):$bind(n,l,this),o.bound=!0,l.is_function&&-1==l.C.tree[0].locals.indexOf(n)&&l.C.tree[0].locals.push(n)},$DefCtx.prototype.toString=function(){return"def "+this.name+"("+this.tree+")"},$DefCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":return l.name&&$_SyntaxError(l,"token "+n+" after "+l),l.set_name(o),l;case"(":return null==l.name&&$_SyntaxError(l,"missing name in function definition"),l.has_args=!0,new $FuncArgs(l);case"annotation":return new $AbstractExprCtx(new $AnnotationCtx(l),!0);case":":if(l.has_args)return $BodyCtx(l);$_SyntaxError(l,"missing function parameters");case"eol":l.has_args&&$_SyntaxError(l,"missing colon")}$_SyntaxError(l,"token "+n+" after "+l)},$DefCtx.prototype.transform=function(n,o){if(this.is_comp&&($get_node(this).is_comp=!0),void 0===this.transformed){var l=this.scope;this.doc_string=$get_docstring(n),this.rank=o;var x=n.indent+12;if(this.name.substr(0,15)=="lambda_"+$B.lambda_magic){var N=l.parent_block;N.C&&"def"==N.C.tree[0].type&&this.enclosing.push(N)}for(var U=this.parent.node;U.parent&&U.parent.is_def_func;)this.enclosing.push(U.parent.parent),U=U.parent.parent;var G=[],A=[],P=!1;this.argcount=0,this.kwonlyargcount=0,this.kwonlyargsdefaults=[],this.otherdefaults=[],this.varnames={},this.args=[],this.__defaults__=[],this.slots=[];var de=[],be=[],te=[];this.annotation&&te.push('"return":'+this.annotation.to_js()),this.func_name=this.tree[0].to_js();var ce=this.func_name;this.decorated&&(this.func_name="var "+this.alias,ce=this.alias),this.tree[1].tree.forEach(function(sr){if("end_positional"==sr.type?(this.args.push("/"),de.push('"/"'),P=!0):(this.args.push(sr.name),this.varnames[sr.name]=!0),"func_arg_id"==sr.type?(this.star_arg?(this.kwonlyargcount++,sr.has_default&&this.kwonlyargsdefaults.push(sr.name)):(this.argcount++,sr.has_default&&this.otherdefaults.push(sr.name)),this.slots.push(sr.name+":null"),de.push('"'+sr.name+'"'),be.push(sr.name+":"+sr.name),sr.tree.length>0&&(G.push('"'+sr.name+'"'),A.push(sr.name+":"+$to_js(sr.tree)),this.__defaults__.push($to_js(sr.tree)))):"func_star_arg"==sr.type&&("*"==sr.op?this.star_arg=sr.name:"**"==sr.op&&(this.kw_arg=sr.name)),sr.annotation){var ei=$mangle(sr.name,this);te.push(ei+": "+sr.annotation.to_js())}},this),be="{"+be.join(", ")+"}";var fe=67;this.star_arg&&(fe|=4),this.kw_arg&&(fe|=8),"generator"==this.type&&(fe|=32),this.async&&(fe|=128);for(var _e=[],le=l;le.parent_block&&"__builtins__"!==le.parent_block.id;)le=le.parent_block;var pe="$locals_"+le.id.replace(/\./g,"_"),T=this.name+this.num,B="$locals_"+this.id;F="var "+B+" = {},"+(ft="\n"+" ".repeat(x))+"$locals = "+B+";",(Be=new $Node).locals_def=!0,Be.func_node=n,new $NodeJSCtx(Be,F),_e.push(Be);var q=[$NodeJS('$locals.$line_info = "'+n.line_num+","+this.module+'"'),$NodeJS(`var $top_frame=["${this.id}",$locals,"`+le.id+'", '+pe+", "+(this.is_comp?this.name:T)+"]"),$NodeJS("$locals.$f_trace = $B.enter_frame($top_frame)"),$NodeJS("var $stack_length = $B.frames_stack.length;")];"generator"==this.type&&q.push($NodeJS("$locals.$is_generator = true")),this.async&&q.splice(1,0,$NodeJS(`$locals.$async="${this.id}"`)),q.forEach(function(sr){sr.enter_frame=!0}),this.is_comp&&_e.push($NodeJS("var $defaults = {}")),this.env=[];var ee=[],F=B+' = $locals = $B.args("'+this.name+'", '+this.argcount+", {"+this.slots.join(", ")+"}, ["+de.join(", ")+"], arguments, $defaults, "+this.other_args+", "+this.other_kw+");",Be=new $Node;new $NodeJSCtx(Be,F),ee.push(Be);var K=!1;if(null!==this.other_args||null!==this.other_kw||0!=this.after_star.length||P)_e.push(ee[0]),ee.length>1&&_e.push(ee[1]);else{K=!0,_e.push($NodeJS("var $len = arguments.length;")),Be=new $Node,new $NodeJSCtx(Be,F="if($len > 0 && arguments[$len - 1].$nat !== undefined)"),_e.push(Be),ee.forEach(function(sr){Be.add(sr)});var ve=new $Node;new $NodeJSCtx(ve,"else"),_e.push(ve);var Ae=this.slots.length,Fe=$NodeJS("if($len == "+Ae+")");ve.add(Fe),Fe.add($NodeJS(B+" = $locals = "+be)),ve.add($NodeJS("else if($len > "+Ae+'){$B.wrong_nb_args("'+this.name+'", $len, '+Ae+", ["+de+"])}")),Ae>0&&(ve.add($NodeJS("else if($len + Object.keys($defaults).length < "+Ae+'){$B.wrong_nb_args("'+this.name+'", $len, '+Ae+", ["+de+"])}")),subelse_node=$NodeJS("else"),ve.add(subelse_node),subelse_node.add($NodeJS(B+" = $locals = "+be)),subelse_node.add($NodeJS("var defparams = ["+de+"]")),subelse_node.add($NodeJS("for(var i = $len; i < defparams.length; i++){$locals[defparams[i]] = $defaults[defparams[i]]}")))}_e=_e.concat(q),"class"==l.ntype&&(class_ref="$locals_"+l.parent_block.id.replace(/\./g,"_")+"."+l.C.tree[0].qualname,this.parent.node.binding.__class__=!0,_e.push($NodeJS("$locals.__class__ = "+class_ref))),_e.push($NodeJS("$B.js_this = this;"));for(var Ee=_e.length-1;Ee>=0;Ee--)n.children.splice(0,0,_e[Ee]);var qe=new $Node;this.params="",K&&(this.params=Object.keys(this.varnames).join(", ")),new $NodeJSCtx(qe,""),qe.is_def_func=!0,qe.module=this.module;var Ke=n.children[n.children.length-1];x=Ke.indent,"return"!=Ke.C.tree[0].type&&(F="if($locals.$f_trace !== _b_.None){\n"+"    ".repeat(x)+"$B.trace_return(_b_.None)\n"+"    ".repeat(x)+"}\n"+"    ".repeat(x),F+="$B.leave_frame","$exec"==this.id.substr(0,5)&&(F+="_exec"),n.add($NodeJS(F+="({$locals});return _b_.None")));var gt=[];if(this.parent.node.referenced)for(var at in this.parent.node.referenced)this.parent.node.binding[at]||gt.push('"'+at+'"');n.add(qe);var Ct=1;if(x=n.indent,!this.is_comp){n.parent.insert(o+Ct++,$NodeJS(T+".$is_func = true")),this.$has_yield_in_cm&&n.parent.insert(o+Ct++,$NodeJS(T+".$has_yield_in_cm = true")),n.parent.insert(o+Ct++,$NodeJS(T+".$infos = {"));var wt=this.name;"$$"==this.name.substr(0,2)&&(wt=wt.substr(2)),wt.substr(0,15)=="lambda_"+$B.lambda_magic&&(wt="<lambda>"),n.parent.insert(o+Ct++,$NodeJS(F='    __name__:"'+wt+'",'));var Ft=wt;if(this.class_name&&(Ft=this.class_name+"."+wt),n.parent.insert(o+Ct++,$NodeJS(F='    __qualname__:"'+Ft+'",')),this.otherdefaults.length>0){var Ot=[];this.otherdefaults.forEach(function(sr){Ot.push("$defaults."+sr)}),n.parent.insert(o+Ct++,$NodeJS("    __defaults__ : $B.fast_tuple(["+Ot.join(", ")+"]),"))}else n.parent.insert(o+Ct++,$NodeJS("    __defaults__ : _b_.None,"));this.kwonlyargsdefaults.lengh>0?(Ot=[],this.kwonlyargsdefaults.forEach(function(sr){Ot.push("$defaults."+sr)}),n.parent.insert(o+Ct++,$NodeJS("    __kwdefaults__ : $B.fast_tuple(["+Ot.join(", ")+"]),"))):n.parent.insert(o+Ct++,$NodeJS("    __kwdefaults__ : _b_.None,")),n.parent.insert(o+Ct++,$NodeJS("    __annotations__: {"+te.join(",")+"},")),n.parent.insert(o+Ct++,$NodeJS("    __dict__: $B.empty_dict(),")),n.parent.insert(o+Ct++,$NodeJS("    __doc__: "+(this.doc_string||"_b_.None")+","));var rn=$get_module(this);for(var at in n.parent.insert(o+Ct++,$NodeJS('    __module__ : "'+rn.module+'",')),this.binding)this.varnames[at]=!0;var ft,Tn=[];for(var at in this.varnames)Tn.push('"'+$B.from_alias(at)+'"');F="    __code__:{"+(ft="\n"+" ".repeat(x+8))+"    co_argcount:"+this.argcount;var Cn=","+ft+" ".repeat(4);F+=Cn+"co_filename:$locals_"+$get_module(this).module.replace(/\./g,"_")+'["__file__"] || "<string>"'+Cn+"co_firstlineno:"+n.line_num+Cn+"co_flags:"+fe+Cn+"co_freevars: ["+gt+"]"+Cn+"co_kwonlyargcount:"+this.kwonlyargcount+Cn+'co_name: "'+this.name+'"'+Cn+"co_nlocals: "+Tn.length+Cn+"co_posonlyargcount: "+(this.pos_only||0)+Cn+"co_varnames: $B.fast_tuple(["+Tn.join(", ")+"])"+ft+"}\n"+" ".repeat(x+4)+"};",n.parent.insert(o+Ct++,$NodeJS(F+="_b_.None;"))}if(this.default_str="{"+A.join(", ")+"}",!this.is_comp){var mn=T;"generator"==this.type&&(mn=`$B.generator.$factory(${T})`);var Pn="return "+mn;this.async&&(Pn="generator"==this.type?`return $B.async_generator.$factory(${T})`:"return $B.make_async("+mn+")"),n.parent.insert(o+Ct++,$NodeJS(Pn+"}")),n.parent.insert(o+Ct++,$NodeJS(this.func_name+" = "+this.name+"$"+this.num+"("+this.default_str+")")),n.parent.insert(o+Ct++,$NodeJS(ce+".$set_defaults = function(value){return "+ce+" = "+this.name+"$"+this.num+"(value)}")),this.$has_yield_in_cm&&n.parent.insert(o+Ct++,$NodeJS(`${ce}.$has_yield_in_cm=true`))}for(var $n=n,gn=0;gn<$n.children.length&&$n.children[gn]!==$B.last(q);gn++);var ur=$NodeJS("try"),or=$n.children.slice(gn+1);$n.insert(gn+1,ur),or.forEach(function(sr){sr.is_def_func?sr.children.forEach(function(ei){ur.add(ei)}):ur.add(sr)}),$n.children.splice(gn+2,$n.children.length);var hr=$NodeJS("catch(err)");return hr.add($NodeJS("$B.set_exc(err)")),hr.add($NodeJS("if($locals.$f_trace !== _b_.None){$locals.$f_trace = $B.trace_exception()}")),hr.add($NodeJS("$B.leave_frame({$locals});throw err")),$n.add(hr),this.transformed=!0,Ct}},$DefCtx.prototype.to_js=function(n){return this.js_processed=!0,this.is_comp?"var "+this.name+" = "+(this.async?" async ":"")+"function* (expr)":(n=n||this.tree[0].to_js(),this.decorated&&(n="var "+this.alias),"var "+this.name+"$"+this.num+" = function($defaults){"+(this.async?"async ":"")+"function"+("generator"==this.type?"* ":" ")+this.name+this.num+"("+this.params+")")};var $DelCtx=$B.parser.$DelCtx=function(n){this.type="del",this.parent=n,n.tree[n.tree.length]=this,this.tree=[]};$DelCtx.prototype.toString=function(){return"del "+this.tree},$DelCtx.prototype.transition=function(n,o){var l=this;if("eol"==n)return $transition(l.parent,n);$_SyntaxError(l,"token "+n+" after "+l)},$DelCtx.prototype.to_js=function(){this.js_processed=!0;var n=this.parent;if("list_or_tuple"==this.tree[0].type){var o=[];return this.tree[0].tree.forEach(function(U){var G=new $DelCtx(n);G.tree=[U],o.push(G.to_js()),n.tree.pop()}),this.tree=[],o.join(";")}if("expr"==this.tree[0].type&&"list_or_tuple"==this.tree[0].tree[0].type)return this.tree[0]=this.tree[0].tree[0],this.to_js();var l=this.tree[0].tree[0];switch(l.type){case"id":var x=$get_scope(this),N=!1;if(("def"==x.ntype||"generator"==x.ntype)&&x.globals&&x.globals.has(l.value)){for(x=x.parent;x.parent&&"__builtins__"!==x.parent.id;)x=x.parent;N=!0}return o='$B.$delete("'+l.value+'"'+(N?', "global"':"")+");",delete x.binding[l.value],o;case"list_or_tuple":return o=[],l.tree.forEach(function(U){o.push("delete "+U.to_js())}),o.join(";");case"sub":return l.func="delitem",js=l.to_js(),l.func="getitem",js;case"op":$_SyntaxError(this,["cannot delete operator"]);case"call":$_SyntaxError(this,["cannot delete function call"]);case"attribute":return"_b_.delattr("+l.value.to_js()+',"'+l.name+'")';default:$_SyntaxError(this,["cannot delete "+l.type])}};var $DictOrSetCtx=$B.parser.$DictOrSetCtx=function(n){this.type="dict_or_set",this.real="dict_or_set",this.expect="id",this.closed=!1,this.start=$pos,this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$DictOrSetCtx.prototype.toString=function(){switch(this.real){case"dict":return"(dict) {"+this.items+"}";case"set":return"(set) {"+this.tree+"}"}return"(dict_or_set) {"+this.tree+"}"},$DictOrSetCtx.prototype.transition=function(n,o){var l=this;if(l.closed){switch(n){case"[":return new $AbstractExprCtx(new $SubCtx(l.parent),!1);case"(":return new $CallArgCtx(new $CallCtx(l.parent))}return $transition(l.parent,n,o)}if(","==l.expect){switch(n){case"}":switch(l.real){case"dict_or_set":if(1!=l.tree.length)break;l.real="set";case"set":case"set_comp":case"dict_comp":return l.items=l.tree,l.tree=[],l.closed=!0,l;case"dict":if(l.nb_dict_items()%2==0)return l.items=l.tree,l.tree=[],l.closed=!0,l}$_SyntaxError(l,"token "+n+" after "+l);case",":return"dict_or_set"==l.real&&(l.real="set"),"dict"==l.real&&l.nb_dict_items()%2&&$_SyntaxError(l,"token "+n+" after "+l),l.expect="id",l;case":":if("dict_or_set"==l.real&&(l.real="dict"),"dict"==l.real)return l.expect=",",new $AbstractExprCtx(l,!1);$_SyntaxError(l,"token "+n+" after "+l);case"for":l.real="dict_or_set"==l.real?"set_comp":"dict_comp";var x=new $ListOrTupleCtx(l,"dict_or_set_comp");x.intervals=[l.start+1],x.vars=l.vars,l.tree.pop(),x.expression=l.tree,l.yields&&(x.expression.yields=l.yields,delete l.yields),l.tree=[x],x.tree=[];var N=new $ComprehensionCtx(x);return new $TargetListCtx(new $CompForCtx(N))}$_SyntaxError(l,"token "+n+" after "+l)}else if("id"==l.expect){switch(n){case"}":return 0==l.tree.length?(l.items=[],l.real="dict"):l.items=l.tree,l.tree=[],l.closed=!0,l;case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case".":case"not":case"lambda":l.expect=",";var U=new $AbstractExprCtx(l,!1);return $transition(U,n,o);case"op":switch(o){case"*":case"**":return l.expect=",",(U=new $AbstractExprCtx(l,!1)).packed=o.length,"dict_or_set"==l.real?l.real="*"==o?"set":"dict":("set"==l.real&&"**"==o||"dict"==l.real&&"*"==o)&&$_SyntaxError(l,"token "+n+" after "+l),U;case"+":return l;case"-":case"~":l.expect=",";var G=new $UnaryCtx(l,o);if("-"==o)var A=new $OpCtx(G,"unary_neg");else A=new $OpCtx(G,"+"==o?"unary_pos":"unary_inv");return new $AbstractExprCtx(A,!1)}$_SyntaxError(l,"token "+n+" after "+l)}$_SyntaxError(l,"token "+n+" after "+l)}return $transition(l.parent,n,o)},$DictOrSetCtx.prototype.nb_dict_items=function(){var n=0;return this.tree.forEach(function(o){o.packed?n+=2:n++}),n},$DictOrSetCtx.prototype.packed_indices=function(){var n=[];return this.items.forEach(function(o,l){"expr"==o.type&&o.packed&&n.push(l)}),n},$DictOrSetCtx.prototype.unpack_dict=function(n){for(var o,l,x,N="",U=0;U<this.items.length;)l=0==U,"expr"==(x=this.items[U]).type&&x.packed?(o="_b_.list.$factory(_b_.dict.items("+x.to_js()+"))",U++):(o="[["+x.to_js()+","+this.items[U+1].to_js()+"]]",U+=2),l||(o=".concat("+o+")"),N+=o;return N},$DictOrSetCtx.prototype.unpack_set=function(n){var o,l="";return this.items.forEach(function(x,N){o=n.indexOf(N)>-1?"_b_.list.$factory("+x.to_js()+")":"["+x.to_js()+"]",N>0&&(o=".concat("+o+")"),l+=o}),l},$DictOrSetCtx.prototype.to_js=function(){switch(this.js_processed=!0,this.real){case"dict":if((l=this.packed_indices()).length>0)return"_b_.dict.$factory("+this.unpack_dict(l)+")"+$to_js(this.tree);for(var n=[],o=0;o<this.items.length;o+=2)n.push("["+this.items[o].to_js()+","+this.items[o+1].to_js()+"]");return"_b_.dict.$factory(["+n.join(",")+"])"+$to_js(this.tree);case"set_comp":return"_b_.set.$factory("+$to_js(this.items)+")"+$to_js(this.tree);case"dict_comp":return"_b_.dict.$factory("+$to_js(this.items)+")"+$to_js(this.tree)}var l;return(l=this.packed_indices()).length>0?"_b_.set.$factory("+this.unpack_set(l)+")":"_b_.set.$factory(["+$to_js(this.items)+"])"+$to_js(this.tree)};var $DoubleStarArgCtx=$B.parser.$DoubleStarArgCtx=function(n){this.type="double_star_arg",this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$DoubleStarArgCtx.prototype.toString=function(){return"**"+this.tree},$DoubleStarArgCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case".":case"not":case"lambda":return $transition(new $AbstractExprCtx(l,!1),n,o);case",":case")":return $transition(l.parent,n);case":":if("lambda"==l.parent.parent.type)return $transition(l.parent.parent,n)}$_SyntaxError(l,"token "+n+" after "+l)},$DoubleStarArgCtx.prototype.to_js=function(){return this.js_processed=!0,'{$nat:"pdict",arg:'+$to_js(this.tree)+"}"};var $EllipsisCtx=$B.parser.$EllipsisCtx=function(n){this.type="ellipsis",this.parent=n,this.nbdots=1,this.start=$pos,n.tree[n.tree.length]=this};$EllipsisCtx.prototype.toString=function(){return"ellipsis"},$EllipsisCtx.prototype.transition=function(n,o){var l=this;return"."==n?(l.nbdots++,3==l.nbdots&&$pos-l.start==2&&(l.$complete=!0),l):l.$complete?$transition(l.parent,n,o):($pos--,void $_SyntaxError(l,"token "+n+" after "+l))},$EllipsisCtx.prototype.to_js=function(){return this.js_processed=!0,'$B.builtins["Ellipsis"]'};var $EndOfPositionalCtx=$B.parser.$EndOfConditionalCtx=function(n){this.type="end_positional",this.parent=n,n.has_end_positional=!0,n.parent.pos_only=n.tree.length,n.tree.push(this)};$EndOfPositionalCtx.prototype.transition=function(n,o){var l=this;if(","==n||")"==n)return $transition(l.parent,n,o);$_SyntaxError(l,"token "+n+" after "+l)},$EndOfPositionalCtx.prototype.to_js=function(){return"/"};var $ExceptCtx=$B.parser.$ExceptCtx=function(n){this.type="except",this.parent=n,n.tree[n.tree.length]=this,this.tree=[],this.expect="id",this.scope=$get_scope(this)};$ExceptCtx.prototype.toString=function(){return"(except) "},$ExceptCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case"not":case"lambda":if("id"==l.expect)return l.expect="as",$transition(new $AbstractExprCtx(l,!1),n,o);case"as":if("as"==l.expect&&void 0===l.has_alias)return l.expect="alias",l.has_alias=!0,l;case"id":if("alias"==l.expect)return l.expect=":",l.set_alias(o),l;break;case":":var x=l.expect;if("id"==x||"as"==x||":"==x)return $BodyCtx(l);break;case"(":if("id"==l.expect&&0==l.tree.length)return l.parenth=!0,l;break;case")":if(","==l.expect||"as"==l.expect)return l.expect="as",l;case",":if(void 0!==l.parenth&&void 0===l.has_alias&&("as"==l.expect||","==l.expect))return l.expect="id",l}$_SyntaxError(l,"token "+n+" after "+l.expect)},$ExceptCtx.prototype.set_alias=function(n){this.tree[0].alias=$mangle(n,this),$bind(n,this.scope,this)},$ExceptCtx.prototype.transform=function(n,o){var l=$NodeJS("void(0)");l.line_num=n.line_num,n.insert(0,l);var x=$B.last(n.children);x.C.tree&&x.C.tree[0]&&"return"==x.C.tree[0].type||n.add($NodeJS("$B.del_exc()"))},$ExceptCtx.prototype.to_js=function(){switch(this.js_processed=!0,this.tree.length){case 0:return"else";case 1:if("Exception"==this.tree[0].name)return"else if(1)"}var n=[];this.tree.forEach(function(x){n.push(x.to_js())});var o="";if($B.debug>0){var l=$get_module(this);o='($locals.$line_info = "'+$get_node(this).line_num+","+l.id+'") && '}return"else if("+o+"$B.is_exc("+this.error_name+",["+n.join(",")+"]))"};var $ExprCtx=$B.parser.$ExprCtx=function(n,o,l){if(this.type="expr",this.name=o,this.with_commas=l,this.expect=",",this.parent=n,n.packed&&(this.packed=n.packed),n.is_await){var x=$get_node(this);x.has_await=x.has_await||[],this.is_await=n.is_await,x.has_await.push(this)}n.assign&&(this.assign=n.assign),this.tree=[],n.tree[n.tree.length]=this};$ExprCtx.prototype.toString=function(){return"(expr "+this.with_commas+") "+this.tree},$ExprCtx.prototype.transition=function(n,o){var l=this;switch(n){case"bytes":case"float":case"id":case"imaginary":case"int":case"lambda":case"pass":case"str":$_SyntaxError(l,"token "+n+" after "+l);break;case"{":return"id"==l.tree[0].type&&-1!=["print","exec"].indexOf(l.tree[0].value)||$_SyntaxError(l,"token "+n+" after "+l),new $DictOrSetCtx(l);case"[":case"(":case".":case"not":if("expr"==l.expect)return l.expect=",",$transition(new $AbstractExprCtx(l,!1),n,o)}switch(n){case"not":if(","==l.expect)return new $ExprNot(l);break;case"in":if("target_list"==l.parent.type)return $transition(l.parent,n);if(","==l.expect)return $transition(l,"op","in");break;case",":if(","==l.expect&&(l.with_commas||["assign","return"].indexOf(l.parent.type)>-1)){$parent_match(l,{type:"yield",from:!0})&&$_SyntaxError(l,"no implicit tuple for yield from"),l.parent.tree.pop();var x=new $ListOrTupleCtx(l.parent,"tuple");return x.implicit=!0,x.has_comma=!0,x.tree=[l],l.parent=x,x}return $transition(l.parent,n);case".":return new $AttrCtx(l);case"[":return new $AbstractExprCtx(new $SubCtx(l),!0);case"(":return new $CallCtx(l);case"op":var N=l.parent,U=o;if("ternary"==N.type&&N.in_else){var G=new $OpCtx(l,U);return new $AbstractExprCtx(G,!1)}for(var A=l.parent,P=null;;)if("expr"==A.type)A=A.parent;else if("op"==A.type&&$op_weight[A.op]>=$op_weight[U]&&("**"!=A.op||"**"!=U))P=A,A=A.parent;else{if(!("not"==A.type&&$op_weight.not>$op_weight[U]))break;P=A,A=A.parent}if(null===P){for(;l.parent!==A;)N=(l=l.parent).parent;var de;return l.parent.tree.pop(),(de=new $ExprCtx(N,"operand",l.with_commas)).expect=",",l.parent=de,G=new $OpCtx(l,U),new $AbstractExprCtx(G,!1)}if("and"===U||"or"===U)for(;"not"==P.parent.type||"expr"==P.parent.type&&"not"==P.parent.parent.type;)N=(P=P.parent).parent;if("op"==P.type){var be=!1;switch(P.op){case"<":case"<=":case"==":case"!=":case"is":case">=":case">":be=!0}if(be)switch(U){case"<":case"<=":case"==":case"!=":case"is":case">=":case">":var te=P.tree[1],ce=te.to_js(),fe=new Object;for(var _e in te)fe[_e]=te[_e];var le="$c"+chained_comp_num;for(te.to_js=function(){return le},fe.to_js=function(){return le},chained_comp_num++;P.parent&&"op"==P.parent.type&&$op_weight[P.parent.op]<$op_weight[P.op];)P=P.parent;P.parent.tree.pop();var pe=new $OpCtx(P,"and");return pe.wrap={name:le,js:ce},fe.parent=pe,pe.tree.push("xxx"),G=new $OpCtx(fe,U),new $AbstractExprCtx(G,!1)}}return P.parent.tree.pop(),(de=new $ExprCtx(P.parent,"operand",!1)).tree=[A],P.parent=de,G=new $OpCtx(P,U),new $AbstractExprCtx(G,!1);case"augm_assign":for(var T=l.parent;T;)"assign"==T.type||"augm_assign"==T.type?$_SyntaxError(l,"augmented assignment inside assignment"):"op"==T.type&&$_SyntaxError(l,["cannot assign to operator"]),T=T.parent;return","==l.expect?new $AbstractExprCtx(new $AugmentedAssignCtx(l,o),!0):$transition(l.parent,n,o);case":":if("sub"==l.parent.type||"list_or_tuple"==l.parent.type&&"sub"==l.parent.parent.type)return new $AbstractExprCtx(new $SliceCtx(l.parent),!1);if("slice"==l.parent.type)return $transition(l.parent,n,o);if("node"==l.parent.type){if(1==l.tree.length){var B=l.tree[0];if(["id","sub","attribute"].indexOf(B.type)>-1)return new $AbstractExprCtx(new $AnnotationCtx(l),!1);if("tuple"==B.real&&","==B.expect&&1==B.tree.length)return new $AbstractExprCtx(new $AnnotationCtx(B.tree[0]),!1)}$_SyntaxError(l,"invalid target for annotation")}break;case"=":var q;if(","==l.expect){if("call_arg"==l.parent.type)return"id"!=l.tree[0].type&&$_SyntaxError(l,['expression cannot contain assignment, perhaps you meant "=="?']),new $AbstractExprCtx(new $KwArgCtx(l),!0);if(q=function(Ke){for(;Ke.parent;){if("annotation"==Ke.parent.type)return Ke.parent;Ke=Ke.parent}return!1}(l))return $transition(q,n,o);if("op"==l.parent.type)$_SyntaxError(l,["cannot assign to operator"]);else if("not"==l.parent.type)$_SyntaxError(l,["cannot assign to operator"]);else if("list_or_tuple"==l.parent.type)for(var ee=0;ee<l.parent.tree.length;ee++){var F=l.parent.tree[ee];"expr"==F.type&&"operand"==F.name&&$_SyntaxError(l,["cannot assign to operator"])}else l.tree.length>0&&l.tree[0].assign?$_SyntaxError(l,["cannot assign to named expression"]):"expr"==l.parent.type&&"target list"==l.parent.name?$_SyntaxError(l,"token "+n+" after "+l):"lambda"==l.parent.type&&"node"!=l.parent.parent.parent.type&&$_SyntaxError(l,['expression cannot contain assignment, perhaps you meant "=="?']);for(;void 0!==l.parent;)"condition"==(l=l.parent).type?$_SyntaxError(l,"token "+n+" after "+l):"augm_assign"==l.type&&$_SyntaxError(l,"assignment inside augmented assignment");return new $AbstractExprCtx(new $AssignCtx(l=l.tree[0]),!0)}break;case":=":var Be=l.parent.type;if(["node","assign","kwarg","annotation"].indexOf(Be)>-1||"func_arg_id"==Be&&l.parent.tree.length>0?$_SyntaxError(l,":= invalid, parent "+Be):"call_arg"==Be&&"call"==l.parent.parent.type&&"lambda"==l.parent.parent.parent.type&&$_SyntaxError(l,":= invalid inside function arguments"),1==l.tree.length&&"id"==l.tree[0].type){for(var K=$get_scope(l),ve=l.tree[0].value;K.is_comp;)K=K.parent_block;$bind(ve,K,l),(T=l.parent).tree.pop();var Ae=new $AbstractExprCtx(T,!1);return Ae.assign=l.tree[0],Ae}$_SyntaxError(l,"token "+n+" after "+l);case"if":for(var Fe=!1,Ee=l.parent;"list_or_tuple"!=Ee.type;){if("comp_for"==Ee.type||"comp_if"==Ee.type){Fe=!0;break}if("call_arg"==Ee.type||void 0===Ee.parent)break;Ee=Ee.parent}if(Fe)break;for(Ee=l;Ee.parent&&("op"==Ee.parent.type||"expr"==Ee.parent.type&&"operand"==Ee.parent.name);)Ee=Ee.parent;return new $AbstractExprCtx(new $TernaryCtx(Ee),!0);case"eol":if(2==l.tree.length&&"id"==l.tree[0].type&&["print","exec"].indexOf(l.tree[0].value)>-1&&$_SyntaxError(l,["Missing parentheses in call to '"+l.tree[0].value+"'."]),-1==["dict_or_set","list_or_tuple"].indexOf(l.parent.type)){var qe=l.tree[0];("packed"==qe.type||"call"==qe.type&&"packed"==qe.func.type)&&$_SyntaxError(l,["can't use starred expression here"])}}return $transition(l.parent,n)},$ExprCtx.prototype.to_js=function(n){var o;if(this.js_processed=!0,o="list"==this.type?"["+$to_js(this.tree)+"]":1==this.tree.length?this.tree[0].to_js(n):"_b_.tuple.$factory(["+$to_js(this.tree)+"])",this.is_await&&(o="await ($B.promise("+o+"))"),this.assign){for(var l=$get_scope(this);l.is_comp;)l=l.parent_block;if(l.globals&&l.globals.has(this.assign.value))for(;l.parent_block&&"__builtins__"!==l.parent_block.id;)l=l.parent_block;else l.nonlocals&&l.nonlocals[this.assign.value]&&(l=l.parent_block);o="($locals_"+l.id.replace(/\./g,"_")+'["'+this.assign.value+'"] = '+o+")"}return o};var $ExprNot=$B.parser.$ExprNot=function(n){this.type="expr_not",this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$ExprNot.prototype.transition=function(n,o){var l=this;if("in"==n)return l.parent.tree.pop(),new $AbstractExprCtx(new $OpCtx(l.parent,"not_in"),!1);$_SyntaxError(l,"token "+n+" after "+l)},$ExprNot.prototype.toString=function(){return"(expr_not)"};var $ForExpr=$B.parser.$ForExpr=function(n){n.node.parent.is_comp&&(n.node.parent.first_for=this),this.type="for",this.parent=n,this.tree=[],n.tree[n.tree.length]=this,this.loop_num=$loop_num,this.scope=$get_scope(this),this.module=this.scope.module,$loop_num++};$ForExpr.prototype.toString=function(){return"(for) "+this.tree},$ForExpr.prototype.transition=function(n,o){var l=this;switch(n){case"in":return 0==l.tree[0].tree.length&&$_SyntaxError(l,"missing target between 'for' and 'in'"),new $AbstractExprCtx(new $ExprCtx(l,"target list",!0),!1);case":":return(l.tree.length<2||"abstract_expr"==l.tree[1].tree[0].type)&&$_SyntaxError(l,"token "+n+" after "+l),$BodyCtx(l)}$_SyntaxError(l,"token "+n+" after "+l)},$ForExpr.prototype.transform=function(n,o){for(var l=this.parent.node.parent;l;){if(l.is_comp){var x=$get_module(this);void 0===x.outermost_expr&&(l.outermost_expr=this.tree[1],x.outermost_expr=this.tree[1],this.tree.pop(),new $RawJSCtx(this,"expr"));break}l=l.parent}if(this.async)return this.transform_async(n,o);var N=$get_scope(this),U=this.tree[0],G=1==U.tree.length&&"id"==U.expect,A=this.tree[1],P=this.loop_num,de="$locals_"+N.id.replace(/\./g,"_"),be="\n"+" ".repeat(n.indent+4),te=!1;if(1==U.tree.length&&!N.blurred&&"id"!=U.expct&&"expr"==A.type&&"expr"==A.tree[0].type&&"call"==A.tree[0].tree[0].type){var ce=A.tree[0].tree[0];"id"==ce.func.type&&"range"==ce.func.value&&ce.tree.length<3&&ce.tree.length>0&&(te=ce)}var fe=[],_e=0,le=n.children;if(te){this.has_break&&(Ct=new $Node,new $NodeJSCtx(Ct,de+'["$no_break'+P+'"] = true'),fe[_e++]=Ct);for(var pe,T=$get_scope(this),B=[];T.binding.range&&B.push(T.id),T.parent_block;)T=T.parent_block;pe=1==B.length&&"__builtins__"==B[0];var q=new $Node;q.module=n.parent.module,new $NodeJSCtx(q,pe?"if(1)":"if("+ce.func.to_js()+" === _b_.range)"),fe[_e++]=q;var ee=U.to_js(),F=!1;if(1==te.tree.length){if("int"==(ve=te.tree[0].tree[0]).tree[0].type&&0<(ve=parseInt(ve.to_js()))<$B.max_int){F=!0;var Be="$i"+$B.UUID();(Fe=$NodeJS("for (var "+Be+" = 0; "+Be+" < "+ve+"; "+Be+"++)")).add($NodeJS(ee+" = "+Be))}var K=0,ve=te.tree[0].to_js()}else K=te.tree[0].to_js(),ve=te.tree[1].to_js();if(!F){var Ae="var $stop_"+P+" = $B.int_or_bool("+ve+"),"+be+"        $next"+P+" = "+K+","+be+"        $safe"+P+" = typeof $next"+P+' == "number" && typeof $stop_'+P+' == "number";'+be+"    while(true)",Fe=new $Node;new $NodeJSCtx(Fe,Ae),Fe.add($NodeJS("if($safe"+P+" && $next"+P+">= $stop_"+P+"){break}")),Fe.add($NodeJS("else if(!$safe"+P+" && $B.ge($next"+P+", $stop_"+P+")){break}")),Fe.add($NodeJS(ee+" = $next"+P)),Fe.add($NodeJS("if($safe"+P+"){$next"+P+" += 1}")),Fe.add($NodeJS("else{$next"+P+" = $B.add($next"+P+",1)}"))}le.forEach(function(Pn){Fe.add(Pn.clone_tree())}),"return"!=$B.last(n.children).C.tree[0].type&&Fe.add($NodeJS(Ae='$locals.$line_info = "'+n.line_num+","+this.module+'";if($locals.$f_trace !== _b_.None){$B.trace_line()};_b_.None;'));var Ee=!1;if("module"==N.ntype)for(l=n.parent;l;){if(l.for_wrapper){Ee=!0;break}l=l.parent}if("module"!=N.ntype||Ee)q.add(Fe);else{var qe=new $Node;qe.for_wrapper=!0,Ae="function $f"+P+"(",this.has_break&&(Ae+="$no_break"+P),new $NodeJSCtx(qe,Ae+=")"),q.add(qe),qe.add(Fe),this.has_break&&qe.add($NodeJS("return $no_break"+P)),q.add($NodeJS("var $res"+P+" = $f"+P+"();")),this.has_break&&q.add($NodeJS("var $no_break"+P+" = $res"+P))}if(pe){n.parent.children.splice(o,1);var Ke=0;return this.has_break&&(n.parent.insert(o,fe[0]),Ke++),fe[Ke].children.forEach(function(Pn){n.parent.insert(o+Ke,Pn)}),n.parent.children[o].line_num=n.line_num,n.parent.children[o].bindings=n.bindings,n.children=[],0}var gt=$NodeJS("else");fe[_e++]=gt;for(var at=fe.length-1;at>=0;at--)n.parent.insert(o+1,fe[at]);this.test_range=!0,fe=[],_e=0}var Ct=new $Node;Ct.line_num=$get_node(this).line_num;var wt=A.to_js(),Ft="$iter"+P;new $NodeJSCtx(Ct,Ae="var "+Ft+" = "+wt+';$locals["$next'+P+'"] = $B.$getattr($B.$iter('+Ft+'),"__next__")'),fe[_e++]=Ct,this.has_break&&(fe[_e++]=$NodeJS(de+'["$no_break'+P+'"] = true;'));var Ot=new $Node;if(new $NodeJSCtx(Ot,Ae=this.has_break?"while("+de+'["$no_break'+P+'"])':"while(true)"),Ot.C.loop_num=P,Ot.C.type="for",fe[_e++]=Ot,n.parent.children.splice(o,1),this.test_range)for(at=fe.length-1;at>=0;at--)gt.insert(0,fe[at]);else for(at=fe.length-1;at>=0;at--)n.parent.insert(o,fe[at]);var rn=$NodeJS("try");rn.bindings=n.bindings,Ot.add(rn);var ft=new $Node;ft.id=this.module;var Tn=new $NodeCtx(ft),Cn=new $ExprCtx(Tn,"left",!0);if(G){var mn=new $ListOrTupleCtx(Cn);mn.real="tuple",mn.tree=U.tree}else Cn.tree=U.tree;return new $AssignCtx(Cn).tree[1]=new $JSCode('$locals["$next'+P+'"]()'),rn.add(ft),Ot.add($NodeJS("catch($err){if($B.is_exc($err, [_b_.StopIteration])){break;}else{throw($err)}}")),le.forEach(function(Pn){Ot.add(Pn.clone())}),0==n.children.length&&console.log("bizarre",this),"return"!=$B.last(n.children).C.tree[0].type&&Ot.add($NodeJS(Ae='$locals.$line_info = "'+n.line_num+","+this.module+'";if($locals.$f_trace !== _b_.None){$B.trace_line()};_b_.None;')),n.children=[],0},$ForExpr.prototype.transform_async=function(n,o){var l=$get_scope(this),x=this.tree[0],N=this.tree[1],U=this.loop_num,G=(l.id.replace(/\./g,"_")," ".repeat(n.indent+4),[]),A="$iter"+U,P="$type"+U,de="$running"+U,be="$anext"+U,te="var "+A+" = "+N.to_js();G.push($NodeJS(te)),G.push($NodeJS("var "+P+" = _b_.type.$factory( "+A+")")),G.push($NodeJS(te=A+" = $B.$call($B.$getattr("+P+', "__aiter__"))('+A+")")),G.push($NodeJS("var "+de+" = true")),G.push($NodeJS("var "+be+" = $B.$call($B.$getattr("+P+', "__anext__"))'));var ce=$NodeJS("while("+de+")");G.push(ce);var fe=$NodeJS("try");if(ce.add(fe),1==x.tree.length)te=x.to_js()+" = await ($B.promise("+be+"("+A+")))",fe.add($NodeJS(te));else{var _e=new $Node,le=new $NodeCtx(_e),pe=new $ExprCtx(le,"left",!1);pe.tree.push(x),x.parent=pe;var T=new $AssignCtx(pe);new $RawJSCtx(T,"await ($B.promise("+be+"("+A+")))"),fe.add(_e)}var B=$NodeJS("catch(err)");ce.add(B),B.add($NodeJS(te="if(err.__class__ === _b_.StopAsyncIteration){"+de+" = false; continue}else{throw err}")),n.children.forEach(function(ee){ce.add(ee)}),n.parent.children.splice(o,1);for(var q=G.length-1;q>=0;q--)n.parent.insert(o,G[q]);return n.children=[],0},$ForExpr.prototype.to_js=function(){this.js_processed=!0;var n=this.tree.pop();return"for ("+$to_js(this.tree)+" in "+n.to_js()+")"};var $FromCtx=$B.parser.$FromCtx=function(n){this.type="from",this.parent=n,this.module="",this.names=[],n.tree[n.tree.length]=this,this.expect="module",this.scope=$get_scope(this)};$FromCtx.prototype.add_name=function(n){this.names[this.names.length]=n,"*"==n&&(this.scope.blurred=!0)},$FromCtx.prototype.bind_names=function(){var n=$get_scope(this);this.names.forEach(function(o){Array.isArray(o)&&(o=o[1]),$bind(o,n,this)},this)},$FromCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":if("id"==l.expect)return l.add_name(o),l.expect=",",l;if("alias"==l.expect)return l.names[l.names.length-1]=[$B.last(l.names),o],l.expect=",",l;case".":if("module"==l.expect)return l.module+="id"==n?o:".",l;case"import":if("module"==l.expect)return l.expect="id",l;case"op":if("*"==o&&"id"==l.expect&&0==l.names.length)return"module"!==$get_scope(l).ntype&&$_SyntaxError(l,["import * only allowed at module level"]),l.add_name("*"),l.expect="eol",l;case",":if(","==l.expect)return l.expect="id",l;case"eol":switch(l.expect){case",":case"eol":return l.bind_names(),$transition(l.parent,n);case"id":$_SyntaxError(l,["trailing comma not allowed without surrounding parentheses"]);default:$_SyntaxError(l,["invalid syntax"])}case"as":if(","==l.expect||"eol"==l.expect)return l.expect="alias",l;case"(":if("id"==l.expect)return l.expect="id",l;case")":if(","==l.expect||"id"==l.expect)return l.expect="eol",l}$_SyntaxError(l,"token "+n+" after "+l)},$FromCtx.prototype.toString=function(){return"(from) "+this.module+" (import) "+this.names},$FromCtx.prototype.to_js=function(){this.js_processed=!0;var n=$get_scope(this),o=$get_module(this),l=o.module,x=[],N=0,U=$get_node(this).indent,G=" ".repeat(U);if(l.startsWith("$exec")){var A=$B.last($B.frames_stack)[1];A.module&&A.module.__name__&&(l=A.module.__name__)}for(var P=this.module.split("."),de=0;de<P.length;de++)o.imports[P.slice(0,de+1).join(".")]=!0;for(var be,te=this.module.replace(/\$/g,""),ce=[];te.length>0&&"."==te.charAt(0);){if(void 0===be?void 0!==$B.imported[l]&&(ce=(be=$B.imported[l].__package__).split(".")):(be=$B.imported[be],ce.pop()),void 0===be)return"throw _b_.SystemError.$factory(\"Parent module '' not loaded, cannot perform relative import\")";"None"==be&&console.log("package is None !"),te=te.substr(1)}te&&ce.push(te),this.module=ce.join(".");var fe=this.module.replace(/\$/g,"");x[N++]='var module = $B.$import("',x[N++]=fe+'",["';for(var _e=[],le=(de=0,this.names.length);de<le;de++)Array.isArray(this.names[de])?_e.push(this.names[de][0]):_e.push(this.names[de]);x[N++]=_e.join('","')+'"], {';var pe="";for(var T in this.aliases)x[N++]=pe+'"'+T+'": "'+this.aliases[T]+'"',pe=",";return x[N++]="}, {}, true);","*"==this.names[0]?(n.blurred=!0,x[N++]="\n"+G+"$B.import_all($locals, module);"):this.names.forEach(function(B){var q=B;Array.isArray(B)&&(q=B[1],B=B[0]),o.imports[this.module+"."+B]=!0,x[N++]="\n"+G+'$locals["'+q+'"] = $B.$getattr($B.imported["'+fe+'"], "'+B+'");'},this),x[N++]="\n"+G+"_b_.None;",x.join("")};var $FuncArgs=$B.parser.$FuncArgs=function(n){this.type="func_args",this.parent=n,this.tree=[],this.names=[],n.tree[n.tree.length]=this,this.expect="id",this.has_default=!1,this.has_star_arg=!1,this.has_kw_arg=!1};$FuncArgs.prototype.toString=function(){return"func args "+this.tree},$FuncArgs.prototype.transition=function(n,o){var l=this;switch(n){case"id":return l.has_kw_arg&&$_SyntaxError(l,"duplicate keyword argument"),"id"==l.expect&&(l.expect=",",l.names.indexOf(o)>-1&&$_SyntaxError(l,["duplicate argument "+o+" in function definition"])),new $FuncArgIdCtx(l,o);case",":if(","==l.expect)return l.expect="id",l;$_SyntaxError(l,"token "+n+" after "+l);case")":var x=$B.last(l.tree);return x&&"func_star_arg"==x.type&&"*"==x.name&&$_SyntaxError(l,"*"==l.op?["named arguments must follow bare *"]:"invalid syntax"),l.parent;case"op":l.has_kw_arg&&$_SyntaxError(l,"duplicate keyword argument");var N=o;if(l.expect=",","*"==N)return l.has_star_arg&&$_SyntaxError(l,"duplicate star argument"),new $FuncStarArgCtx(l,"*");if("**"==N)return new $FuncStarArgCtx(l,"**");if("/"==N)return l.has_end_positional?$_SyntaxError(l,["duplicate / in function parameters"]):l.has_star_arg&&$_SyntaxError(l,["/ after * in function parameters"]),new $EndOfPositionalCtx(l);$_SyntaxError(l,"token "+N+" after "+l);case":":if("lambda"==l.parent.type)return $transition(l.parent,n)}$_SyntaxError(l,"token "+n+" after "+l)},$FuncArgs.prototype.to_js=function(){return this.js_processed=!0,$to_js(this.tree)};var $FuncArgIdCtx=$B.parser.$FuncArgIdCtx=function(n,o){this.type="func_arg_id",this.name=o,this.parent=n,n.has_star_arg?n.parent.after_star.push(o):n.parent.positional_list.push(o);var l=$get_node(this);l.binding[o]&&$_SyntaxError(n,["duplicate argument '"+o+"' in function definition"]),$bind(o,l,this),this.tree=[],n.tree[n.tree.length]=this;for(var x=n;void 0!==x.parent;){if("def"==x.type){x.locals.push(o);break}x=x.parent}this.expect="="};$FuncArgIdCtx.prototype.toString=function(){return"func arg id "+this.name+"="+this.tree},$FuncArgIdCtx.prototype.transition=function(n,o){var l=this;switch(n){case"=":if("="==l.expect){l.has_default=!0;var x=l.parent.parent;return x.default_list.push(l.parent.has_star_arg?x.after_star.pop():x.positional_list.pop()),new $AbstractExprCtx(l,!1)}break;case",":case")":if(!l.parent.has_default||0!=l.tree.length||void 0!==l.parent.has_star_arg)return $transition(l.parent,n);$pos-=l.name.length,$_SyntaxError(l,["non-default argument follows default argument"]);case":":return"lambda"==l.parent.parent.type?$transition(l.parent.parent,":"):(l.has_default&&$_SyntaxError(l,"token "+n+" after "+l),new $AbstractExprCtx(new $AnnotationCtx(l),!1))}$_SyntaxError(l,"token "+n+" after "+l)},$FuncArgIdCtx.prototype.to_js=function(){return this.js_processed=!0,this.name+$to_js(this.tree)};var $FuncStarArgCtx=$B.parser.$FuncStarArgCtx=function(n,o){this.type="func_star_arg",this.op=o,this.parent=n,this.node=$get_node(this),n.has_star_arg="*"==o,n.has_kw_arg="**"==o,n.tree[n.tree.length]=this};$FuncStarArgCtx.prototype.toString=function(){return"(func star arg "+this.op+") "+this.name},$FuncStarArgCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":return void 0===l.name&&l.parent.names.indexOf(o)>-1&&$_SyntaxError(l,["duplicate argument "+o+" in function definition"]),l.set_name(o),l.parent.names.push(o),l;case",":case")":return void 0===l.name&&(l.set_name("*"),l.parent.names.push("*")),$transition(l.parent,n);case":":return"lambda"==l.parent.parent.type?$transition(l.parent.parent,":"):(void 0===l.name&&$_SyntaxError(l,"annotation on an unnamed parameter"),new $AbstractExprCtx(new $AnnotationCtx(l),!1))}$_SyntaxError(l,"token "+n+" after "+l)},$FuncStarArgCtx.prototype.set_name=function(n){this.name=n,this.node.binding[n]&&$_SyntaxError(C,["duplicate argument '"+n+"' in function definition"]),$bind(n,this.node,this);for(var o=this.parent;void 0!==o.parent;){if("def"==o.type){o.locals.push(n);break}o=o.parent}"*"==this.op?o.other_args='"'+n+'"':o.other_kw='"'+n+'"'};var $GlobalCtx=$B.parser.$GlobalCtx=function(n){for(this.type="global",this.parent=n,this.tree=[],n.tree[n.tree.length]=this,this.expect="id",this.scope=$get_scope(this),this.scope.globals=this.scope.globals||new Set,this.module=$get_module(this);this.module.module!=this.module.id;)this.module=this.module.parent_block;this.module.binding=this.module.binding||{}};$GlobalCtx.prototype.toString=function(){return"global "+this.tree},$GlobalCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":if("id"==l.expect)return new $IdCtx(l,o),l.add(o),l.expect=",",l;break;case",":if(","==l.expect)return l.expect="id",l;break;case"eol":if(","==l.expect)return $transition(l.parent,n)}$_SyntaxError(l,"token "+n+" after "+l)},$GlobalCtx.prototype.add=function(n){this.scope.annotations&&this.scope.annotations.has(n)&&$_SyntaxError(C,["annotated name '"+n+"' can't be global"]),this.scope.globals.add(n);var o=this.scope.parent_block;if(this.module.module.startsWith("$exec"))for(;o&&o.parent_block!==this.module;)o._globals=o._globals||{},o._globals[n]=this.module.id,delete o.binding[n],o=o.parent_block;this.module.binding[n]=!0},$GlobalCtx.prototype.to_js=function(){return this.js_processed=!0,""};var $IdCtx=$B.parser.$IdCtx=function(n,o){this.type="id",this.value=$mangle(o,n),this.parent=n,this.tree=[],n.tree[n.tree.length]=this;var l=this.scope=$get_scope(this);this.blurred_scope=this.scope.blurred,this.env=clone(this.scope.binding),["def","generator"].indexOf(l.ntype)>-1&&(l.referenced=l.referenced||{},$B.builtins[this.value]||(l.referenced[this.value]=!0)),"call_arg"==n.parent.type&&(this.call_arg=!0);for(var x=n;void 0!==x.parent;){switch(x.type){case"ctx_manager_alias":$bind(o,l,this);break;case"list_or_tuple":case"dict_or_set":case"call_arg":case"def":case"lambda":void 0===x.vars?x.vars=[o]:-1==x.vars.indexOf(o)&&x.vars.push(o),this.call_arg&&"lambda"==x.type&&(void 0===x.locals?x.locals=[o]:x.locals.push(o))}x=x.parent}if($parent_match(n,{type:"target_list"})&&(this.no_bindings=!0,$bind(o,l,this),this.bound=!0),["def","generator"].indexOf(l.ntype)>-1){for(var N=this.parent;N;){if("list_or_tuple"==N.type&&N.is_comp()){this.in_comp=!0;break}N=N.parent}"expr"==n.type&&"comp_if"==n.parent.type||"global"==n.type&&(void 0===l.globals?l.globals=new Set([o]):l.globals.add(o))}};$IdCtx.prototype.toString=function(){return"(id) "+this.value+":"+(this.tree||"")},$IdCtx.prototype.transition=function(n,o){var l=this;switch(n){case"=":return"expr"==l.parent.type&&void 0!==l.parent.parent&&"call_arg"==l.parent.parent.type?new $AbstractExprCtx(new $KwArgCtx(l.parent),!1):$transition(l.parent,n,o);case"op":return $transition(l.parent,n,o);case"id":case"str":case"int":case"float":case"imaginary":["print","exec"].indexOf(l.value)>-1&&$_SyntaxError(l,["missing parenthesis in call to '"+l.value+"'"]),$_SyntaxError(l,"token "+n+" after "+l)}return"packed"==this.parent.parent.type&&-1==[".","[","("].indexOf(n)?this.parent.parent.transition(n,o):$transition(l.parent,n,o)},$IdCtx.prototype.firstBindingScopeId=function(){for(var n=this.scope;n;){if(n.globals&&n.globals.has(this.value))return $get_module(this).id;if(n.binding&&n.binding[this.value])return n.id;n=n.parent}},$IdCtx.prototype.boundBefore=function(n){for(var o=$get_node(this);o.parent;){var l=o.parent;if(l.bindings&&l.bindings[this.value])return l.bindings[this.value];for(var x=0;x<l.children.length;x++){var N=l.children[x];if(N===o)break;if(N.bindings&&N.bindings[this.value])return N.bindings[this.value]}if(l===n)break;o=l}return!1},$IdCtx.prototype.bindingType=function(n){for(var o,l,x=0,N=$get_node(this),U=!1;!U&&N.parent&&x++<100;){var G=N.parent;if(G.bindings&&G.bindings[this.value])return G.bindings[this.value];for(var A=0;A<G.children.length;A++){var P=G.children[A];if(P===N)break;P.bindings&&P.bindings[this.value]&&(U=P.bindings[this.value],l=A)}if(U){for(var de=l+1;de<G.children.length;de++){if((P=G.children[de]).children.length>0){o=!0;break}if(P===N)break}return o||U}if(G===n)break;N=G}return U},$IdCtx.prototype.to_js=function(n){if(void 0!==this.result&&"generator"==this.scope.ntype)return this.result;var o=this.value;if("__BRYTHON__"==o||"$B"==o)return o;if(o.startsWith("comp_result_"+$B.lambda_magic))return this.bound?"var "+o:o;if(this.js_processed=!0,this.scope._globals&&this.scope._globals[o]&&(this.global_module=this.scope._globals[o]),this.global_module)return"$locals_"+this.global_module.replace(/\./g,"_")+'["'+o+'"]';var l=void 0!==this.scope.binding[o],x=$get_node(this),N=x.bound_before;if(this.nonlocal=this.scope.nonlocals&&void 0!==this.scope.nonlocals[o],this.unbound=this.unbound||l&&!this.bound&&N&&-1==N.indexOf(o),!this.bound&&this.scope.C&&"class"==this.scope.ntype&&this.scope.C.tree[0].name==o)return'$B.$search("'+o+'")';if(this.unbound&&!this.nonlocal)return"def"==this.scope.ntype||"generator"==this.scope.ntype?'$B.$local_search("'+o+'")':'$B.$search("'+o+'")';for(var U=$get_scope(this),G=U,A=[],P=['"'+U.id+'"'],de=U;;){if(de.parent_block){if(de.parent_block==$B.builtins_scope||void 0===de.parent_block.id)break;de=de.parent_block}P.push('"'+de.id+'"')}if(P="["+P.join(", ")+"]",U.globals&&U.globals.has(o)&&(P=['"'+de.id+'"'],U=de),this.nonlocal||this.bound){var be=this.firstBindingScopeId();if(void 0!==be)return"$locals_"+be.replace(/\./g,"_")+'["'+o+'"]';if(this.bound)return"$locals_"+U.id.replace(/\./g,"_")+'["'+o+'"]'}for(var te="$locals_"+de.id.replace(/\./g,"_");;){if(void 0!==G.globals&&G.globals.has(o))return this.boundBefore(de)||this.augm_assign?te+'["'+o+'"]':'$B.$global_search("'+o+'", '+P+")";if(G===U){if(N)(N.indexOf(o)>-1||G.C&&"def"==G.C.tree[0].type&&G.C.tree[0].env.indexOf(o)>-1)&&A.push(G);else if(G.binding[o]){if(void 0!==x.locals[o]){A.push(G);break}G.is_comp||G.parent_block&&G.parent_block.is_comp||A.push(G)}}else void 0===G.binding&&console.log("scope",G,o,"no binding",U),G.binding[o]&&A.push(G);if(!G.parent_block)break;G=G.parent_block}if(this.found=A,this.nonlocal&&A[0]===U&&A.shift(),A.length>0){if(A[0].C&&A[0]===U&&"$"!=o.charAt(0)){var ce=x.locals||{},fe=U.nonlocals;try{if(void 0===ce[o]&&!this.augm_assign&&("def"!=U.type||"generator"!=U.type)&&"class"!=U.ntype&&U.C.tree[0].args&&-1==U.C.tree[0].args.indexOf(o)&&(void 0===fe||void 0===fe[o]))return this.result='$B.$local_search("'+o+'")',this.result}catch(B){throw console.log("error",o,U),B}}if(A.length>1&&A[0].C&&"class"==A[0].C.tree[0].type){var _e="$locals_"+A[0].id.replace(/\./g,"_"),le="$locals_"+A[1].id.replace(/\./g,"_");if(N)return N.indexOf(o)>-1?(this.found=A[0].binding[o],pe=_e):(this.found=A[1].binding[o],pe=le),this.result=pe+'["'+o+'"]',this.result;this.found=!1;var pe=_e+'["'+o+'"] !== undefined ? ';return this.result="("+(pe+=_e+'["'+o+'"] : ')+le+'["'+o+'"])',this.result}this.found=(G=A[0]).binding[o];var T="$locals_"+G.id.replace(/\./g,"_");if(void 0===G.C)if("__builtins__"==G.id)de.blurred?o="("+te+'["'+o+'"] || _b_.'+o+")":(o="_b_."+o,this.is_builtin=!0);else if(this.bound||this.augm_assign)o=T+'["'+o+'"]';else{if(G===U&&void 0===this.env[o])return this.result='$B.$search("'+o+'")',this.result;o=this.boundBefore(G)?T+'["'+o+'"]':'$B.$check_def("'+o+'",'+T+'["'+o+'"])'}else o=G===U?G.globals&&G.globals.has(o)?te+'["'+o+'"]':this.bound||this.augm_assign||this.boundBefore(G)?'$locals["'+o+'"]':'$B.$check_def_local("'+o+'",$locals["'+o+'"])':this.augm_assign?T+'["'+o+'"]':'$B.$check_def_free("'+o+'",'+T+'["'+o+'"])';return this.result=o+$to_js(this.tree,""),this.result}return this.unknown_binding=!0,this.result='$B.$global_search("'+o+'", '+P+")",this.result};var $ImportCtx=$B.parser.$ImportCtx=function(n){this.type="import",this.parent=n,this.tree=[],n.tree[n.tree.length]=this,this.expect="id"};$ImportCtx.prototype.toString=function(){return"import "+this.tree},$ImportCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":if("id"==l.expect)return new $ImportedModuleCtx(l,o),l.expect=",",l;if("qual"==l.expect)return l.expect=",",l.tree[l.tree.length-1].name+="."+o,l.tree[l.tree.length-1].alias+="."+o,l;if("alias"==l.expect)return l.expect=",",l.tree[l.tree.length-1].alias=o,l;break;case".":if(","==l.expect)return l.expect="qual",l;break;case",":if(","==l.expect)return l.expect="id",l;break;case"as":if(","==l.expect)return l.expect="alias",l;break;case"eol":if(","==l.expect)return l.bind_names(),$transition(l.parent,n)}$_SyntaxError(l,"token "+n+" after "+l)},$ImportCtx.prototype.bind_names=function(){var n=$get_scope(this);this.tree.forEach(function(o){if(o.name==o.alias){var l=o.name,x=l.split("."),N=l;x.length>1&&(N=x[0])}else N=o.alias;$bind(N,n,this)},this)},$ImportCtx.prototype.to_js=function(){this.js_processed=!0;var n=$get_scope(this),o=[],l=$get_module(this);return this.tree.forEach(function(x){for(var N=x.name,U=x.name==x.alias?"{}":'{"'+N+'" : "'+x.alias+'"}',G="$locals_"+n.id.replace(/\./g,"_"),A=x.name.split("."),P=0;P<A.length;P++)l.imports[A.slice(0,P+1).join(".")]=!0;o.push('$B.$import("'+N+'", [],'+U+","+G+", true);")}),o.join("")+"_b_.None;"};var $ImportedModuleCtx=$B.parser.$ImportedModuleCtx=function(n,o){this.type="imported module",this.parent=n,this.name=o,this.alias=o,n.tree[n.tree.length]=this};$ImportedModuleCtx.prototype.toString=function(){return" (imported module) "+this.name},$ImportedModuleCtx.prototype.transition=function(n,o){},$ImportedModuleCtx.prototype.to_js=function(){return this.js_processed=!0,'"'+this.name+'"'};var $JSCode=$B.parser.$JSCode=function(n){this.js=n};$JSCode.prototype.toString=function(){return this.js},$JSCode.prototype.transition=function(n,o){},$JSCode.prototype.to_js=function(){return this.js_processed=!0,this.js};var $KwArgCtx=$B.parser.$KwArgCtx=function(n){this.type="kwarg",this.parent=n.parent,this.tree=[n.tree[0]],n.parent.tree.pop(),n.parent.tree.push(this),n.parent.parent.has_kw=!0;var o=this.tree[0].value,l=n.parent.parent;void 0===l.kwargs?l.kwargs=[o]:-1==l.kwargs.indexOf(o)?l.kwargs.push(o):$_SyntaxError(n,["keyword argument repeated"])};$KwArgCtx.prototype.toString=function(){return"kwarg "+this.tree[0]+"="+this.tree[1]},$KwArgCtx.prototype.transition=function(n,o){return","==n?new $CallArgCtx(this.parent.parent):$transition(this.parent,n)},$KwArgCtx.prototype.to_js=function(){this.js_processed=!0;var n=this.tree[0].value;return"$$"==n.substr(0,2)&&(n=n.substr(2)),'{$nat:"kw",name:"'+n+'",value:'+$to_js(this.tree.slice(1,this.tree.length))+"}"};var $LambdaCtx=$B.parser.$LambdaCtx=function(n){this.type="lambda",this.parent=n,n.tree[n.tree.length]=this,this.tree=[],this.args_start=$pos+6,this.vars=[],this.locals=[],this.node=$get_node(this),this.node.binding={},this.positional_list=[],this.default_list=[],this.other_args=null,this.other_kw=null,this.after_star=[]};$LambdaCtx.prototype.toString=function(){return"(lambda) "+this.args_start+" "+this.body_start},$LambdaCtx.prototype.transition=function(n,o){var l=this;return":"==n&&void 0===l.args?(l.args=l.tree,l.tree=[],l.body_start=$pos,new $AbstractExprCtx(l,!1)):void 0!==l.args?(l.body_end=$pos,$transition(l.parent,n)):void 0===l.args&&"("!=n?$transition(new $FuncArgs(l),n,o):void $_SyntaxError(l,"token "+n+" after "+l)},$LambdaCtx.prototype.to_js=function(){this.js_processed=!0;var n=this.parent,o=this.node,l=$get_module(this),x=$get_src(n),N=x.substring(this.args_start,this.body_start),U=x.substring(this.body_start+1,this.body_end);U=(U=U.replace(/\\\n/g," ")).replace(/\n/g," ");var G=$get_scope(this),A=$B.UUID(),P="lambda_"+$B.lambda_magic+"_"+A,de="def "+P+"("+N+"):";de+="    return "+U;var be="lambda"+A,te=l.id.replace(/\./g,"_"),ce=$B.py2js(de,te,be,G,o.line_num).to_js(),fe=`$locals_${be}`;return N="{}",l.is_comp&&(fe+=`,$locals_${l.id.replace(/\./g,"_")}`,N+=`,typeof $locals_${l.id.replace(/\./g,"_")}==="undefined" ?{}:$locals_${l.id.replace(/\./g,"_")}`),ce=`(function(${fe}){\n`+ce+`\nreturn $locals.${P}})(${N})`,$B.clear_ns(be),$B.$py_src[be]=null,delete $B.$py_src[be],ce};var $ListOrTupleCtx=$B.parser.$ListOrTupleCtx=function(n,o){this.type="list_or_tuple",this.start=$pos,this.real=o,this.expect="id",this.closed=!1,this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$ListOrTupleCtx.prototype.toString=function(){switch(this.real){case"list":return"(list) ["+this.tree+"]";case"list_comp":case"gen_expr":return"("+this.real+") ["+this.intervals+"-"+this.tree+"]";default:return"(tuple) ("+this.tree+")"}},$ListOrTupleCtx.prototype.transition=function(n,o){var l=this;if(l.closed)return"["==n?new $AbstractExprCtx(new $SubCtx(l.parent),!1):"("==n?new $CallCtx(l.parent):$transition(l.parent,n,o);if(","==l.expect){switch(l.real){case"tuple":case"gen_expr":if(")"==n){for(var x=!0;"list_or_tuple"==l.type&&"tuple"==l.real&&"expr"==l.parent.type&&"node"==l.parent.parent.type&&1==l.tree.length;){x=!1;var N=l.parent.parent,U=N.tree.indexOf(l.parent);(P=l.tree[0]).parent=N,P.$in_parens=!0,N.tree.splice(U,1,P),l=P.tree[0]}if(x&&l.close(),"gen_expr"==l.real){if(l.expression.yields)for(const de of l.expression.yields)$pos=de[1],$_SyntaxError(l,["'yield' inside generator expression"]);l.intervals.push($pos)}return"packed"==l.parent.type?l.parent.parent:"abstract_expr"==l.parent.type&&l.parent.assign?(l.parent.parent.tree.pop(),(P=new $ExprCtx(l.parent.parent,"assign",!1)).tree=l.parent.tree,P.tree[0].parent=P,P.assign=l.parent.assign,P):l.parent}break;case"list":case"list_comp":if("]"==n){if(l.close(),"list_comp"==l.real){if(l.expression.yields)for(const de of l.expression.yields)$pos=de[1],$_SyntaxError(l,["'yield' inside list comprehension"]);l.intervals.push($pos)}return"packed"==l.parent.type?l.parent.tree.length>0?l.parent.tree[0]:l.parent.parent:l.parent}break;case"dict_or_set_comp":if("}"==n){if(l.expression.yields)for(const de of l.expression.yields)$pos=de[1],$_SyntaxError(l,[`'yield' inside ${"set_comp"==l.parent.real?"set":"dict"}comprehension`]);return l.intervals.push($pos),$transition(l.parent,n)}}switch(n){case",":return"tuple"==l.real&&(l.has_comma=!0),l.expect="id",l;case"for":"list"==l.real?(this.tree.length>1&&$_SyntaxError(l,"unparenthesized expression before 'for'"),l.real="list_comp"):l.real="gen_expr",l.intervals=[l.start+1],l.expression=l.tree,l.yields&&(l.expression.yields=l.yields,delete l.yields),l.tree=[];var A=new $ComprehensionCtx(l);return new $TargetListCtx(new $CompForCtx(A))}return $transition(l.parent,n,o)}if("id"!=l.expect)return $transition(l.parent,n,o);switch(l.real){case"tuple":if(")"==n)return l.close(),l.parent;if("eol"==n&&!0===l.implicit)return l.close(),$transition(l.parent,n);break;case"gen_expr":if(")"==n)return l.close(),$transition(l.parent,n);break;case"list":if("]"==n)return l.close(),l}switch(n){case"=":if("tuple"==l.real&&!0===l.implicit)return l.close(),l.parent.tree.pop(),(P=new $ExprCtx(l.parent,"tuple",!1)).tree=[l],l.parent=P,$transition(l.parent,n);break;case")":break;case"]":if("tuple"==l.real&&!0===l.implicit)return $transition(l.parent,n,o);break;case",":$_SyntaxError(l,"unexpected comma inside list");default:l.expect=",";var P=new $AbstractExprCtx(l,!1);return $transition(P,n,o)}},$ListOrTupleCtx.prototype.close=function(){this.closed=!0;for(var n=0,o=this.tree.length;n<o;n++){var l=this.tree[n];"expr"==l.type&&"list_or_tuple"==l.tree[0].type&&"tuple"==l.tree[0].real&&1==l.tree[0].tree.length&&","==l.tree[0].expect&&(this.tree[n]=l.tree[0].tree[0],this.tree[n].parent=this)}},$ListOrTupleCtx.prototype.is_comp=function(){switch(this.real){case"list_comp":case"gen_expr":case"dict_or_set_comp":return!0}return!1},$ListOrTupleCtx.prototype.get_src=function(){var n=$get_module(this).src,o=$get_scope(this);return void 0===o.comments||o.comments.forEach(function(l){var x=l[0],N=l[1];n=n.substr(0,x)+" ".repeat(N+1)+n.substr(x+N+1)}),n},$ListOrTupleCtx.prototype.bind_ids=function(n){this.tree.forEach(function(o){if("id"==o.type)$bind(o.value,n,this),o.bound=!0;else if("expr"==o.type&&"id"==o.tree[0].type)$bind(o.tree[0].value,n,this),o.tree[0].bound=!0;else if("expr"==o.type&&"packed"==o.tree[0].type){var l=o.tree[0].tree[0];"expr"==l.type&&"id"==l.tree[0].type&&($bind(l.tree[0].value,n,this),l.tree[0].bound=!0)}else("list_or_tuple"==o.type||"expr"==o.type&&"list_or_tuple"==o.tree[0].type)&&("expr"==o.type&&(o=o.tree[0]),o.bind_ids(n))},this)},$ListOrTupleCtx.prototype.packed_indices=function(){for(var n=[],o=0;o<this.tree.length;o++){var l=this.tree[o];"expr"==l.type&&("packed"==(l=l.tree[0]).type||"call"==l.type&&"packed"==l.func.type)&&n.push(o)}return n},$ListOrTupleCtx.prototype.unpack=function(n){for(var o,l="",x=0;x<this.tree.length;x++)o=n.indexOf(x)>-1?"_b_.list.$factory("+this.tree[x].to_js()+")":"["+this.tree[x].to_js()+"]",x>0&&(o=".concat("+o+")"),l+=o;return l},$ListOrTupleCtx.prototype.to_js=function(){this.js_processed=!0;var n=$get_scope(this),o=(n.id.replace(/\//g,"_"),0),l=(T=$get_module(this)).module;switch(this.real){case"list":return(Ee=this.packed_indices()).length>0?"$B.$list("+this.unpack(Ee)+")":"$B.$list(["+$to_js(this.tree)+"])";case"list_comp":case"gen_expr":case"dict_or_set_comp":for(var x=this.get_src(),N=[],U=[],G=new RegExp('"',"g"),A=T.comments,P=1;P<this.intervals.length;P++){for(var de=this.intervals[P-1],be=this.intervals[P],te=x.substring(de,be),ce=A.length-1;ce>=0;ce--){var fe=A[ce];fe[0]>de&&fe[0]<be&&(te=te.substr(0,o=fe[0]-de)+" ".repeat(fe[1])+te.substr(o+fe[1]+1))}te=te.replace(/\\\n/g," "),U.push(te);var _e=te.split("\n"),le=[];_e.forEach(function(qe){0!=qe.replace(/ /g,"").length&&(qe=(qe=(qe=qe.replace(/\n/g," ")).replace(/\\/g,"\\\\")).replace(G,'\\"'),le.push('"'+qe+'"'))}),N.push("["+le.join(",")+"]")}var pe=$get_node(this).line_num;switch(this.real){case"list_comp":var T,B=$B.$list_comp(U),ee=B[1],F="lc"+$B.lambda_magic+ee,Be=$pos,ve=(T=$B.py2js({src:B[0],is_comp:!0,line_info:pe+","+l},l,F,n,1)).outermost_expr;$get_node(this).has_yield&&(ve=this.tree[0].tree[0].tree[1]),void 0===ve&&(ve=T.first_for.tree[1]);var Ae=ve.to_js();$pos=Be;var Fe=T.to_js();return T=null,$B.clear_ns(F),delete $B.$py_src[F],Fe=`function(expr){${Fe+="return $locals_"+F+'["x'+ee+'"]'}})(${Ae})`,this.is_await&&(Fe="async "+Fe),"("+Fe;case"dict_or_set_comp":return 1==this.expression.length?$B.$gen_expr(l,n,U,pe,!0):$B.$dict_comp(l,n,U,pe)}return $B.$gen_expr(l,n,U,pe);case"tuple":var Ee;return(Ee=this.packed_indices()).length>0?"$B.fast_tuple("+this.unpack(Ee)+")":1==this.tree.length&&void 0===this.has_comma?this.tree[0].to_js():"$B.fast_tuple(["+$to_js(this.tree)+"])"}};var $NodeCtx=$B.parser.$NodeCtx=function(n){this.node=n,n.C=this,this.tree=[],this.type="node";for(var o=null,l=n;l.parent&&"module"!=l.parent.type;){var x=!1;switch(l.parent.C.tree[0].type){case"def":case"class":case"generator":o=l.parent,x=!0}if(x)break;l=l.parent}null===o&&(o=l.parent||l),this.node.locals=clone(o.binding),this.scope=o};$NodeCtx.prototype.toString=function(){return"node "+this.tree},$NodeCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case"not":case"lambda":case".":var x=new $AbstractExprCtx(l,!0);return $transition(x,n,o);case"op":switch(o){case"*":case"+":case"-":case"~":return x=new $AbstractExprCtx(l,!0),$transition(x,n,o)}break;case"async":return new $AsyncCtx(l);case"await":return new $AbstractExprCtx(new $AwaitCtx(l),!0);case"class":return new $ClassCtx(l);case"continue":return new $ContinueCtx(l);case"__debugger__":return new $DebuggerCtx(l);case"break":return new $BreakCtx(l);case"def":return new $DefCtx(l);case"for":return new $TargetListCtx(new $ForExpr(l));case"if":case"while":return new $AbstractExprCtx(new $ConditionCtx(l,n),!1);case"elif":var N=$previous(l);return-1!=["condition"].indexOf(N.type)&&"while"!=N.token||$_SyntaxError(l,"elif after "+N.type),new $AbstractExprCtx(new $ConditionCtx(l,n),!1);case"else":return N=$previous(l),-1==["condition","except","for"].indexOf(N.type)&&$_SyntaxError(l,"else after "+N.type),new $SingleKwCtx(l,n);case"finally":return N=$previous(l),-1!=["try","except"].indexOf(N.type)||"single_kw"==N.type&&"else"==N.token||$_SyntaxError(l,"finally after "+N.type),new $SingleKwCtx(l,n);case"try":return new $TryCtx(l);case"except":return N=$previous(l),-1==["try","except"].indexOf(N.type)&&$_SyntaxError(l,"except after "+N.type),new $ExceptCtx(l);case"assert":return new $AbstractExprCtx(new $AssertCtx(l),!1,!0);case"from":return new $FromCtx(l);case"import":return new $ImportCtx(l);case"global":return new $GlobalCtx(l);case"nonlocal":return new $NonlocalCtx(l);case"lambda":return new $LambdaCtx(l);case"pass":return new $PassCtx(l);case"raise":return new $AbstractExprCtx(new $RaiseCtx(l),!0);case"return":return new $AbstractExprCtx(new $ReturnCtx(l),!0);case"with":return new $AbstractExprCtx(new $WithCtx(l),!1);case"yield":return new $AbstractExprCtx(new $YieldCtx(l),!0);case"del":return new $AbstractExprCtx(new $DelCtx(l),!0);case"@":return new $DecoratorCtx(l);case",":l.tree&&0==l.tree.length&&$_SyntaxError(l,"token "+n+" after "+l);var U=l.tree[0];l.tree=[];var G=new $ListOrTupleCtx(l);return G.real="tuple",G.implicit=0,G.tree.push(U),U.parent=G,G;case"eol":return 0==l.tree.length?(l.node.parent.children.pop(),l.node.parent.C):l}$_SyntaxError(l,"token "+n+" after "+l)},$NodeCtx.prototype.to_js=function(){if(void 0!==this.js)return this.js;if(this.js_processed=!0,this.tree.length>1){var n=new $Node;new $NodeCtx(n).tree=[this.tree[1]],n.indent=node.indent+4,this.tree.pop(),node.add(n)}if(this.js="",this.tree[0]){var o="def"!=this.scope.ntype;if(this.tree[0].annotation)if(o){if("expr"==this.tree[0].type&&!this.tree[0].$in_parens&&"id"==this.tree[0].tree[0].type){var l="";return this.create_annotations&&(l+="$locals.__annotations__ = $B.empty_dict();"),l+"_b_.dict.$setitem($locals.__annotations__, '"+this.tree[0].tree[0].value+"', "+this.tree[0].annotation.to_js()+");"}"def"==this.tree[0].type?this.js=this.tree[0].annotation.to_js()+";":(this.js="",this.tree=[])}else"def"!=this.tree[0].type&&(this.tree=[]);else if("assign"==this.tree[0].type&&!this.tree[0].tree[0].$in_parens&&this.tree[0].tree[0].annotation){var x=this.tree[0].tree[0],N=this.tree[0].tree[1];if(this.create_annotations&&(this.js+="$locals.__annotations__ = $B.empty_dict();"),this.js+="var $value = "+N.to_js()+";",this.tree[0].tree.splice(1,1),new $RawJSCtx(this.tree[0],"$value"),!x.tree[0]||"id"!=x.tree[0].type||!o)return this.js+=$to_js(this.tree)+";",o&&(this.js+=x.annotation.to_js()),this.js;this.js+="_b_.dict.$setitem($locals.__annotations__, '"+x.tree[0].value+"', "+x.annotation.to_js()+");"}}return this.js+=0==this.node.children.length?$to_js(this.tree)+";":$to_js(this.tree),this.js};var $NodeJS=$B.parser.$NodeJS=function(n){var o=new $Node;return new $NodeJSCtx(o,n),o},$NodeJSCtx=$B.parser.$NodeJSCtx=function(n,o){this.node=n,n.C=this,this.type="node_js",this.tree=[o]};$NodeJSCtx.prototype.toString=function(){return"js "+js},$NodeJSCtx.prototype.to_js=function(){return this.js_processed=!0,this.tree[0]};var $NonlocalCtx=$B.parser.$NonlocalCtx=function(n){this.type="nonlocal",this.parent=n,this.tree=[],this.names={},n.tree[n.tree.length]=this,this.expect="id",this.scope=$get_scope(this),this.scope.nonlocals=this.scope.nonlocals||{},void 0===this.scope.C&&$_SyntaxError(n,["nonlocal declaration not allowed at module level"])};$NonlocalCtx.prototype.toString=function(){return"nonlocal "+this.tree},$NonlocalCtx.prototype.add=function(n){"arg"==this.scope.binding[n]&&$_SyntaxError(C,["name '"+n+"' is parameter and nonlocal"]),this.names[n]=[!1,$pos],this.scope.nonlocals[n]=!0},$NonlocalCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":if("id"==l.expect)return new $IdCtx(l,o),l.add(o),l.expect=",",l;break;case",":if(","==l.expect)return l.expect="id",l;break;case"eol":if(","==l.expect)return $transition(l.parent,n)}$_SyntaxError(l,"token "+n+" after "+l)},$NonlocalCtx.prototype.transform=function(n,o){var l=this.parent,x=this.scope.parent_block;if(void 0===x.C)$_SyntaxError(l,["no binding for nonlocal '"+$B.last(Object.keys(this.names))+"' found"]);else{for(;void 0!==x&&void 0!==x.C;){for(var N in this.names)void 0!==x.binding[N]&&(this.names[N]=[!0]);x=x.parent_block}for(var N in this.names)this.names[N][0]||(console.log("nonlocal error, C "+l),$pos=this.names[N][1],$_SyntaxError(l,["no binding for nonlocal '"+N+"' found"]))}},$NonlocalCtx.prototype.to_js=function(){return this.js_processed=!0,""};var $NotCtx=$B.parser.$NotCtx=function(n){this.type="not",this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$NotCtx.prototype.toString=function(){return"not ("+this.tree+")"},$NotCtx.prototype.transition=function(n,o){var l=this;switch(n){case"in":return l.parent.parent.tree.pop(),new $ExprCtx(new $OpCtx(l.parent,"not_in"),"op",!1);case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case".":case"not":case"lambda":var x=new $AbstractExprCtx(l,!1);return $transition(x,n,o);case"op":if("+"==o||"-"==o||"~"==o)return x=new $AbstractExprCtx(l,!1),$transition(x,n,o)}return $transition(l.parent,n)},$NotCtx.prototype.to_js=function(){return this.js_processed=!0,"!$B.$bool("+$to_js(this.tree)+")"};var $NumberCtx=$B.parser.$NumberCtx=function(n,o,l){this.type=n,this.value=l,this.parent=o,this.tree=[],o.tree[o.tree.length]=this};$NumberCtx.prototype.toString=function(){return this.type+" "+this.value},$NumberCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case"not":case"lambda":$_SyntaxError(l,"token "+n+" after "+l)}return $transition(l.parent,n,o)},$NumberCtx.prototype.to_js=function(){this.js_processed=!0;var type=this.type,value=this.value;if("int"==type){var v=parseInt(value[1],value[0]);if(v>$B.min_int&&v<$B.max_int)return this.unary_op&&(v=eval(this.unary_op+v)),v;var v=$B.long_int.$factory(value[1],value[0]);switch(this.unary_op){case"-":v=$B.long_int.__neg__(v);break;case"~":v=$B.long_int.__invert__(v)}return'{__class__: $B.long_int, value: "'+v.value+'", pos: '+v.pos+"}"}return"float"==type?/^\d+$/.exec(value)||/^\d+\.\d*$/.exec(value)?"(new Number("+this.value+"))":"_b_.float.$factory("+value+")":"imaginary"==type?"$B.make_complex(0,"+value+")":void 0};var $OpCtx=$B.parser.$OpCtx=function(n,o){if(this.type="op",this.op=o,this.parent=n.parent,this.tree=[n],this.scope=$get_scope(this),"expr"==n.type)if(["int","float","str"].indexOf(n.tree[0].type)>-1)this.left_type=n.tree[0].type;else if("id"==n.tree[0].type){var l=this.scope.binding[n.tree[0].value];l&&(this.left_type=l.type)}n.parent.tree.pop(),n.parent.tree.push(this)};$OpCtx.prototype.toString=function(){return"(op "+this.op+") ["+this.tree+"]"},$OpCtx.prototype.transition=function(n,o){var l=this;if(void 0===l.op&&$_SyntaxError(l,["C op undefined "+l]),"unary"==l.op.substr(0,5)){if("eol"!=n&&("assign"==l.parent.type||"return"==l.parent.type)){l.parent.tree.pop();var x=new $ListOrTupleCtx(l.parent,"tuple");return x.tree.push(l),l.parent=x,x}2==l.tree.length&&"expr"==l.tree[1].type&&"int"==l.tree[1].tree[0].type&&(l.parent.tree.pop(),l.parent.tree.push(l.tree[1]),l.tree[1].parent=l.parent,l.tree[1].tree[0].unary_op=l.tree[0].op)}switch(n){case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case".":case"not":case"lambda":return $transition(new $AbstractExprCtx(l,!1),n,o);case"op":switch(o){case"+":case"-":case"~":return new $UnaryCtx(l,o)}default:"abstract_expr"==l.tree[l.tree.length-1].type&&$_SyntaxError(l,"token "+n+" after "+l)}return $transition(l.parent,n)},$OpCtx.prototype.to_js=function(){this.js_processed=!0;var n={"==":"eq","!=":"ne",">=":"ge","<=":"le","<":"lt",">":"gt"};if(void 0!==n[this.op]){var o=n[this.op];if("expr"==this.tree[0].type&&"expr"==this.tree[1].type){var l=this.tree[0].tree[0],x=this.tree[1].tree[0],N=l.to_js(),U=x.to_js();switch(x.type){case"int":switch(l.type){case"int":return Number.isSafeInteger(l.value)&&Number.isSafeInteger(x.value)?N+this.op+U:"$B.$getattr("+this.tree[0].to_js()+',"__'+o+'__")('+this.tree[1].to_js()+")";case"str":switch(this.op){case"==":return"false";case"!=":return"true";default:return'$B.$TypeError("unorderable types:  int() '+this.op+' str()")'}case"id":return"(typeof "+N+' == "number" ? '+N+this.op+U+' : $B.rich_comp("__'+o+'__",'+this.tree[0].to_js()+","+this.tree[1].to_js()+"))"}break;case"str":switch(l.type){case"str":return N+this.op+U;case"int":switch(this.op){case"==":return"false";case"!=":return"true";default:return'$B.$TypeError("unorderable types:  str() '+this.op+' int()")'}case"id":return"(typeof "+N+' == "string" ? '+N+this.op+U+' : $B.rich_comp("__'+o+'__",'+this.tree[0].to_js()+","+this.tree[1].to_js()+"))"}break;case"id":if("id"==l.type)return"typeof "+N+'!="object" && typeof '+N+'!="function" && typeof '+N+" == typeof "+U+" ? "+N+this.op+U+' : $B.rich_comp("__'+o+'__",'+this.tree[0].to_js()+","+this.tree[1].to_js()+")"}}}switch(this.op){case"and":var G=this.tree[0].to_js(),A=this.tree[1].to_js();return void 0!==this.wrap?"(function(){var "+this.wrap.name+" = "+this.wrap.js+";return $B.$test_expr($B.$test_item("+G+") && $B.$test_item("+A+"))})()":"$B.$test_expr($B.$test_item("+G+")&&$B.$test_item("+A+"))";case"or":return(q="$B.$test_expr($B.$test_item("+this.tree[0].to_js()+")||")+"$B.$test_item("+this.tree[1].to_js()+"))";case"in":return"$B.$is_member("+$to_js(this.tree)+")";case"not_in":return"!$B.$is_member("+$to_js(this.tree)+")";case"unary_neg":case"unary_pos":case"unary_inv":if("unary_neg"==this.op?(be="-",o="__neg__"):"unary_pos"==this.op?(be="+",o="__pos__"):(be="~",o="__invert__"),"expr"==this.tree[1].type){var P=this.tree[1].tree[0];switch(P.type){case"int":var de=parseInt(P.value[1],P.value[0]);return Number.isSafeInteger(de)?be+de:"$B.$getattr("+P.to_js()+', "'+o+'")()';case"float":return"_b_.float.$factory("+be+P.value+")";case"imaginary":return"$B.make_complex(0,"+be+P.value+")"}}return"$B.$getattr("+this.tree[1].to_js()+',"'+o+'")()';case"is":return"$B.$is("+this.tree[0].to_js()+", "+this.tree[1].to_js()+")";case"is_not":return this.tree[0].to_js()+"!=="+this.tree[1].to_js();case"+":return"$B.add("+this.tree[0].to_js()+", "+this.tree[1].to_js()+")";case"*":case"-":let K=function(ve,Ae){var Fe;return["int","float","str"].indexOf(Ae.type)>-1?Fe=Ae.type:"id"==Ae.type&&ve[Ae.value]&&(Fe=ve[Ae.value].type),Fe};var be=this.op,te=[],ce=!1,fe=$get_scope(this),_e=this.tree[0],le=this.tree[1];if(function ve(Ae){if("expr"==Ae.type&&"int"==Ae.tree[0].type)return!0;if("expr"==Ae.type&&"float"==Ae.tree[0].type)return ce=!0,!0;if("expr"==Ae.type&&"list_or_tuple"==Ae.tree[0].type&&"tuple"==Ae.tree[0].real&&1==Ae.tree[0].tree.length&&"expr"==Ae.tree[0].tree[0].type)return ve(Ae.tree[0].tree[0].tree[0]);if("expr"==Ae.type&&"id"==Ae.tree[0].type){var Fe=Ae.tree[0].to_js();return-1==te.indexOf(Fe)&&te.push(Fe),!0}if("op"==Ae.type&&["*","+","-"].indexOf(Ae.op)>-1){for(var Ee=0;Ee<Ae.tree.length;Ee++)if(!ve(Ae.tree[Ee]))return!1;return!0}return!1}(this)){var pe=this.tree[0].tree[0],T=this.tree[1].tree[0];if(0!=te.length||ce){if(0==te.length)return"new Number("+this.simple_js()+")";var B=fe.binding;if(l=K(B,pe),x=K(B,T),"float"==l&&"float"==x||"+"==this.op&&"str"==l&&"str"==x)return this.result_type=l,pe.to_js()+this.op+T.to_js();if(["int","float"].indexOf(l)>-1&&["int","float"].indexOf(x)>-1)switch(this.result_type="int"==l&&"int"==x?"int":"float",this.op){case"-":return"$B.sub("+pe.to_js()+","+T.to_js()+")";case"*":return"$B.mul("+pe.to_js()+","+T.to_js()+")"}var q,ee=[],F=[];return te.forEach(function(ve){ee.push("typeof "+ve+'.valueOf() == "number"'),F.push("typeof "+ve+' == "number"')}),(q=[ee.join(" && ")+" ? "]).push("("+F.join(" && ")+" ? "),q.push(this.simple_js()),q.push(" : new Number("+this.simple_js()+")"),q.push(")"),l=this.tree[0].to_js(),x=this.tree[1].to_js(),"+"==this.op&&q.push(" : (typeof "+l+' == "string" && typeof '+x+' == "string") ? '+l+"+"+x),q.push(': $B.rich_op("'+$operators[this.op]+'",'+l+","+x+")"),"("+q.join("")+")"}return this.simple_js()}return void 0!==n[this.op]?'$B.rich_comp("__'+$operators[this.op]+'__",'+_e.to_js()+","+le.to_js()+")":'$B.rich_op("'+$operators[this.op]+'", '+_e.to_js()+", "+le.to_js()+")";default:return void 0!==n[this.op]?'$B.rich_comp("__'+$operators[this.op]+'__",'+this.tree[0].to_js()+","+this.tree[1].to_js()+")":'$B.rich_op("'+$operators[this.op]+'", '+this.tree[0].to_js()+", "+this.tree[1].to_js()+")"}},$OpCtx.prototype.simple_js=function(){var n=this.op;function o(l){return"op"==l.type?l.simple_js():"expr"==l.type&&"list_or_tuple"==l.tree[0].type&&"tuple"==l.tree[0].real&&1==l.tree[0].tree.length&&"expr"==l.tree[0].tree[0].type?"("+l.tree[0].tree[0].tree[0].simple_js()+")":l.tree[0].to_js()}return"+"==n?"$B.add("+o(this.tree[0])+","+o(this.tree[1])+")":"-"==n?"$B.sub("+o(this.tree[0])+","+o(this.tree[1])+")":"*"==n?"$B.mul("+o(this.tree[0])+","+o(this.tree[1])+")":"/"==n?"$B.div("+o(this.tree[0])+","+o(this.tree[1])+")":o(this.tree[0])+n+o(this.tree[1])};var $PackedCtx=$B.parser.$PackedCtx=function(n){if(this.type="packed","list_or_tuple"==n.parent.type&&"node"==n.parent.parent.type)for(var o=0;o<n.parent.tree.length;o++){var l=n.parent.tree[o];"expr"==l.type&&l.tree.length>0&&"packed"==l.tree[0].type&&$_SyntaxError(n,["two starred expressions in assignment"])}this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$PackedCtx.prototype.toString=function(){return"(packed) "+this.tree},$PackedCtx.prototype.transition=function(n,o){var l=this;if(l.tree.length>0&&"["==n)return $transition(l.tree[0],n,o);if("id"==n){var x=new $AbstractExprCtx(l,!1);return x.packed=!0,l.parent.expect=",",$transition(x,n,o)}return"["==n?(l.parent.expect=",",new $ListOrTupleCtx(l,"list")):"("==n?(l.parent.expect=",",new $ListOrTupleCtx(l,"tuple")):"]"==n?$transition(l.parent,n,o):"{"==n?(l.parent.expect=",",new $DictOrSetCtx(l)):l.parent.transition(n,l)},$PackedCtx.prototype.to_js=function(){return this.js_processed=!0,$to_js(this.tree)};var $PassCtx=$B.parser.$PassCtx=function(n){this.type="pass",this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$PassCtx.prototype.toString=function(){return"(pass)"},$PassCtx.prototype.transition=function(n,o){var l=this;if("eol"==n)return l.parent;$_SyntaxError(l,"token "+n+" after "+l)},$PassCtx.prototype.to_js=function(){return this.js_processed=!0,"void(0)"};var $RaiseCtx=$B.parser.$RaiseCtx=function(n){this.type="raise",this.parent=n,this.tree=[],n.tree[n.tree.length]=this,this.scope_type=$get_scope(this).ntype};$RaiseCtx.prototype.toString=function(){return" (raise) "+this.tree},$RaiseCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":if(0==l.tree.length)return new $IdCtx(new $ExprCtx(l,"exc",!1),o);break;case"from":if(l.tree.length>0)return new $AbstractExprCtx(l,!1);break;case"eol":return $transition(l.parent,n)}$_SyntaxError(l,"token "+n+" after "+l)},$RaiseCtx.prototype.to_js=function(){return this.js_processed=!0,"$B.$raise("+(0==this.tree.length?"":this.tree[0].to_js())+")"};var $RawJSCtx=$B.parser.$RawJSCtx=function(n,o){this.type="raw_js",n.tree[n.tree.length]=this,this.parent=n,this.js=o};$RawJSCtx.prototype.toString=function(){return"(js) "+this.js},$RawJSCtx.prototype.transition=function(n,o){},$RawJSCtx.prototype.to_js=function(){return this.js_processed=!0,this.js};var $ReturnCtx=$B.parser.$ReturnCtx=function(n){this.type="return",this.parent=n,this.tree=[],n.tree[n.tree.length]=this,this.scope=$get_scope(this),-1==["def","generator"].indexOf(this.scope.ntype)&&$_SyntaxError(n,["'return' outside function"]);for(var o=this.node=$get_node(this);o.parent;){if(o.parent.C){var l=o.parent.C.tree[0];if("for"==l.type){l.has_return=!0;break}("try"==l.type||"single_kw"==l.type&&"finally"==l.token)&&(l.has_return=!0)}o=o.parent}};$ReturnCtx.prototype.toString=function(){return"return "+this.tree},$ReturnCtx.prototype.transition=function(n,o){return $transition(this.parent,n)},$ReturnCtx.prototype.to_js=function(){this.js_processed=!0,1==this.tree.length&&"abstract_expr"==this.tree[0].type&&(this.tree.pop(),new $IdCtx(new $ExprCtx(this,"rvalue",!1),"None"));var n=this.scope;if("generator"==n.ntype)return"var $res = "+$to_js(this.tree)+"; $B.leave_frame({$locals});return $B.generator_return($res)";var o="    ".repeat(this.node.indent-1),l="var $res = "+$to_js(this.tree)+";\n"+o+"if($locals.$f_trace !== _b_.None){$B.trace_return($res)}\n"+o+"$B.leave_frame";return"$exec_"==n.id.substr(0,6)&&(l+="_exec"),l+"({$locals});\n"+o+"return $res"};var $SingleKwCtx=$B.parser.$SingleKwCtx=function(n,o){if(this.type="single_kw",this.token=o,this.parent=n,this.tree=[],n.tree[n.tree.length]=this,"else"==o){for(var l=n.node,x=l.parent,N=0;N<x.children.length&&x.children[N]!==l;N++);var U=x.children[N-1].C;if(U.tree.length>0){var G=U.tree[0];("for"==G.type||"asyncfor"==G.type||"condition"==G.type&&"while"==G.token)&&(G.has_break=!0,G.else_node=$get_node(this),this.loop_num=G.loop_num)}}};$SingleKwCtx.prototype.toString=function(){return this.token},$SingleKwCtx.prototype.transition=function(n,o){var l=this;if(":"==n)return $BodyCtx(l);$_SyntaxError(l,"token "+n+" after "+l)},$SingleKwCtx.prototype.transform=function(n,o){if("finally"==this.token){var l=$get_scope(this);n.insert(0,$NodeJS("var $exit;if($B.frames_stack.length < $stack_length){$exit = true;$B.frames_stack.push($top_frame)}")),l.id.replace(/\./g,"_"),"return"!=n.children[n.children.length-1].C.tree[0].type&&n.add($NodeJS("if($exit){$B.leave_frame({$locals})}"))}},$SingleKwCtx.prototype.to_js=function(){return this.js_processed=!0,"finally"==this.token?this.token:void 0!==this.loop_num?"if($locals_"+$get_scope(this).id.replace(/\./g,"_")+'["$no_break'+this.loop_num+'"])':this.token};var $SliceCtx=$B.parser.$SliceCtx=function(n){this.type="slice",this.parent=n,this.tree=n.tree.length>0?[n.tree.pop()]:[],n.tree.push(this)};$SliceCtx.prototype.transition=function(n,o){return":"==n?new $AbstractExprCtx(this,!1):$transition(this.parent,n,o)},$SliceCtx.prototype.to_js=function(){for(var n=0;n<this.tree.length;n++)"abstract_expr"==this.tree[n].type&&(this.tree[n].to_js=function(){return"_b_.None"});return"_b_.slice.$factory("+$to_js(this.tree)+")"};var $StarArgCtx=$B.parser.$StarArgCtx=function(n){this.type="star_arg",this.parent=n,this.tree=[],n.tree[n.tree.length]=this};$StarArgCtx.prototype.toString=function(){return"(star arg) "+this.tree},$StarArgCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":return"target_list"==l.parent.type?(l.tree.push(o),l.parent.expect=",",l.parent):$transition(new $AbstractExprCtx(l,!1),n,o);case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case"not":case"lambda":return $transition(new $AbstractExprCtx(l,!1),n,o);case",":case")":return 0==l.tree.length&&$_SyntaxError(l,"unnamed star argument"),$transition(l.parent,n);case":":if("lambda"==l.parent.parent.type)return $transition(l.parent.parent,n)}$_SyntaxError(l,"token "+n+" after "+l)},$StarArgCtx.prototype.to_js=function(){return this.js_processed=!0,'{$nat:"ptuple",arg:'+$to_js(this.tree)+"}"};var $StringCtx=$B.parser.$StringCtx=function(n,o){this.type="str",this.parent=n,this.tree=[o],n.tree[n.tree.length]=this,this.raw=!1};$StringCtx.prototype.toString=function(){return"string "+(this.tree||"")},$StringCtx.prototype.transition=function(n,o){var l=this;switch(n){case"[":return new $AbstractExprCtx(new $SubCtx(l.parent),!1);case"(":return l.parent.tree[0]=l,new $CallCtx(l.parent);case"str":return l.tree.push(o),l}return $transition(l.parent,n,o)},$StringCtx.prototype.to_js=function(){this.js_processed=!0;var n="",o=null,l=$get_scope(this),x=!1;function N(te){for(var ce=0;ce<te.length;ce++){try{code=te.charCodeAt(ce)}catch(fe){throw console.log("err for s",te),fe}if(code>=55296&&code<=56319)return!0}return!1}function U(te){for(var ce=[],fe=0;fe<te.length;fe++)if("expression"==te[fe].type){for(var _e=te[fe].expression,le=0,pe=[],T=[_e];le<_e.length;){var B=_e.charAt(le);if(":"==B&&0==pe.length){T=[_e.substr(0,le),_e.substr(le+1)];break}"{[(".indexOf(B)>-1?pe.push(B):")]}".indexOf(B)>-1&&pe.pop(),le++}var q=$pos,ee=$B.py2js(_e=T[0],l.module,l.id,l);ee.to_js(),$pos=q;for(var F=0;F<ee.children.length;F++){var Be=ee.children[F];if(Be.C.tree&&1==Be.C.tree.length&&"try"==Be.C.tree[0]){for(var K=0;K<Be.children.length;K++)if(!Be.children[K].is_line_num){for(var ve=Be.children[K].js;"\n;".indexOf(ve.charAt(ve.length-1))>-1;)ve=ve.substr(0,ve.length-1);break}break}}switch(te[fe].conversion){case"a":ve="_b_.ascii("+ve+")";break;case"r":ve="_b_.repr("+ve+")";break;case"s":ve="_b_.str.$factory("+ve+")"}var Ae=T[1];if(void 0!==Ae){var Fe=$B.parse_fstring(Ae),Ee="_b_.str.format('{0:' + "+(Ae=Fe.length>1?U(Fe):"'"+Ae+"'")+" + '}', "+ve+")";ce.push(Ee)}else null===te[fe].conversion&&(ve="_b_.str.$factory("+ve+")"),ce.push(ve)}else{var qe=new RegExp("'","g"),Ke=te[fe].replace(qe,"\\'").replace(/\n/g,"\\n");x=x||N(Ke),ce.push("'"+Ke+"'")}return ce.join(" + ")}function G(te){return(te=te.replace(/\n/g,"\\n\\\n")).replace(/\\U([A-Fa-f0-9]{8})/gm,function(ce){return String.fromCharCode("0x"+ce.slice(2))})}for(var A=0;A<this.tree.length;A++){if("call"==this.tree[A].type)return"(function(){throw _b_.TypeError.$factory(\"'str' object is not callable\")}())";var P=this.tree[A],de=Array.isArray(P),be=!1;if(de||(be="b"==P.charAt(0)),null==o)o=be,be&&(n+="_b_.bytes.$new(_b_.bytes, ");else if(o!=be)return'$B.$TypeError("can\'t concat bytes to str")';be?n+=G(P.substr(1)):de?n+=U(P):(x=x||N(P),n+=G(P)),A<this.tree.length-1&&(n+="+")}return be&&(n+=',"ISO-8859-1")'),0==n.length&&(n='""'),x&&(n="_b_.str.$surrogate.$factory("+n+")"),n};var $SubCtx=$B.parser.$SubCtx=function(n){this.type="sub",this.func="getitem",this.value=n.tree[0],n.tree.pop(),n.tree[n.tree.length]=this,this.parent=n,this.tree=[]};$SubCtx.prototype.toString=function(){return"(sub) (value) "+this.value+" (tree) "+this.tree},$SubCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":case"imaginary":case"int":case"float":case"str":case"bytes":case"[":case"(":case"{":case".":case"not":case"lambda":var x=new $AbstractExprCtx(l,!1);return $transition(x,n,o);case"]":if(l.parent.packed)return l.parent.tree[0];if(l.tree[0].tree.length>0)return l.parent;break;case":":return new $AbstractExprCtx(new $SliceCtx(l),!1);case",":return new $AbstractExprCtx(l,!1)}$_SyntaxError(l,"token "+n+" after "+l)},$SubCtx.prototype.to_js=function(){if(this.js_processed=!0,"getitem"==this.func&&"id"==this.value.type){var n=$get_node(this).locals[this.value.value],o=this.value.to_js();if("list"==n||"tuple"==n){if(1==this.tree.length)return"$B.list_key("+o+", "+this.tree[0].to_js()+")";if(2==this.tree.length)return"$B.list_slice("+o+", "+(this.tree[0].to_js()||"null")+","+(this.tree[1].to_js()||"null")+")";if(3==this.tree.length)return"$B.list_slice_step("+o+", "+(this.tree[0].to_js()||"null")+","+(this.tree[1].to_js()||"null")+","+(this.tree[2].to_js()||"null")+")"}}if("getitem"==this.func&&1==this.tree.length)return"slice"==this.tree[0].type?`$B.getitem_slice(${this.value.to_js()},${this.tree[0].to_js()})`:"$B.$getitem("+this.value.to_js()+","+this.tree[0].to_js()+")";var l="",x=!1;if("delitem"!==this.func&&1==this.tree.length&&!this.in_sub){var N="",U=this;for(x=!0;"sub"==U.value.type;)N+="["+U.tree[0].to_js()+"]",U.value.in_sub=!0,U=U.value;var G=U.value.to_js()+"["+U.tree[0].to_js()+"]((Array.isArray("+U.value.to_js()+") || typeof "+U.value.to_js()+' == "string") && '+G+" !== undefined ?"+G+N+" : "}if(l+="$B.$getattr("+(o=this.value.to_js())+',"__'+this.func+'__")(',1==this.tree.length)l+=this.tree[0].to_js()+")";else{var A=[];this.tree.forEach(function(P){A.push("abstract_expr"==P.type?"_b_.None":P.to_js())}),l+="_b_.tuple.$factory(["+A.join(",")+"]))"}return x?l+")":l};var $TargetListCtx=$B.parser.$TargetListCtx=function(n){this.type="target_list",this.parent=n,this.tree=[],this.expect="id",n.tree[n.tree.length]=this};$TargetListCtx.prototype.toString=function(){return"(target list) "+this.tree},$TargetListCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":if("id"==l.expect)return l.expect=",",new $IdCtx(new $ExprCtx(l,"target",!1),o);case"op":if("id"==l.expect&&"*"==o)return new $PackedCtx(l);case"(":case"[":if("id"==l.expect)return l.expect=",",new $ListOrTupleCtx(l,"("==n?"tuple":"list");case")":case"]":if(","==l.expect)return l.parent;case",":if(","==l.expect)return l.expect="id",l}return","==l.expect||"in"==n?$transition(l.parent,n,o):void $_SyntaxError(l,"token "+n+" after "+l)},$TargetListCtx.prototype.to_js=function(){return this.js_processed=!0,$to_js(this.tree)};var $TernaryCtx=$B.parser.$TernaryCtx=function(n){this.type="ternary",this.parent=n.parent,n.parent.tree.pop(),n.parent.tree.push(this),n.parent=this,this.tree=[n]};$TernaryCtx.prototype.toString=function(){return"(ternary) "+this.tree},$TernaryCtx.prototype.transition=function(n,o){var l=this;if("else"==n)return l.in_else=!0,new $AbstractExprCtx(l,!1);if(l.in_else){if(","==n&&["assign","augm_assign","node","return"].indexOf(l.parent.type)>-1){l.parent.tree.pop();var x=new $ListOrTupleCtx(l.parent,"tuple");return x.implicit=!0,x.tree[0]=l,l.parent=x,x.expect="id",x}}else $_SyntaxError(l,"token "+n+" after "+l);return $transition(l.parent,n,o)},$TernaryCtx.prototype.to_js=function(){this.js_processed=!0;var n="$B.$bool("+this.tree[1].to_js()+") ? ";return(n+=this.tree[0].to_js()+" : ")+this.tree[2].to_js()};var $TryCtx=$B.parser.$TryCtx=function(n){this.type="try",this.parent=n,n.tree[n.tree.length]=this};$TryCtx.prototype.toString=function(){return"(try) "},$TryCtx.prototype.transition=function(n,o){var l=this;if(":"==n)return $BodyCtx(l);$_SyntaxError(l,"token "+n+" after "+l)},$TryCtx.prototype.transform=function(n,o){if(n.parent.children.length==o+1)$_SyntaxError(C,["unexpected EOF while parsing"]);else switch(n.parent.children[o+1].C.tree[0].type){case"except":case"finally":case"single_kw":break;default:$_SyntaxError(C,"no clause after try")}var l=$get_scope(this),x=create_temp_name("$err"),N="$locals."+create_temp_name("$failed"),U=N+" = false;\n"+" ".repeat(n.indent+4)+"try";new $NodeJSCtx(n,U),n.has_return=this.has_return;var G=$NodeJS("catch("+x+")");n.parent.insert(o+1,G),G.add($NodeJS("$B.set_exc("+x+")")),G.add($NodeJS("if($locals.$f_trace !== _b_.None){$locals.$f_trace = $B.trace_exception()}")),G.add($NodeJS(N+" = true;$B.pmframe = $B.last($B.frames_stack);if(false){}"));for(var A=o+2,P=!1,de=!1,be=!1;A!=n.parent.children.length&&void 0!==(le=n.parent.children[A].C.tree[0]);)if("except"==le.type)de&&$_SyntaxError(C,"'except' or 'finally' after 'else'"),be&&$_SyntaxError(C,"'except' after 'finally'"),le.error_name=x,le.tree.length>0&&null!=le.tree[0].alias&&n.parent.children[A].insert(0,$NodeJS('$locals["'+le.tree[0].alias+'"] = $B.exception('+x+")")),G.insert(G.children.length,n.parent.children[A]),0==le.tree.length&&(P&&$_SyntaxError(C,"more than one except: line"),P=!0),n.parent.children.splice(A,1);else if("single_kw"==le.type&&"finally"==le.token){be=!0;var ce=n.parent.children[A];A++}else{if("single_kw"!=le.type||"else"!=le.token)break;de&&$_SyntaxError(C,"more than one 'else'"),be&&$_SyntaxError(C,"'else' after 'finally'"),de=!0;var fe=n.parent.children[A];n.parent.children.splice(A,1)}if(!P){var _e=new $Node,le=new $NodeCtx(_e);G.insert(G.children.length,_e),new $SingleKwCtx(le,"else"),_e.add($NodeJS("throw "+x))}if(de){var pe=new $Node;pe.module=l.module,new $NodeJSCtx(pe,"if(!"+N+")"),fe.children.forEach(function(T){pe.add(T)}),be?ce.insert(0,pe):n.parent.insert(A,pe),A++}$loop_num++},$TryCtx.prototype.to_js=function(){return this.js_processed=!0,"try"};var $UnaryCtx=$B.parser.$UnaryCtx=function(n,o){this.type="unary",this.op=o,this.parent=n,n.tree[n.tree.length]=this};$UnaryCtx.prototype.toString=function(){return"(unary) "+this.op},$UnaryCtx.prototype.transition=function(n,o){var l=this;switch(n){case"int":case"float":case"imaginary":var x=l.parent;return l.parent.parent.tree.pop(),"-"==l.op?o="-"+o:"~"==l.op&&(o=~o),$transition(l.parent.parent,n,o);case"id":l.parent.parent.tree.pop(),x=new $ExprCtx(l.parent.parent,"call",!1);var N=new $ExprCtx(x,"id",!1);return new $IdCtx(N,o),new $AttrCtx(x).name="+"==l.op?"__pos__":"-"==l.op?"__neg__":"__invert__",N;case"op":if("+"==o||"-"==o)return l.op=l.op===o?"+":"-",l}return $transition(l.parent,n,o)},this.to_js=function(){return this.js_processed=!0,this.op};var $WithCtx=$B.parser.$WithCtx=function(n){this.type="with",this.parent=n,n.tree[n.tree.length]=this,this.tree=[],this.expect="as",this.scope=$get_scope(this)};$WithCtx.prototype.toString=function(){return"(with) "+this.tree},$WithCtx.prototype.transition=function(n,o){var l=this;switch(n){case"id":if("id"==l.expect)return l.expect="as",$transition(new $AbstractExprCtx(l,!1),n,o);$_SyntaxError(l,"token "+n+" after "+l);case"as":return new $AbstractExprCtx(new $AliasCtx(l));case":":switch(l.expect){case"id":case"as":case":":return $BodyCtx(l)}break;case"(":if("id"==l.expect&&0==l.tree.length)return l.parenth=!0,l;if("alias"==l.expect)return l.expect=":",new $TargetListCtx(l,!1);break;case")":if(","==l.expect||"as"==l.expect)return l.expect=":",l;break;case",":if(void 0!==l.parenth&&void 0===l.has_alias&&(","==l.expect||"as"==l.expect)||"as"==l.expect||":"==l.expect)return l.expect="id",l}$_SyntaxError(l,"token "+n+" after "+l.expect)},$WithCtx.prototype.set_alias=function(n){var o=[];"id"==n.type?o=[n]:"list_or_tuple"==n.type&&n.tree.forEach(function(U){"expr"==U.type&&"id"==U.tree[0].type&&o.push(U.tree[0])});for(var l=0,x=o.length;l<x;l++){var N=o[l];$bind(N.value,this.scope,this),N.bound=!0,"module"!==this.scope.ntype&&this.scope.C.tree[0].locals.push(N.value)}},$WithCtx.prototype.transform=function(n,o){for(;this.tree.length>1;){var l=n.children,x=this.tree.pop(),N=new $Node,U=new $NodeCtx(N),G=new $WithCtx(U);x.parent=G,G.tree=[x],G.async=this.async,l.forEach(function(q){N.add(q)}),n.children=[N]}if(!this.transformed){if(this.prefix="",this.tree.length>1){var A=new $Node;U=new $NodeCtx(A),A.parent=n,A.module=n.module,A.indent=n.indent+4;var P=new $WithCtx(U);return P.async=this.async,P.tree=this.tree.slice(1),n.children.forEach(function(q){A.add(q)}),n.children=[A],void(this.transformed=!0)}if(this.async)return this.transform_async(n,o);var de=$NodeJS("try");n.parent.insert(o+1,de);var be=this.num=$loop_num++;if(de.ctx_manager_num=be,this.cm_name=this.prefix+"$ctx_manager"+be,this.cmexit_name=this.prefix+"$ctx_manager_exit"+be,this.exc_name=this.prefix+"$exc"+be,this.err_name="$err"+be,this.val_name="$value"+be,this.yield_name=this.prefix+"$yield"+be,null===this.tree[0].alias&&(this.tree[0].alias="$temp"),"expr"==this.tree[0].type&&"list_or_tuple"==this.tree[0].tree[0].type){"expr"==this.tree[1].type&&"list_or_tuple"==this.tree[1].tree[0].type||$_SyntaxError(C),this.tree[0].tree[0].tree.length!=this.tree[1].tree[0].tree.length&&$_SyntaxError(C,["wrong number of alias"]);var te=this.tree[0].tree[0].tree,ce=this.tree[1].tree[0].tree;this.tree.shift(),this.tree.shift();for(var fe=te.length-1;fe>=0;fe--)te[fe].alias=ce[fe].value,this.tree.splice(0,0,te[fe])}var _e=n.children;n.children=[];var le=new $Node;new $NodeJSCtx(le,"try"),de.add(le),this.tree[0].alias&&le.add($NodeJS('$locals["'+(ce=this.tree[0].alias.tree[0].tree[0].value)+'"] = '+this.val_name)),_e.forEach(function(q){le.add(q)});var pe=new $Node;new $NodeJSCtx(pe,"catch("+this.err_name+")");var T=this.exc_name+" = false;"+this.err_name+" = $B.exception("+this.err_name+", true)\n"+" ".repeat(n.indent+4)+"var $b = "+this.cmexit_name+"("+this.err_name+".__class__,"+this.err_name+",$B.$getattr("+this.err_name+', "__traceback__"));';"generator"==this.scope.ntype&&(T+="$B.set_cm_in_generator("+this.cmexit_name+");"),pe.add($NodeJS(T+="if(!$B.$bool($b)){throw "+this.err_name+"}")),de.add(pe);var B=new $Node;new $NodeJSCtx(B,"finally"),B.C.type="single_kw",B.C.token="finally",B.C.in_ctx_manager=!0,B.is_except=!0,B.in_ctx_manager=!0,T="if("+this.exc_name,T+="){"+this.cmexit_name+"(_b_.None, _b_.None, _b_.None);","generator"==this.scope.ntype&&(T+="delete "+this.cmexit_name),B.add($NodeJS(T+="};")),n.parent.insert(o+2,B),this.transformed=!0}},$WithCtx.prototype.transform_async=function(n,o){$get_scope(this);var l=this.tree[0],x=this.tree[0].alias,N=[],U=this.num=$loop_num++;this.cm_name="$ctx_manager"+U,this.cmexit_name="$ctx_manager_exit"+U,this.exc_name="$exc"+U;var G="$ctx_mgr_type"+U,A="$ctx_manager_enter"+U,P="$err"+U,de="var "+this.cm_name+" = "+l.to_js()+",";if(N.push($NodeJS(de)),N.push($NodeJS("    "+G+" = _b_.type.$factory("+this.cm_name+"),")),N.push($NodeJS("    "+this.cmexit_name+" = $B.$call($B.$getattr("+G+', "__aexit__")),')),N.push($NodeJS("    "+A+" = $B.$call($B.$getattr("+G+', "__aenter__"))('+this.cm_name+"),")),N.push($NodeJS("    "+this.exc_name+" = false")),de="",x)if("list_or_tuple"!=x.tree[0].tree[0].type)de=x.tree[0].to_js()+" = await ($B.promise("+A+"))",N.push($NodeJS(de));else{var be=new $Node,te=new $NodeCtx(be);(l=new $ExprCtx(te,"left",!1)).tree.push(x.tree[0].tree[0]),x.tree[0].tree[0].parent=l;var ce=new $AssignCtx(l);new $RawJSCtx(ce,"await ($B.promise("+A+"))"),N.push(be)}else N.push($NodeJS("await ($B.promise("+A+"))"));var fe=new $NodeJS("try");n.children.forEach(function(B){fe.add(B)}),N.push(fe);var _e=new $NodeJS("catch(err)");N.push(_e),_e.add($NodeJS(this.exc_name+" = true")),_e.add($NodeJS("var "+P+' = $B.imported["_sys"].exc_info()'));var le=$NodeJS("if(! await ($B.promise("+this.cmexit_name+"("+this.cm_name+", "+P+"[0], "+P+"[1], "+P+"[2]))))");_e.add(le),le.add($NodeJS("$B.$raise()"));var pe=$NodeJS("if(! "+this.exc_name+")");N.push(pe),pe.add($NodeJS("await ($B.promise("+this.cmexit_name+"("+this.cm_name+", _b_.None, _b_.None, _b_.None)))")),n.parent.children.splice(o,1);for(var T=N.length-1;T>=0;T--)n.parent.insert(o,N[T]);return n.children=[],0},$WithCtx.prototype.to_js=function(){this.js_processed=!0;var n=$get_node(this).indent,o=" ".repeat(n),l=this.num,x=""==this.prefix?"var ":this.prefix,N="$ctx_manager"+l,U=x+"$ctx_manager_exit"+l,G=x+"$exc"+l,A="$value"+l;return"var "+N+" = "+this.tree[0].to_js()+"\n"+o+U+" = $B.$getattr("+N+',"__exit__")\n'+o+"var "+A+" = $B.$getattr("+N+',"__enter__")()\n'+o+G+" = true\n"};var $YieldCtx=$B.parser.$YieldCtx=function(n,o){this.type="yield",this.parent=n,this.tree=[],this.is_await=o,n.tree[n.tree.length]=this,"list_or_tuple"==n.type&&n.tree.length>1&&$_SyntaxError(n,"non-parenthesized yield"),$parent_match(n,{type:"annotation"})&&$_SyntaxError(n,["'yield' outside function"]);for(var l=this;;){var x=$parent_match(l,{type:"list_or_tuple"});if(!x)break;x.yields=x.yields||[],x.yields.push([this,$pos]),l=x}for(l=this;;){var N=$parent_match(l,{type:"dict_or_set"});if(!N)break;N.yields=N.yields||[],N.yields.push([this,$pos]),l=N}var U=$get_module(this);U.yields_func_check=U.yields_func_check||[],U.yields_func_check.push([this,$pos]);var G=this.scope=$get_scope(this,!0),A=$get_node(this);A.has_yield=this;var P=$parent_match(this,{type:"comprehension"});if($get_scope(this).id.startsWith("lc"+$B.lambda_magic)&&delete A.has_yield,P){var de=P.tree[0].tree[1];for(l=n;l&&l!==de;)l=l.parent;l||$_SyntaxError(n,["'yield' inside list comprehension"])}var be=!1;for(l=n;l;){if("lambda"==l.type){be=!0,this.in_lambda=!0;break}l=l.parent}for(l=A.parent;l;){if(l.C&&l.C.tree.length>0&&"with"==l.C.tree[0].type){G.C.tree[0].$has_yield_in_cm=!0;break}l=l.parent}if(!be)switch(n.type){case"node":case"assign":case"list_or_tuple":break;default:$_SyntaxError(n,"yield atom must be inside ()")}};$YieldCtx.prototype.toString=function(){return"(yield) "+(this.from?"(from) ":"")+this.tree},$YieldCtx.prototype.transition=function(n,o){var l=this;return"from"==n?("abstract_expr"!=l.tree[0].type&&$_SyntaxError(l,"'from' must follow 'yield'"),l.from=!0,l.from_num=$B.UUID(),l.tree[0]):$transition(l.parent,n)},$YieldCtx.prototype.transform=function(n,o){for(var l=n.parent;l;){if(void 0!==l.ctx_manager_num){n.parent.insert(o+1,$NodeJS("$top_frame[1].$has_yield_in_cm = true"));break}l=l.parent}},$YieldCtx.prototype.to_js=function(){return this.from?`_r${this.from_num}`:"yield "+$to_js(this.tree)},$YieldCtx.prototype.check_in_function=function(){if(!this.in_lambda){var n=$get_scope(this),o=n.is_function,l=n;if(!o&&n.is_comp){for(var x=n.parent_block;x.is_comp;)x=parent_block;o=x.is_function,l=x}o?this.is_await||(l.C.tree[0].type="generator"):$_SyntaxError(this.parent,["'yield' outside function"])}};var $add_line_num=$B.parser.$add_line_num=function(n,o,l){if("module"!=n.type){if("marker"!==n.type){for(var x=n.C.tree[0],N=1,U=!0,G=n;void 0!==G.parent;)G=G.parent;var P=n.line_num;if(void 0===P&&(U=!1),("condition"==x.type&&"elif"==x.token||"except"==x.type||"single_kw"==x.type)&&(U=!1),U){var de=';$locals.$line_info = "'+(void 0===l?P+","+G.id:l)+'";if($locals.$f_trace !== _b_.None){$B.trace_line()};_b_.None;',be=new $Node;be.is_line_num=!0,new $NodeJSCtx(be,de),n.parent.insert(o,be),N=2}for(te=0;te<n.children.length;)te+=$add_line_num(n.children[te],te,l);return N}return 1}for(var te=0;te<n.children.length;)te+=$add_line_num(n.children[te],te,l)},$bind=$B.parser.$bind=function(n,o,l){if(!o.nonlocals||!o.nonlocals[n])if(o.globals&&o.globals.has(n))$get_module(l).binding[n]=!0;else{if(!l.no_bindings){var x=$get_node(l);x.bindings=x.bindings||{},x.bindings[n]=!0}o.binding=o.binding||{},void 0===o.binding[n]&&(o.binding[n]=!0)}};function $parent_match(n,o){for(var l;n.parent;){for(var x in l=!0,o)if(n.parent[x]!=o[x]){l=!1;break}if(l)return n.parent;n=n.parent}return!1}var $previous=$B.parser.$previous=function(n){var o=n.node.parent.children[n.node.parent.children.length-2];return o&&o.C||$_SyntaxError(n,"keyword not following correct keyword"),o.C.tree[0]},$get_docstring=$B.parser.$get_docstring=function(n){var o="";if(n.children.length>0){var l=n.children[0];if(l.C.tree&&l.C.tree.length>0&&"expr"==l.C.tree[0].type){var x=l.C.tree[0].tree[0];"str"!=x.type||Array.isArray(x.tree[0])||(o=l.C.tree[0].tree[0].to_js())}}return o},$get_scope=$B.parser.$get_scope=function(n,o){for(var l=n.parent;"node"!==l.type;)l=l.parent;for(var x=l.node,N=null;x.parent&&"module"!==x.parent.type;){var U=x.parent.C.tree[0].type;switch(U){case"def":case"class":case"generator":return(N=x.parent).ntype=U,N.is_function="class"!=U,N}x=x.parent}return(N=x.parent||x).ntype="module",N},$get_line_num=$B.parser.$get_line_num=function(n){var o=$get_node(n),l=o.line_num;if(void 0===o.line_num){for(o=o.parent;o&&void 0===o.line_num;)o=o.parent;o&&o.line_num&&(l=o.line_num)}return l},$get_module=$B.parser.$get_module=function(n){for(var o=n.parent;"node"!==o.type;)o=o.parent;var l=o.node;if("module"==l.ntype)return l;for(var x=null;"module"!=l.parent.type;)l=l.parent;return(x=l.parent).ntype="module",x},$get_src=$B.parser.$get_src=function(n){for(var o=$get_node(n);void 0!==o.parent;)o=o.parent;return o.src},$get_node=$B.parser.$get_node=function(n){for(var o=n;o.parent;)o=o.parent;return o.node},$to_js_map=$B.parser.$to_js_map=function(n){if(void 0!==n.to_js)return n.to_js();throw Error("no to_js() for "+n)},$to_js=$B.parser.$to_js=function(n,o){return void 0===o&&(o=","),n.map($to_js_map).join(o)},$mangle=$B.parser.$mangle=function(n,o){if("__"!=n.substr(0,2)||"__"===n.substr(n.length-2))return n;for(var l=$get_scope(o);;){if("module"==l.ntype)return n;if("class"==l.ntype){for(var x=l.C.tree[0].name;"_"==x.charAt(0);)x=x.substr(1);return"_"+x+n}if(!l.parent||!l.parent.C)return n;l=$get_scope(l.C.tree[0])}},$transition=$B.parser.$transition=function(n,o,l){return n.transition(o,l)};$B.forbidden=["alert","arguments","case","catch","const","constructor","Date","debugger","delete","default","do","document","enum","export","eval","extends","Error","history","function","instanceof","keys","length","location","Math","message","new","null","Number","RegExp","String","super","switch","this","throw","typeof","var","window","toLocaleString","toString","void"],$B.aliased_names=$B.list2obj($B.forbidden);for(var s_escaped="abfnrtvxuU\"0123456789'\\",is_escaped={},i=0;i<s_escaped.length;i++)is_escaped[s_escaped.charAt(i)]=!0;var $tokenize=$B.parser.$tokenize=function(root,src){for(var br_close={")":"(","]":"[","}":"{"},br_stack="",br_pos=[],kwdict=["class","return","break","for","lambda","try","finally","raise","def","from","nonlocal","while","del","global","with","as","elif","else","if","yield","assert","import","except","raise","in","pass","with","continue","__debugger__","async","await"],unsupported=[],$indented=["class","def","for","condition","single_kw","try","except","with"],int_pattern=/^(\d[0-9_]*)(j|J)?/,float_pattern1=/^(\d[\d_]*)\.(\d+(_\d+)*)?([eE][+-]?\d+(_\d+)*)?(j|J)?/,float_pattern2=/^(\d[\d_]*)([eE][+-]?\d+(_\d+)*)(j|J)?/,hex_pattern=/^0[xX]([\da-fA-F_]+)/,octal_pattern=/^0[oO]([0-7_]+)/,binary_pattern=/^0[bB]([01_]+)/,C=null,new_node=new $Node,current=root,name="",_type=null,pos=0,indent=null,string_modifier=!1,module=root.module,lnum=root.line_num||1;pos<src.length;){function rmuf(n){return(n.search("__")>-1||n.endsWith("_"))&&$_SyntaxError(C,"invalid literal"),n.replace(/_/g,"")}function check_int(n){if(rmuf(n),n.startsWith("0")){if(!(n.substr(1).search(/[^0_]/)>-1))return"0";$_SyntaxError(C,"invalid literal")}}function rmu(n){return n.replace(/_/g,"")}var car=src.charAt(pos);if(null!==indent)if("#"!=car)if('"'!=car&&"'"!=car){if(""==name&&"$"!=car){if($B.unicode_tables.XID_Start[car.charCodeAt(0)]){name=car;var p0=pos;for(pos++;pos<src.length&&$B.unicode_tables.XID_Continue[src.charCodeAt(pos)];)name+=src.charAt(pos),pos++}if(name){if(kwdict.indexOf(name)>-1)$pos=pos-name.length,unsupported.indexOf(name)>-1&&$_SyntaxError(C,"Unsupported Python keyword '"+name+"'"),C=$transition(C,name);else if("string"==typeof $operators[name]&&-1==["is_not","not_in"].indexOf(name))if("is"==name){var re=/^\s+not\s+/,res=re.exec(src.substr(pos));null!==res?(pos+=res[0].length,$pos=pos-name.length,C=$transition(C,"op","is_not")):($pos=pos-name.length,C=$transition(C,"op",name))}else if("not"==name){var re=/^\s+in\s+/,res=re.exec(src.substr(pos));null!==res?(pos+=res[0].length,$pos=pos-name.length,C=$transition(C,"op","not_in")):($pos=pos-name.length,C=$transition(C,name))}else $pos=pos-name.length,C=$transition(C,"op",name);else{if(('"'==src.charAt(pos)||"'"==src.charAt(pos))&&-1!==["r","b","u","rb","br","f","fr","rf"].indexOf(name.toLowerCase())){string_modifier=name.toLowerCase(),name="";continue}$B.forbidden.indexOf(name)>-1&&(name="$$"+name),$pos=pos-name.length,C=$transition(C,"id",name)}name="";continue}}switch(car){case" ":case"\t":pos++;break;case".":if(pos<src.length-1&&/^\d$/.test(src.charAt(pos+1))){for(var j=pos+1;j<src.length&&src.charAt(j).search(/\d|e|E|_/)>-1;)j++;"j"==src.charAt(j)?(C=$transition(C,"imaginary","0"+rmu(src.substr(pos,j-pos))),j++):C=$transition(C,"float","0"+rmu(src.substr(pos,j-pos))),pos=j;break}$pos=pos,C=$transition(C,"."),pos++;break;case"0":var res=hex_pattern.exec(src.substr(pos));if(res){rmuf(res[1]),C=$transition(C,"int",[16,rmu(res[1])]),pos+=res[0].length;break}var res=octal_pattern.exec(src.substr(pos));if(res){C=$transition(C,"int",[8,rmuf(res[1])]),pos+=res[0].length;break}var res=binary_pattern.exec(src.substr(pos));if(res){C=$transition(C,"int",[2,rmuf(res[1])]),pos+=res[0].length;break}if(src.charAt(pos+1).search(/\d/)>-1){if(0===parseInt(src.substr(pos))){res=int_pattern.exec(src.substr(pos)),$pos=pos,check_int(res[0]),C=$transition(C,"int",[10,rmu(res[0])]),pos+=res[0].length;break}$_SyntaxError(C,"invalid literal starting with 0")}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":var res=float_pattern1.exec(src.substr(pos));res?(check_int(res[1]),res[2]&&rmuf(res[2]),$pos=pos,C=void 0!==$B.last(res)?$transition(C,"imaginary",rmuf(res[0].substr(0,res[0].length-1))):$transition(C,"float",rmuf(res[0]))):(res=float_pattern2.exec(src.substr(pos)),res?(check_int(res[1]),$pos=pos,C=void 0!==$B.last(res)?$transition(C,"imaginary",rmuf(res[0].substr(0,res[0].length-1))):$transition(C,"float",rmuf(res[0]))):(res=int_pattern.exec(src.substr(pos)),check_int(res[1]),$pos=pos,C=void 0!==res[2]?$transition(C,"imaginary",rmu(res[1])):$transition(C,"int",[10,rmu(res[0])]))),pos+=res[0].length;break;case"\n":lnum++,br_stack.length>0||(current.C.tree.length>0||current.C.async?($pos=pos,C=$transition(C,"eol"),indent=null,new_node=new $Node):new_node.line_num=lnum),pos++;break;case"(":case"[":case"{":br_stack+=car,br_pos[br_stack.length-1]=[C,pos],$pos=pos,C=$transition(C,car),pos++;break;case")":case"]":case"}":""==br_stack?($pos=pos,$_SyntaxError(C,"Unexpected closing bracket")):br_close[car]!=br_stack.charAt(br_stack.length-1)?($pos=pos,$_SyntaxError(C,"Unbalanced bracket")):(br_stack=br_stack.substr(0,br_stack.length-1),$pos=pos,C=$transition(C,car),pos++);break;case"=":"="!=src.charAt(pos+1)?($pos=pos,C=$transition(C,"="),pos++):($pos=pos,C=$transition(C,"op","=="),pos+=2);break;case",":case":":$pos=pos,":="==src.substr(pos,2)?(C=$transition(C,":="),pos++):C=$transition(C,car),pos++;break;case";":$transition(C,"eol"),0==current.C.tree.length&&($pos=pos,$_SyntaxError(C,"invalid syntax"));for(var pos1=pos+1,ends_line=!1;pos1<src.length;){var _s=src.charAt(pos1);if("\n"==_s||"#"==_s){ends_line=!0;break}if(" "!=_s)break;pos1++}if(ends_line){pos++;break}new_node=new $Node,new_node.indent=$get_node(C).indent,new_node.line_num=lnum,new_node.module=module,$get_node(C).parent.add(new_node),current=new_node,C=new $NodeCtx(new_node),pos++;break;case"/":case"%":case"&":case">":case"<":case"-":case"+":case"*":case"@":case"/":case"^":case"=":case"|":case"~":case"!":if("-"==car&&">"==src.charAt(pos+1)){C=$transition(C,"annotation"),pos+=2;continue}if("@"==car&&"node"==C.type){$pos=pos,C=$transition(C,car),pos++;break}var op_match="";for(var op_sign in $operators)op_sign==src.substr(pos,op_sign.length)&&op_sign.length>op_match.length&&(op_match=op_sign);$pos=pos,op_match.length>0?(C=$transition(C,op_match in $augmented_assigns?"augm_assign":"op",op_match),pos+=op_match.length):$_SyntaxError(C,"invalid character: "+car);break;case"\\":if("\n"==src.charAt(pos+1)){lnum++,pos+=2,pos==src.length?$_SyntaxError(C,["unexpected EOF while parsing"]):"node"==C.type&&$_SyntaxError(C,"nothing before \\");break}$pos=pos,$_SyntaxError(C,["unexpected character after line continuation character"]);case"\f":pos+=1;break;default:$pos=pos,$_SyntaxError(C,"unknown token ["+car+"]")}}else{var raw="str"==C.type&&C.raw,bytes=!1,fstring=!1,sm_length,end=null;if(string_modifier){switch(string_modifier){case"r":raw=!0;break;case"u":break;case"b":bytes=!0;break;case"rb":case"br":bytes=!0,raw=!0;break;case"f":fstring=!0,sm_length=1;break;case"rf":fstring=!0,sm_length=2,raw=!0}string_modifier=!1}src.substr(pos,3)==car+car+car?(_type="triple_string",end=pos+3):(_type="string",end=pos+1);for(var escaped=!1,zone=car,found=!1;end<src.length;)if(escaped)"a"==src.charAt(end)?zone=zone.substr(0,zone.length-1)+"\x07":(zone+=src.charAt(end),raw&&"\\"==src.charAt(end)&&(zone+="\\")),escaped=!1,end++;else if("\\"==src.charAt(end))if(raw)end<src.length-1&&src.charAt(end+1)==car?(zone+="\\\\"+car,end+=2):(zone+="\\\\",end++),escaped=!0;else if("\n"==src.charAt(end+1))end+=2,lnum++;else if("N{"==src.substr(end+1,2)){var end_lit=end+3,re=new RegExp("[-a-zA-Z0-9 ]+"),search=re.exec(src.substr(end_lit));null===search&&$_SyntaxError(C,"(unicode error) malformed \\N character escape",pos);var end_lit=end_lit+search[0].length;"}"!=src.charAt(end_lit)&&$_SyntaxError(C,"(unicode error) malformed \\N character escape");var description=search[0].toUpperCase();if(void 0===$B.unicodedb){var xhr=new XMLHttpRequest;xhr.open("GET",$B.brython_path+"unicode.txt",!1),xhr.onreadystatechange=function(){4==this.readyState&&(200==this.status?$B.unicodedb=this.responseText:console.log("Warning - could not load unicode.txt"))},xhr.send()}if(void 0!==$B.unicodedb){var re=new RegExp("^([0-9A-F]+);"+description+";.*$","m");search=re.exec($B.unicodedb),null===search&&$_SyntaxError(C,"(unicode error) unknown Unicode character name");var cp="0x"+search[1];zone+=String.fromCodePoint(eval(cp)),end=end_lit+1}else end++}else end<src.length-1&&void 0===is_escaped[src.charAt(end+1)]&&(zone+="\\"),zone+="\\",escaped=!0,end++;else if("\n"==src.charAt(end)&&"triple_string"!=_type)console.log(pos,end,src.substring(pos,end)),$pos=end,$_SyntaxError(C,["EOL while scanning string literal"]);else if(src.charAt(end)==car){if("triple_string"!=_type||src.substr(end,3)==car+car+car){found=!0,$pos=pos;for(var $string=zone.substr(1),string="",i=0;i<$string.length;i++){var $car=$string.charAt(i);$car!=car||!raw&&0!=i&&"\\"==$string.charAt(i-1)||(string+="\\"),string+=$car}if(fstring)try{var re=new RegExp("\\\\"+car,"g"),string_no_bs=string.replace(re,car),elts=$B.parse_fstring(string_no_bs)}catch(n){$_SyntaxError(C,[n.toString()])}bytes?C=$transition(C,"str","b"+car+string+car):fstring?($pos-=sm_length,C=$transition(C,"str",elts),$pos+=sm_length):C=$transition(C,"str",car+string+car),C.raw=raw,pos=end+1,"triple_string"==_type&&(pos=end+3);break}zone+=src.charAt(end),end++}else zone+=src.charAt(end),"\n"==src.charAt(end)&&lnum++,end++;found||$_SyntaxError(C,"triple_string"===_type?"Triple string end not found":"String end not found")}else{var end=src.substr(pos+1).search("\n");-1==end&&(end=src.length-1),root.comments.push([pos,end]),pos+=end+1}else{for(var indent=0;pos<src.length;){var _s=src.charAt(pos);if(" "==_s)indent++,pos++;else{if("\t"!=_s)break;indent++,pos++,indent%8>0&&(indent+=8-indent%8)}}var _s=src.charAt(pos);if("\n"==_s){pos++,lnum++,indent=null;continue}if("#"==_s){var offset=src.substr(pos).search(/\n/);if(-1==offset)break;pos+=offset+1,lnum++,indent=null;continue}if(new_node.indent=indent,new_node.line_num=lnum,new_node.module=module,current.is_body_node&&(current.indent=indent),indent>current.indent)null!==C&&-1==$indented.indexOf(C.tree[0].type)&&($pos=pos,$_SyntaxError(C,"unexpected indent",pos)),current.add(new_node);else if(indent<=current.indent&&C&&C.tree[0]&&$indented.indexOf(C.tree[0].type)>-1&&C.tree.length<2)$pos=pos,$_SyntaxError(C,"expected an indented block",pos);else{for(;indent!==current.indent;)current=current.parent,(void 0===current||indent>current.indent)&&($pos=pos,$_SyntaxError(C,"unexpected indent",pos));current.parent.add(new_node)}current=new_node,C=new $NodeCtx(new_node)}}if(0!=br_stack.length){var br_err=br_pos[0];$pos=br_err[1];var lines=src.split("\n"),id=root.id,fname=id.startsWith("$")?"<string>":id;$_SyntaxError(br_err[0],["unexpected EOF while parsing ("+fname+", line "+(lines.length-1)+")"])}if(null!==C){if("async"==C.type)throw console.log("error with async",pos,src,src.substr(pos)),$pos=pos-7,$_SyntaxError(C,"car "+car+"after async",pos);if(C.tree[0]&&$indented.indexOf(C.tree[0].type)>-1)$pos=pos-1,$_SyntaxError(C,"expected an indented block",pos);else{var parent=current.parent;if(parent.C&&parent.C.tree&&parent.C.tree[0]&&"try"==parent.C.tree[0].type&&($pos=pos-1,$_SyntaxError(C,["unexpected EOF while parsing"])),root.yields_func_check){var save_pos=$pos;for(const n of root.yields_func_check)$pos=n[1],n[0].check_in_function();$pos=save_pos}}}},$create_root_node=$B.parser.$create_root_node=function(n,o,l,x,N){var U=new $Node("module");return U.module=o,U.id=l,U.binding={__doc__:!0,__name__:!0,__file__:!0,__package__:!0},U.parent_block=x,U.line_num=N,U.indent=-1,U.comments=[],U.imports={},"object"==typeof n&&(U.is_comp=n.is_comp,n.has_annotations&&(U.binding.__annotations__=!0),n=n.src),U.src=n,U};$B.py2js=function(n,o,l,x,N){if($pos=0,"object"==typeof o){var U=o.__package__;o=o.__name__}else U="";x=x||$B.builtins_scope;var G=(new Date).getTime(),A=!1,P=!0;if("object"==typeof n){A=n.is_comp,P=n.has_annotations;var de=n.line_info,be=n.ix;void 0!==de&&(N=parseInt(de.split(",")[0])),n=n.src}(n=n.replace(/\r\n/gm,"\n")).endsWith("\\")&&!n.endsWith("\\\\")&&(n=n.substr(0,n.length-1)),"\n"!=n.charAt(n.length-1)&&(n+="\n"),Array.isArray(l)&&(l=l[0]),l.charAt(0);var te="$locals_"+l.replace(/\./g,"_"),ce="$locals_"+o.replace(/\./g,"_"),fe=$create_root_node({src:n,is_comp:A,has_annotations:P},o,l,x,N);$tokenize(fe,n),fe.is_comp=A,null!=be&&(fe.ix=be),fe.transform();var _e=1;(T=["var $B = __BRYTHON__;\n"])[_e++]="var _b_ = __BRYTHON__.builtins;\n",T[2]="var $locals = "+te,A&&(T[2]+=" = {}");var le=0;fe.insert(0,$NodeJS(T.join(""))),le++,fe.insert(le++,$NodeJS(te+'.__package__ = "'+U+'"')),fe.binding.__annotations__&&fe.insert(le++,$NodeJS("$locals.__annotations__ = $B.empty_dict()"));var pe=le,T='var $top_frame = ["'+l.replace(/\./g,"_")+'", '+te+', "'+o.replace(/\./g,"_")+'", '+ce+"]\n$locals.$f_trace = $B.enter_frame($top_frame)\nvar $stack_length = $B.frames_stack.length;";fe.insert(le++,$NodeJS(T));var B=new $NodeJS("try"),q=fe.children.slice(pe+1,fe.children.length);fe.insert(pe+1,B),0==q.length&&(q=[$NodeJS("")]),q.forEach(function(Be){B.add(Be)}),B.add($NodeJS("$B.leave_frame({$locals, value: _b_.None})")),fe.children.splice(pe+2,fe.children.length);var ee=$NodeJS("catch(err)");ee.add($NodeJS("$B.leave_frame({$locals, value: _b_.None})")),ee.add($NodeJS("throw err")),fe.add(ee),$add_line_num(fe,null,de);var F=(new Date).getTime();return $B.debug>2&&o==l&&console.log("module "+o+" translated in "+(F-G)+" ms"),$B.compile_time+=F-G,fe},$B.set_import_paths=function(){var n=[],o=[];$B.use_VFS&&n.push($B.finders.VFS),!1!==$B.$options.static_stdlib_import&&"file"!=$B.protocol&&(n.push($B.finders.stdlib_static),$B.path.length>3&&($B.path.shift(),$B.path.shift())),"file"!==$B.protocol&&(n.push($B.finders.path),o.push($B.$path_hooks[0])),$B.$options.cpython_import&&("replace"==$B.$options.cpython_import&&$B.path.pop(),n.push($B.finders.CPython)),$B.meta_path=n,$B.path_hooks=o};var brython=$B.parser.brython=function(n){void 0===n&&(n={debug:1}),"number"==typeof n&&(n={debug:n}),void 0===n.debug&&(n.debug=1),$B.debug=n.debug,_b_.__debug__=$B.debug>0,$B.compile_time=0,void 0===n.profile&&(n.profile=0),$B.profile=n.profile,void 0===n.indexedDB&&(n.indexedDB=!0),void 0===n.static_stdlib_import&&(n.static_stdlib_import=!0),$B.static_stdlib_import=n.static_stdlib_import,$B.$options=n,$B.set_import_paths();var o=($B.script_path=_window.location.href).split("/");if(o.pop(),($B.isWebWorker||$B.isNode)&&o.pop(),$B.curdir=o.join("/"),void 0!==n.pythonpath&&($B.path=n.pythonpath,$B.$options.static_stdlib_import=!1),n.python_paths&&n.python_paths.forEach(function(P){var de,be;"string"!=typeof P&&(de=P.lang,be=P.prefetch,P=P.path),$B.path.push(P),".vfs.js"!=P.slice(-7).toLowerCase()||void 0!==be&&!0!==be||($B.path_importer_cache[P+"/"]=$B.imported._importlib.VFSPathFinder(P)),de&&N.optimize_import_for_path(P,de)}),!$B.isWebWorker&&!$B.isNode)for(var l,x=document.querySelectorAll("head link[rel~=pythonpath]"),N=$B.imported._importlib,U=0;l=x[U];++U){var G=l.href;-1!=(" "+l.rel+" ").indexOf(" prepend ")?$B.path.unshift(G):$B.path.push(G);var A=l.hreflang;A&&("x-"==A.slice(0,2)&&(A=A.slice(2)),N.optimize_import_for_path(l.href,A))}$B.__ARGV=$B.$options.args?$B.$options.args:_b_.list.$factory([]),$B.isWebWorker||$B.isNode||_run_scripts(n)};$B.run_script=function(n,o,l){$B.$py_module_path[o]=$B.script_path;try{var x=$B.py2js(n,o,o),N=x.to_js(),U={__doc__:x.__doc__,js:N,__name__:o,$src:n,__file__:$B.script_path+($B.script_path.endsWith("/")?"":"/")+o};$B.file_cache[U.__file__]=n,$B.debug>1&&console.log(N)}catch(P){$B.handle_error(P)}if($B.hasOwnProperty("VFS")&&$B.has_indexedDB){var G=Object.keys(x.imports).slice().filter(function(P){return $B.VFS.hasOwnProperty(P)});Object.keys(G).forEach(function(P){if($B.VFS.hasOwnProperty(P)){var de=$B.VFS[P],be=de[0];if(".py"==be){var te=de[2];".py"==be&&required_stdlib_imports(te),te.forEach(function(ce){-1==G.indexOf(ce)&&G.push(ce)})}}});for(var A=0;A<G.length;A++)$B.tasks.push([$B.inImported,G[A]]);x=null}$B.tasks.push(["execute",U]),l&&$B.loop()};var $log=$B.$log=function(n){n.split("\n").forEach(function(o,l){console.log(l+1,":",o)})},_run_scripts=$B.parser._run_scripts=function(options){var kk=Object.keys(_window),defined_ids={};if(void 0!==options.ipy_id){var $elts=[];options.ipy_id.forEach(function(n){$elts.push(document.getElementById(n))})}else for(var scripts=document.getElementsByTagName("script"),$elts=[],webworkers=[],i=0;i<scripts.length;i++){var script=scripts[i];if("text/python"==script.type||"text/python3"==script.type)if("webworker"==script.className){if(void 0===script.id)throw _b_.AttributeError.$factory("webworker script has no attribute 'id'");webworkers.push(script)}else $elts.push(script)}var first_script=!0,module_name;if(void 0!==options.ipy_id){module_name="__main__";var $src="",js,root;$B.$py_module_path[module_name]=$B.script_path,$elts.forEach(function(n){$src+=n.innerHTML||n.textContent});try{root=$B.py2js($src,module_name,module_name),js=root.to_js(),$B.debug>1&&$log(js),eval(js),$B.clear_ns(module_name),root=null,js=null}catch(n){if(root=null,js=null,console.log(n),$B.debug>1)for(var attr in console.log(n),n)console.log(attr+" : ",n[attr]);void 0===n.$py_error&&(console.log("Javascript error",n),n=_b_.RuntimeError.$factory(n+""));var $trace=$B.$getattr(n,"info")+"\n"+n.__name__+": "+n.args;try{$B.$getattr($B.stderr,"write")($trace)}catch{console.log($trace)}throw n}}else{$elts.length>0&&options.indexedDB&&$B.has_indexedDB&&$B.hasOwnProperty("VFS")&&$B.tasks.push([$B.idb_open]);for(var i=0;i<$elts.length;i++){var elt=$elts[i];if(elt.id){if(defined_ids[elt.id])throw Error("Brython error : Found 2 scripts with the same id '"+elt.id+"'");defined_ids[elt.id]=!0}}for(var src,i=0,len=webworkers.length;i<len;i++){var worker=webworkers[i];worker.src?$B.tasks.push([$B.ajax_load_script,{name:worker.id,url:worker.src,is_ww:!0}]):(src=worker.innerHTML||worker.textContent,src=src.replace(/^\n/,""),$B.webworkers[worker.id]=src)}for(var i=0;i<$elts.length;i++){var elt=$elts[i];if("text/python"==elt.type||"text/python3"==elt.type){if(elt.id)module_name=elt.id;else for(first_script?(module_name="__main__",first_script=!1):module_name="__main__"+$B.UUID();void 0!==defined_ids[module_name];)module_name="__main__"+$B.UUID();elt.src?$B.tasks.push([$B.ajax_load_script,{name:module_name,url:elt.src}]):(src=elt.innerHTML||elt.textContent,src=src.replace(/^\n/,""),$B.run_script(src,module_name))}}}void 0===options.ipy_id&&$B.loop()};$B.$operators=$operators,$B.$Node=$Node,$B.$NodeJSCtx=$NodeJSCtx,$B.brython=brython}(__BRYTHON__);var brython=__BRYTHON__.brython;__BRYTHON__.isNode&&(__webpack_require__.g.__BRYTHON__=__BRYTHON__,module.exports={__BRYTHON__}),function(n){var o=n.builtins;function l(G,A,P,de,be){var te=n.idb_cx.result.transaction("modules","readwrite").objectStore("modules"),ce=(te.openCursor(),{name:G,content:A,imports:de,origin,timestamp:__BRYTHON__.timestamp,source_ts:P,is_package:be}),fe=te.put(ce);n.debug>1&&console.log("store precompiled",G,"package",be),document.dispatchEvent(new CustomEvent("precompile",{detail:"cache module "+G}));var _e=n.outdated.indexOf(G);_e>-1&&n.outdated.splice(_e,1),fe.onsuccess=function(le){n.tasks.splice(0,0,[x,G]),U()}}function x(G){var A=n.idb_cx.result.transaction("modules","readonly");try{var P=A.objectStore("modules");req=P.get(G),req.onsuccess=function(de){!function(be,te){var ce=be.target.result;if(void 0===ce||ce.timestamp!=n.timestamp||n.VFS[te]&&ce.source_ts!==n.VFS[te].timestamp){if(void 0!==n.VFS[te]){var fe=(Fe=n.VFS[te])[0],_e=Fe[1];if(".py"==fe){var le,pe,T=Fe[2],B=4==Fe.length,q=Fe.timestamp;B?le=te:((pe=te.split(".")).pop(),le=pe.join(".")),n.imported[te]=n.module.$factory(te,"",le);try{var ee=n.py2js(_e,te,te).to_js()}catch(qe){n.handle_error(qe)}delete n.imported[te],n.debug>1&&console.log("precompile",te),(pe=te.split(".")).length>1&&pe.pop(),n.stdlib.hasOwnProperty(pe.join("."))&&(T=(T=Fe[2]).join(","),n.tasks.splice(0,0,[l,te,ee,q,T,B]))}else console.log("bizarre",te,fe)}}else if(n.precompiled[te]=ce.is_package?[ce.content]:ce.content,ce.imports.length>0){n.debug>1&&console.log(te,"imports",ce.imports);for(var F=ce.imports.split(","),Be=0;Be<F.length;Be++){var K=F[Be];if(K.startsWith(".")){for(var ve=te.split("."),Ae=0;K.startsWith(".");)Ae++,K=K.substr(1);var Fe=ve.slice(0,Ae);K&&(Fe=Fe.concat([K])),K=Fe.join(".")}if(!n.imported.hasOwnProperty(K)&&!n.precompiled.hasOwnProperty(K)&&n.VFS.hasOwnProperty(K)){var Ee=n.VFS[K];fe=Ee[0],_e=Ee[1],".py"==Ee[0]?n.tasks.splice(0,0,[x,K]):N(K,_e)}}}U()}(de,G)}}catch(de){console.info("error",de)}}function N(G,A){A+="\nvar $locals_"+G.replace(/\./g,"_")+" = $module",n.precompiled[G]=A}n.VFS_timestamp&&n.VFS_timestamp>n.timestamp&&(n.timestamp=n.VFS_timestamp),n.idb_open=function(G){n.idb_name="brython-cache";var A=n.idb_cx=indexedDB.open(n.idb_name);A.onsuccess=function(){var P=A.result;if(P.objectStoreNames.contains("modules")){n.debug>1&&console.info("using indexedDB for stdlib modules cache");var de,be=P.transaction("modules","readwrite").objectStore("modules"),te=[],ce=be.openCursor();ce.onerror=function(_e){console.log("open cursor error",_e)},ce.onsuccess=function(_e){cursor=_e.target.result,cursor?((de=cursor.value).timestamp==n.timestamp?n.VFS&&n.VFS[de.name]&&n.VFS[de.name].timestamp!=de.source_ts?te.push(de.name):(n.precompiled[de.name]=de.is_package?[de.content]:de.content,n.debug>1&&console.info("load from cache",de.name)):te.push(de.name),cursor.continue()):(n.debug>1&&console.log("done"),n.outdated=te,U())}}else{var fe=P.version;P.close(),console.info("create object store",fe),(A=indexedDB.open(n.idb_name,fe+1)).onupgradeneeded=function(){console.info("upgrade needed"),n.idb_cx.result.createObjectStore("modules",{keyPath:"name"}).onsuccess=U},A.onversionchanged=function(){console.log("version changed")},A.onsuccess=function(){console.info("db opened",A),A.result.createObjectStore("modules",{keyPath:"name"}).onsuccess=U}}},A.onupgradeneeded=function(){console.info("upgrade needed"),A.result.createObjectStore("modules",{keyPath:"name"}).onsuccess=U},A.onerror=function(){console.info("could not open indexedDB database"),n.idb_cx=null,n.idb_name=null,n.$options.indexedDB=!1,U()}},n.ajax_load_script=function(G){var A=G.url,P=G.name;if(n.files&&n.files.hasOwnProperty(P))n.tasks.splice(0,0,[n.run_script,n.files[P],P,!0]);else{if("file"==n.protocol)throw o.IOError.$factory("can't load external script at "+G.url+" (Ajax calls not supported with protocol file:///)");var de=new XMLHttpRequest,be=n.$options.cache?"":(A.search(/\?/)>-1?"&":"?")+Date.now();de.open("GET",A+be,!0),de.onreadystatechange=function(){if(4==this.readyState)if(200==this.status){var te=this.responseText;G.is_ww?n.webworkers[P]=te:n.tasks.splice(0,0,[n.run_script,te,P,!0]),U()}else if(404==this.status)throw Error(A+" not found")},de.send()}},n.inImported=function(G){if(!n.imported.hasOwnProperty(G))if(__BRYTHON__.VFS&&__BRYTHON__.VFS.hasOwnProperty(G)){var A=__BRYTHON__.VFS[G];void 0===A&&console.log("bizarre",G);var de=A[1];".py"==A[0]?n.idb_cx&&!n.idb_cx.$closed&&n.tasks.splice(0,0,[x,G]):N(G,de)}else console.log("bizarre",G);U()};var U=n.loop=function(){if(0!=n.tasks.length){var G=n.tasks.shift(),A=G[0],P=G.slice(1);if("execute"==A){try{var de=G[1],be=de.__name__.replace(/\./g,"_");(ce=n.module.$factory(de.__name__)).$src=de.$src,ce.__file__=de.__file__,n.imported[be]=ce,new Function("$locals_"+be,de.js)(ce)}catch(fe){void 0===fe.__class__&&(console.log("Javascript error",fe),n.is_recursion_error(fe)?fe=o.RecursionError.$factory("too much recursion"):(n.print_stack(),fe=o.RuntimeError.$factory(fe+""))),n.debug>1&&(console.log("handle error",fe.__class__,fe.args,fe.$stack),console.log(n.frames_stack.slice())),n.handle_error(fe)}U()}else try{A.apply(null,P)}catch(fe){n.handle_error(fe)}}else if(n.idb_cx&&!n.idb_cx.$closed){for(var te=n.idb_cx.result.transaction("modules","readwrite").objectStore("modules");n.outdated.length>0;){var ce=n.outdated.pop();te.delete(ce).onsuccess=function(fe){n.debug>1&&console.info("delete outdated",ce),document.dispatchEvent(new CustomEvent("precompile",{detail:"remove outdated "+ce+" from cache"}))}}document.dispatchEvent(new CustomEvent("precompile",{detail:"close"})),n.idb_cx.result.close(),n.idb_cx.$closed=!0}};n.tasks=[],n.has_indexedDB=void 0!==self.indexedDB,n.handle_error=function(G){if(n.debug>1&&console.log("handle error",G.__class__,G.args),void 0!==G.__class__){var A=n.class_name(G),P=n.$getattr(G,"info");"SyntaxError"==A||"IndentationError"==A?P+="\n    "+" ".repeat(G.args[3])+"^\n"+A+": "+G.args[0]:(P+="\n"+A,G.args[0]&&G.args[0]!==o.None&&(P+=": "+o.str.$factory(G.args[0])))}else console.log(G),P=G+"";try{n.$getattr(n.stderr,"write")(P);try{n.$getattr(n.stderr,"flush")()}catch(be){console.log(be)}}catch{console.log(P)}throw G}}(__BRYTHON__),__BRYTHON__.builtins.object=function(n){var o=n.builtins,l={$infos:{__name__:"object"},$is_class:!0,$native:!0};function x(N){return n.$getattr(N,"__new__").apply(null,arguments)}return l.__delattr__=function(N,U){if(U=n.from_alias(U),N.__dict__&&N.__dict__.$string_dict&&void 0!==N.__dict__.$string_dict[U])return delete N.__dict__.$string_dict[U],o.None;if(void 0===N.__dict__&&void 0!==N[U])return delete N[U],o.None;var G=N.__class__;if(G){var A=n.$getattr(G,U);if(A.__class__===o.property&&void 0!==A.__delete__)return A.__delete__(N),o.None}throw o.AttributeError.$factory(U)},l.__dir__=function(N){var U;if(N.$is_class)U=[N].concat(N.__mro__);else{var G=N.__class__||n.get_class(N);U=[N,G].concat(G.__mro__)}for(var A=[],P=0,de=U.length;P<de;P++)for(var be in U[P])"$"!=be.charAt(0)?isNaN(parseInt(be.charAt(0)))&&"__mro__"!=be&&A.push(be):"$"==be.charAt(1)&&A.push(be.substr(2));if(N.__dict__)for(var be in N.__dict__.$string_dict)"$$"==be.substr(0,2)?A.push(be.substr(2)):"$"!=be.charAt(0)&&A.push(be);return A=o.list.$factory(o.set.$factory(A)),o.list.sort(A),A},l.__eq__=function(N,U){return N===U||o.NotImplemented},l.__format__=function(){var N=n.args("__format__",2,{self:null,spec:null},["self","spec"],arguments,{},null,null);if(""!==N.spec)throw o.TypeError.$factory("non-empty format string passed to object.__format__");return o.getattr(N.self,"__str__")()},l.__ge__=function(){return o.NotImplemented},l.__getattribute__=function(N,U){var G=N.__class__||n.get_class(N),A=!1;if("__class__"===U)return G;var P=N[U];if(Array.isArray(N)&&void 0!==Array.prototype[U]&&(P=void 0),void 0===P&&N.__dict__){var de=N.__dict__;if(de.$string_dict.hasOwnProperty(U))return de.$string_dict[U][0]}if(void 0===P){let ee=function(F,Be,K){var ve=Be[K];if(void 0!==ve)return ve};if(void 0===(P=ee(0,G,U)))for(var be=0,te=(T=G.__mro__).length;be<te&&void 0===(P=ee(0,T[be],U));be++);else P.__class__!==n.method&&void 0===P.__get__&&(A=!0)}else if(void 0===P.__set__)return P;if(void 0!==P){if(P.__class__===o.property)return P.__get__(P,N,G);if(P.__class__===n.method)return void 0===P.__get__&&console.log("bizarre",N,U,P),P.__get__(N,G);if(void 0===(ce=P.__get__)&&P.__class__){var ce=P.__class__.__get__;for(be=0;be<P.__class__.__mro__.length&&void 0===ce;be++)ce=P.__class__.__mro__[be].__get__}var fe=void 0===ce?null:n.$getattr(P,"__get__",null);if(null!==fe)try{return fe.apply(null,[N,G])}catch(ee){throw console.log("error in get.apply",ee),console.log("get attr",U,"of",N),console.log(fe+""),ee}if("object"==typeof P&&fe&&"function"==typeof fe&&(get_func=function(ee,F){return fe.apply(ee,[F,G.$factory])}),null===fe&&"function"==typeof P&&(fe=function(ee){return ee}),null!==fe){P.__name__=U,"__new__"==U&&(P.$type="staticmethod");var _e=fe.apply(null,[P,N,G]);if("function"==typeof _e){if(_e.__class__===n.method||"staticmethod"==P.$type)return P;var le=P.__class__===n.method?G:N,pe=function(){for(var ee=[le],F=0,Be=arguments.length;F<Be;F++)ee.push(arguments[F]);return P.apply(this,ee)};return pe.__class__=n.method,(pe.__get__=function(ee,F){var Be=P.bind(null,F);return Be.__class__=n.method,Be.$infos={__self__:F,__func__:P,__name__:P.$infos.__name__,__qualname__:F.$infos.__name__+"."+P.$infos.__name__},Be}).__class__=n.method_wrapper,pe.__get__.$infos=P.$infos,void 0===G.$infos&&(console.log("no $infos",G),console.log(n.last(n.frames_stack))),pe.$infos={__self__:le,__func__:P,__name__:U,__qualname__:G.$infos.__name__+"."+U},A&&(N.$method_cache=N.$method_cache||{},N.$method_cache[U]=[pe,P]),pe}return _e}return P}var T,B=N.__getattr__;if(void 0===B&&void 0===(B=G.__getattr__))for(be=0,te=(T=G.__mro__).length;be<te&&void 0===(B=T[be].__getattr__);be++);if(void 0!==B)return G===n.module?B(U):B(N,U);throw o.AttributeError.$factory(U)},l.__gt__=function(){return o.NotImplemented},l.__hash__=function(N){var U=N.__hashvalue__;return void 0!==U?U:N.__hashvalue__=n.$py_next_hash--},l.__init__=function(){if(0==arguments.length)throw o.TypeError.$factory("descriptor '__init__' of 'object' object needs an argument");return o.None},l.__init_subclass__=function(){return n.args("__init_subclass__",0,{},[],arguments,{},null,null),o.None},l.__init_subclass__.$type="staticmethod",l.__le__=function(){return o.NotImplemented},l.__lt__=function(){return o.NotImplemented},l.__mro__=[],l.__new__=function(N,...U){if(void 0===N)throw o.TypeError.$factory("object.__new__(): not enough arguments");if(n.$getattr(N,"__init__")===l.__init__&&U.length>0)throw o.TypeError.$factory("object() takes no parameters");return{__class__:N,__dict__:n.empty_dict()}},l.__ne__=function(N,U){if(N===U)return!1;var G=n.$getattr(N,"__eq__",null);if(null!==G){var A=n.$call(G)(U);return A===o.NotImplemented?A:!n.$bool(A)}return o.NotImplemented},l.__reduce__=function(N){function U(de){return n.$call(de)()}U.$infos={__qualname__:"_reconstructor"};var G=[U];G.push(o.tuple.$factory([N.__class__].concat(N.__class__.__mro__)));var A=n.empty_dict();for(var P in N.__dict__.$string_dict)o.dict.$setitem(A.$string_dict,P,N.__dict__.$string_dict[P][0]);return console.log("object.__reduce__, d",A),G.push(A),o.tuple.$factory(G)},x.$infos={__name__:"__newobj__",__qualname__:"__newobj__"},o.__newobj__=x,l.__reduce_ex__=function(N){var U=[x],G=o.tuple.$factory([N.__class__]);Array.isArray(N)&&N.forEach(function(be){G.push(be)}),U.push(G);var A=n.empty_dict(),P=0;if(void 0===N.__dict__)throw o.TypeError.$factory("cannot pickle '"+n.class_name(N)+"' object");for(var de in N.__dict__.$string_dict)"__class__"==de||de.startsWith("$")||(o.dict.$setitem(A,de,N.__dict__.$string_dict[de][0]),P++);return 0==P&&(A=o.None),U.push(A),U.push(o.None),o.tuple.$factory(U)},l.__repr__=function(N){if(N===l)return"<class 'object'>";if(N.__class__===o.type)return"<class '"+N.__name__+"'>";var U=N.__class__.$infos.__module__;return void 0===U||U.startsWith("$")||"builtins"===U?"<"+n.class_name(N)+" object>":"<"+N.__class__.$infos.__module__+"."+n.class_name(N)+" object>"},l.__setattr__=function(N,U,G){if(void 0===G)throw o.TypeError.$factory("can't set attributes of built-in/extension type 'object'");if(N.__class__===l)throw o.AttributeError.$factory(void 0===l[U]?"'object' object has no attribute '"+U+"'":"'object' object attribute '"+U+"' is read-only");return n.aliased_names[U]&&(U="$$"+U),N.__dict__?o.dict.$setitem(N.__dict__,U,G):N[U]=G,o.None},l.__setattr__.__get__=function(N){return function(U,G){l.__setattr__(N,U,G)}},l.__setattr__.__str__=function(){return"method object.setattr"},l.__str__=function(N){var U=n.$getattr(N,"__repr__");return n.$call(U)()},l.__subclasshook__=function(){return o.NotImplemented},l.$factory=function(){var N={__class__:l},U=[N].concat(Array.prototype.slice.call(arguments));return l.__init__.apply(null,U),N},n.set_func_names(l,"builtins"),n.make_class=function(N,U){var G={__class__:o.type,__mro__:[l],$infos:{__name__:N},$is_class:!0};return G.$factory=U,G},l}(__BRYTHON__),function(n){var o=n.builtins;n.$class_constructor=function(A,P,de,be,te){var ce;de=de||[];var fe=P.__module__;void 0===fe&&(fe=P.__module__=n.last(n.frames_stack)[2]);for(var _e=0;_e<de.length;_e++)if(void 0===de[_e])throw n.line_info=P.$def_line,o.NameError.$factory("name '"+be[_e]+"' is not defined");var le={},pe={};if(te)for(_e=0;_e<te.length;_e++){var B=te[_e][1];"metaclass"==(T=te[_e][0])?ce=B:le[T]=B,pe[T]=B}var q=P;void 0!==P.__eq__&&void 0===P.__hash__&&(P.__hash__=o.None);var ee=de.slice(),F=!1;for(_e=0;_e<de.length;_e++)if(void 0===de[_e]||void 0===de[_e].__mro__){var Be=n.$getattr(de[_e],"__mro_entries__",o.None);if(Be!==o.None){var K=o.list.$factory(Be(de));de.splice(_e,1,...K),F=!0,_e--;continue}}if(void 0===ce)if(de&&de.length>0){if(void 0===(ce=de[0].__class__)){if("function"!=typeof de[0])throw o.TypeError.$factory("Argument of "+A+"is not a class (type '"+n.class_name(de[0])+"')");if(1!=de.length)throw o.TypeError.$factory("A Brython class can inherit at most 1 Javascript constructor");ce=de[0].__class__=n.JSMeta,n.set_func_names(de[0],fe)}for(_e=1;_e<de.length;_e++){var ve=de[_e].__class__;if(ve!==ce&&!o.issubclass(ce,ve))if(o.issubclass(ve,ce))ce=ve;else if(ce.__bases__&&-1==ce.__bases__.indexOf(ve))throw o.TypeError.$factory("metaclass conflict: the metaclass of a derived class must be a (non-strict) subclass of the metaclasses of all its bases")}}else ce=o.type;var Ae=n.$getattr(ce,"__prepare__",o.None),Fe=n.$call(Ae)(A,de);for(var Ee in set_class_item=Fe.__class__!==o.dict?n.$getattr(Fe,"__setitem__"):function(mn,Pn){Fe.$string_dict[mn]=[Pn,Fe.$order++]},P)if("__annotations__"==Ee)for(var T in void 0===Fe.$string_dict[Ee]&&(Fe.$string_dict[Ee]=[n.empty_dict(),Fe.$order++]),P[Ee].$string_dict)n.$setitem(Fe.$string_dict[Ee][0],T,P[Ee].$string_dict[T][0]);else"$"==Ee.charAt(0)&&"$$"!=Ee.substr(0,2)||set_class_item(Ee,P[Ee]);F&&set_class_item("__orig_bases__",o.tuple.$factory(ee));var qe={__bases__:de,__class__:ce,__dict__:Fe};if(Fe.__class__===o.dict)for(var T in Fe.$string_dict)qe[T]=Fe.$string_dict[T][0];else for(var Ke=n.$getattr(Fe,"__getitem__"),gt=o.iter(Fe);;)try{qe[T=o.next(gt)]=Ke(T)}catch{break}qe.__mro__=o.type.mro(qe).slice(1);var at=!0,Ct={},wt={},Ft=[qe].concat(qe.__mro__);for(_e=0;_e<Ft.length;_e++){var Ot=0==_e?q:Ft[_e];for(var Ee in Ot)if(!Ct[Ee]){var rn=Ot[Ee];"function"==typeof rn&&(!0===rn.__isabstractmethod__||rn.$attrs&&rn.$attrs.__isabstractmethod__?(at=!1,wt[Ee]=!0):Ct[Ee]=!0)}}var ft=P.__slots__;for(void 0!==ft&&(ft="string"==typeof ft?[ft]:o.list.$factory(ft),Fe.__slots__=ft),_e=0;_e<Ft.length-1;_e++)for(var Ee in Ft[_e]){if("__setattr__"==Ee){Fe.$has_setattr=!0;break}if(Ft[_e][Ee]&&(Ft[_e][Ee].__get__||Ft[_e][Ee].__class__&&Ft[_e][Ee].__class__.__get__)){Fe.$has_setattr=!0;break}}var Tn=o.type.__getattribute__(ce,"__new__")(ce,A,de,Fe);for(var Ee in Tn.__module__=fe,Tn.$infos={__module__:fe,__name__:n.from_alias(A),__qualname__:P.$qualname},Tn.$subclasses=[],P)"$"==Ee.charAt(0)&&"$$"!=Ee.substr(0,2)||"function"==typeof P[Ee]&&(P[Ee].$infos.$class=Tn);for(Tn.__class__===ce&&o.type.__getattribute__(ce,"__init__")(Tn,A,de,Fe),_e=0;_e<de.length;_e++)de[_e].$subclasses=de[_e].$subclasses||[],de[_e].$subclasses.push(Tn);var Cn=o.$$super.$factory(Tn,Tn);return o.$$super.__getattribute__(Cn,"__init_subclass__")({$nat:"kw",kw:le}),at||(Tn.$factory=function(){throw o.TypeError.$factory("Can't instantiate abstract class interface with abstract methods "+Object.keys(wt).join(", "))}),Tn.__qualname__=A.replace("$$",""),Tn};var l=n.make_class("type",function(A,P,de){return 1==arguments.length?void 0===A?n.UndefinedClass:A.__class__||n.get_class(A):l.__new__(l,A,P,de)});l.__call__=function(){for(var A=[],P=arguments[0],de=1,be=arguments.length;de<be;de++)A.push(arguments[de]);var te=o.type.__getattribute__(P,"__new__").apply(null,arguments);if(te.__class__===P){var ce=o.type.__getattribute__(P,"__init__");if(ce!==o.object.__init__){var fe=[te].concat(A);ce.apply(null,fe)}}return te},l.__class__=l,l.__format__=function(A,P){return o.str.$factory(A)},l.__getattribute__=function(A,P){switch(P){case"__annotations__":for(var de=0,be=(_e=[A].concat(A.__mro__)).length;de<be;de++)if(_e[de].__dict__){var te=_e[de].__dict__.$string_dict.__annotations__[0];if(te)if(void 0===B)B=te;else if(B.__class__===o.dict&&te.__class__===o.dict)for(var ce in te.$string_dict)B.$string_dict[ce]=te.$string_dict[ce]}return void 0===B&&(B=n.empty_dict()),B;case"__bases__":return(B=A.__bases__||o.tuple.$factory()).__class__=o.tuple,0==B.length&&B.push(o.object),B;case"__class__":return A.__class__;case"__doc__":return A.__doc__||o.None;case"__setattr__":if(void 0!==A.__setattr__)var fe=A.__setattr__;else fe=function(Be,K,ve){Be[K]=ve};return N.$factory(P,A,fe);case"__delattr__":return void 0!==A.__delattr__?A.__delattr__:N.$factory(P,A,function(Be){delete A[Be]})}if(void 0===(B=A[P])&&A.__slots__&&A.__slots__.indexOf(P)>-1)return U.$factory(P,A);if(A.__class__&&A.__class__[P]&&A.__class__[P].__get__&&A.__class__[P].__set__)return A.__class__[P].__get__(A);if(void 0===B){var _e;if(void 0===(le=A[P]))for(void 0===(_e=A.__mro__)&&console.log("pas de mro pour",A),de=0;de<_e.length;de++){var le;if(void 0!==(le=_e[de][P])){B=le;break}}else B=le;if(void 0===B){var pe=A.__class__||n.get_class(A);if(void 0===(B=pe[P])){var T=pe.__mro__;for(de=0;de<T.length;de++){var B;if(void 0!==(B=T[de][P]))break}}if(void 0!==B){if(B.__class__===o.property)return B.fget(A);if("function"==typeof B){var q=B.bind(null,A);return q.__class__=n.method,q.$infos={__self__:A,__func__:B,__name__:P,__qualname__:A.$infos.__name__+"."+P,__module__:B.$infos?B.$infos.__module__:""},q}}if(void 0===B){var ee=pe.__getattr__;if(void 0===ee)for(de=0;de<T.length;de++)if(void 0!==T[de].__getattr__){ee=T[de].__getattr__;break}if(void 0!==ee)return ee(A,P)}}}if(void 0!==B){if(B.__class__===o.property)return B;if(B.__get__){if(B.__class__===G){var F=B.__get__(B.__func__,A);F.$infos={__func__:B,__name__:B.$infos.__name__,__qualname__:A.$infos.__name__+"."+B.$infos.__name__,__self__:A}}else F=B.__get__(A);return F}return!B.__class__||!B.__class__.__get__||P.startsWith("__")&&P.endsWith("__")?"function"==typeof B?(void 0===B.$infos&&n.debug>1&&console.log("warning: no attribute $infos for",B,"klass",A,"attr",P),"__new__"==P&&(B.$type="staticmethod"),"__class_getitem__"==P&&B.__class__!==n.method&&(B=o.classmethod.$factory(B)),"__init_subclass__"==P&&(B=o.classmethod.$factory(B)),B.__class__===n.method?B.__get__(null,A):B):B:B.__class__.__get__(B,o.None,A)}},l.__hash__=function(A){return o.hash(A)},l.__init__=function(){},l.__init_subclass__=function(){var A=n.args("__init_subclass__",1,{},[],arguments,{},"args","kwargs");if(void 0!==A.kwargs&&(A.kwargs.__class__!==o.dict||Object.keys(A.kwargs.$string_dict).length>0))throw o.TypeError.$factory("__init_subclass__() takes no keyword arguments");return o.None},l.__instancecheck__=function(A,P){var de=P.__class__||n.get_class(P);if(de===A)return!0;for(var be=0;be<de.__mro__.length;be++)if(de.__mro__[be]===A)return!0;return!1},l.__instancecheck__.$type="staticmethod",l.__name__={__get__:function(A){return A.$infos.__name__},__set__:function(A,P){A.$infos.__name__=P},__str__:function(A){return"type"},__eq__:function(A,P){return A.$infos.__name__==P}},l.__new__=function(A,P,de,be){var te=be.$string_dict.__module__;te&&(te=te[0]);var ce={__class__:A,__bases__:de,__dict__:be,$infos:{__name__:P.replace("$$",""),__module__:te},$is_class:!0,$has_setattr:be.$has_setattr};ce.__mro__=l.mro(ce).slice(1);for(var fe=n.dict_to_list(be),_e=0;_e<fe.length;_e++){var le=n.to_alias(fe[_e][0]),pe=fe[_e][1];if("__module__"!==le&&void 0!==pe){if(ce[le]=pe,pe.__class__){var T=n.$getattr(pe.__class__,"__set_name__",o.None);T!==o.None&&T(pe,ce,le)}"function"==typeof pe&&(void 0===pe.$infos&&(console.log("type new",pe,pe+""),console.log(n.frames_stack.slice())),pe.$infos.$class=ce,pe.$infos.__qualname__=P+"."+pe.$infos.__name__,pe.$infos.$defaults)&&n.Function.__setattr__(pe,"__defaults__",pe.$infos.$defaults)}}return ce},l.__repr__=l.__str__=function(A){void 0===A.$infos&&console.log("no $infos",A);var P=A.$infos.__qualname__;return A.$infos.__module__&&"builtins"!=A.$infos.__module__&&!A.$infos.__module__.startsWith("$")&&(P=A.$infos.__module__+"."+P),"<class '"+P+"'>"},l.__prepare__=function(){return n.empty_dict()},l.__qualname__={__get__:function(A){return A.$infos.__qualname__||A.$infos.__name__},__set__:function(A,P){A.$infos.__qualname__=P},__str__:function(A){console.log("type.__qualname__")},__eq__:function(A,P){return A.$infos.__qualname__==P}},l.mro=function(A){for(var P=A.__bases__,de=[],be=0,te=0;te<P.length;te++){P[te]===o.str&&(P[te]=n.StringSubclass);var ce=[],fe=0;if(void 0===P[te]||void 0===P[te].__mro__){if(void 0===P[te].__class__)return[o.object];throw o.TypeError.$factory("Object passed as base class is not a class")}ce[fe++]=P[te];var _e=P[te].__mro__;_e[0]===P[te]&&_e.splice(0,1);for(var le=0;le<_e.length;le++)ce[fe++]=_e[le];de[be++]=ce}-1==P.indexOf(o.object)&&(P=P.concat(o.tuple.$factory([o.object]))),de[be++]=P.slice();for(var pe=[A],T=1;;){var B=[];for(fe=0,te=0;te<de.length;te++)de[te].length>0&&(B[fe++]=de[te]);if(0==B.length)break;for(te=0;te<B.length;te++){for(var q=B[te][0],ee=[],F=(fe=0,0);F<B.length;F++){var Be=B[F];Be.slice(1).indexOf(q)>-1&&(ee[fe++]=Be)}if(!(ee.length>0))break;q=null}if(null===q)throw o.TypeError.$factory("inconsistent hierarchy, no C3 MRO is possible");for(pe[T++]=q,te=0;te<de.length;te++)de[te][0]===q&&de[te].shift()}return pe[pe.length-1]!==o.object&&(pe[T++]=o.object),pe},l.__subclasscheck__=function(A,P){var de=A;return de===o.str?de=n.StringSubclass:de===o.float&&(de=n.FloatSubclass),void 0===P.__bases__?A===o.object:P.__bases__.indexOf(de)>-1},n.set_func_names(l,"builtins"),o.type=l;var x=n.make_class("wrapper_descriptor");n.set_func_names(x,"builtins"),l.__call__.__class__=x,n.$instance_creator=function(A){if(void 0!==A.$instanciable)return function(){throw o.TypeError.$factory("Can't instantiate abstract class interface with abstract methods")};var P,de=A.__class__;if(de!==o.type||A.__bases__&&0!=A.__bases__.length){P=o.type.__getattribute__(de,"__call__");var be=function(){return P.bind(null,A).apply(null,arguments)}}else be=A.hasOwnProperty("__new__")?A.hasOwnProperty("__init__")?function(){var te=A.__new__.bind(null,A).apply(null,arguments);return A.__init__.bind(null,te).apply(null,arguments),te}:function(){return A.__new__.bind(null,A).apply(null,arguments)}:A.hasOwnProperty("__init__")?function(){var te={__class__:A,__dict__:n.empty_dict()};return A.__init__.bind(null,te).apply(null,arguments),te}:function(){if(arguments.length>0&&(1!=arguments.length||!arguments[0].$nat||0!=Object.keys(arguments[0].kw).length))throw o.TypeError.$factory("object() takes no parameters");return{__class__:A,__dict__:n.empty_dict()}};return be.__class__=n.Function,be.$infos={__name__:A.$infos.__name__,__module__:A.$infos.__module__},be};var N=n.method_wrapper=n.make_class("method_wrapper",function(A,P,de){var be=function(){return de.apply(null,arguments)};return be.$infos={__name__:A,__module__:P.__module__},be});N.__str__=N.__repr__=function(A){return"<method '"+A.$infos.__name__+"' of function object>"};var U=n.make_class("member_descriptor",function(A,P){return{__class__:U,cls:P,attr:A}});U.__str__=U.__repr__=function(A){return"<member '"+A.attr+"' of '"+A.cls.$infos.__name__+"' objects>"},n.set_func_names(U,"builtins");var G=n.method=n.make_class("method",function(A,P){var de=function(){return n.$call(A).bind(null,P).apply(null,arguments)};return de.__class__=G,de.$infos=A.$infos,de});G.__eq__=function(A,P){return void 0!==A.$infos&&void 0!==P.$infos&&A.$infos.__func__===P.$infos.__func__&&A.$infos.__self__===P.$infos.__self__},G.__ne__=function(A,P){return!n.method.__eq__(A,P)},G.__get__=function(A){var P=function(){return A(arguments)};return P.__class__=n.method_wrapper,P.$infos=G.$infos,P},G.__getattribute__=function(A,P){var de=A.$infos;if(de&&de[P]){if("__code__"==P){var be={__class__:n.Code};for(var P in de.__code__)be[P]=de.__code__[P];return be}return de[P]}return G.hasOwnProperty(P)?o.object.__getattribute__(A,P):n.Function.__getattribute__(A.$infos.__func__,P)},G.__repr__=G.__str__=function(A){return"<bound method "+A.$infos.__qualname__+" of "+o.str.$factory(A.$infos.__self__)+">"},G.__setattr__=function(A,P,de){throw"__class__"==P?o.TypeError.$factory("__class__ assignment only supported for heap types or ModuleType subclasses"):o.AttributeError.$factory("'method' object has no attribute '"+P+"'")},n.set_func_names(G,"builtins"),n.method_descriptor=n.make_class("method_descriptor"),n.classmethod_descriptor=n.make_class("classmethod_descriptor"),n.GenericAlias=n.make_class("GenericAlias",function(A,P){return{__class__:n.GenericAlias,origin_class:A,items:P}}),n.GenericAlias.__args__={__get__:function(A){return n.fast_tuple(A.items)}},n.GenericAlias.__call__=function(A,...P){return A.origin_class.$factory.apply(null,P)},n.GenericAlias.__eq__=function(A,P){return n.rich_comp("__eq__",A.origin_class,P.origin_class)&&n.rich_comp("__eq__",A.items,P.items)},n.GenericAlias.__getitem__=function(A,P){throw o.TypeError.$factory("descriptor '__getitem__' for '"+A.origin_class.$infos.__name__+"' objects doesn't apply to a '"+n.class_name(P)+"' object")},n.GenericAlias.__origin__={__get__:function(A){return A.origin_class}},n.GenericAlias.__parameters__={__get__:function(A){return n.fast_tuple([])}},n.GenericAlias.__repr__=function(A){for(var P=A.items,de=0,be=P.length;de<be;de++)P[de]=P[de]===o.Ellipsis?"...":P[de].$infos.__name__;return A.origin_class.$infos.__qualname__+"["+P.join(", ")+"]"},o.object.__class__=l}(__BRYTHON__),function($B){var _b_=$B.builtins,_window=self,isWebWorker=typeof WorkerGlobalScope<"u"&&"function"==typeof importScripts&&navigator instanceof WorkerNavigator;function index_error(n){throw _b_.IndexError.$factory(("string"==typeof n?"string":"list")+" index out of range")}$B.args=function(n,o,l,x,N,U,G,A){n.startsWith("lambda_"+$B.lambda_magic)&&(n="<lambda>");var P,de,be=!1,te=N.length,ce=0,fe=x.indexOf("/");if(-1!=fe&&(x.splice(fe,1),de=x.slice(0,fe)),te>0&&N[te-1].$nat&&(te--,Object.keys(N[te].kw).length>0)){be=!0;var _e=N[te].kw;if(Array.isArray(_e)){for(var le=_e[0],pe=1,T=_e.length;pe<T;pe++){var B=_e[pe];if(B.__class__===_b_.dict){for(var q in B.$numeric_dict)throw _b_.TypeError.$factory(n+"() keywords must be strings");for(var q in B.$object_dict)throw _b_.TypeError.$factory(n+"() keywords must be strings");for(var q in B.$string_dict){if(void 0!==le[q])throw _b_.TypeError.$factory(n+"() got multiple values for argument '"+q+"'");le[q]=B.$string_dict[q][0]}}else for(var ee=_b_.iter(B),F=$B.$getattr(B,"__getitem__");;)try{if("string"!=typeof(q=_b_.next(ee)))throw _b_.TypeError.$factory(n+"() keywords must be strings");if(void 0!==le[q])throw _b_.TypeError.$factory(n+"() got multiple values for argument '"+q+"'");le[q]=F(q)}catch(qe){if($B.is_exc(qe,[_b_.StopIteration]))break;throw qe}}_e=le}}if(G&&(l[G]=[],l[G].__class__=_b_.tuple),A&&(P=$B.empty_dict()),te>o){if(null===G||"*"==G)throw _b_.TypeError.$factory(Ee=n+"() takes "+o+" positional argument"+(o>1?"s":"")+" but more were given");for(pe=o;pe<te;pe++)l[G].push(N[pe]);te=o}for(pe=0;pe<te;pe++)l[x[pe]]=N[pe],ce++;if(ce==o&&o===x.length&&!be)return A&&(l[A]=P),l;if(be)for(var Be in _e){var K=_e[Be],ve=$B.to_alias(Be);if(void 0===l[ve]){if(!A)throw _b_.TypeError.$factory(n+"() got an unexpected keyword argument '"+Be+"'");"$$"==Be.substr(0,2)&&(Be=Be.substr(2)),P.$string_dict[Be]=[K,P.$order++]}else{if(null!==l[ve])throw _b_.TypeError.$factory(n+"() got multiple values for argument '"+Be+"'");if(de&&de.indexOf(ve)>-1)throw _b_.TypeError.$factory(n+"() got an unexpected keyword argument '"+Be+"'");l[ve]=K}}var Ae=[];for(var Fe in l)null===l[Fe]&&(void 0!==U[Fe]?l[Fe]=U[Fe]:Ae.push("'"+Fe+"'"));if(Ae.length>0){if(1==Ae.length)throw _b_.TypeError.$factory(n+" missing 1 positional argument: "+Ae[0]);var Ee=n+" missing "+Ae.length+" positional arguments: ";throw Ee+=Ae.join(" and "),_b_.TypeError.$factory(Ee)}return A&&(l[A]=P),l},$B.wrong_nb_args=function(n,o,l,x){if(o<l){var N=l-o;throw _b_.TypeError.$factory(n+"() missing "+N+" positional argument"+(N>1?"s":"")+": "+x.slice(o))}throw _b_.TypeError.$factory(n+"() takes "+l+" positional argument"+(l>1?"s":"")+" but more were given")},$B.get_class=function(n){if(null===n)return $B.$NoneDict;if(void 0===n)return $B.UndefinedClass;var o=n.__class__;if(void 0===o)switch(typeof n){case"number":return n%1==0?_b_.int:_b_.float;case"string":return _b_.str;case"boolean":return _b_.bool;case"function":return n.$is_js_func?$B.JSObj:(n.__class__=$B.Function,$B.Function);case"object":if(Array.isArray(n)){if(Object.getPrototypeOf(n)===Array.prototype)return n.__class__=_b_.list,_b_.list}else{if(n.constructor===Number)return _b_.float;if(typeof Node<"u"&&n instanceof Node)return $B.DOMNode}}return void 0===o?$B.JSObj:o},$B.class_name=function(n){var o=$B.get_class(n);return o===$B.JSObj?"Javascript "+n.constructor.name:o.$infos.__name__},$B.$list_comp=function(n){for(var o=$B.UUID(),l="x"+o+" = []\n",x=0,N=1,U=n.length;N<U;N++){var G=n[N].replace(/\s+$/,"").replace(/\n/g,"");l+=" ".repeat(x)+G+":\n",x+=4}return l+=" ".repeat(x),[l+="x"+o+".append("+n[0]+")\n",o]},$B.$dict_comp=function(n,o,l,x){for(var N=$B.UUID(),U="comp_result_"+$B.lambda_magic+N,G=U+" = {}\n",A=0,P=1,de=l.length;P<de;P++){var be=l[P].replace(/\s+$/,"").replace(/\n/g,"");G+="    ".repeat(A)+be+":\n",A++}G+="    ".repeat(A)+U+".update({"+l[0]+"})";var ce="dc"+N,fe=$B.py2js({src:G,is_comp:!0,line_info:x+","+n},n,ce,o,x),_e=fe.outermost_expr.to_js(),le=fe.to_js();return le="(function(expr){"+(le+="\nreturn "+U+"\n")+"})("+_e+")",$B.clear_ns(ce),delete $B.$py_src[ce],le},$B.$gen_expr=function(n,o,l,x,N){for(var U=$B.UUID(),G=(N?"set_comp"+$B.lambda_magic:"__ge")+U,A=`def ${G}(expr):\n`,P=1,de=1,be=l.length;de<be;de++){var te=l[de].replace(/\s+$/,"").replace(/\n/g,"");A+=" ".repeat(P)+te+":\n",P+=4}A+=" ".repeat(P);var fe=$B.py2js({src:A+="yield ("+l[0]+")",is_comp:!0,line_info:x+","+n,ix:U},G,G,o,x),_e=fe.to_js(),le=_e.split("\n");void 0===fe.outermost_expr&&console.log("no outermost",n,o);var pe=fe.outermost_expr.to_js();return _e=le.join("\n"),"(function($locals_"+G+"){"+(_e+="\nvar $res = $B.generator.$factory("+G+")("+pe+");\nreturn $res\n")+"})($locals)\n"},$B.copy_namespace=function(){var n={};for(const l of $B.frames_stack)for(const x of[l[1],l[3]])for(var o in x)!o.startsWith("$$")&&o.startsWith("$")||(n[o]=x[o]);return n},$B.clear_ns=function(n){n.startsWith("__ge")&&console.log("clear ns",n);var o=n.length;for(var l in $B.$py_module_path)l.substr(0,o)==n&&($B.$py_module_path[l]=null,delete $B.$py_module_path[l]);$B.$py_src[n]=null,delete $B.$py_src[n];var x=n.replace(/\./g,"_");x!=n&&$B.clear_ns(x)},$B.from_alias=function(n){return"$$"==n.substr(0,2)&&$B.aliased_names[n.substr(2)]?n.substr(2):n},$B.$search=function(n,o){var l=$B.last($B.frames_stack);if(void 0!==l[1][n])return l[1][n];if(void 0!==l[3][n])return l[3][n];if(void 0!==_b_[n])return _b_[n];throw l[0]==l[2]||"class"==l[1].$type||l[1].$exec_locals?_b_.NameError.$factory("name '"+n+"' is not defined"):_b_.UnboundLocalError.$factory("local variable '"+n+"' referenced before assignment")},$B.$global_search=function(n,o){for(var l=0;l<$B.frames_stack.length;l++){var x=$B.frames_stack[l];if(o.indexOf(x[0])>-1&&void 0!==x[1][n])return x[1][n];if(o.indexOf(x[2])>-1&&void 0!==x[3][n])return x[3][n]}for(l=0;l<o.length;l++){var N=o[l];if($B.imported[N]&&$B.imported[N][n])return $B.imported[N][n]}throw _b_.NameError.$factory("name '"+$B.from_alias(n)+"' is not defined")},$B.$local_search=function(n){var o=$B.last($B.frames_stack);if(void 0!==o[1][n])return o[1][n];throw _b_.UnboundLocalError.$factory("local variable '"+$B.from_alias(n)+"' referenced before assignment")},$B.$check_def=function(n,o){if(void 0!==o)return o;if(void 0!==_b_[n])return _b_[n];var l=$B.last($B.frames_stack);if(void 0!==l[3][n])return l[3][n];throw _b_.NameError.$factory("name '"+$B.from_alias(n)+"' is not defined")},$B.$check_def_local=function(n,o){if(void 0!==o)return o;throw _b_.UnboundLocalError.$factory("local variable '"+$B.from_alias(n)+"' referenced before assignment")},$B.$check_def_free=function(n,o){if(void 0!==o)return o;for(var l,x=$B.frames_stack.length-1;x>=0;x--)if(void 0!==(l=$B.frames_stack[x][1][n])||void 0!==(l=$B.frames_stack[x][3][n]))return l;throw _b_.NameError.$factory("free variable '"+$B.from_alias(n)+"' referenced before assignment in enclosing scope")},$B.$check_def_free1=function(n,o){for(var l,x=$B.frames_stack.length-1;x>=0;x--){var N=$B.frames_stack[x];if(void 0!==(l=N[1][n])||N[1].$parent&&void 0!==(l=N[1].$parent[n])||N[2]==o&&void 0!==(l=N[3][n]))return l}throw _b_.NameError.$factory("free variable '"+$B.from_alias(n)+"' referenced before assignment in enclosing scope")},$B.$JS2Py=function(n){return"number"==typeof n?n%1==0?n:_b_.float.$factory(n):null==n?_b_.None:(Array.isArray(n)&&Object.getPrototypeOf(n)===Array.prototype&&(n.$brython_class="js"),n)},$B.list_key=function(n,o){(o=$B.$GetInt(o))<0&&(o+=n.length);var l=n[o];if(void 0===l)throw _b_.IndexError.$factory("list index out of range");return l},$B.list_slice=function(n,o,l){return null===o?o=0:(o=$B.$GetInt(o))<0&&(o=Math.max(0,o+n.length)),null===l?n.slice(o):((l=$B.$GetInt(l))<0&&(l=Math.max(0,l+n.length)),n.slice(o,l))},$B.list_slice_step=function(n,o,l,x){if(null===x||1==x)return $B.list_slice(n,o,l);if(0==x)throw _b_.ValueError.$factory("slice step cannot be zero");x=$B.$GetInt(x),null===o?o=x>=0?0:n.length-1:(o=$B.$GetInt(o))<0&&(o=Math.min(0,o+n.length)),null===l?l=x>=0?n.length:-1:(l=$B.$GetInt(l))<0&&(l=Math.max(0,l+n.length));var N=[];if(x>0)for(var U=o;U<l;U+=x)N.push(n[U]);else for(U=o;U>l;U+=x)N.push(n[U]);return N},$B.$getitem=function(n,o){var l=Array.isArray(n)&&n.__class__===_b_.list;if("number"==typeof o&&(l||"string"==typeof n)){if(void 0!==n[o=o>=0?o:n.length+o])return n[o];index_error(n)}try{o=$B.$GetInt(o)}catch{}if((l||"string"==typeof n)&&"number"==typeof o){if(void 0!==n[o=o>=0?o:n.length+o])return n[o];index_error(n)}if(n.$is_class){var x=$B.$getattr(n,"__class_getitem__",_b_.None);if(x!==_b_.None)return x(o);if(n.__class__&&(x=$B.$getattr(n.__class__,"__getitem__",_b_.None))!==_b_.None)return x(n,o)}if(l)return _b_.list.$getitem(n,o);var N=$B.$getattr(n,"__getitem__",_b_.None);if(N!==_b_.None)return N(o);throw _b_.TypeError.$factory("'"+$B.class_name(n)+"' object is not subscriptable")},$B.getitem_slice=function(n,o){var l;return Array.isArray(n)?(o.start===_b_.None&&o.stop===_b_.None?o.step===_b_.None||1==o.step?l=n.slice():-1==o.step&&(l=n.slice().reverse()):o.step===_b_.None&&(o.start===_b_.None&&(o.start=0),o.stop===_b_.None&&(o.stop=n.length),"number"==typeof o.start&&"number"==typeof o.stop&&(o.start<0&&(o.start+=n.length),o.stop<0&&(o.stop+=n.length),l=n.slice(o.start,o.stop))),l?(l.__class__=n.__class__,l):_b_.list.$getitem(n,o)):$B.$getattr(n,"__getitem__")(o)},$B.set_list_key=function(n,o,l){try{o=$B.$GetInt(o)}catch{if(_b_.isinstance(o,_b_.slice)){var x=_b_.slice.$conv_for_seq(o,n.length);return $B.set_list_slice_step(n,x.start,x.stop,x.step,l)}}if(o<0&&(o+=n.length),void 0===n[o])throw console.log(n,o),_b_.IndexError.$factory("list assignment index out of range");n[o]=l},$B.set_list_slice=function(n,o,l,x){null===o?o=0:(o=$B.$GetInt(o))<0&&(o=Math.max(0,o+n.length)),null===l&&(l=n.length),(l=$B.$GetInt(l))<0&&(l=Math.max(0,l+n.length));var N=_b_.list.$factory(x);n.splice.apply(n,[o,l-o].concat(N))},$B.set_list_slice_step=function(n,o,l,x,N){if(null===x||1==x)return $B.set_list_slice(n,o,l,N);if(0==x)throw _b_.ValueError.$factory("slice step cannot be zero");x=$B.$GetInt(x),o=null===o?x>0?0:n.length-1:$B.$GetInt(o),l=null===l?x>0?n.length:-1:$B.$GetInt(l);var U,G=_b_.list.$factory(N),A=0,P=0;U=x>0?function(be){return be<l}:function(be){return be>l};for(var de=o;U(de);de+=x)P++;if(P!=G.length)throw _b_.ValueError.$factory("attempt to assign sequence of size "+G.length+" to extended slice of size "+P);for(de=o;U(de);de+=x)n[de]=G[A],A++},$B.$setitem=function(n,o,l){if(!Array.isArray(n)||void 0!==n.__class__||"number"!=typeof o||_b_.isinstance(n,_b_.tuple)){if(n.__class__!==_b_.dict)return n.__class__===_b_.list?_b_.list.$setitem(n,o,l):void $B.$getattr(n,"__setitem__")(o,l);_b_.dict.$setitem(n,o,l)}else{if(o<0&&(o+=n.length),void 0===n[o])throw _b_.IndexError.$factory("list assignment index out of range");n[o]=l}},$B.augm_item_add=function(n,o,l){if(Array.isArray(n)&&"number"==typeof o&&void 0!==n[o]){if(Array.isArray(n[o])&&Array.isArray(l)){for(var x=0,N=l.length;x<N;x++)n[o].push(l[x]);return}if("string"==typeof n[o]&&"string"==typeof l)return void(n[o]+=l)}var U=$B.$getattr;try{var G=U(U(n,"__getitem__")(o),"__iadd__")}catch{return void U(n,"__setitem__")(o,U(U(n,"__getitem__")(o),"__add__")(l))}G(l)};for(var augm_item_src=""+$B.augm_item_add,augm_ops=[["-=","sub"],["*=","mul"]],i=0,len=augm_ops.length;i<len;i++){var augm_code=augm_item_src.replace(/add/g,augm_ops[i][1]);augm_code=augm_code.replace(/\+=/g,augm_ops[i][0]),eval("$B.augm_item_"+augm_ops[i][1]+"="+augm_code)}$B.extend=function(n,o){for(var l=2;l<arguments.length;l++)for(var x=arguments[l],N=_b_.iter(x),U=$B.$getattr(x,"__getitem__");;)try{var G=_b_.next(N);if("string"!=typeof G)throw _b_.TypeError.$factory(n+"() keywords must be strings");if(void 0!==o[G])throw _b_.TypeError.$factory(n+"() got multiple values for argument '"+G+"'");o[G]=U(G)}catch(A){if(_b_.isinstance(A,[_b_.StopIteration]))break;throw A}return o},$B.extend_list=function(){for(var n=Array.prototype.slice.call(arguments,0,arguments.length-1),o=$B.last(arguments),l=_b_.iter(o);;)try{n.push(_b_.next(l))}catch(x){if(_b_.isinstance(x,[_b_.StopIteration]))break;throw x}return n},$B.$test_item=function(n){return $B.$test_result=n,_b_.bool.$factory(n)},$B.$test_expr=function(){return $B.$test_result},$B.$is=function(n,o){return n instanceof Number&&o instanceof Number?n.valueOf()==o.valueOf():n===_b_.int&&o==$B.long_int||n===$B.long_int&&o===_b_.int||n===o},$B.$is_member=function(n,o){var l,x,N;try{N=$B.$getattr(o.__class__||$B.get_class(o),"__contains__")}catch{}if(N)return $B.$call(N)(o,n);try{x=_b_.iter(o)}catch{}if(x)for(;;)try{var U=_b_.next(x);if($B.rich_comp("__eq__",U,n))return!0}catch{return!1}try{l=$B.$getattr(o,"__getitem__")}catch{throw _b_.TypeError.$factory("'"+$B.class_name(o)+"' object is not iterable")}if(l)for(var G=-1;;){G++;try{if(U=l(G),$B.rich_comp("__eq__",U,n))return!0}catch(A){if(A.__class__===_b_.IndexError)return!1;throw A}}},$B.$call=function(n){if(n.__class__===$B.method||n.$is_func||"function"==typeof n)return n;if(n.$factory)return n.$factory;if(n.$is_class)return n.$factory=$B.$instance_creator(n);try{return $B.$getattr(n,"__call__")}catch{throw _b_.TypeError.$factory("'"+$B.class_name(n)+"' object is not callable")}};var $io=$B.make_class("io",function(n){return{__class__:$io,out:n}});function $err(n,o,l){var x="unsupported operand type(s) for "+n+" : '"+o.$infos.__name__+"' and '"+$B.class_name(l)+"'";throw _b_.TypeError.$factory(x)}$io.flush=function(){},$io.write=function(n,o){return console[n.out](o),_b_.None},$B.stderr=void 0!==console.error?$io.$factory("error"):$io.$factory("log"),$B.stdout=$io.$factory("log"),$B.stdin={__class__:$io,__original__:!0,closed:!1,len:1,pos:0,read:function(){return""},readline:function(){return""}},$B.make_iterator_class=function(n){var o={__class__:_b_.type,__mro__:[_b_.object],$factory:function(l){return{__class__:o,__dict__:$B.empty_dict(),counter:-1,items:l,len:l.length}},$infos:{__name__:n},$is_class:!0,__iter__:function(l){return l.counter=void 0===l.counter?-1:l.counter,l.len=l.items.length,l},__len__:function(l){return l.items.length},__next__:function(l){if("function"==typeof l.len_func&&l.len_func()!=l.len)throw _b_.RuntimeError.$factory("dictionary changed size during iteration");if(l.counter++,l.counter<l.items.length){var x=l.items[l.counter];return"js"==l.items.$brython_class&&(x=$B.$JS2Py(x)),x}throw _b_.StopIteration.$factory("StopIteration")},__reduce_ex__:function(l,x){return $B.fast_tuple([_b_.iter,_b_.tuple.$factory([l.items])])}};return $B.set_func_names(o,"builtins"),o};var ropnames=["add","sub","mul","truediv","floordiv","mod","pow","lshift","rshift","and","xor","or"],ropsigns=["+","-","*","/","//","%","**","<<",">>","&","^","|"];function exit_ctx_managers_in_generators(n){for(key in n[1])n[1][key]&&n[1][key].__class__==$B.generator&&n[1][key].return()}$B.make_rmethods=function(n){for(var o=0,l=ropnames.length;o<l;o++)void 0===n["__"+ropnames[o]+"__"]&&(n["__"+ropnames[o]+"__"]=function(x,N){return function(U,G){try{return $B.$getattr(G,"__r"+x+"__")(U)}catch{$err(N,n,G)}}}(ropnames[o],ropsigns[o]))},$B.UUID=function(){return $B.$py_UUID++},$B.InjectBuiltins=function(){var n=["var _b_ = $B.builtins"],o=1;for(var l in $B.builtins)n[o++]="var "+l+'=_b_["'+l+'"]';return n.join(";")},$B.$GetInt=function(n){if("number"==typeof n||n.constructor===Number)return n;if("boolean"==typeof n)return n?1:0;if(_b_.isinstance(n,_b_.int))return n;if(_b_.isinstance(n,_b_.float))return n.valueOf();if(!n.$is_class){try{return $B.$getattr(n,"__int__")()}catch{}try{return $B.$getattr(n,"__index__")()}catch{}}throw _b_.TypeError.$factory("'"+$B.class_name(n)+"' object cannot be interpreted as an integer")},$B.to_num=function(n,o){for(var l={__complex__:_b_.complex,__float__:_b_.float,__index__:_b_.int,__int__:_b_.int},x=n.__class__||$B.get_class(n),N=0;N<o.length;N++){var U={},G=$B.$getattr(x,o[N],U);if(G!==U){var A=G(n);if(!_b_.isinstance(A,l[o[N]]))throw console.log(A,o[N],l[o[N]]),_b_.TypeError.$factory(o[N]+"returned non-"+l[o[N]].$infos.__name__+"(type "+$B.get_class(A)+")");return A}}return null},$B.PyNumber_Index=function(n){switch(typeof n){case"boolean":return n?1:0;case"number":return n;case"object":if(n.__class__===$B.long_int)return n;if(_b_.isinstance(n,_b_.int))return n.$brython_value;var o=$B.$getattr(n,"__index__",_b_.None);if(o!==_b_.None)return o="function"==typeof o?o:$B.$getattr(o,"__call__"),$B.int_or_bool(o());default:throw _b_.TypeError.$factory("'"+$B.class_name(n)+"' object cannot be interpreted as an integer")}},$B.int_or_bool=function(n){switch(typeof n){case"boolean":return n?1:0;case"number":return n;case"object":if(n.__class__===$B.long_int)return n;throw _b_.TypeError.$factory("'"+$B.class_name(n)+"' object cannot be interpreted as an integer");default:throw _b_.TypeError.$factory("'"+$B.class_name(n)+"' object cannot be interpreted as an integer")}},$B.enter_frame=function(n){if($B.frames_stack.push(n),$B.tracefunc&&$B.tracefunc!==_b_.None){if(n[4]===$B.tracefunc||$B.tracefunc.$infos&&n[4]&&n[4]===$B.tracefunc.$infos.__func__)return $B.tracefunc.$frame_id=n[0],_b_.None;for(var o=$B.frames_stack.length-1;o>=0;o--)if($B.frames_stack[o][0]==$B.tracefunc.$frame_id)return _b_.None;return $B.tracefunc($B._frame.$factory($B.frames_stack,$B.frames_stack.length-1),"call",_b_.None)}return _b_.None},$B.trace_exception=function(){var n=$B.last($B.frames_stack);if(n[0]==$B.tracefunc.$current_frame_id)return _b_.None;var l=n[1].$current_exception;return(0,n[1].$f_trace)($B._frame.$factory($B.frames_stack,$B.frames_stack.length-1),"exception",$B.fast_tuple([l.__class__,l,$B.traceback.$factory(l)]))},$B.trace_line=function(){var n=$B.last($B.frames_stack);return n[0]==$B.tracefunc.$current_frame_id?_b_.None:(0,n[1].$f_trace)($B._frame.$factory($B.frames_stack,$B.frames_stack.length-1),"line",_b_.None)},$B.set_line=function(n){var o=$B.last($B.frames_stack);if($B.tracefunc&&o[0]==$B.tracefunc.$current_frame_id)return _b_.None;o[1].$line_info=n;var l=o[1].$f_trace;if(l!==_b_.None){var x=$B._frame.$factory($B.frames_stack,$B.frames_stack.length-1);o[1].$ftrace=l(x,"line",_b_.None)}return!0},$B.trace_return=function(n){var o=$B.last($B.frames_stack),l=o[1].$f_trace,x=$B._frame.$factory($B.frames_stack,$B.frames_stack.length-1);if(o[0]==$B.tracefunc.$current_frame_id)return _b_.None;l(x,"return",n)},$B.set_cm_in_generator=function(n){void 0!==n&&$B.frames_stack.forEach(function(o){o[1].$cm_in_gen=o[1].$cm_in_gen||new Set,o[1].$cm_in_gen.add(n)})},$B.leave_frame=function(n){if(0!=$B.frames_stack.length){n&&void 0!==n.value&&$B.tracefunc&&(void 0===$B.last($B.frames_stack)[1].$f_trace&&($B.last($B.frames_stack)[1].$f_trace=$B.tracefunc),$B.last($B.frames_stack)[1].$f_trace!==_b_.None&&$B.trace_return(n.value));var o=$B.frames_stack.pop();if(o[1].$current_exception=void 0,o[1].$close_generators)for(var l=0,x=o[1].$close_generators.length;l<x;l++){var N=o[1].$close_generators[l];N.$has_run&&N.return()}return _b_.None}console.log("empty stack")},$B.leave_frame_exec=function(n){if($B.profile>0&&$B.$profile.return(),0!=$B.frames_stack.length){var o=$B.frames_stack.pop();exit_ctx_managers_in_generators(o);for(var l=$B.frames_stack.length-1;l>=0;l--)$B.frames_stack[l][2]==o[2]&&($B.frames_stack[l][3]=o[3])}else console.log("empty stack")};var min_int=Math.pow(-2,53),max_int=Math.pow(2,53)-1;$B.is_safe_int=function(){for(var n=0;n<arguments.length;n++){var o=arguments[n];if(o<min_int||o>max_int)return!1}return!0},$B.add=function(n,o){if("number"==typeof n.valueOf()&&"number"==typeof o.valueOf()){if("number"==typeof n&&"number"==typeof o){var l=n+o;return l<$B.max_int&&l>$B.min_int?l:l===1/0?_b_.float.$factory("inf"):l===-1/0?_b_.float.$factory("-inf"):isNaN(l)?_b_.float.$factory("nan"):$B.long_int.__add__($B.long_int.$factory(n),$B.long_int.$factory(o))}return new Number(n+o)}if("string"==typeof n&&"string"==typeof o)return n+o;try{var x=$B.$getattr(n.__class__||$B.get_class(n),"__add__")}catch(U){throw U.__class__===_b_.AttributeError?_b_.TypeError.$factory("unsupported operand type(s) for +: '"+$B.class_name(n)+"' and '"+$B.class_name(o)+"'"):U}var N=$B.$call(x)(n,o);return N===_b_.NotImplemented?$B.rich_op("add",n,o):N},$B.div=function(n,o){var l=n/o;return n>min_int&&n<max_int&&o>min_int&&o<max_int&&l>min_int&&l<max_int?l:$B.long_int.__truediv__($B.long_int.$factory(n),$B.long_int.$factory(o))},$B.eq=function(n,o){return n>min_int&&n<max_int&&o>min_int&&o<max_int?n==o:$B.long_int.__eq__($B.long_int.$factory(n),$B.long_int.$factory(o))},$B.floordiv=function(n,o){var l=n/o;return n>min_int&&n<max_int&&o>min_int&&o<max_int&&l>min_int&&l<max_int?Math.floor(l):$B.long_int.__floordiv__($B.long_int.$factory(n),$B.long_int.$factory(o))},$B.mul=function(n,o){var l="number"!=typeof n||"number"!=typeof o?new Number(n*o):n*o;if(n>min_int&&n<max_int&&o>min_int&&o<max_int&&l>min_int&&l<max_int||"number"!=typeof n&&n.__class__!==$B.long_int||"number"!=typeof o&&o.__class__!==$B.long_int)return l;if("number"==typeof n&&isNaN(n)||"number"==typeof o&&isNaN(o))return _b_.float.$factory("nan");switch(n){case 1/0:case-1/0:return 0==o?_b_.float.$factory("nan"):o>0?n:-n}return $B.long_int.__mul__($B.long_int.$factory(n),$B.long_int.$factory(o))},$B.sub=function(n,o){var l="number"!=typeof n||"number"!=typeof o?new Number(n-o):n-o;return n>min_int&&n<max_int&&o>min_int&&o<max_int&&l>min_int&&l<max_int||"number"!=typeof n&&n.__class__!==$B.long_int||"number"!=typeof o&&o.__class__!==$B.long_int?l:"number"==typeof n&&isNaN(n)||"number"==typeof o&&isNaN(o)?_b_.float.$factory("nan"):$B.long_int.__sub__($B.long_int.$factory(n),$B.long_int.$factory(o))},$B.ge=function(n,o){return"number"==typeof n&&"number"==typeof o?n>=o:"number"==typeof n&&"number"!=typeof o?!o.pos:"number"!=typeof n&&"number"==typeof o?!0===n.pos:$B.long_int.__ge__(n,o)},$B.gt=function(n,o){return"number"==typeof n&&"number"==typeof o?n>o:"number"==typeof n&&"number"!=typeof o?!o.pos:"number"!=typeof n&&"number"==typeof o?!0===n.pos:$B.long_int.__gt__(n,o)};var reversed_op={__lt__:"__gt__",__le__:"__ge__",__gt__:"__lt__",__ge__:"__le__"},method2comp={__lt__:"<",__le__:"<=",__gt__:">",__ge__:">="};$B.rich_comp=function(n,o,l){var x,N,U=o.valueOf(),G=l.valueOf();if("number"==typeof U&&"number"==typeof G&&void 0===o.__class__&&void 0===l.__class__)switch(n){case"__eq__":return U==G;case"__ne__":return U!=G;case"__le__":return U<=G;case"__lt__":return U<G;case"__ge__":return U>=G;case"__gt__":return U>G}if(o.$is_class||o.$factory){if("__eq__"==n)return o===l;if("__ne__"==n)return o!==l;throw _b_.TypeError.$factory("'"+method2comp[n]+"' not supported between instances of '"+$B.class_name(o)+"' and '"+$B.class_name(l)+"'")}if(o.__class__&&l.__class__&&l.__class__.__mro__.indexOf(o.__class__)>-1&&($B.$getattr(l,N=reversed_op[n]||n),(x=$B.$call($B.$getattr(l,N))(o))!==_b_.NotImplemented)||(x=$B.$call($B.$getattr(o,n))(l))!==_b_.NotImplemented||(x=$B.$call($B.$getattr(l,N=reversed_op[n]||n))(o))!==_b_.NotImplemented)return x;if("__eq__"==n)return _b_.False;if("__ne__"==n)return _b_.True;throw _b_.TypeError.$factory("'"+method2comp[n]+"' not supported between instances of '"+$B.class_name(o)+"' and '"+$B.class_name(l)+"'")};var opname2opsign={sub:"-",xor:"^",mul:"*"};$B.rich_op=function(n,o,l){var x,N,U=o.__class__||$B.get_class(o);if(U===(l.__class__||$B.get_class(l))){if(U===_b_.int)return _b_.int["__"+n+"__"](o,l);try{x=$B.$call($B.$getattr(o,"__"+n+"__"))}catch(A){if(A.__class__===_b_.AttributeError){var G=$B.class_name(o);throw _b_.TypeError.$factory("unsupported operand type(s) for "+opname2opsign[n]+" : '"+G+"' and '"+G+"'")}throw A}return x(l)}try{x=$B.$call($B.$getattr(o,"__"+n+"__"))}catch(A){if(A.__class__!==_b_.AttributeError)throw A;if((N=$B.$call($B.$getattr(l,"__r"+n+"__"))(o))!==_b_.NotImplemented)return N;throw _b_.TypeError.$factory("'"+(opname2opsign[n]||n)+"' not supported between instances of '"+$B.class_name(o)+"' and '"+$B.class_name(l)+"'")}if((N=x(l))===_b_.NotImplemented){if((N=$B.$call($B.$getattr(l,"__r"+n+"__"))(o))!==_b_.NotImplemented)return N;throw _b_.TypeError.$factory("'"+(opname2opsign[n]||n)+"' not supported between instances of '"+$B.class_name(o)+"' and '"+$B.class_name(l)+"'")}return N},$B.is_none=function(n){return null==n||n==_b_.None};var repr_stack=new Set;$B.repr={enter:function(n){if(repr_stack.has(n))return!0;repr_stack.add(n)},leave:function(n){repr_stack.delete(n)}}}(__BRYTHON__),function($B){var _b_=$B.builtins;_b_.__debug__=!1,$B.$comps={">":"gt",">=":"ge","<":"lt","<=":"le"},$B.$inv_comps={">":"lt",">=":"le","<":"gt","<=":"ge"};var check_nb_args=$B.check_nb_args=function(n,o,l){var x=l.length,N=l[x-1];if(N&&"kw"==N.$nat){var U=N.kw;Array.isArray(U)&&U[1]&&U[1].__class__===_b_.dict&&0==Object.keys(U[1].$string_dict).length&&x--}if(x!=o)throw _b_.TypeError.$factory(0==o?n+"() takes no argument ("+x+" given)":n+"() takes exactly "+o+" argument"+(o<2?"":"s")+" ("+x+" given)")},check_no_kw=$B.check_no_kw=function(n,o,l){if(void 0===o&&console.log("x undef",n,o,l),o.$nat&&o.kw&&o.kw[0]&&o.kw[0].length>0||void 0!==l&&l.$nat)throw _b_.TypeError.$factory(n+"() takes no keyword arguments")},NoneType={$factory:function(){return None},$infos:{__name__:"NoneType",__module__:"builtins"},__bool__:function(n){return False},__class__:_b_.type,__hash__:function(n){return 0},__mro__:[_b_.object],__repr__:function(n){return"None"},__str__:function(n){return"None"},$is_class:!0,__setattr__:function(n,o){return no_set_attr(NoneType,o)}},None={__class__:NoneType};for(var $op in $B.$comps){var key=$B.$comps[$op];switch(key){case"ge":case"gt":case"le":case"lt":NoneType["__"+key+"__"]=function(n){return function(o){return _b_.NotImplemented}}()}}for(var $func in None)"function"==typeof None[$func]&&(None[$func].__str__=function(n){return function(){return"<method-wrapper "+n+" of NoneType object>"}}($func));function abs(n){if(check_nb_args("abs",1,arguments),check_no_kw("abs",n),isinstance(n,_b_.int))return n.__class__===$B.long_int?{__class__:$B.long_int,value:n.value,pos:!0}:_b_.int.$factory(Math.abs(n));if(isinstance(n,_b_.float))return _b_.float.$factory(Math.abs(_b_.float.numerator(n)));var o=n.__class__||$B.get_class(n);try{var l=$B.$getattr(o,"__abs__")}catch(x){throw x.__class__===_b_.AttributeError?_b_.TypeError.$factory("Bad operand type for abs(): '"+$B.class_name(n)+"'"):x}return $B.$call(l)(n)}function all(n){check_nb_args("all",1,arguments),check_no_kw("all",n);for(var o=iter(n);;)try{var l=next(o);if(!$B.$bool(l))return!1}catch{return!0}}function any(n){check_nb_args("any",1,arguments),check_no_kw("any",n);for(var o=iter(n);;)try{var l=next(o);if($B.$bool(l))return!0}catch{return!1}}function ascii(n){check_nb_args("ascii",1,arguments),check_no_kw("ascii",n);for(var o,l=repr(n),x="",N=0;N<l.length;N++)if((o=l.charCodeAt(N))<128)x+=l.charAt(N);else if(o<256)x+="\\x"+o.toString(16);else{var U=o.toString(16);U.length%2==1&&(U="0"+U),x+="\\u"+U}return x}function $builtin_base_convert_helper(n,o){var l="";switch(o){case 2:l="0b";break;case 8:l="0o";break;case 16:l="0x";break;default:console.log("invalid base:"+o)}if(n.__class__===$B.long_int){var x=l+$B.long_int.to_base(n,o);return n.pos||(x="-"+x),x}var N=$B.$GetInt(n);if(void 0===N)throw _b_.TypeError.$factory("Error, argument must be an integer or contains an __index__ function");return N>=0?l+N.toString(o):"-"+l+(-N).toString(o)}function bin_hex_oct(n,o){if(isinstance(o,_b_.int))return $builtin_base_convert_helper(o,n);try{var l=o.__class__||$B.get_class(o),x=$B.$getattr(l,"__index__")}catch(N){throw N.__class__===_b_.AttributeError?_b_.TypeError.$factory("'"+$B.class_name(o)+"' object cannot be interpreted as an integer"):N}return $builtin_base_convert_helper($B.$call(x)(o),n)}function bin(n){return check_nb_args("bin",1,arguments),check_no_kw("bin",n),bin_hex_oct(2,n)}function breakpoint(){$B.$import("sys",[]);var n={},o=$B.$getattr($B.imported.sys,"breakpointhook",n);if(o===n)throw _b_.RuntimeError.$factory("lost sys.breakpointhook");return $B.$call(o).apply(null,arguments)}function callable(n){return check_nb_args("callable",1,arguments),check_no_kw("callable",n),hasattr(n,"__call__")}function chr(n){if(check_nb_args("chr",1,arguments),check_no_kw("chr",n),n<0||n>1114111)throw _b_.ValueError.$factory("Outside valid range");return String.fromCodePoint(n)}$B.set_func_names(NoneType,"builtins");var classmethod=$B.make_class("classmethod",function(n){check_nb_args("classmethod",1,arguments),check_no_kw("classmethod",n);var o=function(){return n.apply(null,arguments)};if(o.__class__=$B.method,n.$attrs)for(var l in n.$attrs)o[l]=n.$attrs[l];return o.$infos={__func__:n,__name__:n.$infos.__name__},o.__get__=function(x,N){var U=function(){return o(N,...arguments)};return U.__class__=$B.method,U.$infos={__self__:N,__func__:o,__name__:n.$infos.__name__,__qualname__:N.$infos.__name__+"."+n.$infos.__name__},U},o.__get__.__class__=$B.method_wrapper,o.__get__.$infos=n.$infos,o});$B.set_func_names(classmethod,"builtins");var code=$B.code=$B.make_class("code");function compile(){var n=$B.args("compile",6,{source:null,filename:null,mode:null,flags:null,dont_inherit:null,optimize:null,_feature_version:null},["source","filename","mode","flags","dont_inherit","optimize","_feature_version"],arguments,{flags:0,dont_inherit:!1,optimize:-1,_feature_version:0},null,null),o="$exec_"+$B.UUID();if($B.clear_ns(o),n.__class__=code,n.co_flags=n.flags,n.name="<module>","single"==n.mode&&512&n.flags&&!n.source.endsWith("\n")){var l=n.source.split("\n");if($B.last(l).startsWith(" "))throw _b_.SyntaxError.$factory("unexpected EOF while parsing")}return $B.py2js(n.source,o,o),n}code.__repr__=code.__str__=function(n){return"<code object "+n.co_name+", file "+n.co_filename+">"},code.__getattribute__=function(n,o){return n[o]},$B.set_func_names(code,"builtins");var __debug__=$B.debug>0;function delattr(n,o){if(check_no_kw("delattr",n,o),check_nb_args("delattr",2,arguments),"string"!=typeof o)throw _b_.TypeError.$factory("attribute name must be string, not '"+$B.class_name(o)+"'");return $B.$getattr(n,"__delattr__")(o)}function dir(n){if(void 0===n){var o=$B.last($B.frames_stack);for(var l in locals_obj=o[1],N=_b_.list.$factory(),U=0,locals_obj)"$"==l.charAt(0)&&"$"!=l.charAt(1)||(N[U++]=l);return _b_.list.sort(N),N}if(check_nb_args("dir",1,arguments),check_no_kw("dir",n),n.__class__||$B.get_class(n),n.$is_class){var x=$B.$getattr(n.__class__,"__dir__");return $B.$call(x)(n)}try{var N=$B.$call($B.$getattr(n,"__dir__"))();return _b_.list.$factory(N)}catch{}N=[];var U=0;for(var l in n)"$"!==l.charAt(0)&&"__class__"!==l&&void 0!==n[l]&&(N[U++]=l);return N.sort(),N}function divmod(n,o){check_no_kw("divmod",n,o),check_nb_args("divmod",2,arguments);var l=n.__class__||$B.get_class(n),x=$B.$getattr(l,"__divmod__",_b_.None);return x!==_b_.None?x(n,o):_b_.tuple.$factory([$B.$getattr(l,"__floordiv__")(n,o),$B.$getattr(l,"__mod__")(n,o)])}$B.$delete=function(n,o){function l(U){U.__class__===$B.generator&&U.return()}var x=!1,N=$B.last($B.frames_stack);if(o?N[2]!=N[0]&&void 0!==N[3][n]&&(x=!0,l(N[3][n]),delete N[3][n]):void 0!==N[1][n]&&(x=!0,l(N[1][n]),delete N[1][n]),!x)throw _b_.NameError.$factory(n)};var enumerate=$B.make_class("enumerate",function(){var n=$B.args("enumerate",2,{iterable:null,start:null},["iterable","start"],arguments,{start:0},null,null),o=iter(n.iterable),l=n.start;return{__class__:enumerate,__name__:"enumerate iterator",counter:l-1,iter:o,start:l}});function $$eval(src,_globals,_locals){var $=$B.args("eval",4,{src:null,globals:null,locals:null,mode:null},["src","globals","locals","mode"],arguments,{globals:_b_.None,locals:_b_.None,mode:"eval"},null,null),src=$.src,_globals=$.globals,_locals=$.locals,mode=$.mode;$.src.mode&&"single"==$.src.mode&&["<console>","<stdin>"].indexOf($.src.filename)>-1&&_b_.print(">",$.src.source.trim());var current_frame=$B.frames_stack[$B.frames_stack.length-1];if(void 0!==current_frame)var current_locals_id=current_frame[0].replace(/\./g,"_"),current_globals_id=current_frame[2].replace(/\./g,"_");var stack_len=$B.frames_stack.length;if(src.__class__===code)mode=src.mode,src=src.source;else if("string"!=typeof src)throw _b_.TypeError.$factory("eval() arg 1 must be a string, bytes or code object");var globals_id="$exec_"+$B.UUID(),globals_name=globals_id,locals_id="$exec_"+$B.UUID(),parent_scope;if(_globals===_b_.None){current_locals_id==current_globals_id&&(locals_id=globals_id);var local_scope={module:globals_id,id:locals_id,binding:{},bindings:{}};for(var attr in current_frame[1])local_scope.binding[attr]=!0,local_scope.bindings[attr]=!0;var global_scope={module:globals_id,id:globals_id,binding:{},bindings:{}};for(var attr in current_frame[3])global_scope.binding[attr]=!0,global_scope.bindings[attr]=!0;local_scope.parent_block=global_scope,global_scope.parent_block=$B.builtins_scope,parent_scope=local_scope,eval("$locals_"+parent_scope.id+" = current_frame[1]")}else{if(_globals.__class__!=_b_.dict)throw _b_.TypeError.$factory("exec() globals must be a dict, not "+$B.class_name(_globals));if(_globals.globals_id&&(globals_id=globals_name=_globals.globals_id),_globals.globals_id=globals_id,_locals===_globals||_locals===_b_.None)locals_id=globals_id,parent_scope=$B.builtins_scope;else{var grandparent_scope={id:globals_id,parent_block:$B.builtins_scope,binding:{}};for(var attr in parent_scope={id:locals_id,parent_block:grandparent_scope,binding:{}},_globals.$string_dict)grandparent_scope.binding[attr]=!0;for(var attr in _locals.$string_dict)parent_scope.binding[attr]=!0}}if($B.$py_module_path[globals_id]=$B.$py_module_path[current_globals_id],eval("var $locals_"+globals_id+" = {}\nvar $locals_"+locals_id+" = {}"),_globals===_b_.None){var gobj=current_frame[3],ex="var $locals_"+globals_id+" = gobj;",obj={};for(var attr in eval(ex),gobj)attr.startsWith("$")&&!attr.startsWith("$$")||(obj[attr]=gobj[attr]);eval("$locals_"+globals_id+" = obj")}else{var globals_is_dict=!1;if(_globals.$jsobj)var items=_globals.$jsobj;else{var items=_b_.dict.$to_obj(_globals);_globals.$jsobj=items,globals_is_dict=!0}for(var item in eval("$locals_"+globals_id+" = _globals.$jsobj"),items){var item1=$B.to_alias(item);try{eval("$locals_"+globals_id+'["'+item+'"] = items.'+item)}catch(n){console.log(n),console.log("error setting",item);break}}}if(_globals.$is_namespace=!0,_locals===_b_.None)if(_globals!==_b_.None)eval("var $locals_"+locals_id+" = $locals_"+globals_id);else{var lobj=current_frame[1],ex="",obj={};for(var attr in current_frame[1])attr.startsWith("$")&&!attr.startsWith("$$")||(obj[attr]=lobj[attr]);eval("$locals_"+locals_id+" = obj")}else{var locals_is_dict=!1;if(_locals.$jsobj)var items=_locals.$jsobj;else{locals_id_dict=!0;var items=_b_.dict.$to_obj(_locals);_locals.$jsobj=items}for(var item in items){var item1=$B.to_alias(item);try{eval("$locals_"+locals_id+'["'+item+'"] = items.'+item)}catch(n){console.log(n),console.log("error setting",item);break}}eval("$locals_"+locals_id+".$exec_locals = true")}_locals.$is_namespace=!0,_globals===_b_.None&&_locals===_b_.None&&current_frame[0]==current_frame[2]||eval("$locals_"+locals_id+".$src = src");var root=$B.py2js(src,globals_id,locals_id,parent_scope),js,gns,lns;if(_globals!==_b_.None&&_locals==_b_.None)for(var attr in _globals.$string_dict)root.binding[attr]=!0;try{var try_node=root.children[root.children.length-2],instr=try_node.children[try_node.children.length-2],type=instr.C.tree[0].type;switch(type){case"expr":case"list_or_tuple":case"op":case"ternary":var children=try_node.children;root.children.splice(root.children.length-2,2);for(var i=0;i<children.length-1;i++)root.add(children[i]);break;default:if("eval"==mode)throw _b_.SyntaxError.$factory("eval() argument must be an expression","<string>",1,1,src)}if("eval"!=mode){var last=$B.last(root.children),js=last.to_js();-1==["node_js"].indexOf(last.C.type)&&(last.to_js=function(){for(;js.endsWith("\n");)js=js.substr(0,js.length-1);for(;js.endsWith(";");)js=js.substr(0,js.length-1);return"return ("+js+")"}),js=root.to_js();var locals_obj=eval("$locals_"+locals_id),globals_obj=eval("$locals_"+globals_id);if(_globals===_b_.None)var res=new Function("$locals_"+globals_id,"$locals_"+locals_id,js)(globals_obj,locals_obj);else{current_globals_obj=current_frame[3],current_locals_obj=current_frame[1];var res=new Function("$locals_"+globals_id,"$locals_"+locals_id,"$locals_"+current_globals_id,"$locals_"+current_locals_id,js)(globals_obj,locals_obj,current_globals_obj,current_locals_obj)}$.src.mode&&"single"==$.src.mode&&"<stdin>"==$.src.filename&&res!==_b_.None&&void 0!==res&&_b_.print(_b_.repr(res))}else{js=root.to_js();var res=eval(js)}if("<console>"==$.src.filename&&"single"==$.src.mode&&void 0!==res&&res!==_b_.None&&_b_.print(res),gns=eval("$locals_"+globals_id),$B.frames_stack[$B.frames_stack.length-1][2]==globals_id&&(gns=$B.frames_stack[$B.frames_stack.length-1][3]),_locals!==_b_.None)for(var attr in lns=eval("$locals_"+locals_id),lns){var attr1=$B.from_alias(attr);"$"!=attr1.charAt(0)&&(_locals.$jsobj?_locals.$jsobj[attr]=lns[attr]:_b_.dict.$setitem(_locals,attr1,lns[attr]))}else for(var attr in lns)"$src"!==attr&&(current_frame[1][attr]=lns[attr]);if(_globals!==_b_.None){if(globals_is_dict){var jsobj=_globals.$jsobj;delete _globals.$jsobj}for(var attr in gns)attr1=$B.from_alias(attr),"$"!=attr1.charAt(0)&&(globals_is_dict?_b_.dict.$setitem(_globals,attr,gns[attr]):_globals.$jsobj[attr1]=gns[attr]);for(var attr in _globals.$string_dict)attr.startsWith("$")&&!attr.startsWith("$$")&&delete _globals.$string_dict[attr]}else for(var attr in gns)"$src"!==attr&&(current_frame[3][attr]=gns[attr]);return void 0===res?_b_.None:res}catch(n){throw n.src=src,n.module=globals_id,void 0===n.$py_error?$B.exception(n):n}finally{$B.frames_stack.length==stack_len+1&&$B.frames_stack.pop(),root=null,js=null,gns=null,lns=null,$B.clear_ns(globals_id),$B.clear_ns(locals_id)}}function exec(n,o,l){var x=$B.args("exec",3,{src:null,globals:null,locals:null},["src","globals","locals"],arguments,{globals:_b_.None,locals:_b_.None},null,null);return $$eval(x.src,x.globals,x.locals,"exec")||_b_.None}function exit(){throw _b_.SystemExit}enumerate.__iter__=function(n){return n.counter=n.start-1,n},enumerate.__next__=function(n){return n.counter++,$B.fast_tuple([n.counter,next(n.iter)])},$B.set_func_names(enumerate,"builtins"),$B.from_alias=function(n){return"$$"==n.substr(0,2)&&$B.aliased_names[n.substr(2)]?n.substr(2):n},$B.to_alias=function(n){return $B.aliased_names[n]?"$$"+n:n},$$eval.$is_func=!0,exec.$is_func=!0,exit.__repr__=exit.__str__=function(){return"Use exit() or Ctrl-Z plus Return to exit"};var filter=$B.make_class("filter",function(n,o){return check_no_kw("filter",n,o),check_nb_args("filter",2,arguments),o=iter(o),n===_b_.None&&(n=$B.$bool),{__class__:filter,func:n,iterable:o}});function format(n,o){var l=$B.args("format",2,{value:null,format_spec:null},["value","format_spec"],arguments,{format_spec:""},null,null),x=n.__class__||$B.get_class(n);try{var N=$B.$getattr(x,"__format__")}catch(U){throw U.__class__===_b_.AttributeError?_b_.NotImplementedError("__format__ is not implemented for object '"+_b_.str.$factory(n)+"'"):U}return $B.$call(N)(n,l.format_spec)}function attr_error(n,o){var l="bad operand type for unary #: '"+o+"'";switch(n){case"__neg__":throw _b_.TypeError.$factory(l.replace("#","-"));case"__pos__":throw _b_.TypeError.$factory(l.replace("#","+"));case"__invert__":throw _b_.TypeError.$factory(l.replace("#","~"));case"__call__":throw _b_.TypeError.$factory("'"+o+"' object is not callable");default:for(;"$"==n.charAt(0);)n=n.substr(1);throw _b_.AttributeError.$factory("'"+o+"' object has no attribute '"+n+"'")}}function getattr(){var n={},o=$B.args("getattr",3,{obj:null,attr:null,_default:null},["obj","attr","_default"],arguments,{_default:n},null,null);return $B.$getattr(o.obj,o.attr,o._default===n?void 0:o._default)}function in_mro(n,o){if(void 0===n)return!1;if(n.hasOwnProperty(o))return n[o];for(var l=n.__mro__,x=0,N=l.length;x<N;x++)if(l[x].hasOwnProperty(o))return l[x][o];return!1}function globals(){check_nb_args("globals",0,arguments);var n=$B.obj_dict($B.last($B.frames_stack)[3]);return n.$jsobj.__BRYTHON__=$B.JSObj.$factory($B),n.$is_namespace=!0,n}function hasattr(n,o){check_no_kw("hasattr",n,o),check_nb_args("hasattr",2,arguments);try{return $B.$getattr(n,o),!0}catch{return!1}}filter.__iter__=function(n){return n},filter.__next__=function(n){for(;;){var o=next(n.iterable);if(n.func(o))return o}},$B.set_func_names(filter,"builtins"),$B.$getattr=function(n,o,l){if(o=$B.to_alias(o),n.$method_cache&&n.$method_cache[o]&&n.__class__&&n.__class__[o]==n.$method_cache[o][1])return n.$method_cache[o][0];var x=o;void 0===n&&console.log("get attr",o,"of undefined");var N,U=n.$is_class||n.$factory,G=n.__class__;if(void 0!==G&&G.__bases__&&(0==G.__bases__.length||1==G.__bases__.length&&G.__bases__[0]===_b_.object)){if(n.hasOwnProperty(o))return n[o];if(n.__dict__&&n.__dict__.$string_dict.hasOwnProperty(o)&&(!G.hasOwnProperty(o)||!G[o].__get__))return n.__dict__.$string_dict[o][0];if(G.hasOwnProperty(o)&&"function"!=typeof G[o]&&"__dict__"!=o&&void 0===G[o].__get__&&!in_mro(G[o].__class__,"__get__"))return G[o]}if(void 0===G)if("string"==typeof n)G=_b_.str;else if("number"==typeof n)G=n%1==0?_b_.int:_b_.float;else if(n instanceof Number)G=_b_.float;else if(void 0===(G=$B.get_class(n))){if(void 0!==(P=n[o])){if("function"==typeof P){var A=function(){return P.apply(n,arguments)};return A.$infos={__name__:o,__qualname__:o},A}return $B.$JS2Py(P)}if(void 0!==l)return l;throw _b_.AttributeError.$factory("object has no attribute "+x)}switch(o){case"__call__":if("function"==typeof n){var P=function(){return n.apply(null,arguments)};return P.__class__=method_wrapper,P.$infos={__name__:"__call__"},P}break;case"__class__":return G;case"__dict__":if(U){var de={};for(var be in n){var te=$B.from_alias(be);te.startsWith("$")||(de[te]=n[be])}return de.__dict__=$B.getset_descriptor.$factory(n,"__dict__"),$B.mappingproxy.$factory(de)}if(n.hasOwnProperty(o))return n[o];if(n.$infos){if(n.$infos.hasOwnProperty("__dict__"))return n.$infos.__dict__;if(n.$infos.hasOwnProperty("__func__"))return n.$infos.__func__.$infos.__dict__}return $B.obj_dict(n);case"__doc__":for(var ce=0;ce<builtin_names.length;ce++)if(n===_b_[builtin_names[ce]])return _get_builtins_doc(),$B.builtins_doc[builtin_names[ce]];break;case"__mro__":if(n.$is_class)return _b_.tuple.$factory([n].concat(n.__mro__));if(n.__dict__&&void 0!==n.__dict__.$string_dict.__mro__)return n.__dict__.$string_dict.__mro__;throw _b_.AttributeError.$factory(o);case"__subclasses__":if(G.$factory||G.$is_class){var fe=n.$subclasses||[];return function(){return fe}}}if("function"==typeof n){var _e=n[o];if(void 0!==_e&&"__module__"==o)return _e}if(!U&&G.$native){if(n.$method_cache&&n.$method_cache[o])return n.$method_cache[o];if("__doc__"==o&&void 0===G[o]&&G.$infos&&(_get_builtins_doc(),G[o]=$B.builtins_doc[G.$infos.__name__]),void 0===G[o]){var le=_b_.object[o];if(void 0===le){var pe=n.__dict__;return pe&&void 0!==(le=pe.$string_dict[o])?le[0]:(void 0===l&&attr_error(o,G.$infos.__name__),l)}G[o]=le}if(G.$descriptors&&void 0!==G.$descriptors[o])return G[o](n);if("function"==typeof G[o]){var T=G[o];if("__new__"==o&&(T.$type="staticmethod"),"staticmethod"==T.$type)return T;var B=G[o].__class__==$B.method?G:n,q=G[o].bind(null,B);return q.__class__=$B.method,q.$infos={__func__:T,__name__:o,__self__:B,__qualname__:G.$infos.__name__+"."+o},"object"==typeof n&&(n.__class__=G,n.$method_cache=n.$method_cache||{},n.$method_cache[o]=q),q}if(void 0!==G[o])return G[o];attr_error(x,G.$infos.__name__)}if(U)N=_b_.type.__getattribute__;else if(void 0===(N=G.__getattribute__)){var ee;void 0===(ee=G.__mro__)&&console.log(n,o,"no mro, klass",G),ce=0;for(var F=ee.length;ce<F&&void 0===(N=ee[ce].__getattribute__);ce++);}if("function"!=typeof N&&console.log(o+" is not a function "+N,G),N===_b_.object.__getattribute__){if(P=n[o],Array.isArray(n)&&void 0!==Array.prototype[o]&&(P=void 0),null===P)return null;if(void 0===P&&n.hasOwnProperty(o)||void 0!==P&&(void 0===P.__set__||P.$is_class))return P}try{P=N(n,o)}catch(K){if(void 0!==l)return l;throw K}if(void 0!==P)return P;if(void 0!==l)return l;var Be=G.$infos.__name__;U&&(Be=n.$infos.__name__),attr_error(x,Be)};var hash_cache={};function hash(n){if(check_no_kw("hash",n),check_nb_args("hash",1,arguments),void 0!==n.__hashvalue__)return n.__hashvalue__;if(isinstance(n,_b_.bool))return _b_.int.$factory(n);if(isinstance(n,_b_.int))return void 0===n.$brython_value?n.valueOf():n.__hashvalue__=n.$brython_value;if(n.$is_class||n.__class__===_b_.type||n.__class__===$B.Function)return n.__hashvalue__=$B.$py_next_hash--;if("string"==typeof n){var o=hash_cache[n];return void 0!==o?o:hash_cache[n]=_b_.str.__hash__(n)}var l=n.__class__||$B.get_class(n);if(void 0===l)throw _b_.TypeError.$factory("unhashable type: '"+_b_.str.$factory($B.JSObj.$factory(n))+"'");var x=$B.$getattr(l,"__hash__",_b_.None);if(x===_b_.None)throw _b_.TypeError.$factory("unhashable type: '"+$B.class_name(n)+"'");if(x.$infos.__func__===_b_.object.__hash__){if($B.$getattr(n,"__eq__").$infos.__func__!==_b_.object.__eq__)throw _b_.TypeError.$factory("unhashable type: '"+$B.class_name(n)+"'","hash");return n.__hashvalue__=_b_.object.__hash__(n)}return $B.$call(x)(n)}function _get_builtins_doc(){if(void 0===$B.builtins_doc){var url=$B.brython_path;"/"==url.charAt(url.length-1)&&(url=url.substr(0,url.length-1)),url+="/builtins_docstrings.js";var f=_b_.open(url);eval(f.$string),$B.builtins_doc=docs}}function help(n){if(void 0===n&&(n="help"),"string"==typeof n&&void 0!==_b_[n]){_get_builtins_doc();var o=$B.builtins_doc[n];if(void 0!==o&&""!=o)return void _b_.print(o)}for(var l=0;l<builtin_names.length;l++)n===_b_[builtin_names[l]]&&(_get_builtins_doc(),_b_.print(o=$B.builtins_doc[builtin_names[l]]));if("string"!=typeof n)try{return $B.$getattr(n,"__doc__")}catch{return""}else $B.$import("pydoc"),$B.$getattr($B.$getattr($B.imported.pydoc,"help"),"__call__")(n)}function hex(n){return check_no_kw("hex",n),check_nb_args("hex",1,arguments),bin_hex_oct(16,n)}function id(n){return check_no_kw("id",n),check_nb_args("id",1,arguments),isinstance(n,[_b_.str,_b_.int,_b_.float])&&!isinstance(n,$B.long_int)?$B.$getattr(_b_.str.$factory(n),"__hash__")():void 0!==n.$id?n.$id:n.$id=$B.UUID()}function __import__(n,o,l,x,N){var U=$B.args("__import__",5,{name:null,globals:null,locals:null,fromlist:null,level:null},["name","globals","locals","fromlist","level"],arguments,{globals:None,locals:None,fromlist:_b_.tuple.$factory(),level:0},null,null);return $B.$__import__(U.name,U.globals,U.locals,U.fromlist)}function input(n){var o=prompt(n||"")||"";return $B.imported.sys&&$B.imported.sys.ps1&&(n!=$B.imported.sys.ps1&&n!=$B.imported.sys.ps2||console.log(n,o)),o}function isinstance(n,o){if(check_no_kw("isinstance",n,o),check_nb_args("isinstance",2,arguments),null===n)return o===None;if(void 0===n)return!1;if(o.constructor===Array){for(var l=0;l<o.length;l++)if(isinstance(n,o[l]))return!0;return!1}if(o.__class__===$B.GenericAlias)throw _b_.TypeError.$factory("isinstance() arg 2 cannot be a parameterized generic");if(!o.__class__||void 0===o.$factory&&void 0===o.$is_class)throw _b_.TypeError.$factory("isinstance() arg 2 must be a type or tuple of types");if(o===_b_.int&&(n===True||n===False))return True;if(o===_b_.bool)switch(typeof n){case"string":case"number":return!1;case"boolean":return!0}var x=n.__class__;if(null==x){if("string"==typeof n){if(o==_b_.str)return!0;if($B.builtin_classes.indexOf(o)>-1)return!1}else if(n.contructor===Number&&Number.isFinite(n)){if(o==_b_.float)return!0}else if("number"==typeof n&&Number.isFinite(n)&&Number.isFinite(n)&&o==_b_.int)return!0;x=$B.get_class(n)}if(void 0===x)return!1;function N(A,P){return A===P||P===_b_.str&&A===$B.StringSubclass||P===_b_.int&&A===$B.IntSubclass||void 0}if(N(x,o))return!0;var U=x.__mro__;for(l=0;l<U.length;l++)if(N(U[l],o))return!0;var G=$B.$getattr(o.__class__||$B.get_class(o),"__instancecheck__",_b_.None);return G!==_b_.None&&G(o,n)}function issubclass(n,o){if(check_no_kw("issubclass",n,o),check_nb_args("issubclass",2,arguments),!n.__class__||void 0===n.$factory&&void 0===n.$is_class)throw _b_.TypeError.$factory("issubclass() arg 1 must be a class");if(isinstance(o,_b_.tuple)){for(var l=0;l<o.length;l++)if(issubclass(n,o[l]))return!0;return!1}if(o.__class__===$B.GenericAlias)throw _b_.TypeError.$factory("issubclass() arg 2 cannot be a parameterized generic");if((o.$factory||o.$is_class)&&(n===o||n.__mro__.indexOf(o)>-1))return!0;var x=$B.$getattr(o.__class__||$B.get_class(o),"__subclasscheck__",_b_.None);return x!=_b_.None&&x(o,n)}help.__repr__=help.__str__=function(){return"Type help() for interactive help, or help(object) for help about object."};var iterator_class=$B.make_class("iterator",function(n,o){return{__class__:iterator_class,getitem:n,len:o,counter:-1}});function iter(){var n=$B.args("iter",1,{obj:null},["obj"],arguments,{},"args","kw");if(n.args.length>0)var o=n.args[0];return $B.$iter(n.obj,o)}function len(n){check_no_kw("len",n),check_nb_args("len",1,arguments);var o=n.__class__||$B.get_class(n);try{var l=$B.$getattr(o,"__len__")}catch{throw _b_.TypeError.$factory("object of type '"+$B.class_name(n)+"' has no len()")}return $B.$call(l)(n)}function locals(){check_nb_args("locals",0,arguments);var n=$B.obj_dict($B.last($B.frames_stack)[1]);return n.$is_namespace=!0,delete n.$jsobj.__annotations__,n}iterator_class.__next__=function(n){if(n.counter++,null!==n.len&&n.counter==n.len)throw _b_.StopIteration.$factory("");try{return n.getitem(n.counter)}catch{throw _b_.StopIteration.$factory("")}},callable_iterator=$B.make_class("callable_iterator",function(n,o){return{__class__:callable_iterator,func:n,sentinel:o}}),callable_iterator.__iter__=function(n){return n},callable_iterator.__next__=function(n){var o=n.func();if($B.rich_comp("__eq__",o,n.sentinel))throw _b_.StopIteration.$factory();return o},$B.$iter=function(n,o){if(void 0===o){var l=n.__class__||$B.get_class(n);try{var x=$B.$call($B.$getattr(l,"__iter__"))}catch(G){if(G.__class__===_b_.AttributeError)try{var N=$B.$call($B.$getattr(l,"__getitem__"));return len(n),iterator_class.$factory(function(A){return N(n,A)},len)}catch{throw _b_.TypeError.$factory("'"+$B.class_name(n)+"' object is not iterable")}throw G}var U=$B.$call(x)(n);try{$B.$getattr(U,"__next__")}catch(G){if(isinstance(G,_b_.AttributeError))throw _b_.TypeError.$factory("iter() returned non-iterator of type '"+$B.class_name(U)+"'")}return U}return callable_iterator.$factory(n,o)};var map=$B.make_class("map",function(){var n=$B.args("map",2,{func:null,it1:null},["func","it1"],arguments,{},"args",null),o=$B.$call(n.func),l=[$B.$iter(n.it1)];return n.args.forEach(function(x){l.push($B.$iter(x))}),{__class__:map,args:l,func:o}});function $extreme(n,o){var l="min";if("__gt__"===o&&(l="max"),0==n.length)throw _b_.TypeError.$factory(l+" expected 1 arguments, got 0");var x=n[n.length-1],N=n.length,U=!1,G=!1;if("kw"==x.$nat)for(var A in N--,x=x.kw)switch(A){case"key":G=x[A];break;case"$$default":var P=x[A];U=!0;break;default:throw _b_.TypeError.$factory("'"+A+"' is an invalid keyword argument for this function")}if(G||(G=function(fe){return fe}),0==N)throw _b_.TypeError.$factory(l+" expected 1 argument, got 0");if(1!=N){if(U)throw _b_.TypeError.$factory("Cannot specify a default for "+l+"() with multiple positional arguments");te=null;for(var de=0;de<N;de++)ce=n[de],(null===te||$B.$bool($B.$getattr(G(ce),o)(G(te))))&&(te=ce);return te}for(var be=iter(n[0]),te=null;;)try{var ce=next(be);(null===te||$B.$bool($B.$getattr(G(ce),o)(G(te))))&&(te=ce)}catch(fe){if(fe.__class__==_b_.StopIteration){if(null===te){if(U)return P;throw _b_.ValueError.$factory(l+"() arg is an empty sequence")}return te}throw fe}}function max(){return $extreme(arguments,"__gt__")}map.__iter__=function(n){return n},map.__next__=function(n){for(var o=[],l=0;l<n.args.length;l++)o.push(next(n.args[l]));return n.func.apply(null,o)},$B.set_func_names(map,"builtins");var memoryview=$B.make_class("memoryview",function(n){if(check_no_kw("memoryview",n),check_nb_args("memoryview",1,arguments),n.__class__===memoryview)return n;if($B.get_class(n).$buffer_protocol)return{__class__:memoryview,obj:n,format:"B",itemsize:1,ndim:1,shape:_b_.tuple.$factory([_b_.len(n)]),strides:_b_.tuple.$factory([1]),suboffsets:_b_.tuple.$factory([]),c_contiguous:!0,f_contiguous:!0,contiguous:!0};throw _b_.TypeError.$factory("memoryview: a bytes-like object is required, not '"+$B.class_name(n)+"'")});function min(){return $extreme(arguments,"__lt__")}function next(n){check_no_kw("next",n);var o={},l=$B.args("next",2,{obj:null,def:null},["obj","def"],arguments,{def:o},null,null),x=n.__class__||$B.get_class(n),N=$B.$call($B.$getattr(x,"__next__"));if(void 0!==N)try{return $B.$call(N)(n)}catch(U){if(U.__class__===_b_.StopIteration&&l.def!==o)return l.def;throw U}throw _b_.TypeError.$factory("'"+$B.class_name(n)+"' object is not an iterator")}memoryview.__eq__=function(n,o){return o.__class__===memoryview&&$B.$getattr(n.obj,"__eq__")(o.obj)},memoryview.__getitem__=function(n,o){if(isinstance(o,_b_.int)){var l=o*n.itemsize;if("I"==n.format){for(var x=n.obj.source[l],N=256,U=1;U<4;U++)x+=n.obj.source[l+U]*N,N*=256;return x}if("B".indexOf(n.format)>-1){if(o>n.obj.source.length-1)throw _b_.KeyError.$factory(o);return n.obj.source[o]}return n.obj.source[o]}if(x=n.obj.__class__.__getitem__(n.obj,o),o.__class__===_b_.slice)return memoryview.$factory(x)},memoryview.__len__=function(n){return len(n.obj)/n.itemsize},memoryview.cast=function(n,o){switch(o){case"B":return memoryview.$factory(n.obj);case"I":var l=memoryview.$factory(n.obj),x=len(n.obj);if(l.itemsize=4,l.format="I",x%4!=0)throw _b_.TypeError.$factory("memoryview: length is not a multiple of itemsize");return l}},memoryview.hex=function(n){var o="";return _b_.bytes.$factory(n).source.forEach(function(l){o+=l.toString(16)}),o},memoryview.tobytes=function(n){return _b_.bytes.$factory(n.obj)},memoryview.tolist=function(n){if(1==n.itemsize)return _b_.list.$factory(_b_.bytes.$factory(n.obj));if(4==n.itemsize&&"I"==n.format){for(var o=[],l=0;l<n.obj.source.length;l+=4){for(var x=n.obj.source[l],N=256,U=1;U<4;U++)x+=N*n.obj.source[l+U],N*=256;o.push(x)}return o}},$B.set_func_names(memoryview,"builtins");var NotImplementedType=$B.make_class("NotImplementedType",function(){return NotImplemented});NotImplementedType.__repr__=NotImplementedType.__str__=function(n){return"NotImplemented"};var NotImplemented={__class__:NotImplementedType};function $not(n){return!$B.$bool(n)}function oct(n){return check_no_kw("oct",n),check_nb_args("oct",1,arguments),bin_hex_oct(8,n)}function ord(n){if(check_no_kw("ord",n),check_nb_args("ord",1,arguments),"string"==typeof n){if(1==n.length)return n.charCodeAt(0);throw _b_.TypeError.$factory("ord() expected a character, but string of length "+n.length+" found")}switch($B.get_class(n)){case _b_.str:if(1==n.length)return n.charCodeAt(0);throw _b_.TypeError.$factory("ord() expected a character, but string of length "+n.length+" found");case _b_.str.$surrogate:if(1==n.items.length)return n.items[0].codePointAt(0);throw _b_.TypeError.$factory("ord() expected a character, but string of length "+n.items.length+" found");case _b_.bytes:case _b_.bytearray:if(1==n.source.length)return n.source[0];throw _b_.TypeError.$factory("ord() expected a character, but string of length "+n.source.length+" found");default:throw _b_.TypeError.$factory("ord() expected a character, but "+$B.class_name(n)+" was found")}}function pow(){var n=$B.args("pow",3,{x:null,y:null,mod:null},["x","y","mod"],arguments,{mod:None},null,null),o=n.x,l=n.y,x=n.mod,N=o.__class__||$B.get_class(o);if(x===_b_.None)return $B.$call($B.$getattr(N,"__pow__"))(o,l);if(o!=_b_.int.$factory(o)||l!=_b_.int.$factory(l))throw _b_.TypeError.$factory("pow() 3rd argument not allowed unless all arguments are integers");return $B.$call($B.$getattr(N,"__pow__"))(o,l,x)}function $print(){var n=$B.args("print",0,{},[],arguments,{},"args","kw"),o=n.kw.$string_dict,l=void 0===o.end||o.end===None?"\n":o.end[0],x=void 0===o.sep||o.sep===None?" ":o.sep[0],N=void 0===o.file?$B.stdout:o.file[0],G=[];n.args.forEach(function(de){G.push(_b_.str.$factory(de))});var A=G.join(x)+l;A=A.replace(new RegExp("\x07","g"),"").replace(new RegExp("(.)\b","g"),""),$B.$getattr(N,"write")(A);var P=$B.$getattr(N,"flush",None);return P!==None&&P(),None}$print.__name__="print",$print.is_func=!0;var property=$B.make_class("property",function(n,o,l,x){var N={__class__:property};return property.__init__(N,n,o,l,x),N});function quit(){throw _b_.SystemExit}function repr(n){check_no_kw("repr",n),check_nb_args("repr",1,arguments);var o=n.__class__||$B.get_class(n);return $B.$call($B.$getattr(o,"__repr__"))(n)}property.__init__=function(n,o,l,x,N){if(n.__doc__=N||"",n.$type=o.$type,n.fget=o,n.fset=l,n.fdel=x,o&&o.$attrs)for(var U in o.$attrs)n[U]=o.$attrs[U];n.__get__=function(G,A,P){if(void 0===A)return G;if(void 0===G.fget)throw _b_.AttributeError.$factory("unreadable attribute");return $B.$call(G.fget)(A)},void 0!==l&&(n.__set__=function(G,A,P){if(void 0===G.fset)throw _b_.AttributeError.$factory("can't set attribute");$B.$getattr(G.fset,"__call__")(A,P)}),n.__delete__=x,n.getter=function(G){return property.$factory(G,n.fset,n.fdel,n.__doc__)},n.setter=function(G){return property.$factory(n.fget,G,n.fdel,n.__doc__)},n.deleter=function(G){return property.$factory(n.fget,n.fset,G,n.__doc__)}},property.__repr__=function(n){return _b_.repr(n.fget(n))},property.__str__=function(n){return _b_.str.$factory(n.fget(n))},$B.set_func_names(property,"builtins"),quit.__repr__=quit.__str__=function(){return"Use quit() or Ctrl-Z plus Return to exit"};var reversed=$B.make_class("reversed",function(n){check_no_kw("reversed",n),check_nb_args("reversed",1,arguments);var o=n.__class__||$B.get_class(n),l=$B.$getattr(o,"__reversed__",null);if(null!==l)return $B.$call(l)(n);try{var x=$B.$getattr(o,"__getitem__")}catch{throw _b_.TypeError.$factory("argument to reversed() must be a sequence")}return{__class__:reversed,$counter:_b_.len(n),getter:function(U){return $B.$call(x)(n,U)}}});function round(){var n=$B.args("round",2,{number:null,ndigits:null},["number","ndigits"],arguments,{ndigits:None},null,null),o=n.number,l=n.ndigits===None?0:n.ndigits;if(!isinstance(o,[_b_.int,_b_.float])){var x=o.__class__||$B.get_class(o);try{return $B.$call($B.$getattr(x,"__round__")).apply(null,arguments)}catch(P){throw P.__class__===_b_.AttributeError?_b_.TypeError.$factory("type "+$B.class_name(o)+" doesn't define __round__ method"):P}}if(isinstance(o,_b_.float)&&(o.value===1/0||o.value===-1/0))throw _b_.OverflowError.$factory("cannot convert float infinity to integer");if(!isinstance(l,_b_.int))throw _b_.TypeError.$factory("'"+$B.class_name(l)+"' object cannot be interpreted as an integer");var N,U=Math.pow(10,l),G=o*U,A=Math.floor(G);return.5==Math.abs(G-A)?(A%2&&(A+=1),N=_b_.int.__truediv__(A,U)):N=_b_.int.__truediv__(Math.round(G),U),n.ndigits===None?N.valueOf():o instanceof Number?new Number(N):N.valueOf()}function setattr(){var n=$B.args("setattr",3,{obj:null,attr:null,value:null},["obj","attr","value"],arguments,{},null,null),o=n.obj,l=n.attr,x=n.value;if("string"!=typeof l)throw _b_.TypeError.$factory("setattr(): attribute name must be string");return $B.$setattr(o,l,x)}function sorted(){for(var n=$B.args("sorted",1,{iterable:null},["iterable"],arguments,{},null,"kw"),o=_b_.list.$factory(iter(n.iterable)),l=[o],x=1;x<arguments.length;x++)l.push(arguments[x]);return _b_.list.sort.apply(null,l),o}reversed.__iter__=function(n){return n},reversed.__next__=function(n){if(n.$counter--,n.$counter<0)throw _b_.StopIteration.$factory("");return n.getter(n.$counter)},$B.set_func_names(reversed,"builtins"),$B.$setattr=function(n,o,l){if($B.aliased_names[o])o="$$"+o;else{if("__dict__"==o){if(!isinstance(l,_b_.dict))throw _b_.TypeError.$factory("__dict__ must be set to a dictionary, not a '"+$B.class_name(l)+"'");return n.$infos?(n.$infos.__dict__=l,None):(n.__dict__=l,None)}if("__class__"==o){let T=function(B){throw _b_.TypeError.$factory(B)};if(l.__class__)if("builtins"==l.__module__)T("__class__ assignement only supported for heap types or ModuleType subclasses");else if(Array.isArray(l.__bases__))for(var x=0;x<l.__bases__.length;x++)"builtins"==l.__bases__[x].__module__&&T("__class__ assignment: '"+$B.class_name(n)+"' object layout differs from '"+$B.class_name(l)+"'");return n.__class__=l,None}"__doc__"==o&&n.__class__===_b_.property&&(n[o]=l)}if(n.$factory||n.$is_class){var N=n.__class__;return N&&N[o]&&N[o].__get__&&N[o].__set__?(N[o].__set__(n,l),None):(n[o]=l,"__init__"==o||"__new__"==o?n.$factory=$B.$instance_creator(n):"__bases__"==o&&(n.__mro__=_b_.type.mro(n)),None)}var U=n[o],G=n.__class__||$B.get_class(n);if(void 0===U&&G&&void 0===(U=G[o])){var A=(ce=G.__mro__).length;for(x=0;x<A&&void 0===(U=ce[x][o]);x++);}if(null!=U){if(void 0!==U.__set__)return U.__set__(U,n,l),None;var P,de=U.__class__;if(void 0!==de&&void 0===(P=de.__set__))for(x=0,A=(ce=de.__mro__).length;x<A&&!(P=ce[x].__set__);x++);if(void 0!==P){var be=$B.$getattr(U,"__set__",null);if(be&&"function"==typeof be)return be.apply(U,[n,l]),None}else if(G&&void 0!==G.$descriptors&&void 0!==G[o]){var te=G[o].setter;if("function"==typeof te)return te(n,l),None;throw _b_.AttributeError.$factory("readonly attribute")}}var ce,fe=!1;if(void 0!==G&&void 0===(fe=G.__setattr__))for(x=0,A=(ce=G.__mro__).length-1;x<A&&!(fe=ce[x].__setattr__);x++);if(G&&G.__slots__&&-1==["__module__"].indexOf(o)&&!fe){let T=function(B){return B.__slots__?Array.isArray(B.__slots__)?B.__slots__.map(function(q){return q.startsWith("__")&&!q.endsWith("_")?"_"+B.$infos.__name__+q:q}):B.__slots__:[]};var _e=!1;if(T(G).indexOf(o)>-1)_e=!0;else for(x=0;x<G.__mro__.length;x++)if(T(G.__mro__[x]).indexOf(o)>-1){_e=!0;break}if(!_e)throw _b_.AttributeError.$factory("'"+G.$infos.__name__+"' object has no attribute '"+o+"'")}return fe?fe(n,o,l):void 0===n.__dict__?n[o]=l:_b_.dict.$setitem(n.__dict__,o,l),None};var staticmethod=$B.make_class("staticmethod",function(n){var o={$infos:n.$infos,__get__:function(){return n}};return o.__get__.__class__=$B.method_wrapper,o.__get__.$infos=n.$infos,o});function sum(n,o){var l=$B.args("sum",2,{iterable:null,start:null},["iterable","start"],arguments,{start:0},null,null);if(n=l.iterable,_b_.isinstance(o=l.start,[_b_.str,_b_.bytes]))throw _b_.TypeError.$factory("TypeError: sum() can't sum bytes [use b''.join(seq) instead]");var x=o;for(n=iter(n);;)try{var N=next(n);x=$B.$getattr(x,"__add__")(N)}catch(U){if(U.__class__===_b_.StopIteration)break;throw U}return x}$B.set_func_names(staticmethod,"builtins"),$B.missing_super2=function(n){return n.$missing=!0,n};var $$super=$B.make_class("super",function(n,o){if(void 0===n&&void 0===o){var l=$B.last($B.frames_stack),x=$B.imported._sys.Getframe();if(!x.f_code||!x.f_code.co_varnames||void 0===(n=l[1].__class__))throw _b_.RuntimeError.$factory("super(): no arguments");o=l[1][x.f_code.co_varnames[0]]}return Array.isArray(o)&&(o=o[0]),{__class__:$$super,__thisclass__:n,__self_class__:o}});function vars(){var n={},o=$B.args("vars",1,{obj:null},["obj"],arguments,{obj:n},null,null);if(o.obj===n)return _b_.locals();try{return $B.$getattr(o.obj,"__dict__")}catch(l){throw l.__class__===_b_.AttributeError?_b_.TypeError.$factory("vars() argument must have __dict__ attribute"):l}}$$super.__get__=function(n,o,l){return $$super.$factory(n.__thisclass__,o)},$$super.__getattribute__=function(n,o){var l=n.__thisclass__.__mro__,x=n.__self_class__;if(void 0!==x){x.$is_class||(x=x.__class__||$B.get_class(x));for(var N=[x].concat(x.__mro__),U=0;U<N.length;U++)if(N[U]===n.__thisclass__){l=N.slice(U+1);break}}U=0;for(var G,A,P=l.length;U<P;U++)if(void 0!==l[U][o]){G=l[U][o];break}if(void 0===G){if(void 0!==$$super[o])return A=n,function(){for(var ce=[A],fe=0,_e=arguments.length;fe<_e;fe++)ce.push(arguments[fe]);return $$super[o].apply(null,ce)};throw _b_.AttributeError.$factory(o)}if("staticmethod"==G.$type||"__new__"==o||"function"!=typeof G)return G;G.__class__===$B.method&&(G=G.$infos.__func__);var de,be=$B.$call(G),te=function(){return be(n.__self_class__,...arguments)};return te.__class__=$B.method,void 0!==G.$infos?de=G.$infos.__module__:G.__class__===property?de=G.fget.$infos.__module:G.$is_class&&(de=G.__module__),te.$infos={__self__:n.__self_class__,__func__:G,__name__:o,__module__:de,__qualname__:n.__thisclass__.$infos.__name__+"."+o},te},$$super.__repr__=$$super.__str__=function(n){var o="<super: <class '"+n.__thisclass__.$infos.__name__+"'>";return(o+=void 0!==n.__self_class__?", <"+n.__self_class__.__class__.$infos.__name__+" object>":", NULL")+">"},$B.set_func_names($$super,"builtins");var $Reader=$B.make_class("Reader");function make_content(n){n.$binary&&void 0===n.$bytes?n.$bytes=_b_.str.encode(n.$string,n.encoding):n.$binary||void 0!==n.$string||(n.$string=_b_.bytes.decode(n.$bytes,n.encoding))}function make_lines(n){if(void 0===n.$lines)if(make_content(n),n.$binary){console.log("make lines, binary");for(var o=[],l=n.$bytes.source;;){var x=l.indexOf(10);if(-1==x){o.push({__class__:_b_.bytes,source:l});break}o.push({__class__:_b_.bytes,source:l.slice(0,x+1)}),l=l.slice(x+1)}n.$lines=o}else n.$lines=n.$string.split("\n")}$Reader.__enter__=function(n){return n},$Reader.__exit__=function(n){return!1},$Reader.__iter__=function(n){return iter($Reader.readlines(n))},$Reader.__len__=function(n){return n.lines.length},$Reader.close=function(n){n.closed=!0},$Reader.flush=function(n){return None},$Reader.read=function(){var n=$B.args("read",2,{self:null,size:null},["self","size"],arguments,{size:-1},null,null),o=n.self,l=$B.$GetInt(n.size);if(!0===o.closed)throw _b_.ValueError.$factory("I/O operation on closed file");return make_content(o),l<0&&(l=(o.$binary?o.$bytes.source.length:o.$string.length)-o.$counter),res=o.$binary?_b_.bytes.$factory(o.$bytes.source.slice(o.$counter,o.$counter+l)):o.$string.substr(o.$counter,l),o.$counter+=l,res},$Reader.readable=function(n){return!0},$Reader.readline=function(n,o){var l=$B.args("readline",2,{self:null,size:null},["self","size"],arguments,{size:-1},null,null);if(n=l.self,o=$B.$GetInt(l.size),n.$lc=void 0===n.$lc?-1:n.$lc,!0===n.closed)throw _b_.ValueError.$factory("I/O operation on closed file");if(make_content(n),n.$binary){var x;if(-1==(x=n.$bytes.source.indexOf(10,n.$counter)))return _b_.bytes.$factory();var N={__class__:_b_.bytes,source:n.$bytes.source.slice(n.$counter,x+1)};return n.$counter=x+1,N}return-1==(x=n.$string.indexOf("\n",n.$counter))?"":(N=n.$string.substring(n.$counter,x+1),n.$counter=x+1,n.$lc+=1,N)},$Reader.readlines=function(){var n=$B.args("readlines",2,{self:null,hint:null},["self","hint"],arguments,{hint:-1},null,null),o=n.self,l=$B.$GetInt(n.hint);if(!0===o.closed)throw _b_.ValueError.$factory("I/O operation on closed file");if(o.$lc=void 0===o.$lc?-1:o.$lc,make_lines(o),l<0)var x=o.$lines.slice(o.$lc+1);else for(x=[];o.$lc<o.$lines.length&&0<l;)o.$lc++,x.push(o.$lines[o.$lc]);for(;""==x[x.length-1];)x.pop();return x},$Reader.seek=function(n,o,l){if(n.closed===True)throw _b_.ValueError.$factory("I/O operation on closed file");void 0===l&&(l=0),0===l?n.$counter=o:1===l?n.$counter+=o:2===l&&(n.$counter=n.$content.length+o)},$Reader.seekable=function(n){return!0},$Reader.tell=function(n){return n.$counter},$Reader.writable=function(n){return!1},$B.set_func_names($Reader,"builtins");var $BufferedReader=$B.make_class("_io.BufferedReader");$BufferedReader.__mro__=[$Reader,_b_.object];var $TextIOWrapper=$B.make_class("_io.TextIOWrapper",function(){var n=$B.args("TextIOWrapper",6,{buffer:null,encoding:null,errors:null,newline:null,line_buffering:null,write_through:null},["buffer","encoding","errors","newline","line_buffering","write_through"],arguments,{encoding:"utf-8",errors:_b_.None,newline:_b_.None,line_buffering:_b_.False,write_through:_b_.False},null,null);return{__class__:$TextIOWrapper,$bytes:n.buffer.$bytes,encoding:n.encoding,errors:n.errors,newline:n.newline}});function $url_open(){var $ns=$B.args("open",3,{file:null,mode:null,encoding:null},["file","mode","encoding"],arguments,{mode:"r",encoding:"utf-8"},"args","kw"),$bytes,$string,$res;for(var attr in $ns)eval("var "+attr+'=$ns["'+attr+'"]');if(args.length>0)var mode=args[0];if(args.length>1)var encoding=args[1];if(mode.search("w")>-1)throw _b_.IOError.$factory("Browsers cannot write on disk");if(-1==["r","rb"].indexOf(mode))throw _b_.ValueError.$factory("Invalid mode '"+mode+"'");if(isinstance(file,_b_.str)){var is_binary=mode.search("b")>-1;if($B.file_cache.hasOwnProperty($ns.file))$string=$B.file_cache[$ns.file];else if($B.files&&$B.files.hasOwnProperty($ns.file)){$res=atob($B.files[$ns.file].content);var source=[];for(const n of $res)source.push(n.charCodeAt(0));$bytes=_b_.bytes.$factory(),$bytes.source=source}else{if("file"==$B.protocol)throw _b_.FileNotFoundError.$factory("cannot use 'open()' with protocol 'file'");if(is_binary)throw _b_.IOError.$factory("open() in binary mode is not supported");var req=new XMLHttpRequest;req.onreadystatechange=function(){try{var n=this.status;$res=404==n?_b_.FileNotFoundError.$factory(file):200!=n?_b_.IOError.$factory("Could not open file "+file+" : status "+n):this.responseText}catch(o){$res=_b_.IOError.$factory("Could not open file "+file+" : error "+o)}};var fake_qs=$B.$options.cache?"":"?foo="+(new Date).getTime();if(req.open("GET",file+fake_qs,!1),req.overrideMimeType("text/plain; charset=utf-8"),req.send(),$res.constructor===Error)throw $res;$string=$res}if(void 0===$string&&void 0===$bytes)throw _b_.FileNotFoundError.$factory($ns.file);var res={$binary:is_binary,$string,$bytes,$counter:0,closed:False,encoding,mode,name:file};return res.__class__=is_binary?$BufferedReader:$TextIOWrapper,res}throw _b_.TypeError.$factory("invalid argument for open(): "+_b_.str.$factory(file))}$TextIOWrapper.__mro__=[$Reader,_b_.object],$B.set_func_names($TextIOWrapper,"builtins"),$B.Reader=$Reader,$B.TextIOWrapper=$TextIOWrapper,$B.BufferedReader=$BufferedReader;var zip=$B.make_class("zip",function(){var n={__class__:zip,items:[]};if(0==arguments.length)return n;for(var o=$B.args("zip",0,{},[],arguments,{},"args","kw").args,l=[],x=0;x<o.length;x++)l.push(iter(o[x]));for(var N=0,U=[];;){var G=[],A=!0;for(x=0;x<l.length;x++)try{G.push(next(l[x]))}catch(P){if(P.__class__==_b_.StopIteration){A=!1;break}throw P}if(!A)break;U[N++]=_b_.tuple.$factory(G)}return n.items=U,n}),zip_iterator=$B.make_iterator_class("zip_iterator");function no_set_attr(n,o){throw _b_.AttributeError.$factory(void 0!==n[o]?"'"+n.$infos.__name__+"' object attribute '"+o+"' is read-only":"'"+n.$infos.__name__+"' object has no attribute '"+o+"'")}zip.__iter__=function(n){return zip_iterator.$factory(n.items)},$B.set_func_names(zip,"builtins");var True=!0,False=!1,ellipsis=$B.make_class("ellipsis",function(){return Ellipsis}),Ellipsis={__class__:ellipsis,__bool__:function(){return True}};for(var $key in $B.$comps)switch($B.$comps[$key]){case"ge":case"gt":case"le":case"lt":ellipsis["__"+$B.$comps[$key]+"__"]=function(n){return function(o){throw _b_.TypeError.$factory("unorderable types: ellipsis() "+n+" "+$B.class_name(o))}}($key)}for(var $func in Ellipsis)"function"==typeof Ellipsis[$func]&&(Ellipsis[$func].__str__=function(o){return function(){return"<method-wrapper "+o+" of Ellipsis object>"}}($func));$B.set_func_names(ellipsis);var FunctionCode=$B.make_class("function code"),FunctionGlobals=$B.make_class("function globals");$B.Function={__class__:_b_.type,__code__:{__class__:FunctionCode,__name__:"function code"},__globals__:{__class__:FunctionGlobals,__name__:"function globals"},__mro__:[_b_.object],$infos:{__name__:"function",__module__:"builtins"},$is_class:!0},$B.Function.__delattr__=function(n,o){if("__dict__"==o)throw _b_.TypeError.$factory("can't deleted function __dict__")},$B.Function.__dir__=function(n){var l=n.$attrs||{};return Object.keys(n.$infos||{}).concat(Object.keys(l))},$B.Function.__eq__=function(n,o){return n===o},$B.Function.__get__=function(n,o){if(o===_b_.None)return n;var l=function(){return n(o,...arguments)};return l.__class__=$B.method,void 0===n.$infos&&(console.log("no $infos",n),console.log($B.last($B.frames_stack))),l.$infos={__name__:n.$infos.__name__,__qualname__:$B.class_name(o)+"."+n.$infos.__name__,__self__:o,__func__:n},l},$B.Function.__getattribute__=function(n,o){if(!n.$infos||void 0===n.$infos[o]){if(n.$infos&&n.$infos.__dict__&&void 0!==n.$infos.__dict__.$string_dict[o])return n.$infos.__dict__.$string_dict[o][0];if("__closure__"==o){var l=n.$infos.__code__.co_freevars;if(0==l.length)return None;for(var x=[],N=0;N<l.length;N++)try{x.push($B.cell.$factory($B.$check_def_free(l[N])))}catch{x.push($B.cell.$factory(None))}return _b_.tuple.$factory(x)}return"__globals__"==o?$B.obj_dict($B.imported[n.$infos.__module__]):n.$attrs&&void 0!==n.$attrs[o]?n.$attrs[o]:_b_.object.__getattribute__(n,o)}if("__code__"==o){var U={__class__:code};for(var o in n.$infos.__code__)U[o]=n.$infos.__code__[o];return U.name=n.$infos.__name__,U.filename=n.$infos.__code__.co_filename,U.co_code=n+"",U}return"__annotations__"==o?$B.obj_dict(n.$infos[o]):n.$infos.hasOwnProperty(o)?n.$infos[o]:void 0},$B.Function.__repr__=$B.Function.__str__=function(n){return void 0===n.$infos?"<function "+n.name+">":"<function "+n.$infos.__qualname__+">"},$B.Function.__mro__=[_b_.object],$B.Function.__setattr__=function(n,o,l){if("__closure__"==o)throw _b_.AttributeError.$factory("readonly attribute");if("__defaults__"==o){if(l===_b_.None)l=[];else if(!isinstance(l,_b_.tuple))throw _b_.TypeError.$factory("__defaults__ must be set to a tuple object");var x=n.$set_defaults;if(void 0===x||!n.$infos||!n.$infos.__code__)throw _b_.AttributeError.$factory("cannot set attribute "+o+" of "+_b_.str.$factory(n));for(var U=n.$infos.__code__.co_varnames.slice(0,n.$infos.__code__.co_argcount),G={},A=l.length-1;A>=0;A--){var P=U.length-l.length+A;if(P<0)break;G[U[P]]=l[A]}var de=n.$infos.$class,be=x(G);return be.$set_defaults=x,de?(de[n.$infos.__name__]=be,be.$infos.$class=de,be.$infos.__defaults__=l):(n.$infos.$defaults=l,n.$infos.__defaults__=l),_b_.None}void 0!==n.$infos[o]?n.$infos[o]=l:(n.$attrs=n.$attrs||{},n.$attrs[o]=l)},$B.Function.$factory=function(){},$B.set_func_names($B.Function,"builtins"),_b_.__BRYTHON__=__BRYTHON__,$B.builtin_funcs=["abs","all","any","ascii","bin","breakpoint","callable","chr","compile","delattr","dir","divmod","eval","exec","exit","format","getattr","globals","hasattr","hash","help","hex","id","input","isinstance","issubclass","iter","len","locals","max","min","next","oct","open","ord","pow","print","quit","repr","round","setattr","sorted","sum","vars"];var builtin_function=$B.builtin_function=$B.make_class("builtin_function_or_method");builtin_function.__getattribute__=$B.Function.__getattribute__,builtin_function.__reduce_ex__=builtin_function.__reduce__=function(n){return n.$infos.__name__},builtin_function.__repr__=builtin_function.__str__=function(n){return"<built-in function "+n.$infos.__name__+">"},$B.set_func_names(builtin_function,"builtins");var method_wrapper=$B.make_class("method_wrapper");method_wrapper.__repr__=method_wrapper.__str__=function(n){return"<method wrapper '"+n.$infos.__name__+"' of function object>"},$B.set_func_names(method_wrapper,"builtins");var wrapper_descriptor=$B.wrapper_descriptor=$B.make_class("wrapper_descriptor");wrapper_descriptor.__getattribute__=$B.Function.__getattribute__,wrapper_descriptor.__repr__=wrapper_descriptor.__str__=function(n){return"<slot wrapper '"+n.$infos.__name__+"' of '"+n.__objclass__.$infos.__name__+"' object>"},$B.set_func_names(wrapper_descriptor,"builtins"),$B.builtin_classes=["bool","bytearray","bytes","classmethod","complex","dict","enumerate","filter","float","frozenset","int","list","map","memoryview","object","property","range","reversed","set","slice","staticmethod","str","super","tuple","type","zip"];for(var other_builtins=["Ellipsis","False","None","True","__debug__","__import__","copyright","credits","license","NotImplemented"],builtin_names=$B.builtin_funcs.concat($B.builtin_classes).concat(other_builtins),i=0;i<builtin_names.length;i++){var name=builtin_names[i],orig_name=name,name1=name;"open"==name&&(name1="$url_open"),"super"==name&&(name=name1="$$super"),"eval"==name&&(name=name1="$$eval"),"print"==name&&(name1="$print");try{_b_[name]=eval(name1),$B.builtin_funcs.indexOf(orig_name)>-1&&(_b_[name].__class__=builtin_function,_b_[name].$infos={__module__:"builtins",__name__:orig_name,__qualname__:orig_name})}catch(n){}}_b_.open=$url_open,_b_.print=$print,_b_.$$super=$$super,_b_.object.__init__.__class__=wrapper_descriptor,_b_.object.__new__.__class__=builtin_function}(__BRYTHON__),function($B){var bltns=$B.InjectBuiltins();eval(bltns),$B.del_exc=function(){$B.last($B.frames_stack)[1].$current_exception=void 0},$B.set_exc=function(n){var o=$B.last($B.frames_stack);void 0===o&&console.log("no frame",n),o[1].$current_exception=$B.exception(n)},$B.get_exc=function(){return $B.last($B.frames_stack)[1].$current_exception},$B.$raise=function(n){if(void 0===n){var o=$B.get_exc();throw void 0!==o?o:_b_.RuntimeError.$factory("No active exception to reraise")}throw isinstance(n,BaseException)?(n.__class__===_b_.StopIteration&&$B.last($B.frames_stack)[1].$is_generator&&(n=_b_.RuntimeError.$factory("generator raised StopIteration")),n):n.$is_class&&issubclass(n,BaseException)?n===_b_.StopIteration&&$B.last($B.frames_stack)[1].$is_generator?_b_.RuntimeError.$factory("generator raised StopIteration"):$B.$call(n)():_b_.TypeError.$factory("exceptions must derive from BaseException")},$B.$syntax_err_line=function(n,o,l,x,N){var U={},G=1;if(o="$"==o.charAt(0)?"<string>":o,void 0===l)n.$line_info=N+","+o,n.args=_b_.tuple.$factory([$B.$getitem(n.args,0),o,N,0,0]);else{for(var A={1:0},P=0,de=l.length;P<de;P++)U[P]=G,"\n"==l.charAt(P)&&(A[++G]=P);for(;void 0===N;)N=U[x],x--;n.$line_info=N+","+o;var be=l.split("\n")[N-1],te=x-A[N];for(de=be.length,n.text=be,(te-=de-be.length)<0&&(te=0);" "==be.charAt(0);)be=be.substr(1),te>0&&te--;n.offset=te,n.args=_b_.tuple.$factory([$B.$getitem(n.args,0),o,N,te,be])}n.lineno=N,n.msg=n.args[0],n.filename=o},$B.$SyntaxError=function(n,o,l,x,N,U){void 0!==U&&void 0!==U.line_info&&(N=U.line_info);var G=_b_.SyntaxError.$factory(o);throw $B.$syntax_err_line(G,n,l,x,N),G},$B.$IndentationError=function(n,o,l,x,N,U){$B.frames_stack.push([n,{$line_info:N+","+n},n,{$src:l}]),void 0!==U&&void 0!==U.line_info&&(N=U.line_info);var G=_b_.IndentationError.$factory(o);throw $B.$syntax_err_line(G,n,l,x,N),G},$B.print_stack=function(n){var o=[];return(n=n||$B.frames_stack).forEach(function(l){var x=l[1].$line_info;if(void 0!==x){var N=x.split(",");N[1].startsWith("$exec")&&(N[1]="<module>"),o.push(N[1]+" line "+N[0]);var U=$B.file_cache[l[3].__file__];if(U){var G=U.split("\n")[parseInt(N[0])-1];o.push("  "+G.trim())}}}),console.log("print stack ok",o),o.join("\n")};var traceback=$B.traceback=$B.make_class("traceback",function(n,o){return $B.last($B.frames_stack),void 0===o&&(o=n.$stack),{__class__:traceback,$stack:o,exc:n}});traceback.__getattribute__=function(n,o){var l;if("tb_frame"===o||"tb_lineno"===o||"tb_lasti"===o||"tb_next"===o){0==n.$stack.length&&console.log("no stack",o);var x=n.$stack[0];l=n.exc.$line_infos[n.exc.$line_infos.length-n.$stack.length]}switch(o){case"tb_frame":return frame.$factory(n.$stack);case"tb_lineno":return void 0===l||x[0].startsWith($B.lambda_magic)?x[4]&&x[4].$infos&&x[4].$infos.__code__?x[4].$infos.__code__.co_firstlineno:-1:parseInt(l.split(",")[0]);case"tb_lasti":if(void 0===l)return console.log("no line info",n.$stack),"";for(var N,U,G=l.split(","),A=n.$stack.length-1;A>=0;A--){var P=n.$stack[A];if(P[2]==G[1].replace(/\./g,"_")){U=P[3].__file__;break}}if(void 0===N&&($B.file_cache.hasOwnProperty(U)?N=$B.file_cache[U]:$B.imported[G[1]]&&$B.imported[G[1]].__file__&&(N=$B.file_cache[$B.imported[G[1]].__file__],console.log("from filecache",l,$B.imported[G[1]].__file__))),void 0===N)return console.log(U),console.log("no src for",G),"";try{return N.split("\n")[parseInt(G[0]-1)].trim()}catch(de){throw console.log("error in attr tb_lasti of",n),console.log(N,G),de}case"tb_next":return n.$stack.length<=1?None:traceback.$factory(n.exc,n.$stack.slice(1));default:return _b_.object.__getattribute__(n,o)}},$B.set_func_names(traceback,"builtins");var frame=$B.make_class("frame",function(n,o){var l=n,x={__class__:frame,f_builtins:{},$stack:n.slice()};if(void 0===o&&(o=0),x.$pos=o,l.length){var N,U=l[o],G=U[0];try{x.f_locals=$B.obj_dict(U[1])}catch(be){throw console.log("err "+be),be}if(x.f_globals=$B.obj_dict(U[3]),void 0!==U[3].__file__&&(N=U[3].__file__),G.startsWith("$exec")&&(N="<string>"),void 0===U[1].$line_info)x.f_lineno=-1;else{var A=U[1].$line_info.split(",");x.f_lineno=parseInt(A[0]);var P=A[1];$B.imported.hasOwnProperty(P)&&(N=$B.imported[P].__file__),x.f_lineno=parseInt(U[1].$line_info.split(",")[0])}var de=G.startsWith("$exec")?"<module>":G;G==U[2]?de="<module>":G.startsWith("lc"+$B.lambda_magic)?de="<listcomp>":U[1].$name?de=U[1].$name:U[1].$dict_comp?de="<dictcomp>":U[1].$list_comp?de="<listcomp>":U.length>4&&(de=U[4].$infos?U[4].$infos.__name__:U[4].name,void 0===U[4].$infos?U[4].name.startsWith("__ge")?de="<genexpr>":U[4].name.startsWith("set_comp"+$B.lambda_magic)?de="<setcomp>":U[4].name.startsWith("lambda"+$B.lambda_magic)&&(de="<lambda>"):void 0===N&&U[4].$infos.__code__&&(void 0===(N=U[4].$infos.__code__.co_filename)&&(N=U[4].$infos.__module__),x.f_lineno=U[4].$infos.__code__.co_firstlineno)),x.f_code=U.length>4&&void 0!==U[4].$infos?U[4].$infos.__code__:{co_name:de,co_filename:N},x.f_code.__class__=$B.code,x.f_code.co_code=_b_.None,void 0===N&&(x.f_code.co_filename="<string>")}return x});frame.__delattr__=function(n,o){"f_trace"==o&&($B.last(n.$stack)[1].$f_trace=_b_.None)},frame.__getattr__=function(n,o){if("f_back"==o)return n.$pos>0?frame.$factory(n.$stack.slice(0,n.$stack.length-1),n.$pos-1):_b_.None;if("clear"==o)return function(){};if("f_trace"==o){var l=$B.last(n.$stack)[1];return void 0===l.$f_trace?_b_.None:l.$f_trace}},frame.__setattr__=function(n,o,l){"f_trace"==o&&($B.last(n.$stack)[1].$f_trace=l)},frame.__str__=frame.__repr__=function(n){return"<frame object, file "+n.f_code.co_filename+", line "+n.f_lineno+", code "+n.f_code.co_name+">"},$B.set_func_names(frame,"builtins"),$B._frame=frame;var BaseException=_b_.BaseException={__class__:_b_.type,__bases__:[_b_.object],__mro__:[_b_.object],args:[],$infos:{__name__:"BaseException",__module__:"builtins"},$is_class:!0};BaseException.__init__=function(n){n.args=_b_.tuple.$factory(void 0===arguments[1]?[]:[arguments[1]])},BaseException.__repr__=function(n){var o=n.__class__.$infos.__name__;return n.args[0]&&(o+="("+repr(n.args[0])),n.args.length>1&&(o+=", "+repr($B.fast_tuple(n.args.slice(1)))),o+")"},BaseException.__str__=function(n){return n.args.length>0?_b_.str.$factory(n.args[0]):n.__class__.$infos.__name__},BaseException.__new__=function(n){var o=_b_.BaseException.$factory();return o.__class__=n,o.__dict__=$B.empty_dict(),o};var getExceptionTrace=function(n,o){if(void 0===n.__class__)return $B.debug>1&&console.log("no class",n),n+"";var l="";void 0!==n.$js_exc&&o&&(l+="\nJS stack:\n"+n.$js_exc.stack+"\n"),l+="Traceback (most recent call last):";for(var x=n.$line_info,N=0;N<n.$stack.length;N++){var U=n.$stack[N];if(U[1]&&U[1].$line_info){var G;if(x=U[1].$line_info.split(","),n.module==x[1]&&(G=n.src),!o&&void 0===(G=U[3].$src))if($B.VFS&&$B.VFS.hasOwnProperty(U[2]))G=$B.VFS[U[2]][1];else if(!(G=$B.file_cache[U[3].__file__]))continue;var A=U[3].__file__||"<string>",P=x[1],de="$"==P.charAt(0);if(de&&(P="<module>"),l+="\n  File "+A+" line "+x[0],U.length>4)if(U[4].$infos){var be=U[4].$infos.__name__;be.startsWith("lc"+$B.lambda_magic)?l+=",in <listcomp>":l+=", in "+be}else U[4].name.startsWith("__ge")?l+=", in <genexpr>":U[4].name.startsWith("set_comp"+$B.lambda_magic)?l+=", in <setcomp>":U[4].name.startsWith("lc"+$B.lambda_magic)?l+=", in <listcomp>":console.log("frame[4]",U[4]);else l+=U[1].$list_comp?", in <listcomp>":U[1].$dict_comp?", in <dictcomp>":", in <module>";if(void 0!==G&&!de){var te=G.split("\n")[parseInt(x[0])-1];te&&(te=te.replace(/^[ ]+/g,"")),l+="\n    "+te}}}return n.__class__===_b_.SyntaxError&&(l+="\n  File "+n.args[1]+", line "+n.args[2]+"\n    "+n.args[4]),l};BaseException.__getattr__=function(n,o){if("info"==o)return getExceptionTrace(n,!1);if("infoWithInternal"==o)return getExceptionTrace(n,!0);if("__traceback__"==o)return void 0!==n.$traceback?n.$traceback:traceback.$factory(n);throw _b_.AttributeError.$factory(n.__class__.$infos.__name__+" has no attribute '"+o+"'")},BaseException.with_traceback=function(n,o){return n.$traceback=o,n},$B.deep_copy=function(n){var o=[];for(const N of n){var l=[N[0],{},N[2],{}];void 0!==N[4]&&l.push(N[4]);for(const U of[1,3])for(var x in N[U])l[U][x]=N[U][x];o.push(l)}return o},$B.save_stack=function(){return $B.deep_copy($B.frames_stack)},$B.restore_stack=function(n,o){$B.frames_stack=n,$B.frames_stack[$B.frames_stack.length-1][1]=o},$B.freeze=function(n){if(void 0===n.$stack){n.$line_infos=[];for(var o=0,l=$B.frames_stack.length;o<l;o++)n.$line_infos.push($B.frames_stack[o][1].$line_info);n.$stack=$B.frames_stack.slice(),$B.frames_stack.length&&(n.$line_info=$B.last($B.frames_stack)[1].$line_info)}};var show_stack=$B.show_stack=function(n){n=n||$B.frames_stack;for(const o of n)console.log(o[0],o[1].$line_info)};function $make_exc(names,parent){for(var _str=[],pos=0,i=0;i<names.length;i++){var name=names[i],code="";if(Array.isArray(name))var code=name[1],name=name[0];$B.builtins_scope[name]=!0;var $exc=(BaseException.$factory+"").replace(/BaseException/g,name);$exc=$exc.replace("//placeholder//",code),_str[pos++]="_b_."+name+" = {__class__:_b_.type, __mro__: [_b_."+parent.$infos.__name__+"].concat(parent.__mro__), $is_class: true,$infos: {__name__:'"+name+"'}}",_str[pos++]="_b_."+name+".$factory = "+$exc,_str[pos++]="_b_."+name+'.$factory.$infos = {__name__: "'+name+'", __qualname__: "'+name+'"}',_str[pos++]="$B.set_func_names(_b_."+name+", 'builtins')"}try{eval(_str.join(";"))}catch(n){throw console.log("--err"+n),n}}BaseException.$factory=function(){var err=Error();return err.args=$B.fast_tuple(Array.prototype.slice.call(arguments)),err.__class__=_b_.BaseException,err.$py_error=!0,$B.freeze(err),eval("//placeholder//"),err.__cause__=_b_.None,err.__context__=_b_.None,err.__suppress_context__=!1,err},BaseException.$factory.$infos={__name__:"BaseException",__qualname__:"BaseException"},$B.set_func_names(BaseException),_b_.BaseException=BaseException,$B.exception=function(n,o){if(n.__class__){if($B.freeze(U=n),o)for(var l=$B.last($B.frames_stack)[0],x=0,N=U.$stack.length;x<N;x++)if(U.$stack[x][0]==l){U.$stack=U.$stack.slice(x),U.$traceback=traceback.$factory(U);break}}else{var U;if(console.log("Javascript exception:",n),console.log($B.last($B.frames_stack)),console.log("recursion error ?",$B.is_recursion_error(n)),(U=Error()).__name__="Internal Javascript error: "+(n.__name__||n.name),U.__class__=_b_.Exception,U.$js_exc=n,$B.is_recursion_error(n))return _b_.RecursionError.$factory("too much recursion");"ReferenceError"==n.name?(U.__name__="NameError",U.__class__=_b_.NameError,n.message=n.message.replace("$$","")):"InternalError"==n.name&&(U.__name__="RuntimeError",U.__class__=_b_.RuntimeError),U.__cause__=_b_.None,U.__context__=_b_.None,U.__suppress_context__=!1,U.args=_b_.tuple.$factory(["<Javascript "+n.name+">: "+(n.message||"<"+n+">")]),U.$py_error=!0,$B.freeze(U)}return U},$B.is_exc=function(n,o){void 0===n.__class__&&(n=$B.exception(n));for(var l=n.$is_class?n:n.__class__,x=0;x<o.length;x++){var N=o[x];if(void 0===l&&console.log("exc class undefined",n),issubclass(l,N))return!0}return!1},$B.is_recursion_error=function(n){console.log("test is js exc is recursion error",n,n+"");var o=(n+"").split(":"),l=o[0].trim(),x=o[1].trim();return"InternalError"==l&&"too much recursion"==x||"Error"==l&&"Out of stack space"==x||"RangeError"==l&&"Maximum call stack size exceeded"==x},$make_exc(["SystemExit","KeyboardInterrupt","GeneratorExit","Exception"],BaseException),$make_exc([["StopIteration","err.value = arguments[0]"],["StopAsyncIteration","err.value = arguments[0]"],"ArithmeticError","AssertionError","AttributeError","BufferError","EOFError",["ImportError","err.name = arguments[0]"],"LookupError","MemoryError","NameError","OSError","ReferenceError","RuntimeError",["SyntaxError","err.msg = arguments[0]"],"SystemError","TypeError","ValueError","Warning"],_b_.Exception),$make_exc(["FloatingPointError","OverflowError","ZeroDivisionError"],_b_.ArithmeticError),$make_exc([["ModuleNotFoundError","err.name = arguments[0]"]],_b_.ImportError),$make_exc(["IndexError","KeyError"],_b_.LookupError),$make_exc(["UnboundLocalError"],_b_.NameError),$make_exc(["BlockingIOError","ChildProcessError","ConnectionError","FileExistsError","FileNotFoundError","InterruptedError","IsADirectoryError","NotADirectoryError","PermissionError","ProcessLookupError","TimeoutError"],_b_.OSError),$make_exc(["BrokenPipeError","ConnectionAbortedError","ConnectionRefusedError","ConnectionResetError"],_b_.ConnectionError),$make_exc(["NotImplementedError","RecursionError"],_b_.RuntimeError),$make_exc(["IndentationError"],_b_.SyntaxError),$make_exc(["TabError"],_b_.IndentationError),$make_exc(["UnicodeError"],_b_.ValueError),$make_exc(["UnicodeDecodeError","UnicodeEncodeError","UnicodeTranslateError"],_b_.UnicodeError),$make_exc(["DeprecationWarning","PendingDeprecationWarning","RuntimeWarning","SyntaxWarning","UserWarning","FutureWarning","ImportWarning","UnicodeWarning","BytesWarning","ResourceWarning"],_b_.Warning),$make_exc(["EnvironmentError","IOError","VMSError","WindowsError"],_b_.OSError),$B.$TypeError=function(n){throw _b_.TypeError.$factory(n)};var se=_b_.SyntaxError.$factory;_b_.SyntaxError.$factory=function(){var n=arguments[0];if(n.__class__===_b_.SyntaxError)return n;var o=se.apply(null,arguments),l=$B.last($B.frames_stack);if(l){line_info=l[1].$line_info,o.filename=l[3].__file__,o.lineno=parseInt(line_info.split(",")[0]);var x=$B.file_cache[l[3].__file__];x&&(lines=x.split("\n"),o.text=lines[o.lineno-1]),o.offset=n.offset}return o},_b_}(__BRYTHON__),function(n){var o=n.builtins,l=o.None,x={__class__:o.type,__mro__:[o.object],$infos:{__module__:"builtins",__name__:"range"},$is_class:!0,$native:!0,$descriptors:{start:!0,step:!0,stop:!0}};function N(P,de){var be=x.__len__(P);return 0==be?P.start:de>be?P.stop:n.add(P.start,n.mul(P.step,de))}x.__contains__=function(P,de){if(0==x.__len__(P))return!1;try{de=n.int_or_bool(de)}catch{try{return x.index(P,de),!0}catch{return!1}}var be=n.sub(de,P.start),te=n.floordiv(be,P.step),ce=n.mul(P.step,te);return!!n.eq(ce,be)&&(n.gt(P.stop,P.start)?n.ge(de,P.start)&&n.gt(P.stop,de):n.ge(P.start,de)&&n.gt(de,P.stop))},x.__delattr__=function(P,de,be){throw o.AttributeError.$factory("readonly attribute")},x.__eq__=function(P,de){if(o.isinstance(de,x)){var be=x.__len__(P);return!!n.eq(be,x.__len__(de))&&(0==be||!!n.eq(P.start,de.start)&&(1==be||n.eq(P.step,de.step)))}return!1},x.__getitem__=function(P,de){if(o.isinstance(de,o.slice)){var be=o.slice.$conv_for_seq(de,x.__len__(P)),te=n.mul(P.step,be.step),ce=N(P,be.start),fe=N(P,be.stop);return x.$factory(ce,fe,te)}"number"!=typeof de&&(de=n.$GetInt(de)),n.gt(0,de)&&(de=n.add(de,x.__len__(P)));var _e=n.add(P.start,n.mul(de,P.step));if(n.gt(P.step,0)&&(n.ge(_e,P.stop)||n.gt(P.start,_e))||n.gt(0,P.step)&&(n.ge(P.stop,_e)||n.gt(_e,P.start)))throw o.IndexError.$factory("range object index out of range");return _e},x.__hash__=function(P){var de=x.__len__(P);return o.hash(o.tuple.$factory(0==de?[0,l,l]:1==de?[1,P.start,l]:[de,P.start,P.step]))};var U={__class__:o.type,__mro__:[o.object],__iter__:function(P){return P},__next__:function(P){return o.next(P.obj)},$infos:{__name__:"range_iterator",__module__:"builtins"},$is_class:!0,$factory:function(P){return{__class__:U,obj:P}}};n.set_func_names(U,"builtins"),x.__iter__=function(P){var de={__class__:x,start:P.start,stop:P.stop,step:P.step};return de.$counter=P.$safe?P.start-P.step:n.sub(P.start,P.step),U.$factory(de)},x.__len__=function(P){var de;if(n.gt(P.step,0)){if(n.ge(P.start,P.stop))return 0;var be=n.sub(P.stop,n.add(1,P.start)),te=n.floordiv(be,P.step);de=n.add(1,te)}else{if(n.ge(P.stop,P.start))return 0;be=n.sub(P.start,n.add(1,P.stop)),te=n.floordiv(be,n.mul(-1,P.step)),de=n.add(1,te)}return void 0===n.maxsize&&(n.maxsize=n.long_int.__pow__(n.long_int.$factory(2),63),n.maxsize=n.long_int.__sub__(n.maxsize,1)),de},x.__next__=function(P){if(P.$safe){if(P.$counter+=P.step,P.step>0&&P.$counter>=P.stop||P.step<0&&P.$counter<=P.stop)throw o.StopIteration.$factory("")}else if(P.$counter=n.add(P.$counter,P.step),n.gt(P.step,0)&&n.ge(P.$counter,P.stop)||n.gt(0,P.step)&&n.ge(P.stop,P.$counter))throw o.StopIteration.$factory("");return P.$counter},x.__reversed__=function(P){var de=n.sub(x.__len__(P),1);return x.$factory(n.add(P.start,n.mul(de,P.step)),n.sub(P.start,P.step),n.mul(-1,P.step))},x.__repr__=x.__str__=function(P){var de="range("+o.str.$factory(P.start)+", "+o.str.$factory(P.stop);return 1!=P.step&&(de+=", "+o.str.$factory(P.step)),de+")"},x.__setattr__=function(P,de,be){throw o.AttributeError.$factory("readonly attribute")},x.start=function(P){return P.start},x.step=function(P){return P.step},x.stop=function(P){return P.stop},x.count=function(P,de){if(o.isinstance(de,[o.int,o.float,o.bool]))return o.int.$factory(x.__contains__(P,de));for(var te=x.__iter__(P),ce=U.__next__,fe=0;;)try{_e=ce(te),n.rich_comp("__eq__",de,_e)&&fe++}catch(_e){if(o.isinstance(_e,o.StopIteration))return fe;throw _e}var _e},x.index=function(P,de){var q,be=n.args("index",2,{self:null,other:null},["self","other"],arguments,{},null,null);P=be.self,de=be.other;try{de=n.int_or_bool(de)}catch{for(var ce=x.__iter__(P),fe=U.__next__,_e=0;;)try{if(q=fe(ce),n.rich_comp("__eq__",de,q))return _e;_e++}catch(q){throw o.isinstance(q,o.StopIteration)?o.ValueError.$factory(o.str.$factory(de)+" not in range"):q}}var le=n.sub(de,P.start),pe=n.floordiv(le,P.step),T=n.mul(P.step,pe);if(n.eq(T,le)){if(n.gt(P.stop,P.start)&&n.ge(de,P.start)&&n.gt(P.stop,de)||n.ge(P.start,P.stop)&&n.ge(P.start,de)&&n.gt(de,P.stop))return pe;throw o.ValueError.$factory(o.str.$factory(de)+" not in range")}throw o.ValueError.$factory(o.str.$factory(de)+" not in range")},x.$factory=function(){var P=n.args("range",3,{start:null,stop:null,step:null},["start","stop","step"],arguments,{start:null,stop:null,step:null},null,null),de=P.start,be=P.stop,te=P.step;if(null===be&&null===te){if(null==de)throw o.TypeError.$factory("range expected 1 arguments, got 0");return be=n.PyNumber_Index(de),{__class__:x,start:0,stop:be,step:1,$is_range:!0,$safe:"number"==typeof be}}if(null===te&&(te=1),de=n.PyNumber_Index(de),be=n.PyNumber_Index(be),0==(te=n.PyNumber_Index(te)))throw o.ValueError.$factory("range arg 3 must not be zero");return{__class__:x,start:de,stop:be,step:te,$is_range:!0,$safe:"number"==typeof de&&"number"==typeof be&&"number"==typeof te}},n.set_func_names(x,"builtins");var G={__class__:o.type,__mro__:[o.object],$infos:{__module__:"builtins",__name__:"slice"},$is_class:!0,$native:!0,$descriptors:{start:!0,step:!0,stop:!0}};function A(P){for(var de=["start","stop","step"],be=[],te=0;te<de.length;te++){var ce=P[de[te]];if(ce===o.None)be.push(ce);else try{be.push(n.PyNumber_Index(ce))}catch{throw o.TypeError.$factory("slice indices must be integers or None or have an __index__ method")}}return be}G.__eq__=function(P,de){var be=A(P),te=A(de);return be[0]==te[0]&&be[1]==te[1]&&be[2]==te[2]},G.__repr__=G.__str__=function(P){return"slice("+o.str.$factory(P.start)+", "+o.str.$factory(P.stop)+", "+o.str.$factory(P.step)+")"},G.__setattr__=function(P,de,be){throw o.AttributeError.$factory("readonly attribute")},G.$conv_for_seq=function(P,de){var be,te=P.step===l?1:n.PyNumber_Index(P.step),ce=n.gt(0,te),fe=n.sub(de,1);if(0==te)throw o.ValueError.$factory("slice step cannot be zero");return P.start===l?be=ce?fe:0:(be=n.PyNumber_Index(P.start),n.gt(0,be)&&(be=n.add(be,de),n.gt(0,be)&&(be=0)),n.ge(be,de)&&(be=te<0?fe:de)),P.stop===l?stop=ce?-1:de:(stop=n.PyNumber_Index(P.stop),n.gt(0,stop)&&(stop=n.add(stop,de)),n.ge(stop,de)&&(stop=ce?fe:de)),{start:be,stop,step:te}},G.start=function(P){return P.start},G.step=function(P){return P.step},G.stop=function(P){return P.stop},G.indices=function(P,de){var be=n.args("indices",2,{self:null,length:null},["self","length"],arguments,{},null,null),te=n.$GetInt(be.length);te<0&&o.ValueError.$factory("length should not be negative");var ce=P.step==o.None?1:P.step;if(ce<0){var fe=P.start,_e=P.stop;fe=fe==o.None?te-1:fe<0?o.max(-1,fe+te):o.min(te-1,P.start),_e=P.stop==o.None?-1:_e<0?o.max(-1,_e+te):o.min(te-1,P.stop)}else fe=P.start==o.None?0:o.min(te,P.start),_e=P.stop==o.None?te:o.min(te,P.stop),fe<0&&(fe=o.max(0,fe+te)),_e<0&&(_e=o.max(0,_e+te));return o.tuple.$factory([fe,_e,ce])},G.$factory=function(){var P,de,be,te=n.args("slice",3,{start:null,stop:null,step:null},["start","stop","step"],arguments,{stop:null,step:null},null,null);null===te.stop&&null===te.step?(P=o.None,de=te.start,be=o.None):(P=te.start,de=te.stop,be=null===te.step?o.None:te.step);var ce={__class__:G,start:P,stop:de,step:be};return A(ce),ce},n.set_func_names(G,"builtins"),o.range=x,o.slice=G}(__BRYTHON__),function(n){var o=n.builtins,l={},x={};function N(T,B,q){if(void 0===B){B=[];for(var ee=0,F=4;ee<F;ee++)B.push("\r\n \t".charCodeAt(ee))}else{if(!o.isinstance(B,P))throw o.TypeError.$factory("Type str doesn't support the buffer API");B=B.source}if("l"==q){for(ee=0,F=T.source.length;ee<F&&-1!=B.indexOf(T.source[ee]);ee++);return P.$factory(T.source.slice(ee))}for(ee=T.source.length-1;ee>=0&&-1!=B.indexOf(T.source[ee]);ee--);return P.$factory(T.source.slice(0,ee+1))}function U(T){return!o.isinstance(T,[P,G])}n.to_bytes=function(T){var B;if(o.isinstance(T,[P,G]))B=T.source;else{var q=n.$getattr(T,"tobytes",null);if(null===q)throw o.TypeError.$factory("object doesn't support the buffer protocol");B=n.$call(q)().source}return B};var G={__class__:o.type,__mro__:[o.object],$buffer_protocol:!0,$infos:{__module__:"builtins",__name__:"bytearray"},$is_class:!0};["__delitem__","clear","copy","count","index","pop","remove","reverse","sort"].forEach(function(T){var B;G[T]=(B=T,function(q){for(var ee=[q.source],F=1,Be=1,K=arguments.length;Be<K;Be++)ee[F++]=arguments[Be];return o.list[B].apply(null,ee)})});var A=n.make_iterator_class("bytearray_iterator");G.__iter__=function(T){return A.$factory(T.source)},G.__mro__=[o.object],G.__repr__=G.__str__=function(T){return"bytearray("+P.__repr__(T)+")"},G.__setitem__=function(T,B,q){if(o.isinstance(B,o.int)){if(!o.isinstance(q,o.int))throw o.TypeError.$factory("an integer is required");if(q>255)throw o.ValueError.$factory("byte must be in range(0, 256)");var ee=B;if(B<0&&(ee=T.source.length+ee),!(ee>=0&&ee<T.source.length))throw o.IndexError.$factory("list index out of range");T.source[ee]=q}else{if(!o.isinstance(B,o.slice))throw o.TypeError.$factory("list indices must be integer, not "+n.class_name(B));var F=B.start===o.None?0:B.start,Be=B.stop===o.None?T.source.length:B.stop;F<0&&(F=T.source.length+F),Be<0&&(Be=T.source.length+Be),T.source.splice(F,Be-F);try{for(var K=o.list.$factory(q),ve=K.length-1;ve>=0;ve--){if(!o.isinstance(K[ve],o.int))throw o.TypeError.$factory("an integer is required");if(K[ve]>255)throw ValueError.$factory("byte must be in range(0, 256)");T.source.splice(F,0,K[ve])}}catch{throw o.TypeError.$factory("can only assign an iterable")}}},G.append=function(T,B){if(2!=arguments.length)throw o.TypeError.$factory("append takes exactly one argument ("+(arguments.length-1)+" given)");if(!o.isinstance(B,o.int))throw o.TypeError.$factory("an integer is required");if(B>255)throw ValueError.$factory("byte must be in range(0, 256)");T.source[T.source.length]=B},G.extend=function(T,B){if(B.__class__===G||B.__class__===P)return B.source.forEach(function(ee){T.source.push(ee)}),o.None;for(var q=o.iter(B);;)try{G.__add__(T,o.next(q))}catch(ee){if(ee===o.StopIteration)break;throw ee}return o.None},G.insert=function(T,B,q){if(3!=arguments.length)throw o.TypeError.$factory("insert takes exactly 2 arguments ("+(arguments.length-1)+" given)");if(!o.isinstance(q,o.int))throw o.TypeError.$factory("an integer is required");if(q>255)throw ValueError.$factory("byte must be in range(0, 256)");o.list.insert(T.source,B,q)},G.$factory=function(){for(var T=[G],B=0,q=arguments.length;B<q;B++)T.push(arguments[B]);return G.__new__.apply(null,T)};var P={__class__:o.type,__mro__:[o.object],$buffer_protocol:!0,$infos:{__module__:"builtins",__name__:"bytes"},$is_class:!0,__add__:function(T,B){if(o.isinstance(B,P))return T.__class__.$factory(T.source.concat(B.source));if(o.isinstance(B,G))return T.__class__.$factory(P.__add__(T,P.$factory(B)));if(o.isinstance(B,o.memoryview))return T.__class__.$factory(P.__add__(T,o.memoryview.tobytes(B)));throw o.TypeError.$factory("can't concat bytes to "+o.str.$factory(B))},__contains__:function(T,B){if("number"==typeof B)return T.source.indexOf(B)>-1;if(T.source.length<B.source.length)return!1;for(var q=B.source.length,ee=0;ee<T.source.length-B.source.length+1;ee++){for(var F=!0,Be=0;Be<q;Be++)if(B.source[ee+Be]!=T.source[Be]){F=!1;break}if(F)return!0}return!1}},de=n.make_iterator_class("bytes_iterator");P.__iter__=function(T){return de.$factory(T.source)},P.__eq__=function(T,B){return!U(B)&&n.$getattr(T.source,"__eq__")(B.source)},P.__ge__=function(T,B){return U(B)?o.NotImplemented:o.list.__ge__(T.source,B.source)},P.__getitem__=function(T,B){if(o.isinstance(B,o.int)){var q=B;if(B<0&&(q=T.source.length+q),q>=0&&q<T.source.length)return T.source[q];throw o.IndexError.$factory("index out of range")}if(o.isinstance(B,o.slice)){var ee=o.slice.$conv_for_seq(B,T.source.length),F=ee.start,Be=ee.stop,K=ee.step,ve=[],Ae=null;if(q=0,K>0){if((Be=Math.min(Be,T.source.length))<=F)return P.$factory([]);for(Ae=F;Ae<Be;Ae+=K)ve[q++]=T.source[Ae]}else{if(Be>=F)return P.$factory([]);for(Be=Math.max(0,Be),Ae=F;Ae>=Be;Ae+=K)ve[q++]=T.source[Ae]}return P.$factory(ve)}if(o.isinstance(B,o.bool))return T.source.__getitem__(o.int.$factory(B))},P.__gt__=function(T,B){return U(B)?o.NotImplemented:o.list.__gt__(T.source,B.source)},P.__hash__=function(T){if(void 0===T)return P.__hashvalue__||n.$py_next_hash--;for(var B=1,q=0,ee=T.source.length;q<ee;q++)B=101*B+T.source[q]&4294967295;return B},P.__init__=function(){return o.None},P.__le__=function(T,B){return U(B)?o.NotImplemented:o.list.__le__(T.source,B.source)},P.__len__=function(T){return T.source.length},P.__lt__=function(T,B){return U(B)?o.NotImplemented:o.list.__lt__(T.source,B.source)},P.__mod__=function(T,B){var q=_e(T,"ascii","strict"),ee=o.str.__mod__(q,B);return o.str.encode(ee,"ascii")},P.__mul__=function(){for(var T=n.args("__mul__",2,{self:null,other:null},["self","other"],arguments,{},null,null),B=n.PyNumber_Index(T.other),q=[],ee=T.self.source,F=ee.length,Be=0;Be<B;Be++)for(var K=0;K<F;K++)q.push(ee[K]);var ve=P.$factory();return ve.source=q,ve},P.__ne__=function(T,B){return!P.__eq__(T,B)},P.__new__=function(T,B,q,ee){var F=n.args("__new__",4,{cls:null,source:null,encoding:null,errors:null},["cls","source","encoding","errors"],arguments,{source:[],encoding:"utf-8",errors:"strict"},null,null);return P.$new(F.cls,F.source,F.encoding,F.errors)},P.$new=function(T,B,q,ee){var F={__class__:T},Be=[],K=0;if(void 0!==B)if("number"==typeof B||o.isinstance(B,o.int))for(var ve=B;ve--;)Be[K++]=0;else if("string"==typeof B||o.isinstance(B,o.str)){if(void 0===q)throw o.TypeError.$factory("string argument without an encoding");Be=le(B,q||"utf-8",ee||"strict")}else for(Be=o.list.$factory(B),ve=0;ve<Be.length;ve++){try{var Ae=o.int.$factory(Be[ve])}catch{throw o.TypeError.$factory("'"+n.class_name(Be[ve])+"' object cannot be interpreted as an integer")}if(Ae<0||Ae>255)throw o.ValueError.$factory("bytes must be in range(0, 256)")}return F.source=Be,F.encoding=q,F.errors=ee,F},P.__repr__=P.__str__=function(T){for(var B="",q=0,ee=T.source.length;q<ee;q++){var F=T.source[q];if(10==F)B+="\\n";else if(F<32||F>=128){var Be=F.toString(16);B+="\\x"+(Be=(1==Be.length?"0":"")+Be)}else B+=92==F?"\\\\":String.fromCharCode(F)}return B.indexOf("'")>-1&&-1==B.indexOf('"')?'b"'+B+'"':"b'"+B.replace(new RegExp("'","g"),"\\'")+"'"},P.__reduce_ex__=function(T){return P.__repr__(T)},P.capitalize=function(T){var B=T.source,q=B.length,ee=B.slice();ee[0]>96&&ee[0]<123&&(ee[0]-=32);for(var F=1;F<q;++F)ee[F]>64&&ee[F]<91&&(ee[F]+=32);return P.$factory(ee)},P.center=function(){var T=n.args("center",3,{self:null,width:null,fillbyte:null},["self","width","fillbyte"],arguments,{fillbyte:P.$factory([32])},null,null),B=T.width-T.self.source.length;if(B<=0)return P.$factory(T.self.source);var q=P.ljust(T.self,T.self.source.length+Math.floor(B/2),T.fillbyte);return P.rjust(q,T.width,T.fillbyte)},P.count=function(){var T=n.args("count",4,{self:null,sub:null,start:null,end:null},["self","sub","start","end"],arguments,{start:0,end:-1},null,null),B=0,q=-1,ee=0;if("number"==typeof T.sub){if(T.sub<0||T.sub>255)throw o.ValueError.$factory("byte must be in range(0, 256)");ee=1}else{if(!T.sub.__class__||!T.sub.__class__.$buffer_protocol)throw o.TypeError.$factory("first argument must be a bytes-like object, not '"+n.class_name(T.sub)+"'");ee=T.sub.source.length}do{-1!=(q=P.find(T.self,T.sub,Math.max(q+ee,T.start),T.end))&&B++}while(-1!=q);return B},P.decode=function(T,B,q){var ee=n.args("decode",3,{self:null,encoding:null,errors:null},["self","encoding","errors"],arguments,{encoding:"utf-8",errors:"strict"},null,null);switch(ee.errors){case"strict":case"ignore":case"replace":case"surrogateescape":case"surrogatepass":case"xmlcharrefreplace":case"backslashreplace":return _e(ee.self,ee.encoding,ee.errors)}},P.endswith=function(){var T=n.args("endswith",4,{self:null,suffix:null,start:null,end:null},["self","suffix","start","end"],arguments,{start:-1,end:-1},null,null);if(o.isinstance(T.suffix,P)){for(var B=-1==T.start?T.self.source.length-T.suffix.source.length:Math.min(T.self.source.length-T.suffix.source.length,T.start),q=-1==T.end?-1==T.start?T.self.source.length:B+T.suffix.source.length:Math.min(T.self.source.length-1,T.end),ee=!0,F=T.suffix.source.length-1,Be=T.suffix.source.length;F>=0&&ee;--F)ee=T.self.source[q-Be+F]==T.suffix.source[F];return ee}if(o.isinstance(T.suffix,o.tuple)){for(F=0;F<T.suffix.length;++F){if(!o.isinstance(T.suffix[F],P))throw o.TypeError.$factory("endswith first arg must be bytes or a tuple of bytes, not "+n.class_name(T.suffix));if(P.endswith(T.self,T.suffix[F],T.start,T.end))return!0}return!1}throw o.TypeError.$factory("endswith first arg must be bytes or a tuple of bytes, not "+n.class_name(T.suffix))},P.expandtabs=function(){var T=n.args("expandtabs",2,{self:null,tabsize:null},["self","tabsize"],arguments,{tabsize:8},null,null),B=[];for(let ee=0;ee<T.tabsize;++ee)B.push(32);var q=T.self.source.slice();for(let ee=0;ee<q.length;++ee)9===q[ee]&&q.splice.apply(q,[ee,1].concat(B));return o.bytes.$factory(q)},P.find=function(T,B){if(2!=arguments.length)var q=n.args("find",4,{self:null,sub:null,start:null,end:null},["self","sub","start","end"],arguments,{start:0,end:-1},null,null),ee=(B=q.sub,q.start),F=q.end;else ee=0,F=-1;if("number"==typeof B){if(B<0||B>255)throw o.ValueError.$factory("byte must be in range(0, 256)");return T.source.slice(0,-1==F?void 0:F).indexOf(B,ee)}if(!B.__class__||!B.__class__.$buffer_protocol)throw o.TypeError.$factory("first argument must be a bytes-like object, not '"+n.class_name(B)+"'");F=-1==F?T.source.length:Math.min(T.source.length,F);for(var Be=B.source.length,K=ee;K<=F-Be;K++){for(var ve=T.source.slice(K,K+Be),Ae=!0,Fe=0;Fe<Be;Fe++)if(ve[Fe]!=B.source[Fe]){Ae=!1;break}if(Ae)return K}return-1},P.fromhex=function(){for(var T=n.args("fromhex",2,{cls:null,string:null},["cls","string"],arguments,{},null,null),B=T.string.replace(/\s/g,""),q=[],ee=0;ee<B.length;ee+=2){if(ee+2>B.length)throw o.ValueError.$factory("non-hexadecimal number found in fromhex() arg");q.push(o.int.$factory(B.substr(ee,2),16))}return T.cls.$factory(q)},P.hex=function(){for(var T=n.args("hex",1,{self:null},["self"],arguments,{},null,null).self,B="",q=0,ee=T.source.length;q<ee;q++){var F=T.source[q].toString(16);F.length<2&&(F="0"+F),B+=F}return B},P.index=function(){var T=n.args("rfind",4,{self:null,sub:null,start:null,end:null},["self","sub","start","end"],arguments,{start:0,end:-1},null,null),B=P.find(T.self,T.sub,T.start,T.end);if(-1==B)throw o.ValueError.$factory("subsection not found");return B},P.isalnum=function(T){for(var B=T.source,q=B.length,ee=q>0,F=0;F<q&&ee;++F)ee=B[F]>96&&B[F]<123||B[F]>64&&B[F]<91||B[F]>47&&B[F]<58;return ee},P.isalpha=function(T){for(var B=T.source,q=B.length,ee=q>0,F=0;F<q&&ee;++F)ee=B[F]>96&&B[F]<123||B[F]>64&&B[F]<91;return ee},P.isdigit=function(T){var B=T.source,q=B.length,ee=q>0;for(let F=0;F<q&&ee;++F)ee=B[F]>47&&B[F]<58;return ee},P.islower=function(T){var B=T.source,q=B.length,ee=!1;for(let F=0;F<q;++F)if(ee=ee||B[F]>96&&B[F]<123,B[F]>64&&B[F]<91)return!1;return ee},P.isspace=function(T){var B=T.source,q=B.length;for(let ee=0;ee<q;++ee)switch(B[ee]){case 9:case 10:case 11:case 12:case 13:case 32:break;default:return!1}return!0},P.isupper=function(T){var B=T.source,q=B.length,ee=!1;for(let F=0;F<q;++F)if(ee=ee||B[F]>64&&B[F]<91,B[F]>96&&B[F]<123)return!1;return ee},P.istitle=function(T){for(var B=T.source,q=B.length,ee=!1,F=!1,Be=!1,K=!1,ve=0;ve<q;++ve){if(Be=B[ve]>64&&B[ve]<91,(ee=(K=B[ve]>96&&B[ve]<123)||Be)&&F&&Be||!F&&K)return!1;F=ee}return!0},P.join=function(){for(var T=n.args("join",2,{self:null,iterable:null},["self","iterable"],arguments,{}),B=T.self,ee=n.$getattr(o.iter(T.iterable),"__next__"),F=B.__class__.$factory(),Be=!0;;)try{var K=ee();Be?Be=!1:F=P.__add__(F,B),F=P.__add__(F,K)}catch(ve){if(o.isinstance(ve,o.StopIteration))break;throw ve}return F};var be=function(T){return T>=65&&T<=90?T+32:T};P.lower=function(T){for(var B=[],q=0,ee=0,F=T.source.length;ee<F;ee++)T.source[ee]&&(B[q++]=be(T.source[ee]));return P.$factory(B)},P.ljust=function(){var T=n.args("ljust",3,{self:null,width:null,fillbyte:null},["self","width","fillbyte"],arguments,{fillbyte:P.$factory([32])},null,null);if(!T.fillbyte.__class__||!T.fillbyte.__class__.$buffer_protocol)throw o.TypeError.$factory("argument 2 must be a byte string of length 1, not '"+n.class_name(T.fillbyte)+"'");for(var B=[],q=T.width-T.self.source.length,ee=0;ee<q;++ee)B.push(T.fillbyte.source[0]);return P.$factory(T.self.source.concat(B))},P.lstrip=function(T,B){return N(T,B,"l")},P.maketrans=function(T,B){for(var q=[],ee=(B=n.to_bytes(B),0);ee<256;ee++)q[ee]=ee;ee=0;for(var F=T.source.length;ee<F;ee++)q[T.source[ee]]=B[ee];return P.$factory(q)},P.partition=function(){var T=n.args("partition",2,{self:null,sep:null},["self","sep"],arguments,{},null,null);if(!T.sep.__class__||!T.sep.__class__.$buffer_protocol)throw o.TypeError.$factory("a bytes-like object is required, not '"+n.class_name(T.sep)+"'");var B=T.sep.source.length,q=T.self.source,ee=P.find(T.self,T.sep);return o.tuple.$factory([P.$factory(q.slice(0,ee)),P.$factory(q.slice(ee,ee+B)),P.$factory(q.slice(ee+B))])},P.removeprefix=function(){var T=n.args("removeprefix",2,{self:null,prefix:null},["self","prefix"],arguments,{},null,null);if(!o.isinstance(T.prefix,[P,G]))throw o.ValueError.$factory(`prefix should be bytes, not '${n.class_name(T.prefix)}'`);return P.startswith(T.self,T.prefix)?P.__getitem__(T.self,o.slice.$factory(T.prefix.source.length,o.None)):P.__getitem__(T.self,o.slice.$factory(0,o.None))},P.removesuffix=function(){var T=n.args("removesuffix",2,{self:null,prefix:null},["self","suffix"],arguments,{},null,null);if(!o.isinstance(T.suffix,[P,G]))throw o.ValueError.$factory(`suffix should be bytes, not '${n.class_name(T.suffix)}'`);return P.endswith(T.self,T.suffix)?P.__getitem__(T.self,o.slice.$factory(0,T.suffix.source.length+1)):P.__getitem__(T.self,o.slice.$factory(0,o.None))},P.replace=function(){var T=n.args("replace",4,{self:null,old:null,new:null,count:null},["self","old","new","count"],arguments,{count:-1},null,null),B=[],q=T.self,ee=q.source,F=ee.length,Be=T.old,K=T.new,ve=T.count>=0?T.count:ee.length;if(!T.old.__class__)throw o.TypeError.$factory("first argument must be a bytes-like object, not '"+n.class_name(T.old)+"'");if(!T.old.__class__.$buffer_protocol)throw o.TypeError.$factory("first argument must be a bytes-like object, not '"+n.class_name(T.sep)+"'");if(!T.new.__class__)throw o.TypeError.$factory("second argument must be a bytes-like object, not '"+n.class_name(T.old)+"'");if(!T.new.__class__.$buffer_protocol)throw o.TypeError.$factory("second argument must be a bytes-like object, not '"+n.class_name(T.sep)+"'");for(var Ae=0;Ae<F;Ae++)if(P.startswith(q,Be,Ae)&&ve){for(var Fe=0;Fe<K.source.length;Fe++)B.push(K.source[Fe]);Ae+=Be.source.length-1,ve--}else B.push(ee[Ae]);return P.$factory(B)},P.rfind=function(T,B){if(2==arguments.length&&B.__class__===P)var q=B,ee=0,F=-1;else{var Be=n.args("rfind",4,{self:null,sub:null,start:null,end:null},["self","sub","start","end"],arguments,{start:0,end:-1},null,null);T=Be.self,q=Be.sub,ee=Be.start,F=Be.end}if("number"==typeof q){if(q<0||q>255)throw o.ValueError.$factory("byte must be in range(0, 256)");return Be.self.source.slice(ee,-1==Be.end?void 0:Be.end).lastIndexOf(q)+ee}if(!q.__class__)throw o.TypeError.$factory("first argument must be a bytes-like object, not '"+n.class_name(Be.sub)+"'");if(!q.__class__.$buffer_protocol)throw o.TypeError.$factory("first argument must be a bytes-like object, not '"+n.class_name(q)+"'");F=-1==F?T.source.length:Math.min(T.source.length,F);for(var K=q.source.length,ve=F-K;ve>=ee;--ve){for(var Ae=T.source.slice(ve,ve+K),Fe=!0,Ee=0;Ee<K;Ee++)if(Ae[Ee]!=q.source[Ee]){Fe=!1;break}if(Fe)return ve}return-1},P.rindex=function(){var T=n.args("rfind",4,{self:null,sub:null,start:null,end:null},["self","sub","start","end"],arguments,{start:0,end:-1},null,null),B=P.rfind(T.self,T.sub,T.start,T.end);if(-1==B)throw o.ValueError.$factory("subsection not found");return B},P.rjust=function(){var T=n.args("rjust",3,{self:null,width:null,fillbyte:null},["self","width","fillbyte"],arguments,{fillbyte:P.$factory([32])},null,null);if(!T.fillbyte.__class__||!T.fillbyte.__class__.$buffer_protocol)throw o.TypeError.$factory("argument 2 must be a byte string of length 1, not '"+n.class_name(T.fillbyte)+"'");for(var B=[],q=T.width-T.self.source.length,ee=0;ee<q;++ee)B.push(T.fillbyte.source[0]);return P.$factory(B.concat(T.self.source))},P.rpartition=function(){var T=n.args("rpartition",2,{self:null,sep:null},["self","sep"],arguments,{},null,null);if(!T.sep.__class__||!T.sep.__class__.$buffer_protocol)throw o.TypeError.$factory("a bytes-like object is required, not '"+n.class_name(T.sep)+"'");var B=T.sep.source.length,q=T.self.source,ee=P.rfind(T.self,T.sep);return o.tuple.$factory([P.$factory(q.slice(0,ee)),P.$factory(q.slice(ee,ee+B)),P.$factory(q.slice(ee+B))])},P.rstrip=function(T,B){return N(T,B,"r")},P.split=function(){var T=n.args("split",2,{self:null,sep:null},["self","sep"],arguments,{},null,null),B=[],q=0,ee=0;if(!T.sep.__class__||!T.sep.__class__.$buffer_protocol)throw o.TypeError.$factory("a bytes-like object is required, not '"+n.class_name(T.sep)+"'");for(var F=T.sep.source,Be=F.length,K=T.self.source,ve=K.length;ee<ve;){for(var Ae=!0,Fe=0;Fe<Be&&Ae;Fe++)K[ee+Fe]!=F[Fe]&&(Ae=!1);Ae?(B.push(P.$factory(K.slice(q,ee))),ee=q=ee+Be):ee++}return(Ae||ee>q)&&B.push(P.$factory(K.slice(q,ee))),B},P.splitlines=function(T){var B=n.args("splitlines",2,{self:null,keepends:null},["self","keepends"],arguments,{keepends:!1},null,null);if(!o.isinstance(B.keepends,[o.bool,o.int]))throw o.TypeError("integer argument expected, got "+n.get_class(B.keepends).__name);var q=o.int.$factory(B.keepends),ee=[],F=B.self.source,Be=0,K=0;if(!F.length)return ee;for(;K<F.length;)K<F.length-1&&13==F[K]&&10==F[K+1]?(ee.push(P.$factory(F.slice(Be,q?K+2:K))),Be=K+=2):13==F[K]||10==F[K]?(ee.push(P.$factory(F.slice(Be,q?K+1:K))),Be=K+=1):K++;return Be<F.length&&ee.push(P.$factory(F.slice(Be))),ee},P.startswith=function(){var T=n.args("startswith",3,{self:null,prefix:null,start:null},["self","prefix","start"],arguments,{start:0},null,null),B=T.start;if(o.isinstance(T.prefix,P)){for(var q=!0,ee=0;ee<T.prefix.source.length&&q;ee++)q=T.self.source[B+ee]==T.prefix.source[ee];return q}if(o.isinstance(T.prefix,o.tuple)){var F=[];for(ee=0;ee<T.prefix.length;ee++){if(!o.isinstance(T.prefix[ee],P))throw o.TypeError.$factory("startswith first arg must be bytes or a tuple of bytes, not "+n.class_name(T.prefix));F=F.concat(T.prefix[ee].source)}var Be=P.$factory(F);return P.startswith(T.self,Be,B)}throw o.TypeError.$factory("startswith first arg must be bytes or a tuple of bytes, not "+n.class_name(T.prefix))},P.strip=function(T,B){var q=P.lstrip(T,B);return P.rstrip(q,B)},P.swapcase=function(T){for(var B=T.source,q=B.length,ee=B.slice(),F=0;F<q;++F)ee[F]>96&&ee[F]<123?ee[F]-=32:ee[F]>64&&ee[F]<91&&(ee[F]+=32);return P.$factory(ee)},P.title=function(T){var B=T.source,q=B.length;buffer=B.slice(),current_char_is_letter=!1,prev_char_was_letter=!1,is_uppercase=!1,is_lowercase=!1;for(var ee=0;ee<q;++ee)is_lowercase=buffer[ee]>96&&buffer[ee]<123,is_uppercase=buffer[ee]>64&&buffer[ee]<91,current_char_is_letter=is_lowercase||is_uppercase,current_char_is_letter&&(prev_char_was_letter&&is_uppercase?buffer[ee]+=32:!prev_char_was_letter&&is_lowercase&&(buffer[ee]-=32)),prev_char_was_letter=current_char_is_letter;return P.$factory(buffer)},P.translate=function(T,B,q){if(void 0===q)q=[];else{if(!o.isinstance(q,P))throw o.TypeError.$factory("Type "+n.get_class(q).__name+" doesn't support the buffer API");q=q.source}var ee=[],F=0;if(o.isinstance(B,P)&&256==B.source.length)for(var Be=0,K=T.source.length;Be<K;Be++)q.indexOf(T.source[Be])>-1||(ee[F++]=B.source[T.source[Be]]);return P.$factory(ee)};var te=function(T){return T>=97&&T<=122?T-32:T};function ce(T,B,q){throw o.UnicodeEncodeError.$factory("'"+T+"' codec can't encode character "+o.hex(B)+" in position "+q)}function fe(T){var B=T.toLowerCase();return"windows"==B.substr(0,7)&&(B="cp"+B.substr(7)),(B.startsWith("cp")||B.startsWith("iso"))&&(B=B.replace("-","")),B.replace(/-/g,"_")}P.upper=function(T){for(var B=[],q=0,ee=0,F=T.source.length;ee<F;ee++)T.source[ee]&&(B[q++]=te(T.source[ee]));return P.$factory(B)},P.zfill=function(T,B){for(var q=T.source.slice(),ee=43==q[0]||45==q[0]?1:0,F=B-T.source.length,Be=[],K=0;K<F;++K)Be.push(48);return q.splice.apply(q,[ee,0].concat(Be)),P.$factory(q)};var _e=n.decode=function(T,B,q){var ee="",F=T.source,Be=fe(B),K=!1;switch(Be){case"utf_8":case"utf-8":case"utf8":case"U8":case"UTF":var ve,Ae=0;for(ee="";Ae<F.length;){var Fe=F[Ae];if(ve=null,128&Fe)if(Fe>>5==6)if(void 0===F[Ae+1]?ve=[Fe,Ae,"end"]:128!=(192&F[Ae+1])&&(ve=[Fe,Ae,"continuation"]),null!==ve){if("ignore"!=q)throw o.UnicodeDecodeError.$factory("'utf-8' codec can't decode byte 0x"+ve[0].toString(16)+"  in position "+ve[1]+("end"==ve[2]?": unexpected end of data":": invalid continuation byte"));Ae++}else{var Ee=31&Fe;Ee<<=6,Ee+=63&F[Ae+1],ee+=String.fromCodePoint(Ee),Ae+=2}else if(Fe>>4==14)if(void 0===F[Ae+1]?ve=[Fe,Ae,"end",Ae+1]:128!=(192&F[Ae+1])?ve=[Fe,Ae,"continuation",Ae+2]:void 0===F[Ae+2]?ve=[Fe,Ae+"-"+(Ae+1),"end",Ae+2]:128!=(192&F[Ae+2])&&(ve=[Fe,Ae,"continuation",Ae+3]),null!==ve)if("ignore"==q)Ae=ve[3];else{if("surrogateescape"!=q)throw o.UnicodeDecodeError.$factory("'utf-8' codec can't decode byte 0x"+ve[0].toString(16)+"  in position "+ve[1]+("end"==ve[2]?": unexpected end of data":": invalid continuation byte"));for(var qe=Ae;qe<ve[3];qe++)ee+=String.fromCodePoint(56448+F[qe]-128);Ae=ve[3]}else Ee=15&Fe,Ee<<=12,Ee+=(63&F[Ae+1])<<6,Ee+=63&F[Ae+2],ee+=String.fromCodePoint(Ee),Ae+=3;else if(Fe>>3==30)if(K=!0,void 0===F[Ae+1]?ve=[Fe,Ae,"end",Ae+1]:128!=(192&F[Ae+1])?ve=[Fe,Ae,"continuation",Ae+2]:void 0===F[Ae+2]?ve=[Fe,Ae+"-"+(Ae+1),"end",Ae+2]:128!=(192&F[Ae+2])?ve=[Fe,Ae,"continuation",Ae+3]:void 0===F[Ae+3]?ve=[Fe,Ae+"-"+(Ae+1)+"-"+(Ae+2),"end",Ae+3]:128!=(192&F[Ae+2])&&(ve=[Fe,Ae,"continuation",Ae+3]),null!==ve)if("ignore"==q)Ae=ve[3];else{if("surrogateescape"!=q)throw o.UnicodeDecodeError.$factory("'utf-8' codec can't decode byte 0x"+ve[0].toString(16)+"  in position "+ve[1]+("end"==ve[2]?": unexpected end of data":": invalid continuation byte"));for(qe=Ae;qe<ve[3];qe++)ee+=String.fromCodePoint(56448+F[qe]-128);Ae=ve[3]}else Ee=15&Fe,Ee<<=18,Ee+=(63&F[Ae+1])<<12,Ee+=(63&F[Ae+2])<<6,Ee+=63&F[Ae+3],ee+=String.fromCodePoint(Ee),Ae+=4;else if("ignore"==q)Ae++;else{if("surrogateescape"!=q)throw o.UnicodeDecodeError.$factory("'utf-8' codec can't decode byte 0x"+Fe.toString(16)+" in position "+Ae+": invalid start byte");ee+=String.fromCodePoint(56448+F[Ae]-128),Ae++}else ee+=String.fromCodePoint(Fe),Ae++}return K?o.str.$surrogate.$factory(ee):ee;case"latin_1":case"windows1252":case"iso-8859-1":case"iso8859-1":case"8859":case"cp819":case"latin":case"latin1":case"L1":F.forEach(function(at){ee+=String.fromCharCode(at)});break;case"unicode_escape":return T.__class__!==P&&T.__class__!==G||(T=_e(T,"latin-1","strict")),T.replace(/\\n/g,"\n").replace(/\\a/g,"\x07").replace(/\\b/g,"\b").replace(/\\f/g,"\f").replace(/\\t/g,"\t").replace(/\\'/g,"'").replace(/\\"/g,'"');case"raw_unicode_escape":return T.__class__!==P&&T.__class__!==G||(T=_e(T,"latin-1","strict")),T.replace(/\\u([a-fA-F0-9]{4})/g,function(at){var Ct=parseInt(at.substr(2),16);return String.fromCharCode(Ct)});case"ascii":qe=0;for(var Ke=F.length;qe<Ke;qe++)if((Ee=F[qe])<=127)ee+=String.fromCharCode(Ee);else if("ignore"!=q){var gt="'ascii' codec can't decode byte 0x"+Ee.toString(16)+" in position "+qe+": ordinal not in range(128)";throw o.UnicodeDecodeError.$factory(gt)}break;default:try{!function(at){if(void 0===x[at]){var Ct=o.__import__("encodings."+at);Ct[at].getregentry&&(x[at]=n.$getattr(Ct[at].getregentry(),"decode"))}}(Be)}catch(at){throw console.log(F,B,"error load_decoder",at),o.LookupError.$factory("unknown encoding: "+Be)}return x[Be](T)[0]}return ee},le=n.encode=function(){var T=n.args("encode",3,{s:null,encoding:null,errors:null},["s","encoding","errors"],arguments,{encoding:"utf-8",errors:"strict"},null,null),B=T.s,q=T.encoding,ee=T.errors,F=[],Be=0,K=fe(q);switch(K){case"utf-8":case"utf_8":case"utf8":for(var ve=[],Ae=0,Fe=B.length;Ae<Fe;Ae++)(Ee=B.charCodeAt(Ae))<127?ve.push(Ee):Ee<2047?ve.push(192+(Ee>>6),128+(63&Ee)):Ee<65535?ve.push(224+(Ee>>12),128+((4095&Ee)>>6),128+(63&Ee)):console.log("4 bytes");return ve;case"latin":case"latin1":case"latin-1":case"latin_1":case"L1":case"iso8859_1":case"iso_8859_1":case"8859":case"cp819":case"windows1252":for(Ae=0,Fe=B.length;Ae<Fe;Ae++)(Ee=B.charCodeAt(Ae))<=255?F[Be++]=Ee:"ignore"!=ee&&ce(q,Ae);break;case"ascii":for(Ae=0,Fe=B.length;Ae<Fe;Ae++)(Ee=B.charCodeAt(Ae))<=127?F[Be++]=Ee:"ignore"!=ee&&ce(q,Ae);break;case"raw_unicode_escape":for(Ae=0,Fe=B.length;Ae<Fe;Ae++){var Ee;if((Ee=B.charCodeAt(Ae))<256)F[Be++]=Ee;else{var qe=Ee.toString(16);qe.length%2&&(qe="0"+qe),qe="\\u"+qe;for(var Ke=0;Ke<qe.length;Ke++)F[Be++]=qe.charCodeAt(Ke)}}break;default:try{!function(gt){if(void 0===l[gt]){var at=o.__import__("encodings."+gt);at[gt].getregentry&&(l[gt]=n.$getattr(at[gt].getregentry(),"encode"))}}(K)}catch{throw o.LookupError.$factory("unknown encoding: "+q)}F=l[K](B)[0].source}return F};for(var pe in P.$factory=function(T,B,q){var ee=n.args("bytes",3,{source:null,encoding:null,errors:null},["source","encoding","errors"],arguments,{source:[],encoding:"utf-8",errors:"strict"},null,null);return P.$new(P,ee.source,ee.encoding,ee.errors)},P.__class__=o.type,P.$is_class=!0,P)void 0===G[pe]&&"function"==typeof P[pe]&&(G[pe]=function(T){return function(){return P[T].apply(null,arguments)}}(pe));n.set_func_names(P,"builtins"),P.fromhex=o.classmethod.$factory(P.fromhex),n.set_func_names(G,"builtins"),G.fromhex=o.classmethod.$factory(G.fromhex),o.bytes=P,o.bytearray=G}(__BRYTHON__),function($B){var _b_=$B.builtins,object=_b_.object,$N=_b_.None;function create_type(n){return $B.get_class(n).$factory()}function clone(n){var o=create_type(n);for(key in o.$items=n.$items.slice(),n.$hashes)o.$hashes[key]=n.$hashes[key];return o}var set={__class__:_b_.type,$infos:{__module__:"builtins",__name__:"set"},$is_class:!0,$native:!0,__add__:function(n,o){throw _b_.TypeError.$factory("unsupported operand type(s) for +: 'set' and "+typeof o)},__and__:function(n,o,l){try{$test(l,o)}catch{return _b_.NotImplemented}for(var x=create_type(n),N=0,U=n.$items.length;N<U;N++)_b_.getattr(o,"__contains__")(n.$items[N])&&set.add(x,n.$items[N]);return x},__class_getitem__:function(n,o){return Array.isArray(o)||(o=[o]),$B.GenericAlias.$factory(n,o)},__contains__:function(n,o){if(n.$simple){if("number"==typeof o||o instanceof Number){if(isNaN(o)){for(var l=n.$items.length-1;l>=0;l--)if(isNaN(n.$items[l]))return!0;return!1}return o instanceof Number?n.$numbers.indexOf(o.valueOf())>-1:n.$items.indexOf(o)>-1}if("string"==typeof o)return n.$items.indexOf(o)>-1}_b_.isinstance(o,set)||$B.$getattr(o,"__hash__");var x=_b_.hash(o);if(n.$hashes[x]){l=0;for(var N=n.$hashes[x].length;l<N;l++)if($B.rich_comp("__eq__",n.$hashes[x][l],o))return!0}return!1},__eq__:function(n,o){if(void 0===o)return n===set;if(_b_.isinstance(o,[_b_.set,_b_.frozenset])){if(o.$items.length==n.$items.length){for(var l=0,x=n.$items.length;l<x;l++)if(!1===set.__contains__(n,o.$items[l]))return!1;return!0}return!1}return _b_.NotImplemented},__format__:function(n,o){return set.__str__(n)},__ge__:function(n,o){return _b_.isinstance(o,[set,frozenset])?set.__le__(o,n):_b_.NotImplemented},__gt__:function(n,o){return _b_.isinstance(o,[set,frozenset])?set.__lt__(o,n):_b_.NotImplemented}};set.__hash__=_b_.None,set.__init__=function(n,o,l){if(void 0===l&&Array.isArray(o)){for(var x=0,N=o.length;x<N;x++)$add(n,o[x]);return $N}var U=$B.args("__init__",2,{self:null,iterable:null},["self","iterable"],arguments,{iterable:[]},null,null);if(n=U.self,_b_.isinstance(o=U.iterable,[set,frozenset])){for(var G in n.$items=o.$items.slice(),n.$hashes={},o.$hashes)n.$hashes[G]=o.$hashes[G];return $N}for(var A=$B.$iter(o);;)try{$add(n,_b_.next(A))}catch(P){if(_b_.isinstance(P,_b_.StopIteration))break;throw P}return $N};var set_iterator=$B.make_iterator_class("set iterator");function $test(n,o,l){if(void 0===n&&!_b_.isinstance(o,[set,frozenset]))throw _b_.TypeError.$factory("unsupported operand type(s) for "+l+": 'set' and '"+$B.class_name(o)+"'")}function $add(n,o){var l=!1;if(("string"==typeof o||"number"==typeof o||o instanceof Number)&&(l=!0),l){var x=n.$items.indexOf(o);if(-1==x){if(!(o instanceof Number&&n.$numbers.indexOf(o.valueOf())>-1||"number"==typeof o&&n.$numbers.indexOf(o)>-1)){n.$items.push(o);var N=o.valueOf();"number"==typeof N&&n.$numbers.push(N)}}else o!==n.$items[x]&&n.$items.push(o)}else{var U=_b_.hash(o);if(void 0===(G=n.$hashes[U]))n.$hashes[U]=[o],n.$items.push(o);else{for(var G,P=0,de=(G=n.$hashes[U]).length;P<de;P++)if($B.rich_comp("__eq__",o,G[P]))return $N;n.$hashes[U].push(o),n.$items.push(o)}}return $N}set.__iter__=function(n){return n.$items.sort(),set_iterator.$factory(n.$items)},set.__le__=function(n,o){if(_b_.isinstance(o,[set,frozenset])){for(var l=_b_.getattr(o,"__contains__"),x=0,N=n.$items.length;x<N;x++)if(!l(n.$items[x]))return!1;return!0}return _b_.NotImplemented},set.__len__=function(n){return n.$items.length},set.__lt__=function(n,o){return _b_.isinstance(o,[set,frozenset])?set.__le__(n,o)&&set.__len__(n)<_b_.getattr(o,"__len__")():_b_.NotImplemented},set.__mro__=[_b_.object],set.__new__=function(n){if(void 0===n)throw _b_.TypeError.$factory("set.__new__(): not enough arguments");return{__class__:n,$simple:!0,$items:[],$numbers:[],$hashes:{}}},set.__or__=function(n,o,l){for(var x=clone(n),N=_b_.getattr($B.$iter(o),"__next__");;)try{set.add(x,N())}catch(U){if(_b_.isinstance(U,_b_.StopIteration))break;throw U}return x.__class__=n.__class__,x},set.__rand__=function(n,o){return set.__and__(n,o)},set.__reduce__=function(n){return _b_.tuple.$factory([n.__class__,_b_.tuple.$factory([n.$items]),$N])},set.__reduce_ex__=function(n,o){return set.__reduce__(n)},set.__rsub__=function(n,o){return set.__sub__(n,o)},set.__rxor__=function(n,o){return set.__xor__(n,o)},set.__str__=set.__repr__=function(n){var o=$B.class_name(n);if(0===n.$items.length)return o+"()";var l=o+"({",x="})";"set({"==l&&(l="{",x="}");var N=[];if($B.repr.enter(n))return o+"(...)";n.$items.sort();for(var U=0,G=n.$items.length;U<G;U++){var A=_b_.repr(n.$items[U]);N.push(A===n||A===n.$items[U]?"{...}":A)}return N=N.join(", "),$B.repr.leave(n),l+N+x},set.__sub__=function(n,o,l){try{$test(l,o,"-")}catch{return _b_.NotImplemented}for(var x=create_type(n),N=_b_.getattr(o,"__contains__"),U=[],G=0,A=n.$items.length;G<A;G++)N(n.$items[G])||U.push(n.$items[G]);return set.__init__.call(null,x,U),x},set.__xor__=function(n,o,l){try{$test(l,o,"^")}catch{return _b_.NotImplemented}for(var x=create_type(n),N=_b_.getattr(o,"__contains__"),U=0,G=n.$items.length;U<G;U++)N(n.$items[U])||set.add(x,n.$items[U]);for(U=0,G=o.$items.length;U<G;U++)set.__contains__(n,o.$items[U])||set.add(x,o.$items[U]);return x},$B.make_rmethods(set),set.add=function(){var n=$B.args("add",2,{self:null,item:null},["self","item"],arguments,{},null,null);return $add(n.self,n.item)},set.clear=function(){var n=$B.args("clear",1,{self:null},["self"],arguments,{},null,null);return n.self.$items=[],n.self.$hashes={},$N},set.copy=function(){var n=$B.args("copy",1,{self:null},["self"],arguments,{},null,null);if(_b_.isinstance(n.self,frozenset))return n.self;var o=set.$factory();for(key in n.self.$items.forEach(function(l){o.$items.push(l)}),n.self.$numbers.forEach(function(l){o.$numbers.push(l)}),self.$hashes)o.$hashes[key]=self.$hashes[key];return o},set.difference_update=function(n){for(var o=$B.args("difference_update",1,{self:null},["self"],arguments,{},"args",null),l=0;l<o.args.length;l++)for(var x,N=set.$factory(o.args[l]),U=_b_.getattr($B.$iter(N),"__next__");;)try{var G=typeof(x=U());if("string"==G||"number"==G){var A=n.$items.indexOf(x);A>-1&&n.$items.splice(A,1)}else for(var P=0;P<n.$items.length;P++)if($B.rich_comp("__eq__",n.$items[P],x)){n.$items.splice(P,1);var de=_b_.hash(x);if(n.$hashes[de])for(var be=0;be<n.$hashes[de].length;be++)if($B.rich_comp("__eq__",n.$hashes[de][be],x)){n.$hashes[de].splice(be,1);break}}}catch(te){if(_b_.isinstance(te,_b_.StopIteration))break;throw te}return $N},set.discard=function(){var n=$B.args("discard",2,{self:null,item:null},["self","item"],arguments,{},null,null);try{set.remove(n.self,n.item)}catch(o){if(!_b_.isinstance(o,[_b_.KeyError,_b_.LookupError]))throw o}return $N},set.intersection_update=function(){for(var n=$B.args("intersection_update",1,{self:null},["self"],arguments,{},"args",null),o=n.self,l=0;l<n.args.length;l++){for(var x=[],N=set.$factory(n.args[l]),U=0;U<o.$items.length;U++){var G=o.$items[U],A=typeof G;if("string"==A||"number"==A)-1==N.$items.indexOf(G)&&x.push(U);else{var P=!1,de=_b_.hash(G);if(N.$hashes[de]){for(var be=N.$hashes[de],te=0;!P&&te<be.length;te++)$B.rich_comp("__eq__",be[te],G)&&(P=!0);if(!P)for(x.push(U),be=o.$hashes[de],te=0;!P&&te<be.length;te++)$B.rich_comp("__eq__",be[te],G)&&o.$hashes.splice(te,1)}}}for(x.sort(function(ce,fe){return ce-fe}).reverse(),U=0;U<x.length;U++)o.$items.splice(x[U],1)}return $N},set.isdisjoint=function(){for(var n=$B.args("is_disjoint",2,{self:null,other:null},["self","other"],arguments,{},null,null),o=0,l=n.self.$items.length;o<l;o++)if(_b_.getattr(n.other,"__contains__")(n.self.$items[o]))return!1;return!0},set.pop=function(n){if(0===n.$items.length)throw _b_.KeyError.$factory("pop from an empty set");var o=n.$items.pop();if("string"!=typeof o&&"number"!=typeof o)for(var l=_b_.hash(o),x=n.$hashes[l],N=0;N<x.length;N++)if($B.rich_comp("__eq__",x[N],o)){n.$hashes[l].splice(N,1);break}return o},set.remove=function(n,o){var l=$B.args("remove",2,{self:null,item:null},["self","item"],arguments,{},null,null);if(n=l.self,_b_.isinstance(o=l.item,set)||_b_.hash(o),"string"==typeof o||"number"==typeof o){var x=n.$items.indexOf(o);if(-1==x)throw _b_.KeyError.$factory(o);return n.$items.splice(x,1),"number"==typeof o&&n.$numbers.splice(n.$numbers.indexOf(o),1),$N}var N=_b_.hash(o);if(n.$hashes[N]){for(var U=0,G=n.$items.length;U<G;U++)if($B.rich_comp("__eq__",n.$items[U],o)){n.$items.splice(U,1),o instanceof Number&&n.$numbers.splice(n.$numbers.indexOf(o.valueOf()),1);break}for(U=0,G=n.$hashes[N].length;U<G;U++)if($B.rich_comp("__eq__",n.$hashes[N][U],o)){n.$hashes[N].splice(U,1);break}return $N}throw _b_.KeyError.$factory(o)},set.symmetric_difference_update=function(n,o){for(var l,x=$B.args("symmetric_difference_update",2,{self:null,s:null},["self","s"],arguments,{},null,null),N=(n=x.self,_b_.getattr($B.$iter(o=x.s),"__next__")),U=[],G=[];;)try{var A=typeof(l=N());if("string"==A||"number"==A){var P=n.$items.indexOf(l);P>-1?U.push(P):G.push(l)}else{for(var de=!1,be=0;!de&&be<n.$items.length;be++)$B.rich_comp("__eq__",n.$items[be],l)&&(U.push(be),de=!0);de||G.push(l)}}catch(ce){if(_b_.isinstance(ce,_b_.StopIteration))break;throw ce}U.sort(function(ce,fe){return ce-fe}).reverse();for(var te=0;te<U.length;te++)U[te]!=U[te-1]&&n.$items.splice(U[te],1);for(te=0;te<G.length;te++)set.add(n,G[te]);return $N},set.update=function(n){for(var o=$B.args("update",1,{self:null},["self"],arguments,{},"args",null),l=0;l<o.args.length;l++)for(var x=set.$factory(o.args[l]),N=0,U=x.$items.length;N<U;N++)$add(n,x.$items[N]);return $N},set.difference=function(){var n=$B.args("difference",1,{self:null},["self"],arguments,{},"args",null);if(0==n.args.length)return set.copy(n.self);for(var o=clone(n.self),l=0;l<n.args.length;l++)o=set.__sub__(o,set.$factory(n.args[l]),!0);return o};var fc=set.difference+"";function $accept_only_set(n,o){return function(l,x,N){return $test(N,x,o),n(l,x),l}}eval("set.intersection = "+fc.replace(/difference/g,"intersection").replace("__sub__","__and__")),eval("set.symmetric_difference = "+fc.replace(/difference/g,"symmetric_difference").replace("__sub__","__xor__")),eval("set.union = "+fc.replace(/difference/g,"union").replace("__sub__","__or__")),set.issubset=function(){for(var n=$B.args("issubset",2,{self:null,other:null},["self","other"],arguments,{},"args",null),o=_b_.getattr(n.other,"__contains__"),l=0,x=n.self.$items.length;l<x;l++)if(!o(n.self.$items[l]))return!1;return!0},set.issuperset=function(){for(var n=$B.args("issuperset",2,{self:null,other:null},["self","other"],arguments,{},"args",null),o=_b_.getattr(n.self,"__contains__"),l=$B.$iter(n.other);;)try{if(!o(_b_.next(l)))return!1}catch(x){if(_b_.isinstance(x,_b_.StopIteration))return!0;throw x}return!0},set.__iand__=$accept_only_set(set.intersection_update,"&="),set.__isub__=$accept_only_set(set.difference_update,"-="),set.__ixor__=$accept_only_set(set.symmetric_difference_update,"^="),set.__ior__=$accept_only_set(set.update,"|="),set.$factory=function(){var n={__class__:set,$simple:!0,$items:[],$numbers:[],$hashes:{}},o=[n].concat(Array.prototype.slice.call(arguments));return set.__init__.apply(null,o),n},$B.set_func_names(set,"builtins"),set.__class_getitem__=_b_.classmethod.$factory(set.__class_getitem__);var frozenset={__class__:_b_.type,__mro__:[object],$infos:{__module__:"builtins",__name__:"frozenset"},$is_class:!0,$native:!0};for(var attr in set)switch(attr){case"add":case"clear":case"discard":case"pop":case"remove":case"update":break;default:null==frozenset[attr]&&(frozenset[attr]="function"==typeof set[attr]?function(n){return function(){return set[n].apply(null,arguments)}}(attr):set[attr])}frozenset.__hash__=function(n){if(void 0===n)return frozenset.__hashvalue__||$B.$py_next_hash--;if(void 0!==n.__hashvalue__)return n.__hashvalue__;var o=1927868237;o*=n.$items.length;for(var l=0,x=n.$items.length;l<x;l++){var N=_b_.hash(n.$items[l]);o^=3644798167*(89869747^N^N<<16)}return-1==(o=69069*o+907133923)&&(o=590923713),n.__hashvalue__=o},frozenset.__init__=function(){return $N},frozenset.__new__=function(n){if(void 0===n)throw _b_.TypeError.$factory("frozenset.__new__(): not enough arguments");return{__class__:n,$simple:!0,$items:[],$numbers:[],$hashes:{}}};var singleton_id=Math.floor(Math.random()*Math.pow(2,40));function empty_frozenset(){var n=frozenset.__new__(frozenset);return n.$id=singleton_id,n}frozenset.$factory=function(){var n=$B.args("frozenset",1,{iterable:null},["iterable"],arguments,{iterable:null},null,null);if(null===n.iterable)return empty_frozenset();if(n.iterable.__class__==frozenset)return n.iterable;var o=set.$factory(n.iterable);return 0==o.$items.length?empty_frozenset():(o.__class__=frozenset,o)},$B.set_func_names(frozenset,"builtins"),_b_.set=set,_b_.frozenset=frozenset}(__BRYTHON__),function($B){var _b_=$B.builtins,object=_b_.object,_window=self;function to_simple(n){switch(typeof n){case"string":case"number":return n;case"boolean":return n?"true":"false";case"object":if(n===_b_.None)return"null";if(n instanceof Number)return n.valueOf();default:throw console.log("erreur",n),_b_.TypeError.$factory("keys must be str, int, float, bool or None, not "+$B.class_name(n))}}$B.pyobj2structuredclone=function(n,o){if(o=void 0===o||o,"boolean"==typeof n||"number"==typeof n||"string"==typeof n)return n;if(n instanceof Number)return n.valueOf();if(n===_b_.None)return null;if(Array.isArray(n)||n.__class__===_b_.list||n.__class__===_b_.tuple){for(var l=[],x=0,N=n.length;x<N;x++)l.push($B.pyobj2structuredclone(n[x]));return l}if(_b_.isinstance(n,_b_.dict)){if(o&&(Object.keys(n.$numeric_dict).length>0||Object.keys(n.$object_dict).length>0))throw _b_.TypeError.$factory("a dictionary with non-string keys does not support structured clone");var U=$B.dict_to_list(n);for(l={},x=0,N=U.length;x<N;x++)l[to_simple(U[x][0])]=$B.pyobj2structuredclone(U[x][1]);return l}return n},$B.structuredclone2pyobj=function(n){if(null===n)return _b_.None;if(void 0===n)return $B.Undefined;if("boolean"==typeof n||"number"==typeof n||"string"==typeof n)return n;if(n instanceof Number)return n.valueOf();if(Array.isArray(n)||n.__class__===_b_.list||n.__class__===_b_.tuple){for(var o=_b_.list.$factory(),l=0,x=n.length;l<x;l++)o.push($B.structuredclone2pyobj(n[l]));return o}if("object"==typeof n){for(var N in o=$B.empty_dict(),n)_b_.dict.$setitem(o,N,$B.structuredclone2pyobj(n[N]));return o}throw console.log(n,Array.isArray(n),n.__class__,_b_.list,n.__class__===_b_.list),_b_.TypeError.$factory(_b_.str.$factory(n)+" does not support the structured clone algorithm")};var JSConstructor={__class__:_b_.type,__mro__:[object],$infos:{__module__:"<javascript>",__name__:"JSConstructor"},$is_class:!0,__call__:function(n){return function(){for(var o=[null],l=0,x=arguments.length;l<x;l++)o.push(pyobj2jsobj(arguments[l]));var N=new(n.func.bind.apply(n.func,o));return $B.$JS2Py(N)}},__getattribute__:function(n,o){return"__call__"==o?function(){for(var l=[null],x=0,N=arguments.length;x<N;x++)l.push(pyobj2jsobj(arguments[x]));var U=new(n.func.bind.apply(n.func,l));return $B.$JS2Py(U)}:JSObject.__getattribute__(n,o)},$factory:function(n){return{__class__:JSConstructor,js:n,func:n.js_func}}},jsobj2pyobj=$B.jsobj2pyobj=function(n){switch(n){case!0:case!1:return n}return void 0===n?$B.Undefined:null===n?_b_.None:Array.isArray(n)?_b_.list.$factory(n.map(jsobj2pyobj)):"number"==typeof n?-1==n.toString().indexOf(".")?_b_.int.$factory(n):_b_.float.$factory(n):"kw"===n.$nat?n:$B.$isNode(n)?$B.DOMNode.$factory(n):$B.JSObj.$factory(n)},pyobj2jsobj=$B.pyobj2jsobj=function(n){if(!0===n||!1===n)return n;if(n===_b_.None)return null;if(n!==$B.Undefined){var o=$B.get_class(n);if(void 0===o)return n;if(o===JSConstructor)return void 0!==n.js_func?n.js_func:n.js;if(o===$B.DOMNode||o.__mro__.indexOf($B.DOMNode)>-1)return n;if([_b_.list,_b_.tuple].indexOf(o)>-1){var l=[];return n.forEach(function(N){l.push(pyobj2jsobj(N))}),l}if(o===_b_.dict||_b_.issubclass(o,_b_.dict)){var x={};return _b_.list.$factory(_b_.dict.items(n)).forEach(function(N){"function"==typeof N[1]&&N[1].bind(x),x[N[0]]=pyobj2jsobj(N[1])}),x}return o===_b_.float?n.valueOf():o===$B.Function||o===$B.method?function(){try{for(var N=[],U=0;U<arguments.length;U++)N.push(void 0===arguments[U]?_b_.None:jsobj2pyobj(arguments[U]));return pyobj2jsobj(n.apply(this,N))}catch(G){throw console.log(G),console.log($B.$getattr(G,"info")),console.log($B.class_name(G)+":",G.args.length>0?G.args[0]:""),G}}:n}};function pyargs2jsargs(n){for(var o=[],l=0,x=n.length;l<x;l++){var N=n[l];if(null!=N&&void 0!==N.$nat){var U=N.kw;if(Array.isArray(U)&&(U=$B.extend(js_attr.name,...U)),Object.keys(U).length>0)throw _b_.TypeError.$factory("A Javascript function can't take keyword arguments")}else o.push($B.pyobj2jsobj(N))}return o}$B.JSConstructor=JSConstructor,$B.JSObj=$B.make_class("JSObj",function(n){if(!Array.isArray(n))if("function"==typeof n)n.$is_js_func=!0;else if("number"==typeof n&&!Number.isInteger(n))return new Number(n);return n}),$B.JSObj.__sub__=function(n,o){if("bigint"==typeof n&&"bigint"==typeof o)return n-o;throw _b_.TypeError.$factory("unsupported operand type(s) for - : '"+$B.class_name(n)+"' and '"+$B.class_name(o)+"'")};var ops={"+":"__add__","*":"__mul__","**":"__pow__","%":"__mod__"};for(var op in ops)eval("$B.JSObj."+ops[op]+" = "+($B.JSObj.__sub__+"").replace(/-/g,op));$B.JSObj.__eq__=function(n,o){if("object"==typeof n){if(Object.keys(n).length!==Object.keys(o).length)return!1;for(var l in n)if(!$B.JSObj.__eq__(n[l],o[l]))return!1}return n===o},$B.JSObj.__ne__=function(n,o){return!$B.JSObj.__eq__(n,o)},$B.JSObj.__getattribute__=function(n,o){if("$$new"==o&&"function"==typeof n)return n.$js_func?function(){var G=pyargs2jsargs(arguments);return $B.JSObj.$factory(new n.$js_func(...G))}:function(){var G=pyargs2jsargs(arguments);return $B.JSObj.$factory(new n(...G))};"string"==typeof o&&(o=$B.from_alias(o));var l=n[o];if(null==l&&"function"==typeof n&&n.$js_func&&(l=n.$js_func[o]),void 0===l){if("function"==typeof n.getNamedItem&&void 0!==(U=n.getNamedItem(o)))return $B.JSObj.$factory(U);var x=$B.get_class(n);if(x&&x[o]){var N=x[o];return"function"==typeof N?function(){for(var G=[n],A=0,P=arguments.length;A<P;A++)G.push(arguments[A]);return $B.JSObj.$factory(N.apply(null,G))}:N}if("bind"==o&&"function"==typeof n.addEventListener)return function(G,A){return n.addEventListener(G,A)};throw _b_.AttributeError.$factory(o)}if("function"==typeof l){var U=function(){var G=pyargs2jsargs(arguments),A=n.$js_func||n;try{var P=l.apply(A,G)}catch(de){throw console.log("error",de),console.log("attribute",o,"of self",n,l,G,arguments),de}return void 0===P?$B.Undefined:null===P?_b_.None:$B.JSObj.$factory(P)};return U.prototype=l.prototype,U.$js_func=l,U.__mro__=[_b_.object],U.$infos={__name__:l.name,__qualname__:l.name},$B.frames_stack.length>0&&(U.$infos.__module__=$B.last($B.frames_stack)[3].__name__),$B.JSObj.$factory(U)}return $B.JSObj.$factory(l)},$B.JSObj.__setattr__=function(n,o,l){return"string"==typeof o&&(o=$B.from_alias(o)),n[o]=$B.pyobj2structuredclone(l),_b_.None},$B.JSObj.__getitem__=function(n,o){if("string"==typeof o)return $B.JSObj.__getattribute__(n,o);if("number"==typeof o){if(void 0!==n[o])return $B.JSObj.$factory(n[o]);if("number"==typeof n.length&&("number"==typeof o||"boolean"==typeof o)&&"function"==typeof n.item){var l=_b_.int.$factory(o);l<0&&(l+=n.length);var x=n.item(l);if(null===x)throw _b_.IndexError.$factory(l);return $B.JSObj.$factory(x)}}throw _b_.KeyError.$factory(l)},$B.JSObj.__setitem__=$B.JSObj.__setattr__;var JSObj_iterator=$B.make_iterator_class("JS object iterator");$B.JSObj.__iter__=function(n){var o=[];if(_window.Symbol&&void 0!==n[Symbol.iterator]){if(o=[],void 0!==n.next)for(;;){var l=n.next();if(l.done)break;o.push($B.JSObj.$factory(l.value))}else if(void 0!==n.length&&void 0!==n.item)for(var x=0;x<n.length;x++)o.push($B.JSObj.$factory(n.item(x)));return JSObj_iterator.$factory(o)}if(void 0!==n.length&&void 0!==n.item){for(x=0;x<n.length;x++)o.push($B.JSObj.$factory(n.js.item(x)));return JSObj_iterator.$factory(o)}var N=$B.JSObj.to_dict(n);return _b_.dict.__iter__(N)},$B.JSObj.__len__=function(n){if("number"==typeof n.length)return n.length;throw _b_.AttributeError.$factory(n+" has no attribute __len__")},$B.JSObj.__repr__=$B.JSObj.__str__=function(n){return"<Javascript "+n.constructor.name+" object: "+n.toString()+">"},$B.JSObj.bind=function(n,o,l){return n.addEventListener(o,function(x){return l(jsobj2pyobj(x))}),_b_.None},$B.JSObj.to_dict=function(n){return $B.structuredclone2pyobj(n)},$B.set_func_names($B.JSObj,"builtins"),$B.JSMeta=$B.make_class("JSMeta"),$B.JSMeta.__call__=function(n){for(var o=[],l=1,x=arguments.length;l<x;l++)o.push(arguments[l]);return new n.__mro__[0].$js_func(...o)},$B.JSMeta.__mro__=[_b_.type,_b_.object],$B.JSMeta.__getattribute__=function(n,o){return void 0!==n[o]?n[o]:void 0!==$B.JSMeta[o]?$B.JSMeta[o]:_b_.type.__getattribute__(n,o)},$B.JSMeta.__init_subclass__=function(){},$B.set_func_names($B.JSMeta,"builtins")}(__BRYTHON__),function(n){n.stdlib={};for(var o=["VFS_import","__future__","_abcoll","_codecs","_collections","_collections_abc","_compat_pickle","_contextvars","_csv","_dummy_thread","_frozen_importlib","_functools","_imp","_io","_markupbase","_operator","_py_abc","_pydecimal","_queue","_random","_socket","_sre","_struct","_sysconfigdata","_sysconfigdata_0_brython_","_testcapi","_thread","_threading_local","_weakref","_weakrefset","abc","antigravity","argparse","atexit","base64","bdb","binascii","bisect","browser.aio","browser.ajax","browser.highlight","browser.html","browser.indexed_db","browser.local_storage","browser.markdown","browser.object_storage","browser.session_storage","browser.svg","browser.template","browser.timer","browser.webcomponent","browser.websocket","browser.webworker","browser.worker","calendar","cmath","cmd","code","codecs","codeop","colorsys","configparser","contextlib","contextvars","copy","copyreg","csv","dataclasses","datetime","decimal","difflib","doctest","enum","errno","external_import","faulthandler","fnmatch","formatter","fractions","functools","gc","genericpath","getopt","gettext","glob","heapq","hmac","imp","inspect","interpreter","io","ipaddress","itertools","json","keyword","linecache","locale","mimetypes","nntplib","ntpath","numbers","opcode","operator","optparse","os","pathlib","pdb","pickle","pkgutil","platform","posixpath","pprint","profile","pwd","py_compile","pydoc","queue","quopri","re","reprlib","select","selectors","shlex","shutil","signal","site","site-packages.__future__","site-packages.docs","site-packages.header","site-packages.test","site-packages.test_sp","socket","sre_compile","sre_constants","sre_parse","stat","string","stringprep","struct","subprocess","sys","sysconfig","tarfile","tb","tempfile","test.namespace_pkgs.module_and_namespace_package.a_test","textwrap","this","threading","time","timeit","token","tokenize","traceback","turtle","types","typing","uu","uuid","warnings","weakref","webbrowser","zipfile","zipimport","zlib"],l=0;l<o.length;l++)n.stdlib[o[l]]=["py"];var x=["_aio","_ajax","_base64","_binascii","_io_classes","_json","_jsre","_locale","_multiprocessing","_posixsubprocess","_profile","_sre_utils","_string","_strptime","_svg","_warnings","_webcomponent","_webworker","_zlib_utils","aes","array","builtins","dis","hashlib","hmac-md5","hmac-ripemd160","hmac-sha1","hmac-sha224","hmac-sha256","hmac-sha3","hmac-sha384","hmac-sha512","long_int","marshal","math","math1","md5","modulefinder","pbkdf2","posix","rabbit","rabbit-legacy","random","rc4","ripemd160","sha1","sha224","sha256","sha3","sha384","sha512","tripledes","unicodedata"];for(l=0;l<x.length;l++)n.stdlib[x[l]]=["js"];var N=["browser.widgets","collections","concurrent","concurrent.futures","email","email.mime","encodings","html","http","importlib","logging","multiprocessing","multiprocessing.dummy","pydoc_data","site-packages.foobar","site-packages.simpleaio","site-packages.simpy","site-packages.simpy.resources","site-packages.ui","test","test.encoded_modules","test.leakers","test.namespace_pkgs.not_a_namespace_pkg.foo","test.support","test.test_email","test.test_importlib","test.test_importlib.builtin","test.test_importlib.extension","test.test_importlib.frozen","test.test_importlib.import_","test.test_importlib.source","test.test_json","test.tracedmodules","unittest","unittest.test","unittest.test.testmock","urllib"];for(l=0;l<N.length;l++)n.stdlib[N[l]]=["py",!0]}(__BRYTHON__),function($B){var _b_=$B.builtins,_window=self,module=$B.module={__class__:_b_.type,__mro__:[_b_.object],$infos:{__module__:"builtins",__name__:"module"},$is_class:!0};function parent_package(n){var o=n.split(".");return o.pop(),o.join(".")}function $download_module(n,o,l){var x=new XMLHttpRequest,N="?v="+(new Date).getTime(),U=null,G=n.__name__,A=_window.setTimeout(function(){x.abort()},5e3);if(x.open("GET",$B.$options.cache?o:o+N,!1),x.send(),$B.$CORS?U=200==x.status||0==x.status?x.responseText:_b_.ModuleNotFoundError.$factory("No module named '"+G+"'"):4==x.readyState&&(200==x.status?(U=x.responseText,n.$last_modified=x.getResponseHeader("Last-Modified")):(console.info("Error "+x.status+" means that Python module "+G+" was not found at url "+o),U=_b_.ModuleNotFoundError.$factory("No module named '"+G+"'"))),_window.clearTimeout(A),null==U)throw _b_.ModuleNotFoundError.$factory("No module named '"+G+"' (res is null)");if(U.constructor===Error)throw U;return U}function import_js(n,o){try{var l=$download_module(n,o,void 0)}catch{return null}return run_js(l,o,n),!0}function run_js(n,o,l){try{var x=new Function(n+";\nreturn $module")();$B.$options.store&&(l.$js=n)}catch(U){throw console.log(U),console.log(o,l),U}for(var N in x.__name__=l.__name__,x)"function"==typeof x[N]&&(x[N].$infos={__module__:l.__name__,__name__:N,__qualname__:N});if(void 0!==l){for(var N in x)l[N]=x[N];(x=l).__class__=module}else x.__class__=module,x.__name__=l.__name__,x.__repr__=x.__str__=function(){return $B.builtin_module_names.indexOf(l.name)>-1?"<module '"+l.__name__+"' (built-in)>":"<module '"+l.__name__+"' from "+o+" >"},"builtins"!=l.name&&(x.__file__=o);return $B.imported[l.__name__]=x,!0}function show_ns(){for(var kk=Object.keys(_window),i=0,len=kk.length;i<len;i++)console.log(kk[i]),"$"==kk[i].charAt(0)&&console.log(eval(kk[i]));console.log("---")}function import_py(n,o,l){var x=n.__name__,N=$download_module(n,o,l);if(n.$src=N,$B.imported[x].$is_package=n.$is_package,$B.imported[x].$last_modified=n.$last_modified,"/__init__.py"==o.substr(o.length-12))$B.imported[x].__package__=x,$B.imported[x].__path__=o,$B.imported[x].$is_package=n.$is_package=!0;else if(l)$B.imported[x].__package__=l;else{var U=x.split(".");U.pop(),$B.imported[x].__package__=U.join(".")}return $B.imported[x].__file__=o,run_py(N,o,n)}function run_py(module_contents,path,module,compiled){$B.file_cache[path]=module_contents;var root,js,mod_name=module.__name__;if(!compiled){var $Node=$B.$Node,$NodeJSCtx=$B.$NodeJSCtx;$B.$py_module_path[module.__name__]=path;var src={src:module_contents,has_annotations:!1};root=$B.py2js(src,module,module.__name__,$B.builtins_scope),void 0!==module.__package__&&(root.binding.__package__=!0)}try{js=compiled?module_contents:root.to_js(),10==$B.$options.debug&&(console.log("code for module "+module.__name__),console.log(js));var src=js;js="var $module = (function(){\n"+js+"return $locals_"+module.__name__.replace(/\./g,"_")+"})(__BRYTHON__)\nreturn $module";var module_id="$locals_"+module.__name__.replace(/\./g,"_"),$module=new Function(module_id,js)(module)}catch(n){for(var attr in console.log(n+" for module "+module.__name__),console.log("module",module),console.log(root),$B.debug>1&&console.log(js),n)console.log(attr,n[attr]);throw console.log(_b_.getattr(n,"info","[no info]")),console.log("message: "+n.$message),console.log("filename: "+n.fileName),console.log("linenum: "+n.lineNumber),$B.debug>0&&console.log("line info "+$B.line_info),n}finally{$B.clear_ns(module.__name__)}try{var mod=eval("$module");for(var attr in mod)module[attr]=mod[attr];return module.__initializing__=!1,$B.imported[module.__name__]=module,{content:src,name:mod_name,imports:Object.keys(root.imports).join(",")}}catch(n){for(var attr in console.log(n+"  for module "+module.__name__),n)console.log(attr+" "+n[attr]);throw $B.debug>0&&console.log("line info "+__BRYTHON__.line_info),n}}function new_spec(n){return n.__class__=module,n}module.__init__=function(){},module.__new__=function(n,o,l,x){return{__class__:n,__name__:o,__doc__:l||_b_.None,__package__:x||_b_.None}},module.__repr__=module.__str__=function(n){var o="<module "+n.__name__;return void 0===n.__file__&&(o+=" (built-in)"),o+">"},module.__setattr__=function(n,o,l){"__builtins__"==n.__name__?$B.builtins[o]=l:n[o]=l},module.$factory=function(n,o,l){return{__class__:module,__name__:n,__doc__:o||_b_.None,__package__:l||_b_.None}},$B.set_func_names(module,"builtins"),$B.$download_module=$download_module,$B.run_py=run_py;var finder_VFS={__class__:_b_.type,__mro__:[_b_.object],$infos:{__module__:"builtins",__name__:"VFSFinder"},create_module:function(n,o){return _b_.None},exec_module:function(n,o){var l=o.__spec__.loader_state.stored,x=o.__spec__.loader_state.timestamp;delete o.__spec__.loader_state;var N=l[0],U=l[1];o.$is_package=l[3]||!1;var G="VFS."+o.__name__;if(o.__file__=G+=o.$is_package?"/__init__.py":N,$B.file_cache[o.__file__]=$B.VFS[o.__name__][1],".js"==N)run_js(U,o.__path__,o);else{if($B.precompiled.hasOwnProperty(o.__name__)){$B.debug>1&&console.info("load",o.__name__,"from precompiled");for(var A=o.__name__.split("."),P=0;P<A.length;P++){var de=A.slice(0,P+1).join(".");if(!$B.imported.hasOwnProperty(de)||!$B.imported[de].__initialized__){var be=$B.precompiled[de],te=o.$is_package;Array.isArray(be)&&(be=be[0]);var ce=$B.imported[de]=module.$factory(de,void 0,te);ce.__initialized__=!0,te?(ce.__path__="<stdlib>",ce.__package__=de):((B=de.split(".")).pop(),ce.__package__=B.join(".")),ce.__file__=G;try{var fe=de.replace(/\./g,"_");be+="return $locals_"+fe;var _e=new Function("$locals_"+fe,be)(ce)}catch(ee){if($B.debug>1){for(var le in console.log(ee),ee)console.log(le,ee[le]);console.log(Object.keys($B.imported)),$B.debug>2&&console.log(o,"mod_js",be)}throw ee}for(var pe in _e)ce[pe]=_e[pe];_e.__file__=G,P>0&&$B.builtins.setattr($B.imported[A.slice(0,P).join(".")],A[P],_e)}}return _e}var T=o.__name__;$B.debug>1&&console.log("run Python code from VFS",T);var B,q=run_py(U,o.__path__,o);q.is_package=o.$is_package,q.timestamp=$B.timestamp,q.source_ts=x,$B.precompiled[T]=q.is_package?[q.content]:q.content,(B=T.split(".")).length>1&&B.pop(),$B.$options.indexedDB&&self.indexedDB&&$B.idb_name&&(indexedDB.open($B.idb_name).onsuccess=function(ee){var F=ee.target.result.transaction("modules","readwrite").objectStore("modules"),Be=(F.openCursor(),F.put(q));Be.onsuccess=function(){$B.debug>1&&console.info(o.__name__,"stored in db")},Be.onerror=function(){console.info("could not store "+o.__name__)}})}},find_module:function(n,o,l){return{__class__:Loader,load_module:function(x,N){var U=n.find_spec(n,x,N),G=module.$factory(x);$B.imported[x]=G,G.__spec__=U,n.exec_module(n,G)}}},find_spec:function(n,o,l,x){var N,U,G;return $B.use_VFS?void 0===(N=$B.VFS[o])?_b_.None:(U=N[3]||!1,G=N.timestamp,N?new_spec({name:o,loader:n,origin:$B.builtin_module_names.indexOf(o)>-1?"built-in":"brython_stdlib",submodule_search_locations:U?[]:_b_.None,loader_state:{stored:N,timestamp:G},cached:_b_.None,parent:U?o:parent_package(o),has_location:_b_.False}):void 0):_b_.None}};for(var method in $B.set_func_names(finder_VFS,"<import>"),finder_VFS)"function"==typeof finder_VFS[method]&&(finder_VFS[method]=_b_.classmethod.$factory(finder_VFS[method]));finder_VFS.$factory=function(){return{__class__:finder_VFS}};var finder_cpython={__class__:_b_.type,__mro__:[_b_.object],$infos:{__module__:"builtins",__name__:"CPythonFinder"},create_module:function(n,o){return _b_.None},exec_module:function(n,o){console.log("exec PYthon module",o);var l=o.__spec__.loader_state,x=l.content;delete o.__spec__.loader_state,o.$is_package=l.is_package,o.__file__=l.__file__,$B.file_cache[o.__file__]=x,$B.debug>1&&console.log("run Python code from CPython",o.__name__),run_py(x,o.__path__,o)},find_module:function(n,o,l){return{__class__:Loader,load_module:function(x,N){var U=n.find_spec(n,x,N),G=module.$factory(x);$B.imported[x]=G,G.__spec__=U,n.exec_module(n,G)}}},find_spec:function(n,o,l,x){console.log("finder cpython",o);var N,U=new XMLHttpRequest;return U.open("GET","/cpython_import?module="+o,!1),U.onreadystatechange=function(){if(4==this.readyState&&200==this.status){var A=JSON.parse(this.responseText);N=new_spec({name:o,loader:n,origin:"CPython",submodule_search_locations:A.is_package?[]:_b_.None,loader_state:{content:A.content},cached:_b_.None,parent:A.is_package?o:parent_package(o),has_location:_b_.False})}},U.send(),N}};for(var method in $B.set_func_names(finder_cpython,"<import>"),finder_cpython)"function"==typeof finder_cpython[method]&&(finder_cpython[method]=_b_.classmethod.$factory(finder_cpython[method]));finder_cpython.$factory=function(){return{__class__:finder_cpython}};var finder_stdlib_static={$factory:finder_stdlib_static,__class__:_b_.type,__mro__:[_b_.object],$infos:{__module__:"builtins",__name__:"StdlibStatic"},create_module:function(n,o){return _b_.None},exec_module:function(n,o){var l=o.__spec__.loader_state;o.$is_package=l.is_package,"py"==l.ext?import_py(o,l.path,o.__package__):import_js(o,l.path),delete o.__spec__.loader_state},find_module:function(n,o,l){var x=n.find_spec(n,o,l);return x===_b_.None?_b_.None:{__class__:Loader,load_module:function(N,U){var G=module.$factory(N);$B.imported[N]=G,G.__spec__=x,G.__package__=x.parent,n.exec_module(n,G)}}},find_spec:function(n,o,l,x){if($B.stdlib&&$B.$options.static_stdlib_import){var N=$B.stdlib[o];if(void 0===N){var U=o.split(".");if(U.length>1){U.pop();var G=$B.stdlib[U.join(".")];G&&G[1]&&(N=["py"])}}if(void 0!==N){var A=N[0],P=void 0!==N[1],de={ext:A,is_package:P,path:(l=$B.brython_path+("py"==A?"Lib/":"libs/")+o.replace(/\./g,"/"))+(P?"/__init__.py":"py"==A?".py":".js"),address:N};return new_spec({name:o,loader:n,origin:de.path,submodule_search_locations:P?[l]:_b_.None,loader_state:de,cached:_b_.None,parent:P?o:parent_package(o),has_location:_b_.True})}}return _b_.None}};for(var method in $B.set_func_names(finder_stdlib_static,"<import>"),finder_stdlib_static)"function"==typeof finder_stdlib_static[method]&&(finder_stdlib_static[method]=_b_.classmethod.$factory(finder_stdlib_static[method]));finder_stdlib_static.$factory=function(){return{__class__:finder_stdlib_static}};var finder_path={__class__:_b_.type,__mro__:[_b_.object],$infos:{__module__:"builtins",__name__:"ImporterPath"},create_module:function(n,o){return _b_.None},exec_module:function(n,o){var l=$B.$getattr(o,"__spec__"),x=l.loader_state.code;o.$is_package=l.loader_state.is_package,delete l.loader_state.code;var N=l.loader_state.type;"py"==N||"pyc.js"==N?run_py(x,l.origin,o,"pyc.js"==N):"js"==l.loader_state.type&&run_js(x,l.origin,o)},find_module:function(n,o,l){return finder_path.find_spec(n,o,l)},find_spec:function(n,o,l,x){var N=$B.last($B.frames_stack)[2];if($B.VFS&&$B.VFS[N])return _b_.None;$B.is_none(l)&&(l=$B.path);for(var U=0,G=l.length;U<G;++U){var A=l[U];"/"!=A[A.length-1]&&(A+="/");var P=$B.path_importer_cache[A];if(void 0===P){for(var de=!0,be=0,te=$B.path_hooks.length;be<te&&de;++be){var ce=$B.path_hooks[be].$factory;try{P=("function"==typeof ce?ce:$B.$getattr(ce,"__call__"))(A),de=!1}catch(le){if(le.__class__!==_b_.ImportError)throw le}}de&&($B.path_importer_cache[A]=_b_.None)}if(!$B.is_none(P)){var fe=$B.$getattr(P,"find_spec"),_e=("function"==typeof fe?fe:$B.$getattr(fe,"__call__"))(o,x);if(!$B.is_none(_e))return _e}}return _b_.None}};for(var method in $B.set_func_names(finder_path,"<import>"),finder_path)"function"==typeof finder_path[method]&&(finder_path[method]=_b_.classmethod.$factory(finder_path[method]));finder_path.$factory=function(){return{__class__:finder_path}};var url_hook={__class__:_b_.type,__mro__:[_b_.object],__repr__:function(n){return"<UrlPathFinder"+(n.hint?" for '"+n.hint+"'":"(unbound)")+" at "+n.path_entry+">"},$infos:{__module__:"builtins",__name__:"UrlPathFinder"},find_spec:function(n,o,l){var x={},N=!0,U=n.hint,G=n.path_entry+o.match(/[^.]+$/g)[0],A=[];(void 0===U||"py"==U)&&(A=A.concat([[G+".py","py",!1],[G+"/__init__.py","py",!0]]));for(var P=0;N&&P<A.length;++P)try{var de=A[P];x.code=$download_module({__name__:o,$is_package:!1},de[0],void 0),N=!1,x.type=de[1],x.is_package=de[2],void 0===U&&(n.hint=de[1],$B.path_importer_cache[n.path_entry]=n),x.is_package&&($B.path_importer_cache[G+"/"]=url_hook.$factory(G+"/",n.hint)),x.path=de[0]}catch{}return N?_b_.None:new_spec({name:o,loader:finder_path,origin:x.path,submodule_search_locations:x.is_package?[G]:_b_.None,loader_state:x,cached:_b_.None,parent:x.is_package?o:parent_package(o),has_location:_b_.True})},invalidate_caches:function(n){},$factory:function(n,o){return{__class__:url_hook,path_entry:n.endsWith("/")?n:n+"/",hint:o}}};$B.set_func_names(url_hook,"<import>"),$B.path_importer_cache={};for(var _sys_paths=[[$B.script_dir+"/","py"],[$B.brython_path+"Lib/","py"],[$B.brython_path+"Lib/site-packages/","py"],[$B.brython_path+"libs/","js"]],i=0;i<_sys_paths.length;++i){var _path=_sys_paths[i],_type=_path[1];_path=_path[0],$B.path_importer_cache[_path]=url_hook.$factory(_path,_type)}function import_error(n){var o=_b_.ImportError.$factory(n);throw o.name=n,o}function optimize_import_for_path(n,o){"/"!=n.slice(-1)&&(n+="/");var l="none"==o?_b_.None:url_hook.$factory(n,o);$B.path_importer_cache[n]=l}$B.$__import__=function(n,o,l,x,N){var U=!1;if(o.$jsobj&&o.$jsobj.__file__){var G=o.$jsobj.__file__;(G.startsWith($B.brython_path+"Lib/")&&!G.startsWith($B.brython_path+"Lib/site-packages/")||G.startsWith($B.brython_path+"libs/")||G.startsWith("VFS."))&&(U=!0)}var A=$B.imported[n],P=n.split("."),de=x.length>0;if(A==_b_.None&&import_error(n),void 0===A){$B.is_none(x)&&(x=[]);for(var be=0,te="",ce="",fe=P.length-1,_e=_b_.None;be<=fe;++be){var le=ce;if(ce+=te+P[be],te=".",(A=$B.imported[ce])==_b_.None)import_error(ce);else if(void 0===A){try{$B.import_hooks(ce,_e,U)}catch(T){throw delete $B.imported[ce],T}$B.is_none($B.imported[ce])?import_error(ce):le&&_b_.setattr($B.imported[le],P[be],$B.imported[ce])}else $B.imported[le]&&void 0===$B.imported[le][P[be]]&&_b_.setattr($B.imported[le],P[be],$B.imported[ce]);if(be<fe)try{_e=$B.$getattr($B.imported[ce],"__path__")}catch{if(be==fe-1&&$B.imported[ce][P[fe]]&&$B.imported[ce][P[fe]].__class__===module)return $B.imported[ce][P[fe]];if(!de){var pe=_b_.ModuleNotFoundError.$factory();throw pe.msg="No module named '"+n+"'; '"+ce+"' is not a package",pe.args=$B.fast_tuple([pe.msg]),pe.name=n,pe.path=_b_.None,pe}import_error(n)}}}else if($B.imported[P[0]]&&2==P.length)try{void 0===$B.imported[P[0]][P[1]]&&$B.$setattr($B.imported[P[0]],P[1],A)}catch(T){throw console.log("error",P,A),T}return x.length>0?$B.imported[n]:$B.imported[P[0]]},$B.$import=function(n,o,l,x){o=void 0===o?[]:o,l=void 0===l?{}:l,x=void 0===x?{}:x;var N=n.split(".");"."==n[n.length-1]&&N.pop();for(var U=[],G=!0,A=0,P=N.length;A<P;A++){var de=N[A];if(G&&""==de){if(elt=U.pop(),void 0===elt)throw _b_.ImportError.$factory("Parent module '' not loaded, cannot perform relative import")}else G=!1,U.push("$$"==de.substr(0,2)?de.substr(2):de)}n=U.join("."),10==$B.$options.debug&&(console.log("$import "+n),console.log("use VFS ? "+$B.use_VFS),console.log("use static stdlib paths ? "+$B.static_stdlib_import));var be=$B.frames_stack[$B.frames_stack.length-1],te=be[3],ce=te.__import__,fe=$B.obj_dict(te);void 0===ce&&(ce=$B.$__import__);var _e=("function"==typeof ce?ce:$B.$getattr(ce,"__call__"))(n,fe,void 0,o,0);if(o&&0!=o.length){var le=o,pe={};if(o&&"*"==o[0]&&(le=$B.$getattr(_e,"__all__",pe))!==pe&&(l={}),le===pe)for(var T in _e)"_"!==T[0]&&(x[T]=_e[T]);else{A=0;for(var B=le.length;A<B;++A){var q=le[A],ee=l[q]||q;try{x[ee]=$B.$getattr(_e,q)}catch{try{var F=$B.from_alias(q);$B.$getattr(ce,"__call__")(n+"."+F,fe,void 0,[],0),x[ee]=$B.$getattr(_e,F)}catch(Fe){if("__future__"===n){var Be=$B.last($B.frames_stack),K=Be[3].$line_info.split(","),ve=parseInt(K[0]);$B.$SyntaxError(Be[2],"future feature "+q+" is not defined",be[3].src,void 0,ve)}throw Fe.$py_error?(Fe.__class__!==_b_.ImportError&&Fe.__class__!==_b_.ModuleNotFoundError&&$B.handle_error(Fe),_b_.ImportError.$factory("cannot import name '"+q+"'")):($B.debug>1&&(console.log(Fe),console.log($B.last($B.frames_stack))),_b_.ImportError.$factory("cannot import name '"+q+"'"))}}}}return x}(ee=l[n])?x[ee]=$B.imported[n]:x[$B.to_alias(U[0])]=_e},$B.import_all=function(n,o){for(var l in o)(l.startsWith("$$")||-1=="_$".indexOf(l.charAt(0)))&&(n[l]=o[l])},$B.$path_hooks=[url_hook],$B.$meta_path=[finder_VFS,finder_stdlib_static,finder_path],$B.finders={VFS:finder_VFS,stdlib_static:finder_stdlib_static,path:finder_path,CPython:finder_cpython};var Loader={__class__:$B.$type,__mro__:[_b_.object],__name__:"Loader"},_importlib_module={__class__:module,__name__:"_importlib",Loader,VFSFinder:finder_VFS,StdlibStatic:finder_stdlib_static,ImporterPath:finder_path,UrlPathFinder:url_hook,optimize_import_for_path};_importlib_module.__repr__=_importlib_module.__str__=function(){return"<module '_importlib' (built-in)>"},$B.imported._importlib=_importlib_module}(__BRYTHON__),function($B){var bltns=$B.InjectBuiltins();eval(bltns);var object=_b_.object;function $err(n,o){var l="unsupported operand type(s) for "+n+": 'float' and '"+$B.class_name(o)+"'";throw _b_.TypeError.$factory(l)}function float_value(n){return void 0!==n.$brython_value?n.$brython_value:n}var float={__class__:_b_.type,__dir__:object.__dir__,$infos:{__module__:"builtins",__name__:"float"},$is_class:!0,$native:!0,$descriptors:{numerator:!0,denominator:!0,imag:!0,real:!0}};function preformat(n,o){if(o.empty)return _b_.str.$factory(n);if(o.type&&-1=="eEfFgGn%".indexOf(o.type))throw _b_.ValueError.$factory("Unknown format code '"+o.type+"' for object of type 'float'");if(isNaN(n))return"f"==o.type||"g"==o.type?"nan":"NAN";if(n==Number.POSITIVE_INFINITY)return"f"==o.type||"g"==o.type?"inf":"INF";if(void 0===o.precision&&void 0!==o.type&&(o.precision=6),"%"==o.type&&(n*=100),"e"==o.type){var l=n.toExponential(o.precision),x=parseInt(l.substr(l.search("e")+1));return Math.abs(x)<10&&(l=l.substr(0,l.length-1)+"0"+l.charAt(l.length-1)),l}if(void 0!==o.precision){var N=o.precision;if(0==N)return Math.round(n)+"";var U=(l=n.toFixed(N)).indexOf(".");if(void 0===o.type||"%"!=o.type&&"f"!=o.type.toLowerCase()){if(o.type&&"g"==o.type.toLowerCase()){var G=preformat(n,{type:"e"}).split("e"),A=(l=-4<=(x=parseInt(G[1]))&&x<o.precision?preformat(n,{type:"f",precision:o.precision-1-x}):preformat(n,{type:"e",precision:o.precision-1})).split("e");if(o.alternate)-1==A[0].search(/\./)&&(A[0]+=".");else if(A[1]){for(var P=A[0];P.endsWith("0");)P=P.substr(0,P.length-1);P.endsWith(".")&&(P=P.substr(0,P.length-1)),A[0]=P}return l=A.join("e"),"G"==o.type&&(l=l.toUpperCase()),l}if(void 0===o.type)o.type="g",l=preformat(n,o),o.type=void 0;else{var de=n.toExponential(o.precision-1);if((x=parseInt(de.substr(de.search("e")+1)))<-4||x>=o.precision-1){for(var be=de.split("e");be[0].endsWith("0");)be[0]=be[0].substr(0,be[0].length-1);l=be.join("e")}}}else if(-1==U)l+="."+"0".repeat(o.precision);else{var te=o.precision-l.length+U+1;te>0&&(l+="0".repeat(te))}}else l=_b_.str.$factory(n);if(void 0===o.type||-1!="gGn".indexOf(o.type)){if(-1==l.search("e"))for(;"0"==l.charAt(l.length-1);)l=l.substr(0,l.length-1);"."==l.charAt(l.length-1)&&(void 0===o.type?l+="0":l=l.substr(0,l.length-1))}return void 0!==o.sign&&(" "==o.sign||"+"==o.sign)&&n>0&&(l=o.sign+l),"%"==o.type&&(l+="%"),l}float.numerator=function(n){return float_value(n)},float.denominator=function(n){return _b_.int.$factory(1)},float.imag=function(n){return _b_.int.$factory(0)},float.real=function(n){return float_value(n)},float.__float__=function(n){return float_value(n)},float.as_integer_ratio=function(n){if((n=float_value(n)).valueOf()==Number.POSITIVE_INFINITY||n.valueOf()==Number.NEGATIVE_INFINITY)throw _b_.OverflowError.$factory("Cannot pass infinity to float.as_integer_ratio.");if(!Number.isFinite(n.valueOf()))throw _b_.ValueError.$factory("Cannot pass NaN to float.as_integer_ratio.");for(var o=_b_.$frexp(n.valueOf()),l=o[0],x=o[1],N=0;N<300&&l!=Math.floor(l);N++)l*=2,x--;return numerator=float.$factory(l),py_exponent=abs(x),denominator=1,py_exponent=_b_.getattr(_b_.int.$factory(denominator),"__lshift__")(py_exponent),x>0?numerator*=py_exponent:denominator=py_exponent,_b_.tuple.$factory([_b_.int.$factory(numerator),_b_.int.$factory(denominator)])},float.__bool__=function(n){return n=float_value(n),_b_.bool.$factory(n.valueOf())},float.__eq__=function(n,o){return n=float_value(n),o=float_value(o),(!isNaN(n)||!isNaN(o))&&(isinstance(o,_b_.int)?n==o:isinstance(o,float)?n.valueOf()==o.valueOf():isinstance(o,_b_.complex)?0==o.$imag&&n==o.$real:_b_.NotImplemented)},float.__floordiv__=function(n,o){if(n=float_value(n),o=float_value(o),isinstance(o,[_b_.int,float])){if(0==o.valueOf())throw ZeroDivisionError.$factory("division by zero");return float.$factory(Math.floor(n/o))}if(hasattr(o,"__rfloordiv__"))return getattr(o,"__rfloordiv__")(n);$err("//",o)},float.fromhex=function(n){if(!isinstance(n,_b_.str))throw _b_.ValueError.$factory("argument must be a string");var o,l=n.trim();switch(l.toLowerCase()){case"+inf":case"inf":case"+infinity":case"infinity":return $FloatClass(1/0);case"-inf":case"-infinity":return $FloatClass(-1/0);case"+nan":case"nan":return $FloatClass(Number.NaN);case"-nan":return $FloatClass(-Number.NaN);case"":throw _b_.ValueError.$factory("could not convert string to float")}if(null!==(o=/^(\d*\.?\d*)$/.exec(l)))return $FloatClass(parseFloat(o[1]));if(null==(o=/^(\+|-)?(0x)?([0-9A-F]+\.?)?(\.[0-9A-F]+)?(p(\+|-)?\d+)?$/i.exec(l)))throw _b_.ValueError.$factory("invalid hexadecimal floating-point string");var x=o[1],N=parseInt(o[3]||"0",16),U=o[4]||".0",G=o[5]||"p0";x="-"==x?-1:1;for(var A=N,P=1,de=U.length;P<de;P++)A+=parseInt(U.charAt(P),16)/Math.pow(16,P);return new Number(x*A*Math.pow(2,parseInt(G.substring(1))))},float.__getformat__=function(n){if("double"==n||"float"==n)return"IEEE, little-endian";throw _b_.ValueError.$factory("__getformat__() argument 1 must be 'double' or 'float'")},float.__format__=function(n,o){n=float_value(n);var l=new $B.parse_format_spec(o);l.align=l.align||">";var x=preformat(n,l).split("."),N=x[0];if(l.comma){for(var U=N.length,G=Math.ceil(N.length/3),A=[],P=0;P<G;P++)A.push(N.substring(U-3*P-3,U-3*P));A.reverse(),x[0]=A.join(",")}return $B.format_width(x.join("."),l)},float.__hash__=function(n){if(void 0===n)return float.__hashvalue__||$B.$py_next_hash--;var o=n.valueOf();if(o===1/0)return 314159;if(o===-1/0)return-271828;if(isNaN(o))return 0;if(o==Math.round(o))return Math.round(o);var l=_b_.$frexp(o);l[0]*=Math.pow(2,31);var x=_b_.int.$factory(l[0]);return l[0]=(l[0]-x)*Math.pow(2,31),4294967295&x+_b_.int.$factory(l[0])+(l[1]<<15)},_b_.$isninf=function(n){var o=n;return isinstance(n,float)&&(o=n.valueOf()),o==-1/0||o==Number.NEGATIVE_INFINITY},_b_.$isinf=function(n){var o=n;return isinstance(n,float)&&(o=n.valueOf()),o==1/0||o==-1/0||o==Number.POSITIVE_INFINITY||o==Number.NEGATIVE_INFINITY},_b_.$fabs=function(n){return float.$factory(n>0?n:-n)},_b_.$frexp=function(n){var o=n;if(isinstance(n,float)&&(o=n.valueOf()),isNaN(o)||_b_.$isinf(o))return[o,-1];if(0==o)return[0,0];var l=1,x=0,N=o;for(N<0&&(l=-l,N=-N);N<.5;)N*=2,x--;for(;N>=1;)N*=.5,x++;return[N*=l,x]},_b_.$ldexp=function(n,o){if(_b_.$isninf(n))return float.$factory("-inf");if(_b_.$isinf(n))return float.$factory("inf");var l=n;if(isinstance(n,float)&&(l=n.valueOf()),0==l)return l;var x=o;return isinstance(o,float)&&(x=o.valueOf()),l*Math.pow(2,x)},float.hex=function(n){switch((n=float_value(n)).valueOf()){case 1/0:case-1/0:case Number.NaN:case-Number.NaN:return n;case-0:return"-0x0.0p0";case 0:return"0x0.0p0"}var o=_b_.$frexp(_b_.$fabs(n.valueOf())),l=o[0],x=o[1],N=1-Math.max(-1021-x,0);l=_b_.$ldexp(l,N),x-=N;var U="0123456789ABCDEF".split(""),G=U[Math.floor(l)];G+=".",l-=Math.floor(l);for(var A=0;A<13;A++)l*=16,G+=U[Math.floor(l)],l-=Math.floor(l);var P="+";return x<0&&(P="-",x=-x),n.value<0?"-0x"+G+"p"+P+x:"0x"+G+"p"+P+x},float.__init__=function(n,o){return _b_.None},float.__int__=function(n){return parseInt(n)},float.is_integer=function(n){return _b_.int.$factory(n)==n},float.__mod__=function(n,o){if(n=float_value(n),0==(o=float_value(o)))throw ZeroDivisionError.$factory("float modulo");if(isinstance(o,_b_.int))return new Number((n%o+o)%o);if(isinstance(o,float)){var l=Math.floor(n/o);return new Number(n-o*l)}if(isinstance(o,_b_.bool)){var x=0;return o.valueOf()&&(x=1),new Number((n%x+x)%x)}if(hasattr(o,"__rmod__"))return getattr(o,"__rmod__")(n);$err("%",o)},float.__mro__=[object],float.__mul__=function(n,o){if(n=float_value(n),o=float_value(o),isinstance(o,_b_.int))return new Number(o.__class__==$B.long_int?n*parseFloat(o.value):n*o);if(isinstance(o,float))return new Number(n*float_value(o));if(isinstance(o,_b_.bool)){var l=0;return o.valueOf()&&(l=1),new Number(n*l)}return isinstance(o,_b_.complex)?$B.make_complex(float.$factory(n*o.$real),float.$factory(n*o.$imag)):hasattr(o,"__rmul__")?getattr(o,"__rmul__")(n):void $err("*",o)},float.__ne__=function(n,o){var l=float.__eq__(n,o);return l===_b_.NotImplemented?l:!l},float.__neg__=function(n,o){return float.$factory(-float_value(n))},float.__new__=function(n,o){if(void 0===n)throw _b_.TypeError.$factory("float.__new__(): not enough arguments");if(!_b_.isinstance(n,_b_.type))throw _b_.TypeError.$factory("float.__new__(X): X is not a type object");return n===float?float.$factory(o):{__class__:n,__dict__:$B.empty_dict(),$brython_value:o||0}},float.__pos__=function(n){return float_value(n)},float.__pow__=function(n,o){if(n=float_value(n),o=float_value(o),isinstance(o,_b_.int)||isinstance(o,float)){if(1==n)return n;if(0==o)return new Number(1);if(!(-1!=n||isFinite(o)&&o.__class__!==$B.long_int&&$B.is_safe_int(o)||isNaN(o)))return new Number(1);if(0==n&&isFinite(o)&&o<0)throw _b_.ZeroDivisionError.$factory("0.0 cannot be raised to a negative power");return n!=Number.NEGATIVE_INFINITY||isNaN(o)?n!=Number.POSITIVE_INFINITY||isNaN(o)?o!=Number.NEGATIVE_INFINITY||isNaN(n)?o!=Number.POSITIVE_INFINITY||isNaN(n)?n<0&&!_b_.getattr(o,"__eq__")(_b_.int.$factory(o))?_b_.complex.__pow__($B.make_complex(n,0),o):float.$factory(Math.pow(n,o)):Math.abs(n)<1?new Number(0):Number.POSITIVE_INFINITY:Math.abs(n)<1?Number.POSITIVE_INFINITY:new Number(0):o>0?n:new Number(0):o<0&&o%2==1?new Number(-0):o<0?new Number(0):o>0&&o%2==1?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY}if(isinstance(o,_b_.complex)){var l=Math.pow(n,o.$real),x=Math.log(n);return $B.make_complex(l*Math.cos(x),l*Math.sin(x))}if(hasattr(o,"__rpow__"))return getattr(o,"__rpow__")(n);$err("** or pow()",o)},float.__repr__=float.__str__=function(n){if((n=float_value(n)).valueOf()==1/0)return"inf";if(n.valueOf()==-1/0)return"-inf";if(isNaN(n.valueOf()))return"nan";var o,l,x=n.valueOf()+"";if(-1==x.indexOf(".")&&(x+=".0"),[o,l]=x.split("."),o.length>16){for(var N=o.length-1,U=o[0],G=o.substr(1)+l;G.endsWith("0");)G=G.substr(0,G.length-1);var A=U;return G.length>0&&(A+="."+G),A+"e+"+N}if("0"==o){for(N=0;N<l.length&&"0"==l.charAt(N);)N++;if(N>3){var P=l.substr(N);for(N=(N+1).toString();P.endsWith("0");)P=P.substr(0,x.length-1);return A=P[0],P.length>1&&(A+="."+P.substr(1)),1==N.length&&(N="0"+N),A+"e-"+N}}return _b_.str.$factory(x)},float.__setattr__=function(n,o,l){if(n.constructor===Number)throw void 0===float[o]?_b_.AttributeError.$factory("'float' object has no attribute '"+o+"'"):_b_.AttributeError.$factory("'float' object attribute '"+o+"' is read-only");return n[o]=l,_b_.None},float.__truediv__=function(n,o){if(n=float_value(n),o=float_value(o),isinstance(o,[_b_.int,float])){if(0==o.valueOf())throw ZeroDivisionError.$factory("division by zero");return float.$factory(n/o)}if(isinstance(o,_b_.complex)){var l=o.$real*o.$real+o.$imag*o.$imag;if(0==l)throw ZeroDivisionError.$factory("division by zero");return $B.make_complex(float.$factory(n*o.$real/l),float.$factory(-n*o.$imag/l))}if(hasattr(o,"__rtruediv__"))return getattr(o,"__rtruediv__")(n);$err("/",o)};var $op_func=function(n,o){if(n=float_value(n),o=float_value(o),isinstance(o,_b_.int))return"boolean"==typeof o?o?n-1:n:float.$factory(o.__class__===$B.long_int?n-parseInt(o.value):n-o);if(isinstance(o,float))return float.$factory(n-o);if(isinstance(o,_b_.bool)){var l=0;return o.valueOf()&&(l=1),float.$factory(n-l)}return isinstance(o,_b_.complex)?$B.make_complex(n-o.$real,-o.$imag):hasattr(o,"__rsub__")?getattr(o,"__rsub__")(n):void $err("-",o)};$op_func+="";var $ops={"+":"add","-":"sub"};for(var $op in $ops){var $opf=$op_func.replace(/-/gm,$op);$opf=$opf.replace(/__rsub__/gm,"__r"+$ops[$op]+"__"),eval("float.__"+$ops[$op]+"__ = "+$opf)}var $comp_func=function(n,o){if(n=float_value(n),o=float_value(o),isinstance(o,_b_.int))return o.__class__===$B.long_int?n>parseInt(o.value):n>o.valueOf();if(isinstance(o,float))return n>o;if(isinstance(o,_b_.bool))return n.valueOf()>_b_.bool.__hash__(o);if(hasattr(o,"__int__")||hasattr(o,"__index__"))return _b_.int.__gt__(n,$B.$GetInt(o));var l=getattr(o,"__le__",None);if(l!==None)return l(n);throw _b_.TypeError.$factory("unorderable types: float() > "+$B.class_name(o)+"()")};for(var $op in $comp_func+="",$B.$comps)eval("float.__"+$B.$comps[$op]+"__ = "+$comp_func.replace(/>/gm,$op).replace(/__gt__/gm,"__"+$B.$comps[$op]+"__").replace(/__le__/,"__"+$B.$inv_comps[$op]+"__"));$B.make_rmethods(float);var $notimplemented=function(n,o){throw _b_.TypeError.$factory("unsupported operand types for OPERATOR: 'float' and '"+$B.class_name(o)+"'")};for(var $op in $notimplemented+="",$B.$operators)if(void 0===$B.augmented_assigns[$op]){var $opfunc="__"+$B.$operators[$op]+"__";void 0===float[$opfunc]&&eval("float."+$opfunc+"="+$notimplemented.replace(/OPERATOR/gm,$op))}function $FloatClass(n){return new Number(n)}function to_digits(n){for(var o="",l=0;l<n.length;l++){var x="\u0660\u0661\u0662\u0663\u0664\u0665\u0666\u0667\u0668\u0669".indexOf(n[l]);o+=x>-1?x:n[l]}return o}float.$factory=function(value){switch(value){case void 0:return $FloatClass(0);case Number.MAX_VALUE:return $FloatClass(1/0);case-Number.MAX_VALUE:return $FloatClass(-1/0);case!0:return new Number(1);case!1:return new Number(0)}if("number"==typeof value)return new Number(value);if(isinstance(value,float))return float_value(value);if(isinstance(value,bytes)){var s=getattr(value,"decode")("latin-1");return float.$factory(getattr(value,"decode")("latin-1"))}if("string"==typeof value)switch(value=value.trim(),value.toLowerCase()){case"+inf":case"inf":case"+infinity":case"infinity":return Number.POSITIVE_INFINITY;case"-inf":case"-infinity":return Number.NEGATIVE_INFINITY;case"+nan":case"nan":return Number.NaN;case"-nan":return-Number.NaN;case"":throw _b_.ValueError.$factory("count not convert string to float");default:if(value=value.charAt(0)+value.substr(1).replace(/_/g,""),value=to_digits(value),isFinite(value))return $FloatClass(eval(value));throw _b_.str.encode(value,"latin-1"),_b_.ValueError.$factory("Could not convert to float(): '"+_b_.str.$factory(value)+"'")}var klass=value.__class__||$B.get_class(value),num_value=$B.to_num(value,["__float__","__index__"]);if(null!==num_value)return num_value;throw _b_.TypeError.$factory("float() argument must be a string or a number, not '"+$B.class_name(value)+"'")},$B.$FloatClass=$FloatClass,$B.set_func_names(float,"builtins");var FloatSubclass=$B.FloatSubclass={__class__:_b_.type,__mro__:[object],$infos:{__module__:"builtins",__name__:"float"},$is_class:!0};for(var $attr in float)"function"==typeof float[$attr]&&(FloatSubclass[$attr]=function(n){return function(){var o=[],l=0;if(arguments.length>0){o=[arguments[0].valueOf()],l=1;for(var x=1,N=arguments.length;x<N;x++)o[l++]=arguments[x]}return float[n].apply(null,o)}}($attr));$B.set_func_names(FloatSubclass,"builtins"),_b_.float=float}(__BRYTHON__),function($B){var _b_=$B.builtins;function $err(n,o){var l="unsupported operand type(s) for "+n+" : 'int' and '"+$B.class_name(o)+"'";throw _b_.TypeError.$factory(l)}function int_value(n){return void 0!==n.$brython_value?n.$brython_value:n}var int={__class__:_b_.type,__dir__:_b_.object.__dir__,$infos:{__module__:"builtins",__name__:"int"},$is_class:!0,$native:!0,$descriptors:{numerator:!0,denominator:!0,imag:!0,real:!0}};function preformat(n,o){if(o.empty)return _b_.str.$factory(n);if(o.type&&-1=="bcdoxXn".indexOf(o.type))throw _b_.ValueError.$factory("Unknown format code '"+o.type+"' for object of type 'int'");var l;switch(o.type){case void 0:case"d":l=n.toString();break;case"b":l=(o.alternate?"0b":"")+n.toString(2);break;case"c":l=_b_.chr(n);break;case"o":l=(o.alternate?"0o":"")+n.toString(8);break;case"x":l=(o.alternate?"0x":"")+n.toString(16);break;case"X":l=(o.alternate?"0X":"")+n.toString(16).toUpperCase();break;case"n":return n}return void 0!==o.sign&&(" "==o.sign||"+"==o.sign)&&n>=0&&(l=o.sign+l),l}function extended_euclidean(n,o){var l,x,N;return 0==o?[n,1,0]:([l,x,N]=extended_euclidean(o,n%o),[l,N,x-Math.floor(n/o)*N])}int.as_integer_ratio=function(){var n=$B.args("as_integer_ratio",1,{self:null},["self"],arguments,{},null,null);return $B.$list([n.self,1])},int.from_bytes=function(){var n,o,l=$B.args("from_bytes",3,{bytes:null,byteorder:null,signed:null},["bytes","byteorder","signed"],arguments,{signed:!1},null,null),x=l.bytes,N=l.byteorder,U=l.signed;if(_b_.isinstance(x,[_b_.bytes,_b_.bytearray]))n=x.source,o=x.source.length;else{o=(n=_b_.list.$factory(x)).length;for(var G=0;G<o;G++)_b_.bytes.$factory([n[G]])}switch(N){case"big":var A=n[o-1],P=256;for(G=o-2;G>=0;G--)A=$B.add($B.mul(P,n[G]),A),P=$B.mul(P,256);return U?n[0]<128?A:$B.sub(A,P):A;case"little":for((A=n[0])>=128&&(A-=256),P=256,G=1;G<o;G++)A=$B.add($B.mul(P,n[G]),A),P=$B.mul(P,256);return U?n[o-1]<128?A:$B.sub(A,P):A}throw _b_.ValueError.$factory("byteorder must be either 'little' or 'big'")},int.to_bytes=function(){var n=$B.args("to_bytes",3,{self:null,len:null,byteorder:null},["self","len","byteorder"],arguments,{},"args","kw"),o=n.self,l=n.len,x=n.byteorder,N=n.kw;if(!_b_.isinstance(l,_b_.int))throw _b_.TypeError.$factory("integer argument expected, got "+$B.class_name(l));if(-1==["little","big"].indexOf(x))throw _b_.ValueError.$factory("byteorder must be either 'little' or 'big'");var G=[];if(o<0){if(!N.$string_dict.signed)throw _b_.OverflowError.$factory("can't convert negative int to unsigned");o=Math.pow(256,l)+o}for(var A=o;;){var P=Math.floor(A/256);if(G.push(A-256*P),0==P)break;A=P}if(G.length>l)throw _b_.OverflowError.$factory("int too big to convert");for(;G.length<l;)G=G.concat([0]);return"big"==x&&(G=G.reverse()),{__class__:_b_.bytes,source:G}},int.__abs__=function(n){return _b_.abs(n)},int.__bool__=function(n){return 0!=int_value(n).valueOf()},int.__ceil__=function(n){return Math.ceil(int_value(n))},int.__divmod__=function(n,o){return $B.fast_tuple([int.__floordiv__(n,o),int.__mod__(n,o)])},int.__eq__=function(n,o){return void 0===o?n===int:_b_.isinstance(o,int)?n.valueOf()==int_value(o).valueOf():_b_.isinstance(o,_b_.float)?n.valueOf()==o.valueOf():_b_.isinstance(o,_b_.complex)?0!=o.$imag?False:n.valueOf()==o.$real:_b_.NotImplemented},int.__float__=function(n){return new Number(n)},int.__format__=function(n,o){var l=new $B.parse_format_spec(o);if(l.type&&-1!="eEfFgG%".indexOf(l.type))return _b_.float.__format__(n,o);l.align=l.align||">";var x=preformat(n,l);if(l.comma){for(var N="-"==x[0]?"-":"",U=x.substr(N.length),G=U.length,A=Math.ceil(U.length/3),P=[],de=0;de<A;de++)P.push(U.substring(G-3*de-3,G-3*de));P.reverse(),x=N+P.join(",")}return $B.format_width(x,l)},int.__floordiv__=function(n,o){if(o.__class__===$B.long_int)return $B.long_int.__floordiv__($B.long_int.$factory(n),o);if(_b_.isinstance(o,int)){if(0==(o=int_value(o)))throw _b_.ZeroDivisionError.$factory("division by zero");return Math.floor(n/o)}if(_b_.isinstance(o,_b_.float)){if(!o.valueOf())throw _b_.ZeroDivisionError.$factory("division by zero");return Math.floor(n/o)}if(_b_.hasattr(o,"__rfloordiv__"))return $B.$getattr(o,"__rfloordiv__")(n);$err("//",o)},int.__hash__=function(n){return void 0===n?int.__hashvalue__||$B.$py_next_hash--:n.valueOf()},int.__index__=function(n){return int_value(n)},int.__init__=function(n,o){return void 0===o&&(o=0),n.toString=function(){return o},_b_.None},int.__int__=function(n){return n},int.__invert__=function(n){return~n},int.__lshift__=function(n,o){if(_b_.isinstance(o,int))return o=int_value(o),int.$factory($B.long_int.__lshift__($B.long_int.$factory(n),$B.long_int.$factory(o)));var l=$B.$getattr(o,"__rlshift__",_b_.None);if(l!==_b_.None)return l(n);$err("<<",o)},int.__mod__=function(n,o){if(_b_.isinstance(o,_b_.tuple)&&1==o.length&&(o=o[0]),o.__class__===$B.long_int)return $B.long_int.__mod__($B.long_int.$factory(n),o);if(_b_.isinstance(o,[int,_b_.float,bool])){if(!1===(o=int_value(o))?o=0:!0===o&&(o=1),0==o)throw _b_.ZeroDivisionError.$factory("integer division or modulo by zero");return(n%o+o)%o}if(_b_.hasattr(o,"__rmod__"))return $B.$getattr(o,"__rmod__")(n);$err("%",o)},int.__mro__=[_b_.object],int.__mul__=function(n,o){var l=n.valueOf();if("string"==typeof o)return o.repeat(l);if(_b_.isinstance(o,int))return(x=n*(o=int_value(o)))>$B.min_int&&x<$B.max_int?x:int.$factory($B.long_int.__mul__($B.long_int.$factory(n),$B.long_int.$factory(o)));if(_b_.isinstance(o,_b_.float))return new Number(n*o);if(_b_.isinstance(o,_b_.bool))return o.valueOf()?n:int.$factory(0);if(_b_.isinstance(o,_b_.complex))return $B.make_complex(int.__mul__(n,o.$real),int.__mul__(n,o.$imag));if(_b_.isinstance(o,[_b_.list,_b_.tuple])){for(var x=[],N=o.slice(0,o.length),U=0;U<l;U++)x=x.concat(N);return _b_.isinstance(o,_b_.tuple)&&(x=_b_.tuple.$factory(x)),x}if(_b_.hasattr(o,"__rmul__"))return $B.$getattr(o,"__rmul__")(n);$err("*",o)},int.__ne__=function(n,o){var l=int.__eq__(n,o);return l===_b_.NotImplemented?l:!l},int.__neg__=function(n){return-n},int.__new__=function(n,o){if(void 0===n)throw _b_.TypeError.$factory("int.__new__(): not enough arguments");if(!_b_.isinstance(n,_b_.type))throw _b_.TypeError.$factory("int.__new__(X): X is not a type object");return n===int?int.$factory(o):{__class__:n,__dict__:$B.empty_dict(),$brython_value:o||0}},int.__pos__=function(n){return n},$B.use_bigint=0,int.__pow__=function(n,o,l){if("number"==typeof o||_b_.isinstance(o,int)){switch((o=int_value(o)).valueOf()){case 0:return int.$factory(1);case 1:return int.$factory(n.valueOf())}if(void 0!==l&&l!==_b_.None){if(1==l)return 0;var x=1,N=n%l,U=o,G=$B.long_int;if(U<0){var A,P,de;if([A,P,de]=extended_euclidean(n,l),1!==A)throw _b_.ValueError.$factory("not relative primes: "+n+" and "+l);return int.__pow__(P,-U,l)}for(;U>0;)U%2==1&&(x*N>$B.max_int?(x=G.__mul__(G.$factory(x),G.$factory(N)),x=G.__mod__(x,l)):x=x*N%l),U>>=1,N*N>$B.max_int?(N=G.__mul__(G.$factory(N),G.$factory(N)),N=G.__mod__(N,l)):N=N*N%l;return x}var be=Math.pow(n.valueOf(),o.valueOf());return be>$B.min_int&&be<$B.max_int?be:be===1/0||isFinite(be)?$B.BigInt?($B.use_bigint++,{__class__:$B.long_int,value:($B.BigInt(n)**$B.BigInt(o)).toString(),pos:!0}):$B.long_int.__pow__($B.long_int.$from_int(n),$B.long_int.$from_int(o)):be}if(_b_.isinstance(o,_b_.float))return n>=0?new Number(Math.pow(n,o.valueOf())):_b_.complex.__pow__($B.make_complex(n,0),o);if(_b_.isinstance(o,_b_.complex)){var te=Math.pow(n,o.$real),ce=Math.log(n);return $B.make_complex(te*Math.cos(ce),te*Math.sin(ce))}var fe=$B.$getattr(o,"__rpow__",_b_.None);if(fe!==_b_.None)return fe(n);$err("**",o)},int.__repr__=function(n){return n===int?"<class 'int'>":n.toString()},int.__rshift__=function(n,o){if(_b_.isinstance(o,int))return o=int_value(o),int.$factory($B.long_int.__rshift__($B.long_int.$factory(n),$B.long_int.$factory(o)));var l=$B.$getattr(o,"__rrshift__",_b_.None);if(l!==_b_.None)return l(n);$err(">>",o)},int.__setattr__=function(n,o,l){if("number"==typeof n)throw _b_.AttributeError.$factory(void 0===int.$factory[o]?"'int' object has no attribute '"+o+"'":"'int' object attribute '"+o+"' is read-only");return _b_.dict.$setitem(n.__dict__,o,l),_b_.None},int.__str__=int.__repr__,int.__truediv__=function(n,o){if(_b_.isinstance(o,int)){if(0==(o=int_value(o)))throw _b_.ZeroDivisionError.$factory("division by zero");return new Number(o.__class__===$B.long_int?n/parseInt(o.value):n/o)}if(_b_.isinstance(o,_b_.float)){if(!o.valueOf())throw _b_.ZeroDivisionError.$factory("division by zero");return new Number(n/o)}if(_b_.isinstance(o,_b_.complex)){var l=o.$real*o.$real+o.$imag*o.$imag;if(0==l)throw _b_.ZeroDivisionError.$factory("division by zero");return $B.make_complex(n*o.$real/l,-n*o.$imag/l)}if(_b_.hasattr(o,"__rtruediv__"))return $B.$getattr(o,"__rtruediv__")(n);$err("/",o)},int.bit_length=function(n){return s=_b_.bin(n),s=$B.$getattr(s,"lstrip")("-0b"),s.length},int.numerator=function(n){return n},int.denominator=function(n){return int.$factory(1)},int.imag=function(n){return int.$factory(0)},int.real=function(n){return n},$B.max_int32=2147483647,$B.min_int32=-$B.max_int32;var $op_func=function(n,o){if(_b_.isinstance(o,int))return o.__class__===$B.long_int?$B.long_int.__sub__($B.long_int.$factory(n),$B.long_int.$factory(o)):(o=int_value(o),n>$B.max_int32||n<$B.min_int32||o>$B.max_int32||o<$B.min_int32?$B.long_int.__sub__($B.long_int.$factory(n),$B.long_int.$factory(o)):n-o);if(_b_.isinstance(o,_b_.bool))return n-o;var l=$B.$getattr(o,"__rsub__",_b_.None);if(l!==_b_.None)return l(n);$err("-",o)};$op_func+="";var $ops={"&":"and","|":"or","^":"xor"};for(var $op in $ops){var opf=$op_func.replace(/-/gm,$op);opf=opf.replace(new RegExp("sub","gm"),$ops[$op]),eval("int.__"+$ops[$op]+"__ = "+opf)}var $op_func=function(n,o){if(_b_.isinstance(o,int)){if("number"==typeof(o=int_value(o))){var l=n.valueOf()-o.valueOf();return l>$B.min_int&&l<$B.max_int?l:$B.long_int.__sub__($B.long_int.$factory(n),$B.long_int.$factory(o))}return"boolean"==typeof o?o?n-1:n:$B.long_int.__sub__($B.long_int.$factory(n),$B.long_int.$factory(o))}if(_b_.isinstance(o,_b_.float))return new Number(n-o);if(_b_.isinstance(o,_b_.complex))return $B.make_complex(n-o.$real,-o.$imag);if(_b_.isinstance(o,_b_.bool)){var x=0;return o.valueOf()&&(x=1),n-x}if(_b_.isinstance(o,_b_.complex))return $B.make_complex(n.valueOf()-o.$real,o.$imag);var N=$B.$getattr(o,"__rsub__",_b_.None);if(N!==_b_.None)return N(n);throw console.log("err",n,o),console.log($B.frames_stack.slice()),$err("-",o)};$op_func+="";var $ops={"+":"add","-":"sub"};for(var $op in $ops){var opf=$op_func.replace(/-/gm,$op);opf=opf.replace(new RegExp("sub","gm"),$ops[$op]),eval("int.__"+$ops[$op]+"__ = "+opf)}var $comp_func=function(n,o){return o.__class__===$B.long_int?$B.long_int.__lt__(o,$B.long_int.$factory(n)):_b_.isinstance(o,int)?(o=int_value(o),n.valueOf()>o.valueOf()):_b_.isinstance(o,_b_.float)?n.valueOf()>o.valueOf():_b_.isinstance(o,_b_.bool)?n.valueOf()>_b_.bool.__hash__(o):_b_.hasattr(o,"__int__")||_b_.hasattr(o,"__index__")?int.__gt__(n,$B.$GetInt(o)):_b_.NotImplemented};for(var $op in $comp_func+="",$B.$comps)eval("int.__"+$B.$comps[$op]+"__ = "+$comp_func.replace(/>/gm,$op).replace(/__gt__/gm,"__"+$B.$comps[$op]+"__").replace(/__lt__/,"__"+$B.$inv_comps[$op]+"__"));$B.make_rmethods(int);var $valid_digits=function(n){var o="";if(0===n)return"0";if(n<10){for(var l=0;l<n;l++)o+=String.fromCharCode(l+48);return o}for(o="0123456789",l=10;l<n;l++)o+=String.fromCharCode(l+55);return o};int.$factory=function(n,o){if(void 0===n)return 0;if("number"==typeof n&&(void 0===o||10==o))return parseInt(n);if(_b_.isinstance(n,_b_.complex))throw _b_.TypeError.$factory("can't convert complex to int");var l=$B.args("int",2,{x:null,base:null},["x","base"],arguments,{base:10},null,null);if(o=l.base,_b_.isinstance(n=l.x,_b_.float)&&10==o)return(n=_b_.float.numerator(n))<$B.min_int||n>$B.max_int?$B.long_int.$from_float(n):n>0?Math.floor(n):Math.ceil(n);if(!(o>=2&&o<=36)&&0!=o)throw _b_.ValueError.$factory("invalid base");if("number"==typeof n){if(10==o)return n<$B.min_int||n>$B.max_int?$B.long_int.$factory(n):n;if(n.toString().search("e")>-1)throw _b_.OverflowError.$factory("can't convert to base "+o);var x=parseInt(n,o);return n<$B.min_int||n>$B.max_int?$B.long_int.$factory(n,o):x}if(!0===n)return 1;if(!1===n)return 0;if(n.__class__===$B.long_int){var N=parseInt(n.value);return N>$B.min_int&&N<$B.max_int?N:n}function U(be,te){throw _b_.ValueError.$factory("invalid literal for int() with base "+te+": '"+_b_.str.$factory(be)+"'")}if(o=$B.$GetInt(o),_b_.isinstance(n,_b_.str)&&(n=n.valueOf()),"string"==typeof n){var G=n.trim();if(2==G.length&&0==o&&("0b"==G||"0o"==G||"0x"==G))throw _b_.ValueError.$factory("invalid value");if(G.length>2){var A=G.substr(0,2).toUpperCase();if(0==o?("0B"==A&&(o=2),"0O"==A&&(o=8),"0X"==A&&(o=16)):("0X"==A&&16!=o||"0O"==A&&8!=o)&&U(G,o),"0B"==A&&2==o||"0O"==A||"0X"==A)for(G=G.substr(2);G.startsWith("_");)G=G.substr(1)}else 0==o&&(o=10);var P=$valid_digits(o);return null===new RegExp("^[+-]?["+P+"]["+P+"_]*$","i").exec(G)?U(n,o):n=G.replace(/_/g,""),o<=10&&!isFinite(n)&&U(G,o),(x=parseInt(n,o))<$B.min_int||x>$B.max_int?$B.long_int.$factory(n,o):x}if(_b_.isinstance(n,[_b_.bytes,_b_.bytearray]))return int.$factory($B.$getattr(n,"decode")("latin-1"),o);var de=$B.to_num(n,["__int__","__index__","__trunc__"]);if(null===de)throw _b_.TypeError.$factory("int() argument must be a string, a bytes-like object or a number, not '"+$B.class_name(n)+"'");return de},$B.set_func_names(int,"builtins"),_b_.int=int,$B.$bool=function(n){if(null==n)return!1;switch(typeof n){case"boolean":return n;case"number":case"string":return!!n;default:if(n.$is_class)return!0;var o=n.__class__||$B.get_class(n),l={},x=$B.$getattr(o,"__bool__",l);if(x!==l){var N=$B.$call(x)(n);if(!0!==N&&!1!==N)throw _b_.TypeError.$factory("__bool__ should return bool, returned "+$B.class_name(N));return N}try{return _b_.len(n)>0}catch{return!0}}};var bool={__bases__:[int],__class__:_b_.type,__mro__:[int,_b_.object],$infos:{__name__:"bool",__module__:"builtins"},$is_class:!0,$native:!0},methods=$B.op2method.subset("operations","binary","comparisons","boolean");for(var op in methods){var method="__"+methods[op]+"__";bool[method]=function(n){return function(o,l){if(void 0!==int[n])return int[n](o?1:0,l)}}(method)}bool.__and__=function(n,o){return _b_.isinstance(o,bool)?n&&o:_b_.isinstance(o,int)?int.__and__(bool.__index__(n),int.__index__(o)):_b_.NotImplemented},bool.__hash__=bool.__index__=bool.__int__=function(n){return n.valueOf()?1:0},bool.__neg__=function(n){return-$B.int_or_bool(n)},bool.__or__=function(n,o){return _b_.isinstance(o,bool)?n||o:_b_.isinstance(o,int)?int.__or__(bool.__index__(n),int.__index__(o)):_b_.NotImplemented},bool.__pos__=$B.int_or_bool,bool.__repr__=bool.__str__=function(n){return n?"True":"False"},bool.__setattr__=function(n,o){if(_b_.dir(n).indexOf(o)>-1)var l="attribute '"+o+"' of 'int' objects is not writable";else l="'bool' object has no attribute '"+o+"'";throw _b_.AttributeError.$factory(l)},bool.__xor__=function(n,o){return _b_.isinstance(o,bool)?!!(n^o):_b_.isinstance(o,int)?int.__xor__(bool.__index__(n),int.__index__(o)):_b_.NotImplemented},bool.$factory=function(){var n=$B.args("bool",1,{x:null},["x"],arguments,{x:!1},null,null);return $B.$bool(n.x)},_b_.bool=bool,$B.set_func_names(bool,"builtins")}(__BRYTHON__),function($B){var bltns=$B.InjectBuiltins();eval(bltns);try{eval("window")}catch(n){window=self}var long_int={__class__:_b_.type,__mro__:[int,object],$infos:{__module__:"builtins",__name__:"int"},$is_class:!0,$native:!0,$descriptors:{numerator:!0,denominator:!0,imag:!0,real:!0}};function add_pos(n,o){if(window.BigInt)return{__class__:long_int,value:(BigInt(n)+BigInt(o)).toString(),pos:!0};for(var l,x="",N=0,U=n.length,G=o.length-1;G>=0;G--)2==(l=(N+(--U<0?0:parseInt(n.charAt(U)))+parseInt(o.charAt(G))).toString()).length?(x=l.charAt(1)+x,N=parseInt(l.charAt(0))):(x=l+x,N=0);for(;U>0;)U--,2==(l=(N+parseInt(n.charAt(U))).toString()).length?(x=l.charAt(1)+x,N=parseInt(l.charAt(0))):(x=l+x,N=0);return N&&(x=N+x),{__class__:long_int,value:x,pos:!0}}var len=(Math.pow(2,53)-1+"").length-1;function binary_pos(n){for(var o,l,x,N,U=Math.ceil(n.length/len),G=[],A=[],P=0;P<U;P++)x=(o=n.length-(P+1)*len)-(l=Math.max(0,o)),G.push(n.substr(l,len+x));(G=G.reverse()).forEach(function(be,te){G[te]=parseInt(be)});for(var de=Math.pow(10,15);G[G.length-1]>0;)G.forEach(function(be,te){N=be%2,G[te]=Math.floor(be/2),N&&te<G.length-1&&(G[te+1]+=de)}),A.push(N),0==G[0]&&G.shift();return A.reverse().join("")}function binary(n){var o=binary_pos(n.value);if(n.pos)return o;for(var l="",x=0,N=o.length;x<N;x++)l+="0"==o.charAt(x)?"1":"0";var U=add_pos(l,"1").value;return l.substr(0,l.length-U.length)+U}function check_shift(n){if(!isinstance(n,long_int))throw TypeError.$factory("shift must be int, not '"+$B.class_name(n)+"'");if(!n.pos)throw ValueError.$factory("negative shift count")}function clone(n){var o={};for(var l in n)o[l]=n[l];return o}function comp_pos(n,o){return n.length>o.length?1:n.length<o.length?-1:n>o?1:n<o?-1:0}function divmod_by_safe_int(n,o){if(1==o)return[n,0];for(var l,x,N,U=(Math.floor((Math.pow(2,53)-1)/o)+"").length-1,G=Math.ceil(n.length/U),A=[],P=0;P<G;P++)N=(l=n.length-(P+1)*U)-(x=Math.max(0,l)),A.push(n.substr(x,U+N));(A=A.reverse()).forEach(function(ce,fe){A[fe]=parseInt(ce)});var de,be,te=Math.pow(10,U);for(A.forEach(function(ce,fe){de=ce%o,A[fe]=Math.floor(ce/o),fe<A.length-1&&(A[fe+1]+=te*de)});0==A[0];)if(A.shift(),0==A.length)return[0,de];return be=A[0]+"",A.forEach(function(ce,fe){fe>0&&(be+="0".repeat(U-ce.toString().length)+ce)}),[be,de]}function divmod_pos(n,o){if(window.BigInt)return[{__class__:long_int,value:(BigInt(n)/BigInt(o)).toString(),pos:!0},{__class__:long_int,value:(BigInt(n)%BigInt(o)).toString(),pos:!0}];var l,x=parseInt(n),N=parseInt(o);if(x<$B.max_int&&N<$B.max_int){var U=x%N,G=Math.floor(x/N).toString();return[{__class__:long_int,value:G.toString(),pos:!0},{__class__:long_int,value:U.toString(),pos:!0}]}if(N<$B.max_int){var A=divmod_by_safe_int(n,N);return[long_int.$factory(A[0]),long_int.$factory(A[1])]}if(-1==comp_pos(n,o))P="0",l=long_int.$factory(n);else if(o==n)P="1",l=long_int.$factory("0");else{var P="",de=n.substr(0,o.length);n<o&&(de=n.substr(0,o.length+1));for(var be=n.substr(de.length),te={};;){var ce=Math.floor(parseInt(de)/parseInt(o))+"";if("10"==ce&&(ce="9"),void 0===te[ce]&&(te[ce]=mul_pos(o,ce).value),-1==comp_pos(de,te[ce])&&void 0===te[--ce]&&(te[ce]=mul_pos(o,ce).value),P+=ce,de=sub_pos(de,te[ce]).value,0==be.length)break;de+=be.charAt(0),be=be.substr(1)}l=sub_pos(n,mul_pos(P,o).value)}return[long_int.$factory(P),l]}function split_chunks(n,o){for(var l=Math.ceil(n.length/o),x=[],N=n.length,U=0;U<l;U++){var G=N-o*(U+1);G<0&&(o+=G,G=0),x.push(parseInt(n.substr(G,o)))}return x}function mul_pos(n,o){if(window.BigInt)return{__class__:long_int,value:(BigInt(n)*BigInt(o)).toString(),pos:!0};var l,x=parseInt(n)*parseInt(o);if(x<$B.max_int)return{__class__:long_int,value:x.toString(),pos:!0};for(var N=split_chunks(n,6),U=split_chunks(o,6),G={},A=N.length+U.length,P=0;P<A-1;P++)G[P]=0;for(P=0;P<N.length;P++)for(var de=0;de<U.length;de++)G[P+de]+=N[P]*U[de];for(P=0;P<A-1;P++){var be=split_chunks(G[P].toString(),6);for(de=1;de<be.length;de++)void 0===G[l=P+de]?G[l]=parseInt(be[de]):G[l]+=parseInt(be[de]);G[P]=be[0]}var te,ce="";for(P=0;void 0!==G[P];)te=G[P].toString(),void 0!==G[P+1]&&(te="0".repeat(6-te.length)+te),ce=te+ce,P++;try{return long_int.$factory(ce)}catch(fe){throw console.log(n,o,G,ce),fe}}function sub_pos(n,o){if(window.BigInt)return{__class__:long_int,value:(BigInt(n)-BigInt(o)).toString(),pos:!0};for(var l,x="",N=0,U=n.length,G=0,A=o.length-1;A>=0;A--)U--,l=(G=parseInt(n.charAt(U)))-N-parseInt(o.charAt(A)),isNaN(l)&&console.log("x is NaN",n.length,o.length,A,U,G,N,A,o.charAt(A)),l<0?(x=10+l+x,N=1):(x=l+x,N=0);for(x.startsWith("NaN")&&alert(x);U>0;)U--,(l=parseInt(n.charAt(U))-N)<0?(x=10+l+x,N=1):(x=l+x,N=0);for(;"0"==x.charAt(0)&&x.length>1;)x=x.substr(1);return x.startsWith("NaN")&&console.log("hoho !!",n,o,n>=o,x),{__class__:long_int,value:x,pos:!0}}function to_BigInt(n){var o=$B.BigInt(n.value);return n.pos?o:-o}function from_BigInt(n){var o=n>=0;return n=(n=(n=n.toString()).endsWith("n")?n.substr(0,n.length-1):n).startsWith("-")?n.substr(1):n,intOrLong({__class__:long_int,value:n,pos:o})}function digits(n){for(var o={},l=0;l<n&&10!=l;l++)o[l]=!0;if(n>10)for(l=0;l<n-10;l++)o[String.fromCharCode(65+l)]=!0,o[String.fromCharCode(97+l)]=!0;return o}long_int.$from_float=function(n){var o=Math.abs(n).toString(),l=o;if(o.search("e")>-1){var x=/-?(\d)(\.\d+)?e([+-])(\d*)/.exec(o),N=x[1],U=x[2],A=x[4];"+"==x[3]&&(l=void 0===U?N+"0".repeat(A-1):N+U+"0".repeat(A-1-U.length))}return{__class__:long_int,value:l,pos:n>=0}},long_int.__abs__=function(n){return{__class__:long_int,value:n.value,pos:!0}},long_int.__add__=function(n,o){if(isinstance(o,_b_.float))return _b_.float.$factory(parseInt(n.value)+o.value);if("number"==typeof o)o=long_int.$factory(_b_.str.$factory(o));else if(o.__class__!==long_int)if(isinstance(o,_b_.bool))o=long_int.$factory(o?1:0);else{if(!isinstance(o,int))return _b_.NotImplemented;o=long_int.$factory(_b_.str.$factory(_b_.int.__index__(o)))}var l;if(n.pos&&o.pos)return add_pos(n.value,o.value);if(n.pos||o.pos){if(n.pos&&!o.pos){switch(comp_pos(n.value,o.value)){case 1:l=sub_pos(n.value,o.value);break;case 0:l={__class__:long_int,value:0,pos:!0};break;case-1:(l=sub_pos(o.value,n.value)).pos=!1}return intOrLong(l)}switch(comp_pos(n.value,o.value)){case 1:(l=sub_pos(n.value,o.value)).pos=!1;break;case 0:l={__class__:long_int,value:0,pos:!0};break;case-1:l=sub_pos(o.value,n.value)}return intOrLong(l)}return(l=add_pos(n.value,o.value)).pos=!1,intOrLong(l)},long_int.__and__=function(n,o){if("number"==typeof o&&(o=long_int.$factory(_b_.str.$factory(o))),$B.BigInt)return from_BigInt(to_BigInt(n)&to_BigInt(o));var l="",x=!n.pos&&!o.pos;x&&(n=long_int.__neg__(n),o=long_int.__neg__(o));var N,U,G=binary(n),A=G.length,P=binary(o),de=P.length,be=1;for(l="";!(be>A&&be>de);)N=be>A?n.pos?"0":"1":G.charAt(A-be),U=be>de?o.pos?"0":"1":P.charAt(de-be),l="1"==N&&"1"==U?"1"+l:"0"+l,be++;for(;"0"==l.charAt(0);)l=l.substr(1);return l=$B.long_int.$factory(l,2),x&&(l.pos=!1),intOrLong(l)},long_int.__divmod__=function(n,o){"number"==typeof o&&(o=long_int.$factory(_b_.str.$factory(o)));var l=divmod_pos(n.value,o.value);return n.pos!==o.pos&&("0"!=l[0].value&&(l[0].pos=!1),"0"!=l[1].value&&(l[0]=long_int.__sub__(l[0],long_int.$factory("1")),l[1]=long_int.__sub__(n,long_int.__mul__(o,long_int.$factory(l[0]))))),$B.fast_tuple([intOrLong(l[0]),intOrLong(l[1])])},long_int.__eq__=function(n,o){return"number"==typeof o&&(o=long_int.$factory(_b_.str.$factory(o))),n.value==o.value&&n.pos==o.pos},long_int.__float__=function(n){return new Number(parseFloat(n.value))},long_int.__floordiv__=function(n,o){if(isinstance(o,_b_.float))return _b_.float.$factory(parseInt(n.value)/o);if("number"==typeof o){var l=divmod_by_safe_int(n.value,o);return{__class__:long_int,value:l[0],pos:o>0?n.pos:!n.pos}}return intOrLong(long_int.__divmod__(n,o)[0])},long_int.__ge__=function(n,o){return"number"==typeof o&&(o=long_int.$factory(_b_.str.$factory(o))),n.pos!=o.pos?!o.pos:n.value.length>o.value.length?n.pos:n.value.length<o.value.length?!n.pos:n.pos?n.value>=o.value:n.value<=o.value},long_int.__gt__=function(n,o){return!long_int.__le__(n,o)},long_int.__index__=function(n){for(var o,l="",x=n.value;l=(o=divmod_pos(x,"2"))[1].value+l,"0"!=(x=o[0].value););if(n.pos)l="0"+l;else{for(var N="",U=!1,G=l.length-1;G>=0;G--)"0"==l.charAt(G)?N=U?"1"+N:"0"+N:U?N="0"+N:(U=!0,N="1"+N);l=N="1"+N}return intOrLong(l)},long_int.__invert__=function(n){return long_int.__sub__(long_int.$factory("-1"),n)},long_int.__le__=function(n,o){return"number"==typeof o&&(o=long_int.$factory(_b_.str.$factory(o))),n.pos!==o.pos||n.value.length>o.value.length?!n.pos:n.value.length<o.value.length?n.pos:n.pos?n.value<=o.value:n.value>=o.value},long_int.__lt__=function(n,o){return!long_int.__ge__(n,o)},long_int.__lshift__=function(n,o){if(window.BigInt)return o.__class__==long_int&&(o=o.value),intOrLong({__class__:long_int,value:(BigInt(n.value)<<BigInt(o)).toString(),pos:n.pos});var l;if(o.__class__===long_int){var x=parseInt(o.value);if(x<0)throw _b_.ValueError.$factory("negative shift count");x<$B.max_int&&(l=!0,o=x)}if(l){if(0==x)return n}else if("0"==(o=long_int.$factory(o)).value)return n;for(var N=n.value;;){for(var U,G=0,A="",P=N.length-1;P>=0;P--)2==(U=(G+2*parseInt(N.charAt(P))).toString()).length?(A=U.charAt(1)+A,G=parseInt(U.charAt(0))):(A=U+A,G=0);if(G&&(A=G+A),N=A,l){if(0==--o)break}else if("0"==(o=sub_pos(o.value,"1")).value)break}return intOrLong({__class__:long_int,value:N,pos:n.pos})},long_int.__mod__=function(n,o){return intOrLong(long_int.__divmod__(n,o)[1])},long_int.__mro__=[_b_.int,_b_.object],long_int.__mul__=function(n,o){switch(n){case Number.NEGATIVE_INFINITY:case Number.POSITIVE_INFINITY:return $B.rich_comp("__eq__",o,0)?NaN:_b_.getattr(o,"__gt__")(0)?n:-n}if(isinstance(o,_b_.float))return _b_.float.$factory(parseInt(n.value)*o);if("number"==typeof o&&(o=long_int.$factory(o)),other_value=o.value,other_pos=o.pos,o.__class__!==long_int&&isinstance(o,int)){var l=int.__index__(o);other_value=_b_.str.$factory(l),other_pos=l>0}if($B.BigInt)return from_BigInt(to_BigInt(n)*to_BigInt(o));var x=mul_pos(n.value,other_value);return n.pos==other_pos||(x.pos=!1),intOrLong(x)},long_int.__neg__=function(n){return{__class__:long_int,value:n.value,pos:!n.pos}},long_int.__or__=function(n,o){o=long_int.$factory(o);var l=long_int.__index__(n),x=long_int.__index__(o);if(l.length<x.length){var N=x;x=l,l=N}for(var U=l.length-x.length,G=l.substr(0,U),A=0;A<x.length;A++)"1"==l.charAt(U+A)||"1"==x.charAt(A)?G+="1":G+="0";return intOrLong(long_int.$factory(G,2))},long_int.__pos__=function(n){return n},long_int.__pow__=function(n,o,l){if("number"==typeof o)o=long_int.$from_int(o);else if(isinstance(o,int))o=long_int.$factory(_b_.str.$factory(_b_.int.__index__(o)));else if(!isinstance(o,long_int))throw TypeError.$factory("power must be an integer, not '"+$B.class_name(o)+"'");if(!o.pos)return"1"==n.value?n:long_int.$factory("0");if("0"==o.value)return long_int.$factory("1");if($B.BigInt){var x=$B.BigInt(n.value),N=$B.BigInt(1),U=$B.BigInt(o.value);if(void 0===(l=void 0===l?l:$B.BigInt("number"==typeof l?l:l.value)))return{__class__:long_int,value:(x**U).toString(),pos:!0};for(;U>0;)U%$B.BigInt(2)==1&&(N*=x),(U/=$B.BigInt(2))>0&&(x*=x),void 0!==l&&(N%=l);return{__class__:long_int,value:N.toString(),pos:!0}}N={__class__:long_int,value:"1",pos:!0},x=n;for(var G,A=o.value;"string"==typeof A&&parseInt(A)<$B.max_int&&(A=parseInt(A)),0!=A;)"string"==typeof A?(parseInt(A.charAt(A.length-1))%2==1&&(N=long_int.__mul__(N,x)),A=long_int.__floordiv__(A,2)):(A%2==1&&(N="number"==typeof N&&"number"==typeof x&&(G=N*x)<$B.max_int?G:long_int.__mul__(long_int.$factory(N),long_int.$factory(x))),A=Math.floor(A/2)),A>0&&("number"==typeof x&&(G=x*x)<$B.max_int?x=G:(x=long_int.$factory(x),x=long_int.__mul__(x,x))),void 0!==l&&(N=long_int.__mod__(N,l));return intOrLong(N)},long_int.__rshift__=function(n,o){if(window.BigInt)return o.__class__===long_int&&(o=o.value),intOrLong({__class__:long_int,value:(BigInt(n.value)>>BigInt(o)).toString(),pos:n.pos});if("number"==typeof o){var l=Math.pow(2,o);if(l<$B.max_int){var x=divmod_by_safe_int(n.value,l);return intOrLong({__class__:long_int,value:x[0],pos:n.pos})}}if("0"==(o=long_int.$factory(o)).value)return n;for(x=n.value;"0"!=(x=divmod_pos(x,"2")[0].value).value&&"0"!=(o=sub_pos(o.value,"1")).value;);return intOrLong({__class__:long_int,value:x,pos:n.pos})},long_int.__str__=long_int.__repr__=function(n){var o="";return n.pos||(o+="-"),o+n.value},long_int.__sub__=function(n,o){if(isinstance(o,_b_.float))return o=o instanceof Number?o:o.$brython_value,_b_.float.$factory(parseInt(n.value)-o);var l;if("number"==typeof o&&(o=long_int.$factory(_b_.str.$factory(o))),n.pos&&o.pos){switch(comp_pos(n.value,o.value)){case 1:l=sub_pos(n.value,o.value);break;case 0:l={__class__:long_int,value:"0",pos:!0};break;case-1:(l=sub_pos(o.value,n.value)).pos=!1}return intOrLong(l)}if(n.pos||o.pos)return n.pos&&!o.pos?intOrLong(add_pos(n.value,o.value)):((l=add_pos(n.value,o.value)).pos=!1,intOrLong(l));switch(comp_pos(n.value,o.value)){case 1:(l=sub_pos(n.value,o.value)).pos=!1;break;case 0:l={__class__:long_int,value:"0",pos:!0};break;case-1:l=sub_pos(o.value,n.value)}return intOrLong(l)},long_int.__truediv__=function(n,o){if(isinstance(o,long_int))return _b_.float.$factory(parseInt(n.value)/parseInt(o.value));if(isinstance(o,_b_.int)||isinstance(o,_b_.float))return _b_.float.$factory(parseInt(n.value)/o);throw TypeError.$factory("unsupported operand type(s) for /: 'int' and '"+$B.class_name(o)+"'")},long_int.__xor__=function(n,o){o=long_int.$factory(o);var l=long_int.__index__(n),x=long_int.__index__(o);if(l.length<x.length){var N=x;x=l,l=N}for(var U=l.length-x.length,G=l.substr(0,U),A=0;A<x.length;A++)"1"==l.charAt(U+A)&&"0"==x.charAt(A)||"0"==l.charAt(U+A)&&"1"==x.charAt(A)?G+="1":G+="0";return intOrLong(long_int.$factory(G,2))},long_int.numerator=function(n){return n},long_int.denominator=function(n){return _b_.int.$factory(1)},long_int.imag=function(n){return _b_.int.$factory(0)},long_int.real=function(n){return n},long_int.to_base=function(n,o){if(2==o)return binary_pos(n.value);for(var l="",x=n.value;x>0;){var N=divmod_pos(x,o.toString());if(l=parseInt(N[1].value).toString(o)+l,0==(x=N[0].value))break}return l};var MAX_SAFE_INTEGER=Math.pow(2,53)-1,MIN_SAFE_INTEGER=-MAX_SAFE_INTEGER;function isSafeInteger(n){return"number"==typeof n&&Math.round(n)===n&&MIN_SAFE_INTEGER<=n&&n<=MAX_SAFE_INTEGER}function intOrLong(n){var o=parseInt(n.value)*(n.pos?1:-1);return o>MIN_SAFE_INTEGER&&o<MAX_SAFE_INTEGER?o:n}long_int.$from_int=function(n){return{__class__:long_int,value:n.toString(),pos:n>0}},long_int.$factory=function(n,o){if(arguments.length>2)throw _b_.TypeError.$factory("long_int takes at most 2 arguments ("+arguments.length+" given)");if(void 0===o)o=10;else if(!isinstance(o,int))throw TypeError.$factory("'"+$B.class_name(o)+"' object cannot be interpreted as an integer");if(o<0||1==o||o>36)throw ValueError.$factory("long_int.$factory() base must be >= 2 and <= 36");if("number"==typeof n){var l=n>0;if(isSafeInteger(n=Math.abs(n)))P=long_int.$from_int(n);else{if(n.constructor!=Number)throw ValueError.$factory("argument of long_int is not a safe integer");var x=n.toString(),N=x.search("e");if(N>-1){var U=x.substr(0,N),G=parseInt(x.substr(N+1));if((ce=U.search(/\./))>-1){var A=U.substr(ce+1).length;if(A>G){var P=U.substr(0,ce)+U.substr(ce+1).substr(0,G);P=long_int.$from_int(P)}else P=U.substr(0,ce)+U.substr(ce+1)+"0".repeat(G-A),P=long_int.$from_int(P)}else P=long_int.$from_int(U+"0".repeat(G))}else P=(ce=x.search(/\./))>-1?long_int.$from_int(x.substr(0,ce)):long_int.$from_int(x)}return P.pos=l,P}if(isinstance(n,_b_.float)){if(n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)return n;n=new Number(n>=0?Math.round(n.value):Math.ceil(n.value))}else{if(isinstance(n,_b_.bool))return n.valueOf()?int.$factory(1):int.$factory(0);if(n.__class__===long_int)return n;if(isinstance(n,int))n=n.$brython_value+"";else if(isinstance(n,_b_.bool))n=_b_.bool.__int__(n)+"";else if("string"!=typeof n)throw ValueError.$factory("argument of long_int must be a string, not "+$B.class_name(n))}for(var de=!1,be=(l=!0,0);" "==n.charAt(0)&&n.length;)n=n.substr(1);for(;" "==n.charAt(n.length-1)&&n.length;)n=n.substr(0,n.length-1);if("+"==n.charAt(0)?de=!0:"-"==n.charAt(0)&&(de=!0,l=!1),de){if(1==n.length)throw ValueError.$factory('long_int argument is not a valid number: "'+n+'"');n=n.substr(1)}for(;be<n.length-1&&"0"==n.charAt(be);)be++;n=n.substr(be);for(var te=digits(o),ce=-1,fe=0;fe<n.length;fe++)if("."==n.charAt(fe)&&-1==ce)ce=fe;else if(!te[n.charAt(fe)])throw ValueError.$factory('long_int argument is not a valid number: "'+n+'"');if(-1!=ce&&(n=n.substr(0,ce)),10!=o){for(var _e="1",le=long_int.$factory(0),pe=n.length;pe--;){var T=mul_pos(_e,parseInt(n.charAt(pe),o).toString()).value;le=add_pos(le.value,T),_e=mul_pos(_e,o.toString()).value}return le}return{__class__:long_int,value:n,pos:l}},$B.set_func_names(long_int,"builtins"),$B.long_int=long_int}(__BRYTHON__),function($B){var _b_=$B.builtins;function $UnsupportedOpType(n,o,l){throw _b_.TypeError.$factory("unsupported operand type(s) for "+n+": '"+o+"' and '"+l+"'")}var complex={__class__:_b_.type,__dir__:_b_.object.__dir__,$infos:{__module__:"builtins",__name__:"complex"},$is_class:!0,$native:!0,$descriptors:{real:!0,imag:!0}};function complex2expo(n){var o=Math.sqrt(n.$real*n.$real+n.$imag*n.$imag),l=n.$imag/o,x=n.$real/o;return{norm:o,angle:0==x?1==l?Math.PI/2:3*Math.PI/2:0==l?1==x?0:Math.PI:Math.atan(l/x)}}complex.__abs__=function(n){var o=isFinite(n.$real),l=isFinite(n.$imag);if(o&&isNaN(n.$imag)||l&&isNaN(n.$real)||isNaN(n.$imag)&&isNaN(n.$real))return NaN;if(!o||!l)return 1/0;var x=Math.sqrt(Math.pow(n.$real,2)+Math.pow(n.$imag,2));if(!isFinite(x)&&o&&l)throw _b_.OverflowError.$factory("absolute value too large");return x},complex.__bool__=function(n){return 0!=n.$real||0!=n.$imag},complex.__eq__=function(n,o){return _b_.isinstance(o,complex)?n.$real.valueOf()==o.$real.valueOf()&&n.$imag.valueOf()==o.$imag.valueOf():_b_.isinstance(o,_b_.int)||_b_.isinstance(o,_b_.float)?0==n.$imag&&n.$real==o.valueOf():_b_.NotImplemented},complex.__floordiv__=function(n,o){$UnsupportedOpType("//","complex",$B.get_class(o))},complex.__hash__=function(n){return 1000003*n.$imag+n.$real},complex.__init__=function(){return _b_.None},complex.__invert__=function(n){return~n},complex.__mod__=function(n,o){throw _b_.TypeError.$factory("TypeError: can't mod complex numbers.")},complex.__mro__=[_b_.object],complex.__mul__=function(n,o){return _b_.isinstance(o,complex)?make_complex(n.$real*o.$real-n.$imag*o.$imag,n.$imag*o.$real+n.$real*o.$imag):_b_.isinstance(o,_b_.int)?make_complex(n.$real*o.valueOf(),n.$imag*o.valueOf()):_b_.isinstance(o,_b_.float)?make_complex(n.$real*o,n.$imag*o):_b_.isinstance(o,_b_.bool)?o.valueOf()?n:make_complex(0,0):void $UnsupportedOpType("*",complex,o)},complex.__ne__=function(n,o){var l=complex.__eq__(n,o);return l===_b_.NotImplemented?l:!l},complex.__neg__=function(n){return make_complex(-n.$real,-n.$imag)},complex.__new__=function(n){if(void 0===n)throw _b_.TypeError.$factory("complex.__new__(): not enough arguments");var o={},l=$B.args("complex",3,{cls:null,real:null,imag:null},["cls","real","imag"],arguments,{real:0,imag:o},null,null),x=l.real,N=l.imag;if("string"==typeof x){if(N!==o)throw _b_.TypeError.$factory("complex() can't take second arg if first is a string");{let de=function(be){var te=parseFloat(be.charAt(0)+be.substr(1).replace(/_/g,""));if(isNaN(te))throw _b_.ValueError.$factory("could not convert string to complex: '"+U+"'");return te};var U=x;(x=x.trim()).startsWith("(")&&x.endsWith(")")&&(x=(x=x.substr(1)).substr(0,x.length-1));var G=/^\s*([\+\-]*[0-9_]*\.?[0-9_]*(e[\+\-]*[0-9_]*)?)([\+\-]?)([0-9_]*\.?[0-9_]*(e[\+\-]*[0-9_]*)?)(j?)\s*$/i.exec(x);if(null===G||"."==G[_real]||"."==G[_imag]||".e"==G[_real]||".e"==G[_imag]||"e"==G[_real]||"e"==G[_imag])throw _b_.ValueError.$factory("complex() arg is a malformed string");return""!=G[_j]?""==G[_sign]?(x=0,N="+"==G[_real]||""==G[_real]?1:"-"==G[_real]?-1:de(G[_real])):(x=de(G[_real]),N=""==G[_imag]?1:de(G[_imag]),N="-"==G[_sign]?-N:N):(x=de(G[_real]),N=0),{__class__:complex,$real:x||0,$imag:N||0}}}if(N=N===o?0:N,1==arguments.length&&x.__class__===complex&&0==N)return x;if(_b_.isinstance(x,[_b_.float,_b_.int])&&_b_.isinstance(N,[_b_.float,_b_.int]))return{__class__:complex,$real:x,$imag:N};var A=$B.to_num(x,["__complex__","__float__","__index__"]);if(null===A)throw _b_.TypeError.$factory("complex() first argument must be a  string or a number, not '"+$B.class_name(x)+"'");if(x=A,N=_convert(N),!_b_.isinstance(x,_b_.float)&&!_b_.isinstance(x,_b_.int)&&!_b_.isinstance(x,_b_.complex))throw _b_.TypeError.$factory("complex() argument must be a string or a number");if("string"==typeof N)throw _b_.TypeError.$factory("complex() second arg can't be a string");if(!_b_.isinstance(N,_b_.float)&&!_b_.isinstance(N,_b_.int)&&!_b_.isinstance(N,_b_.complex)&&N!==o)throw _b_.TypeError.$factory("complex() argument must be a string or a number");return N=complex.__mul__(complex.$factory("1j"),N),complex.__add__(N,x)},complex.__pos__=function(n){return n},complex.__pow__=function(n,o){var l=complex2expo(n),x=l.angle,N=Math.pow(l.norm,o);if(_b_.isinstance(o,[_b_.int,_b_.float]))return make_complex(N*Math.cos(x*o),N*Math.sin(x*o));if(_b_.isinstance(o,complex)){var U=o.$real,G=o.$imag,A=Math.pow(l.norm,U)*Math.pow(Math.E,-G*x),P=G*Math.log(l.norm)-U*x;return make_complex(A*Math.cos(P),A*Math.sin(P))}throw _b_.TypeError.$factory("unsupported operand type(s) for ** or pow(): 'complex' and '"+$B.class_name(o)+"'")},complex.__str__=complex.__repr__=function(n){return 0==n.$real?1/n.$real<0?n.$imag<0?"(-0"+n.$imag+"j)":0==n.$imag&&1/n.$imag<0?"(-0-"+n.$imag+"j)":"(-0+"+n.$imag+"j)":0==n.$imag&&1/n.$imag<0?"-"+n.$imag+"j":n.$imag+"j":n.$imag>0?"("+n.$real+"+"+n.$imag+"j)":0==n.$imag?1/n.$imag<0?"("+n.$real+"-"+n.$imag+"j)":"("+n.$real+"+"+n.$imag+"j)":"("+n.$real+"-"+-n.$imag+"j)"},complex.__sqrt__=function(n){if(0==n.$imag)return complex(Math.sqrt(n.$real));var o=n.$real,l=n.$imag,x=Math.sqrt((o+sqrt)/2),N=Number.sign(l)*Math.sqrt((-o+sqrt)/2);return make_complex(x,N)},complex.__truediv__=function(n,o){if(_b_.isinstance(o,complex)){if(0==o.$real&&0==o.$imag)throw _b_.ZeroDivisionError.$factory("division by zero");var x=o.$real*o.$real+o.$imag*o.$imag;return make_complex((n.$real*o.$real+n.$imag*o.$imag)/x,(n.$imag*o.$real-n.$real*o.$imag)/x)}if(_b_.isinstance(o,_b_.int)){if(!o.valueOf())throw _b_.ZeroDivisionError.$factory("division by zero");return complex.__truediv__(n,complex.$factory(o.valueOf()))}if(_b_.isinstance(o,_b_.float)){if(!o.valueOf())throw _b_.ZeroDivisionError.$factory("division by zero");return complex.__truediv__(n,complex.$factory(o.valueOf()))}$UnsupportedOpType("//","complex",o.__class__)},complex.conjugate=function(n){return make_complex(n.$real,-n.$imag)};var $op_func=function(n,o){throw _b_.TypeError.$factory("TypeError: unsupported operand type(s) for -: 'complex' and '"+$B.class_name(o)+"'")};$op_func+="";var $ops={"&":"and","|":"ior","<<":"lshift",">>":"rshift","^":"xor"};for(var $op in $ops)eval("complex.__"+$ops[$op]+"__ = "+$op_func.replace(/-/gm,$op));complex.__ior__=complex.__or__;var $op_func=function(n,o){if(_b_.isinstance(o,complex))return make_complex(n.$real-o.$real,n.$imag-o.$imag);if(_b_.isinstance(o,_b_.int))return make_complex($B.sub(n.$real,o.valueOf()),n.$imag);if(_b_.isinstance(o,_b_.float))return make_complex(n.$real-o.valueOf(),n.$imag);if(_b_.isinstance(o,_b_.bool)){var l=0;return o.valueOf()&&(l=1),make_complex(n.$real-l,n.$imag)}throw _b_.TypeError.$factory("unsupported operand type(s) for -: "+n.__repr__()+" and '"+$B.class_name(o)+"'")};complex.__sub__=$op_func,$op_func+="",$op_func=$op_func.replace(/-/gm,"+").replace(/sub/gm,"add"),eval("complex.__add__ = "+$op_func);var $comp_func=function(n,o){if(void 0===o||o==_b_.None)return _b_.NotImplemented;throw _b_.TypeError.$factory("TypeError: no ordering relation is defined for complex numbers")};for(var $op in $comp_func+="",$B.$comps)eval("complex.__"+$B.$comps[$op]+"__ = "+$comp_func.replace(/>/gm,$op));$B.make_rmethods(complex),complex.real=function(n){return new Number(n.$real)},complex.real.setter=function(){throw _b_.AttributeError.$factory("readonly attribute")},complex.imag=function(n){return new Number(n.$imag)},complex.imag.setter=function(){throw _b_.AttributeError.$factory("readonly attribute")};var _real=1,_real_mantissa=2,_sign=3,_imag=4,_imag_mantissa=5,_j=6,type_conversions=["__complex__","__float__","__index__"],_convert=function(n){for(var o=n.__class__||$B.get_class(n),l=0;l<type_conversions.length;l++){var x={},N=$B.$getattr(o,type_conversions[l],x);if(N!==x)return N(n)}return null},make_complex=$B.make_complex=function(n,o){return{__class__:complex,$real:n,$imag:o}};complex.$factory=function(){return complex.__new__(complex,...arguments)},$B.set_func_names(complex,"builtins"),_b_.complex=complex}(__BRYTHON__),function(n){var o=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9];function l(te){return te<1e5?te<100?te<10?0:1:te<1e4?te<1e3?2:3:4:te<1e7?te<1e6?5:6:te<1e9?te<1e8?7:8:9}function x(te,ce){if(te===ce)return 0;if(~~te===te&&~~ce===ce){if(0===te||0===ce)return te<ce?-1:1;if(te<0||ce<0){if(ce>=0)return-1;if(te>=0)return 1;te=-te,ce=-ce}al=l(te),bl=l(ce);var fe=0;return al<bl?(te*=o[bl-al-1],ce/=10,fe=-1):al>bl&&(ce*=o[al-bl-1],te/=10,fe=1),te===ce?fe:te<ce?-1:1}var _e=String(te),le=String(ce);return _e===le?0:_e<le?-1:1}function N(te,ce,fe,_e){var le=ce+1;if(le===fe)return 1;if(_e(te[le++],te[ce])<0){for(;le<fe&&_e(te[le],te[le-1])<0;)le++;!function(pe,T,B){for(B--;T<B;){var q=pe[T];pe[T++]=pe[B],pe[B--]=q}}(te,ce,le)}else for(;le<fe&&_e(te[le],te[le-1])>=0;)le++;return le-ce}function U(te,ce,fe,_e,le){for(_e===ce&&_e++;_e<fe;_e++){for(var pe=te[_e],T=ce,B=_e;T<B;){var q=T+B>>>1;le(pe,te[q])<0?B=q:T=q+1}var ee=_e-T;switch(ee){case 3:te[T+3]=te[T+2];case 2:te[T+2]=te[T+1];case 1:te[T+1]=te[T];break;default:for(;ee>0;)te[T+ee]=te[T+ee-1],ee--}te[T]=pe}}function G(te,ce,fe,_e,le,pe){var T=0,B=0,q=1;if(pe(te,ce[fe+le])>0){for(B=_e-le;q<B&&pe(te,ce[fe+le+q])>0;)T=q,(q=1+(q<<1))<=0&&(q=B);q>B&&(q=B),T+=le,q+=le}else{for(B=le+1;q<B&&pe(te,ce[fe+le-q])<=0;)T=q,(q=1+(q<<1))<=0&&(q=B);q>B&&(q=B);var ee=T;T=le-q,q=le-ee}for(T++;T<q;){var F=T+(q-T>>>1);pe(te,ce[fe+F])>0?T=F+1:q=F}return q}function A(te,ce,fe,_e,le,pe){var T=0,B=0,q=1;if(pe(te,ce[fe+le])<0){for(B=le+1;q<B&&pe(te,ce[fe+le-q])<0;)T=q,(q=1+(q<<1))<=0&&(q=B);q>B&&(q=B);var ee=T;T=le-q,q=le-ee}else{for(B=_e-le;q<B&&pe(te,ce[fe+le+q])>=0;)T=q,(q=1+(q<<1))<=0&&(q=B);q>B&&(q=B),T+=le,q+=le}for(T++;T<q;){var F=T+(q-T>>>1);pe(te,ce[fe+F])<0?q=F:T=F+1}return q}var P="TimSortAssertion",de=function(te){this.name=P,this.message=te},be=function(te,ce){var fe={array:te,compare:ce,minGallop:7,length:te.length,tmpStorageLength:256,stackLength:0,runStart:null,runLength:null,stackSize:0,pushRun:function(_e,le){this.runStart[this.stackSize]=_e,this.runLength[this.stackSize]=le,this.stackSize+=1},mergeRuns:function(){for(;this.stackSize>1;){var _e=this.stackSize-2;if(_e>=1&&this.runLength[_e-1]<=this.runLength[_e]+this.runLength[_e+1]||_e>=2&&this.runLength[_e-2]<=this.runLength[_e]+this.runLength[_e-1])this.runLength[_e-1]<this.runLength[_e+1]&&_e--;else if(this.runLength[_e]>this.runLength[_e+1])break;this.mergeAt(_e)}},forceMergeRuns:function(){for(;this.stackSize>1;){var _e=this.stackSize-2;_e>0&&this.runLength[_e-1]<this.runLength[_e+1]&&_e--,this.mergeAt(_e)}},mergeAt:function(_e){var le=this.compare,pe=this.array,T=this.runStart[_e],B=this.runLength[_e],q=this.runStart[_e+1],ee=this.runLength[_e+1];this.runLength[_e]=B+ee,_e===this.stackSize-3&&(this.runStart[_e+1]=this.runStart[_e+2],this.runLength[_e+1]=this.runLength[_e+2]),this.stackSize--;var F=A(pe[q],pe,T,B,0,le);T+=F,0!=(B-=F)&&0!==(ee=G(pe[T+B-1],pe,q,ee,ee-1,le))&&(B<=ee?this.mergeLow(T,B,q,ee):this.mergeHigh(T,B,q,ee))},mergeLow:function(_e,le,pe,T){var B=this.compare,q=this.array,ee=this.tmp,F=0;for(F=0;F<le;F++)ee[F]=q[_e+F];var Be=0,K=pe,ve=_e;if(q[ve++]=q[K++],0!=--T)if(1!==le){for(var Ae=this.minGallop;;){var Fe=0,Ee=0,qe=!1;do{if(B(q[K],ee[Be])<0){if(q[ve++]=q[K++],Ee++,Fe=0,0==--T){qe=!0;break}}else if(q[ve++]=ee[Be++],Fe++,Ee=0,1==--le){qe=!0;break}}while((Fe|Ee)<Ae);if(qe)break;do{if(0!==(Fe=A(q[K],ee,Be,le,0,B))){for(F=0;F<Fe;F++)q[ve+F]=ee[Be+F];if(ve+=Fe,Be+=Fe,(le-=Fe)<=1){qe=!0;break}}if(q[ve++]=q[K++],0==--T){qe=!0;break}if(0!==(Ee=G(ee[Be],q,K,T,0,B))){for(F=0;F<Ee;F++)q[ve+F]=q[K+F];if(ve+=Ee,K+=Ee,0==(T-=Ee)){qe=!0;break}}if(q[ve++]=ee[Be++],1==--le){qe=!0;break}Ae--}while(Fe>=7||Ee>=7);if(qe)break;Ae<0&&(Ae=0),Ae+=2}if(this.minGallop=Ae,Ae<1&&(this.minGallop=1),1===le){for(F=0;F<T;F++)q[ve+F]=q[K+F];q[ve+T]=ee[Be]}else{if(0===le)throw new de("mergeLow preconditions were not respected");for(F=0;F<le;F++)q[ve+F]=ee[Be+F]}}else{for(F=0;F<T;F++)q[ve+F]=q[K+F];q[ve+T]=ee[Be]}else for(F=0;F<le;F++)q[ve+F]=ee[Be+F]},mergeHigh:function(_e,le,pe,T){var B=this.compare,q=this.array,ee=this.tmp,F=0;for(F=0;F<T;F++)ee[F]=q[pe+F];var Be=_e+le-1,K=T-1,ve=pe+T-1,Ae=0,Fe=0;if(q[ve--]=q[Be--],0!=--le)if(1!==T){for(var Ee=this.minGallop;;){var qe=0,Ke=0,gt=!1;do{if(B(ee[K],q[Be])<0){if(q[ve--]=q[Be--],qe++,Ke=0,0==--le){gt=!0;break}}else if(q[ve--]=ee[K--],Ke++,qe=0,1==--T){gt=!0;break}}while((qe|Ke)<Ee);if(gt)break;do{if(0!=(qe=le-A(ee[K],q,_e,le,le-1,B))){for(le-=qe,Fe=1+(ve-=qe),Ae=1+(Be-=qe),F=qe-1;F>=0;F--)q[Fe+F]=q[Ae+F];if(0===le){gt=!0;break}}if(q[ve--]=ee[K--],1==--T){gt=!0;break}if(0!=(Ke=T-G(q[Be],ee,0,T,T-1,B))){for(T-=Ke,Fe=1+(ve-=Ke),Ae=1+(K-=Ke),F=0;F<Ke;F++)q[Fe+F]=ee[Ae+F];if(T<=1){gt=!0;break}}if(q[ve--]=q[Be--],0==--le){gt=!0;break}Ee--}while(qe>=7||Ke>=7);if(gt)break;Ee<0&&(Ee=0),Ee+=2}if(this.minGallop=Ee,Ee<1&&(this.minGallop=1),1===T){for(Fe=1+(ve-=le),Ae=1+(Be-=le),F=le-1;F>=0;F--)q[Fe+F]=q[Ae+F];q[ve]=ee[K]}else{if(0==T)throw new de("mergeHigh preconditions were not respected");for(Ae=ve-(T-1),F=0;F<T;F++)q[Ae+F]=ee[F]}}else{for(Fe=1+(ve-=le),Ae=1+(Be-=le),F=le-1;F>=0;F--)q[Fe+F]=q[Ae+F];q[ve]=ee[K]}else for(Ae=ve-(T-1),F=0;F<T;F++)q[Ae+F]=ee[F]}};return fe.length<512&&(fe.tmpStorageLength=fe.length>>>1),fe.tmp=new Array(fe.tmpStorageLength),fe.stackLength=fe.length<120?5:fe.length<1542?10:fe.length<119151?19:40,fe.runStart=new Array(fe.stackLength),fe.runLength=new Array(fe.stackLength),fe};n.$TimSort=function(te,ce){try{!function(fe,_e,le,pe){if(!Array.isArray(fe))throw TypeError.$factory("Can only sort arrays");_e?"function"!=typeof _e&&(pe=le,le=_e,_e=x):_e=x,le||(le=0),pe||(pe=fe.length);var T=pe-le;if(!(T<2)){var B=0;if(T<32)U(fe,le,pe,le+(B=N(fe,le,pe,_e)),_e);else{var q=new be(fe,_e),ee=function(Be){for(var K=0;Be>=32;)K|=1&Be,Be>>=1;return Be+K}(T);do{if((B=N(fe,le,pe,_e))<ee){var F=T;F>ee&&(F=ee),U(fe,le,le+F,le+B,_e),B=F}q.pushRun(le,B),q.mergeRuns(),T-=B,le+=B}while(0!==T);q.forceMergeRuns()}}}(te,ce,0,te.length)}catch(fe){if(fe.name!=P)throw fe;te.sort(ce)}},n.$AlphabeticalCompare=x}(__BRYTHON__),function(n){var o=n.builtins,l=o.object,x=n.$getattr,N=o.isinstance,U=o.None;function G(le,pe){if(le.__class__===ce)throw o.AttributeError.$factory("'tuple' object has no attribute '"+pe+"'")}var A={__class__:o.type,__mro__:[l],$infos:{__module__:"builtins",__name__:"list"},$is_class:!0,$native:!0,__dir__:l.__dir__,__add__:function(le,pe){if(n.get_class(le)!==n.get_class(pe)){var T=x(pe,"__radd__",o.NotImplemented);if(T!==o.NotImplemented)return T(le);throw o.TypeError.$factory('can only concatenate list (not "'+n.class_name(pe)+'") to list')}var B=le.slice(),q="js"==pe.$brython_class;for(const ee of pe)B.push(q?n.$JS2Py(ee):ee);return B.__brython__=!0,N(le,ce)&&(B=ce.$factory(B)),B},__class_getitem__:function(le,pe){return Array.isArray(pe)||(pe=[pe]),n.GenericAlias.$factory(le,pe)},__contains__:function(le,pe){for(var T=n.args("__contains__",2,{self:null,item:null},["self","item"],arguments,{},null,null),B=(le=T.self,pe=T.item,function(ee){return n.rich_comp("__eq__",pe,ee)}),q=0;q<le.length;){if(B(le[q]))return!0;q++}return!1},__delitem__:function(le,pe){if(N(pe,o.int)){var T=pe;if(pe<0&&(T=le.length+T),T>=0&&T<le.length)return le.splice(T,1),U;throw o.IndexError.$factory(n.class_name(le)+" index out of range")}if(N(pe,o.slice)){var B=pe.step;B===U&&(B=1);var q=pe.start;q===U&&(q=B>0?0:le.length);var ee=pe.stop;ee===U&&(ee=B>0?le.length:0),q<0&&(q=le.length+q),ee<0&&(ee=le.length+ee);var F=[],Be=null;if(T=0,B>0){if(ee>q)for(Be=q;Be<ee;Be+=B)void 0!==le[Be]&&(F[T++]=Be)}else if(ee<q){for(Be=q;Be>ee;Be+=B)void 0!==le[Be]&&(F[T++]=Be);F.reverse()}for(Be=F.length;Be--;)le.splice(F[Be],1);return U}if(o.hasattr(pe,"__int__")||o.hasattr(pe,"__index__"))return A.__delitem__(le,o.int.$factory(pe)),U;throw o.TypeError.$factory(n.class_name(le)+" indices must be integer, not "+n.class_name(pe))},__eq__:function(le,pe){if(N(le,A))var T=A;else T=ce;if(N(pe,T)&&pe.length==le.length){for(var B=le.length;B--;)if(!n.rich_comp("__eq__",le[B],pe[B]))return!1;return!0}return o.NotImplemented},__getitem__:function(le,pe){return n.check_no_kw("__getitem__",le,pe),n.check_nb_args("__getitem__",2,arguments),A.$getitem(le,pe)},$getitem:function(le,pe){var T=(le.__class__||n.get_class(le)).$factory;if(N(pe,o.int)){var B=le.valueOf(),q=pe;if(pe<0&&(q=B.length+q),q>=0&&q<B.length)return B[q];throw o.IndexError.$factory(n.class_name(le)+" index out of range")}if(pe.__class__===o.slice||N(pe,o.slice)){if(pe.start===o.None&&pe.stop===o.None&&pe.step===o.None)return le.slice();var ee=o.slice.$conv_for_seq(pe,le.length),F=[],Be=null,K=(B=le.valueOf(),q=0,ee.start),ve=ee.stop,Ae=ee.step;if(Ae>0){if(ve<=K)return T(F);for(Be=K;Be<ve;Be+=Ae)F[q++]=B[Be];return T(F)}if(ve>K)return T(F);for(Be=K;Be>ve;Be+=Ae)F[q++]=B[Be];return T(F)}if(o.hasattr(pe,"__int__")||o.hasattr(pe,"__index__"))return A.__getitem__(le,o.int.$factory(pe));throw o.TypeError.$factory(n.class_name(le)+" indices must be integer, not "+n.class_name(pe))},__ge__:function(le,pe){if(!N(pe,[A,o.tuple]))return o.NotImplemented;for(var T=0;T<le.length;){if(T>=pe.length)return!0;if(!n.rich_comp("__eq__",le[T],pe[T])){if(res=x(le[T],"__ge__")(pe[T]),res===o.NotImplemented)throw o.TypeError.$factory("unorderable types: "+n.class_name(le[T])+"() >= "+n.class_name(pe[T])+"()");return res}T++}return pe.length==le.length},__gt__:function(le,pe){if(!N(pe,[A,o.tuple]))return o.NotImplemented;for(var T=0;T<le.length;){if(T>=pe.length)return!0;if(!n.rich_comp("__eq__",le[T],pe[T])){if(res=x(le[T],"__gt__")(pe[T]),res===o.NotImplemented)throw o.TypeError.$factory("unorderable types: "+n.class_name(le[T])+"() > "+n.class_name(pe[T])+"()");return res}T++}return!1}};A.__hash__=U,A.__iadd__=function(){var le=n.args("__iadd__",2,{self:null,x:null},["self","x"],arguments,{},null,null),pe=x(le.x,"__radd__",o.NotImplemented);if(pe!==o.NotImplemented)return pe(le.self);for(var T=A.$factory(n.$iter(le.x)),B=0;B<T.length;B++)le.self.push(T[B]);return le.self},A.__imul__=function(){var le=n.args("__imul__",2,{self:null,x:null},["self","x"],arguments,{},null,null),pe=n.$GetInt(le.x),T=le.self.length,B=T;if(0==pe)return A.clear(le.self),le.self;for(var q=1;q<pe;q++)for(j=0;j<T;j++)le.self[B++]=le.self[j];return le.self},A.__init__=function(le,pe){var T=n.$call(x(le,"__len__")),B=x(le,"pop",U);if(B!==U)for(B=n.$call(B);T();)B();if(void 0===pe)return U;pe=n.$iter(pe);for(var q=n.$call(x(pe,"__next__")),ee=T();;)try{var F=q();le[ee++]=F}catch(Be){if(Be.__class__===o.StopIteration)break;throw Be}return U};var P=n.make_iterator_class("list_iterator");P.__reduce__=P.__reduce_ex__=function(le){return n.fast_tuple([o.iter,n.fast_tuple([A.$factory(le)]),0])},A.__iter__=function(le){return P.$factory(le)},A.__le__=function(le,pe){var T=A.__ge__(le,pe);return T===o.NotImplemented?T:!T},A.__len__=function(le){return le.length},A.__lt__=function(le,pe){if(!N(pe,[A,o.tuple]))return o.NotImplemented;for(var T=0;T<le.length;){if(T>=pe.length)return!1;if(!n.rich_comp("__eq__",le[T],pe[T])){if(res=x(le[T],"__lt__")(pe[T]),res===o.NotImplemented)throw o.TypeError.$factory("unorderable types: "+n.class_name(le[T])+"() >= "+n.class_name(pe[T])+"()");return res}T++}return pe.length>le.length},A.__mul__=function(le,pe){if(N(pe,o.int)){for(var T=[],B=le.slice(),q=B.length,ee=0;ee<pe;ee++)for(var F=0;F<q;F++)T.push(B[F]);return T.__class__=le.__class__,T}if(o.hasattr(pe,"__int__")||o.hasattr(pe,"__index__"))return A.__mul__(le,o.int.$factory(pe));var Be=n.$getattr(pe,"__rmul__",o.NotImplemented);if(Be!==o.NotImplemented)return Be(le);throw o.TypeError.$factory("can't multiply sequence by non-int of type '"+n.class_name(pe)+"'")},A.__new__=function(le,...pe){if(void 0===le)throw o.TypeError.$factory("list.__new__(): not enough arguments");var T=[];return T.__class__=le,T.__brython__=!0,T.__dict__=n.empty_dict(),T},A.__repr__=function(le){if(n.repr.enter(le))return"[...]";for(var pe,T=[],B=0;B<le.length;B++)T.push(o.repr(le[B]));return pe=le.__class__===ce?1==le.length?"("+T[0]+",)":"("+T.join(", ")+")":"["+T.join(", ")+"]",n.repr.leave(le),pe},A.__setattr__=function(le,pe,T){if(le.__class__===A)throw A.hasOwnProperty(pe)?o.AttributeError.$factory("'list' object attribute '"+pe+"' is read-only"):o.AttributeError.$factory("'list' object has no attribute '"+pe+"'");return o.dict.$setitem(le.__dict__,pe,T),U},A.__setitem__=function(){var le=n.args("__setitem__",3,{self:null,key:null,value:null},["self","key","value"],arguments,{},null,null);A.$setitem(le.self,le.key,le.value)},A.$setitem=function(le,pe,T){if("number"==typeof pe||N(pe,o.int)){var B=pe;if(pe<0&&(B=le.length+B),!(B>=0&&B<le.length))throw o.IndexError.$factory("list index out of range");return le[B]=T,U}if(N(pe,o.slice)){var q=o.slice.$conv_for_seq(pe,le.length);return null===pe.step?n.set_list_slice(le,q.start,q.stop,T):n.set_list_slice_step(le,q.start,q.stop,q.step,T),U}if(o.hasattr(pe,"__int__")||o.hasattr(pe,"__index__"))return A.__setitem__(le,o.int.$factory(pe),T),U;throw o.TypeError.$factory("list indices must be integer, not "+n.class_name(pe))},n.make_rmethods(A),A.append=function(le,pe){return n.check_no_kw("append",le,pe),n.check_nb_args("append",2,arguments),le.push(pe),U},A.clear=function(){for(var le=n.args("clear",1,{self:null},["self"],arguments,{},null,null);le.self.length;)le.self.pop();return U},A.copy=function(){return n.args("copy",1,{self:null},["self"],arguments,{},null,null).self.slice()},A.count=function(){for(var le=n.args("count",2,{self:null,x:null},["self","x"],arguments,{},null,null),pe=0,B=le.self.length;B--;)n.rich_comp("__eq__",le.x,le.self[B])&&pe++;return pe},A.extend=function(){for(var le=n.args("extend",2,{self:null,t:null},["self","t"],arguments,{},null,null),pe=A.$factory(n.$iter(le.t)),T=0;T<pe.length;T++)le.self.push(pe[T]);return U},A.index=function(){var le={},pe=n.args("index",4,{self:null,x:null,start:null,stop:null},["self","x","start","stop"],arguments,{start:0,stop:le},null,null),T=pe.self,B=pe.start,q=pe.stop;B.__class__===n.long_int&&(B=parseInt(B.value)*(B.pos?1:-1)),B<0&&(B=Math.max(0,B+T.length)),q===le?q=T.length:(q.__class__===n.long_int&&(q=parseInt(q.value)*(q.pos?1:-1)),q<0&&(q=Math.min(T.length,q+T.length)),q=Math.min(q,T.length));for(var F=B;F<q;F++)if(n.rich_comp("__eq__",pe.x,T[F]))return F;throw o.ValueError.$factory(o.repr(pe.x)+" is not in "+n.class_name(T))},A.insert=function(){var le=n.args("insert",3,{self:null,i:null,item:null},["self","i","item"],arguments,{},null,null);return le.self.splice(le.i,0,le.item),U},A.pop=function(){var le={},pe=n.args("pop",2,{self:null,pos:null},["self","pos"],arguments,{pos:le},null,null),T=pe.self,B=pe.pos;G(T,"pop"),B===le&&(B=T.length-1),(B=n.$GetInt(B))<0&&(B+=T.length);var q=T[B];if(void 0===q)throw o.IndexError.$factory("pop index out of range");return T.splice(B,1),q},A.remove=function(){for(var le=n.args("remove",2,{self:null,x:null},["self","x"],arguments,{},null,null),pe=0,T=le.self.length;pe<T;pe++)if(n.rich_comp("__eq__",le.self[pe],le.x))return le.self.splice(pe,1),U;throw o.ValueError.$factory(o.str.$factory(le.x)+" is not in list")},A.reverse=function(le){for(var pe=n.args("reverse",1,{self:null},["self"],arguments,{},null,null),T=pe.self.length-1,B=parseInt(pe.self.length/2);B--;){var q=pe.self[B];pe.self[B]=pe.self[T-B],pe.self[T-B]=q}return U},A.sort=function(le){var Be,pe=n.args("sort",1,{self:null},["self"],arguments,{},null,"kw");G(le,"sort");for(var T=U,B=!1,q=pe.kw,ee=o.list.$factory(o.dict.$$keys(q)),F=0;F<ee.length;F++)if("key"==ee[F])T=q.$string_dict[ee[F]][0];else{if("reverse"!=ee[F])throw o.TypeError.$factory("'"+ee[F]+"' is an invalid keyword argument for this function");B=q.$string_dict[ee[F]][0]}if(0!=le.length)return T!==U&&(T=n.$call(T)),le.$cl=function(K){if(0==K.length)return null;for(var ve=n.get_class(K[0]),Ae=K.length;Ae--;)if(n.get_class(K[Ae])!==ve)return!1;return ve}(le),Be=T===U&&le.$cl===o.str?B?function(K,ve){return n.$AlphabeticalCompare(ve,K)}:function(K,ve){return n.$AlphabeticalCompare(K,ve)}:T===U&&le.$cl===o.int?B?function(K,ve){return ve-K}:function(K,ve){return K-ve}:T===U?B?function(K,ve){if(res=x(ve,"__lt__")(K),res===o.NotImplemented)throw o.TypeError.$factory("unorderable types: "+n.class_name(K)+"() < "+n.class_name(ve)+"()");return res?ve==K?0:-1:1}:function(K,ve){if(res=x(K,"__lt__")(ve),res===o.NotImplemented)throw o.TypeError.$factory("unorderable types: "+n.class_name(K)+"() < "+n.class_name(ve)+"()");return res?K==ve?0:-1:1}:B?function(K,ve){var Ae=T(ve),Fe=T(K);if(res=x(Ae,"__lt__")(Fe),res===o.NotImplemented)throw o.TypeError.$factory("unorderable types: "+n.class_name(K)+"() < "+n.class_name(ve)+"()");return res?Ae==Fe?0:-1:1}:function(K,ve){var Ae=T(K),Fe=T(ve);if(res=n.$getattr(Ae,"__lt__")(Fe),res===o.NotImplemented)throw o.TypeError.$factory("unorderable types: "+n.class_name(K)+"() < "+n.class_name(ve)+"()");return res?Ae==Fe?0:-1:1},n.$TimSort(le,Be),le.__brython__?U:le},n.$list=function(le){return le.__brython__=!0,le},A.$factory=function(){if(0==arguments.length)return[];var le=n.args("list",1,{obj:null},["obj"],arguments,{},null,null).obj;if(Array.isArray(le))return(le=le.slice()).__brython__=!0,le.__class__==ce?((pe=le.slice()).__class__=A,pe):le;for(var pe=[],T=0,B=n.$iter(le),q=n.$call(x(B,"__next__"));;)try{pe[T++]=q()}catch(ee){if(!N(ee,o.StopIteration))throw ee;break}return pe.__brython__=!0,pe},n.set_func_names(A,"builtins"),A.__class_getitem__=o.classmethod.$factory(A.__class_getitem__);var de=n.JSArray=n.make_class("JSArray",function(le){return{__class__:de,js:le}});function be(le){for(var pe=[le[0].js],T=1,B=le.length;T<B;T++)pe.push(le[T]);return pe}for(var te in de.__repr__=de.__str__=function(){return"<JSArray object>"},A)void 0===n.JSArray[te]&&"function"==typeof A[te]&&(n.JSArray[te]=function(le){return function(){return n.$JS2Py(A[le].apply(null,be(arguments)))}}(te));n.set_func_names(n.JSArray,"builtins");var ce={__class__:o.type,__mro__:[l],$infos:{__module__:"builtins",__name__:"tuple"},$is_class:!0,$native:!0},fe=n.make_iterator_class("tuple_iterator");for(var te in ce.__iter__=function(pe){return fe.$factory(pe)},ce.$factory=function(){var pe=A.$factory(...arguments);return pe.__class__=ce,pe},n.fast_tuple=function(pe){return pe.__class__=ce,pe.__brython__=!0,pe.__dict__=n.empty_dict(),pe},A)switch(te){case"__delitem__":case"__iadd__":case"__imul__":case"__setitem__":case"append":case"extend":case"insert":case"remove":case"reverse":break;default:void 0===ce[te]&&"function"==typeof A[te]&&(ce[te]=function(pe){return function(){return A[pe].apply(null,arguments)}}(te))}function _e(le,pe){return s=(parseInt(le)*pe&4294967295).toString(16),parseInt(s.substr(0,s.length-1),16)}ce.__eq__=function(le,pe){return void 0===pe?le===ce:A.__eq__(le,pe)},ce.__hash__=function(le){for(var pe=54880137,T=0,B=le.length;T<B;T++){var q=o.hash(le[T]);pe=_e(1000003,pe)^4294967295&q}return pe},ce.__init__=function(){return U},ce.__new__=function(le,...pe){if(void 0===le)throw o.TypeError.$factory("list.__new__(): not enough arguments");var T=[];T.__class__=le,T.__brython__=!0,T.__dict__=n.empty_dict();for(var B=n.$iter(pe[0]),q=n.$call(x(B,"__next__"));;)try{var ee=q();T.push(ee)}catch(F){if(F.__class__===o.StopIteration)break;throw F}return T},n.set_func_names(ce,"builtins"),o.list=A,o.tuple=ce,o.object.__bases__=ce.$factory()}(__BRYTHON__);var $B=__BRYTHON__;for(var gc in $B.unicode={Cc:[[0,32],[127,33]],Zs:[32,160,5760,6158,[8192,11],8239,8287,12288],Po:[[33,3],[37,3],[42,3,2],47,58,59,63,64,92,161,183,191,894,903,[1370,6],1417,[1472,3,3],1523,1524,1545,1546,1548,1549,1563,1566,1567,[1642,4],1748,[1792,14],[2039,3],[2096,15],2404,2405,2416,3572,3663,3674,3675,[3844,15],3973,[4048,5],[4170,6],4347,[4961,8],5741,5742,[5867,3],5941,5942,[6100,3],[6104,3],[6144,6],[6151,4],6468,6469,6622,6623,6686,6687,[6816,7],[6824,6],[7002,7],[7227,5],7294,7295,7379,8214,8215,[8224,8],[8240,9],[8251,4],[8257,3],[8263,11],8275,[8277,10],[11513,4],11518,11519,11776,11777,[11782,3],11787,[11790,9],11800,11801,11803,11806,11807,[11818,5],11824,11825,[12289,3],12349,12539,42238,42239,[42509,3],42611,42622,[42738,6],[43124,4],43214,43215,[43256,3],43310,43311,43359,[43457,13],43486,43487,[43612,4],43742,43743,44011,[65040,7],65049,65072,65093,65094,[65097,4],[65104,3],[65108,4],[65119,3],65128,65130,65131,[65281,3],[65285,3],[65290,3,2],65295,65306,65307,65311,65312,65340,65377,65380,65381,65792,65793,66463,66512,67671,67871,67903,[68176,9],68223,[68409,7],69819,69820,[69822,4],[74864,4]],Sc:[36,[162,4],1547,2546,2547,2555,2801,3065,3647,6107,[8352,25],43064,65020,65129,65284,65504,65505,65509,65510],Ps:[40,91,123,3898,3900,5787,8218,8222,8261,8317,8333,9001,[10088,7,2],10181,[10214,5,2],[10627,11,2],10712,10714,10748,[11810,4,2],[12296,5,2],[12308,4,2],12317,64830,65047,[65077,8,2],65095,[65113,3,2],65288,65339,65371,65375,65378],Pe:[41,93,125,3899,3901,5788,8262,8318,8334,9002,[10089,7,2],10182,[10215,5,2],[10628,11,2],10713,10715,10749,[11811,4,2],[12297,5,2],[12309,4,2],12318,12319,64831,65048,[65078,8,2],65096,[65114,3,2],65289,65341,[65373,3,3]],Sm:[43,[60,3],124,126,172,177,215,247,1014,[1542,3],8260,8274,[8314,3],[8330,3],[8512,5],8523,[8592,5],8602,8603,[8608,3,3],8622,8654,8655,8658,8660,[8692,268],[8968,4],8992,8993,9084,[9115,25],[9180,6],9655,9665,[9720,8],9839,[10176,5],[10183,4],10188,[10192,22],[10224,16],[10496,131],[10649,63],[10716,32],[10750,258],[11056,21],[11079,6],64297,65122,[65124,3],65291,[65308,3],65372,65374,65506,[65513,4],120513,120539,120571,120597,120629,120655,120687,120713,120745,120771],Pd:[45,1418,1470,5120,6150,[8208,6],11799,11802,12316,12336,12448,65073,65074,65112,65123,65293],Nd:[[48,10],[1632,10],[1776,10],[1984,10],[2406,10],[2534,10],[2662,10],[2790,10],[2918,10],[3046,10],[3174,10],[3302,10],[3430,10],[3664,10],[3792,10],[3872,10],[4160,10],[4240,10],[6112,10],[6160,10],[6470,10],[6608,11],[6784,10],[6800,10],[6992,10],[7088,10],[7232,10],[7248,10],[42528,10],[43216,10],[43264,10],[43472,10],[43600,10],[44016,10],[65296,10],[66720,10],[120782,50]],Lu:[[65,26],[192,23],[216,7],[256,28,2],[313,8,2],[330,24,2],[377,3,2],385,[386,3,2],391,[393,3],[398,4],403,404,[406,3],412,413,415,[416,4,2],423,425,428,430,431,[433,3],437,439,440,444,[452,4,3],[463,7,2],[478,9,2],497,500,[502,3],[506,29,2],570,571,573,574,577,[579,4],[584,4,2],880,882,886,902,[904,3],908,910,911,[913,17],[931,9],975,[978,3],[984,12,2],1012,1015,1017,1018,[1021,51],[1120,17,2],[1162,28,2],[1217,7,2],[1232,43,2],[1329,38],[4256,38],[7680,75,2],[7838,49,2],[7944,8],[7960,6],[7976,8],[7992,8],[8008,6],[8025,4,2],[8040,8],[8120,4],[8136,4],[8152,4],[8168,5],[8184,4],8450,8455,[8459,3],[8464,3],8469,[8473,5],[8484,4,2],[8491,3],[8496,4],8510,8511,8517,8579,[11264,47],11360,[11362,3],[11367,4,2],[11374,3],11378,11381,[11390,3],[11394,49,2],11499,11501,[42560,16,2],[42594,6,2],[42624,12,2],[42786,7,2],[42802,31,2],[42873,3,2],[42878,5,2],42891,[65313,26],[66560,40],[119808,26],[119860,26],[119912,26],119964,119966,[119967,3,3],119974,[119977,4],[119982,8],[120016,26],120068,120069,[120071,4],[120077,8],[120086,7],120120,120121,[120123,4],[120128,5],120134,[120138,7],[120172,26],[120224,26],[120276,26],[120328,26],[120380,26],[120432,26],[120488,25],[120546,25],[120604,25],[120662,25],[120720,25],120778],Sk:[94,96,168,175,180,184,[706,4],[722,14],[741,7],749,[751,17],885,900,901,8125,[8127,3],[8141,3],[8157,3],[8173,3],8189,8190,12443,12444,[42752,23],42784,42785,42889,42890,65342,65344,65507],Pc:[95,8255,8256,8276,65075,65076,[65101,3],65343],Ll:[[97,26],170,181,186,[223,24],[248,8],[257,28,2],[312,9,2],[329,24,2],[378,3,2],383,384,387,389,392,396,397,402,405,[409,3],414,[417,3,2],424,426,427,429,432,436,438,441,442,[445,3],[454,3,3],[462,8,2],[477,10,2],496,499,501,[505,30,2],[564,6],572,575,576,578,[583,5,2],[592,68],[661,27],881,[883,3,4],892,893,912,[940,35],976,977,[981,3],[985,12,2],[1008,4],[1013,3,3],1020,[1072,48],[1121,17,2],[1163,27,2],[1218,7,2],[1231,44,2],[1377,39],[7424,44],[7522,22],[7545,34],[7681,75,2],[7830,8],[7839,49,2],[7936,8],[7952,6],[7968,8],[7984,8],[8e3,6],[8016,8],[8032,8],[8048,14],[8064,8],[8080,8],[8096,8],[8112,5],8118,8119,8126,[8130,3],8134,8135,[8144,4],8150,8151,[8160,8],[8178,3],8182,8183,8458,8462,8463,8467,[8495,3,5],8508,8509,[8518,4],8526,8580,[11312,47],11361,11365,[11366,4,2],11377,11379,11380,[11382,7],[11393,50,2],11492,11500,11502,[11520,38],[42561,16,2],[42595,6,2],[42625,12,2],[42787,7,2],42800,[42801,33,2],[42866,7],42874,42876,[42879,5,2],42892,[64256,7],[64275,5],[65345,26],[66600,40],[119834,26],[119886,7],[119894,18],[119938,26],[119990,4],119995,[119997,7],[120005,11],[120042,26],[120094,26],[120146,26],[120198,26],[120250,26],[120302,26],[120354,26],[120406,26],[120458,28],[120514,25],[120540,6],[120572,25],[120598,6],[120630,25],[120656,6],[120688,25],[120714,6],[120746,25],[120772,6],120779],So:[166,167,169,174,176,182,1154,1550,1551,1769,1789,1790,2038,2554,2928,[3059,6],3066,3199,3313,3314,3449,[3841,3],[3859,5],[3866,6],[3892,3,2],[4030,8],[4039,6],4046,4047,[4053,4],4254,4255,4960,[5008,10],6464,[6624,32],[7009,10],[7028,9],8448,8449,[8451,4],8456,8457,8468,[8470,3],[8478,6],[8485,3,2],8494,8506,8507,8522,8524,8525,8527,[8597,5],[8604,4],8609,8610,8612,8613,[8615,7],[8623,31],8656,[8657,3,2],[8662,30],[8960,8],[8972,20],[8994,7],[9003,81],[9085,30],[9140,40],[9186,7],[9216,39],[9280,11],[9372,78],[9472,183],[9656,9],[9666,54],[9728,111],[9840,94],[9935,19],9955,[9960,24],[9985,4],[9990,4],[9996,28],[10025,35],10061,[10063,4],[10070,9],[10081,7],10132,[10136,24],[10161,14],[10240,256],[11008,48],11077,11078,[11088,10],[11493,6],[11904,26],[11931,89],[12032,214],[12272,12],12292,12306,12307,12320,12342,12343,12350,12351,12688,12689,[12694,10],[12736,36],[12800,31],[12842,39],[12896,32],[12938,39],[12992,63],[13056,256],[19904,64],[42128,55],[43048,4],43062,43063,43065,[43639,3],65021,65508,65512,65517,65518,65532,65533,65794,[65847,9],[65913,17],[65936,12],[66e3,45],[118784,246],[119040,39],[119081,60],[119146,3],119171,119172,[119180,30],[119214,48],[119296,66],119365,[119552,87],[126976,44],[127024,100],[127248,31],127281,127293,127295,[127298,3,4],[127307,4],127319,127327,127353,127355,127356,127359,[127370,4],127376,127488,[127504,34],[127552,9]],Pi:[171,8216,8219,8220,8223,8249,11778,11780,11785,11788,11804,11808],Cf:[173,[1536,4],1757,1807,6068,6069,[8203,5],[8234,5],[8288,5],[8298,6],65279,[65529,3],69821,[119155,8],917505,[917536,96]],No:[178,179,185,[188,3],[2548,6],[3056,3],[3192,7],[3440,6],[3882,10],[4969,20],[6128,10],8304,[8308,6],[8320,10],[8528,16],8585,[9312,60],[9450,22],[10102,30],11517,[12690,4],[12832,10],[12881,15],[12928,10],[12977,15],[43056,6],[65799,45],[65909,4],65930,[66336,4],[67672,8],[67862,6],[68160,8],68221,68222,[68440,8],[68472,8],[69216,31],[119648,18],[127232,11]],Pf:[187,8217,8221,8250,11779,11781,11786,11789,11805,11809],Lo:[443,[448,4],660,[1488,27],[1520,3],[1569,31],[1601,10],1646,1647,[1649,99],1749,1774,1775,[1786,3],1791,1808,[1810,30],[1869,89],1969,[1994,33],[2048,22],[2308,54],2365,2384,[2392,10],2418,[2425,7],[2437,8],2447,2448,[2451,22],[2474,7],2482,[2486,4],2493,2510,2524,2525,[2527,3],2544,2545,[2565,6],2575,2576,[2579,22],[2602,7],2610,2611,2613,2614,2616,2617,[2649,4],2654,[2674,3],[2693,9],[2703,3],[2707,22],[2730,7],2738,2739,[2741,5],2749,2768,2784,2785,[2821,8],2831,2832,[2835,22],[2858,7],2866,2867,[2869,5],2877,2908,2909,[2911,3],2929,2947,[2949,6],[2958,3],[2962,4],2969,[2970,3,2],2975,2979,2980,[2984,3],[2990,12],3024,[3077,8],[3086,3],[3090,23],[3114,10],[3125,5],3133,3160,3161,3168,3169,[3205,8],[3214,3],[3218,23],[3242,10],[3253,5],3261,3294,3296,3297,[3333,8],[3342,3],[3346,23],[3370,16],3389,3424,3425,[3450,6],[3461,18],[3482,24],[3507,9],3517,[3520,7],[3585,48],3634,3635,[3648,6],3713,3714,3716,3719,3720,3722,3725,[3732,4],[3737,7],[3745,3],3749,3751,3754,3755,[3757,4],3762,3763,3773,[3776,5],3804,3805,3840,[3904,8],[3913,36],[3976,4],[4096,43],4159,[4176,6],[4186,4],4193,4197,4198,[4206,3],[4213,13],4238,[4304,43],[4352,329],[4682,4],[4688,7],4696,[4698,4],[4704,41],[4746,4],[4752,33],[4786,4],[4792,7],4800,[4802,4],[4808,15],[4824,57],[4882,4],[4888,67],[4992,16],[5024,85],[5121,620],[5743,17],[5761,26],[5792,75],[5888,13],[5902,4],[5920,18],[5952,18],[5984,13],[5998,3],[6016,52],6108,[6176,35],[6212,52],[6272,41],6314,[6320,70],[6400,29],[6480,30],[6512,5],[6528,44],[6593,7],[6656,23],[6688,53],[6917,47],[6981,7],[7043,30],7086,7087,[7168,36],[7245,3],[7258,30],[7401,4],[7406,4],[8501,4],[11568,54],[11648,23],[11680,7],[11688,7],[11696,7],[11704,7],[11712,7],[11720,7],[11728,7],[11736,7],12294,12348,[12353,86],12447,[12449,90],12543,[12549,41],[12593,94],[12704,24],[12784,16],13312,19893,19968,40907,[40960,21],[40982,1143],[42192,40],[42240,268],[42512,16],42538,42539,42606,[42656,70],[43003,7],[43011,3],[43015,4],[43020,23],[43072,52],[43138,50],[43250,6],43259,[43274,28],[43312,23],[43360,29],[43396,47],[43520,41],[43584,3],[43588,8],[43616,16],[43633,6],43642,[43648,48],43697,43701,43702,[43705,5],43712,43714,43739,43740,[43968,35],44032,55203,[55216,23],[55243,49],[63744,302],[64048,62],[64112,106],64285,[64287,10],[64298,13],[64312,5],64318,64320,64321,64323,64324,[64326,108],[64467,363],[64848,64],[64914,54],[65008,12],[65136,5],[65142,135],[65382,10],[65393,45],[65440,31],[65474,6],[65482,6],[65490,6],[65498,3],[65536,12],[65549,26],[65576,19],65596,65597,[65599,15],[65616,14],[65664,123],[66176,29],[66208,49],[66304,31],[66352,17],[66370,8],[66432,30],[66464,36],[66504,8],[66640,78],[67584,6],67592,[67594,44],67639,67640,67644,[67647,23],[67840,22],[67872,26],68096,[68112,4],[68117,3],[68121,27],[68192,29],[68352,54],[68416,22],[68448,19],[68608,73],[69763,45],[73728,879],[77824,1071],131072,173782,173824,177972,[194560,542]],Lt:[[453,3,3],498,[8072,8],[8088,8],[8104,8],8124,8140,8188],Lm:[[688,18],[710,12],[736,5],748,750,884,890,1369,1600,1765,1766,2036,2037,2042,2074,2084,2088,2417,3654,3782,4348,6103,6211,6823,[7288,6],[7468,54],7544,[7579,37],8305,8319,[8336,5],11389,11631,11823,12293,[12337,5],12347,12445,12446,[12540,3],40981,[42232,6],42508,42623,[42775,9],42864,42888,43471,43632,43741,65392,65438,65439],Mn:[[768,112],[1155,5],[1425,45],1471,1473,1474,1476,1477,1479,[1552,11],[1611,20],1648,[1750,7],[1759,6],1767,1768,[1770,4],1809,[1840,27],[1958,11],[2027,9],[2070,4],[2075,9],[2085,3],[2089,5],[2304,3],2364,[2369,8],2381,[2385,5],2402,2403,2433,2492,[2497,4],2509,2530,2531,2561,2562,2620,2625,2626,2631,2632,[2635,3],2641,2672,2673,2677,2689,2690,2748,[2753,5],2759,2760,2765,2786,2787,2817,2876,2879,[2881,4],2893,2902,2914,2915,2946,3008,3021,[3134,3],[3142,3],[3146,4],3157,3158,3170,3171,3260,3263,3270,3276,3277,3298,3299,[3393,4],3405,3426,3427,3530,[3538,3],3542,3633,[3636,7],[3655,8],3761,[3764,6],3771,3772,[3784,6],3864,3865,[3893,3,2],[3953,14],[3968,5],3974,3975,[3984,8],[3993,36],4038,[4141,4],[4146,6],4153,4154,4157,4158,4184,4185,[4190,3],[4209,4],4226,4229,4230,4237,4253,4959,[5906,3],[5938,3],5970,5971,6002,6003,[6071,7],6086,[6089,11],6109,[6155,3],6313,[6432,3],6439,6440,6450,[6457,3],6679,6680,6742,[6744,7],6752,6754,[6757,8],[6771,10],6783,[6912,4],6964,[6966,5],6972,6978,[7019,9],7040,7041,[7074,4],7080,7081,[7212,8],7222,7223,[7376,3],[7380,13],[7394,7],7405,[7616,39],[7677,3],[8400,13],8417,[8421,12],[11503,3],[11744,32],[12330,6],12441,12442,42607,42620,42621,42736,42737,43010,43014,43019,43045,43046,43204,[43232,18],[43302,8],[43335,11],[43392,3],43443,[43446,4],43452,[43561,6],43569,43570,43573,43574,43587,43596,43696,[43698,3],43703,43704,43710,43711,43713,44005,44008,44013,64286,[65024,16],[65056,7],66045,[68097,3],68101,68102,[68108,4],[68152,3],68159,69760,69761,[69811,4],69817,69818,[119143,3],[119163,8],[119173,7],[119210,4],[119362,3],[917760,240]],Me:[1160,1161,1758,[8413,4],[8418,3],[42608,3]],Mc:[2307,[2366,3],[2377,4],2382,2434,2435,[2494,3],2503,2504,2507,2508,2519,2563,[2622,3],2691,[2750,3],2761,2763,2764,2818,2819,2878,2880,2887,2888,2891,2892,2903,3006,3007,3009,3010,[3014,3],[3018,3],3031,[3073,3],[3137,4],3202,3203,3262,[3264,5],3271,3272,3274,3275,3285,3286,3330,3331,[3390,3],[3398,3],[3402,3],3415,3458,3459,[3535,3],[3544,8],3570,3571,3902,3903,3967,4139,4140,4145,4152,4155,4156,4182,4183,[4194,3],[4199,7],4227,4228,[4231,6],4239,[4250,3],6070,[6078,8],6087,6088,[6435,4],[6441,3],6448,6449,[6451,6],[6576,17],6600,6601,[6681,3],6741,6743,6753,6755,6756,[6765,6],6916,6965,6971,[6973,5],6979,6980,7042,7073,7078,7079,7082,[7204,8],7220,7221,7393,7410,43043,43044,43047,43136,43137,[43188,16],43346,43347,43395,43444,43445,43450,43451,[43453,4],43567,43568,43571,43572,43597,43643,44003,44004,44006,44007,44009,44010,44012,69762,[69808,3],69815,69816,119141,119142,[119149,6]],Nl:[[5870,3],[8544,35],[8581,4],12295,[12321,9],[12344,3],[42726,10],[65856,53],66369,66378,[66513,5],[74752,99]],Zl:[8232],Zp:[8233],Cs:[55296,56191,56192,56319,56320,57343],Co:[57344,63743,983040,1048573,1048576,1114109],digits:[[48,10],178,179,185,[1632,10],[1776,10],[1984,10],[2406,10],[2534,10],[2662,10],[2790,10],[2918,10],[3046,10],[3174,10],[3302,10],[3430,10],[3558,10],[3664,10],[3792,10],[3872,10],[4160,10],[4240,10],[4969,9],[6112,10],[6160,10],[6470,10],[6608,11],[6784,10],[6800,10],[6992,10],[7088,10],[7232,10],[7248,10],8304,[8308,6],[8320,10],[9312,9],[9332,9],[9352,9],9450,[9461,9],9471,[10102,9],[10112,9],[10122,9],[42528,10],[43216,10],[43264,10],[43472,10],[43504,10],[43600,10],[44016,10],[65296,10],[66720,10],[68160,4],[68912,10],[69216,9],[69714,9],[69734,10],[69872,10],[69942,10],[70096,10],[70384,10],[70736,10],[70864,10],[71248,10],[71360,10],[71472,10],[71904,10],[72784,10],[73040,10],[73120,10],[92768,10],[93008,10],[120782,50],[123200,10],[123632,10],[125264,10],[127232,11]],numeric:[[48,10],178,179,185,[188,3],[1632,10],[1776,10],[1984,10],[2406,10],[2534,10],[2548,6],[2662,10],[2790,10],[2918,10],[2930,6],[3046,13],[3174,10],[3192,7],[3302,10],[3416,7],[3430,19],[3558,10],[3664,10],[3792,10],[3872,20],[4160,10],[4240,10],[4969,20],[5870,3],[6112,10],[6128,10],[6160,10],[6470,10],[6608,11],[6784,10],[6800,10],[6992,10],[7088,10],[7232,10],[7248,10],8304,[8308,6],[8320,10],[8528,51],[8581,5],[9312,60],[9450,22],[10102,30],11517,12295,[12321,9],[12344,3],[12690,4],[12832,10],[12872,8],[12881,15],[12928,10],[12977,15],13317,13443,14378,15181,19968,19971,19975,19977,20061,20108,20116,20118,20159,20160,20191,20200,20237,20336,20740,20806,[20841,3,2],21313,[21315,3],21324,[21441,4],22235,22769,22777,24186,24318,24319,[24332,3],24336,25342,25420,26578,28422,29590,30334,32902,33836,36014,36019,36144,38433,38470,38476,38520,38646,[42528,10],[42726,10],[43056,6],[43216,10],[43264,10],[43472,10],[43504,10],[43600,10],[44016,10],63851,63859,63864,63922,63953,63955,63997,[65296,10],[65799,45],[65856,57],65930,65931,[66273,27],[66336,4],66369,66378,[66513,5],[66720,10],[67672,8],[67705,7],[67751,9],[67835,5],[67862,6],68028,68029,[68032,16],[68050,46],[68160,9],68221,68222,[68253,3],[68331,5],[68440,8],[68472,8],[68521,7],[68858,6],[68912,10],[69216,31],[69405,10],[69457,4],[69714,30],[69872,10],[69942,10],[70096,10],[70113,20],[70384,10],[70736,10],[70864,10],[71248,10],[71360,10],[71472,12],[71904,19],[72784,29],[73040,10],[73120,10],[73664,21],[74752,111],[92768,10],[93008,10],[93019,7],[93824,23],[119520,20],[119648,25],[120782,50],[123200,10],[123632,10],[125127,9],[125264,10],[126065,59],[126125,3],[126129,4],[126209,45],[126255,15],[127232,13],131073,131172,131298,131361,133418,133507,133516,133532,133866,133885,133913,140176,141720,146203,156269,194704],Cn:[[888,2],[896,4],[907,1],[909,1],[930,1],[1328,1],[1367,2],[1419,2],[1424,1],[1480,8],[1515,4],[1525,11],[1565,1],[1806,1],[1867,2],[1970,14],[2043,2],[2094,2],[2111,1],[2140,2],[2143,1],[2155,53],[2229,1],[2238,21],[2436,1],[2445,2],[2449,2],[2473,1],[2481,1],[2483,3],[2490,2],[2501,2],[2505,2],[2511,8],[2520,4],[2526,1],[2532,2],[2559,2],[2564,1],[2571,4],[2577,2],[2601,1],[2609,1],[2612,1],[2615,1],[2618,2],[2621,1],[2627,4],[2633,2],[2638,3],[2642,7],[2653,1],[2655,7],[2679,10],[2692,1],[2702,1],[2706,1],[2729,1],[2737,1],[2740,1],[2746,2],[2758,1],[2762,1],[2766,2],[2769,15],[2788,2],[2802,7],[2816,1],[2820,1],[2829,2],[2833,2],[2857,1],[2865,1],[2868,1],[2874,2],[2885,2],[2889,2],[2894,8],[2904,4],[2910,1],[2916,2],[2936,10],[2948,1],[2955,3],[2961,1],[2966,3],[2971,1],[2973,1],[2976,3],[2981,3],[2987,3],[3002,4],[3011,3],[3017,1],[3022,2],[3025,6],[3032,14],[3067,5],[3085,1],[3089,1],[3113,1],[3130,3],[3141,1],[3145,1],[3150,7],[3159,1],[3163,5],[3172,2],[3184,7],[3213,1],[3217,1],[3241,1],[3252,1],[3258,2],[3269,1],[3273,1],[3278,7],[3287,7],[3295,1],[3300,2],[3312,1],[3315,13],[3332,1],[3341,1],[3345,1],[3397,1],[3401,1],[3408,4],[3428,2],[3456,2],[3460,1],[3479,3],[3506,1],[3516,1],[3518,2],[3527,3],[3531,4],[3541,1],[3543,1],[3552,6],[3568,2],[3573,12],[3643,4],[3676,37],[3715,1],[3717,1],[3723,1],[3748,1],[3750,1],[3774,2],[3781,1],[3783,1],[3790,2],[3802,2],[3808,32],[3912,1],[3949,4],[3992,1],[4029,1],[4045,1],[4059,37],[4294,1],[4296,5],[4302,2],[4681,1],[4686,2],[4695,1],[4697,1],[4702,2],[4745,1],[4750,2],[4785,1],[4790,2],[4799,1],[4801,1],[4806,2],[4823,1],[4881,1],[4886,2],[4955,2],[4989,3],[5018,6],[5110,2],[5118,2],[5789,3],[5881,7],[5901,1],[5909,11],[5943,9],[5972,12],[5997,1],[6001,1],[6004,12],[6110,2],[6122,6],[6138,6],[6159,1],[6170,6],[6265,7],[6315,5],[6390,10],[6431,1],[6444,4],[6460,4],[6465,3],[6510,2],[6517,11],[6572,4],[6602,6],[6619,3],[6684,2],[6751,1],[6781,2],[6794,6],[6810,6],[6830,2],[6847,65],[6988,4],[7037,3],[7156,8],[7224,3],[7242,3],[7305,7],[7355,2],[7368,8],[7419,5],[7674,1],[7958,2],[7966,2],[8006,2],[8014,2],[8024,1],[8026,1],[8028,1],[8030,1],[8062,2],[8117,1],[8133,1],[8148,2],[8156,1],[8176,2],[8181,1],[8191,1],[8293,1],[8306,2],[8335,1],[8349,3],[8384,16],[8433,15],[8588,4],[9255,25],[9291,21],[11124,2],[11158,2],[11311,1],[11359,1],[11508,5],[11558,1],[11560,5],[11566,2],[11624,7],[11633,14],[11671,9],[11687,1],[11695,1],[11703,1],[11711,1],[11719,1],[11727,1],[11735,1],[11743,1],[11856,48],[11930,1],[12020,12],[12246,26],[12284,4],[12352,1],[12439,2],[12544,5],[12592,1],[12687,1],[12731,5],[12772,12],[12831,1],[19894,10],[40944,16],[42125,3],[42183,9],[42540,20],[42744,8],[42944,2],[42951,48],[43052,4],[43066,6],[43128,8],[43206,8],[43226,6],[43348,11],[43389,3],[43470,1],[43482,4],[43519,1],[43575,9],[43598,2],[43610,2],[43715,24],[43767,10],[43783,2],[43791,2],[43799,9],[43815,1],[43823,1],[43880,8],[44014,2],[44026,6],[55204,12],[55239,4],[55292,4],[64110,2],[64218,38],[64263,12],[64280,5],[64311,1],[64317,1],[64319,1],[64322,1],[64325,1],[64450,17],[64832,16],[64912,2],[64968,40],[65022,2],[65050,6],[65107,1],[65127,1],[65132,4],[65141,1],[65277,2],[65280,1],[65471,3],[65480,2],[65488,2],[65496,2],[65501,3],[65511,1],[65519,10],[65534,2],[65548,1],[65575,1],[65595,1],[65598,1],[65614,2],[65630,34],[65787,5],[65795,4],[65844,3],[65935,1],[65948,4],[65953,47],[66046,130],[66205,3],[66257,15],[66300,4],[66340,9],[66379,5],[66427,5],[66462,1],[66500,4],[66518,42],[66718,2],[66730,6],[66772,4],[66812,4],[66856,8],[66916,11],[66928,144],[67383,9],[67414,10],[67432,152],[67590,2],[67593,1],[67638,1],[67641,3],[67645,2],[67670,1],[67743,8],[67760,48],[67827,1],[67830,5],[67868,3],[67898,5],[67904,64],[68024,4],[68048,2],[68100,1],[68103,5],[68116,1],[68120,1],[68150,2],[68155,4],[68169,7],[68185,7],[68256,32],[68327,4],[68343,9],[68406,3],[68438,2],[68467,5],[68498,7],[68509,12],[68528,80],[68681,55],[68787,13],[68851,7],[68904,8],[68922,294],[69247,129],[69416,8],[69466,134],[69623,9],[69710,4],[69744,15],[69826,11],[69838,2],[69865,7],[69882,6],[69941,1],[69959,9],[70007,9],[70094,2],[70112,1],[70133,11],[70162,1],[70207,65],[70279,1],[70281,1],[70286,1],[70302,1],[70314,6],[70379,5],[70394,6],[70404,1],[70413,2],[70417,2],[70441,1],[70449,1],[70452,1],[70458,1],[70469,2],[70473,2],[70478,2],[70481,6],[70488,5],[70500,2],[70509,3],[70517,139],[70746,1],[70748,1],[70752,32],[70856,8],[70874,166],[71094,2],[71134,34],[71237,11],[71258,6],[71277,19],[71353,7],[71370,54],[71451,2],[71468,4],[71488,192],[71740,100],[71923,12],[71936,160],[72104,2],[72152,2],[72165,27],[72264,8],[72355,29],[72441,263],[72713,1],[72759,1],[72774,10],[72813,3],[72848,2],[72872,1],[72887,73],[72967,1],[72970,1],[73015,3],[73019,1],[73022,1],[73032,8],[73050,6],[73062,1],[73065,1],[73103,1],[73106,1],[73113,7],[73130,310],[73465,199],[73714,13],[74650,102],[74863,1],[74869,11],[75076,2748],[78895,1],[78905,4039],[83527,8633],[92729,7],[92767,1],[92778,4],[92784,96],[92910,2],[92918,10],[92998,10],[93018,1],[93026,1],[93048,5],[93072,688],[93851,101],[94027,4],[94088,7],[94112,64],[94180,28],[100344,8],[101107,9485],[110879,49],[110931,17],[110952,8],[111356,2308],[113771,5],[113789,3],[113801,7],[113818,2],[113828,4956],[119030,10],[119079,2],[119273,23],[119366,154],[119540,12],[119639,9],[119673,135],[119893,1],[119965,1],[119968,2],[119971,2],[119975,2],[119981,1],[119994,1],[119996,1],[120004,1],[120070,1],[120075,2],[120085,1],[120093,1],[120122,1],[120127,1],[120133,1],[120135,3],[120145,1],[120486,2],[120780,2],[121484,15],[121504,1],[121520,1360],[122887,1],[122905,2],[122914,1],[122917,1],[122923,213],[123181,3],[123198,2],[123210,4],[123216,368],[123642,5],[123648,1280],[125125,2],[125143,41],[125260,4],[125274,4],[125280,785],[126133,76],[126270,194],[126468,1],[126496,1],[126499,1],[126501,2],[126504,1],[126515,1],[126520,1],[126522,1],[126524,6],[126531,4],[126536,1],[126538,1],[126540,1],[126544,1],[126547,1],[126549,2],[126552,1],[126554,1],[126556,1],[126558,1],[126560,1],[126563,1],[126565,2],[126571,1],[126579,1],[126584,1],[126589,1],[126591,1],[126602,1],[126620,5],[126628,1],[126634,1],[126652,52],[126706,270],[127020,4],[127124,12],[127151,2],[127168,1],[127184,1],[127222,10],[127245,3],[127341,3],[127405,57],[127491,13],[127548,4],[127561,7],[127570,14],[127590,154],[128726,10],[128749,3],[128763,5],[128884,12],[128985,7],[129004,20],[129036,4],[129096,8],[129114,6],[129160,8],[129198,82],[129292,1],[129394,1],[129399,3],[129443,2],[129451,3],[129483,2],[129620,12],[129646,2],[129652,4],[129659,5],[129667,13],[129686,1386],[173783,41],[177973,11],[178206,2],[183970,14],[191457,3103],[195102,722403],[917506,30],[917632,128],[918e3,65040],[1048574,2]]},$B.unicode_casefold={223:[115,115],304:[105,775],329:[700,110],496:[106,780],912:[953,776,769],944:[965,776,769],1415:[1381,1410],7830:[104,817],7831:[116,776],7832:[119,778],7833:[121,778],7834:[97,702],7838:[223],8016:[965,787],8018:[965,787,768],8020:[965,787,769],8022:[965,787,834],8064:[7936,953],8065:[7937,953],8066:[7938,953],8067:[7939,953],8068:[7940,953],8069:[7941,953],8070:[7942,953],8071:[7943,953],8072:[8064],8073:[8065],8074:[8066],8075:[8067],8076:[8068],8077:[8069],8078:[8070],8079:[8071],8080:[7968,953],8081:[7969,953],8082:[7970,953],8083:[7971,953],8084:[7972,953],8085:[7973,953],8086:[7974,953],8087:[7975,953],8088:[8080],8089:[8081],8090:[8082],8091:[8083],8092:[8084],8093:[8085],8094:[8086],8095:[8087],8096:[8032,953],8097:[8033,953],8098:[8034,953],8099:[8035,953],8100:[8036,953],8101:[8037,953],8102:[8038,953],8103:[8039,953],8104:[8096],8105:[8097],8106:[8098],8107:[8099],8108:[8100],8109:[8101],8110:[8102],8111:[8103],8114:[8048,953],8115:[945,953],8116:[940,953],8118:[945,834],8119:[945,834,953],8124:[8115],8130:[8052,953],8131:[951,953],8132:[942,953],8134:[951,834],8135:[951,834,953],8140:[8131],8146:[953,776,768],8147:[953,776,769],8150:[953,834],8151:[953,776,834],8162:[965,776,768],8163:[965,776,769],8164:[961,787],8166:[965,834],8167:[965,776,834],8178:[8060,953],8179:[969,953],8180:[974,953],8182:[969,834],8183:[969,834,953],8188:[8179],64256:[102,102],64257:[102,105],64258:[102,108],64259:[102,102,105],64260:[102,102,108],64261:[115,116],64262:[115,116],64275:[1396,1398],64276:[1396,1381],64277:[1396,1387],64278:[1406,1398],64279:[1396,1389]},$B.unicode_bidi_whitespace=[9,10,11,12,13,28,29,30,31,32,133,5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8232,8233,8287,12288],$B.unicode_identifiers={XID_Start:[95,[65,26],[97,26],170,181,186,[192,23],[216,31],[248,458],[710,12],[736,5],748,750,[880,5],[886,2],[891,3],902,[904,3],908,[910,20],[931,83],[1015,139],[1162,156],[1329,38],1369,[1377,39],[1488,27],[1520,3],[1569,42],[1646,2],[1649,99],1749,[1765,2],[1774,2],[1786,3],1791,1808,[1810,30],[1869,89],1969,[1994,33],[2036,2],2042,[2048,22],2074,2084,2088,[2308,54],2365,2384,[2392,10],2417,2418,[2425,7],[2437,8],[2447,2],[2451,22],[2474,7],2482,[2486,4],2493,2510,[2524,2],[2527,3],[2544,2],[2565,6],[2575,2],[2579,22],[2602,7],[2610,2],[2613,2],[2616,2],[2649,4],2654,[2674,3],[2693,9],[2703,3],[2707,22],[2730,7],[2738,2],[2741,5],2749,2768,[2784,2],[2821,8],[2831,2],[2835,22],[2858,7],[2866,2],[2869,5],2877,[2908,2],[2911,3],2929,2947,[2949,6],[2958,3],[2962,4],[2969,2],2972,[2974,2],[2979,2],[2984,3],[2990,12],3024,[3077,8],[3086,3],[3090,23],[3114,10],[3125,5],3133,[3160,2],[3168,2],[3205,8],[3214,3],[3218,23],[3242,10],[3253,5],3261,3294,[3296,2],[3333,8],[3342,3],[3346,23],[3370,16],3389,[3424,2],[3450,6],[3461,18],[3482,24],[3507,9],3517,[3520,7],[3585,48],3634,[3648,7],[3713,2],3716,[3719,2],3722,3725,[3732,4],[3737,7],[3745,3],3749,3751,[3754,2],[3757,4],3762,3773,[3776,5],3782,[3804,2],3840,[3904,8],[3913,36],[3976,4],[4096,43],4159,[4176,6],[4186,4],4193,[4197,2],[4206,3],[4213,13],4238,[4256,38],[4304,43],4348,[4352,329],[4682,4],[4688,7],4696,[4698,4],[4704,41],[4746,4],[4752,33],[4786,4],[4792,7],4800,[4802,4],[4808,15],[4824,57],[4882,4],[4888,67],[4992,16],[5024,85],[5121,620],[5743,17],[5761,26],[5792,75],[5870,3],[5888,13],[5902,4],[5920,18],[5952,18],[5984,13],[5998,3],[6016,52],6103,6108,[6176,88],[6272,41],6314,[6320,70],[6400,29],[6480,30],[6512,5],[6528,44],[6593,7],[6656,23],[6688,53],6823,[6917,47],[6981,7],[7043,30],[7086,2],[7168,36],[7245,3],[7258,36],[7401,4],[7406,4],[7424,192],[7680,278],[7960,6],[7968,38],[8008,6],[8016,8],8025,8027,8029,[8031,31],[8064,53],[8118,7],8126,[8130,3],[8134,7],[8144,4],[8150,6],[8160,13],[8178,3],[8182,7],8305,8319,[8336,5],8450,8455,[8458,10],8469,8472,[8473,5],8484,8486,8488,[8490,16],[8508,4],[8517,5],8526,[8544,41],[11264,47],[11312,47],[11360,133],[11499,4],[11520,38],[11568,54],11631,[11648,23],[11680,7],[11688,7],[11696,7],[11704,7],[11712,7],[11720,7],[11728,7],[11736,7],12293,12294,12295,[12321,9],[12337,5],[12344,5],[12353,86],[12445,3],[12449,90],[12540,4],[12549,41],[12593,94],[12704,24],[12784,16],[13312,6582],[19968,20940],[40960,1165],[42192,46],[42240,269],[42512,16],[42538,2],[42560,32],[42594,13],42623,[42624,24],[42656,80],[42775,9],[42786,103],[42891,2],[43003,7],[43011,3],[43015,4],[43020,23],[43072,52],[43138,50],[43250,6],43259,[43274,28],[43312,23],[43360,29],[43396,47],43471,[43520,41],[43584,3],[43588,8],[43616,23],43642,[43648,48],43697,[43701,2],[43705,5],43712,43714,[43739,3],[43968,35],[44032,11172],[55216,23],[55243,49],[63744,302],[64048,62],[64112,106],[64256,7],[64275,5],64285,[64287,10],[64298,13],[64312,5],64318,[64320,2],[64323,2],[64326,108],[64467,139],[64612,218],[64848,64],[64914,54],[65008,10],65137,65139,65143,65145,65147,65149,[65151,126],[65313,26],[65345,26],[65382,56],[65440,31],[65474,6],[65482,6],[65490,6],[65498,3],[65536,12],[65549,26],[65576,19],[65596,2],[65599,15],[65616,14],[65664,123],[65856,53],[66176,29],[66208,49],[66304,31],[66352,27],[66432,30],[66464,36],[66504,8],[66513,5],[66560,158],[67584,6],67592,[67594,44],[67639,2],67644,[67647,23],[67840,22],[67872,26],68096,[68112,4],[68117,3],[68121,27],[68192,29],[68352,54],[68416,22],[68448,19],[68608,73],[69763,45],[73728,879],[74752,99],[77824,1071],[119808,85],[119894,71],[119966,2],119970,[119973,2],[119977,4],[119982,12],119995,[119997,7],[120005,65],[120071,4],[120077,8],[120086,7],[120094,28],[120123,4],[120128,5],120134,[120138,7],[120146,340],[120488,25],[120514,25],[120540,31],[120572,25],[120598,31],[120630,25],[120656,31],[120688,25],[120714,31],[120746,25],[120772,8],[131072,42711],[173824,4149],[194560,542]],XID_Continue:[[48,10],[65,26],95,[97,26],170,181,183,186,[192,23],[216,31],[248,458],[710,12],[736,5],748,750,[768,117],[886,2],[891,3],902,903,[904,3],908,[910,20],[931,83],[1015,139],[1155,5],[1162,156],[1329,38],1369,[1377,39],[1425,45],1471,[1473,2],[1476,2],1479,[1488,27],[1520,3],[1552,11],[1569,62],[1632,10],[1646,102],1749,[1750,7],[1759,10],[1770,19],1791,1808,1809,[1810,57],[1869,101],[1984,54],2042,[2048,46],[2304,58],2364,2365,[2366,17],2384,[2385,5],[2392,12],[2406,10],2417,2418,[2425,7],2433,[2434,2],[2437,8],[2447,2],[2451,22],[2474,7],2482,[2486,4],2492,2493,[2494,7],[2503,2],[2507,4],2519,[2524,2],[2527,5],[2534,12],[2561,3],[2565,6],[2575,2],[2579,22],[2602,7],[2610,2],[2613,2],[2616,2],2620,[2622,5],[2631,2],[2635,3],2641,[2649,4],2654,[2662,16],[2689,3],[2693,9],[2703,3],[2707,22],[2730,7],[2738,2],[2741,5],2748,2749,[2750,8],[2759,3],[2763,3],2768,[2784,4],[2790,10],2817,[2818,2],[2821,8],[2831,2],[2835,22],[2858,7],[2866,2],[2869,5],2876,2877,2878,2879,2880,[2881,4],[2887,2],[2891,3],2902,2903,[2908,2],[2911,5],[2918,10],2929,2946,2947,[2949,6],[2958,3],[2962,4],[2969,2],2972,[2974,2],[2979,2],[2984,3],[2990,12],[3006,5],[3014,3],[3018,4],3024,3031,[3046,10],[3073,3],[3077,8],[3086,3],[3090,23],[3114,10],[3125,5],3133,[3134,7],[3142,3],[3146,4],[3157,2],[3160,2],[3168,4],[3174,10],[3202,2],[3205,8],[3214,3],[3218,23],[3242,10],[3253,5],3260,3261,3262,3263,[3264,5],3270,[3271,2],[3274,4],[3285,2],3294,[3296,4],[3302,10],[3330,2],[3333,8],[3342,3],[3346,23],[3370,16],3389,[3390,7],[3398,3],[3402,4],3415,[3424,4],[3430,10],[3450,6],[3458,2],[3461,18],[3482,24],[3507,9],3517,[3520,7],3530,[3535,6],3542,[3544,8],[3570,2],[3585,58],[3648,15],[3664,10],[3713,2],3716,[3719,2],3722,3725,[3732,4],[3737,7],[3745,3],3749,3751,[3754,2],[3757,13],[3771,3],[3776,5],3782,[3784,6],[3792,10],[3804,2],3840,[3864,2],[3872,10],3893,3895,3897,[3902,10],[3913,36],[3953,20],[3974,6],[3984,8],[3993,36],4038,[4096,74],[4176,78],[4256,38],[4304,43],4348,[4352,329],[4682,4],[4688,7],4696,[4698,4],[4704,41],[4746,4],[4752,33],[4786,4],[4792,7],4800,[4802,4],[4808,15],[4824,57],[4882,4],[4888,67],4959,[4969,9],[4992,16],[5024,85],[5121,620],[5743,17],[5761,26],[5792,75],[5870,3],[5888,13],[5902,7],[5920,21],[5952,20],[5984,13],[5998,3],[6002,2],[6016,52],6070,[6071,29],6103,6108,6109,[6112,10],[6155,3],[6160,10],[6176,88],[6272,43],[6320,70],[6400,29],[6432,12],[6448,12],[6470,40],[6512,5],[6528,44],[6576,26],[6608,11],[6656,28],[6688,63],6752,6753,6754,[6755,26],6783,[6784,10],[6800,10],6823,[6912,76],[6992,10],[7019,9],[7040,43],[7086,12],[7168,56],[7232,10],[7245,49],[7376,3],[7380,31],[7424,231],[7677,281],[7960,6],[7968,38],[8008,6],[8016,8],8025,8027,8029,[8031,31],[8064,53],[8118,7],8126,[8130,3],[8134,7],[8144,4],[8150,6],[8160,13],[8178,3],[8182,7],[8255,2],8276,8305,8319,[8336,5],[8400,13],8417,[8421,12],8450,8455,[8458,10],8469,8472,[8473,5],8484,8486,8488,[8490,16],[8508,4],[8517,5],8526,[8544,41],[11264,47],[11312,47],[11360,133],[11499,7],[11520,38],[11568,54],11631,[11648,23],[11680,7],[11688,7],[11696,7],[11704,7],[11712,7],[11720,7],[11728,7],[11736,7],[11744,32],12293,12294,12295,[12321,15],[12337,5],[12344,5],[12353,86],[12441,2],[12445,3],[12449,90],[12540,4],[12549,41],[12593,94],[12704,24],[12784,16],[13312,6582],[19968,20940],[40960,1165],[42192,46],[42240,269],[42512,28],[42560,32],[42594,14],[42620,2],42623,[42624,24],[42656,82],[42775,9],[42786,103],[42891,2],[43003,45],[43072,52],[43136,69],[43216,10],[43232,24],43259,[43264,46],[43312,36],[43360,29],[43392,65],43471,[43472,10],[43520,55],[43584,14],[43600,10],[43616,23],43642,43643,[43648,67],[43739,3],[43968,43],44012,44013,[44016,10],[44032,11172],[55216,23],[55243,49],[63744,302],[64048,62],[64112,106],[64256,7],[64275,5],64285,64286,[64287,10],[64298,13],[64312,5],64318,[64320,2],[64323,2],[64326,108],[64467,139],[64612,218],[64848,64],[64914,54],[65008,10],[65024,16],[65056,7],[65075,2],[65101,3],65137,65139,65143,65145,65147,65149,[65151,126],[65296,10],[65313,26],65343,[65345,26],[65382,89],[65474,6],[65482,6],[65490,6],[65498,3],[65536,12],[65549,26],[65576,19],[65596,2],[65599,15],[65616,14],[65664,123],[65856,53],66045,[66176,29],[66208,49],[66304,31],[66352,27],[66432,30],[66464,36],[66504,8],[66513,5],[66560,158],[66720,10],[67584,6],67592,[67594,44],[67639,2],67644,[67647,23],[67840,22],[67872,26],68096,[68097,3],[68101,2],[68108,8],[68117,3],[68121,27],[68152,3],68159,[68192,29],[68352,54],[68416,22],[68448,19],[68608,73],[69760,59],[73728,879],[74752,99],[77824,1071],[119141,5],[119149,6],[119163,8],[119173,7],[119210,4],[119362,3],[119808,85],[119894,71],[119966,2],119970,[119973,2],[119977,4],[119982,12],119995,[119997,7],[120005,65],[120071,4],[120077,8],[120086,7],[120094,28],[120123,4],[120128,5],120134,[120138,7],[120146,340],[120488,25],[120514,25],[120540,31],[120572,25],[120598,31],[120630,25],[120656,31],[120688,25],[120714,31],[120746,25],[120772,8],[120782,50],[131072,42711],[173824,4149],[194560,542],[917760,240]]},$B.unicode_tables={},$B.unicode)$B.unicode_tables[gc]={},$B.unicode[gc].forEach(function(n){if(Array.isArray(n))for(var o=n[2]||1,l=0,x=n[1];l<x;l+=1)$B.unicode_tables[gc][n[0]+l*o]=!0;else $B.unicode_tables[gc][n]=!0});for(var key in $B.unicode_identifiers){$B.unicode_tables[key]={};for(const n of $B.unicode_identifiers[key])if(Array.isArray(n))for(var i=0;i<n[1];i++)$B.unicode_tables[key][n[0]+i]=!0;else $B.unicode_tables[key][n]=!0}$B.is_unicode_cn=function(n){for(var o=$B.unicode.Cn,l=0,x=o.length;l<x;l++)return n>=o[l][0]&&n<o[l][0]+o[l][1];return!1},function($B){var bltns=$B.InjectBuiltins();eval(bltns);var unicode_tables=$B.unicode_tables,str={__class__:_b_.type,__dir__:object.__dir__,$infos:{__module__:"builtins",__name__:"str"},$is_class:!0,$native:!0};function normalize_start_end(n){if(null===n.start||n.start===_b_.None?n.start=0:n.start<0&&(n.start+=n.self.length,n.start=Math.max(0,n.start)),null===n.end||n.end===_b_.None?n.end=n.self.length:n.end<0&&(n.end+=n.self.length,n.end=Math.max(0,n.end)),!isinstance(n.start,_b_.int)||!isinstance(n.end,_b_.int))throw _b_.TypeError.$factory("slice indices must be integers or None or have an __index__ method")}function reverse(n){return n.split("").reverse().join("")}function check_str(n){if(!_b_.isinstance(n,str))throw _b_.TypeError.$factory("can't convert '"+$B.class_name(n)+"' object to str implicitly")}function preformat(n,o){if(o.empty)return _b_.str.$factory(n);if(o.type&&"s"!=o.type)throw _b_.ValueError.$factory("Unknown format code '"+o.type+"' for object of type 'str'");return n}str.__add__=function(n,o){if("string"!=typeof o)try{return getattr(o,"__radd__")(n)}catch{throw _b_.TypeError.$factory("Can't convert "+$B.class_name(o)+" to str implicitly")}return n+o},str.__contains__=function(n,o){if(!_b_.isinstance(o,str))throw _b_.TypeError.$factory("'in <string>' requires string as left operand, not "+o.__class__);if("string"==typeof o)var l=o.length;else l=_b_.len(o);if(0==l)return!0;if(0==n.length)return 0==l;for(var x=0,N=n.length;x<N;x++)if(n.substr(x,l)==o)return!0;return!1},str.__delitem__=function(){throw _b_.TypeError.$factory("'str' object doesn't support item deletion")},str.__dir__=object.__dir__,str.__eq__=function(n,o){return void 0===o?n===str:_b_.isinstance(o,_b_.str)?o.valueOf()==n.valueOf():_b_.NotImplemented},str.__format__=function(n,o){var l=new $B.parse_format_spec(o);if(void 0!==l.sign)throw _b_.ValueError.$factory("Sign not allowed in string format specifier");return l.precision&&(n=n.substr(0,l.precision)),l.align=l.align||"<",$B.format_width(preformat(n,l),l)},str.__getitem__=function(n,o){if(isinstance(o,_b_.int)){var l=o;if(o<0&&(l+=n.length),l>=0&&l<n.length)return n.charAt(l);throw _b_.IndexError.$factory("string index out of range")}if(isinstance(o,slice)){var x=_b_.slice.$conv_for_seq(o,n.length),N=x.start,U=x.stop,G=x.step,A="",P=null;if(G>0){if(U<=N)return"";for(P=N;P<U;P+=G)A+=n.charAt(P)}else{if(U>=N)return"";for(P=N;P>U;P+=G)A+=n.charAt(P)}return A}if(isinstance(o,_b_.bool))return n.__getitem__(_b_.int.$factory(o));throw _b_.TypeError.$factory("string indices must be integers")};var prefix=2,suffix=3,mask=2**32-1,str_hash_cache={};function fnv(n){if(0==n.length)return 0;var o=prefix;o=(o^n.charCodeAt(0)<<7)&mask;for(var l=0,x=n.length;l<x;l++)o=(1000003*o^n.charCodeAt(l))&mask;return-1==(o=((o=(o^n.length)&mask)^suffix)&mask)&&(o=-2),o}str.$nb_str_hash_cache=0,str.__hash__=function(n){return void 0!==str_hash_cache[n]?str_hash_cache[n]:(str.$nb_str_hash_cache++,str.$nb_str_hash_cache>1e5&&(str.$nb_str_hash_cache=0,str_hash_cache={}),str_hash_cache[n]=fnv(n))},str.__init__=function(n,o){return n.valueOf=function(){return o},n.toString=function(){return o},_b_.None};var str_iterator=$B.make_iterator_class("str_iterator");str.__iter__=function(n){var o=n.split("");return str_iterator.$factory(o)},str.__len__=function(n){return n.length};var kwarg_key=new RegExp("([^\\)]*)\\)"),NotANumber=function(){this.name="NotANumber"},number_check=function(n){if(!isinstance(n,[_b_.int,_b_.float]))throw new NotANumber},get_char_array=function(n,o){return n<=0?"":new Array(n+1).join(o)},format_padding=function(n,o,l){var x=o.padding;return x?(n=n.toString(),x=parseInt(x,10),l&&(x-=1),o.left?n+get_char_array(x-n.length,o.pad_char):get_char_array(x-n.length,o.pad_char)+n):n},format_int_precision=function(n,o){var l,x=o.precision;return x?(x=parseInt(x,10),"-"===(l=n.__class__===$B.long_int?$B.long_int.to_base(n,10):n.toString())[0]?"-"+get_char_array(x-l.length+1,"0")+l.slice(1):get_char_array(x-l.length,"0")+l):n.toString()},format_float_precision=function(n,o,l,x){var N=l.precision;return isFinite(n)?x(n,N,l,o):(n=n===1/0?"inf":n===-1/0?"-inf":"nan",o?n.toUpperCase():n)},format_sign=function(n,o){if(o.sign){if(n>=0)return"+"}else if(o.space&&n>=0)return" ";return""},str_format=function(n,o){return o.pad_char=" ",format_padding(str.$factory(n),o)},num_format=function(n,o){number_check(n),n=n.__class__===$B.long_int?$B.long_int.to_base(n,10):parseInt(n);var l=format_int_precision(n,o);if("0"===o.pad_char){if(n<0)return l=l.substring(1),"-"+format_padding(l,o,!0);var x=format_sign(n,o);if(""!==x)return x+format_padding(l,o,!0)}return format_padding(format_sign(n,o)+l,o)},repr_format=function(n,o){return o.pad_char=" ",format_padding(repr(n),o)},ascii_format=function(n,o){return o.pad_char=" ",format_padding(ascii(n),o)},_float_helper=function(n,o){return number_check(n),o.precision?(o.precision=parseInt(o.precision,10),validate_precision(o.precision)):o.precision=o.decimal_point?0:6,parseFloat(n)},trailing_zeros=/(.*?)(0+)([eE].*)/,leading_zeros=/\.(0*)/,trailing_dot=/\.$/,validate_precision=function(n){n>20&&(n=20)},floating_point_format=function(n,o,l){if(n=_float_helper(n,l),v=n.toString(),v_len=v.length,dot_idx=v.indexOf("."),dot_idx<0&&(dot_idx=v_len),n<1&&n>-1){var x,N=leading_zeros.exec(v);return(x=N?N[1].length:0)>=4?(n=format_sign(n,l)+format_float_precision(n,o,l,_floating_g_exp_helper),l.alternate?l.precision<=1&&(n=n[0]+"."+n.substring(1)):(U=trailing_zeros.exec(n))&&(n=U[1].replace(trailing_dot,"")+U[3]),format_padding(n,l)):(l.precision=(l.precision||0)+x,format_padding(format_sign(n,l)+format_float_precision(n,o,l,function(G,A){return G.toFixed(min(A,v_len-dot_idx)+x)}),l))}var U;return dot_idx>l.precision?(n=format_sign(n,l)+format_float_precision(n,o,l,_floating_g_exp_helper),l.alternate?l.precision<=1&&(n=n[0]+"."+n.substring(1)):(U=trailing_zeros.exec(n))&&(n=U[1].replace(trailing_dot,"")+U[3]),format_padding(n,l)):format_padding(format_sign(n,l)+format_float_precision(n,o,l,function(G,A){return l.decimal_point?A>v_len&&(l.alternate||(A=v_len)):A=min(v_len-1,6),A<dot_idx&&(A=dot_idx),G.toFixed(A-dot_idx)}),l)},_floating_g_exp_helper=function(n,o,l,x){o&&--o;var N=(n=n.toExponential(o)).lastIndexOf("e");return N>n.length-4&&(n=n.substring(0,N+2)+"0"+n.substring(N+2)),x?n.toUpperCase():n},floating_point_decimal_format=function(n,o,l){return n=_float_helper(n,l),format_padding(format_sign(n,l)+format_float_precision(n,o,l,function(x,N,U){return x=x.toFixed(N),0===N&&U.alternate&&(x+="."),x}),l)},_floating_exp_helper=function(n,o,l,x){var N=(n=n.toExponential(o)).lastIndexOf("e");return N>n.length-4&&(n=n.substring(0,N+2)+"0"+n.substring(N+2)),x?n.toUpperCase():n},floating_point_exponential_format=function(n,o,l){return n=_float_helper(n,l),format_padding(format_sign(n,l)+format_float_precision(n,o,l,_floating_exp_helper),l)},signed_hex_format=function(n,o,l){var x;if(number_check(n),x=n.__class__===$B.long_int?$B.long_int.to_base(n,16):(x=parseInt(n)).toString(16),x=format_int_precision(x,l),o&&(x=x.toUpperCase()),"0"===l.pad_char){n<0&&(x=x.substring(1),x="-"+format_padding(x,l,!0));var N=format_sign(n,l);""!==N&&(x=N+format_padding(x,l,!0))}return l.alternate&&(x="-"===x.charAt(0)?o?"-0X"+x.slice(1):"-0x"+x.slice(1):o?"0X"+x:"0x"+x),format_padding(format_sign(n,l)+x,l)},octal_format=function(n,o){var l;if(number_check(n),l=n.__class__===$B.long_int?$B.long_int.to_base(8):(l=parseInt(n)).toString(8),l=format_int_precision(l,o),"0"===o.pad_char){n<0&&(l=l.substring(1),l="-"+format_padding(l,o,!0));var x=format_sign(n,o);""!==x&&(l=x+format_padding(l,o,!0))}return o.alternate&&(l="-"===l.charAt(0)?"-0o"+l.slice(1):"0o"+l),format_padding(l,o)};function series_of_bytes(n,o){if(n.__class__&&n.__class__.$buffer_protocol)for(var l=_b_.iter(n),x=[];;)try{x.push(_b_.next(l))}catch(U){if(U.__class__===_b_.StopIteration){var N=_b_.bytes.$factory(x);return format_padding(_b_.bytes.decode(N,"ascii"),o)}throw U}else try{return bytes_obj=$B.$getattr(n,"__bytes__"),format_padding(_b_.bytes.decode(bytes_obj),o)}catch(U){throw U.__class__===_b_.AttributeError?_b_.TypeError.$factory("%b does not accept '"+$B.class_name(n)+"'"):U}}var single_char_format=function(n,o){if(isinstance(n,str)&&1==n.length)return n;if(isinstance(n,bytes)&&1==n.source.length)n=n.source[0];else try{n=_b_.int.$factory(n)}catch{throw _b_.TypeError.$factory("%c requires int or char")}return format_padding(chr(n),o)},num_flag=function(n,o){"0"!==n||o.padding||o.decimal_point||o.left?o.decimal_point?o.precision=(o.precision||"")+n:o.padding=(o.padding||"")+n:o.pad_char="0"},decimal_point_flag=function(n,o){if(o.decimal_point)throw new UnsupportedChar;o.decimal_point=!0},neg_flag=function(n,o){o.pad_char=" ",o.left=!0},space_flag=function(n,o){o.space=!0},sign_flag=function(n,o){o.sign=!0},alternate_flag=function(n,o){o.alternate=!0},char_mapping={b:series_of_bytes,s:str_format,d:num_format,i:num_format,u:num_format,o:octal_format,r:repr_format,a:ascii_format,g:function(n,o){return floating_point_format(n,!1,o)},G:function(n,o){return floating_point_format(n,!0,o)},f:function(n,o){return floating_point_decimal_format(n,!1,o)},F:function(n,o){return floating_point_decimal_format(n,!0,o)},e:function(n,o){return floating_point_exponential_format(n,!1,o)},E:function(n,o){return floating_point_exponential_format(n,!0,o)},x:function(n,o){return signed_hex_format(n,!1,o)},X:function(n,o){return signed_hex_format(n,!0,o)},c:single_char_format,0:function(n,o){return num_flag("0",o)},1:function(n,o){return num_flag("1",o)},2:function(n,o){return num_flag("2",o)},3:function(n,o){return num_flag("3",o)},4:function(n,o){return num_flag("4",o)},5:function(n,o){return num_flag("5",o)},6:function(n,o){return num_flag("6",o)},7:function(n,o){return num_flag("7",o)},8:function(n,o){return num_flag("8",o)},9:function(n,o){return num_flag("9",o)},"-":neg_flag," ":space_flag,"+":sign_flag,".":decimal_point_flag,"#":alternate_flag},UnsupportedChar=function(){this.name="UnsupportedChar"};str.__mod__=function(n,o){var l,x=n.length,N=0,U=null;_b_.isinstance(o,_b_.tuple)?U=0:l=_b_.getattr(o,"__getitem__",_b_.None);var G="",A=function(ce){++N;var fe=kwarg_key.exec(ce.substring(te));if(!fe)throw _b_.ValueError.$factory("incomplete format key");var _e=fe[1];te+=fe[0].length;try{var le=l(_e)}catch(pe){throw"KeyError"===pe.name?pe:_b_.TypeError.$factory("format requires a mapping")}return de(ce,le)},P=function(ce){var fe;if(null===U)fe=o;else if(void 0===(fe=o[U++]))throw _b_.TypeError.$factory("not enough arguments for format string");return de(ce,fe)},de=function(ce,fe){for(var _e={pad_char:" "};;){var le=char_mapping[ce[te]];try{if(void 0===le)throw new UnsupportedChar;var pe=le(fe,_e);if(void 0!==pe)return pe;++te}catch(q){if("UnsupportedChar"==q.name)throw invalid_char=ce[te],void 0===invalid_char?_b_.ValueError.$factory("incomplete format"):_b_.ValueError.$factory("unsupported format character '"+invalid_char+"' (0x"+invalid_char.charCodeAt(0).toString(16)+") at index "+te);if("NotANumber"===q.name){var B=fe.__class__;throw B=B?B.$infos.__name__:"string"==typeof fe?"str":typeof fe,_b_.TypeError.$factory("%"+ce[te]+" format: a number is required, not "+B)}throw q}}},be=0;do{var te=n.indexOf("%",N);if(te<0){G+=n.substring(N);break}if(G+=n.substring(N,te),!(++te<x))throw _b_.ValueError.$factory("incomplete format");"%"===n[te]?G+="%":(be++,"("===n[te]?(++te,G+=A(n)):G+=P(n)),N=te+1}while(N<x);if(null!==U){if(o.length>U)throw _b_.TypeError.$factory("not enough arguments for format string");if(o.length<U)throw _b_.TypeError.$factory("not all arguments converted during string formatting")}else if(0==be)throw _b_.TypeError.$factory("not all arguments converted during string formatting");return G},str.__mro__=[object],str.__mul__=function(){var n=$B.args("__mul__",2,{self:null,other:null},["self","other"],arguments,{},null,null);if(!isinstance(n.other,_b_.int))throw _b_.TypeError.$factory("Can't multiply sequence by non-int of type '"+$B.class_name(n.other)+"'");for(var o="",l=0;l<n.other;l++)o+=n.self.valueOf();return o},str.__ne__=function(n,o){return o!==n.valueOf()},str.__repr__=function(n){var o=n;o=(o=(o=n.replace(/\\/g,"\\\\")).replace(new RegExp("\x07","g"),"\\x07").replace(new RegExp("\b","g"),"\\x08").replace(new RegExp("\v","g"),"\\x0b").replace(new RegExp("\f","g"),"\\x0c").replace(new RegExp("\n","g"),"\\n").replace(new RegExp("\r","g"),"\\r").replace(new RegExp("\t","g"),"\\t")).replace(combining_re,"\u200b$1");for(var l="",x=0;x<o.length;x++)if($B.is_unicode_cn(o.codePointAt(x))){for(var N=o.codePointAt(x).toString(16);N.length<4;)N="0"+N;l+="\\u"+N}else l+=o.charAt(x);if(-1==(o=l).search('"')&&-1==o.search("'"))return"'"+o+"'";if(-1==n.search('"'))return'"'+o+'"';var U=new RegExp("'","g");return"'"+o.replace(U,"\\'")+"'"},str.__setitem__=function(n,o,l){throw _b_.TypeError.$factory("'str' object does not support item assignment")};for(var combining=[],cp=768;cp<=879;cp++)combining.push(String.fromCharCode(cp));var combining_re=new RegExp("("+combining.join("|")+")");str.__str__=function(n){return n.replace(combining_re,"\u200b$1")},str.toString=function(){return"string!"};var $comp_func=function(n,o){return"string"!=typeof o?_b_.NotImplemented:n>o};$comp_func+="";var $comps={">":"gt",">=":"ge","<":"lt","<=":"le"};for(var $op in $comps)eval("str.__"+$comps[$op]+"__ = "+$comp_func.replace(/>/gm,$op));$B.make_rmethods(str);var $notimplemented=function(n,o){throw NotImplementedError.$factory("OPERATOR not implemented for class str")};str.capitalize=function(n){return $B.args("capitalize",1,{self:n},["self"],arguments,{},null,null),0==n.length?"":n.charAt(0).toUpperCase()+n.substr(1)},str.casefold=function(n){$B.args("casefold",1,{self:n},["self"],arguments,{},null,null);for(var o,l,x="",N=0,U=n.length;N<U;N++)o=n.charCodeAt(N),(l=$B.unicode_casefold[o])?l.forEach(function(G){x+=String.fromCharCode(G)}):x+=n.charAt(N).toLowerCase();return x},str.center=function(){var n=$B.args("center",3,{self:null,width:null,fillchar:null},["self","width","fillchar"],arguments,{fillchar:" "},null,null),o=n.self;if(n.width<=o.length)return o;var l=parseInt((n.width-o.length)/2),x=n.fillchar.repeat(l);return(x+=o+x).length<n.width&&(x+=n.fillchar),x},str.count=function(){var n=$B.args("count",4,{self:null,sub:null,start:null,stop:null},["self","sub","start","stop"],arguments,{start:null,stop:null},null,null);if("string"!=typeof n.sub)throw _b_.TypeError.$factory("Can't convert '"+$B.class_name(n.sub)+"' object to str implicitly");var o,l=n.self;if(null!==n.start)o=null!==n.stop?_b_.slice.$factory(n.start,n.stop):_b_.slice.$factory(n.start,n.self.length),l=str.__getitem__.apply(null,[n.self].concat(o));else if(n.self.length+n.sub.length==0)return 1;if(0==n.sub.length)return n.start==n.self.length?1:0==l.length?0:l.length+1;for(var x=0,N=0;N<l.length&&(N=l.indexOf(n.sub,N))>=0;)x++,N+=n.sub.length;return x},str.encode=function(){var n=$B.args("encode",3,{self:null,encoding:null,errors:null},["self","encoding","errors"],arguments,{encoding:"utf-8",errors:"strict"},null,null);if("rot13"==n.encoding||"rot_13"==n.encoding){for(var o="",l=0,x=n.self.length;l<x;l++){var N=n.self.charAt(l);o+="a"<=N&&N<="m"||"A"<=N&&N<="M"?String.fromCharCode(String.charCodeAt(N)+13):"m"<N&&N<="z"||"M"<N&&N<="Z"?String.fromCharCode(String.charCodeAt(N)-13):N}return o}return _b_.bytes.__new__(_b_.bytes,n.self,n.encoding,n.errors)},str.endswith=function(){var n=$B.args("endswith",4,{self:null,suffix:null,start:null,end:null},["self","suffix","start","end"],arguments,{start:0,end:null},null,null);normalize_start_end(n);var o=n.suffix;isinstance(o,_b_.tuple)||(o=[o]);for(var l=n.self.substring(n.start,n.end),x=0,N=o.length;x<N;x++){var U=o[x];if(!_b_.isinstance(U,str))throw _b_.TypeError.$factory("endswith first arg must be str or a tuple of str, not int");if(U.length<=l.length&&l.substr(l.length-U.length)==U)return!0}return!1},str.expandtabs=function(n,o){var l=$B.args("expandtabs",2,{self:null,tabsize:null},["self","tabsize"],arguments,{tabsize:8},null,null),x=$B.$GetInt(l.tabsize),N=0,U=0,G="";if(1==x)return n.replace(/\t/g," ");for(;U<n.length;){var A=n.charAt(U);switch(A){case"\t":for(;N%x>0;)G+=" ",N++;break;case"\r":case"\n":G+=A,N=0;break;default:G+=A,N++}U++}return G},str.find=function(){var n=$B.args("str.find",4,{self:null,sub:null,start:null,end:null},["self","sub","start","end"],arguments,{start:0,end:null},null,null);if(check_str(n.sub),normalize_start_end(n),!isinstance(n.start,_b_.int)||!isinstance(n.end,_b_.int))throw _b_.TypeError.$factory("slice indices must be integers or None or have an __index__ method");for(var o="",l=n.start;l<n.end;l++)o+=n.self.charAt(l);if(0==n.sub.length&&n.start==n.self.length)return n.self.length;if(o.length+n.sub.length==0)return-1;var x=o.length-n.sub.length;for(l=0;l<=x;l++)if(o.substr(l,n.sub.length)==n.sub)return n.start+l;return-1},$B.parse_format=function(n){var o,l,x,N=n.split(":"),U=[];return 1==N.length?o=n:(o=N[0],x=N.splice(1).join(":")),(N=o.split("!")).length>1&&(o=N[0],l=N[1]),void 0!==o&&(o=o.replace(/\.[_a-zA-Z][_a-zA-Z0-9]*|\[[_a-zA-Z][_a-zA-Z0-9]*\]|\[[0-9]+\]/g,function(G){return U.push(G),""})),{name:o,name_ext:U,conv:l,spec:x||"",string:n}},$B.split_format=function(n){for(var o,l=0,x=n.length,N="",U=[],G=0;l<x;)if("{"==(o=n.charAt(l))&&"{"==n.charAt(l+1))N+="{",l+=2;else if("}"==o&&"}"==n.charAt(l+1))N+="}",l+=2;else if("{"==o){U.push(N);for(var A=l+1,P=1;A<x;)if("{"==n.charAt(A))P++,A++;else if("}"==n.charAt(A)){if(A++,0==--P){var de=n.substring(l+1,A-1),be=$B.parse_format(de);if(be.raw_name=be.name,be.raw_spec=be.spec,be.name||(be.name=G+"",G++),void 0!==be.spec){be.spec=be.spec.replace(/\{(.*?)\}/g,function(fe,_e){return""==_e?"{"+G+++"}":"{"+_e+"}"})}U.push(be),N="";break}}else A++;if(P>0)throw ValueError.$factory("wrong format "+n);l=A}else N+=o,l++;return N&&U.push(N),U},str.format=function(n){for(var o,l=$B.args("format",1,{self:null},["self"],arguments,{},"$args","$kw"),x=$B.split_format(l.self),N="",U=0;U<x.length;U++)if("string"!=typeof x[U]){if(void 0!==(o=x[U]).spec){o.spec=o.spec.replace(/\{(.*?)\}/g,function(fe,_e){return/\d+/.exec(_e)?_b_.tuple.__getitem__(l.$args,parseInt(_e)):_b_.dict.__getitem__(l.$kw,_e)})}if(o.name.charAt(0).search(/\d/)>-1)var G=parseInt(o.name),A=_b_.tuple.__getitem__(l.$args,G);else A=_b_.dict.__getitem__(l.$kw,o.name);for(var P=0;P<o.name_ext.length;P++){var de=o.name_ext[P];if("."==de.charAt(0))A=_b_.getattr(A,de.substr(1));else{var be=de.substr(1,de.length-2);be.charAt(0).search(/\d/)>-1&&(be=parseInt(be)),A=_b_.getattr(A,"__getitem__")(be)}}"a"==o.conv?A=_b_.ascii(A):"r"==o.conv?A=_b_.repr(A):"s"==o.conv&&(A=_b_.str.$factory(A)),N+=A.$is_class||A.$factory?A.__class__.__format__(A,o.spec):$B.$getattr(A,"__format__")(o.spec)}else N+=x[U];return N},str.format_map=function(n){throw NotImplementedError.$factory("function format_map not implemented yet")},str.index=function(n){var o=str.find.apply(null,arguments);if(-1===o)throw _b_.ValueError.$factory("substring not found");return o},str.isascii=function(n){for(var o=0,l=n.length;o<l;o++)if(n.charCodeAt(o)>127)return!1;return!0},str.isalnum=function(n){$B.args("isalnum",1,{self:null},["self"],arguments,{},null,null);for(var o,l=0,x=n.length;l<x;l++)if(o=n.charCodeAt(l),!(unicode_tables.Ll[o]||unicode_tables.Lu[o]||unicode_tables.Lm[o]||unicode_tables.Lt[o]||unicode_tables.Lo[o]||unicode_tables.Nd[o]||unicode_tables.digits[o]||unicode_tables.numeric[o]))return!1;return!0},str.isalpha=function(n){$B.args("isalpha",1,{self:null},["self"],arguments,{},null,null);for(var o,l=0,x=n.length;l<x;l++)if(o=n.charCodeAt(l),!(unicode_tables.Ll[o]||unicode_tables.Lu[o]||unicode_tables.Lm[o]||unicode_tables.Lt[o]||unicode_tables.Lo[o]))return!1;return!0},str.isdecimal=function(n){$B.args("isdecimal",1,{self:null},["self"],arguments,{},null,null);for(var o,l=0,x=n.length;l<x;l++)if(o=n.charCodeAt(l),!unicode_tables.Nd[o])return!1;return n.length>0},str.isdigit=function(n){$B.args("isdigit",1,{self:null},["self"],arguments,{},null,null);for(var o,l=0,x=n.length;l<x;l++)if(o=n.charCodeAt(l),!unicode_tables.digits[o])return!1;return n.length>0},str.isidentifier=function(n){if($B.args("isidentifier",1,{self:null},["self"],arguments,{},null,null),0==n.length||void 0===unicode_tables.XID_Start[n.charCodeAt(0)])return!1;for(var o=1,l=n.length;o<l;o++)if(void 0===unicode_tables.XID_Continue[n.charCodeAt(o)])return!1;return!0},str.islower=function(n){$B.args("islower",1,{self:null},["self"],arguments,{},null,null);for(var o,l=!1,x=0,N=n.length;x<N;x++)if(o=n.charCodeAt(x),unicode_tables.Ll[o])l=!0;else if(unicode_tables.Lu[o]||unicode_tables.Lt[o])return!1;return l},str.isnumeric=function(n){$B.args("isnumeric",1,{self:null},["self"],arguments,{},null,null);for(var o=0,l=n.length;o<l;o++)if(!unicode_tables.numeric[n.charCodeAt(o)])return!1;return n.length>0};var unprintable={},unprintable_gc=["Cc","Cf","Co","Cs","Zl","Zp","Zs"];function $re_escape(n){for(var o="[.*+?|()$^",l=0;l<10;l++){var x=new RegExp("\\"+o.charAt(l),"g");n=n.replace(x,"\\"+o.charAt(l))}return n}str.isprintable=function(n){if(0==Object.keys(unprintable).length){for(var o=0;o<unprintable_gc.length;o++){var l=unicode_tables[unprintable_gc[o]];for(var x in l)unprintable[x]=!0}unprintable[32]=!0}$B.args("isprintable",1,{self:null},["self"],arguments,{},null,null),o=0;for(var N=n.length;o<N;o++)if(unprintable[n.charCodeAt(o)])return!1;return!0},str.isspace=function(n){$B.args("isspace",1,{self:null},["self"],arguments,{},null,null);for(var o,l=0,x=n.length;l<x;l++)if(o=n.charCodeAt(l),!unicode_tables.Zs[o]&&-1==$B.unicode_bidi_whitespace.indexOf(o))return!1;return n.length>0},str.istitle=function(n){return $B.args("istitle",1,{self:null},["self"],arguments,{},null,null),n.length>0&&str.title(n)==n},str.isupper=function(n){$B.args("islower",1,{self:null},["self"],arguments,{},null,null);for(var o,l=!1,x=0,N=n.length;x<N;x++)if(o=n.charCodeAt(x),unicode_tables.Lu[o])l=!0;else if(unicode_tables.Ll[o]||unicode_tables.Lt[o])return!1;return l},str.join=function(){for(var n=$B.args("join",2,{self:null,iterable:null},["self","iterable"],arguments,{},null,null),o=_b_.iter(n.iterable),l=[];;)try{var x=_b_.next(o);if(!isinstance(x,str))throw _b_.TypeError.$factory("sequence item 0: expected str instance, "+$B.class_name(x)+" found");l.push(x)}catch(N){if(_b_.isinstance(N,_b_.StopIteration))break;throw N}return l.join(n.self)},str.ljust=function(n){var o=$B.args("ljust",3,{self:null,width:null,fillchar:null},["self","width","fillchar"],arguments,{fillchar:" "},null,null);return o.width<=n.length?n:n+o.fillchar.repeat(o.width-n.length)},str.lower=function(n){return $B.args("lower",1,{self:null},["self"],arguments,{},null,null),n.toLowerCase()},str.lstrip=function(n,o){var l=$B.args("lstrip",2,{self:null,chars:null},["self","chars"],arguments,{chars:_b_.None},null,null);if(l.chars===_b_.None)return l.self.trimLeft();for(var x=0;x<l.self.length;x++)if(-1===l.chars.indexOf(l.self.charAt(x)))return l.self.substring(x);return""},str.maketrans=function(){var n=$B.args("maketrans",3,{x:null,y:null,z:null},["x","y","z"],arguments,{y:null,z:null},null,null),o=$B.empty_dict();if(null===n.y&&null===n.z){if(!_b_.isinstance(n.x,_b_.dict))throw _b_.TypeError.$factory("maketrans only argument must be a dict");for(var l=_b_.list.$factory(_b_.dict.items(n.x)),x=0,N=l.length;x<N;x++){var U=l[x][0],G=l[x][1];if(!_b_.isinstance(U,_b_.int)){if(!_b_.isinstance(U,_b_.str)||1!=U.length)throw _b_.TypeError.$factory("dictionary key "+U+" is not int or 1-char string");U=_b_.ord(U)}if(G!==_b_.None&&!_b_.isinstance(G,[_b_.int,_b_.str]))throw _b_.TypeError.$factory("dictionary value "+G+" is not None, integer or string");_b_.dict.$setitem(o,U,G)}return o}if(_b_.isinstance(n.x,_b_.str)&&_b_.isinstance(n.y,_b_.str)){if(n.x.length!==n.y.length)throw _b_.TypeError.$factory("maketrans arguments must be strings or same length");var A={};if(null!==n.z){if(!_b_.isinstance(n.z,_b_.str))throw _b_.TypeError.$factory("maketrans third argument must be a string");for(x=0,N=n.z.length;x<N;x++)A[_b_.ord(n.z.charAt(x))]=!0}for(x=0,N=n.x.length;x<N;x++){var P=_b_.ord(n.x.charAt(x)),de=n.y.charCodeAt(x);_b_.dict.$setitem(o,P,de)}for(var U in A)_b_.dict.$setitem(o,parseInt(U),_b_.None);return o}throw _b_.TypeError.$factory("maketrans arguments must be strings")},str.maketrans.$type="staticmethod",str.partition=function(){var n=$B.args("partition",2,{self:null,sep:null},["self","sep"],arguments,{},null,null);if(""==n.sep)throw _b_.ValueError.$factory("empty separator");check_str(n.sep);var o=n.self.indexOf(n.sep);return-1==o?_b_.tuple.$factory([n.self,"",""]):_b_.tuple.$factory([n.self.substring(0,o),n.sep,n.self.substring(o+n.sep.length)])},str.removeprefix=function(){var n=$B.args("removeprefix",2,{self:null,prefix:null},["self","prefix"],arguments,{},null,null);if(!_b_.isinstance(n.prefix,str))throw _b_.ValueError.$factory(`prefix should be str, not '${$B.class_name(n.prefix)}'`);return str.startswith(n.self,n.prefix)?n.self.substr(n.prefix.length):n.self.substr(0)},str.removesuffix=function(){var n=$B.args("removesuffix",2,{self:null,prefix:null},["self","suffix"],arguments,{},null,null);if(!_b_.isinstance(n.suffix,str))throw _b_.ValueError.$factory(`suffix should be str, not '${$B.class_name(n.prefix)}'`);return n.suffix.length>0&&str.endswith(n.self,n.suffix)?n.self.substr(0,n.self.length-n.suffix.length):n.self.substr(0)},str.replace=function(n,o,l,x){var N=$B.args("replace",4,{self:null,old:null,$$new:null,count:null},["self","old","$$new","count"],arguments,{count:-1},null,null);if(x=N.count,n=N.self,l=N.$$new,check_str(o=N.old),check_str(l),!isinstance(x,[_b_.int,_b_.float]))throw _b_.TypeError.$factory("'"+$B.class_name(x)+"' object cannot be interpreted as an integer");if(isinstance(x,_b_.float))throw _b_.TypeError.$factory("integer argument expected, got float");if(0==x)return n;if(x.__class__==$B.long_int&&(x=parseInt(x.value)),""==o){if(""==l)return n;if(""==n)return l;var U=n.split("");if(x>-1&&U.length>=x){var G=U.slice(x).join("");return l+U.slice(0,x).join(l)+G}return l+U.join(l)+l}U=str.split(n,o,x);var A=n,P=-1;if(0==o.length){A=l;for(var de=0;de<U.length;de++)A+=U[de]+l;return A+G}for(x<0&&(x=A.length);x>0&&!((P=A.indexOf(o,P))<0);)A=A.substr(0,P)+l+A.substr(P+o.length),P+=l.length,x--;return A},str.rfind=function(n,o){if(2==arguments.length&&"string"==typeof o)return n.lastIndexOf(o);var l=$B.args("rfind",4,{self:null,sub:null,start:null,end:null},["self","sub","start","end"],arguments,{start:0,end:null},null,null);if(normalize_start_end(l),check_str(l.sub),0==l.sub.length)return l.start>l.self.length?-1:l.self.length;for(var x=l.sub.length,N=l.end-x;N>=l.start;N--)if(l.self.substr(N,x)==l.sub)return N;return-1},str.rindex=function(){var n=str.rfind.apply(null,arguments);if(-1==n)throw _b_.ValueError.$factory("substring not found");return n},str.rjust=function(n){var o=$B.args("rjust",3,{self:null,width:null,fillchar:null},["self","width","fillchar"],arguments,{fillchar:" "},null,null);return o.width<=n.length?n:o.fillchar.repeat(o.width-n.length)+n},str.rpartition=function(n,o){var l=$B.args("rpartition",2,{self:null,sep:null},["self","sep"],arguments,{},null,null);check_str(l.sep),n=reverse(l.self),o=reverse(l.sep);for(var x=str.partition(n,o).reverse(),N=0;N<x.length;N++)x[N]=x[N].split("").reverse().join("");return x},str.rsplit=function(n){var o=$B.args("rsplit",3,{self:null,sep:null,maxsplit:null},["self","sep","maxsplit"],arguments,{sep:_b_.None,maxsplit:-1},null,null),l=o.sep,x=reverse(o.self),N=l===_b_.None?l:reverse(o.sep),U=str.split(x,N,o.maxsplit);U.reverse();for(var G=0;G<U.length;G++)U[G]=reverse(U[G]);return U},str.rstrip=function(n,o){var l=$B.args("rstrip",2,{self:null,chars:null},["self","chars"],arguments,{chars:_b_.None},null,null);if(l.chars===_b_.None)return l.self.trimRight();for(var x=l.self.length-1;x>=0;x--)if(-1==l.chars.indexOf(l.self.charAt(x)))return l.self.substring(0,x+1);return""},str.split=function(){var n=$B.args("split",3,{self:null,sep:null,maxsplit:null},["self","sep","maxsplit"],arguments,{sep:_b_.None,maxsplit:-1},null,null),o=n.sep,l=n.maxsplit,x=n.self,N=0;if(l.__class__===$B.long_int&&(l=parseInt(l.value)),""==o)throw _b_.ValueError.$factory("empty separator");if(o===_b_.None){for(var U=[];N<x.length&&x.charAt(N).search(/\s/)>-1;)N++;if(N===x.length-1)return[x];for(var G="";;){if(-1==x.charAt(N).search(/\s/))""==G?G=x.charAt(N):G+=x.charAt(N);else if(""!==G){if(U.push(G),-1!==l&&U.length==l+1)return U.pop(),U.push(G+x.substr(N)),U;G=""}if(++N>x.length-1){G&&U.push(G);break}}return U}U=[];var A="",P=o.length;if(0==l)return[x];for(;N<x.length;)if(x.substr(N,P)==o){if(U.push(A),N+=P,l>-1&&U.length>=l)return U.push(x.substr(N)),U;A=""}else A+=x.charAt(N),N++;return U.push(A),U},str.splitlines=function(n){var o=$B.args("splitlines",2,{self:null,keepends:null},["self","keepends"],arguments,{keepends:!1},null,null);if(!_b_.isinstance(o.keepends,[_b_.bool,_b_.int]))throw _b_.TypeError("integer argument expected, got "+$B.get_class(o.keepends).__name);var l=_b_.int.$factory(o.keepends),x=[],N=0,U=0;if(!(n=o.self).length)return x;for(;U<n.length;)"\r\n"==n.substr(U,2)?(x.push(n.slice(N,l?U+2:U)),N=U+=2):"\r"==n[U]||"\n"==n[U]?(x.push(n.slice(N,l?U+1:U)),N=U+=1):U++;return N<n.length&&x.push(n.slice(N)),x},str.startswith=function(){var n=$B.args("startswith",4,{self:null,prefix:null,start:null,end:null},["self","prefix","start","end"],arguments,{start:0,end:null},null,null);normalize_start_end(n);var o=n.prefix;isinstance(o,_b_.tuple)||(o=[o]);for(var l=n.self.substring(n.start,n.end),x=0,N=o.length;x<N;x++){var U=o[x];if(!_b_.isinstance(U,str))throw _b_.TypeError.$factory("endswith first arg must be str or a tuple of str, not int");if(l.substr(0,U.length)==U)return!0}return!1},str.strip=function(){var n=$B.args("strip",2,{self:null,chars:null},["self","chars"],arguments,{chars:_b_.None},null,null);if(n.chars===_b_.None)return n.self.trim();for(var o=0;o<n.self.length&&-1!=n.chars.indexOf(n.self.charAt(o));o++);for(var l=n.self.length-1;l>=o&&-1!=n.chars.indexOf(n.self.charAt(l));l--);return n.self.substring(o,l+1)},str.swapcase=function(n){$B.args("swapcase",1,{self:n},["self"],arguments,{},null,null);for(var o,l="",x=0,N=n.length;x<N;x++)o=n.charCodeAt(x),l+=unicode_tables.Ll[o]?n.charAt(x).toUpperCase():unicode_tables.Lu[o]?n.charAt(x).toLowerCase():n.charAt(x);return l},str.title=function(n){$B.args("title",1,{self:n},["self"],arguments,{},null,null);for(var o,l,x="",N=0,U=n.length;N<U;N++)l=n.charCodeAt(N),unicode_tables.Ll[l]?o?x+=n.charAt(N):(x+=n.charAt(N).toUpperCase(),o="word"):unicode_tables.Lu[l]||unicode_tables.Lt[l]?(x+=o?n.charAt(N).toLowerCase():n.charAt(N),o="word"):(o=null,x+=n.charAt(N));return x},str.translate=function(n,o){for(var l=[],x=$B.$getattr(o,"__getitem__"),N=0,U=n.length;N<U;N++)try{var G=x(n.charCodeAt(N));G!==_b_.None&&("string"==typeof G?l.push(G):"number"==typeof G&&l.push(String.fromCharCode(G)))}catch{l.push(n.charAt(N))}return l.join("")},str.upper=function(n){return $B.args("upper",1,{self:null},["self"],arguments,{},null,null),n.toUpperCase()},str.zfill=function(n,o){var l=$B.args("zfill",2,{self:null,width:null},["self","width"],arguments,{},null,null);if(l.width<=n.length)return n;switch(n.charAt(0)){case"+":case"-":return n.charAt(0)+"0".repeat(l.width-n.length)+n.substr(1);default:return"0".repeat(o-n.length)+n}},str.$factory=function(n,o,l){if(0==arguments.length)return"";if(void 0===n)return $B.UndefinedClass.__str__();if(void 0!==o){var x=$B.args("str",3,{arg:null,encoding:null,errors:null},["arg","encoding","errors"],arguments,{encoding:"utf-8",errors:"strict"},null,null);o=x.encoding,l=x.errors}switch(typeof n){case"string":return str.__str__(n);case"number":if(isFinite(n))return n.toString()}try{if(n.$is_class||n.$factory)return $B.$getattr(n.__class__,"__str__")(n);if(n.__class__&&n.__class__===_b_.bytes&&void 0!==o)return _b_.bytes.decode(n,x.encoding,x.errors);var N=n.__class__||$B.get_class(n);if(void 0===N)return $B.JSObj.__str__($B.JSObj.$factory(n));if(null===(U=$B.$getattr(N,"__str__",null))||n.__class__&&n.__class__!==_b_.object&&U.$infos&&U.$infos.__func__===_b_.object.__str__)var U=$B.$getattr(N,"__repr__")}catch(G){throw console.log("no __str__ for",n),console.log("err ",G),$B.debug>1&&console.log(G),console.log("Warning - no method __str__ or __repr__, default to toString",n),G}return $B.$call(U)(n)},str.__new__=function(n){if(void 0===n)throw _b_.TypeError.$factory("str.__new__(): not enough arguments");return{__class__:n}},$B.set_func_names(str,"builtins");var StringSubclass=$B.StringSubclass={__class__:_b_.type,__mro__:[object],$infos:{__module__:"builtins",__name__:"str"},$is_class:!0};for(var $attr in str)"function"==typeof str[$attr]&&(StringSubclass[$attr]=function(n){return function(){var o=[],l=0;if(arguments.length>0){o=[arguments[0].valueOf()],l=1;for(var x=1,N=arguments.length;x<N;x++)o[l++]=arguments[x]}return str[n].apply(null,o)}}($attr));function fstring_expression(){this.type="expression",this.expression="",this.conversion=null,this.fmt=null}StringSubclass.__new__=function(n){return{__class__:n}},$B.set_func_names(StringSubclass,"builtins"),_b_.str=str,$B.parse_format_spec=function(n){if(""==n)this.empty=!0;else{var o=0,l="<>=^",x="0123456789",N=l.indexOf(n.charAt(0));-1!=N?n.charAt(1)&&-1!=l.indexOf(n.charAt(1))?(this.fill=n.charAt(0),this.align=n.charAt(1),o=2):(this.align=l[N],this.fill=" ",o++):(N=l.indexOf(n.charAt(1)),n.charAt(1)&&-1!=N&&(this.align=l[N],this.fill=n.charAt(0),o=2));var U=n.charAt(o);for("+"!=U&&"-"!=U&&" "!=U||(this.sign=U,o++,U=n.charAt(o)),"#"==U&&(this.alternate=!0,o++,U=n.charAt(o)),"0"==U&&(this.fill="0",-1==N&&(this.align="="),o++,U=n.charAt(o));U&&x.indexOf(U)>-1;)void 0===this.width?this.width=U:this.width+=U,o++,U=n.charAt(o);if(void 0!==this.width&&(this.width=parseInt(this.width)),void 0===this.width&&"{"==U){var G=n.substr(o).search("}");this.width=n.substring(o,G),console.log("width","["+this.width+"]"),o+=G+1}if(","==U&&(this.comma=!0,o++,U=n.charAt(o)),"."==U){if(-1==x.indexOf(n.charAt(o+1)))throw _b_.ValueError.$factory("Missing precision in format spec");for(this.precision=n.charAt(o+1),U=n.charAt(o+=2);U&&x.indexOf(U)>-1;)this.precision+=U,o++,U=n.charAt(o);this.precision=parseInt(this.precision)}if(U&&"bcdeEfFgGnosxX%".indexOf(U)>-1&&(this.type=U,o++,U=n.charAt(o)),o!==n.length)throw _b_.ValueError.$factory("Invalid format specifier: "+n)}this.toString=function(){return(void 0===this.fill?"":_b_.str.$factory(this.fill))+(this.align||"")+(this.sign||"")+(this.alternate?"#":"")+(this.sign_aware?"0":"")+(this.width||"")+(this.comma?",":"")+(this.precision?"."+this.precision:"")+(this.type||"")}},$B.format_width=function(n,o){if(o.width&&n.length<o.width){var l=o.fill||" ",N=o.width-n.length;switch(o.align||"<"){case"<":return n+l.repeat(N);case">":return l.repeat(N)+n;case"=":return"+-".indexOf(n.charAt(0))>-1?n.charAt(0)+l.repeat(N)+n.substr(1):l.repeat(N)+n;case"^":var U=parseInt(N/2);return l.repeat(U)+n+l.repeat(N-U)}}return n},$B.parse_fstring=function(n){for(var o,l=[],x=0,N="",U=null,G=0;x<n.length;)if(null===U)if("{"==(o=n.charAt(x)))"{"==n.charAt(x+1)?(U="string",N="{",x+=2):(U="expression",G=1,x++);else if("}"==o){if(n.charAt(x+1)!=o)throw Error(" f-string: single '}' is not allowed");U="string",N="}",x+=2}else U="string",N=o,x++;else if("string"==U){for(var A=x;A<n.length;)if("{"==(o=n.charAt(A))){if("{"!=n.charAt(A+1)){l.push(N),U="expression",x=A+1;break}N+="{",A+=2}else if("}"==o){if(n.charAt(A+1)!=o)throw Error(" f-string: single '}' is not allowed");N+=o,A+=2}else N+=o,A++;x=A+1}else if("debug"==U){for(;" "==n.charAt(A);)A++;"}"==n.charAt(A)&&(l.push(N),U=null,N="",x=A+1)}else{A=x,G=1;var P=0;for(N=new fstring_expression;A<n.length;)if("{"==(o=n.charAt(A))&&0==P)G++,N.expression+=o,A++;else if("}"==o&&0==P){if(0==(G-=1)){l.push(N),U=null,N="",x=A+1;break}N.expression+=o,A++}else{if("\\"==o)throw Error("f-string expression part cannot include a backslash");if(0==P&&"!"==o&&null===N.fmt&&":}".indexOf(n.charAt(A+2))>-1){if(0==N.expression.length)throw Error("f-string: empty expression not allowed");if(-1=="ars".indexOf(n.charAt(A+1)))throw Error("f-string: invalid conversion character: expected 's', 'r', or 'a'");N.conversion=n.charAt(A+1),A+=2}else if("("==o)P++,N.expression+=o,A++;else if(")"==o)P--,N.expression+=o,A++;else if('"'==o)if('"""'==n.substr(A,3)){if(-1==(be=n.indexOf('"""',A+3)))throw Error("f-string: unterminated string");var de=n.substring(A,be+3);de=de.replace("\n","\\n\\"),N.expression+=de,A=be+3}else{var be;if(-1==(be=n.indexOf('"',A+1)))throw Error("f-string: unterminated string");N.expression+=n.substring(A,be+1),A=be+1}else if(0==P&&":"==o)N.fmt=!0,N.expression+=o,A++;else if("="==o){var te=N.expression,ce=te.charAt(te.length-1),fe=("()".indexOf(ce)>-1?"\\":"")+ce;if(0==te.length||"="==n.charAt(A+1)||"=!<>:".search(fe)>-1)N.expression+=o+n.charAt(A+1),A+=2;else{for(tail=o;n.charAt(A+1).match(/\s/);)tail+=n.charAt(A+1),A++;for(l.push(N.expression+tail);te.match(/\s$/);)te=te.substr(0,te.length-1);N.expression=te,U="debug",A++}}else N.expression+=o,A++}if(G>0)throw Error("f-string: expected '}'")}return N.length>0&&l.push(N),l};var surrogate=str.$surrogate=$B.make_class("surrogate_string",function(n){for(var o=[],l=0,x=n.length;l<x;l++){var N=n.charCodeAt(l);N>=55296&&N<=56319&&(l++,N=1024*(N-55296)+(n.charCodeAt(l)-56320)+65536),o.push(String.fromCodePoint(N))}return{__class__:str.$surrogate,items:o}});surrogate.__mro__=[str,object],surrogate.__contains__=function(n,o){return str.__contains__(n.items.join(""),o)},surrogate.__getitem__=function(n,o){if(isinstance(o,_b_.int)){var l=o;if(o<0&&(l+=n.items.length),l>=0&&l<n.items.length)return 2==n.items[l].length?surrogate.$factory(n.items[l]):n.items[l];throw _b_.IndexError.$factory("string index out of range")}if(isinstance(o,slice)){var x=_b_.slice.$conv_for_seq(o,n.items.length),N=x.start,U=x.stop,G=x.step,A="",P=null;if(G>0){if(U<=N)return"";for(P=N;P<U;P+=G)A+=n.items[P]}else{if(U>=N)return"";for(P=N;P>U;P+=G)A+=n.items[P]}return A}if(isinstance(o,_b_.bool))return surrogate.__getitem__(n,_b_.int.$factory(o));throw _b_.TypeError.$factory("string indices must be integers")},surrogate.__hash__=function(n){return str.__hash__(n.items.join(""))},surrogate.__iter__=function(n){return str_iterator.$factory(n.items)},surrogate.__len__=function(n){return n.items.length},surrogate.__repr__=function(n){return str.__repr__(n.items.join(""))},surrogate.__str__=function(n){return str.__str__(n.items.join(""))},$B.set_func_names(surrogate,"builtins")}(__BRYTHON__),function($B){var bltns=$B.InjectBuiltins();eval(bltns);var str_hash=_b_.str.__hash__,$N=_b_.None,set_ops=["eq","le","lt","ge","gt","sub","rsub","and","or","xor"];function is_sublist(n,o){for(var l=0,x=n.length;l<x;l++){for(var N=n[l],U=!1,G=0,A=o.length;G<A;G++)if($B.rich_comp("__eq__",N,o[G])){o.splice(G,1),U=!0;break}if(!U)return!1}return!0}dict_view_op={__eq__:function(n,o){return n.length==o.length&&is_sublist(n,o)},__ne__:function(n,o){return!dict_view_op.__eq__(n,o)},__lt__:function(n,o){return n.length<o.length&&is_sublist(n,o)},__gt__:function(n,o){return dict_view_op.__lt__(o,n)},__le__:function(n,o){return n.length<=o.length&&is_sublist(n,o)},__ge__:function(n,o){return dict_view_op.__le__(o,n)},__and__:function(n,o){for(var l=[],x=0,N=n.length;x<N;x++){var U=n[x];flag=!1;for(var G=0,A=o.length;G<A;G++)if($B.rich_comp("__eq__",U,o[G])){o.splice(G,1),l.push(U);break}}return l},__or__:function(n,o){for(var l=n,x=0,N=o.length;x<N;x++){for(var U=o[x],G=!1,A=0,P=n.length;A<P;A++)if($B.rich_comp("__eq__",U,n[A])){o.splice(x,1),G=!0;break}G||l.push(U)}return l}},$B.make_view=function(n){for(var o=$B.make_class(n,function(U,G){return{__class__:o,__dict__:$B.empty_dict(),counter:-1,items:U,len:U.length,set_like:G}}),l=0,x=set_ops.length;l<x;l++){var N="__"+set_ops[l]+"__";o[N]=function(U){return function(G,A){if(G.set_like)return _b_.set[U](_b_.set.$factory(G),_b_.set.$factory(A));if(A.__class__!==o)return!1;var P=_b_.list.$factory(A);return dict_view_op[U](G.items,P)}}(N)}return o.__iter__=function(U){var G=o.$iterator.$factory(U.items);return G.len_func=U.len_func,G},o.__len__=function(U){return U.len},o.__repr__=function(U){return o.$infos.__name__+"("+_b_.repr(U.items)+")"},$B.set_func_names(o,"builtins"),o};var dict={__class__:_b_.type,__mro__:[_b_.object],$infos:{__module__:"builtins",__name__:"dict"},$is_class:!0,$native:!0};function to_list(n,o){var l=[];if(n.$jsobj){for(var x in l=[],n.$jsobj)if("$"!=x.charAt(0)){var N=n.$jsobj[x];void 0===N?N=_b_.NotImplemented:null===N&&(N=$N),l.push([x,N])}}else if(_b_.isinstance(n,_b_.dict)){for(var U in n.$numeric_dict)l.push([parseFloat(U),n.$numeric_dict[U]]);for(var U in n.$string_dict)l.push([U,n.$string_dict[U]]);for(var U in n.$object_dict)n.$object_dict[U].forEach(function(A){l.push(A)});l.sort(function(G,A){return G[1][1]-A[1][1]}),l=l.map(function(G){return[G[0],G[1][0]]})}return void 0!==o?l.map(function(G){return G[o]}):(l.__class__=_b_.tuple,l.map(function(G){return G.__class__=_b_.tuple,G}))}function dict_iterator_next(n){if(n.len_func()!=n.len)throw _b_.RuntimeError.$factory("dictionary changed size during iteration");if(n.counter++,n.counter<n.items.length)return n.items[n.counter];throw _b_.StopIteration.$factory("StopIteration")}dict.$to_obj=function(n){var o={};for(var l in n.$string_dict)o[l]=n.$string_dict[l][0];return o},$B.dict_to_list=to_list;var $copy_dict=function(n,o){var l=to_list(o),x=dict.$setitem;o.$version=o.$version||0;for(var N=o.$version||0,U=0,G=l.length;U<G;U++)if(x(n,l[U][0],l[U][1]),o.$version!=N)throw _b_.RuntimeError.$factory("dict mutated during update")};function rank(n,o,l){var x=n.$object_dict[o];if(void 0!==x)for(var N=0,U=x.length;N<U;N++)if($B.rich_comp("__eq__",l,x[N][0]))return N;return-1}function init_from_list(n,o){for(var l=-1,x=o.length-1,N=dict.__setitem__;l++<x;){var U=o[l];switch(typeof U[0]){case"string":n.$string_dict[U[0]]=[U[1],n.$order++],n.$str_hash[str_hash(U[0])]=U[0],n.$version++;break;case"number":if(0!=U[0]&&1!=U[0]){n.$numeric_dict[U[0]]=[U[1],n.$order++],n.$version++;break}default:N(n,U[0],U[1])}}}dict.__bool__=function(){var n=$B.args("__bool__",1,{self:null},["self"],arguments,{},null,null);return dict.__len__(n.self)>0},dict.__class_getitem__=function(n,o){return Array.isArray(o)||(o=[o]),$B.GenericAlias.$factory(n,o)},dict.__contains__=function(){var n=$B.args("__contains__",2,{self:null,key:null},["self","key"],arguments,{},null,null),o=n.self,l=n.key;if(o.$is_namespace&&(l=$B.to_alias(l)),o.$jsobj)return void 0!==o.$jsobj[l];switch(typeof l){case"string":return void 0!==o.$string_dict[l];case"number":return void 0!==o.$numeric_dict[l]}var x=_b_.hash(l);return!(void 0===o.$str_hash[x]||!$B.rich_comp("__eq__",l,o.$str_hash[x]))||!(void 0===o.$numeric_dict[x]||!$B.rich_comp("__eq__",l,x))||rank(o,x,l)>-1},dict.__delitem__=function(){var n=$B.args("__eq__",2,{self:null,arg:null},["self","arg"],arguments,{},null,null),o=n.self,l=n.arg;if(o.$jsobj){if(void 0===o.$jsobj[l])throw _b_.KeyError.$factory(l);return delete o.$jsobj[l],$N}switch(typeof l){case"string":if(void 0===o.$string_dict[l])throw _b_.KeyError.$factory(_b_.str.$factory(l));return delete o.$string_dict[l],delete o.$str_hash[str_hash(l)],o.$version++,$N;case"number":if(void 0===o.$numeric_dict[l])throw _b_.KeyError.$factory(_b_.str.$factory(l));return delete o.$numeric_dict[l],o.$version++,$N}var x,N=_b_.hash(l);if(!((x=rank(o,N,l))>-1))throw _b_.KeyError.$factory(_b_.str.$factory(l));return o.$object_dict[N].splice(x,1),o.$version++,$N},dict.__eq__=function(){var n=$B.args("__eq__",2,{self:null,other:null},["self","other"],arguments,{},null,null),o=n.self,l=n.other;if(!_b_.isinstance(l,dict)||(o.$jsobj&&(o=jsobj2dict(o.$jsobj)),l.$jsobj&&(l=jsobj2dict(l.$jsobj)),dict.__len__(o)!=dict.__len__(l))||o.$string_dict.length!=l.$string_dict.length)return!1;for(var x in o.$numeric_dict)if(l.$numeric_dict.hasOwnProperty(x)){if(!$B.rich_comp("__eq__",l.$numeric_dict[x][0],o.$numeric_dict[x][0]))return!1}else{if(!l.$object_dict.hasOwnProperty(x))return!1;for(var N=!1,U=0,G=(P=l.$object_dict[x]).length;U<G;U++)if($B.rich_comp("__eq__",x,P[U][0])&&$B.rich_comp("__eq__",o.$numeric_dict[x],P[U][1])){N=!0;break}if(!N)return!1}for(var x in o.$string_dict)if(!l.$string_dict.hasOwnProperty(x)||!$B.rich_comp("__eq__",l.$string_dict[x][0],o.$string_dict[x][0]))return!1;for(var A in o.$object_dict){var P=o.$object_dict[A],de=[];if(void 0!==l.$numeric_dict[A]&&de.push([A,l.$numeric_dict[A]]),void 0!==l.$object_dict[A]&&(de=de.concat(l.$object_dict[A])),0==de.length)return!1;U=0;for(var be=P.length;U<be;U++){N=!1;for(var te=P[U][0],ce=P[U][1][0],fe=0,_e=de.length;fe<_e;fe++)if($B.rich_comp("__eq__",te,de[fe][0])&&$B.rich_comp("__eq__",ce,de[fe][1][0])){N=!0;break}if(!N)return!1}}return!0},dict.__getitem__=function(){var n=$B.args("__getitem__",2,{self:null,arg:null},["self","arg"],arguments,{},null,null);return dict.$getitem(n.self,n.arg)},dict.$getitem=function(n,o){if(n.$jsobj){if(void 0===n.$jsobj[o]){if(n.$jsobj.hasOwnProperty(o))return $B.Undefined;throw _b_.KeyError.$factory(o)}return n.$jsobj[o]}switch(typeof o){case"string":if(void 0!==n.$string_dict[o])return n.$string_dict[o][0];break;case"number":if(void 0!==n.$numeric_dict[o])return n.$numeric_dict[o][0]}var l=_b_.hash(o),x=function(P){return $B.rich_comp("__eq__",o,P)};"object"==typeof o&&(o.$hash=l);var N=n.$str_hash[l];if(void 0!==N&&x(N))return n.$string_dict[N][0];if(void 0!==n.$numeric_dict[l]&&x(l))return n.$numeric_dict[l][0];if(_b_.isinstance(o,_b_.str)){var U=n.$string_dict[o.valueOf()];if(void 0!==U)return U[0]}var G=rank(n,l,o);if(G>-1)return n.$object_dict[l][G][1][0];if(n.__class__!==dict){try{var A=getattr(n.__class__,"__missing__",_b_.None)}catch(P){console.log(P)}if(A!==_b_.None)return A(n,o)}throw _b_.KeyError.$factory(o)},dict.__hash__=_b_.None,dict.__init__=function(n,o,l){var x;if(void 0===o)return $N;if(void 0===l){if("kw"!=o.$nat&&$B.get_class(o)===$B.JSObj){for(var N in o)n.$string_dict[N]=[o[N],n.$order++];return _b_.None}if(o.$jsobj){for(var U in n.$jsobj={},o.$jsobj)n.$jsobj[U]=o.$jsobj[U];return $N}if(Array.isArray(o))return init_from_list(n,o),$N}var G=(x=x||$B.args("dict",1,{self:null},["self"],arguments,{},"first","second")).first;if(G.length>1)throw _b_.TypeError.$factory("dict expected at most 1 argument, got 2");if(1==G.length)if((G=G[0]).__class__===dict)["$string_dict","$str_hash","$numeric_dict","$object_dict"].forEach(function(ce){for(N in G[ce])n[ce][N]=G[ce][N]});else if(_b_.isinstance(G,dict))$copy_dict(n,G);else{var A=$B.$getattr(G,"keys",null);if(null!==A){var P=$B.$getattr(G,"__getitem__",null);if(null!==P){P=$B.$call(P);for(var de=_b_.iter($B.$call(A)());;)try{var be=P(N=_b_.next(de));dict.__setitem__(n,N,be)}catch(ce){if(ce.__class__===_b_.StopIteration)break;throw ce}return $N}}Array.isArray(G)||(G=_b_.list.$factory(G)),init_from_list(n,G)}var te=x.second.$string_dict;for(var U in te)switch(typeof U){case"string":n.$string_dict[U]=[te[U][0],n.$order++],n.$str_hash[str_hash(U)]=U;break;case"number":n.$numeric_dict[U]=[te[U][0],n.$order++];break;default:si(n,U,te[U][0])}return $N},dict.__iter__=function(n){return _b_.iter(dict.$$keys(n))},dict.__ior__=function(n,o){return dict.update(n,o),n},dict.__len__=function(n){var o=0;if(n.$jsobj){for(var l in n.$jsobj)"$"!=l.charAt(0)&&o++;return o}for(var x in n.$numeric_dict)o++;for(var x in n.$string_dict)o++;for(var N in n.$object_dict)o+=n.$object_dict[N].length;return o},dict.__ne__=function(n,o){return!dict.__eq__(n,o)},dict.__new__=function(n){if(void 0===n)throw _b_.TypeError.$factory("int.__new__(): not enough arguments");var o={__class__:n,$numeric_dict:{},$object_dict:{},$string_dict:{},$str_hash:{},$version:0,$order:0};return n!==dict&&(o.__dict__=$B.empty_dict()),o},dict.__or__=function(n,o){if(!_b_.isinstance(o,dict))return _b_.NotImplemented;var l=dict.copy(n);return dict.update(l,o),l},dict.__repr__=function(n){if(n.$jsobj)return dict.__repr__(jsobj2dict(n.$jsobj));if($B.repr.enter(n))return"{...}";var o=[];return to_list(n).forEach(function(l){try{o.push(repr(l[0])+": "+repr(l[1]))}catch(x){throw x}}),$B.repr.leave(n),"{"+o.join(", ")+"}"},dict.__ror__=function(n,o){if(!_b_.isinstance(o,dict))return _b_.NotImplemented;var l=dict.copy(o);return dict.update(l,n),l},dict.__setitem__=function(n,o,l){var x=$B.args("__setitem__",3,{self:null,key:null,value:null},["self","key","value"],arguments,{},null,null);return dict.$setitem(x.self,x.key,x.value)},dict.$setitem=function(n,o,l,x){if(n.$jsobj)return n.$from_js&&(l=$B.pyobj2jsobj(l)),n.$jsobj.__class__===_b_.type?(n.$jsobj[o]=l,"__init__"!=o&&"__new__"!=o||(n.$jsobj.$factory=$B.$instance_creator(n.$jsobj))):n.$jsobj[o]=l,$N;switch(typeof o){case"string":return void 0===n.$string_dict&&console.log("pas de string dict",n,o,l),void 0!==n.$string_dict[o]?n.$string_dict[o][0]=l:(n.$string_dict[o]=[l,n.$order++],n.$str_hash[str_hash(o)]=o,n.$version++),$N;case"number":if(void 0!==n.$numeric_dict[o])n.$numeric_dict[o][0]=l;else{var N=!1;if((0==o||1==o)&&void 0!==n.$object_dict[o])for(const te of n.$object_dict[o])(0==o&&!1===te[0]||1==o&&!0===te[0])&&(te[1][0]=l,N=!0);N||(n.$numeric_dict[o]=[l,n.$order++]),n.$version++}return $N;case"boolean":var U=o?1:0;if(void 0!==n.$numeric_dict[U])return void(n.$numeric_dict[U]=[l,n.$numeric_dict[U][1]]);void 0!==n.$object_dict[U]?n.$object_dict[U].push([o,[l,n.$order++]]):n.$object_dict[U]=[[o,[l,n.$order++]]]}var A=void 0===x?_b_.hash(o):x,P=function(te){return $B.rich_comp("__eq__",o,te)};if(void 0!==n.$numeric_dict[A]&&P(A))return n.$numeric_dict[A]=[l,n.$numeric_dict[A][1]],n.$version++,$N;var de=n.$str_hash[A];if(void 0!==de&&P(de))return n.$string_dict[de]=[l,n.$string_dict[de][1]],n.$version++,$N;if(x)return void 0!==n.$object_dict[x]?n.$object_dict[x].push([o,[l,n.$order++]]):n.$object_dict[x]=[[o,[l,n.$order++]]],n.$version++,$N;var be=rank(n,A,o);return be>-1?(n.$object_dict[A][be][1]=[l,n.$object_dict[A][be][1][1]],$N):(n.$object_dict.hasOwnProperty(A)?n.$object_dict[A].push([o,[l,n.$order++]]):n.$object_dict[A]=[[o,[l,n.$order++]]],n.$version++,$N)},dict.__str__=function(){return dict.__repr__.apply(null,arguments)},$B.make_rmethods(dict),dict.clear=function(){var n=$B.args("clear",1,{self:null},["self"],arguments,{},null,null).self;if(n.$numeric_dict={},n.$string_dict={},n.$str_hash={},n.$object_dict={},n.$jsobj)for(var o in n.$jsobj)"$"!==o.charAt(0)&&"__class__"!==o&&delete n.$jsobj[o];return n.$version++,n.$order=0,$N},dict.copy=function(n){n=$B.args("copy",1,{self:null},["self"],arguments,{},null,null).self;var o=$B.empty_dict();return $copy_dict(o,n),o},dict.fromkeys=function(){for(var n=$B.args("fromkeys",3,{cls:null,keys:null,value:null},["cls","keys","value"],arguments,{value:_b_.None},null,null),o=n.keys,l=n.value,x=n.cls,N=$B.$call(x)(),U=$B.$iter(o);;)try{var G=_b_.next(U);x===dict?dict.$setitem(N,G,l):$B.$getattr(N,"__setitem__")(G,l)}catch(A){if($B.is_exc(A,[_b_.StopIteration]))return N;throw A}},dict.get=function(){var n=$B.args("get",3,{self:null,key:null,_default:null},["self","key","_default"],arguments,{_default:$N},null,null);try{return dict.__getitem__(n.self,n.key)}catch(o){if(_b_.isinstance(o,_b_.KeyError))return n._default;throw o}};var dict_items=$B.make_view("dict_items",!0);dict_items.$iterator=$B.make_iterator_class("dict_itemiterator"),dict.items=function(n){if(arguments.length>1)throw _b_.TypeError.$factory("items() takes no arguments ("+(arguments.length-1)+" given)");for(var l=to_list(n),x=!0,N=0,U=l.length;N<U;N++)try{_b_.hash(l[N][1])}catch{x=!1;break}var G=dict_items.$factory(to_list(n),x);return G.len_func=function(){return dict.__len__(n)},G};var dict_keys=$B.make_view("dict_keys");dict_keys.$iterator=$B.make_iterator_class("dict_keyiterator"),dict.$$keys=function(n){if(arguments.length>1)throw _b_.TypeError.$factory("keys() takes no arguments ("+(arguments.length-1)+" given)");var l=dict_keys.$factory(to_list(n,0),!0);return l.len_func=function(){return dict.__len__(n)},l},dict.pop=function(){var n={},o=$B.args("pop",3,{self:null,key:null,_default:null},["self","key","_default"],arguments,{_default:n},null,null),l=o.self,x=o.key,N=o._default;try{var U=dict.__getitem__(l,x);return dict.__delitem__(l,x),U}catch(G){if(G.__class__===_b_.KeyError){if(N!==n)return N;throw G}throw G}},dict.popitem=function(n){try{var o=_b_.next(_b_.iter(dict.items(n)));return dict.__delitem__(n,o[0]),_b_.tuple.$factory(o)}catch(l){if(l.__class__==_b_.StopIteration)throw _b_.KeyError.$factory("'popitem(): dictionary is empty'")}},dict.setdefault=function(){var n=$B.args("setdefault",3,{self:null,key:null,_default:null},["self","key","_default"],arguments,{_default:$N},null,null),o=n.self,l=n.key,x=n._default;try{return dict.__getitem__(o,l)}catch(U){if(U.__class__!==_b_.KeyError)throw U;void 0===x&&(x=$N);var N=l.$hash;return l.$hash=void 0,dict.$setitem(o,l,x,N),x}},dict.update=function(n){var o=$B.args("update",1,{self:null},["self"],arguments,{},"args","kw"),l=(n=o.self,o.args),x=o.kw;if(l.length>0){var N=l[0];if(_b_.isinstance(N,dict))N.$jsobj&&(N=jsobj2dict(N.$jsobj)),$copy_dict(n,N);else if(_b_.hasattr(N,"keys"))for(var U=_b_.list.$factory($B.$call($B.$getattr(N,"keys"))()),G=0,A=U.length;G<A;G++){var P=getattr(N,"__getitem__")(U[G]);dict.$setitem(n,U[G],P)}else{var de=_b_.iter(N);for(G=0;;){try{var be=_b_.next(de)}catch(te){if(te.__class__===_b_.StopIteration)break;throw te}try{key_value=_b_.list.$factory(be)}catch{throw _b_.TypeError.$factory("cannot convert dictionary update sequence element #"+G+" to a sequence")}if(2!==key_value.length)throw _b_.ValueError.$factory("dictionary update sequence element #"+G+" has length "+key_value.length+"; 2 is required");dict.$setitem(n,key_value[0],key_value[1]),G++}}}return $copy_dict(n,x),n.$version++,$N};var dict_values=$B.make_view("dict_values");dict_values.$iterator=$B.make_iterator_class("dict_valueiterator"),dict.values=function(n){if(arguments.length>1)throw _b_.TypeError.$factory("values() takes no arguments ("+(arguments.length-1)+" given)");to_list(n,1);var l=dict_values.$factory(to_list(n,1),!1);return l.len_func=function(){return dict.__len__(n)},l},dict.$factory=function(){for(var n=dict.__new__(dict),o=[n],l=0,x=arguments.length;l<x;l++)o.push(arguments[l]);return dict.__init__.apply(null,o),n},_b_.dict=dict,$B.set_func_names(dict,"builtins"),dict.__class_getitem__=_b_.classmethod.$factory(dict.__class_getitem__),$B.empty_dict=function(){return{__class__:dict,$numeric_dict:{},$object_dict:{},$string_dict:{},$str_hash:{},$version:0,$order:0}},dict.fromkeys=_b_.classmethod.$factory(dict.fromkeys),$B.getset_descriptor=$B.make_class("getset_descriptor",function(n,o){return{__class__:$B.getset_descriptor,__doc__:_b_.None,cls:n,attr:o}}),$B.getset_descriptor.__repr__=$B.getset_descriptor.__str__=function(n){return`<attribute '${n.attr}' of '${n.cls.$infos.__name__}' objects>`},$B.set_func_names($B.getset_descriptor,"builtins");var mappingproxy=$B.mappingproxy=$B.make_class("mappingproxy",function(n){if(_b_.isinstance(n,dict))var o=$B.obj_dict(dict.$to_obj(n));else o=$B.obj_dict(n);return o.__class__=mappingproxy,o});for(var attr in mappingproxy.__setitem__=function(){throw _b_.TypeError.$factory("'mappingproxy' object does not support item assignment")},dict)void 0!==mappingproxy[attr]||["__class__","__mro__","__new__","__init__","__delitem__","clear","fromkeys","pop","popitem","setdefault","update"].indexOf(attr)>-1||(mappingproxy[attr]="function"==typeof dict[attr]?function(n){return function(){return dict[n].apply(null,arguments)}}(attr):dict[attr]);function jsobj2dict(n){var o=$B.empty_dict();for(var l in n)if("$"!=l.charAt(0)&&"__class__"!==l)if(null===n[l])o.$string_dict[l]=[_b_.None,o.$order++];else{if(void 0===n[l])continue;o.$string_dict[l]=n[l].$jsobj===n?[o,o.$order++]:[$B.$JS2Py(n[l]),o.$order++]}return o}$B.set_func_names(mappingproxy,"builtins"),$B.obj_dict=function(n,o){var l=n.__class__||$B.get_class(n);if(void 0!==l&&l.$native)throw _b_.AttributeError.$factory(l.__name__+" has no attribute '__dict__'");var x=$B.empty_dict();return x.$jsobj=n,x.$from_js=o,x}}(__BRYTHON__),function(n){var o=n.builtins,l=o.object,x=self;function N(K){var ve=0,Ae=0,Fe=K.width||K.offsetWidth,Ee=K.height||K.offsetHeight;for(document;K.offsetParent;)ve+=K.offsetLeft,Ae+=K.offsetTop,K=K.offsetParent;if(ve+=K.offsetLeft||0,Ae+=K.offsetTop||0,K.parentElement){var qe=N(K.parentElement);ve+=qe.left,Ae+=qe.top}return{left:ve,top:Ae,width:Fe,height:Ee}}function U(K){if(K.type.startsWith("touch"))return(ve={}).x=o.int.$factory(K.touches[0].screenX),ve.y=o.int.$factory(K.touches[0].screenY),ve.__getattr__=function(Ee){return this[Ee]},ve.__class__="MouseCoords",ve;var ve,Ae=0,Fe=0;return K||(K=x.event),K.pageX||K.pageY?(Ae=K.pageX,Fe=K.pageY):(K.clientX||K.clientY)&&(Ae=K.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,Fe=K.clientY+document.body.scrollTop+document.documentElement.scrollTop),(ve={}).x=o.int.$factory(Ae),ve.y=o.int.$factory(Fe),ve.__getattr__=function(Ee){return this[Ee]},ve.__class__="MouseCoords",ve}n.$isNode=function(K){return"object"==typeof Node?K instanceof Node:K&&"object"==typeof K&&"number"==typeof K.nodeType&&"string"==typeof K.nodeName},n.$isNodeList=function(K){try{var ve=Object.prototype.toString.call(K),Ae=new RegExp("^\\[object (HTMLCollection|NodeList)\\]$");return"object"==typeof K&&null!==Ae.exec(ve)&&void 0!==K.length&&(0==K.length||"object"==typeof K[0]&&K[0].nodeType>0)}catch{return!1}};var G=["NONE","CAPTURING_PHASE","AT_TARGET","BUBBLING_PHASE","type","target","currentTarget","eventPhase","bubbles","cancelable","timeStamp","stopPropagation","preventDefault","initEvent"],A=["altKey","altLeft","button","cancelBubble","clientX","clientY","contentOverflow","ctrlKey","ctrlLeft","data","dataFld","dataTransfer","fromElement","keyCode","nextPage","offsetX","offsetY","origin","propertyName","reason","recordset","repeat","screenX","screenY","shiftKey","shiftLeft","source","srcElement","srcFilter","srcUrn","toElement","type","url","wheelDelta","x","y"];n.$isEvent=function(K){for(var ve=!0,Ae=0;Ae<G.length;Ae++)if(void 0===K[G[Ae]]){ve=!1;break}if(ve)return!0;for(Ae=0;Ae<A.length;Ae++)if(void 0===K[A[Ae]])return!1;return!0};var P={1:"ELEMENT",2:"ATTRIBUTE",3:"TEXT",4:"CDATA_SECTION",5:"ENTITY_REFERENCE",6:"ENTITY",7:"PROCESSING_INSTRUCTION",8:"COMMENT",9:"DOCUMENT",10:"DOCUMENT_TYPE",11:"DOCUMENT_FRAGMENT",12:"NOTATION"},de=n.make_class("Attributes",function(K){return{__class__:de,elt:K}});de.__contains__=function(){var K=n.args("__getitem__",2,{self:null,key:null},["self","key"],arguments,{},null,null);return K.self.elt instanceof SVGElement?K.self.elt.hasAttributeNS(null,K.key):"function"==typeof K.self.elt.hasAttribute&&K.self.elt.hasAttribute(K.key)},de.__delitem__=function(){var K=n.args("__getitem__",2,{self:null,key:null},["self","key"],arguments,{},null,null);if(!de.__contains__(K.self,K.key))throw o.KeyError.$factory(K.key);return K.self.elt instanceof SVGElement?(K.self.elt.removeAttributeNS(null,K.key),o.None):"function"==typeof K.self.elt.hasAttribute?(K.self.elt.removeAttribute(K.key),o.None):void 0},de.__getitem__=function(){var K=n.args("__getitem__",2,{self:null,key:null},["self","key"],arguments,{},null,null);if(K.self.elt instanceof SVGElement&&K.self.elt.hasAttributeNS(null,K.key))return K.self.elt.getAttributeNS(null,K.key);if("function"==typeof K.self.elt.hasAttribute&&K.self.elt.hasAttribute(K.key))return K.self.elt.getAttribute(K.key);throw o.KeyError.$factory(K.key)},de.__iter__=function(K){K.$counter=0;for(var ve=K.elt.attributes,Ae=[],Fe=0;Fe<ve.length;Fe++)Ae.push(ve[Fe].name);return K.$items=Ae,K},de.__next__=function(){var K=n.args("__next__",1,{self:null},["self"],arguments,{},null,null);if(K.self.$counter<K.self.$items.length){var ve=K.self.$items[K.self.$counter];return K.self.$counter++,ve}throw o.StopIteration.$factory("")},de.__setitem__=function(){var K=n.args("__setitem__",3,{self:null,key:null,value:null},["self","key","value"],arguments,{},null,null);if(K.self.elt instanceof SVGElement&&"function"==typeof K.self.elt.setAttributeNS)return K.self.elt.setAttributeNS(null,K.key,K.value),o.None;if("function"==typeof K.self.elt.setAttribute)return K.self.elt.setAttribute(K.key,K.value),o.None;throw o.TypeError.$factory("Can't set attributes on element")},de.__repr__=de.__str__=function(K){for(var ve=K.elt.attributes,Ae=[],Fe=0;Fe<ve.length;Fe++)Ae.push(ve[Fe].name+': "'+K.elt.getAttributeNS(null,ve[Fe].name)+'"');return"{"+Ae.join(", ")+"}"},de.get=function(){var K=n.args("get",3,{self:null,key:null,deflt:null},["self","key","deflt"],arguments,{deflt:o.None},null,null);try{return de.__getitem__(K.self,K.key)}catch(ve){if(ve.__class__===o.KeyError)return K.deflt;throw ve}},de.keys=function(){return de.__iter__.apply(null,arguments)},de.items=function(){for(var K=n.args("values",1,{self:null},["self"],arguments,{},null,null).self.attributes,ve=[],Ae=0;Ae<K.length;Ae++)ve.push([K[Ae].name,K[Ae].value]);return o.list.__iter__(ve)},de.values=function(){for(var K=n.args("values",1,{self:null},["self"],arguments,{},null,null).self.attributes,ve=[],Ae=0;Ae<K.length;Ae++)ve.push(K[Ae].value);return o.list.__iter__(ve)},n.set_func_names(de,"<dom>");var be=n.DOMEvent={__class__:o.type,__mro__:[l],$infos:{__name__:"DOMEvent"}};function te(K,ve){var Ae=K.createSVGPoint();return Ae.x=ve.x,Ae.y=ve.y,Ae.matrixTransform(K.getScreenCTM().inverse())}be.__new__=function(K,ve){var Ae=new Event(ve);return Ae.__class__=be,void 0===Ae.preventDefault&&(Ae.preventDefault=function(){Ae.returnValue=!1}),void 0===Ae.stopPropagation&&(Ae.stopPropagation=function(){Ae.cancelBubble=!0}),Ae},be.__getattribute__=function(K,ve){switch(ve){case"__repr__":case"__str__":return function(){return"<DOMEvent object>"};case"x":return U(K).x;case"y":return U(K).y;case"data":return null!==K.dataTransfer?fe.$factory(K.dataTransfer):n.$JS2Py(K.data);case"target":if(void 0!==K.target)return T.$factory(K.target);case"char":return String.fromCharCode(K.which);case"svgX":if(K.target instanceof SVGSVGElement)return Math.floor(te(K.target,U(K)).x);throw o.AttributeError.$factory("event target is not an SVG element");case"svgY":if(K.target instanceof SVGSVGElement)return Math.floor(te(K.target,U(K)).y);throw o.AttributeError.$factory("event target is not an SVG element")}var Ae=K[ve];if(void 0!==Ae){if("function"==typeof Ae){var Fe=function(){for(var Ee=[],qe=0;qe<arguments.length;qe++)Ee.push(n.pyobj2jsobj(arguments[qe]));return Ae.apply(K,arguments)};return Fe.$infos={__name__:Ae.name,__qualname__:Ae.name},Fe}return n.$JS2Py(Ae)}throw o.AttributeError.$factory("object DOMEvent has no attribute '"+ve+"'")},be.$factory=function(K){return be.__new__(be,K)};var ce=n.$DOMEvent=function(K){return K.__class__=be,K.$no_dict=!0,void 0===K.preventDefault&&(K.preventDefault=function(){K.returnValue=!1}),void 0===K.stopPropagation&&(K.stopPropagation=function(){K.cancelBubble=!0}),K};n.set_func_names(be,"browser");var fe={__class__:o.type,$infos:{__module__:"browser",__name__:"Clipboard"},__getitem__:function(K,ve){return K.data.getData(ve)}};fe.__mro__=[l],fe.__setitem__=function(K,ve,Ae){K.data.setData(ve,Ae)},fe.$factory=function(K){return{__class__:fe,__dict__:n.empty_dict(),data:K}},n.set_func_names(fe,"<dom>");var _e=n.OpenFile={__class__:o.type,__mro__:[l],$infos:{__module__:"<pydom>",__name__:"OpenFile"}};_e.$factory=function(K,ve,Ae){var Fe={__class__:$OpenFileDict,file:K,reader:new FileReader};return"r"===ve?Fe.reader.readAsText(K,Ae):"rb"===ve&&Fe.reader.readAsBinaryString(K),Fe},_e.__getattr__=function(K,ve){return void 0!==K["get_"+ve]?K["get_"+ve]:K.reader[ve]},_e.__setattr__=function(K,ve,Ae){var Fe=K.reader;if("on"==ve.substr(0,2))Fe.addEventListener(ve.substr(2),function(Ee){return Ae(ce(Ee))});else{if("set_"+ve in Fe)return Fe["set_"+ve](Ae);ve in Fe?Fe[ve]=Ae:setattr(Fe,ve,Ae)}},n.set_func_names(_e,"<dom>");var le={File:function(){},FileReader:function(){}};le.File.__class__=o.type,le.File.__str__=function(){return"<class 'File'>"},le.FileReader.__class__=o.type,le.FileReader.__str__=function(){return"<class 'FileReader'>"};var pe={__class__:o.type,__delitem__:function(K,ve){K.parent.options.remove(ve.elt)},__getitem__:function(K,ve){return T.$factory(K.parent.options[ve])},__len__:function(K){return K.parent.options.length},__mro__:[l],__setattr__:function(K,ve,Ae){K.parent.options[ve]=Ae},__setitem__:function(K,ve,Ae){K.parent.options[ve]=n.$JS2Py(Ae)},__str__:function(K){return"<object Options wraps "+K.parent.options+">"},append:function(K,ve){K.parent.options.add(ve.elt)},insert:function(K,ve,Ae){void 0===ve?K.parent.options.add(Ae.elt):K.parent.options.add(Ae.elt,ve)},item:function(K,ve){return K.parent.options.item(ve)},namedItem:function(K,ve){return K.parent.options.namedItem(ve)},remove:function(K,ve){K.parent.options.remove(ve.elt)},$infos:{__module__:"<pydom>",__name__:"Options"},$factory:function(K){return{__class__:pe,parent:K}}};n.set_func_names(pe,"<dom>");var T={__class__:o.type,__mro__:[l],$infos:{__module__:"browser",__name__:"DOMNode"}};function B(K){for(var ve=[],Ae=0;Ae<K.length;Ae++)ve.push(T.$factory(K[Ae]));return ve}T.$factory=function(K,ve){if(K.__class__===T||"number"==typeof K||"boolean"==typeof K||"string"==typeof K)return K;if(void 0===ve&&void 0!==T.tags){var Ae=T.tags.$string_dict;if(void 0!==Ae&&Ae.hasOwnProperty(K.tagName)){try{var Fe=Ae[K.tagName][0]}catch(Ee){throw console.log("tdict",Ae,"tag name",K.tagName),Ee}if(void 0!==Fe)return Fe.$elt_wrap=K,Fe.$factory()}}return void 0!==K.$brython_id&&9!=K.nodeType||(K.$brython_id="DOM-"+n.UUID()),K},T.__add__=function(K,ve){var Ae=F.$factory();if(Ae.children=[K],pos=1,o.isinstance(ve,F))Ae.children=Ae.children.concat(ve.children);else if(o.isinstance(ve,[o.str,o.int,o.float,o.list,o.dict,o.set,o.tuple]))Ae.children[pos++]=T.$factory(document.createTextNode(o.str.$factory(ve)));else if(o.isinstance(ve,T))Ae.children[pos++]=ve;else try{Ae.children=Ae.children.concat(o.list.$factory(ve))}catch{throw o.TypeError.$factory("can't add '"+n.class_name(ve)+"' object to DOMNode instance")}return Ae},T.__bool__=function(K){return!0},T.__contains__=function(K,ve){if(9==K.nodeType&&"string"==typeof ve)return null!==document.getElementById(ve);if(void 0!==K.length&&"function"==typeof K.item)for(var Ae=0,Fe=K.length;Ae<Fe;Ae++)if(K.item(Ae)===ve)return!0;return!1},T.__del__=function(K){if(!K.parentNode)throw o.ValueError.$factory("can't delete "+o.str.$factory(K));K.parentNode.removeChild(K)},T.__delattr__=function(K,ve){if(void 0===K[ve])throw o.AttributeError.$factory(`cannot delete DOMNode attribute '${ve}'`);return delete K[ve],o.None},T.__delitem__=function(K,ve){if(9==K.nodeType){var Ae=K.getElementById(ve);if(!Ae)throw o.KeyError.$factory(ve);Ae.parentNode.removeChild(Ae)}else K.parentNode.removeChild(K)},T.__dir__=function(K){var ve=[];for(var Ae in K)"$"!=Ae.charAt(0)&&ve.push(Ae);return ve.sort(),ve},T.__eq__=function(K,ve){return K==ve},T.__getattribute__=function(K,ve){switch("$$"==ve.substr(0,2)&&(ve=ve.substr(2)),ve){case"attrs":return de.$factory(K);case"class_name":case"html":case"id":case"parent":case"text":return T[ve](K);case"height":case"left":case"top":case"width":if("CANVAS"==K.tagName&&K[ve])return K[ve];if(K instanceof SVGElement)return K[ve].baseVal.value;if(K.style[ve])return parseInt(K.style[ve]);var Ae=window.getComputedStyle(K)[ve];if(void 0!==Ae)return Math.floor(parseFloat(Ae)+.5);throw o.AttributeError.$factory("style."+ve+" is not set for "+o.str.$factory(K));case"x":case"y":if(!(K instanceof SVGElement)){var Fe=N(K);return"x"==ve?Fe.left:Fe.top}case"clear":case"closest":return function(){return T[ve](K,arguments[0])};case"headers":if(9==K.nodeType){var Ee=new XMLHttpRequest;Ee.open("GET",document.location,!1),Ee.send(null);var qe=Ee.getAllResponseHeaders();qe=qe.split("\r\n");for(var Ke=n.empty_dict(),gt=0;gt<qe.length;gt++){var at=qe[gt];0!=at.strip().length&&(Fe=at.search(":"),Ke.__setitem__(at.substr(0,Fe),at.substr(Fe+1).lstrip()))}return Ke}break;case"$$location":ve="location"}if("select"==ve&&1==K.nodeType&&["INPUT","TEXTAREA"].indexOf(K.tagName.toUpperCase())>-1)return function(mn){return void 0===mn?(K.select(),o.None):T.select(K,mn)};if("query"==ve&&9==K.nodeType){Ke={__class__:q,_keys:[],_values:{}};var Ct=location.search.substr(1).split("&");if(""!=location.search)for(gt=0;gt<Ct.length;gt++){Fe=Ct[gt].search("=");var wt=[Ct[gt].substr(0,Fe),Ct[gt].substr(Fe+1)],Ft=decodeURIComponent(wt[0]),Ot=decodeURIComponent(wt[1]);Ke._keys.indexOf(Ft)>-1?Ke._values[Ft].push(Ot):(Ke._keys.push(Ft),Ke._values[Ft]=[Ot])}return Ke}var rn=K[ve];if(void 0===rn&&n.aliased_names[ve]&&(rn=K["$$"+ve]),void 0===rn){if(K.tagName){var ft=customElements.get(K.tagName.toLowerCase());if(void 0!==ft&&void 0!==ft.$cls){var Tn=K.__class__;K.__class__=ft.$cls;try{return Ke=o.object.__getattribute__(K,ve),K.__class__=Tn,Ke}catch(mn){if(K.__class__=Tn,!n.is_exc(mn,[o.AttributeError]))throw mn}}}return l.__getattribute__(K,ve)}if(void 0!==(Ke=rn)){if(null===Ke)return o.None;if("function"==typeof Ke){var Cn=function(mn,Pn){return function(){for(var $n=[],gn=0,ur=0;ur<arguments.length;ur++){var or=arguments[ur];if("function"==typeof or){if(or.$cache)var hr=or.$cache;else hr=function(ei){return function(){try{return ei.apply(null,arguments)}catch(Jr){n.handle_error(Jr)}}}(or),or.$cache=hr;$n[gn++]=hr}else o.isinstance(or,T)?$n[gn++]=or:$n[gn++]=or===o.None?null:or.__class__==o.dict?o.dict.$to_obj(or):or}var sr=mn.apply(Pn,$n);return n.$JS2Py(sr)}}(Ke,K);return Cn.$infos={__name__:ve,__qualname__:ve},Cn.$is_func=!0,Cn}return"options"==ve?pe.$factory(K):"style"==ve?n.JSObj.$factory(K[ve]):Array.isArray(Ke)?Ke:n.$JS2Py(Ke)}return l.__getattribute__(K,ve)},T.__getitem__=function(K,ve){if(9==K.nodeType){if("string"==typeof ve){if(Fe=K.getElementById(ve))return T.$factory(Fe);throw o.KeyError.$factory(ve)}try{for(var Ae=K.getElementsByTagName(ve.$infos.__name__),Fe=[],Ee=0;Ee<Ae.length;Ee++)Fe.push(T.$factory(Ae[Ee]));return Fe}catch{throw o.KeyError.$factory(o.str.$factory(ve))}}else{if(("number"==typeof ve||"boolean"==typeof ve)&&"function"==typeof K.item){var qe=o.int.$factory(ve);if(qe<0&&(qe+=K.length),void 0===(Fe=T.$factory(K.item(qe))))throw o.KeyError.$factory(ve);return Fe}if("string"==typeof ve&&K.attributes&&"function"==typeof K.attributes.getNamedItem){var Ke=K.attributes.getNamedItem(ve);if(Ke)return Ke.value;throw o.KeyError.$factory(ve)}}},T.__hash__=function(K){return void 0===K.__hashvalue__?K.__hashvalue__=n.$py_next_hash--:K.__hashvalue__},T.__iter__=function(K){if(void 0!==K.length&&"function"==typeof K.item)for(var ve=[],Ae=0,Fe=K.length;Ae<Fe;Ae++)ve.push(T.$factory(K.item(Ae)));else if(void 0!==K.childNodes)for(ve=[],Ae=0,Fe=K.childNodes.length;Ae<Fe;Ae++)ve.push(T.$factory(K.childNodes[Ae]));return n.$iter(ve)},T.__le__=function(K,ve){if(9==K.nodeType&&(K=K.body),o.isinstance(ve,F))for(var Ae=0;Ae<ve.children.length;Ae++)K.appendChild(ve.children[Ae]);else if("string"==typeof ve||"number"==typeof ve){var Fe=document.createTextNode(ve.toString());K.appendChild(Fe)}else if(o.isinstance(ve,T))K.appendChild(ve);else try{o.list.$factory(ve).forEach(function(Ee){T.__le__(K,Ee)})}catch{throw o.TypeError.$factory("can't add '"+n.class_name(ve)+"' object to DOMNode instance")}return!0},T.__len__=function(K){return K.length},T.__mul__=function(K,ve){if(o.isinstance(ve,o.int)&&ve.valueOf()>0){for(var Ae=F.$factory(),Fe=Ae.children.length,Ee=0;Ee<ve.valueOf();Ee++)Ae.children[Fe++]=T.clone(K)();return Ae}throw o.ValueError.$factory("can't multiply "+K.__class__+"by "+ve)},T.__ne__=function(K,ve){return!T.__eq__(K,ve)},T.__next__=function(K){if(K.$counter++,K.$counter<K.childNodes.length)return T.$factory(K.childNodes[K.$counter]);throw o.StopIteration.$factory("StopIteration")},T.__radd__=function(K,ve){var Ae=F.$factory(),Fe=T.$factory(document.createTextNode(ve));return Ae.children=[Fe,K],Ae},T.__str__=T.__repr__=function(K){var ve=K.attributes;if(void 0!==ve)for(var Ae=[],Fe=0;Fe<ve.length;Fe++)Ae.push(ve[Fe].name+'="'+K.getAttributeNS(null,ve[Fe].name)+'"');var Ee=Object.getPrototypeOf(K);if(Ee){var qe=Ee.constructor.name;if(void 0===qe){var Ke=Ee.constructor.toString();qe=Ke.substring(8,Ke.length-1)}return Ae.splice(0,0,qe),"<"+Ae.join(" ")+">"}return"<DOMNode object type '"+P[K.nodeType]+"' name '"+K.nodeName+"'>"},T.__setattr__=function(K,ve,Ae){if("on"!=ve.substr(0,2)){let gt=function(at){console.log(at);var Ct=n.last(n.frames_stack);if(n.debug>0){var wt=Ct[1].$line_info.split(",");console.log("module",wt[1],"line",wt[0]),n.$py_src.hasOwnProperty(wt[1])&&console.log(n.$py_src[wt[1]].split("\n")[parseInt(wt[0])-1])}else console.log("module",Ct[2])};switch(ve){case"left":case"top":case"width":case"height":if(o.isinstance(Ae,o.int)&&1==K.nodeType)return K.style[ve]=Ae+"px",o.None;throw o.ValueError.$factory(ve+" value should be an integer, not "+n.class_name(Ae))}if(void 0!==T["set_"+ve])return T["set_"+ve](K,Ae);for(var Fe=Object.getPrototypeOf(K),Ee=0;Fe&&Fe!==Object.prototype&&Ee++<10;){var qe=Object.getOwnPropertyDescriptors(Fe);if(!qe||"function"!=typeof qe.hasOwnProperty)break;if(qe.hasOwnProperty(ve)){qe[ve].writable||void 0!==qe[ve].set||gt("Warning: property '"+ve+"' is not writable. Use element.attrs['"+ve+"'] instead.");break}Fe=Object.getPrototypeOf(Fe)}return K.style&&void 0!==K.style[ve]&&gt("Warning: '"+ve+"' is a property of element.style"),K[ve]=Ae,o.None}n.$bool(Ae)?T.bind(K,ve.substr(2),Ae):T.unbind(K,ve.substr(2))},T.__setitem__=function(K,ve,Ae){"number"==typeof ve?K.childNodes[ve]=Ae:"string"==typeof ve&&K.attributes&&(K instanceof SVGElement?K.setAttributeNS(null,ve,Ae):"function"==typeof K.setAttribute&&K.setAttribute(ve,Ae))},T.abs_left={__get__:function(K){return N(K).left},__set__:function(){throw o.AttributeError.$factory("'DOMNode' objectattribute 'abs_left' is read-only")}},T.abs_top={__get__:function(K){return N(K).top},__set__:function(){throw o.AttributeError.$factory("'DOMNode' objectattribute 'abs_top' is read-only")}},T.attach=T.__le__,T.bind=function(K,ve){var Ae=n.args("bind",4,{self:null,event:null,func:null,options:null},["self","event","func","options"],arguments,{func:o.None,options:o.None},null,null),Fe=(K=Ae.self,ve=Ae.event,Ae.func),Ee=Ae.options;if(Fe===o.None)return function(gt){return T.bind(K,ve,gt)};var qe,Ke=(qe=Fe,function(gt){try{return qe(ce(gt))}catch(at){if(void 0!==at.__class__)n.handle_error(at);else try{n.$getattr(n.stderr,"write")(at)}catch{console.log(at)}}});return Ke.$infos=Fe.$infos,Ke.$attrs=Fe.$attrs||{},Ke.$func=Fe,"boolean"==typeof Ee?K.addEventListener(ve,Ke,Ee):Ee.__class__===o.dict?K.addEventListener(ve,Ke,o.dict.$to_obj(Ee)):Ee===o.None&&K.addEventListener(ve,Ke,!1),K.$events=K.$events||{},K.$events[ve]=K.$events[ve]||[],K.$events[ve].push([Fe,Ke]),K},T.children=function(K){var ve=[];return 9==K.nodeType&&(K=K.body),K.childNodes.forEach(function(Ae){ve.push(T.$factory(Ae))}),ve},T.clear=function(K){for(9==K.nodeType&&(K=K.body);K.firstChild;)K.removeChild(K.firstChild)},T.Class=function(K){return void 0!==K.className?K.className:o.None},T.class_name=function(K){return T.Class(K)},T.clone=function(K){var ve=T.$factory(K.cloneNode(!0)),Ae=K.$events||{};for(var Fe in Ae)Ae[Fe].forEach(function(Ee){T.bind(ve,Fe,Ee[0])});return ve},T.closest=function(K,ve){var Ae=K.closest(ve);if(null===Ae)throw o.KeyError.$factory("no parent with selector "+ve);return T.$factory(Ae)},T.events=function(K,ve){K.$events=K.$events||{};var Ae=K.$events[ve]=K.$events[ve]||[],Fe=[];return Ae.forEach(function(Ee){Fe.push(Ee[1])}),Fe},T.focus=function(K){return ve=K,function(){setTimeout(function(){ve.focus()},10)};var ve},T.get=function(K){for(var ve=[],Ae=1;Ae<arguments.length;Ae++)ve.push(arguments[Ae]);var Fe=n.args("get",0,{},[],ve,{},null,"kw"),Ee={};if(o.list.$factory(o.dict.items(Fe.kw)).forEach(function(Ke){Ee[Ke[0]]=Ke[1]}),void 0!==Ee.name){if(void 0===K.getElementsByName)throw o.TypeError.$factory("DOMNode object doesn't support selection by name");return B(K.getElementsByName(Ee.name))}if(void 0!==Ee.tag){if(void 0===K.getElementsByTagName)throw o.TypeError.$factory("DOMNode object doesn't support selection by tag name");return B(K.getElementsByTagName(Ee.tag))}if(void 0!==Ee.classname){if(void 0===K.getElementsByClassName)throw o.TypeError.$factory("DOMNode object doesn't support selection by class name");return B(K.getElementsByClassName(Ee.classname))}if(void 0!==Ee.id){if(void 0===K.getElementById)throw o.TypeError.$factory("DOMNode object doesn't support selection by id");var qe=document.getElementById(Ee.id);return qe?[T.$factory(qe)]:[]}if(void 0!==Ee.selector){if(void 0===K.querySelectorAll)throw o.TypeError.$factory("DOMNode object doesn't support selection by selector");return B(K.querySelectorAll(Ee.selector))}return res},T.getContext=function(K){if(!("getContext"in K))throw o.AttributeError.$factory("object has no attribute 'getContext'");return function(ve){return n.JSObj.$factory(K.getContext(ve))}},T.getSelectionRange=function(K){if(void 0!==K.getSelectionRange)return K.getSelectionRange.apply(null,arguments)},T.html=function(K){var ve=K.innerHTML;return void 0===ve&&(ve=9==K.nodeType?K.body.innerHTML:o.None),ve},T.id=function(K){return void 0!==K.id?K.id:o.None},T.index=function(K,ve){var Ae;Ae=void 0===ve?K.parentElement.childNodes:K.parentElement.querySelectorAll(ve);for(var Fe=-1,Ee=0;Ee<Ae.length;Ee++)if(Ae[Ee]===K){Fe=Ee;break}return Fe},T.inside=function(K,ve){for(var Ae=K;;){if(ve===Ae)return!0;if(!(Ae=Ae.parentElement))return!1}},T.options=function(K){return new $OptionsClass(K)},T.parent=function(K){return K.parentElement?T.$factory(K.parentElement):o.None},T.reset=function(K){return function(){K.reset()}},T.scrolled_left={__get__:function(K){return N(K).left-document.scrollingElement.scrollLeft},__set__:function(){throw o.AttributeError.$factory("'DOMNode' objectattribute 'scrolled_left' is read-only")}},T.scrolled_top={__get__:function(K){return N(K).top-document.scrollingElement.scrollTop},__set__:function(){throw o.AttributeError.$factory("'DOMNode' objectattribute 'scrolled_top' is read-only")}},T.select=function(K,ve){if(void 0===K.querySelectorAll)throw o.TypeError.$factory("DOMNode object doesn't support selection by selector");return B(K.querySelectorAll(ve))},T.select_one=function(K,ve){if(void 0===K.querySelector)throw o.TypeError.$factory("DOMNode object doesn't support selection by selector");var Ae=K.querySelector(ve);return null===Ae?o.None:T.$factory(Ae)},T.style=function(K){return K.style.float=K.style.cssFloat||K.styleFloat,n.JSObj.$factory(K.style)},T.setSelectionRange=function(K){return void 0!==this.setSelectionRange?(ve=this,function(){return ve.setSelectionRange.apply(ve,arguments)}):void 0!==this.createTextRange?function(Ae){return function(Fe,Ee){null==Ee&&(Ee=Fe);var qe=Ae.createTextRange();qe.collapse(!0),qe.moveEnd("character",Fe),qe.moveStart("character",Ee),qe.select()}}(this):void 0;var ve},T.set_class_name=function(K,ve){K.setAttribute("class",ve)},T.set_html=function(K,ve){9==K.nodeType&&(K=K.body),K.innerHTML=o.str.$factory(ve)},T.set_style=function(K,ve){if(!o.isinstance(ve,o.dict))throw o.TypeError.$factory("style must be dict, not "+n.class_name(ve));for(var Ae=o.list.$factory(o.dict.items(ve)),Fe=0;Fe<Ae.length;Fe++){var Ee=Ae[Fe][0],qe=Ae[Fe][1];if("float"==Ee.toLowerCase())K.style.cssFloat=qe,K.style.styleFloat=qe;else{switch(Ee){case"top":case"left":case"width":case"borderWidth":o.isinstance(qe,o.int)&&(qe+="px")}K.style[Ee]=qe}}},T.set_text=function(K,ve){9==K.nodeType&&(K=K.body),K.innerText=o.str.$factory(ve),K.textContent=o.str.$factory(ve)},T.set_value=function(K,ve){K.value=o.str.$factory(ve)},T.submit=function(K){return function(){K.submit()}},T.text=function(K){9==K.nodeType&&(K=K.body);var ve=K.innerText||K.textContent;return null===ve&&(ve=o.None),ve},T.toString=function(K){return void 0===K?"DOMNode":K.nodeName},T.trigger=function(K,ve){if(K.fireEvent)K.fireEvent("on"+ve);else{var Ae=document.createEvent("Events");Ae.initEvent(ve,!0,!1),K.dispatchEvent(Ae)}},T.unbind=function(K,ve){if(K.$events=K.$events||{},K.$events==={})return o.None;if(void 0===ve){for(var ve in K.$events)T.unbind(K,ve);return o.None}if(void 0===K.$events[ve]||0==K.$events[ve].length)return o.None;var Ae=K.$events[ve];if(2==arguments.length){for(var Fe=0;Fe<Ae.length;Fe++){var Ee=Ae[Fe][1];K.removeEventListener(ve,Ee,!1)}return K.$events[ve]=[],o.None}for(Fe=2;Fe<arguments.length;Fe++){var qe=!1;if(void 0===(at=(Ee=arguments[Fe]).$func)){for(var Ke=!1,gt=0;gt<Ae.length;gt++)if(Ae[gt][0]===Ee){var at=Ee;Ke=!0;break}if(!Ke)throw o.TypeError.$factory("function is not an event callback")}for(gt=0;gt<Ae.length;gt++)if(n.$getattr(at,"__eq__")(Ae[gt][0])){K.removeEventListener(ve,Ee=Ae[gt][1],!1),Ae.splice(gt,1),qe=!0;break}if(!qe)throw o.KeyError.$factory("missing callback for event "+ve)}},n.set_func_names(T,"browser");var q={__class__:o.type,__mro__:[o.object],$infos:{__name__:"query"},__contains__:function(K,ve){return K._keys.indexOf(ve)>-1},__getitem__:function(K,ve){var Ae=K._values[ve];if(void 0===Ae)throw o.KeyError.$factory(ve);return 1==Ae.length?Ae[0]:Ae}},ee=n.make_iterator_class("query string iterator");q.__iter__=function(K){return ee.$factory(K._keys)},q.__setitem__=function(K,ve,Ae){return K._values[ve]=[Ae],o.None},q.__str__=q.__repr__=function(K){var ve=[];for(var Ae in K._values)for(const Fe of K._values[Ae])ve.push(encodeURIComponent(Ae)+"="+encodeURIComponent(Fe));return 0==ve.length?"":"?"+ve.join("&")},q.getfirst=function(K,ve,Ae){var Fe=K._values[ve];return void 0===Fe?void 0===Ae?o.None:Ae:Fe[0]},q.getlist=function(K,ve){var Ae=K._values[ve];return void 0===Ae?[]:Ae},q.getvalue=function(K,ve,Ae){try{return q.__getitem__(K,ve)}catch{return void 0===Ae?o.None:Ae}},q.keys=function(K){return K._keys},n.set_func_names(q,"<dom>");var F={__class__:o.type,__mro__:[l],$infos:{__module__:"<pydom>",__name__:"TagSum"},appendChild:function(K,ve){K.children.push(ve)},__add__:function(K,ve){return n.get_class(ve)===F?K.children=K.children.concat(ve.children):o.isinstance(ve,[o.str,o.int,o.float,o.dict,o.set,o.list])?K.children=K.children.concat(T.$factory(document.createTextNode(ve))):K.children.push(ve),K},__radd__:function(K,ve){var Ae=F.$factory();return Ae.children=K.children.concat(T.$factory(document.createTextNode(ve))),Ae},__repr__:function(K){for(var ve="<object TagSum> ",Ae=0;Ae<K.children.length;Ae++)ve+=K.children[Ae],"[object Text]"==K.children[Ae].toString()&&(ve+=" ["+K.children[Ae].textContent+"]\n");return ve}};F.__str__=F.toString=F.__repr__,F.clone=function(K){for(var ve=F.$factory(),Ae=0;Ae<K.children.length;Ae++)ve.children.push(K.children[Ae].cloneNode(!0));return ve},F.$factory=function(){return{__class__:F,children:[],toString:function(){return"(TagSum)"}}},n.set_func_names(F,"<dom>"),n.TagSum=F;var Be=n.JSObj.$factory(x);Be.get_postMessage=function(K,ve){if(o.isinstance(K,dict)){var Ae={__class__:"dict"};o.list.$factory(o.dict.items(K)).forEach(function(Fe){Ae[Fe[0]]=Fe[1]}),K=Ae}return x.postMessage(K,ve)},n.DOMNode=T,n.win=Be}(__BRYTHON__),function($B){var _b_=$B.builtins,bltns=$B.InjectBuiltins();eval(bltns);var $GeneratorReturn={};$B.generator_return=function(n){return{__class__:$GeneratorReturn,value:n}},$B.generator=$B.make_class("generator",function(n){var o=function(){var l=n.apply(null,arguments);if(l.$name=n.name,l.$func=n,l.$has_run=!1,l.__class__=$B.generator,n.$has_yield_in_cm){var x=$B.last($B.frames_stack)[1];x.$close_generators=x.$close_generators||[],x.$close_generators.push(l)}return l};return o.$infos=n.$infos,o.$is_genfunc=!0,o}),$B.generator.__iter__=function(n){return n},$B.generator.__next__=function(n){return $B.generator.send(n,_b_.None)},$B.generator.close=function(n){try{$B.generator.$$throw(n,_b_.GeneratorExit.$factory())}catch(o){if(!$B.is_exc(o,[_b_.GeneratorExit,_b_.StopIteration]))throw _b_.RuntimeError.$factory("generator ignored GeneratorExit")}},$B.generator.send=function(n,o){if(n.$has_run=!0,n.$finished)throw _b_.StopIteration.$factory(o);if(!0===n.gi_running)throw _b_.ValueError.$factory("generator already executing");n.gi_running=!0;try{var l=n.next(o)}catch(x){throw n.$finished=!0,x}if(l.value&&l.value.__class__===$GeneratorReturn)throw n.$finished=!0,_b_.StopIteration.$factory(l.value.value);if(n.gi_running=!1,l.done)throw _b_.StopIteration.$factory(l.value);return l.value},$B.generator.$$throw=function(n,o,l,x){var N=o;if(N.$is_class){if(!_b_.issubclass(o,_b_.BaseException))throw _b_.TypeError.$factory("exception value must be an instance of BaseException");void 0===l?N=$B.$call(N)():_b_.isinstance(l,o)&&(N=l)}else void 0===l?l=N:N=$B.$call(N)(l);void 0!==x&&(N.$traceback=x);var U=n.throw(N);if(U.done)throw _b_.StopIteration.$factory("StopIteration");return U.value},$B.set_func_names($B.generator,"builtins"),$B.async_generator=$B.make_class("async_generator",function(n){return function(){var o=n.apply(null,arguments);return o.__class__=$B.async_generator,o}});var ag_closed={};function rstrip(n,o){for(var l=o||" \t\n",x=0,N=n.length;x<N&&l.indexOf(n.charAt(N-1-x))>-1;)x++;return n.substr(0,N-x)}$B.async_generator.__aiter__=function(n){return n},$B.async_generator.__anext__=function(n){return $B.async_generator.asend(n,_b_.None)},$B.async_generator.aclose=function(n){return n.$finished=!0,_b_.None},$B.async_generator.asend=async function(n,o){if(n.$finished)throw _b_.StopAsyncIteration.$factory(o);if(!0===n.ag_running)throw _b_.ValueError.$factory("generator already executing");n.ag_running=!0;try{var l=await n.next(o)}catch(x){throw n.$finished=!0,x}if(l.done)throw _b_.StopAsyncIteration.$factory(o);if(l.value.__class__===$GeneratorReturn)throw n.$finished=!0,_b_.StopAsyncIteration.$factory(l.value.value);return n.ag_running=!1,l.value},$B.async_generator.athrow=async function(n,o,l,x){var N=o;if(N.$is_class){if(!_b_.issubclass(o,_b_.BaseException))throw _b_.TypeError.$factory("exception value must be an instance of BaseException");void 0===l&&(l=$B.$call(N)())}else void 0===l?l=N:N=$B.$call(N)(l);void 0!==x&&(N.$traceback=x),await n.throw(l)},$B.set_func_names($B.async_generator,"builtins")}(__BRYTHON__),function($B){var _b_=$B.builtins,update=function(n,o){for(attr in o)n[attr]=o[attr]},_window=self,modules={},browser={$package:!0,$is_package:!0,__initialized__:!0,__package__:"browser",__file__:$B.brython_path.replace(/\/*$/g,"")+"/Lib/browser/__init__.py",bind:function(){var n=$B.args("bind",3,{elt:null,evt:null,options:null},["elt","evt","options"],arguments,{options:_b_.None},null,null),o=n.options;return"boolean"==typeof o||o.__class__===_b_.dict&&(o=o.$string_dict),function(l){if($B.get_class(n.elt)===$B.JSObj)return n.elt.addEventListener(n.evt,function(A){try{return l($B.JSObj.$factory(A))}catch(P){$B.handle_error(P)}},o),l;if(_b_.isinstance(n.elt,$B.DOMNode))return $B.DOMNode.bind(n.elt,n.evt,l,o),l;if(_b_.isinstance(n.elt,_b_.str)){for(var x=document.querySelectorAll(n.elt),N=0;N<x.length;N++)$B.DOMNode.bind($B.DOMNode.$factory(x[N]),n.evt,l,o);return l}try{for(var U=$B.$iter(n.elt);;)try{var G=_b_.next(U);$B.DOMNode.bind(G,n.evt,l)}catch(A){if(_b_.isinstance(A,_b_.StopIteration))break;throw A}}catch(A){throw _b_.isinstance(A,_b_.AttributeError)&&$B.DOMNode.bind(n.elt,n.evt,l),A}return l}},console:self.console&&$B.JSObj.$factory(self.console),self:$B.win,win:$B.win,$$window:$B.win};browser.__path__=browser.__file__,$B.isNode?(delete browser.$$window,delete browser.win):$B.isWebWorker?(browser.is_webworker=!0,delete browser.$$window,delete browser.win,browser.self.send=self.postMessage):(browser.is_webworker=!1,update(browser,{$$alert:function(n){window.alert($B.builtins.str.$factory(n||""))},confirm:$B.JSObj.$factory(window.confirm),$$document:$B.DOMNode.$factory(document),doc:$B.DOMNode.$factory(document),DOMEvent:$B.DOMEvent,DOMNode:$B.DOMNode,load:function(script_url){var file_obj=$B.builtins.open(script_url),content=$B.$getattr(file_obj,"read")();eval(content)},mouseCoords:function(n){return $B.JSObj.$factory($mouseCoords(n))},prompt:function(n,o){return $B.JSObj.$factory(window.prompt(n,o||""))},reload:function(){var n=document.getElementsByTagName("script"),o=[];for(var l in n.forEach(function(x){void 0!==x.type&&"text/javascript"!=x.type||(o.push(x),x.src&&console.log(x.src))}),console.log(o),$B.imported)$B.imported[l].$last_modified?console.log("check",l,$B.imported[l].__file__,$B.imported[l].$last_modified):console.log("no date for mod",l)},run_script:function(){var n=$B.args("run_script",2,{src:null,name:null},["src","name"],arguments,{name:"script_"+$B.UUID()},null,null);$B.run_script(n.src,n.name,!0)},URLParameter:function(n){n=n.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var o=new RegExp("[\\?&]"+n+"=([^&#]*)").exec(location.search);return o=null===o?"":decodeURIComponent(o[1].replace(/\+/g," ")),$B.builtins.str.$factory(o)}}),modules["browser.html"]=function($B){var _b_=$B.builtins,TagSum=$B.TagSum;function makeTagDict(tagName){var dict={__class__:_b_.type,$infos:{__name__:tagName,__module__:"browser.html"},__init__:function(){var $ns=$B.args("pow",1,{self:null},["self"],arguments,{},"args","kw"),self=$ns.self,args=$ns.args;if(1==args.length){var first=args[0];if(_b_.isinstance(first,[_b_.str,_b_.int,_b_.float]))self.innerHTML=_b_.str.$factory(first);else if(first.__class__===TagSum)for(var i=0,len=first.children.length;i<len;i++)self.appendChild(first.children[i]);else if(_b_.isinstance(first,$B.DOMNode))self.appendChild(first);else try{var items=_b_.list.$factory(first);items.forEach(function(n){$B.DOMNode.__le__(self,n)})}catch(n){$B.debug>1&&(console.log(n,n.__class__,n.args),console.log("first",first),console.log(arguments)),$B.handle_error(n)}}for(var items=_b_.list.$factory(_b_.dict.items($ns.kw)),i=0,len=items.length;i<len;i++){var arg=items[i][0],value=items[i][1];if("on"==arg.toLowerCase().substr(0,2)){var js='$B.DOMNode.bind(self,"'+arg.toLowerCase().substr(2);eval(js+'",function(){'+value+"})")}else if("style"==arg.toLowerCase())$B.DOMNode.set_style(self,value);else if(!1!==value)try{arg=$B.imported["browser.html"].attribute_mapper(arg),self.setAttribute(arg,value)}catch(n){throw _b_.ValueError.$factory("can't set attribute "+arg)}}}};return dict.__mro__=[$B.DOMNode,$B.builtins.object],dict.__new__=function(n){if(void 0!==n.$elt_wrap){var o=n.$elt_wrap;n.$elt_wrap=void 0,(l=$B.DOMNode.$factory(o,!0))._wrapped=!0}else{var l;(l=$B.DOMNode.$factory(document.createElement(tagName),!0))._wrapped=!1}return l.__class__=n,l.__dict__=$B.empty_dict(),l},$B.set_func_names(dict,"browser.html"),dict}function makeFactory(n){return function(){if(void 0!==n.$elt_wrap){var o=n.$elt_wrap;n.$elt_wrap=void 0,(l=$B.DOMNode.$factory(o,!0))._wrapped=!0}else{if("SVG"==n.$infos.__name__)var l=$B.DOMNode.$factory(document.createElementNS("http://www.w3.org/2000/svg","svg"),!0);else o=document.createElement(n.$infos.__name__),l=$B.DOMNode.$factory(o,!0);l._wrapped=!1}return l.__class__=n,n.__init__(l,...arguments),l}}var tags=["A","ABBR","ACRONYM","ADDRESS","APPLET","AREA","B","BASE","BASEFONT","BDO","BIG","BLOCKQUOTE","BODY","BR","BUTTON","CAPTION","CENTER","CITE","CODE","COL","COLGROUP","DD","DEL","DFN","DIR","DIV","DL","DT","EM","FIELDSET","FONT","FORM","FRAME","FRAMESET","H1","H2","H3","H4","H5","H6","HEAD","HR","HTML","I","IFRAME","IMG","INPUT","INS","ISINDEX","KBD","LABEL","LEGEND","LI","LINK","MAP","MENU","META","NOFRAMES","NOSCRIPT","OBJECT","OL","OPTGROUP","OPTION","P","PARAM","PRE","Q","S","SAMP","SCRIPT","SELECT","SMALL","SPAN","STRIKE","STRONG","STYLE","SUB","SUP","SVG","TABLE","TBODY","TD","TEXTAREA","TFOOT","TH","THEAD","TITLE","TR","TT","U","UL","VAR","ARTICLE","ASIDE","AUDIO","BDI","CANVAS","COMMAND","DATA","DATALIST","EMBED","FIGCAPTION","FIGURE","FOOTER","HEADER","KEYGEN","MAIN","MARK","MATH","METER","NAV","OUTPUT","PROGRESS","RB","RP","RT","RTC","RUBY","SECTION","SOURCE","TEMPLATE","TIME","TRACK","VIDEO","WBR","DETAILS","DIALOG","MENUITEM","PICTURE","SUMMARY"],obj={tags:$B.empty_dict()},dicts={};function maketag(n){if("string"!=typeof n)throw _b_.TypeError.$factory("html.maketag expects a string as argument");var o=dicts[n]=makeTagDict(n);return o.$factory=makeFactory(o),_b_.dict.$setitem(obj.tags,n,o),o}return $B.DOMNode.tags=obj.tags,tags.forEach(function(n){obj[n]=maketag(n)}),obj.maketag=maketag,obj.attribute_mapper=function(n){return n.replace(/_/g,"-")},obj}(__BRYTHON__)),modules.browser=browser,$B.UndefinedClass=$B.make_class("Undefined",function(){return $B.Undefined}),$B.UndefinedClass.__mro__=[_b_.object],$B.UndefinedClass.__bool__=function(n){return!1},$B.UndefinedClass.__repr__=$B.UndefinedClass.__str__=function(n){return"<Javascript undefined>"},$B.Undefined={__class__:$B.UndefinedClass},$B.set_func_names($B.UndefinedClass,"javascript"),modules.javascript={$$this:function(){return void 0===$B.js_this?$B.builtins.None:$B.JSObj.$factory($B.js_this)},$$Date:self.Date&&$B.JSObj.$factory(self.Date),$$extends:function(n){return function(o){if("function"==typeof o){var l=function(){n.call(this,...arguments),o.apply(this,arguments)};return l.prototype=Object.create(n.prototype),l.prototype.constructor=l,l.$is_js_func=!0,l}if(o.$is_class){for(var x in console.log("obj",o),"Named"==n.$js_func.name&&console.log("-- Named"),l=function(){if(console.log("call parent class",o.$parent_class),o.$parent_class.call(this,...arguments),o.$$constructor){for(var U=[this],G=0,A=arguments.length;G<A;G++)U.push(arguments[G]);o.$$constructor.apply(this,U)}},l.prototype=Object.create(n.prototype),l.prototype.constructor=l,l.$is_js_func=!0,l.$class=o,o.$parent_class=n,o.__dict__.$string_dict){var N=o.__dict__.$string_dict[x][0];l.prototype[x]="function"==typeof N?function(U){return function(){for(var G=[this],A=0,P=arguments.length;A<P;A++)G.push($B.pyobj2jsobj(arguments[A]));return U.apply(this,G)}}(N):$B.pyobj2jsobj(N)}return l}}},JSON:{__class__:$B.make_class("JSON"),parse:function(){return $B.structuredclone2pyobj(JSON.parse.apply(this,arguments))},stringify:function(n,o,l){return JSON.stringify($B.pyobj2structuredclone(n,!1),$B.JSObj.$factory(o),l)}},jsobj2pyobj:function(n){return $B.jsobj2pyobj(n)},load:function(script_url){console.log('"javascript.load" is deprecrated. Use browser.load instead.');var file_obj=$B.builtins.open(script_url),content=$B.$getattr(file_obj,"read")();eval(content)},$$Math:self.Math&&$B.JSObj.$factory(self.Math),NULL:null,$$Number:self.Number&&$B.JSObj.$factory(self.Number),py2js:function(n,o){return void 0===o&&(o="__main__"+$B.UUID()),$B.py2js(n,o,o,$B.builtins_scope).to_js()},pyobj2jsobj:function(n){return $B.pyobj2jsobj(n)},$$RegExp:self.RegExp&&$B.JSObj.$factory(self.RegExp),$$String:self.String&&$B.JSObj.$factory(self.String),UNDEFINED:$B.Undefined,UndefinedType:$B.UndefinedClass};var arraybuffers=["Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];arraybuffers.forEach(function(n){void 0!==self[n]&&(modules.javascript[n]=$B.JSObj.$factory(self[n]))});var _b_=$B.builtins;function load(n,o){for(var l in o.__class__=$B.module,o.__name__=n,$B.imported[n]=o,o)if("function"==typeof o[l]){var x=$B.from_alias(l);o[l].$infos={__module__:n,__name__:x,__qualname__:n+"."+x}}}for(var attr in modules._sys={Getframe:function(){var n=$B.args("_getframe",1,{depth:null},["depth"],arguments,{depth:0},null,null).depth;return $B._frame.$factory($B.frames_stack,$B.frames_stack.length-n-1)},breakpointhook:function(){var n,o,l,x,N=$B.$options.breakpoint;void 0===N&&(N="pdb.set_trace"),[n,o,l]=_b_.str.rpartition(N,"."),""==o&&(n="builtins");try{$B.$import(n),x=$B.$getattr($B.imported[n],l)}catch{return console.warn("cannot import breakpoint",N),_b_.None}return $B.$call(x).apply(null,arguments)},exc_info:function(){for(var n=$B.frames_stack.length-1;n>=0;n--){var o=$B.frames_stack[n][1].$current_exception;if(o)return _b_.tuple.$factory([o.__class__,o,$B.$getattr(o,"__traceback__")])}return _b_.tuple.$factory([_b_.None,_b_.None,_b_.None])},excepthook:function(n,o,l){$B.handle_error(o)},gettrace:function(){return $B.tracefunc||_b_.None},modules:_b_.property.$factory(function(){return $B.obj_dict($B.imported)},function(n,o,l){throw _b_.TypeError.$factory("Read only property 'sys.modules'")}),path:_b_.property.$factory(function(){return $B.path},function(n,o,l){$B.path=l}),meta_path:_b_.property.$factory(function(){return $B.meta_path},function(n,o,l){$B.meta_path=l}),path_hooks:_b_.property.$factory(function(){return $B.path_hooks},function(n,o,l){$B.path_hooks=l}),path_importer_cache:_b_.property.$factory(function(){return _b_.dict.$factory($B.JSObj.$factory($B.path_importer_cache))},function(n,o,l){throw _b_.TypeError.$factory("Read only property 'sys.path_importer_cache'")}),settrace:function(){var n=$B.args("settrace",1,{tracefunc:null},["tracefunc"],arguments,{},null,null);return $B.tracefunc=n.tracefunc,$B.last($B.frames_stack)[1].$f_trace=$B.tracefunc,$B.tracefunc.$current_frame_id=$B.last($B.frames_stack)[0],_b_.None},stderr:_b_.property.$factory(function(){return $B.stderr},function(n,o){$B.stderr=o}),stdout:_b_.property.$factory(function(){return $B.stdout},function(n,o){$B.stdout=o}),stdin:_b_.property.$factory(function(){return $B.stdin},function(n,o){$B.stdin=o}),vfs:_b_.property.$factory(function(){return $B.hasOwnProperty("VFS")?$B.obj_dict($B.VFS):_b_.None},function(){throw _b_.TypeError.$factory("Read only property 'sys.vfs'")})},modules._sys.__breakpointhook__=modules._sys.breakpointhook,modules._sys.stderr.write=function(n){return $B.$getattr(_sys.stderr.__get__(),"write")(n)},modules._sys.stdout.write=function(n){return $B.$getattr(_sys.stdout.__get__(),"write")(n)},modules)load(attr,modules[attr]);$B.isWebWorker||$B.isNode||(modules.browser.html=modules["browser.html"]);var _b_=$B.builtins;for(var attr in _b_.__builtins__=$B.module.$factory("__builtins__","Python builtins"),_b_)_b_.__builtins__[attr]=_b_[attr],$B.builtins_scope.binding[attr]=!0;for(var name in _b_.__builtins__.__setattr__=function(n,o){_b_[n]=o},$B.method_descriptor.__getattribute__=$B.Function.__getattribute__,$B.wrapper_descriptor.__getattribute__=$B.Function.__getattribute__,_b_)if(_b_[name].__class__===_b_.type)for(var key in $B.builtin_classes.push(_b_[name]),_b_[name]){var value=_b_[name][key];void 0!==value&&(value.__class__||"function"==typeof value&&(value.__class__="__new__"==key?$B.builtin_function:key.startsWith("__")?$B.wrapper_descriptor:$B.method_descriptor,value.__objclass__=_b_[name]))}for(var attr in $B)Array.isArray($B[attr])&&($B[attr].__class__=_b_.list);$B.cell=$B.make_class("cell",function(n){return{__class__:$B.cell,$cell_contents:n}}),$B.cell.cell_contents=$B.$call(_b_.property)(function(n){if(null===n.$cell_contents)throw _b_.ValueError.$factory("empty cell");return n.$cell_contents},function(n,o){n.$cell_contents=o});var $comps=Object.values($B.$comps).concat(["eq","ne"]);$comps.forEach(function(n){var o="__"+n+"__";$B.cell[o]=function(l){return function(x,N){return _b_.isinstance(N,$B.cell)?null===x.$cell_contents?null===N.$cell_contents?"__eq__"==l:["__ne__","__lt__","__le__"].indexOf(l)>-1:null===N.$cell_contents?["__ne__","__gt__","__ge__"].indexOf(l)>-1:$B.rich_comp(l,x.$cell_contents,N.$cell_contents):NotImplemented}}(o)}),$B.set_func_names($B.cell,"builtins")}(__BRYTHON__);var docs={ArithmeticError:"Base class for arithmetic errors.",AssertionError:"Assertion failed.",AttributeError:"Attribute not found.",BaseException:"Common base class for all exceptions",BlockingIOError:"I/O operation would block.",BrokenPipeError:"Broken pipe.",BufferError:"Buffer error.",BytesWarning:"Base class for warnings about bytes and buffer related problems, mostly\nrelated to conversion from str or comparing to str.",ChildProcessError:"Child process error.",ConnectionAbortedError:"Connection aborted.",ConnectionError:"Connection error.",ConnectionRefusedError:"Connection refused.",ConnectionResetError:"Connection reset.",DeprecationWarning:"Base class for warnings about deprecated features.",EOFError:"Read beyond end of file.",Ellipsis:"",EnvironmentError:"Base class for I/O related errors.",Exception:"Common base class for all non-exit exceptions.",False:"bool(x) -> bool\n\nReturns True when the argument x is true, False otherwise.\nThe builtins True and False are the only two instances of the class bool.\nThe class bool is a subclass of the class int, and cannot be subclassed.",FileExistsError:"File already exists.",FileNotFoundError:"File not found.",FloatingPointError:"Floating point operation failed.",FutureWarning:"Base class for warnings about constructs that will change semantically\nin the future.",GeneratorExit:"Request that a generator exit.",IOError:"Base class for I/O related errors.",ImportError:"Import can't find module, or can't find name in module.",ImportWarning:"Base class for warnings about probable mistakes in module imports",IndentationError:"Improper indentation.",IndexError:"Sequence index out of range.",InterruptedError:"Interrupted by signal.",IsADirectoryError:"Operation doesn't work on directories.",KeyError:"Mapping key not found.",KeyboardInterrupt:"Program interrupted by user.",LookupError:"Base class for lookup errors.",MemoryError:"Out of memory.",NameError:"Name not found globally.",None:"",NotADirectoryError:"Operation only works on directories.",NotImplemented:"",NotImplementedError:"Method or function hasn't been implemented yet.",OSError:"Base class for I/O related errors.",OverflowError:"Result too large to be represented.",PendingDeprecationWarning:"Base class for warnings about features which will be deprecated\nin the future.",PermissionError:"Not enough permissions.",ProcessLookupError:"Process not found.",ReferenceError:"Weak ref proxy used after referent went away.",ResourceWarning:"Base class for warnings about resource usage.",RuntimeError:"Unspecified run-time error.",RuntimeWarning:"Base class for warnings about dubious runtime behavior.",StopIteration:"Signal the end from iterator.__next__().",SyntaxError:"Invalid syntax.",SyntaxWarning:"Base class for warnings about dubious syntax.",SystemError:"Internal error in the Python interpreter.\n\nPlease report this to the Python maintainer, along with the traceback,\nthe Python version, and the hardware/OS platform and version.",SystemExit:"Request to exit from the interpreter.",TabError:"Improper mixture of spaces and tabs.",TimeoutError:"Timeout expired.",True:"bool(x) -> bool\n\nReturns True when the argument x is true, False otherwise.\nThe builtins True and False are the only two instances of the class bool.\nThe class bool is a subclass of the class int, and cannot be subclassed.",TypeError:"Inappropriate argument type.",UnboundLocalError:"Local name referenced but not bound to a value.",UnicodeDecodeError:"Unicode decoding error.",UnicodeEncodeError:"Unicode encoding error.",UnicodeError:"Unicode related error.",UnicodeTranslateError:"Unicode translation error.",UnicodeWarning:"Base class for warnings about Unicode related problems, mostly\nrelated to conversion problems.",UserWarning:"Base class for warnings generated by user code.",ValueError:"Inappropriate argument value (of correct type).",Warning:"Base class for warning categories.",WindowsError:"Base class for I/O related errors.",ZeroDivisionError:"Second argument to a division or modulo operation was zero.",__debug__:"bool(x) -> bool\n\nReturns True when the argument x is true, False otherwise.\nThe builtins True and False are the only two instances of the class bool.\nThe class bool is a subclass of the class int, and cannot be subclassed.",abs:"abs(number) -> number\n\nReturn the absolute value of the argument.",all:"all(iterable) -> bool\n\nReturn True if bool(x) is True for all values x in the iterable.\nIf the iterable is empty, return True.",any:"any(iterable) -> bool\n\nReturn True if bool(x) is True for any x in the iterable.\nIf the iterable is empty, return False.",ascii:"ascii(object) -> string\n\nAs repr(), return a string containing a printable representation of an\nobject, but escape the non-ASCII characters in the string returned by\nrepr() using \\x, \\u or \\U escapes.  This generates a string similar\nto that returned by repr() in Python 2.",bin:"bin(number) -> string\n\nReturn the binary representation of an integer.\n\n   >>> bin(2796202)\n   '0b1010101010101010101010'\n",bool:"bool(x) -> bool\n\nReturns True when the argument x is true, False otherwise.\nThe builtins True and False are the only two instances of the class bool.\nThe class bool is a subclass of the class int, and cannot be subclassed.",bytearray:"bytearray(iterable_of_ints) -> bytearray\nbytearray(string, encoding[, errors]) -> bytearray\nbytearray(bytes_or_buffer) -> mutable copy of bytes_or_buffer\nbytearray(int) -> bytes array of size given by the parameter initialized with null bytes\nbytearray() -> empty bytes array\n\nConstruct an mutable bytearray object from:\n  - an iterable yielding integers in range(256)\n  - a text string encoded using the specified encoding\n  - a bytes or a buffer object\n  - any object implementing the buffer API.\n  - an integer",bytes:"bytes(iterable_of_ints) -> bytes\nbytes(string, encoding[, errors]) -> bytes\nbytes(bytes_or_buffer) -> immutable copy of bytes_or_buffer\nbytes(int) -> bytes object of size given by the parameter initialized with null bytes\nbytes() -> empty bytes object\n\nConstruct an immutable array of bytes from:\n  - an iterable yielding integers in range(256)\n  - a text string encoded using the specified encoding\n  - any object implementing the buffer API.\n  - an integer",callable:"callable(object) -> bool\n\nReturn whether the object is callable (i.e., some kind of function).\nNote that classes are callable, as are instances of classes with a\n__call__() method.",chr:"chr(i) -> Unicode character\n\nReturn a Unicode string of one character with ordinal i; 0 <= i <= 0x10ffff.",classmethod:"classmethod(function) -> method\n\nConvert a function to be a class method.\n\nA class method receives the class as implicit first argument,\njust like an instance method receives the instance.\nTo declare a class method, use this idiom:\n\n  class C:\n      def f(cls, arg1, arg2, ...): ...\n      f = classmethod(f)\n\nIt can be called either on the class (e.g. C.f()) or on an instance\n(e.g. C().f()).  The instance is ignored except for its class.\nIf a class method is called for a derived class, the derived class\nobject is passed as the implied first argument.\n\nClass methods are different than C++ or Java static methods.\nIf you want those, see the staticmethod builtin.",compile:"compile(source, filename, mode[, flags[, dont_inherit]]) -> code object\n\nCompile the source (a Python module, statement or expression)\ninto a code object that can be executed by exec() or eval().\nThe filename will be used for run-time error messages.\nThe mode must be 'exec' to compile a module, 'single' to compile a\nsingle (interactive) statement, or 'eval' to compile an expression.\nThe flags argument, if present, controls which future statements influence\nthe compilation of the code.\nThe dont_inherit argument, if non-zero, stops the compilation inheriting\nthe effects of any future statements in effect in the code calling\ncompile; if absent or zero these statements do influence the compilation,\nin addition to any features explicitly specified.",complex:"complex(real[, imag]) -> complex number\n\nCreate a complex number from a real part and an optional imaginary part.\nThis is equivalent to (real + imag*1j) where imag defaults to 0.",copyright:"interactive prompt objects for printing the license text, a list of\n    contributors and the copyright notice.",credits:"interactive prompt objects for printing the license text, a list of\n    contributors and the copyright notice.",delattr:"delattr(object, name)\n\nDelete a named attribute on an object; delattr(x, 'y') is equivalent to\n``del x.y''.",dict:"dict() -> new empty dictionary\ndict(mapping) -> new dictionary initialized from a mapping object's\n    (key, value) pairs\ndict(iterable) -> new dictionary initialized as if via:\n    d = {}\n    for k, v in iterable:\n        d[k] = v\ndict(**kwargs) -> new dictionary initialized with the name=value pairs\n    in the keyword argument list.  For example:  dict(one=1, two=2)",dir:"dir([object]) -> list of strings\n\nIf called without an argument, return the names in the current scope.\nElse, return an alphabetized list of names comprising (some of) the attributes\nof the given object, and of attributes reachable from it.\nIf the object supplies a method named __dir__, it will be used; otherwise\nthe default dir() logic is used and returns:\n  for a module object: the module's attributes.\n  for a class object:  its attributes, and recursively the attributes\n    of its bases.\n  for any other object: its attributes, its class's attributes, and\n    recursively the attributes of its class's base classes.",divmod:"divmod(x, y) -> (div, mod)\n\nReturn the tuple ((x-x%y)/y, x%y).  Invariant: div*y + mod == x.",enumerate:"enumerate(iterable[, start]) -> iterator for index, value of iterable\n\nReturn an enumerate object.  iterable must be another object that supports\niteration.  The enumerate object yields pairs containing a count (from\nstart, which defaults to zero) and a value yielded by the iterable argument.\nenumerate is useful for obtaining an indexed list:\n    (0, seq[0]), (1, seq[1]), (2, seq[2]), ...",eval:"eval(source[, globals[, locals]]) -> value\n\nEvaluate the source in the C of globals and locals.\nThe source may be a string representing a Python expression\nor a code object as returned by compile().\nThe globals must be a dictionary and locals can be any mapping,\ndefaulting to the current globals and locals.\nIf only globals is given, locals defaults to it.\n",exec:"exec(object[, globals[, locals]])\n\nRead and execute code from an object, which can be a string or a code\nobject.\nThe globals and locals are dictionaries, defaulting to the current\nglobals and locals.  If only globals is given, locals defaults to it.",exit:"",filter:"filter(function or None, iterable) --\x3e filter object\n\nReturn an iterator yielding those items of iterable for which function(item)\nis true. If function is None, return the items that are true.",float:"float(x) -> floating point number\n\nConvert a string or number to a floating point number, if possible.",format:'format(value[, format_spec]) -> string\n\nReturns value.__format__(format_spec)\nformat_spec defaults to ""',frozenset:"frozenset()-> empty frozenset object\nfrozenset(iterable)-> frozenset object\n\nBuild an immutable unordered collection of unique elements.",getattr:"getattr(object,name[,default])-> value\n\nGet a named attribute from an object;getattr(x,'y')is equivalent to x.y.\nWhen a default argument is given,it is returned when the attribute doesn't\nexist; without it, an exception is raised in that case.",globals:"globals() -> dictionary\n\nReturn the dictionary containing the current scope's global variables.",hasattr:"hasattr(object,name)-> bool\n\nReturn whether the object has an attribute with the given name.\n(This is done by calling getattr(object,name)and catching AttributeError.)",hash:"hash(object)-> integer\n\nReturn a hash value for the object. Two objects with the same value have\nthe same hash value. The reverse is not necessarily true,but likely.",help:"Define the builtin 'help'.\n\n This is a wrapper around pydoc.help that provides a helpful message\n when 'help' is typed at the Python interactive prompt.\n\n Calling help()at the Python prompt starts an interactive help session.\n Calling help(thing)prints help for the python object 'thing'.\n ",hex:"hex(number)-> string\n\nReturn the hexadecimal representation of an integer.\n\n >>> hex(3735928559)\n '0xdeadbeef'\n",id:"id(object)-> integer\n\nReturn the identity of an object. This is guaranteed to be unique among\nsimultaneously existing objects.(Hint:it's the object's memory address.)",input:"input([prompt])-> string\n\nRead a string from standard input. The trailing newline is stripped.\nIf the user hits EOF(Unix:Ctl-D,Windows:Ctl-Z+Return),raise EOFError.\nOn Unix,GNU readline is used if enabled. The prompt string,if given,\nis printed without a trailing newline before reading.",int:"int(x=0)-> integer\nint(x,base=10)-> integer\n\nConvert a number or string to an integer,or return 0 if no arguments\nare given. If x is a number,return x.__int__(). For floating point\nnumbers,this truncates towards zero.\n\nIf x is not a number or if base is given,then x must be a string,\nbytes,or bytearray instance representing an integer literal in the\ngiven base. The literal can be preceded by '+' or '-' and be surrounded\nby whitespace. The base defaults to 10. Valid bases are 0 and 2-36.\nBase 0 means to interpret the base from the string as an integer literal.\n>>> int('0b100',base=0)\n4",isinstance:"isinstance(object,class-or-type-or-tuple)-> bool\n\nReturn whether an object is an instance of a class or of a subclass thereof.\nWith a type as second argument,return whether that is the object's type.\nThe form using a tuple, isinstance(x, (A, B, ...)), is a shortcut for\nisinstance(x, A) or isinstance(x, B) or ... (etc.).",issubclass:"issubclass(C, B) -> bool\n\nReturn whether class C is a subclass (i.e., a derived class) of class B.\nWhen using a tuple as the second argument issubclass(X, (A, B, ...)),\nis a shortcut for issubclass(X, A) or issubclass(X, B) or ... (etc.).",iter:"iter(iterable) -> iterator\niter(callable, sentinel) -> iterator\n\nGet an iterator from an object.  In the first form, the argument must\nsupply its own iterator, or be a sequence.\nIn the second form, the callable is called until it returns the sentinel.",len:"len(object)\n\nReturn the number of items of a sequence or collection.",license:"interactive prompt objects for printing the license text, a list of\n    contributors and the copyright notice.",list:"list() -> new empty list\nlist(iterable) -> new list initialized from iterable's items",locals:"locals()-> dictionary\n\nUpdate and return a dictionary containing the current scope's local variables.",map:"map(func, *iterables) --\x3e map object\n\nMake an iterator that computes the function using arguments from\neach of the iterables.  Stops when the shortest iterable is exhausted.",max:"max(iterable, *[, default=obj, key=func]) -> value\nmax(arg1, arg2, *args, *[, key=func]) -> value\n\nWith a single iterable argument, return its biggest item. The\ndefault keyword-only argument specifies an object to return if\nthe provided iterable is empty.\nWith two or more arguments, return the largest argument.",memoryview:"memoryview(object)\n\nCreate a new memoryview object which references the given object.",min:"min(iterable, *[, default=obj, key=func]) -> value\nmin(arg1, arg2, *args, *[, key=func]) -> value\n\nWith a single iterable argument, return its smallest item. The\ndefault keyword-only argument specifies an object to return if\nthe provided iterable is empty.\nWith two or more arguments, return the smallest argument.",next:"next(iterator[, default])\n\nReturn the next item from the iterator. If default is given and the iterator\nis exhausted, it is returned instead of raising StopIteration.",object:"The most base type",oct:"oct(number) -> string\n\nReturn the octal representation of an integer.\n\n   >>> oct(342391)\n   '0o1234567'\n",open:"open(file, mode='r', buffering=-1, encoding=None,\n     errors=None, newline=None, closefd=True, opener=None) -> file object\n\nOpen file and return a stream.  Raise IOError upon failure.\n\nfile is either a text or byte string giving the name (and the path\nif the file isn't in the current working directory)of the file to\nbe opened or an integer file descriptor of the file to be\nwrapped.(If a file descriptor is given,it is closed when the\nreturned I/O object is closed,unless closefd is set to False.)\n\nmode is an optional string that specifies the mode in which the file\nis opened. It defaults to 'r' which means open for reading in text\nmode. Other common values are 'w' for writing(truncating the file if\nit already exists),'x' for creating and writing to a new file,and\n'a' for appending(which on some Unix systems,means that all writes\nappend to the end of the file regardless of the current seek position).\nIn text mode,if encoding is not specified the encoding used is platform\ndependent:locale.getpreferredencoding(False)is called to get the\ncurrent locale encoding.(For reading and writing raw bytes use binary\nmode and leave encoding unspecified.)The available modes are:\n\n========================================================================\nCharacter Meaning\n------------------------------------------------------------------------\n'r' open for reading(default)\n'w' open for writing,truncating the file first\n'x' create a new file and open it for writing\n'a' open for writing,appending to the end of the file if it exists\n'b' binary mode\n't' text mode(default)\n'+' open a disk file for updating(reading and writing)\n'U' universal newline mode(deprecated)\n========================================================================\n\nThe default mode is 'rt'(open for reading text). For binary random\naccess,the mode 'w+b' opens and truncates the file to 0 bytes,while\n'r+b' opens the file without truncation. The 'x' mode implies 'w' and\nraises an `FileExistsError` if the file already exists.\n\nPython distinguishes between files opened in binary and text modes,\neven when the underlying operating system doesn't. Files opened in\nbinary mode (appending 'b' to the mode argument) return contents as\nbytes objects without any decoding. In text mode (the default, or when\n't' is appended to the mode argument), the contents of the file are\nreturned as strings, the bytes having been first decoded using a\nplatform-dependent encoding or using the specified encoding if given.\n\n'U' mode is deprecated and will raise an exception in future versions\nof Python.  It has no effect in Python 3.  Use newline to control\nuniversal newlines mode.\n\nbuffering is an optional integer used to set the buffering policy.\nPass 0 to switch buffering off (only allowed in binary mode), 1 to select\nline buffering (only usable in text mode), and an integer > 1 to indicate\nthe size of a fixed-size chunk buffer.  When no buffering argument is\ngiven, the default buffering policy works as follows:\n\n* Binary files are buffered in fixed-size chunks; the size of the buffer\n  is chosen using a heuristic trying to determine the underlying device's\n \"block size\" and falling back on `io.DEFAULT_BUFFER_SIZE`.\n  On many systems, the buffer will typically be 4096 or 8192 bytes long.\n\n* \"Interactive\" text files (files for which isatty() returns True)\n  use line buffering.  Other text files use the policy described above\n  for binary files.\n\nencoding is the name of the encoding used to decode or encode the\nfile. This should only be used in text mode. The default encoding is\nplatform dependent, but any encoding supported by Python can be\npassed.  See the codecs module for the list of supported encodings.\n\nerrors is an optional string that specifies how encoding errors are to\nbe handled---this argument should not be used in binary mode. Pass\n'strict' to raise a ValueError exception if there is an encoding error\n(the default of None has the same effect), or pass 'ignore' to ignore\nerrors. (Note that ignoring encoding errors can lead to data loss.)\nSee the documentation for codecs.register or run 'help(codecs.Codec)'\nfor a list of the permitted encoding error strings.\n\nnewline controls how universal newlines works (it only applies to text\nmode). It can be None, '', '\\n', '\\r', and '\\r\\n'.  It works as\nfollows:\n\n* On input, if newline is None, universal newlines mode is\n  enabled. Lines in the input can end in '\\n', '\\r', or '\\r\\n', and\n  these are translated into '\\n' before being returned to the\n  caller. If it is '', universal newline mode is enabled, but line\n  endings are returned to the caller untranslated. If it has any of\n  the other legal values, input lines are only terminated by the given\n  string, and the line ending is returned to the caller untranslated.\n\n* On output, if newline is None, any '\\n' characters written are\n  translated to the system default line separator, os.linesep. If\n  newline is '' or '\\n', no translation takes place. If newline is any\n  of the other legal values, any '\\n' characters written are translated\n  to the given string.\n\nIf closefd is False, the underlying file descriptor will be kept open\nwhen the file is closed. This does not work when a file name is given\nand must be True in that case.\n\nA custom opener can be used by passing a callable as *opener*. The\nunderlying file descriptor for the file object is then obtained by\ncalling *opener* with (*file*, *flags*). *opener* must return an open\nfile descriptor (passing os.open as *opener* results in functionality\nsimilar to passing None).\n\nopen() returns a file object whose type depends on the mode, and\nthrough which the standard file operations such as reading and writing\nare performed. When open() is used to open a file in a text mode ('w',\n'r', 'wt', 'rt', etc.), it returns a TextIOWrapper. When used to open\na file in a binary mode, the returned class varies: in read binary\nmode, it returns a BufferedReader; in write binary and append binary\nmodes, it returns a BufferedWriter, and in read/write mode, it returns\na BufferedRandom.\n\nIt is also possible to use a string or bytearray as a file for both\nreading and writing. For strings StringIO can be used like a file\nopened in a text mode, and for bytes a BytesIO can be used like a file\nopened in a binary mode.\n",ord:"ord(c) -> integer\n\nReturn the integer ordinal of a one-character string.",pow:"pow(x, y[, z]) -> number\n\nWith two arguments, equivalent to x**y.  With three arguments,\nequivalent to (x**y) % z, but may be more efficient (e.g. for ints).",print:"print(value, ..., sep=' ', end='\\n', file=sys.stdout, flush=False)\n\nPrints the values to a stream, or to sys.stdout by default.\nOptional keyword arguments:\nfile:  a file-like object (stream); defaults to the current sys.stdout.\nsep:   string inserted between values, default a space.\nend:   string appended after the last value, default a newline.\nflush: whether to forcibly flush the stream.",property:"property(fget=None, fset=None, fdel=None, doc=None) -> property attribute\n\nfget is a function to be used for getting an attribute value, and likewise\nfset is a function for setting, and fdel a function for del'ing, an\nattribute.  Typical use is to define a managed attribute x:\n\nclass C(object):\n    def getx(self): return self._x\n    def setx(self, value): self._x = value\n    def delx(self): del self._x\n    x = property(getx, setx, delx, \"I'm the 'x' property.\")\n\nDecorators make defining new properties or modifying existing ones easy:\n\nclass C(object):\n    @property\n    def x(self):\n        \"I am the 'x' property.\"\n        return self._x\n    @x.setter\n    def x(self, value):\n        self._x = value\n    @x.deleter\n    def x(self):\n        del self._x\n",quit:"",range:"range(stop) -> range object\nrange(start, stop[, step]) -> range object\n\nReturn a virtual sequence of numbers from start to stop by step.",repr:"repr(object) -> string\n\nReturn the canonical string representation of the object.\nFor most object types, eval(repr(object)) == object.",reversed:"reversed(sequence) -> reverse iterator over values of the sequence\n\nReturn a reverse iterator",round:"round(number[, ndigits]) -> number\n\nRound a number to a given precision in decimal digits (default 0 digits).\nThis returns an int when called with one argument, otherwise the\nsame type as the number. ndigits may be negative.",set:"set() -> new empty set object\nset(iterable) -> new set object\n\nBuild an unordered collection of unique elements.",setattr:"setattr(object, name, value)\n\nSet a named attribute on an object; setattr(x, 'y', v) is equivalent to\n``x.y = v''.",slice:"slice(stop)\nslice(start, stop[, step])\n\nCreate a slice object.  This is used for extended slicing (e.g. a[0:10:2]).",sorted:"sorted(iterable, key=None, reverse=False) --\x3e new sorted list",staticmethod:"staticmethod(function) -> method\n\nConvert a function to be a static method.\n\nA static method does not receive an implicit first argument.\nTo declare a static method, use this idiom:\n\n     class C:\n     def f(arg1, arg2, ...): ...\n     f = staticmethod(f)\n\nIt can be called either on the class (e.g. C.f()) or on an instance\n(e.g. C().f()).  The instance is ignored except for its class.\n\nStatic methods in Python are similar to those found in Java or C++.\nFor a more advanced concept, see the classmethod builtin.",str:"str(object='') -> str\nstr(bytes_or_buffer[, encoding[, errors]]) -> str\n\nCreate a new string object from the given object. If encoding or\nerrors is specified, then the object must expose a data buffer\nthat will be decoded using the given encoding and error handler.\nOtherwise, returns the result of object.__str__() (if defined)\nor repr(object).\nencoding defaults to sys.getdefaultencoding().\nerrors defaults to 'strict'.",sum:"sum(iterable[, start]) -> value\n\nReturn the sum of an iterable of numbers (NOT strings) plus the value\nof parameter 'start' (which defaults to 0).  When the iterable is\nempty, return start.",super:"super() -> same as super(__class__, <first argument>)\nsuper(type) -> unbound super object\nsuper(type, obj) -> bound super object; requires isinstance(obj, type)\nsuper(type, type2) -> bound super object; requires issubclass(type2, type)\nTypical use to call a cooperative superclass method:\nclass C(B):\n    def meth(self, arg):\n        super().meth(arg)\nThis works for class methods too:\nclass C(B):\n    @classmethod\n    def cmeth(cls, arg):\n        super().cmeth(arg)\n",tuple:"tuple() -> empty tuple\ntuple(iterable) -> tuple initialized from iterable's items\n\nIf the argument is a tuple, the return value is the same object.",type:"type(object_or_name, bases, dict)\ntype(object) -> the object's type\ntype(name, bases, dict) -> a new type",vars:"vars([object]) -> dictionary\n\nWithout arguments, equivalent to locals().\nWith an argument, equivalent to object.__dict__.",zip:"zip(iter1 [,iter2 [...]]) --\x3e zip object\n\nReturn a zip object whose .__next__() method returns a tuple where\nthe i-th element comes from the i-th iterable argument.  The .__next__()\nmethod continues until the shortest iterable in the argument sequence\nis exhausted and then it raises StopIteration."},n,o;return __BRYTHON__.builtins_doc=docs,n=__BRYTHON__,o=n.builtins,n.import_hooks=function(l,x,N){var U,G,A=n.meta_path.slice(),P=n.imported;if(N){var de=A.indexOf(n.finders.path);de>-1&&A.splice(de,1)}for(var be=0,te=A.length;be<te;be++){var ce=A[be],fe=n.$getattr(ce,"find_spec",o.None);if(fe==o.None){var _e=n.$getattr(ce,"find_module",o.None);if(_e!==o.None&&(U=_e(l,x))!==o.None){var le=n.$getattr(U,"load_module"),pe=n.$call(le)(l);return P[l]=pe,pe}}else if(G=fe(l,x),!n.is_none(G)){if(void 0!==(pe=n.imported[G.name]))return P[G.name]=pe;U=o.getattr(G,"loader",o.None);break}}if(void 0===U){message=l,"file"==n.protocol&&(message+=" (warning: cannot import local files with protocol 'file')");var T=o.ModuleNotFoundError.$factory(message);throw T.name=l,T}if(n.is_none(pe)){if(G===o.None)throw o.ModuleNotFoundError.$factory(l);var B=o.getattr(G,"name");if(!n.is_none(U)){var q=o.getattr(U,"create_module",o.None);n.is_none(q)||(pe=n.$call(q)(G))}if(void 0===pe)throw o.ImportError.$factory(l);if(n.is_none(pe)){pe=n.module.$factory(l);var ee=o.getattr(G,"origin");ee=o.getattr(G,"has_location")?"from '"+ee+"'":"("+ee+")"}}pe.__name__=B,pe.__loader__=U,pe.__package__=o.getattr(G,"parent",""),pe.__spec__=G;var F=o.getattr(G,"submodule_search_locations");(pe.$is_package=!n.is_none(F))&&(pe.__path__=F),o.getattr(G,"has_location")&&(pe.__file__=o.getattr(G,"origin"),n.$py_module_path[pe.__name__]=pe.__file__);var Be=o.getattr(G,"cached");if(n.is_none(Be)||(pe.__cached__=Be),n.is_none(U)){if(n.is_none(F))throw o.ImportError.$factory(l);P[B]=pe}else{var K=o.getattr(U,"exec_module",o.None);if(n.is_none(K))pe=o.getattr(U,"load_module")(B);else{P[B]=pe;try{K(pe)}catch(ve){throw delete P[B],ve}}}return P[B]},function(n){var o=n.coroutine=n.make_class("coroutine");o.close=function(l){},o.send=function(l){return l.$func.apply(null,l.$args)},o.__repr__=o.__str__=function(l){return l.$func.$infos?"<coroutine "+l.$func.$infos.__name__+">":"<coroutine object>"},n.set_func_names(o,"builtins"),n.make_async=l=>{if(l.$is_genfunc)return l;var x=function(){var N=arguments,U=n.deep_copy(n.frames_stack);return{__class__:o,$args:N,$func:l,$stack:U}};return x.$infos=l.$infos,x},n.promise=function(l){return l.__class__===o?o.send(l):"function"==typeof l?l():l}}(__BRYTHON__),window.__BRYTHON__=__BRYTHON__,__BRYTHON__},__WEBPACK_AMD_DEFINE_ARRAY__=[],void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=factory)?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},561:n=>{var o=Object.prototype.toString;n.exports=function(l){return l.BYTES_PER_ELEMENT&&"[object ArrayBuffer]"===o.call(l.buffer)||Array.isArray(l)}},355:n=>{n.exports=function(o,l){return"number"==typeof o?o:"number"==typeof l?l:0}},546:function(n,o,l){var x,N,U;N=[l(734)],x=function(G){"use strict";var A=function(T,B,q){if(void 0===T&&(T=A.DEFAULT_CAPACITY),void 0===B&&(B=A.DEFAULT_ENDIAN),void 0===q&&(q=A.DEFAULT_NOASSERT),!q){if((T|=0)<0)throw RangeError("Illegal capacity");B=!!B,q=!!q}this.buffer=0===T?de:new ArrayBuffer(T),this.view=0===T?null:new Uint8Array(this.buffer),this.offset=0,this.markedOffset=-1,this.limit=T,this.littleEndian=B,this.noAssert=q};A.VERSION="5.0.1",A.LITTLE_ENDIAN=!0,A.BIG_ENDIAN=!1,A.DEFAULT_CAPACITY=16,A.DEFAULT_ENDIAN=A.BIG_ENDIAN,A.DEFAULT_NOASSERT=!1,A.Long=G||null;var P=A.prototype;Object.defineProperty(P,"__isByteBuffer__",{value:!0,enumerable:!1,configurable:!1});var de=new ArrayBuffer(0),be=String.fromCharCode;function te(T){var B=0;return function(){return B<T.length?T.charCodeAt(B++):null}}function ce(){var T=[],B=[];return function(){if(0===arguments.length)return B.join("")+be.apply(String,T);T.length+arguments.length>1024&&(B.push(be.apply(String,T)),T.length=0),Array.prototype.push.apply(T,arguments)}}function fe(T,B,q,ee,F){var Be,K,ve=8*F-ee-1,Ae=(1<<ve)-1,Fe=Ae>>1,Ee=-7,qe=q?F-1:0,Ke=q?-1:1,gt=T[B+qe];for(qe+=Ke,Be=gt&(1<<-Ee)-1,gt>>=-Ee,Ee+=ve;Ee>0;Be=256*Be+T[B+qe],qe+=Ke,Ee-=8);for(K=Be&(1<<-Ee)-1,Be>>=-Ee,Ee+=ee;Ee>0;K=256*K+T[B+qe],qe+=Ke,Ee-=8);if(0===Be)Be=1-Fe;else{if(Be===Ae)return K?NaN:1/0*(gt?-1:1);K+=Math.pow(2,ee),Be-=Fe}return(gt?-1:1)*K*Math.pow(2,Be-ee)}function _e(T,B,q,ee,F,Be){var K,ve,Ae,Fe=8*Be-F-1,Ee=(1<<Fe)-1,qe=Ee>>1,Ke=23===F?Math.pow(2,-24)-Math.pow(2,-77):0,gt=ee?0:Be-1,at=ee?1:-1,Ct=B<0||0===B&&1/B<0?1:0;for(B=Math.abs(B),isNaN(B)||B===1/0?(ve=isNaN(B)?1:0,K=Ee):(K=Math.floor(Math.log(B)/Math.LN2),B*(Ae=Math.pow(2,-K))<1&&(K--,Ae*=2),(B+=K+qe>=1?Ke/Ae:Ke*Math.pow(2,1-qe))*Ae>=2&&(K++,Ae/=2),K+qe>=Ee?(ve=0,K=Ee):K+qe>=1?(ve=(B*Ae-1)*Math.pow(2,F),K+=qe):(ve=B*Math.pow(2,qe-1)*Math.pow(2,F),K=0));F>=8;T[q+gt]=255&ve,gt+=at,ve/=256,F-=8);for(K=K<<F|ve,Fe+=F;Fe>0;T[q+gt]=255&K,gt+=at,K/=256,Fe-=8);T[q+gt-at]|=128*Ct}A.accessor=function(){return Uint8Array},A.allocate=function(T,B,q){return new A(T,B,q)},A.concat=function(T,B,q,ee){"boolean"!=typeof B&&"string"==typeof B||(ee=q,q=B,B=void 0);for(var F,Be=0,K=0,ve=T.length;K<ve;++K)A.isByteBuffer(T[K])||(T[K]=A.wrap(T[K],B)),(F=T[K].limit-T[K].offset)>0&&(Be+=F);if(0===Be)return new A(0,q,ee);var Ae,Fe=new A(Be,q,ee);for(K=0;K<ve;)(F=(Ae=T[K++]).limit-Ae.offset)<=0||(Fe.view.set(Ae.view.subarray(Ae.offset,Ae.limit),Fe.offset),Fe.offset+=F);return Fe.limit=Fe.offset,Fe.offset=0,Fe},A.isByteBuffer=function(T){return!0===(T&&T.__isByteBuffer__)},A.type=function(){return ArrayBuffer},A.wrap=function(T,B,q,ee){if("string"!=typeof B&&(ee=q,q=B,B=void 0),"string"==typeof T)switch(void 0===B&&(B="utf8"),B){case"base64":return A.fromBase64(T,q);case"hex":return A.fromHex(T,q);case"binary":return A.fromBinary(T,q);case"utf8":return A.fromUTF8(T,q);case"debug":return A.fromDebug(T,q);default:throw Error("Unsupported encoding: "+B)}if(null===T||"object"!=typeof T)throw TypeError("Illegal buffer");var F;if(A.isByteBuffer(T))return(F=P.clone.call(T)).markedOffset=-1,F;if(T instanceof Uint8Array)F=new A(0,q,ee),T.length>0&&(F.buffer=T.buffer,F.offset=T.byteOffset,F.limit=T.byteOffset+T.byteLength,F.view=new Uint8Array(T.buffer));else if(T instanceof ArrayBuffer)F=new A(0,q,ee),T.byteLength>0&&(F.buffer=T,F.offset=0,F.limit=T.byteLength,F.view=T.byteLength>0?new Uint8Array(T):null);else{if("[object Array]"!==Object.prototype.toString.call(T))throw TypeError("Illegal buffer");(F=new A(T.length,q,ee)).limit=T.length;for(var Be=0;Be<T.length;++Be)F.view[Be]=T[Be]}return F},P.writeBitSet=function(T,B){var q=void 0===B;if(q&&(B=this.offset),!this.noAssert){if(!(T instanceof Array))throw TypeError("Illegal BitSet: Not an array");if("number"!=typeof B||B%1!=0)throw TypeError("Illegal offset: "+B+" (not an integer)");if((B>>>=0)<0||B+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+B+" (+0) <= "+this.buffer.byteLength)}var ee,F=B,Be=T.length,K=Be>>3,ve=0;for(B+=this.writeVarint32(Be,B);K--;)ee=1&!!T[ve++]|(1&!!T[ve++])<<1|(1&!!T[ve++])<<2|(1&!!T[ve++])<<3|(1&!!T[ve++])<<4|(1&!!T[ve++])<<5|(1&!!T[ve++])<<6|(1&!!T[ve++])<<7,this.writeByte(ee,B++);if(ve<Be){var Ae=0;for(ee=0;ve<Be;)ee|=(1&!!T[ve++])<<Ae++;this.writeByte(ee,B++)}return q?(this.offset=B,this):B-F},P.readBitSet=function(T){var B=void 0===T;B&&(T=this.offset);var q,ee=this.readVarint32(T),F=ee.value,Be=F>>3,K=0,ve=[];for(T+=ee.length;Be--;)q=this.readByte(T++),ve[K++]=!!(1&q),ve[K++]=!!(2&q),ve[K++]=!!(4&q),ve[K++]=!!(8&q),ve[K++]=!!(16&q),ve[K++]=!!(32&q),ve[K++]=!!(64&q),ve[K++]=!!(128&q);if(K<F){var Ae=0;for(q=this.readByte(T++);K<F;)ve[K++]=!!(q>>Ae++&1)}return B&&(this.offset=T),ve},P.readBytes=function(T,B){var q=void 0===B;if(q&&(B=this.offset),!this.noAssert){if("number"!=typeof B||B%1!=0)throw TypeError("Illegal offset: "+B+" (not an integer)");if((B>>>=0)<0||B+T>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+B+" (+"+T+") <= "+this.buffer.byteLength)}var ee=this.slice(B,B+T);return q&&(this.offset+=T),ee},P.writeBytes=P.append,P.writeInt8=function(T,B){var q=void 0===B;if(q&&(B=this.offset),!this.noAssert){if("number"!=typeof T||T%1!=0)throw TypeError("Illegal value: "+T+" (not an integer)");if(T|=0,"number"!=typeof B||B%1!=0)throw TypeError("Illegal offset: "+B+" (not an integer)");if((B>>>=0)<0||B+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+B+" (+0) <= "+this.buffer.byteLength)}var ee=this.buffer.byteLength;return(B+=1)>ee&&this.resize((ee*=2)>B?ee:B),this.view[B-=1]=T,q&&(this.offset+=1),this},P.writeByte=P.writeInt8,P.readInt8=function(T){var B=void 0===T;if(B&&(T=this.offset),!this.noAssert){if("number"!=typeof T||T%1!=0)throw TypeError("Illegal offset: "+T+" (not an integer)");if((T>>>=0)<0||T+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+T+" (+1) <= "+this.buffer.byteLength)}var q=this.view[T];return 128&~q||(q=-(255-q+1)),B&&(this.offset+=1),q},P.readByte=P.readInt8,P.writeUint8=function(T,B){var q=void 0===B;if(q&&(B=this.offset),!this.noAssert){if("number"!=typeof T||T%1!=0)throw TypeError("Illegal value: "+T+" (not an integer)");if(T>>>=0,"number"!=typeof B||B%1!=0)throw TypeError("Illegal offset: "+B+" (not an integer)");if((B>>>=0)<0||B+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+B+" (+0) <= "+this.buffer.byteLength)}var ee=this.buffer.byteLength;return(B+=1)>ee&&this.resize((ee*=2)>B?ee:B),this.view[B-=1]=T,q&&(this.offset+=1),this},P.writeUInt8=P.writeUint8,P.readUint8=function(T){var B=void 0===T;if(B&&(T=this.offset),!this.noAssert){if("number"!=typeof T||T%1!=0)throw TypeError("Illegal offset: "+T+" (not an integer)");if((T>>>=0)<0||T+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+T+" (+1) <= "+this.buffer.byteLength)}var q=this.view[T];return B&&(this.offset+=1),q},P.readUInt8=P.readUint8,P.writeInt16=function(T,B){var q=void 0===B;if(q&&(B=this.offset),!this.noAssert){if("number"!=typeof T||T%1!=0)throw TypeError("Illegal value: "+T+" (not an integer)");if(T|=0,"number"!=typeof B||B%1!=0)throw TypeError("Illegal offset: "+B+" (not an integer)");if((B>>>=0)<0||B+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+B+" (+0) <= "+this.buffer.byteLength)}var ee=this.buffer.byteLength;return(B+=2)>ee&&this.resize((ee*=2)>B?ee:B),B-=2,this.littleEndian?(this.view[B+1]=(65280&T)>>>8,this.view[B]=255&T):(this.view[B]=(65280&T)>>>8,this.view[B+1]=255&T),q&&(this.offset+=2),this},P.writeShort=P.writeInt16,P.readInt16=function(T){var B=void 0===T;if(B&&(T=this.offset),!this.noAssert){if("number"!=typeof T||T%1!=0)throw TypeError("Illegal offset: "+T+" (not an integer)");if((T>>>=0)<0||T+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+T+" (+2) <= "+this.buffer.byteLength)}var q=0;return this.littleEndian?(q=this.view[T],q|=this.view[T+1]<<8):(q=this.view[T]<<8,q|=this.view[T+1]),32768&~q||(q=-(65535-q+1)),B&&(this.offset+=2),q},P.readShort=P.readInt16,P.writeUint16=function(T,B){var q=void 0===B;if(q&&(B=this.offset),!this.noAssert){if("number"!=typeof T||T%1!=0)throw TypeError("Illegal value: "+T+" (not an integer)");if(T>>>=0,"number"!=typeof B||B%1!=0)throw TypeError("Illegal offset: "+B+" (not an integer)");if((B>>>=0)<0||B+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+B+" (+0) <= "+this.buffer.byteLength)}var ee=this.buffer.byteLength;return(B+=2)>ee&&this.resize((ee*=2)>B?ee:B),B-=2,this.littleEndian?(this.view[B+1]=(65280&T)>>>8,this.view[B]=255&T):(this.view[B]=(65280&T)>>>8,this.view[B+1]=255&T),q&&(this.offset+=2),this},P.writeUInt16=P.writeUint16,P.readUint16=function(T){var B=void 0===T;if(B&&(T=this.offset),!this.noAssert){if("number"!=typeof T||T%1!=0)throw TypeError("Illegal offset: "+T+" (not an integer)");if((T>>>=0)<0||T+2>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+T+" (+2) <= "+this.buffer.byteLength)}var q=0;return this.littleEndian?(q=this.view[T],q|=this.view[T+1]<<8):(q=this.view[T]<<8,q|=this.view[T+1]),B&&(this.offset+=2),q},P.readUInt16=P.readUint16,P.writeInt32=function(T,B){var q=void 0===B;if(q&&(B=this.offset),!this.noAssert){if("number"!=typeof T||T%1!=0)throw TypeError("Illegal value: "+T+" (not an integer)");if(T|=0,"number"!=typeof B||B%1!=0)throw TypeError("Illegal offset: "+B+" (not an integer)");if((B>>>=0)<0||B+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+B+" (+0) <= "+this.buffer.byteLength)}var ee=this.buffer.byteLength;return(B+=4)>ee&&this.resize((ee*=2)>B?ee:B),B-=4,this.littleEndian?(this.view[B+3]=T>>>24&255,this.view[B+2]=T>>>16&255,this.view[B+1]=T>>>8&255,this.view[B]=255&T):(this.view[B]=T>>>24&255,this.view[B+1]=T>>>16&255,this.view[B+2]=T>>>8&255,this.view[B+3]=255&T),q&&(this.offset+=4),this},P.writeInt=P.writeInt32,P.readInt32=function(T){var B=void 0===T;if(B&&(T=this.offset),!this.noAssert){if("number"!=typeof T||T%1!=0)throw TypeError("Illegal offset: "+T+" (not an integer)");if((T>>>=0)<0||T+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+T+" (+4) <= "+this.buffer.byteLength)}var q=0;return this.littleEndian?(q=this.view[T+2]<<16,q|=this.view[T+1]<<8,q|=this.view[T],q+=this.view[T+3]<<24>>>0):(q=this.view[T+1]<<16,q|=this.view[T+2]<<8,q|=this.view[T+3],q+=this.view[T]<<24>>>0),q|=0,B&&(this.offset+=4),q},P.readInt=P.readInt32,P.writeUint32=function(T,B){var q=void 0===B;if(q&&(B=this.offset),!this.noAssert){if("number"!=typeof T||T%1!=0)throw TypeError("Illegal value: "+T+" (not an integer)");if(T>>>=0,"number"!=typeof B||B%1!=0)throw TypeError("Illegal offset: "+B+" (not an integer)");if((B>>>=0)<0||B+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+B+" (+0) <= "+this.buffer.byteLength)}var ee=this.buffer.byteLength;return(B+=4)>ee&&this.resize((ee*=2)>B?ee:B),B-=4,this.littleEndian?(this.view[B+3]=T>>>24&255,this.view[B+2]=T>>>16&255,this.view[B+1]=T>>>8&255,this.view[B]=255&T):(this.view[B]=T>>>24&255,this.view[B+1]=T>>>16&255,this.view[B+2]=T>>>8&255,this.view[B+3]=255&T),q&&(this.offset+=4),this},P.writeUInt32=P.writeUint32,P.readUint32=function(T){var B=void 0===T;if(B&&(T=this.offset),!this.noAssert){if("number"!=typeof T||T%1!=0)throw TypeError("Illegal offset: "+T+" (not an integer)");if((T>>>=0)<0||T+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+T+" (+4) <= "+this.buffer.byteLength)}var q=0;return this.littleEndian?(q=this.view[T+2]<<16,q|=this.view[T+1]<<8,q|=this.view[T],q+=this.view[T+3]<<24>>>0):(q=this.view[T+1]<<16,q|=this.view[T+2]<<8,q|=this.view[T+3],q+=this.view[T]<<24>>>0),B&&(this.offset+=4),q},P.readUInt32=P.readUint32,G&&(P.writeInt64=function(T,B){var q=void 0===B;if(q&&(B=this.offset),!this.noAssert){if("number"==typeof T)T=G.fromNumber(T);else if("string"==typeof T)T=G.fromString(T);else if(!(T&&T instanceof G))throw TypeError("Illegal value: "+T+" (not an integer or Long)");if("number"!=typeof B||B%1!=0)throw TypeError("Illegal offset: "+B+" (not an integer)");if((B>>>=0)<0||B+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+B+" (+0) <= "+this.buffer.byteLength)}"number"==typeof T?T=G.fromNumber(T):"string"==typeof T&&(T=G.fromString(T));var ee=this.buffer.byteLength;(B+=8)>ee&&this.resize((ee*=2)>B?ee:B),B-=8;var F=T.low,Be=T.high;return this.littleEndian?(this.view[B+3]=F>>>24&255,this.view[B+2]=F>>>16&255,this.view[B+1]=F>>>8&255,this.view[B]=255&F,this.view[(B+=4)+3]=Be>>>24&255,this.view[B+2]=Be>>>16&255,this.view[B+1]=Be>>>8&255,this.view[B]=255&Be):(this.view[B]=Be>>>24&255,this.view[B+1]=Be>>>16&255,this.view[B+2]=Be>>>8&255,this.view[B+3]=255&Be,this.view[B+=4]=F>>>24&255,this.view[B+1]=F>>>16&255,this.view[B+2]=F>>>8&255,this.view[B+3]=255&F),q&&(this.offset+=8),this},P.writeLong=P.writeInt64,P.readInt64=function(T){var B=void 0===T;if(B&&(T=this.offset),!this.noAssert){if("number"!=typeof T||T%1!=0)throw TypeError("Illegal offset: "+T+" (not an integer)");if((T>>>=0)<0||T+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+T+" (+8) <= "+this.buffer.byteLength)}var q=0,ee=0;this.littleEndian?(q=this.view[T+2]<<16,q|=this.view[T+1]<<8,q|=this.view[T],q+=this.view[T+3]<<24>>>0,ee=this.view[(T+=4)+2]<<16,ee|=this.view[T+1]<<8,ee|=this.view[T],ee+=this.view[T+3]<<24>>>0):(ee=this.view[T+1]<<16,ee|=this.view[T+2]<<8,ee|=this.view[T+3],ee+=this.view[T]<<24>>>0,q=this.view[(T+=4)+1]<<16,q|=this.view[T+2]<<8,q|=this.view[T+3],q+=this.view[T]<<24>>>0);var F=new G(q,ee,!1);return B&&(this.offset+=8),F},P.readLong=P.readInt64,P.writeUint64=function(T,B){var q=void 0===B;if(q&&(B=this.offset),!this.noAssert){if("number"==typeof T)T=G.fromNumber(T);else if("string"==typeof T)T=G.fromString(T);else if(!(T&&T instanceof G))throw TypeError("Illegal value: "+T+" (not an integer or Long)");if("number"!=typeof B||B%1!=0)throw TypeError("Illegal offset: "+B+" (not an integer)");if((B>>>=0)<0||B+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+B+" (+0) <= "+this.buffer.byteLength)}"number"==typeof T?T=G.fromNumber(T):"string"==typeof T&&(T=G.fromString(T));var ee=this.buffer.byteLength;(B+=8)>ee&&this.resize((ee*=2)>B?ee:B),B-=8;var F=T.low,Be=T.high;return this.littleEndian?(this.view[B+3]=F>>>24&255,this.view[B+2]=F>>>16&255,this.view[B+1]=F>>>8&255,this.view[B]=255&F,this.view[(B+=4)+3]=Be>>>24&255,this.view[B+2]=Be>>>16&255,this.view[B+1]=Be>>>8&255,this.view[B]=255&Be):(this.view[B]=Be>>>24&255,this.view[B+1]=Be>>>16&255,this.view[B+2]=Be>>>8&255,this.view[B+3]=255&Be,this.view[B+=4]=F>>>24&255,this.view[B+1]=F>>>16&255,this.view[B+2]=F>>>8&255,this.view[B+3]=255&F),q&&(this.offset+=8),this},P.writeUInt64=P.writeUint64,P.readUint64=function(T){var B=void 0===T;if(B&&(T=this.offset),!this.noAssert){if("number"!=typeof T||T%1!=0)throw TypeError("Illegal offset: "+T+" (not an integer)");if((T>>>=0)<0||T+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+T+" (+8) <= "+this.buffer.byteLength)}var q=0,ee=0;this.littleEndian?(q=this.view[T+2]<<16,q|=this.view[T+1]<<8,q|=this.view[T],q+=this.view[T+3]<<24>>>0,ee=this.view[(T+=4)+2]<<16,ee|=this.view[T+1]<<8,ee|=this.view[T],ee+=this.view[T+3]<<24>>>0):(ee=this.view[T+1]<<16,ee|=this.view[T+2]<<8,ee|=this.view[T+3],ee+=this.view[T]<<24>>>0,q=this.view[(T+=4)+1]<<16,q|=this.view[T+2]<<8,q|=this.view[T+3],q+=this.view[T]<<24>>>0);var F=new G(q,ee,!0);return B&&(this.offset+=8),F},P.readUInt64=P.readUint64),P.writeFloat32=function(T,B){var q=void 0===B;if(q&&(B=this.offset),!this.noAssert){if("number"!=typeof T)throw TypeError("Illegal value: "+T+" (not a number)");if("number"!=typeof B||B%1!=0)throw TypeError("Illegal offset: "+B+" (not an integer)");if((B>>>=0)<0||B+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+B+" (+0) <= "+this.buffer.byteLength)}var ee=this.buffer.byteLength;return(B+=4)>ee&&this.resize((ee*=2)>B?ee:B),_e(this.view,T,B-=4,this.littleEndian,23,4),q&&(this.offset+=4),this},P.writeFloat=P.writeFloat32,P.readFloat32=function(T){var B=void 0===T;if(B&&(T=this.offset),!this.noAssert){if("number"!=typeof T||T%1!=0)throw TypeError("Illegal offset: "+T+" (not an integer)");if((T>>>=0)<0||T+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+T+" (+4) <= "+this.buffer.byteLength)}var q=fe(this.view,T,this.littleEndian,23,4);return B&&(this.offset+=4),q},P.readFloat=P.readFloat32,P.writeFloat64=function(T,B){var q=void 0===B;if(q&&(B=this.offset),!this.noAssert){if("number"!=typeof T)throw TypeError("Illegal value: "+T+" (not a number)");if("number"!=typeof B||B%1!=0)throw TypeError("Illegal offset: "+B+" (not an integer)");if((B>>>=0)<0||B+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+B+" (+0) <= "+this.buffer.byteLength)}var ee=this.buffer.byteLength;return(B+=8)>ee&&this.resize((ee*=2)>B?ee:B),_e(this.view,T,B-=8,this.littleEndian,52,8),q&&(this.offset+=8),this},P.writeDouble=P.writeFloat64,P.readFloat64=function(T){var B=void 0===T;if(B&&(T=this.offset),!this.noAssert){if("number"!=typeof T||T%1!=0)throw TypeError("Illegal offset: "+T+" (not an integer)");if((T>>>=0)<0||T+8>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+T+" (+8) <= "+this.buffer.byteLength)}var q=fe(this.view,T,this.littleEndian,52,8);return B&&(this.offset+=8),q},P.readDouble=P.readFloat64,A.MAX_VARINT32_BYTES=5,A.calculateVarint32=function(T){return(T>>>=0)<128?1:T<16384?2:T<2097152?3:T<268435456?4:5},A.zigZagEncode32=function(T){return((T|=0)<<1^T>>31)>>>0},A.zigZagDecode32=function(T){return T>>>1^-(1&T)},P.writeVarint32=function(T,B){var q=void 0===B;if(q&&(B=this.offset),!this.noAssert){if("number"!=typeof T||T%1!=0)throw TypeError("Illegal value: "+T+" (not an integer)");if(T|=0,"number"!=typeof B||B%1!=0)throw TypeError("Illegal offset: "+B+" (not an integer)");if((B>>>=0)<0||B+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+B+" (+0) <= "+this.buffer.byteLength)}var F=A.calculateVarint32(T),Be=this.buffer.byteLength;for((B+=F)>Be&&this.resize((Be*=2)>B?Be:B),B-=F,T>>>=0;T>=128;)this.view[B++]=127&T|128,T>>>=7;return this.view[B++]=T,q?(this.offset=B,this):F},P.writeVarint32ZigZag=function(T,B){return this.writeVarint32(A.zigZagEncode32(T),B)},P.readVarint32=function(T){var B=void 0===T;if(B&&(T=this.offset),!this.noAssert){if("number"!=typeof T||T%1!=0)throw TypeError("Illegal offset: "+T+" (not an integer)");if((T>>>=0)<0||T+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+T+" (+1) <= "+this.buffer.byteLength)}var q,ee=0,F=0;do{if(!this.noAssert&&T>this.limit){var Be=Error("Truncated");throw Be.truncated=!0,Be}q=this.view[T++],ee<5&&(F|=(127&q)<<7*ee),++ee}while(128&q);return F|=0,B?(this.offset=T,F):{value:F,length:ee}},P.readVarint32ZigZag=function(T){var B=this.readVarint32(T);return"object"==typeof B?B.value=A.zigZagDecode32(B.value):B=A.zigZagDecode32(B),B},G&&(A.MAX_VARINT64_BYTES=10,A.calculateVarint64=function(T){"number"==typeof T?T=G.fromNumber(T):"string"==typeof T&&(T=G.fromString(T));var B=T.toInt()>>>0,q=T.shiftRightUnsigned(28).toInt()>>>0,ee=T.shiftRightUnsigned(56).toInt()>>>0;return 0==ee?0==q?B<16384?B<128?1:2:B<2097152?3:4:q<16384?q<128?5:6:q<2097152?7:8:ee<128?9:10},A.zigZagEncode64=function(T){return"number"==typeof T?T=G.fromNumber(T,!1):"string"==typeof T?T=G.fromString(T,!1):!1!==T.unsigned&&(T=T.toSigned()),T.shiftLeft(1).xor(T.shiftRight(63)).toUnsigned()},A.zigZagDecode64=function(T){return"number"==typeof T?T=G.fromNumber(T,!1):"string"==typeof T?T=G.fromString(T,!1):!1!==T.unsigned&&(T=T.toSigned()),T.shiftRightUnsigned(1).xor(T.and(G.ONE).toSigned().negate()).toSigned()},P.writeVarint64=function(T,B){var q=void 0===B;if(q&&(B=this.offset),!this.noAssert){if("number"==typeof T)T=G.fromNumber(T);else if("string"==typeof T)T=G.fromString(T);else if(!(T&&T instanceof G))throw TypeError("Illegal value: "+T+" (not an integer or Long)");if("number"!=typeof B||B%1!=0)throw TypeError("Illegal offset: "+B+" (not an integer)");if((B>>>=0)<0||B+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+B+" (+0) <= "+this.buffer.byteLength)}"number"==typeof T?T=G.fromNumber(T,!1):"string"==typeof T?T=G.fromString(T,!1):!1!==T.unsigned&&(T=T.toSigned());var ee=A.calculateVarint64(T),F=T.toInt()>>>0,Be=T.shiftRightUnsigned(28).toInt()>>>0,K=T.shiftRightUnsigned(56).toInt()>>>0,ve=this.buffer.byteLength;switch((B+=ee)>ve&&this.resize((ve*=2)>B?ve:B),B-=ee,ee){case 10:this.view[B+9]=K>>>7&1;case 9:this.view[B+8]=9!==ee?128|K:127&K;case 8:this.view[B+7]=8!==ee?Be>>>21|128:Be>>>21&127;case 7:this.view[B+6]=7!==ee?Be>>>14|128:Be>>>14&127;case 6:this.view[B+5]=6!==ee?Be>>>7|128:Be>>>7&127;case 5:this.view[B+4]=5!==ee?128|Be:127&Be;case 4:this.view[B+3]=4!==ee?F>>>21|128:F>>>21&127;case 3:this.view[B+2]=3!==ee?F>>>14|128:F>>>14&127;case 2:this.view[B+1]=2!==ee?F>>>7|128:F>>>7&127;case 1:this.view[B]=1!==ee?128|F:127&F}return q?(this.offset+=ee,this):ee},P.writeVarint64ZigZag=function(T,B){return this.writeVarint64(A.zigZagEncode64(T),B)},P.readVarint64=function(T){var B=void 0===T;if(B&&(T=this.offset),!this.noAssert){if("number"!=typeof T||T%1!=0)throw TypeError("Illegal offset: "+T+" (not an integer)");if((T>>>=0)<0||T+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+T+" (+1) <= "+this.buffer.byteLength)}var q=T,ee=0,F=0,Be=0,K=0;if(ee=127&(K=this.view[T++]),128&K&&(ee|=(127&(K=this.view[T++]))<<7,(128&K||this.noAssert&&void 0===K)&&(ee|=(127&(K=this.view[T++]))<<14,(128&K||this.noAssert&&void 0===K)&&(ee|=(127&(K=this.view[T++]))<<21,(128&K||this.noAssert&&void 0===K)&&(F=127&(K=this.view[T++]),(128&K||this.noAssert&&void 0===K)&&(F|=(127&(K=this.view[T++]))<<7,(128&K||this.noAssert&&void 0===K)&&(F|=(127&(K=this.view[T++]))<<14,(128&K||this.noAssert&&void 0===K)&&(F|=(127&(K=this.view[T++]))<<21,(128&K||this.noAssert&&void 0===K)&&(Be=127&(K=this.view[T++]),(128&K||this.noAssert&&void 0===K)&&(Be|=(127&(K=this.view[T++]))<<7,128&K||this.noAssert&&void 0===K))))))))))throw Error("Buffer overrun");var ve=G.fromBits(ee|F<<28,F>>>4|Be<<24,!1);return B?(this.offset=T,ve):{value:ve,length:T-q}},P.readVarint64ZigZag=function(T){var B=this.readVarint64(T);return B&&B.value instanceof G?B.value=A.zigZagDecode64(B.value):B=A.zigZagDecode64(B),B}),P.writeCString=function(T,B){var q=void 0===B;q&&(B=this.offset);var ee,F=T.length;if(!this.noAssert){if("string"!=typeof T)throw TypeError("Illegal str: Not a string");for(ee=0;ee<F;++ee)if(0===T.charCodeAt(ee))throw RangeError("Illegal str: Contains NULL-characters");if("number"!=typeof B||B%1!=0)throw TypeError("Illegal offset: "+B+" (not an integer)");if((B>>>=0)<0||B+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+B+" (+0) <= "+this.buffer.byteLength)}F=pe.calculateUTF16asUTF8(te(T))[1];var Be=this.buffer.byteLength;return(B+=F+1)>Be&&this.resize((Be*=2)>B?Be:B),B-=F+1,pe.encodeUTF16toUTF8(te(T),function(K){this.view[B++]=K}.bind(this)),this.view[B++]=0,q?(this.offset=B,this):F},P.readCString=function(T){var B=void 0===T;if(B&&(T=this.offset),!this.noAssert){if("number"!=typeof T||T%1!=0)throw TypeError("Illegal offset: "+T+" (not an integer)");if((T>>>=0)<0||T+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+T+" (+1) <= "+this.buffer.byteLength)}var q,ee=T,F=-1;return pe.decodeUTF8toUTF16(function(){if(0===F)return null;if(T>=this.limit)throw RangeError("Illegal range: Truncated data, "+T+" < "+this.limit);return 0===(F=this.view[T++])?null:F}.bind(this),q=ce(),!0),B?(this.offset=T,q()):{string:q(),length:T-ee}},P.writeIString=function(T,B){var q=void 0===B;if(q&&(B=this.offset),!this.noAssert){if("string"!=typeof T)throw TypeError("Illegal str: Not a string");if("number"!=typeof B||B%1!=0)throw TypeError("Illegal offset: "+B+" (not an integer)");if((B>>>=0)<0||B+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+B+" (+0) <= "+this.buffer.byteLength)}var ee,F=B;ee=pe.calculateUTF16asUTF8(te(T),this.noAssert)[1];var Be=this.buffer.byteLength;if((B+=4+ee)>Be&&this.resize((Be*=2)>B?Be:B),B-=4+ee,this.littleEndian?(this.view[B+3]=ee>>>24&255,this.view[B+2]=ee>>>16&255,this.view[B+1]=ee>>>8&255,this.view[B]=255&ee):(this.view[B]=ee>>>24&255,this.view[B+1]=ee>>>16&255,this.view[B+2]=ee>>>8&255,this.view[B+3]=255&ee),B+=4,pe.encodeUTF16toUTF8(te(T),function(K){this.view[B++]=K}.bind(this)),B!==F+4+ee)throw RangeError("Illegal range: Truncated data, "+B+" == "+(B+4+ee));return q?(this.offset=B,this):B-F},P.readIString=function(T){var B=void 0===T;if(B&&(T=this.offset),!this.noAssert){if("number"!=typeof T||T%1!=0)throw TypeError("Illegal offset: "+T+" (not an integer)");if((T>>>=0)<0||T+4>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+T+" (+4) <= "+this.buffer.byteLength)}var q=T,ee=this.readUint32(T),F=this.readUTF8String(ee,A.METRICS_BYTES,T+=4);return T+=F.length,B?(this.offset=T,F.string):{string:F.string,length:T-q}},A.METRICS_CHARS="c",A.METRICS_BYTES="b",P.writeUTF8String=function(T,B){var q,ee=void 0===B;if(ee&&(B=this.offset),!this.noAssert){if("number"!=typeof B||B%1!=0)throw TypeError("Illegal offset: "+B+" (not an integer)");if((B>>>=0)<0||B+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+B+" (+0) <= "+this.buffer.byteLength)}var F=B;q=pe.calculateUTF16asUTF8(te(T))[1];var Be=this.buffer.byteLength;return(B+=q)>Be&&this.resize((Be*=2)>B?Be:B),B-=q,pe.encodeUTF16toUTF8(te(T),function(K){this.view[B++]=K}.bind(this)),ee?(this.offset=B,this):B-F},P.writeString=P.writeUTF8String,A.calculateUTF8Chars=function(T){return pe.calculateUTF16asUTF8(te(T))[0]},A.calculateUTF8Bytes=function(T){return pe.calculateUTF16asUTF8(te(T))[1]},A.calculateString=A.calculateUTF8Bytes,P.readUTF8String=function(T,B,q){"number"==typeof B&&(q=B,B=void 0);var ee=void 0===q;if(ee&&(q=this.offset),void 0===B&&(B=A.METRICS_CHARS),!this.noAssert){if("number"!=typeof T||T%1!=0)throw TypeError("Illegal length: "+T+" (not an integer)");if(T|=0,"number"!=typeof q||q%1!=0)throw TypeError("Illegal offset: "+q+" (not an integer)");if((q>>>=0)<0||q+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+q+" (+0) <= "+this.buffer.byteLength)}var F,Be=0,K=q;if(B===A.METRICS_CHARS){if(F=ce(),pe.decodeUTF8(function(){return Be<T&&q<this.limit?this.view[q++]:null}.bind(this),function(Ae){++Be,pe.UTF8toUTF16(Ae,F)}),Be!==T)throw RangeError("Illegal range: Truncated data, "+Be+" == "+T);return ee?(this.offset=q,F()):{string:F(),length:q-K}}if(B===A.METRICS_BYTES){if(!this.noAssert){if("number"!=typeof q||q%1!=0)throw TypeError("Illegal offset: "+q+" (not an integer)");if((q>>>=0)<0||q+T>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+q+" (+"+T+") <= "+this.buffer.byteLength)}var ve=q+T;if(pe.decodeUTF8toUTF16(function(){return q<ve?this.view[q++]:null}.bind(this),F=ce(),this.noAssert),q!==ve)throw RangeError("Illegal range: Truncated data, "+q+" == "+ve);return ee?(this.offset=q,F()):{string:F(),length:q-K}}throw TypeError("Unsupported metrics: "+B)},P.readString=P.readUTF8String,P.writeVString=function(T,B){var q=void 0===B;if(q&&(B=this.offset),!this.noAssert){if("string"!=typeof T)throw TypeError("Illegal str: Not a string");if("number"!=typeof B||B%1!=0)throw TypeError("Illegal offset: "+B+" (not an integer)");if((B>>>=0)<0||B+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+B+" (+0) <= "+this.buffer.byteLength)}var ee,F,Be=B;ee=pe.calculateUTF16asUTF8(te(T),this.noAssert)[1],F=A.calculateVarint32(ee);var K=this.buffer.byteLength;if((B+=F+ee)>K&&this.resize((K*=2)>B?K:B),B-=F+ee,B+=this.writeVarint32(ee,B),pe.encodeUTF16toUTF8(te(T),function(ve){this.view[B++]=ve}.bind(this)),B!==Be+ee+F)throw RangeError("Illegal range: Truncated data, "+B+" == "+(B+ee+F));return q?(this.offset=B,this):B-Be},P.readVString=function(T){var B=void 0===T;if(B&&(T=this.offset),!this.noAssert){if("number"!=typeof T||T%1!=0)throw TypeError("Illegal offset: "+T+" (not an integer)");if((T>>>=0)<0||T+1>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+T+" (+1) <= "+this.buffer.byteLength)}var q=T,ee=this.readVarint32(T),F=this.readUTF8String(ee.value,A.METRICS_BYTES,T+=ee.length);return T+=F.length,B?(this.offset=T,F.string):{string:F.string,length:T-q}},P.append=function(T,B,q){"number"!=typeof B&&"string"==typeof B||(q=B,B=void 0);var ee=void 0===q;if(ee&&(q=this.offset),!this.noAssert){if("number"!=typeof q||q%1!=0)throw TypeError("Illegal offset: "+q+" (not an integer)");if((q>>>=0)<0||q+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+q+" (+0) <= "+this.buffer.byteLength)}T instanceof A||(T=A.wrap(T,B));var F=T.limit-T.offset;if(F<=0)return this;var Be=this.buffer.byteLength;return(q+=F)>Be&&this.resize((Be*=2)>q?Be:q),q-=F,this.view.set(T.view.subarray(T.offset,T.limit),q),T.offset+=F,ee&&(this.offset+=F),this},P.appendTo=function(T,B){return T.append(this,B),this},P.assert=function(T){return this.noAssert=!T,this},P.capacity=function(){return this.buffer.byteLength},P.clear=function(){return this.offset=0,this.limit=this.buffer.byteLength,this.markedOffset=-1,this},P.clone=function(T){var B=new A(0,this.littleEndian,this.noAssert);return T?(B.buffer=new ArrayBuffer(this.buffer.byteLength),B.view=new Uint8Array(B.buffer)):(B.buffer=this.buffer,B.view=this.view),B.offset=this.offset,B.markedOffset=this.markedOffset,B.limit=this.limit,B},P.compact=function(T,B){if(void 0===T&&(T=this.offset),void 0===B&&(B=this.limit),!this.noAssert){if("number"!=typeof T||T%1!=0)throw TypeError("Illegal begin: Not an integer");if(T>>>=0,"number"!=typeof B||B%1!=0)throw TypeError("Illegal end: Not an integer");if(B>>>=0,T<0||T>B||B>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+T+" <= "+B+" <= "+this.buffer.byteLength)}if(0===T&&B===this.buffer.byteLength)return this;var q=B-T;if(0===q)return this.buffer=de,this.view=null,this.markedOffset>=0&&(this.markedOffset-=T),this.offset=0,this.limit=0,this;var ee=new ArrayBuffer(q),F=new Uint8Array(ee);return F.set(this.view.subarray(T,B)),this.buffer=ee,this.view=F,this.markedOffset>=0&&(this.markedOffset-=T),this.offset=0,this.limit=q,this},P.copy=function(T,B){if(void 0===T&&(T=this.offset),void 0===B&&(B=this.limit),!this.noAssert){if("number"!=typeof T||T%1!=0)throw TypeError("Illegal begin: Not an integer");if(T>>>=0,"number"!=typeof B||B%1!=0)throw TypeError("Illegal end: Not an integer");if(B>>>=0,T<0||T>B||B>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+T+" <= "+B+" <= "+this.buffer.byteLength)}if(T===B)return new A(0,this.littleEndian,this.noAssert);var q=B-T,ee=new A(q,this.littleEndian,this.noAssert);return ee.offset=0,ee.limit=q,ee.markedOffset>=0&&(ee.markedOffset-=T),this.copyTo(ee,0,T,B),ee},P.copyTo=function(T,B,q,ee){var F,Be;if(!this.noAssert&&!A.isByteBuffer(T))throw TypeError("Illegal target: Not a ByteBuffer");if(B=(Be=void 0===B)?T.offset:0|B,q=(F=void 0===q)?this.offset:0|q,ee=void 0===ee?this.limit:0|ee,B<0||B>T.buffer.byteLength)throw RangeError("Illegal target range: 0 <= "+B+" <= "+T.buffer.byteLength);if(q<0||ee>this.buffer.byteLength)throw RangeError("Illegal source range: 0 <= "+q+" <= "+this.buffer.byteLength);var K=ee-q;return 0===K?T:(T.ensureCapacity(B+K),T.view.set(this.view.subarray(q,ee),B),F&&(this.offset+=K),Be&&(T.offset+=K),this)},P.ensureCapacity=function(T){var B=this.buffer.byteLength;return B<T?this.resize((B*=2)>T?B:T):this},P.fill=function(T,B,q){var ee=void 0===B;if(ee&&(B=this.offset),"string"==typeof T&&T.length>0&&(T=T.charCodeAt(0)),void 0===B&&(B=this.offset),void 0===q&&(q=this.limit),!this.noAssert){if("number"!=typeof T||T%1!=0)throw TypeError("Illegal value: "+T+" (not an integer)");if(T|=0,"number"!=typeof B||B%1!=0)throw TypeError("Illegal begin: Not an integer");if(B>>>=0,"number"!=typeof q||q%1!=0)throw TypeError("Illegal end: Not an integer");if(q>>>=0,B<0||B>q||q>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+B+" <= "+q+" <= "+this.buffer.byteLength)}if(B>=q)return this;for(;B<q;)this.view[B++]=T;return ee&&(this.offset=B),this},P.flip=function(){return this.limit=this.offset,this.offset=0,this},P.mark=function(T){if(T=void 0===T?this.offset:T,!this.noAssert){if("number"!=typeof T||T%1!=0)throw TypeError("Illegal offset: "+T+" (not an integer)");if((T>>>=0)<0||T+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+T+" (+0) <= "+this.buffer.byteLength)}return this.markedOffset=T,this},P.order=function(T){if(!this.noAssert&&"boolean"!=typeof T)throw TypeError("Illegal littleEndian: Not a boolean");return this.littleEndian=!!T,this},P.LE=function(T){return this.littleEndian=void 0===T||!!T,this},P.BE=function(T){return this.littleEndian=void 0!==T&&!T,this},P.prepend=function(T,B,q){"number"!=typeof B&&"string"==typeof B||(q=B,B=void 0);var ee=void 0===q;if(ee&&(q=this.offset),!this.noAssert){if("number"!=typeof q||q%1!=0)throw TypeError("Illegal offset: "+q+" (not an integer)");if((q>>>=0)<0||q+0>this.buffer.byteLength)throw RangeError("Illegal offset: 0 <= "+q+" (+0) <= "+this.buffer.byteLength)}T instanceof A||(T=A.wrap(T,B));var F=T.limit-T.offset;if(F<=0)return this;var Be=F-q;if(Be>0){var K=new ArrayBuffer(this.buffer.byteLength+Be),ve=new Uint8Array(K);ve.set(this.view.subarray(q,this.buffer.byteLength),F),this.buffer=K,this.view=ve,this.offset+=Be,this.markedOffset>=0&&(this.markedOffset+=Be),this.limit+=Be,q+=Be}else new Uint8Array(this.buffer);return this.view.set(T.view.subarray(T.offset,T.limit),q-F),T.offset=T.limit,ee&&(this.offset-=F),this},P.prependTo=function(T,B){return T.prepend(this,B),this},P.printDebug=function(T){"function"!=typeof T&&(T=console.log.bind(console)),T(this.toString()+"\n-------------------------------------------------------------------\n"+this.toDebug(!0))},P.remaining=function(){return this.limit-this.offset},P.reset=function(){return this.markedOffset>=0?(this.offset=this.markedOffset,this.markedOffset=-1):this.offset=0,this},P.resize=function(T){if(!this.noAssert){if("number"!=typeof T||T%1!=0)throw TypeError("Illegal capacity: "+T+" (not an integer)");if((T|=0)<0)throw RangeError("Illegal capacity: 0 <= "+T)}if(this.buffer.byteLength<T){var B=new ArrayBuffer(T),q=new Uint8Array(B);q.set(this.view),this.buffer=B,this.view=q}return this},P.reverse=function(T,B){if(void 0===T&&(T=this.offset),void 0===B&&(B=this.limit),!this.noAssert){if("number"!=typeof T||T%1!=0)throw TypeError("Illegal begin: Not an integer");if(T>>>=0,"number"!=typeof B||B%1!=0)throw TypeError("Illegal end: Not an integer");if(B>>>=0,T<0||T>B||B>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+T+" <= "+B+" <= "+this.buffer.byteLength)}return T===B||Array.prototype.reverse.call(this.view.subarray(T,B)),this},P.skip=function(T){if(!this.noAssert){if("number"!=typeof T||T%1!=0)throw TypeError("Illegal length: "+T+" (not an integer)");T|=0}var B=this.offset+T;if(!this.noAssert&&(B<0||B>this.buffer.byteLength))throw RangeError("Illegal length: 0 <= "+this.offset+" + "+T+" <= "+this.buffer.byteLength);return this.offset=B,this},P.slice=function(T,B){if(void 0===T&&(T=this.offset),void 0===B&&(B=this.limit),!this.noAssert){if("number"!=typeof T||T%1!=0)throw TypeError("Illegal begin: Not an integer");if(T>>>=0,"number"!=typeof B||B%1!=0)throw TypeError("Illegal end: Not an integer");if(B>>>=0,T<0||T>B||B>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+T+" <= "+B+" <= "+this.buffer.byteLength)}var q=this.clone();return q.offset=T,q.limit=B,q},P.toBuffer=function(T){var B=this.offset,q=this.limit;if(!this.noAssert){if("number"!=typeof B||B%1!=0)throw TypeError("Illegal offset: Not an integer");if(B>>>=0,"number"!=typeof q||q%1!=0)throw TypeError("Illegal limit: Not an integer");if(q>>>=0,B<0||B>q||q>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+B+" <= "+q+" <= "+this.buffer.byteLength)}if(!T&&0===B&&q===this.buffer.byteLength)return this.buffer;if(B===q)return de;var ee=new ArrayBuffer(q-B);return new Uint8Array(ee).set(new Uint8Array(this.buffer).subarray(B,q),0),ee},P.toArrayBuffer=P.toBuffer,P.toString=function(T,B,q){if(void 0===T)return"ByteBufferAB(offset="+this.offset+",markedOffset="+this.markedOffset+",limit="+this.limit+",capacity="+this.capacity()+")";switch("number"==typeof T&&(q=B=T="utf8"),T){case"utf8":return this.toUTF8(B,q);case"base64":return this.toBase64(B,q);case"hex":return this.toHex(B,q);case"binary":return this.toBinary(B,q);case"debug":return this.toDebug();case"columns":return this.toColumns();default:throw Error("Unsupported encoding: "+T)}};var le=function(){for(var T={},B=[65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,48,49,50,51,52,53,54,55,56,57,43,47],q=[],ee=0,F=B.length;ee<F;++ee)q[B[ee]]=ee;return T.encode=function(Be,K){for(var ve,Ae;null!==(ve=Be());)K(B[ve>>2&63]),Ae=(3&ve)<<4,null!==(ve=Be())?(K(B[63&((Ae|=ve>>4&15)|ve>>4&15)]),Ae=(15&ve)<<2,null!==(ve=Be())?(K(B[63&(Ae|ve>>6&3)]),K(B[63&ve])):(K(B[63&Ae]),K(61))):(K(B[63&Ae]),K(61),K(61))},T.decode=function(Be,K){var ve,Ae,Fe;function Ee(qe){throw Error("Illegal character code: "+qe)}for(;null!==(ve=Be());)if(void 0===(Ae=q[ve])&&Ee(ve),null!==(ve=Be())&&(void 0===(Fe=q[ve])&&Ee(ve),K(Ae<<2>>>0|(48&Fe)>>4),null!==(ve=Be()))){if(void 0===(Ae=q[ve])){if(61===ve)break;Ee(ve)}if(K((15&Fe)<<4>>>0|(60&Ae)>>2),null!==(ve=Be())){if(void 0===(Fe=q[ve])){if(61===ve)break;Ee(ve)}K((3&Ae)<<6>>>0|Fe)}}},T.test=function(Be){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(Be)},T}();P.toBase64=function(T,B){if(void 0===T&&(T=this.offset),void 0===B&&(B=this.limit),B|=0,(T|=0)<0||B>this.capacity||T>B)throw RangeError("begin, end");var q;return le.encode(function(){return T<B?this.view[T++]:null}.bind(this),q=ce()),q()},A.fromBase64=function(T,B){if("string"!=typeof T)throw TypeError("str");var q=new A(T.length/4*3,B),ee=0;return le.decode(te(T),function(F){q.view[ee++]=F}),q.limit=ee,q},A.btoa=function(T){return A.fromBinary(T).toBase64()},A.atob=function(T){return A.fromBase64(T).toBinary()},P.toBinary=function(T,B){if(void 0===T&&(T=this.offset),void 0===B&&(B=this.limit),B|=0,(T|=0)<0||B>this.capacity()||T>B)throw RangeError("begin, end");if(T===B)return"";for(var q=[],ee=[];T<B;)q.push(this.view[T++]),q.length>=1024&&(ee.push(String.fromCharCode.apply(String,q)),q=[]);return ee.join("")+String.fromCharCode.apply(String,q)},A.fromBinary=function(T,B){if("string"!=typeof T)throw TypeError("str");for(var q,ee=0,F=T.length,Be=new A(F,B);ee<F;){if((q=T.charCodeAt(ee))>255)throw RangeError("illegal char code: "+q);Be.view[ee++]=q}return Be.limit=F,Be},P.toDebug=function(T){for(var B,q=-1,ee=this.buffer.byteLength,F="",Be="",K="";q<ee;){if(-1!==q&&(F+=(B=this.view[q])<16?"0"+B.toString(16).toUpperCase():B.toString(16).toUpperCase(),T&&(Be+=B>32&&B<127?String.fromCharCode(B):".")),++q,T&&q>0&&q%16==0&&q!==ee){for(;F.length<51;)F+=" ";K+=F+Be+"\n",F=Be=""}F+=q===this.offset&&q===this.limit?q===this.markedOffset?"!":"|":q===this.offset?q===this.markedOffset?"[":"<":q===this.limit?q===this.markedOffset?"]":">":q===this.markedOffset?"'":T||0!==q&&q!==ee?" ":""}if(T&&" "!==F){for(;F.length<51;)F+=" ";K+=F+Be+"\n"}return T?K:F},A.fromDebug=function(T,B,q){for(var ee,F,Be=T.length,K=new A((Be+1)/3|0,B,q),ve=0,Ae=0,Fe=!1,Ee=!1,qe=!1,Ke=!1,gt=!1;ve<Be;){switch(ee=T.charAt(ve++)){case"!":if(!q){if(Ee||qe||Ke){gt=!0;break}Ee=qe=Ke=!0}K.offset=K.markedOffset=K.limit=Ae,Fe=!1;break;case"|":if(!q){if(Ee||Ke){gt=!0;break}Ee=Ke=!0}K.offset=K.limit=Ae,Fe=!1;break;case"[":if(!q){if(Ee||qe){gt=!0;break}Ee=qe=!0}K.offset=K.markedOffset=Ae,Fe=!1;break;case"<":if(!q){if(Ee){gt=!0;break}Ee=!0}K.offset=Ae,Fe=!1;break;case"]":if(!q){if(Ke||qe){gt=!0;break}Ke=qe=!0}K.limit=K.markedOffset=Ae,Fe=!1;break;case">":if(!q){if(Ke){gt=!0;break}Ke=!0}K.limit=Ae,Fe=!1;break;case"'":if(!q){if(qe){gt=!0;break}qe=!0}K.markedOffset=Ae,Fe=!1;break;case" ":Fe=!1;break;default:if(!q&&Fe){gt=!0;break}if(F=parseInt(ee+T.charAt(ve++),16),!q&&(isNaN(F)||F<0||F>255))throw TypeError("Illegal str: Not a debug encoded string");K.view[Ae++]=F,Fe=!0}if(gt)throw TypeError("Illegal str: Invalid symbol at "+ve)}if(!q){if(!Ee||!Ke)throw TypeError("Illegal str: Missing offset or limit");if(Ae<K.buffer.byteLength)throw TypeError("Illegal str: Not a debug encoded string (is it hex?) "+Ae+" < "+Be)}return K},P.toHex=function(T,B){if(T=void 0===T?this.offset:T,B=void 0===B?this.limit:B,!this.noAssert){if("number"!=typeof T||T%1!=0)throw TypeError("Illegal begin: Not an integer");if(T>>>=0,"number"!=typeof B||B%1!=0)throw TypeError("Illegal end: Not an integer");if(B>>>=0,T<0||T>B||B>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+T+" <= "+B+" <= "+this.buffer.byteLength)}for(var q,ee=new Array(B-T);T<B;)(q=this.view[T++])<16?ee.push("0",q.toString(16)):ee.push(q.toString(16));return ee.join("")},A.fromHex=function(T,B,q){if(!q){if("string"!=typeof T)throw TypeError("Illegal str: Not a string");if(T.length%2!=0)throw TypeError("Illegal str: Length not a multiple of 2")}for(var ee,F=T.length,Be=new A(F/2|0,B),K=0,ve=0;K<F;K+=2){if(ee=parseInt(T.substring(K,K+2),16),!q&&(!isFinite(ee)||ee<0||ee>255))throw TypeError("Illegal str: Contains non-hex characters");Be.view[ve++]=ee}return Be.limit=ve,Be};var pe=function(){var T={MAX_CODEPOINT:1114111,encodeUTF8:function(B,q){var ee=null;for("number"==typeof B&&(ee=B,B=function(){return null});null!==ee||null!==(ee=B());)ee<128?q(127&ee):ee<2048?(q(ee>>6&31|192),q(63&ee|128)):ee<65536?(q(ee>>12&15|224),q(ee>>6&63|128),q(63&ee|128)):(q(ee>>18&7|240),q(ee>>12&63|128),q(ee>>6&63|128),q(63&ee|128)),ee=null},decodeUTF8:function(B,q){for(var ee,F,Be,K,ve=function(Ae){Ae=Ae.slice(0,Ae.indexOf(null));var Fe=Error(Ae.toString());throw Fe.name="TruncatedError",Fe.bytes=Ae,Fe};null!==(ee=B());)if(128&ee)if(192==(224&ee))null===(F=B())&&ve([ee,F]),q((31&ee)<<6|63&F);else if(224==(240&ee))(null===(F=B())||null===(Be=B()))&&ve([ee,F,Be]),q((15&ee)<<12|(63&F)<<6|63&Be);else{if(240!=(248&ee))throw RangeError("Illegal starting byte: "+ee);(null===(F=B())||null===(Be=B())||null===(K=B()))&&ve([ee,F,Be,K]),q((7&ee)<<18|(63&F)<<12|(63&Be)<<6|63&K)}else q(ee)},UTF16toUTF8:function(B,q){for(var ee,F=null;null!==(ee=null!==F?F:B());)ee>=55296&&ee<=57343&&null!==(F=B())&&F>=56320&&F<=57343?(q(1024*(ee-55296)+F-56320+65536),F=null):q(ee);null!==F&&q(F)},UTF8toUTF16:function(B,q){var ee=null;for("number"==typeof B&&(ee=B,B=function(){return null});null!==ee||null!==(ee=B());)ee<=65535?q(ee):(q(55296+((ee-=65536)>>10)),q(ee%1024+56320)),ee=null},encodeUTF16toUTF8:function(B,q){T.UTF16toUTF8(B,function(ee){T.encodeUTF8(ee,q)})},decodeUTF8toUTF16:function(B,q){T.decodeUTF8(B,function(ee){T.UTF8toUTF16(ee,q)})},calculateCodePoint:function(B){return B<128?1:B<2048?2:B<65536?3:4},calculateUTF8:function(B){for(var q,ee=0;null!==(q=B());)ee+=q<128?1:q<2048?2:q<65536?3:4;return ee},calculateUTF16asUTF8:function(B){var q=0,ee=0;return T.UTF16toUTF8(B,function(F){++q,ee+=F<128?1:F<2048?2:F<65536?3:4}),[q,ee]}};return T}();return P.toUTF8=function(T,B){if(void 0===T&&(T=this.offset),void 0===B&&(B=this.limit),!this.noAssert){if("number"!=typeof T||T%1!=0)throw TypeError("Illegal begin: Not an integer");if(T>>>=0,"number"!=typeof B||B%1!=0)throw TypeError("Illegal end: Not an integer");if(B>>>=0,T<0||T>B||B>this.buffer.byteLength)throw RangeError("Illegal range: 0 <= "+T+" <= "+B+" <= "+this.buffer.byteLength)}var q;try{pe.decodeUTF8toUTF16(function(){return T<B?this.view[T++]:null}.bind(this),q=ce())}catch{if(T!==B)throw RangeError("Illegal range: Truncated data, "+T+" != "+B)}return q()},A.fromUTF8=function(T,B,q){if(!q&&"string"!=typeof T)throw TypeError("Illegal str: Not a string");var ee=new A(pe.calculateUTF16asUTF8(te(T),!0)[1],B,q),F=0;return pe.encodeUTF16toUTF8(te(T),function(Be){ee.view[F++]=Be}),ee.limit=F,ee},A},void 0===(U=x.apply(o,N))||(n.exports=U)},690:n=>{n.exports=function(o){switch(o){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},87:n=>{n.exports="function"==typeof Object.create?function(o,l){l&&(o.super_=l,o.prototype=Object.create(l.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}))}:function(o,l){if(l){o.super_=l;var x=function(){};x.prototype=l.prototype,o.prototype=new x,o.prototype.constructor=o}}},809:n=>{function o(l){return!!l.constructor&&"function"==typeof l.constructor.isBuffer&&l.constructor.isBuffer(l)}n.exports=function(l){return null!=l&&(o(l)||"function"==typeof(x=l).readFloatLE&&"function"==typeof x.slice&&o(x.slice(0,0))||!!l._isBuffer);var x}},190:(n,o,l)=>{var x=l(408),N=l(720),U=l(355),G=["x","e","a","o","n","s","r","c","u","m","v","w","z"],A=["m","w"],P=["H","I","N","E","F","K","L","T","U","V","W","X","Y","Z"];function te(pe){this.glyphs=[],this._measure=this.computeMetrics.bind(this),this.update(pe)}function ce(pe){return new Function(["return function "+pe+"() {","  return this._"+pe,"}"].join("\n"))()}function fe(pe,T){if(!pe.chars||0===pe.chars.length)return null;var B=le(pe.chars,T);return B>=0?pe.chars[B]:null}function _e(pe,T,B){if(!pe.kernings||0===pe.kernings.length)return 0;for(var q=pe.kernings,ee=0;ee<q.length;ee++){var F=q[ee];if(F.first===T&&F.second===B)return F.amount}return 0}function le(pe,T,B){for(var q=B=B||0;q<pe.length;q++)if(pe[q].id===T)return q;return-1}n.exports=function(pe){return new te(pe)},te.prototype.update=function(pe){if(pe=N({measure:this._measure},pe),this._opt=pe,this._opt.tabSize=U(this._opt.tabSize,4),!pe.font)throw new Error("must provide a valid bitmap font");var T=this.glyphs,B=pe.text||"",q=pe.font;this._setupSpaceGlyphs(q);var ee=x.lines(B,pe),F=pe.width||0;T.length=0;var Be=ee.reduce(function(Ct,wt){return Math.max(Ct,wt.width,F)},0),K=0,ve=0,Ae=U(pe.lineHeight,q.common.lineHeight),Fe=q.common.base,Ee=Ae-Fe,qe=pe.letterSpacing||0,Ke=Ae*ee.length-Ee,gt=function(Ct){return"center"===Ct?1:"right"===Ct?2:0}(this._opt.align);ve-=Ke,this._width=Be,this._height=Ke,this._descender=Ae-Fe,this._baseline=Fe,this._xHeight=function(Ct){for(var wt=0;wt<G.length;wt++){var Ft=G[wt].charCodeAt(0),Ot=le(Ct.chars,Ft);if(Ot>=0)return Ct.chars[Ot].height}return 0}(q),this._capHeight=function(Ct){for(var wt=0;wt<P.length;wt++){var Ft=P[wt].charCodeAt(0),Ot=le(Ct.chars,Ft);if(Ot>=0)return Ct.chars[Ot].height}return 0}(q),this._lineHeight=Ae,this._ascender=Ae-Ee-this._xHeight;var at=this;ee.forEach(function(Ct,wt){for(var Ft,rn=Ct.end,ft=Ct.width,Tn=Ct.start;Tn<rn;Tn++){var Cn=B.charCodeAt(Tn),mn=at.getGlyph(q,Cn);if(mn){Ft&&(K+=_e(q,Ft.id,mn.id));var Pn=K;1===gt?Pn+=(Be-ft)/2:2===gt&&(Pn+=Be-ft),T.push({position:[Pn,ve],data:mn,index:Tn,line:wt}),K+=mn.xadvance+qe,Ft=mn}}ve+=Ae,K=0}),this._linesTotal=ee.length},te.prototype._setupSpaceGlyphs=function(pe){if(this._fallbackSpaceGlyph=null,this._fallbackTabGlyph=null,pe.chars&&0!==pe.chars.length){var T=fe(pe,32)||function(q){for(var ee=0;ee<A.length;ee++){var F=A[ee].charCodeAt(0),Be=le(q.chars,F);if(Be>=0)return q.chars[Be]}return 0}(pe)||pe.chars[0],B=this._opt.tabSize*T.xadvance;this._fallbackSpaceGlyph=T,this._fallbackTabGlyph=N(T,{x:0,y:0,xadvance:B,id:9,xoffset:0,yoffset:0,width:0,height:0})}},te.prototype.getGlyph=function(pe,T){return fe(pe,T)||(9===T?this._fallbackTabGlyph:32===T?this._fallbackSpaceGlyph:null)},te.prototype.computeMetrics=function(pe,T,B,q){var ee,F=this._opt.letterSpacing||0,Be=this._opt.font,K=0,ve=0,Ae=0;if(!Be.chars||0===Be.chars.length)return{start:T,end:T,width:0};B=Math.min(pe.length,B);for(var Fe=T;Fe<B;Fe++){var Ee,qe=pe.charCodeAt(Fe);if(Ee=this.getGlyph(Be,qe)){var Ke=(K+=ee?_e(Be,ee.id,Ee.id):0)+Ee.xadvance+F,gt=K+Ee.width;if(gt>=q||Ke>=q)break;K=Ke,ve=gt,ee=Ee}Ae++}return ee&&(ve+=ee.xoffset),{start:T,end:T+Ae,width:ve}},["width","height","descender","ascender","xHeight","baseline","capHeight","lineHeight"].forEach(function(pe){Object.defineProperty(te.prototype,pe,{get:ce(pe),configurable:!0})})},734:function(n,o){var l,x;void 0===(x="function"==typeof(l=function(){"use strict";function N(Ee,qe,Ke){this.low=0|Ee,this.high=0|qe,this.unsigned=!!Ke}function U(Ee){return!0===(Ee&&Ee.__isLong__)}Object.defineProperty(N.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1}),N.isLong=U;var G={},A={};function P(Ee,qe){var Ke,gt,at;return qe?(at=0<=(Ee>>>=0)&&Ee<256)&&(gt=A[Ee])?gt:(Ke=be(Ee,(0|Ee)<0?-1:0,!0),at&&(A[Ee]=Ke),Ke):(at=-128<=(Ee|=0)&&Ee<128)&&(gt=G[Ee])?gt:(Ke=be(Ee,Ee<0?-1:0,!1),at&&(G[Ee]=Ke),Ke)}function de(Ee,qe){if(isNaN(Ee)||!isFinite(Ee))return qe?q:B;if(qe){if(Ee<0)return q;if(Ee>=le)return ve}else{if(Ee<=-pe)return Ae;if(Ee+1>=pe)return K}return Ee<0?de(-Ee,qe).neg():be(Ee%_e|0,Ee/_e|0,qe)}function be(Ee,qe,Ke){return new N(Ee,qe,Ke)}N.fromInt=P,N.fromNumber=de,N.fromBits=be;var te=Math.pow;function ce(Ee,qe,Ke){if(0===Ee.length)throw Error("empty string");if("NaN"===Ee||"Infinity"===Ee||"+Infinity"===Ee||"-Infinity"===Ee)return B;if("number"==typeof qe?(Ke=qe,qe=!1):qe=!!qe,(Ke=Ke||10)<2||36<Ke)throw RangeError("radix");var gt;if((gt=Ee.indexOf("-"))>0)throw Error("interior hyphen");if(0===gt)return ce(Ee.substring(1),qe,Ke).neg();for(var at=de(te(Ke,8)),Ct=B,wt=0;wt<Ee.length;wt+=8){var Ft=Math.min(8,Ee.length-wt),Ot=parseInt(Ee.substring(wt,wt+Ft),Ke);if(Ft<8){var rn=de(te(Ke,Ft));Ct=Ct.mul(rn).add(de(Ot))}else Ct=(Ct=Ct.mul(at)).add(de(Ot))}return Ct.unsigned=qe,Ct}function fe(Ee){return Ee instanceof N?Ee:"number"==typeof Ee?de(Ee):"string"==typeof Ee?ce(Ee):be(Ee.low,Ee.high,Ee.unsigned)}N.fromString=ce,N.fromValue=fe;var _e=4294967296,le=_e*_e,pe=le/2,T=P(1<<24),B=P(0);N.ZERO=B;var q=P(0,!0);N.UZERO=q;var ee=P(1);N.ONE=ee;var F=P(1,!0);N.UONE=F;var Be=P(-1);N.NEG_ONE=Be;var K=be(-1,2147483647,!1);N.MAX_VALUE=K;var ve=be(-1,-1,!0);N.MAX_UNSIGNED_VALUE=ve;var Ae=be(0,-2147483648,!1);N.MIN_VALUE=Ae;var Fe=N.prototype;return Fe.toInt=function(){return this.unsigned?this.low>>>0:this.low},Fe.toNumber=function(){return this.unsigned?(this.high>>>0)*_e+(this.low>>>0):this.high*_e+(this.low>>>0)},Fe.toString=function(Ee){if((Ee=Ee||10)<2||36<Ee)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(Ae)){var qe=de(Ee),Ke=this.div(qe),gt=Ke.mul(qe).sub(this);return Ke.toString(Ee)+gt.toInt().toString(Ee)}return"-"+this.neg().toString(Ee)}for(var at=de(te(Ee,6),this.unsigned),Ct=this,wt="";;){var Ft=Ct.div(at),Ot=(Ct.sub(Ft.mul(at)).toInt()>>>0).toString(Ee);if((Ct=Ft).isZero())return Ot+wt;for(;Ot.length<6;)Ot="0"+Ot;wt=""+Ot+wt}},Fe.getHighBits=function(){return this.high},Fe.getHighBitsUnsigned=function(){return this.high>>>0},Fe.getLowBits=function(){return this.low},Fe.getLowBitsUnsigned=function(){return this.low>>>0},Fe.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Ae)?64:this.neg().getNumBitsAbs();for(var Ee=0!=this.high?this.high:this.low,qe=31;qe>0&&!(Ee&1<<qe);qe--);return 0!=this.high?qe+33:qe+1},Fe.isZero=function(){return 0===this.high&&0===this.low},Fe.isNegative=function(){return!this.unsigned&&this.high<0},Fe.isPositive=function(){return this.unsigned||this.high>=0},Fe.isOdd=function(){return!(1&~this.low)},Fe.isEven=function(){return!(1&this.low)},Fe.equals=function(Ee){return U(Ee)||(Ee=fe(Ee)),(this.unsigned===Ee.unsigned||this.high>>>31!=1||Ee.high>>>31!=1)&&this.high===Ee.high&&this.low===Ee.low},Fe.eq=Fe.equals,Fe.notEquals=function(Ee){return!this.eq(Ee)},Fe.neq=Fe.notEquals,Fe.lessThan=function(Ee){return this.comp(Ee)<0},Fe.lt=Fe.lessThan,Fe.lessThanOrEqual=function(Ee){return this.comp(Ee)<=0},Fe.lte=Fe.lessThanOrEqual,Fe.greaterThan=function(Ee){return this.comp(Ee)>0},Fe.gt=Fe.greaterThan,Fe.greaterThanOrEqual=function(Ee){return this.comp(Ee)>=0},Fe.gte=Fe.greaterThanOrEqual,Fe.compare=function(Ee){if(U(Ee)||(Ee=fe(Ee)),this.eq(Ee))return 0;var qe=this.isNegative(),Ke=Ee.isNegative();return qe&&!Ke?-1:!qe&&Ke?1:this.unsigned?Ee.high>>>0>this.high>>>0||Ee.high===this.high&&Ee.low>>>0>this.low>>>0?-1:1:this.sub(Ee).isNegative()?-1:1},Fe.comp=Fe.compare,Fe.negate=function(){return!this.unsigned&&this.eq(Ae)?Ae:this.not().add(ee)},Fe.neg=Fe.negate,Fe.add=function(Ee){U(Ee)||(Ee=fe(Ee));var Ot=0,rn=0,ft=0,Tn=0;return ft+=(Tn+=(65535&this.low)+(65535&Ee.low))>>>16,rn+=(ft+=(this.low>>>16)+(Ee.low>>>16))>>>16,Ot+=(rn+=(65535&this.high)+(65535&Ee.high))>>>16,Ot+=(this.high>>>16)+(Ee.high>>>16),be((ft&=65535)<<16|(Tn&=65535),(Ot&=65535)<<16|(rn&=65535),this.unsigned)},Fe.subtract=function(Ee){return U(Ee)||(Ee=fe(Ee)),this.add(Ee.neg())},Fe.sub=Fe.subtract,Fe.multiply=function(Ee){if(this.isZero()||(U(Ee)||(Ee=fe(Ee)),Ee.isZero()))return B;if(this.eq(Ae))return Ee.isOdd()?Ae:B;if(Ee.eq(Ae))return this.isOdd()?Ae:B;if(this.isNegative())return Ee.isNegative()?this.neg().mul(Ee.neg()):this.neg().mul(Ee).neg();if(Ee.isNegative())return this.mul(Ee.neg()).neg();if(this.lt(T)&&Ee.lt(T))return de(this.toNumber()*Ee.toNumber(),this.unsigned);var Ke=65535&this.high,gt=this.low>>>16,at=65535&this.low,wt=65535&Ee.high,Ft=Ee.low>>>16,Ot=65535&Ee.low,rn=0,ft=0,Tn=0,Cn=0;return Tn+=(Cn+=at*Ot)>>>16,ft+=(Tn+=gt*Ot)>>>16,Tn&=65535,ft+=(Tn+=at*Ft)>>>16,rn+=(ft+=Ke*Ot)>>>16,ft&=65535,rn+=(ft+=gt*Ft)>>>16,ft&=65535,rn+=(ft+=at*wt)>>>16,rn+=(this.high>>>16)*Ot+Ke*Ft+gt*wt+at*(Ee.high>>>16),be((Tn&=65535)<<16|(Cn&=65535),(rn&=65535)<<16|(ft&=65535),this.unsigned)},Fe.mul=Fe.multiply,Fe.divide=function(Ee){if(U(Ee)||(Ee=fe(Ee)),Ee.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?q:B;var qe,Ke,gt;if(this.unsigned){if(Ee.unsigned||(Ee=Ee.toUnsigned()),Ee.gt(this))return q;if(Ee.gt(this.shru(1)))return F;gt=q}else{if(this.eq(Ae))return Ee.eq(ee)||Ee.eq(Be)?Ae:Ee.eq(Ae)?ee:(qe=this.shr(1).div(Ee).shl(1)).eq(B)?Ee.isNegative()?ee:Be:(Ke=this.sub(Ee.mul(qe)),gt=qe.add(Ke.div(Ee)));if(Ee.eq(Ae))return this.unsigned?q:B;if(this.isNegative())return Ee.isNegative()?this.neg().div(Ee.neg()):this.neg().div(Ee).neg();if(Ee.isNegative())return this.div(Ee.neg()).neg();gt=B}for(Ke=this;Ke.gte(Ee);){qe=Math.max(1,Math.floor(Ke.toNumber()/Ee.toNumber()));for(var at=Math.ceil(Math.log(qe)/Math.LN2),Ct=at<=48?1:te(2,at-48),wt=de(qe),Ft=wt.mul(Ee);Ft.isNegative()||Ft.gt(Ke);)Ft=(wt=de(qe-=Ct,this.unsigned)).mul(Ee);wt.isZero()&&(wt=ee),gt=gt.add(wt),Ke=Ke.sub(Ft)}return gt},Fe.div=Fe.divide,Fe.modulo=function(Ee){return U(Ee)||(Ee=fe(Ee)),this.sub(this.div(Ee).mul(Ee))},Fe.mod=Fe.modulo,Fe.not=function(){return be(~this.low,~this.high,this.unsigned)},Fe.and=function(Ee){return U(Ee)||(Ee=fe(Ee)),be(this.low&Ee.low,this.high&Ee.high,this.unsigned)},Fe.or=function(Ee){return U(Ee)||(Ee=fe(Ee)),be(this.low|Ee.low,this.high|Ee.high,this.unsigned)},Fe.xor=function(Ee){return U(Ee)||(Ee=fe(Ee)),be(this.low^Ee.low,this.high^Ee.high,this.unsigned)},Fe.shiftLeft=function(Ee){return U(Ee)&&(Ee=Ee.toInt()),0==(Ee&=63)?this:Ee<32?be(this.low<<Ee,this.high<<Ee|this.low>>>32-Ee,this.unsigned):be(0,this.low<<Ee-32,this.unsigned)},Fe.shl=Fe.shiftLeft,Fe.shiftRight=function(Ee){return U(Ee)&&(Ee=Ee.toInt()),0==(Ee&=63)?this:Ee<32?be(this.low>>>Ee|this.high<<32-Ee,this.high>>Ee,this.unsigned):be(this.high>>Ee-32,this.high>=0?0:-1,this.unsigned)},Fe.shr=Fe.shiftRight,Fe.shiftRightUnsigned=function(Ee){if(U(Ee)&&(Ee=Ee.toInt()),0==(Ee&=63))return this;var qe=this.high;return Ee<32?be(this.low>>>Ee|qe<<32-Ee,qe>>>Ee,this.unsigned):be(32===Ee?qe:qe>>>Ee-32,0,this.unsigned)},Fe.shru=Fe.shiftRightUnsigned,Fe.toSigned=function(){return this.unsigned?be(this.low,this.high,!1):this},Fe.toUnsigned=function(){return this.unsigned?this:be(this.low,this.high,!0)},Fe.toBytes=function(Ee){return Ee?this.toBytesLE():this.toBytesBE()},Fe.toBytesLE=function(){var Ee=this.high,qe=this.low;return[255&qe,qe>>>8&255,qe>>>16&255,qe>>>24&255,255&Ee,Ee>>>8&255,Ee>>>16&255,Ee>>>24&255]},Fe.toBytesBE=function(){var Ee=this.high,qe=this.low;return[Ee>>>24&255,Ee>>>16&255,Ee>>>8&255,255&Ee,qe>>>24&255,qe>>>16&255,qe>>>8&255,255&qe]},N})?l.apply(o,[]):l)||(n.exports=x)},166:(n,o,l)=>{var x=l(690),N=l(561),U=l(809),G=[0,2,3],A=[2,1,3];n.exports=function(P,de){P&&(N(P)||U(P))||(de=P||{},P=null);for(var be="string"==typeof(de="number"==typeof de?{count:de}:de||{}).type?de.type:"uint16",ce=de.start||0,fe=!1!==de.clockwise?G:A,_e=fe[0],le=fe[1],pe=fe[2],T=6*("number"==typeof de.count?de.count:1),B=P||new(x(be))(T),q=0,ee=0;q<T;q+=6,ee+=4){var F=q+ce;B[F+0]=ee+0,B[F+1]=ee+1,B[F+2]=ee+2,B[F+3]=ee+_e,B[F+4]=ee+le,B[F+5]=ee+pe}return B}},573:(n,o,l)=>{var x=l(412),N=l(190),U=l(87),G=l(166),A=l(991),P=l(47),de=x.BufferGeometry;function be(te){de.call(this),"string"==typeof te&&(te={text:te}),this._opt=Object.assign({},te),te&&this.update(te)}n.exports=function(te){return new be(te)},U(be,de),be.prototype.update=function(te){if("string"==typeof te&&(te={text:te}),!(te=Object.assign({},this._opt,te)).font)throw new TypeError("must specify a { font } in options");this.layout=N(te);var ce=!1!==te.flipY,fe=te.font,_e=fe.common.scaleW,le=fe.common.scaleH,pe=this.layout.glyphs.filter(function(F){var Be=F.data;return Be.width*Be.height>0});this.visibleGlyphs=pe;var T=A.positions(pe),B=A.uvs(pe,_e,le,ce),q=G([],{clockwise:!0,type:"uint16",count:pe.length});if(this.setIndex(q),this.setAttribute("position",new x.BufferAttribute(T,2)),this.setAttribute("uv",new x.BufferAttribute(B,2)),!te.multipage&&"page"in this.attributes)this.removeAttribute("page");else if(te.multipage){var ee=A.pages(pe);this.setAttribute("page",new x.BufferAttribute(ee,1))}},be.prototype.computeBoundingSphere=function(){null===this.boundingSphere&&(this.boundingSphere=new x.Sphere);var te=this.attributes.position.array;if(!te||!this.attributes.position.itemSize||te.length<2)return this.boundingSphere.radius=0,void this.boundingSphere.center.set(0,0,0);P.computeSphere(te,this.boundingSphere),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')},be.prototype.computeBoundingBox=function(){null===this.boundingBox&&(this.boundingBox=new x.Box3);var te=this.boundingBox,ce=this.attributes.position.array;!ce||!this.attributes.position.itemSize||ce.length<2?te.makeEmpty():P.computeBox(ce,te)}},47:n=>{var o={min:[0,0],max:[0,0]};function l(x){var N=x.length/2;o.min[0]=x[0],o.min[1]=x[1],o.max[0]=x[0],o.max[1]=x[1];for(var U=0;U<N;U++){var G=x[2*U+0],A=x[2*U+1];o.min[0]=Math.min(G,o.min[0]),o.min[1]=Math.min(A,o.min[1]),o.max[0]=Math.max(G,o.max[0]),o.max[1]=Math.max(A,o.max[1])}}n.exports.computeBox=function(x,N){l(x),N.min.set(o.min[0],o.min[1],0),N.max.set(o.max[0],o.max[1],0)},n.exports.computeSphere=function(x,N){l(x);var U=o.min[0],G=o.min[1],A=o.max[0]-U,P=o.max[1]-G,de=Math.sqrt(A*A+P*P);N.center.set(U+A/2,G+P/2,0),N.radius=de/2}},991:n=>{n.exports.pages=function(o){var l=new Float32Array(4*o.length*1),x=0;return o.forEach(function(N){var U=N.data.page||0;l[x++]=U,l[x++]=U,l[x++]=U,l[x++]=U}),l},n.exports.uvs=function(o,l,x,N){var U=new Float32Array(4*o.length*2),G=0;return o.forEach(function(A){var P=A.data,be=P.y+P.height,te=P.x/l,ce=P.y/x,fe=(P.x+P.width)/l,_e=be/x;N&&(ce=(x-P.y)/x,_e=(x-be)/x),U[G++]=te,U[G++]=ce,U[G++]=te,U[G++]=_e,U[G++]=fe,U[G++]=_e,U[G++]=fe,U[G++]=ce}),U},n.exports.positions=function(o){var l=new Float32Array(4*o.length*2),x=0;return o.forEach(function(N){var U=N.data,G=N.position[0]+U.xoffset,A=N.position[1]+U.yoffset,P=U.width,de=U.height;l[x++]=G,l[x++]=A,l[x++]=G,l[x++]=A+de,l[x++]=G+P,l[x++]=A+de,l[x++]=G+P,l[x++]=A}),l}},412:(n,o,l)=>{"use strict";l.r(o),l.d(o,{ACESFilmicToneMapping:()=>Zr,AddEquation:()=>Ae,AddOperation:()=>ir,AdditiveAnimationBlendMode:()=>Yu,AdditiveBlending:()=>F,AlphaFormat:()=>dp,AlwaysDepth:()=>$n,AlwaysStencilFunc:()=>na,AmbientLight:()=>ht,AmbientLightProbe:()=>Dh,AnimationClip:()=>zs,AnimationLoader:()=>Il,AnimationMixer:()=>gm,AnimationObjectGroup:()=>jm,AnimationUtils:()=>oo,ArcCurve:()=>a,ArrayCamera:()=>Ch,ArrowHelper:()=>up,Audio:()=>Rd,AudioAnalyser:()=>Of,AudioContext:()=>Ou,AudioListener:()=>Pf,AudioLoader:()=>qp,AxesHelper:()=>wf,AxisHelper:()=>D_,BackSide:()=>le,BasicDepthPacking:()=>W,BasicShadowMap:()=>be,BinaryTextureLoader:()=>H_,Bone:()=>Kd,BooleanKeyframeTrack:()=>dl,BoundingBoxHelper:()=>U_,Box2:()=>Wm,Box3:()=>_n,Box3Helper:()=>Hf,BoxBufferGeometry:()=>nh,BoxGeometry:()=>Cs,BoxHelper:()=>Yp,BufferAttribute:()=>Gr,BufferGeometry:()=>dn,BufferGeometryLoader:()=>Kn,ByteType:()=>kl,Cache:()=>Ei,Camera:()=>Mi,CameraHelper:()=>xf,CanvasRenderer:()=>q_,CanvasTexture:()=>Cu,CatmullRomCurve3:()=>R,CineonToneMapping:()=>Nr,CircleBufferGeometry:()=>lp,CircleGeometry:()=>ap,ClampToEdgeWrapping:()=>Xr,Clock:()=>lu,ClosedSplineCurve3:()=>g_,Color:()=>lr,ColorKeyframeTrack:()=>nf,CompressedTexture:()=>sd,CompressedTextureLoader:()=>Ld,ConeBufferGeometry:()=>Pi,ConeGeometry:()=>Jo,CubeCamera:()=>Io,CubeGeometry:()=>Cs,CubeReflectionMapping:()=>bi,CubeRefractionMapping:()=>So,CubeTexture:()=>ls,CubeTextureLoader:()=>fl,CubeUVReflectionMapping:()=>Di,CubeUVRefractionMapping:()=>Eo,CubicBezierCurve:()=>X,CubicBezierCurve3:()=>oe,CubicInterpolant:()=>dh,CullFaceBack:()=>A,CullFaceFront:()=>P,CullFaceFrontBack:()=>de,CullFaceNone:()=>G,Curve:()=>Hn,CurvePath:()=>Re,CustomBlending:()=>ve,CustomToneMapping:()=>Vr,CylinderBufferGeometry:()=>Nn,CylinderGeometry:()=>hh,Cylindrical:()=>o_,DataTexture:()=>ol,DataTexture2DArray:()=>za,DataTexture3D:()=>Mu,DataTextureLoader:()=>Iu,DecrementStencilOp:()=>At,DecrementWrapStencilOp:()=>fn,DefaultLoadingManager:()=>rf,DepthFormat:()=>To,DepthStencilFormat:()=>Ws,DepthTexture:()=>lh,DirectionalLight:()=>$t,DirectionalLightHelper:()=>of,DirectionalLightShadow:()=>Bt,DiscreteInterpolant:()=>Bc,DodecahedronBufferGeometry:()=>Fs,DodecahedronGeometry:()=>ks,DoubleSide:()=>pe,DstAlphaFactor:()=>rn,DstColorFactor:()=>Tn,DynamicBufferAttribute:()=>C_,DynamicCopyUsage:()=>ra,DynamicDrawUsage:()=>Lr,DynamicReadUsage:()=>Yi,EdgesGeometry:()=>Si,EdgesHelper:()=>z_,EllipseCurve:()=>rs,EqualDepth:()=>or,EqualStencilFunc:()=>Er,EquirectangularReflectionMapping:()=>Gs,EquirectangularRefractionMapping:()=>Ks,Euler:()=>lt,EventDispatcher:()=>ia,ExtrudeBufferGeometry:()=>ha,ExtrudeGeometry:()=>Cc,Face3:()=>sa,Face4:()=>Tm,FaceColors:()=>Mm,FileLoader:()=>tc,FlatShading:()=>T,Float32Attribute:()=>k_,Float32BufferAttribute:()=>Fn,Float64Attribute:()=>F_,Float64BufferAttribute:()=>Ml,FloatType:()=>Vo,Fog:()=>pf,FogExp2:()=>Sd,Font:()=>hs,FontLoader:()=>Bo,FrontSide:()=>_e,Frustum:()=>Vc,GammaEncoding:()=>Gl,Geometry:()=>Fr,GeometryUtils:()=>W_,GreaterDepth:()=>sr,GreaterEqualDepth:()=>hr,GreaterEqualStencilFunc:()=>Ko,GreaterStencilFunc:()=>Ar,GridHelper:()=>zf,Group:()=>Ys,HalfFloatType:()=>ds,HemisphereLight:()=>et,HemisphereLightHelper:()=>bf,HemisphereLightProbe:()=>cd,IcosahedronBufferGeometry:()=>Aa,IcosahedronGeometry:()=>ua,ImageBitmapLoader:()=>Do,ImageLoader:()=>Ol,ImageUtils:()=>Ki,ImmediateRenderObject:()=>Ff,IncrementStencilOp:()=>Et,IncrementWrapStencilOp:()=>Xt,InstancedBufferAttribute:()=>On,InstancedBufferGeometry:()=>Yn,InstancedInterleavedBuffer:()=>Hm,InstancedMesh:()=>Ad,Int16Attribute:()=>R_,Int16BufferAttribute:()=>ep,Int32Attribute:()=>I_,Int32BufferAttribute:()=>tr,Int8Attribute:()=>L_,Int8BufferAttribute:()=>tl,IntType:()=>Zp,InterleavedBuffer:()=>Jc,InterleavedBufferAttribute:()=>Fp,Interpolant:()=>Us,InterpolateDiscrete:()=>zl,InterpolateLinear:()=>jl,InterpolateSmooth:()=>qu,InvertStencilOp:()=>In,JSONLoader:()=>X_,KeepStencilOp:()=>Ve,KeyframeTrack:()=>fo,LOD:()=>ja,LatheBufferGeometry:()=>kh,LatheGeometry:()=>Lu,Layers:()=>yu,LensFlare:()=>J_,LessDepth:()=>gn,LessEqualDepth:()=>ur,LessEqualStencilFunc:()=>Kr,LessStencilFunc:()=>xn,Light:()=>ke,LightProbe:()=>un,LightShadow:()=>rt,Line:()=>Ni,Line3:()=>bm,LineBasicMaterial:()=>Qn,LineCurve:()=>ne,LineCurve3:()=>ge,LineDashedMaterial:()=>$a,LineLoop:()=>Mc,LinePieces:()=>E_,LineSegments:()=>Wi,LineStrip:()=>_a,LinearEncoding:()=>Qi,LinearFilter:()=>ii,LinearInterpolant:()=>Wa,LinearMipMapLinearFilter:()=>Jp,LinearMipMapNearestFilter:()=>Uh,LinearMipmapLinearFilter:()=>Ya,LinearMipmapNearestFilter:()=>Pc,LinearToneMapping:()=>pi,Loader:()=>Ci,LoaderUtils:()=>wr,LoadingManager:()=>fa,LogLuvEncoding:()=>Yh,LoopOnce:()=>_u,LoopPingPong:()=>lc,LoopRepeat:()=>Pa,LuminanceAlphaFormat:()=>Uu,LuminanceFormat:()=>Oc,MOUSE:()=>N,Material:()=>Ur,MaterialLoader:()=>Mn,Math:()=>rr,MathUtils:()=>rr,Matrix3:()=>jo,Matrix4:()=>ti,MaxEquation:()=>Ke,Mesh:()=>Bi,MeshBasicMaterial:()=>eo,MeshDepthMaterial:()=>sh,MeshDistanceMaterial:()=>Ip,MeshFaceMaterial:()=>T_,MeshLambertMaterial:()=>to,MeshMatcapMaterial:()=>Zo,MeshNormalMaterial:()=>Go,MeshPhongMaterial:()=>po,MeshPhysicalMaterial:()=>pl,MeshStandardMaterial:()=>da,MeshToonMaterial:()=>us,MinEquation:()=>qe,MirroredRepeatWrapping:()=>ss,MixOperation:()=>ci,MultiMaterial:()=>M_,MultiplyBlending:()=>K,MultiplyOperation:()=>Jr,NearestFilter:()=>Or,NearestMipMapLinearFilter:()=>Hs,NearestMipMapNearestFilter:()=>Fu,NearestMipmapLinearFilter:()=>ps,NearestMipmapNearestFilter:()=>Na,NeverDepth:()=>Pn,NeverStencilFunc:()=>nn,NoBlending:()=>q,NoColors:()=>La,NoToneMapping:()=>vr,NormalAnimationBlendMode:()=>Xu,NormalBlending:()=>ee,NotEqualDepth:()=>ei,NotEqualStencilFunc:()=>ms,NumberKeyframeTrack:()=>$i,Object3D:()=>er,ObjectLoader:()=>Mr,ObjectSpaceNormalMap:()=>Le,OctahedronBufferGeometry:()=>uh,OctahedronGeometry:()=>Rh,OneFactor:()=>at,OneMinusDstAlphaFactor:()=>ft,OneMinusDstColorFactor:()=>Cn,OneMinusSrcAlphaFactor:()=>Ot,OneMinusSrcColorFactor:()=>wt,OrthographicCamera:()=>zt,PCFShadowMap:()=>te,PCFSoftShadowMap:()=>ce,PMREMGenerator:()=>Em,ParametricBufferGeometry:()=>Ac,ParametricGeometry:()=>Kl,Particle:()=>Am,ParticleBasicMaterial:()=>m_,ParticleSystem:()=>Km,ParticleSystemMaterial:()=>__,Path:()=>Oe,PerspectiveCamera:()=>Bs,Plane:()=>Wo,PlaneBufferGeometry:()=>Cl,PlaneGeometry:()=>Ua,PlaneHelper:()=>Vf,PointCloud:()=>f_,PointCloudMaterial:()=>A_,PointLight:()=>Kt,PointLightHelper:()=>yf,Points:()=>wo,PointsMaterial:()=>ca,PolarGridHelper:()=>xm,PolyhedronBufferGeometry:()=>Ma,PolyhedronGeometry:()=>ch,PositionalAudio:()=>gf,PropertyBinding:()=>rc,PropertyMixer:()=>dm,QuadraticBezierCurve:()=>we,QuadraticBezierCurve3:()=>Se,Quaternion:()=>yo,QuaternionKeyframeTrack:()=>Nc,QuaternionLinearInterpolant:()=>Nu,REVISION:()=>x,RGBADepthPacking:()=>ue,RGBAFormat:()=>lo,RGBAIntegerFormat:()=>vh,RGBA_ASTC_10x10_Format:()=>Qa,RGBA_ASTC_10x5_Format:()=>Hu,RGBA_ASTC_10x6_Format:()=>Za,RGBA_ASTC_10x8_Format:()=>Hh,RGBA_ASTC_12x10_Format:()=>Vh,RGBA_ASTC_12x12_Format:()=>Vu,RGBA_ASTC_4x4_Format:()=>ju,RGBA_ASTC_5x4_Format:()=>_p,RGBA_ASTC_5x5_Format:()=>gp,RGBA_ASTC_6x5_Format:()=>kc,RGBA_ASTC_6x6_Format:()=>oc,RGBA_ASTC_8x5_Format:()=>bh,RGBA_ASTC_8x6_Format:()=>vp,RGBA_ASTC_8x8_Format:()=>Gu,RGBA_BPTC_Format:()=>sc,RGBA_ETC2_EAC_Format:()=>Dl,RGBA_PVRTC_2BPPV1_Format:()=>Fl,RGBA_PVRTC_4BPPV1_Format:()=>yl,RGBA_S3TC_DXT1_Format:()=>ic,RGBA_S3TC_DXT3_Format:()=>jh,RGBA_S3TC_DXT5_Format:()=>yh,RGBDEncoding:()=>gu,RGBEEncoding:()=>Uc,RGBEFormat:()=>gh,RGBFormat:()=>Rs,RGBIntegerFormat:()=>mp,RGBM16Encoding:()=>Ju,RGBM7Encoding:()=>cc,RGB_ETC1_Format:()=>zu,RGB_ETC2_Format:()=>fs,RGB_PVRTC_2BPPV1_Format:()=>vl,RGB_PVRTC_4BPPV1_Format:()=>Gh,RGB_S3TC_DXT1_Format:()=>zh,RGFormat:()=>fu,RGIntegerFormat:()=>fp,RawShaderMaterial:()=>qi,Ray:()=>co,Raycaster:()=>vm,RectAreaLight:()=>Tt,RedFormat:()=>Qp,RedIntegerFormat:()=>Ja,ReinhardToneMapping:()=>go,RepeatWrapping:()=>vo,ReplaceStencilOp:()=>Qe,ReverseSubtractEquation:()=>Ee,RingBufferGeometry:()=>Lc,RingGeometry:()=>pa,SRGB8_ALPHA8_ASTC_10x10_Format:()=>wp,SRGB8_ALPHA8_ASTC_10x5_Format:()=>bp,SRGB8_ALPHA8_ASTC_10x6_Format:()=>Wh,SRGB8_ALPHA8_ASTC_10x8_Format:()=>xp,SRGB8_ALPHA8_ASTC_12x10_Format:()=>qh,SRGB8_ALPHA8_ASTC_12x12_Format:()=>Kp,SRGB8_ALPHA8_ASTC_4x4_Format:()=>ac,SRGB8_ALPHA8_ASTC_5x4_Format:()=>xh,SRGB8_ALPHA8_ASTC_5x5_Format:()=>mu,SRGB8_ALPHA8_ASTC_6x5_Format:()=>Fc,SRGB8_ALPHA8_ASTC_6x6_Format:()=>yp,SRGB8_ALPHA8_ASTC_8x5_Format:()=>Dc,SRGB8_ALPHA8_ASTC_8x6_Format:()=>Wu,SRGB8_ALPHA8_ASTC_8x8_Format:()=>Ul,Scene:()=>Sl,SceneUtils:()=>Y_,ShaderChunk:()=>Dr,ShaderLib:()=>wc,ShaderMaterial:()=>uo,ShadowMaterial:()=>ph,Shape:()=>Ge,ShapeBufferGeometry:()=>ou,ShapeGeometry:()=>Bu,ShapePath:()=>Uo,ShapeUtils:()=>$c,ShortType:()=>Ra,Skeleton:()=>Qd,SkeletonHelper:()=>md,SkinnedMesh:()=>zp,SmoothShading:()=>B,Sphere:()=>zn,SphereBufferGeometry:()=>Hr,SphereGeometry:()=>Cr,Spherical:()=>i_,SphericalHarmonics3:()=>Zt,Spline:()=>e_,SplineCurve:()=>Ce,SplineCurve3:()=>v_,SpotLight:()=>vt,SpotLightHelper:()=>vf,SpotLightShadow:()=>ut,Sprite:()=>Zd,SpriteMaterial:()=>Lh,SrcAlphaFactor:()=>Ft,SrcAlphaSaturateFactor:()=>mn,SrcColorFactor:()=>Ct,StaticCopyUsage:()=>uc,StaticDrawUsage:()=>_i,StaticReadUsage:()=>Xi,StereoCamera:()=>au,StreamCopyUsage:()=>el,StreamDrawUsage:()=>Ia,StreamReadUsage:()=>Jh,StringKeyframeTrack:()=>Ru,SubtractEquation:()=>Fe,SubtractiveBlending:()=>Be,TOUCH:()=>U,TangentSpaceNormalMap:()=>Te,TetrahedronBufferGeometry:()=>eu,TetrahedronGeometry:()=>Kc,TextBufferGeometry:()=>ho,TextGeometry:()=>Oh,Texture:()=>ui,TextureLoader:()=>ld,TorusBufferGeometry:()=>Vp,TorusGeometry:()=>Ao,TorusKnotBufferGeometry:()=>Pl,TorusKnotGeometry:()=>Va,Triangle:()=>Ir,TriangleFanDrawMode:()=>Ep,TriangleStripDrawMode:()=>Sp,TrianglesDrawMode:()=>Xh,TubeBufferGeometry:()=>ec,TubeGeometry:()=>tu,UVMapping:()=>fi,Uint16Attribute:()=>P_,Uint16BufferAttribute:()=>Tl,Uint32Attribute:()=>O_,Uint32BufferAttribute:()=>nl,Uint8Attribute:()=>B_,Uint8BufferAttribute:()=>yc,Uint8ClampedAttribute:()=>N_,Uint8ClampedBufferAttribute:()=>Qu,Uniform:()=>kf,UniformsLib:()=>pr,UniformsUtils:()=>Po,UnsignedByteType:()=>ea,UnsignedInt248Type:()=>Es,UnsignedIntType:()=>Vs,UnsignedShort4444Type:()=>Du,UnsignedShort5551Type:()=>pu,UnsignedShort565Type:()=>du,UnsignedShortType:()=>Ic,VSMShadowMap:()=>fe,Vector2:()=>wn,Vector3:()=>ot,Vector4:()=>gi,VectorKeyframeTrack:()=>su,Vertex:()=>$_,VertexColors:()=>d_,VideoTexture:()=>Ha,WebGL1Renderer:()=>Op,WebGLCubeRenderTarget:()=>$l,WebGLMultisampleRenderTarget:()=>Zh,WebGLRenderTarget:()=>Is,WebGLRenderTargetCube:()=>V_,WebGLRenderer:()=>$u,WebGLUtils:()=>la,WireframeGeometry:()=>Ql,WireframeHelper:()=>j_,WrapAroundEnding:()=>xl,XHRLoader:()=>G_,ZeroCurvatureEnding:()=>va,ZeroFactor:()=>gt,ZeroSlopeEnding:()=>ta,ZeroStencilOp:()=>He,sRGBEncoding:()=>Ka}),void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),void 0===Math.sign&&(Math.sign=function(t){return t<0?-1:t>0?1:+t}),"name"in Function.prototype==0&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");const u=Object(t);for(let m=1;m<arguments.length;m++){const g=arguments[m];if(null!=g)for(const E in g)Object.prototype.hasOwnProperty.call(g,E)&&(u[E]=g[E])}return u});const x="119",N={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},U={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},G=0,A=1,P=2,de=3,be=0,te=1,ce=2,fe=3,_e=0,le=1,pe=2,T=1,B=2,q=0,ee=1,F=2,Be=3,K=4,ve=5,Ae=100,Fe=101,Ee=102,qe=103,Ke=104,gt=200,at=201,Ct=202,wt=203,Ft=204,Ot=205,rn=206,ft=207,Tn=208,Cn=209,mn=210,Pn=0,$n=1,gn=2,ur=3,or=4,hr=5,sr=6,ei=7,Jr=0,ci=1,ir=2,vr=0,pi=1,go=2,Nr=3,Zr=4,Vr=5,fi=300,bi=301,So=302,Gs=303,Ks=304,Di=306,Eo=307,vo=1e3,Xr=1001,ss=1002,Or=1003,Na=1004,Fu=1004,ps=1005,Hs=1005,ii=1006,Pc=1007,Uh=1007,Ya=1008,Jp=1008,ea=1009,kl=1010,Ra=1011,Ic=1012,Zp=1013,Vs=1014,Vo=1015,ds=1016,Du=1017,pu=1018,du=1019,Es=1020,dp=1021,Rs=1022,lo=1023,Oc=1024,Uu=1025,gh=lo,To=1026,Ws=1027,Qp=1028,Ja=1029,fu=1030,fp=1031,mp=1032,vh=1033,zh=33776,ic=33777,jh=33778,yh=33779,Gh=35840,vl=35841,yl=35842,Fl=35843,zu=36196,fs=37492,Dl=37496,ju=37808,_p=37809,gp=37810,kc=37811,oc=37812,bh=37813,vp=37814,Gu=37815,Hu=37816,Za=37817,Hh=37818,Qa=37819,Vh=37820,Vu=37821,sc=36492,ac=37840,xh=37841,mu=37842,Fc=37843,yp=37844,Dc=37845,Wu=37846,Ul=37847,bp=37848,Wh=37849,xp=37850,wp=37851,qh=37852,Kp=37853,_u=2200,Pa=2201,lc=2202,zl=2300,jl=2301,qu=2302,va=2400,ta=2401,xl=2402,Xu=2500,Yu=2501,Xh=0,Sp=1,Ep=2,Qi=3e3,Ka=3001,Gl=3007,Uc=3002,Yh=3003,cc=3004,Ju=3005,gu=3006,W=3200,ue=3201,Te=0,Le=1,He=0,Ve=7680,Qe=7681,Et=7682,At=7683,Xt=34055,fn=34056,In=5386,nn=512,xn=513,Er=514,Kr=515,Ar=516,ms=517,Ko=518,na=519,_i=35044,Lr=35048,Ia=35040,Xi=35045,Yi=35049,Jh=35041,uc=35046,ra=35050,el=35042;function ia(){}Object.assign(ia.prototype,{addEventListener:function(t,u){void 0===this._listeners&&(this._listeners={});const m=this._listeners;void 0===m[t]&&(m[t]=[]),-1===m[t].indexOf(u)&&m[t].push(u)},hasEventListener:function(t,u){if(void 0===this._listeners)return!1;const m=this._listeners;return void 0!==m[t]&&-1!==m[t].indexOf(u)},removeEventListener:function(t,u){if(void 0===this._listeners)return;const m=this._listeners[t];if(void 0!==m){const g=m.indexOf(u);-1!==g&&m.splice(g,1)}},dispatchEvent:function(t){if(void 0===this._listeners)return;const u=this._listeners[t.type];if(void 0!==u){t.target=this;const m=u.slice(0);for(let g=0,E=m.length;g<E;g++)m[g].call(this,t)}}});const Ui=[];for(let t=0;t<256;t++)Ui[t]=(t<16?"0":"")+t.toString(16);let Ps=1234567;const rr={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){const t=4294967295*Math.random()|0,u=4294967295*Math.random()|0,m=4294967295*Math.random()|0,g=4294967295*Math.random()|0;return(Ui[255&t]+Ui[t>>8&255]+Ui[t>>16&255]+Ui[t>>24&255]+"-"+Ui[255&u]+Ui[u>>8&255]+"-"+Ui[u>>16&15|64]+Ui[u>>24&255]+"-"+Ui[63&m|128]+Ui[m>>8&255]+"-"+Ui[m>>16&255]+Ui[m>>24&255]+Ui[255&g]+Ui[g>>8&255]+Ui[g>>16&255]+Ui[g>>24&255]).toUpperCase()},clamp:function(t,u,m){return Math.max(u,Math.min(m,t))},euclideanModulo:function(t,u){return(t%u+u)%u},mapLinear:function(t,u,m,g,E){return g+(t-u)*(E-g)/(m-u)},lerp:function(t,u,m){return(1-m)*t+m*u},smoothstep:function(t,u,m){return t<=u?0:t>=m?1:(t=(t-u)/(m-u))*t*(3-2*t)},smootherstep:function(t,u,m){return t<=u?0:t>=m?1:(t=(t-u)/(m-u))*t*t*(t*(6*t-15)+10)},randInt:function(t,u){return t+Math.floor(Math.random()*(u-t+1))},randFloat:function(t,u){return t+Math.random()*(u-t)},randFloatSpread:function(t){return t*(.5-Math.random())},seededRandom:function(t){return void 0!==t&&(Ps=t%2147483647),Ps=16807*Ps%2147483647,(Ps-1)/2147483646},degToRad:function(t){return t*rr.DEG2RAD},radToDeg:function(t){return t*rr.RAD2DEG},isPowerOfTwo:function(t){return!(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,u,m,g,E){const I=Math.cos,V=Math.sin,J=I(m/2),Y=V(m/2),Z=I((u+g)/2),me=V((u+g)/2),S=I((u-g)/2),e=V((u-g)/2),c=I((g-u)/2),p=V((g-u)/2);switch(E){case"XYX":t.set(J*me,Y*S,Y*e,J*Z);break;case"YZY":t.set(Y*e,J*me,Y*S,J*Z);break;case"ZXZ":t.set(Y*S,Y*e,J*me,J*Z);break;case"XZX":t.set(J*me,Y*p,Y*c,J*Z);break;case"YXY":t.set(Y*c,J*me,Y*p,J*Z);break;case"ZYZ":t.set(Y*p,Y*c,J*me,J*Z);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+E)}}};function wn(t=0,u=0){this.x=t,this.y=u}function jo(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}let as;Object.defineProperties(wn.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Object.assign(wn.prototype,{isVector2:!0,set:function(t,u){return this.x=t,this.y=u,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,u){switch(t){case 0:this.x=u;break;case 1:this.y=u;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,u){return void 0!==u?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,u)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,u){return this.x=t.x+u.x,this.y=t.y+u.y,this},addScaledVector:function(t,u){return this.x+=t.x*u,this.y+=t.y*u,this},sub:function(t,u){return void 0!==u?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,u)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,u){return this.x=t.x-u.x,this.y=t.y-u.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){const u=this.x,m=this.y,g=t.elements;return this.x=g[0]*u+g[3]*m+g[6],this.y=g[1]*u+g[4]*m+g[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,u){return this.x=Math.max(t.x,Math.min(u.x,this.x)),this.y=Math.max(t.y,Math.min(u.y,this.y)),this},clampScalar:function(t,u){return this.x=Math.max(t,Math.min(u,this.x)),this.y=Math.max(t,Math.min(u,this.y)),this},clampLength:function(t,u){const m=this.length();return this.divideScalar(m||1).multiplyScalar(Math.max(t,Math.min(u,m)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){return Math.atan2(-this.y,-this.x)+Math.PI},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){const u=this.x-t.x,m=this.y-t.y;return u*u+m*m},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,u){return this.x+=(t.x-this.x)*u,this.y+=(t.y-this.y)*u,this},lerpVectors:function(t,u,m){return this.x=t.x+(u.x-t.x)*m,this.y=t.y+(u.y-t.y)*m,this},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,u){return void 0===u&&(u=0),this.x=t[u],this.y=t[u+1],this},toArray:function(t,u){return void 0===t&&(t=[]),void 0===u&&(u=0),t[u]=this.x,t[u+1]=this.y,t},fromBufferAttribute:function(t,u,m){return void 0!==m&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(u),this.y=t.getY(u),this},rotateAround:function(t,u){const m=Math.cos(u),g=Math.sin(u),E=this.x-t.x,I=this.y-t.y;return this.x=E*m-I*g+t.x,this.y=E*g+I*m+t.y,this},random:function(){return this.x=Math.random(),this.y=Math.random(),this}}),Object.assign(jo.prototype,{isMatrix3:!0,set:function(t,u,m,g,E,I,V,J,Y){const Z=this.elements;return Z[0]=t,Z[1]=g,Z[2]=V,Z[3]=u,Z[4]=E,Z[5]=J,Z[6]=m,Z[7]=I,Z[8]=Y,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){const u=this.elements,m=t.elements;return u[0]=m[0],u[1]=m[1],u[2]=m[2],u[3]=m[3],u[4]=m[4],u[5]=m[5],u[6]=m[6],u[7]=m[7],u[8]=m[8],this},extractBasis:function(t,u,m){return t.setFromMatrix3Column(this,0),u.setFromMatrix3Column(this,1),m.setFromMatrix3Column(this,2),this},setFromMatrix4:function(t){const u=t.elements;return this.set(u[0],u[4],u[8],u[1],u[5],u[9],u[2],u[6],u[10]),this},multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,u){const m=t.elements,g=u.elements,E=this.elements,I=m[0],V=m[3],J=m[6],Y=m[1],Z=m[4],me=m[7],S=m[2],e=m[5],c=m[8],p=g[0],_=g[3],w=g[6],L=g[1],O=g[4],D=g[7],z=g[2],Q=g[5],ae=g[8];return E[0]=I*p+V*L+J*z,E[3]=I*_+V*O+J*Q,E[6]=I*w+V*D+J*ae,E[1]=Y*p+Z*L+me*z,E[4]=Y*_+Z*O+me*Q,E[7]=Y*w+Z*D+me*ae,E[2]=S*p+e*L+c*z,E[5]=S*_+e*O+c*Q,E[8]=S*w+e*D+c*ae,this},multiplyScalar:function(t){const u=this.elements;return u[0]*=t,u[3]*=t,u[6]*=t,u[1]*=t,u[4]*=t,u[7]*=t,u[2]*=t,u[5]*=t,u[8]*=t,this},determinant:function(){const t=this.elements,u=t[0],m=t[1],g=t[2],E=t[3],I=t[4],V=t[5],J=t[6],Y=t[7],Z=t[8];return u*I*Z-u*V*Y-m*E*Z+m*V*J+g*E*Y-g*I*J},getInverse:function(t,u){void 0!==u&&console.warn("THREE.Matrix3: .getInverse() can no longer be configured to throw on degenerate.");const m=t.elements,g=this.elements,E=m[0],I=m[1],V=m[2],J=m[3],Y=m[4],Z=m[5],me=m[6],S=m[7],e=m[8],c=e*Y-Z*S,p=Z*me-e*J,_=S*J-Y*me,w=E*c+I*p+V*_;if(0===w)return this.set(0,0,0,0,0,0,0,0,0);const L=1/w;return g[0]=c*L,g[1]=(V*S-e*I)*L,g[2]=(Z*I-V*Y)*L,g[3]=p*L,g[4]=(e*E-V*me)*L,g[5]=(V*J-Z*E)*L,g[6]=_*L,g[7]=(I*me-S*E)*L,g[8]=(Y*E-I*J)*L,this},transpose:function(){let t;const u=this.elements;return t=u[1],u[1]=u[3],u[3]=t,t=u[2],u[2]=u[6],u[6]=t,t=u[5],u[5]=u[7],u[7]=t,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){const u=this.elements;return t[0]=u[0],t[1]=u[3],t[2]=u[6],t[3]=u[1],t[4]=u[4],t[5]=u[7],t[6]=u[2],t[7]=u[5],t[8]=u[8],this},setUvTransform:function(t,u,m,g,E,I,V){const J=Math.cos(E),Y=Math.sin(E);this.set(m*J,m*Y,-m*(J*I+Y*V)+I+t,-g*Y,g*J,-g*(-Y*I+J*V)+V+u,0,0,1)},scale:function(t,u){const m=this.elements;return m[0]*=t,m[3]*=t,m[6]*=t,m[1]*=u,m[4]*=u,m[7]*=u,this},rotate:function(t){const u=Math.cos(t),m=Math.sin(t),g=this.elements,E=g[0],I=g[3],V=g[6],J=g[1],Y=g[4],Z=g[7];return g[0]=u*E+m*J,g[3]=u*I+m*Y,g[6]=u*V+m*Z,g[1]=-m*E+u*J,g[4]=-m*I+u*Y,g[7]=-m*V+u*Z,this},translate:function(t,u){const m=this.elements;return m[0]+=t*m[2],m[3]+=t*m[5],m[6]+=t*m[8],m[1]+=u*m[2],m[4]+=u*m[5],m[7]+=u*m[8],this},equals:function(t){const u=this.elements,m=t.elements;for(let g=0;g<9;g++)if(u[g]!==m[g])return!1;return!0},fromArray:function(t,u){void 0===u&&(u=0);for(let m=0;m<9;m++)this.elements[m]=t[m+u];return this},toArray:function(t,u){void 0===t&&(t=[]),void 0===u&&(u=0);const m=this.elements;return t[u]=m[0],t[u+1]=m[1],t[u+2]=m[2],t[u+3]=m[3],t[u+4]=m[4],t[u+5]=m[5],t[u+6]=m[6],t[u+7]=m[7],t[u+8]=m[8],t}});const Ki={getDataURL:function(t){if(/^data:/i.test(t.src)||typeof HTMLCanvasElement>"u")return t.src;let u;if(t instanceof HTMLCanvasElement)u=t;else{void 0===as&&(as=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),as.width=t.width,as.height=t.height;const m=as.getContext("2d");t instanceof ImageData?m.putImageData(t,0,0):m.drawImage(t,0,0,t.width,t.height),u=as}return u.width>2048||u.height>2048?u.toDataURL("image/jpeg",.6):u.toDataURL("image/png")}};let jr=0;function ui(t,u,m,g,E,I,V,J,Y,Z){Object.defineProperty(this,"id",{value:jr++}),this.uuid=rr.generateUUID(),this.name="",this.image=void 0!==t?t:ui.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==u?u:ui.DEFAULT_MAPPING,this.wrapS=void 0!==m?m:Xr,this.wrapT=void 0!==g?g:Xr,this.magFilter=void 0!==E?E:ii,this.minFilter=void 0!==I?I:Ya,this.anisotropy=void 0!==Y?Y:1,this.format=void 0!==V?V:lo,this.internalFormat=null,this.type=void 0!==J?J:ea,this.offset=new wn(0,0),this.repeat=new wn(1,1),this.center=new wn(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new jo,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==Z?Z:Qi,this.version=0,this.onUpdate=null}function gi(t=0,u=0,m=0,g=1){this.x=t,this.y=u,this.z=m,this.w=g}function Is(t,u,m){this.width=t,this.height=u,this.scissor=new gi(0,0,t,u),this.scissorTest=!1,this.viewport=new gi(0,0,t,u),this.texture=new ui(void 0,(m=m||{}).mapping,m.wrapS,m.wrapT,m.magFilter,m.minFilter,m.format,m.type,m.anisotropy,m.encoding),this.texture.image={},this.texture.image.width=t,this.texture.image.height=u,this.texture.generateMipmaps=void 0!==m.generateMipmaps&&m.generateMipmaps,this.texture.minFilter=void 0!==m.minFilter?m.minFilter:ii,this.depthBuffer=void 0===m.depthBuffer||m.depthBuffer,this.stencilBuffer=void 0===m.stencilBuffer||m.stencilBuffer,this.depthTexture=void 0!==m.depthTexture?m.depthTexture:null}function Zh(t,u,m){Is.call(this,t,u,m),this.samples=4}function yo(t=0,u=0,m=0,g=1){this._x=t,this._y=u,this._z=m,this._w=g}ui.DEFAULT_IMAGE=void 0,ui.DEFAULT_MAPPING=fi,ui.prototype=Object.assign(Object.create(ia.prototype),{constructor:ui,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){const u=void 0===t||"string"==typeof t;if(!u&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];const m={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){const g=this.image;if(void 0===g.uuid&&(g.uuid=rr.generateUUID()),!u&&void 0===t.images[g.uuid]){let E;if(Array.isArray(g)){E=[];for(let I=0,V=g.length;I<V;I++)E.push(Ki.getDataURL(g[I]))}else E=Ki.getDataURL(g);t.images[g.uuid]={uuid:g.uuid,url:E}}m.image=g.uuid}return u||(t.textures[this.uuid]=m),m},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(this.mapping!==fi)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case vo:t.x=t.x-Math.floor(t.x);break;case Xr:t.x=t.x<0?0:1;break;case ss:t.x=1===Math.abs(Math.floor(t.x)%2)?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case vo:t.y=t.y-Math.floor(t.y);break;case Xr:t.y=t.y<0?0:1;break;case ss:t.y=1===Math.abs(Math.floor(t.y)%2)?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}}),Object.defineProperty(ui.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.defineProperties(gi.prototype,{width:{get:function(){return this.z},set:function(t){this.z=t}},height:{get:function(){return this.w},set:function(t){this.w=t}}}),Object.assign(gi.prototype,{isVector4:!0,set:function(t,u,m,g){return this.x=t,this.y=u,this.z=m,this.w=g,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,u){switch(t){case 0:this.x=u;break;case 1:this.y=u;break;case 2:this.z=u;break;case 3:this.w=u;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,u){return void 0!==u?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,u)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,u){return this.x=t.x+u.x,this.y=t.y+u.y,this.z=t.z+u.z,this.w=t.w+u.w,this},addScaledVector:function(t,u){return this.x+=t.x*u,this.y+=t.y*u,this.z+=t.z*u,this.w+=t.w*u,this},sub:function(t,u){return void 0!==u?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,u)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,u){return this.x=t.x-u.x,this.y=t.y-u.y,this.z=t.z-u.z,this.w=t.w-u.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){const u=this.x,m=this.y,g=this.z,E=this.w,I=t.elements;return this.x=I[0]*u+I[4]*m+I[8]*g+I[12]*E,this.y=I[1]*u+I[5]*m+I[9]*g+I[13]*E,this.z=I[2]*u+I[6]*m+I[10]*g+I[14]*E,this.w=I[3]*u+I[7]*m+I[11]*g+I[15]*E,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);const u=Math.sqrt(1-t.w*t.w);return u<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/u,this.y=t.y/u,this.z=t.z/u),this},setAxisAngleFromRotationMatrix:function(t){let u,m,g,E;const J=t.elements,Y=J[0],Z=J[4],me=J[8],S=J[1],e=J[5],c=J[9],p=J[2],_=J[6],w=J[10];if(Math.abs(Z-S)<.01&&Math.abs(me-p)<.01&&Math.abs(c-_)<.01){if(Math.abs(Z+S)<.1&&Math.abs(me+p)<.1&&Math.abs(c+_)<.1&&Math.abs(Y+e+w-3)<.1)return this.set(1,0,0,0),this;u=Math.PI;const O=(Y+1)/2,D=(e+1)/2,z=(w+1)/2,Q=(Z+S)/4,ae=(me+p)/4,ie=(c+_)/4;return O>D&&O>z?O<.01?(m=0,g=.707106781,E=.707106781):(m=Math.sqrt(O),g=Q/m,E=ae/m):D>z?D<.01?(m=.707106781,g=0,E=.707106781):(g=Math.sqrt(D),m=Q/g,E=ie/g):z<.01?(m=.707106781,g=.707106781,E=0):(E=Math.sqrt(z),m=ae/E,g=ie/E),this.set(m,g,E,u),this}let L=Math.sqrt((_-c)*(_-c)+(me-p)*(me-p)+(S-Z)*(S-Z));return Math.abs(L)<.001&&(L=1),this.x=(_-c)/L,this.y=(me-p)/L,this.z=(S-Z)/L,this.w=Math.acos((Y+e+w-1)/2),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,u){return this.x=Math.max(t.x,Math.min(u.x,this.x)),this.y=Math.max(t.y,Math.min(u.y,this.y)),this.z=Math.max(t.z,Math.min(u.z,this.z)),this.w=Math.max(t.w,Math.min(u.w,this.w)),this},clampScalar:function(t,u){return this.x=Math.max(t,Math.min(u,this.x)),this.y=Math.max(t,Math.min(u,this.y)),this.z=Math.max(t,Math.min(u,this.z)),this.w=Math.max(t,Math.min(u,this.w)),this},clampLength:function(t,u){const m=this.length();return this.divideScalar(m||1).multiplyScalar(Math.max(t,Math.min(u,m)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,u){return this.x+=(t.x-this.x)*u,this.y+=(t.y-this.y)*u,this.z+=(t.z-this.z)*u,this.w+=(t.w-this.w)*u,this},lerpVectors:function(t,u,m){return this.x=t.x+(u.x-t.x)*m,this.y=t.y+(u.y-t.y)*m,this.z=t.z+(u.z-t.z)*m,this.w=t.w+(u.w-t.w)*m,this},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,u){return void 0===u&&(u=0),this.x=t[u],this.y=t[u+1],this.z=t[u+2],this.w=t[u+3],this},toArray:function(t,u){return void 0===t&&(t=[]),void 0===u&&(u=0),t[u]=this.x,t[u+1]=this.y,t[u+2]=this.z,t[u+3]=this.w,t},fromBufferAttribute:function(t,u,m){return void 0!==m&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(u),this.y=t.getY(u),this.z=t.getZ(u),this.w=t.getW(u),this},random:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}),Is.prototype=Object.assign(Object.create(ia.prototype),{constructor:Is,isWebGLRenderTarget:!0,setSize:function(t,u){this.width===t&&this.height===u||(this.width=t,this.height=u,this.texture.image.width=t,this.texture.image.height=u,this.dispose()),this.viewport.set(0,0,t,u),this.scissor.set(0,0,t,u)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Zh.prototype=Object.assign(Object.create(Is.prototype),{constructor:Zh,isWebGLMultisampleRenderTarget:!0,copy:function(t){return Is.prototype.copy.call(this,t),this.samples=t.samples,this}}),Object.assign(yo,{slerp:function(t,u,m,g){return m.copy(t).slerp(u,g)},slerpFlat:function(t,u,m,g,E,I,V){let J=m[g+0],Y=m[g+1],Z=m[g+2],me=m[g+3];const S=E[I+0],e=E[I+1],c=E[I+2],p=E[I+3];if(me!==p||J!==S||Y!==e||Z!==c){let _=1-V,w=J*S+Y*e+Z*c+me*p,L=w>=0?1:-1,O=1-w*w;if(O>Number.EPSILON){const z=Math.sqrt(O),Q=Math.atan2(z,w*L);_=Math.sin(_*Q)/z,V=Math.sin(V*Q)/z}const D=V*L;if(J=J*_+S*D,Y=Y*_+e*D,Z=Z*_+c*D,me=me*_+p*D,_===1-V){const z=1/Math.sqrt(J*J+Y*Y+Z*Z+me*me);J*=z,Y*=z,Z*=z,me*=z}}t[u]=J,t[u+1]=Y,t[u+2]=Z,t[u+3]=me},multiplyQuaternionsFlat:function(t,u,m,g,E,I){const V=m[g],J=m[g+1],Y=m[g+2],Z=m[g+3],me=E[I],S=E[I+1],e=E[I+2],c=E[I+3];return t[u]=V*c+Z*me+J*e-Y*S,t[u+1]=J*c+Z*S+Y*me-V*e,t[u+2]=Y*c+Z*e+V*S-J*me,t[u+3]=Z*c-V*me-J*S-Y*e,t}}),Object.defineProperties(yo.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this._onChangeCallback()}}}),Object.assign(yo.prototype,{isQuaternion:!0,set:function(t,u,m,g){return this._x=t,this._y=u,this._z=m,this._w=g,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this},setFromEuler:function(t,u){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const m=t._x,g=t._y,E=t._z,I=t.order,V=Math.cos,J=Math.sin,Y=V(m/2),Z=V(g/2),me=V(E/2),S=J(m/2),e=J(g/2),c=J(E/2);switch(I){case"XYZ":this._x=S*Z*me+Y*e*c,this._y=Y*e*me-S*Z*c,this._z=Y*Z*c+S*e*me,this._w=Y*Z*me-S*e*c;break;case"YXZ":this._x=S*Z*me+Y*e*c,this._y=Y*e*me-S*Z*c,this._z=Y*Z*c-S*e*me,this._w=Y*Z*me+S*e*c;break;case"ZXY":this._x=S*Z*me-Y*e*c,this._y=Y*e*me+S*Z*c,this._z=Y*Z*c+S*e*me,this._w=Y*Z*me-S*e*c;break;case"ZYX":this._x=S*Z*me-Y*e*c,this._y=Y*e*me+S*Z*c,this._z=Y*Z*c-S*e*me,this._w=Y*Z*me+S*e*c;break;case"YZX":this._x=S*Z*me+Y*e*c,this._y=Y*e*me+S*Z*c,this._z=Y*Z*c-S*e*me,this._w=Y*Z*me-S*e*c;break;case"XZY":this._x=S*Z*me-Y*e*c,this._y=Y*e*me-S*Z*c,this._z=Y*Z*c+S*e*me,this._w=Y*Z*me+S*e*c;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+I)}return!1!==u&&this._onChangeCallback(),this},setFromAxisAngle:function(t,u){const m=u/2,g=Math.sin(m);return this._x=t.x*g,this._y=t.y*g,this._z=t.z*g,this._w=Math.cos(m),this._onChangeCallback(),this},setFromRotationMatrix:function(t){const u=t.elements,m=u[0],g=u[4],E=u[8],I=u[1],V=u[5],J=u[9],Y=u[2],Z=u[6],me=u[10],S=m+V+me;if(S>0){const e=.5/Math.sqrt(S+1);this._w=.25/e,this._x=(Z-J)*e,this._y=(E-Y)*e,this._z=(I-g)*e}else if(m>V&&m>me){const e=2*Math.sqrt(1+m-V-me);this._w=(Z-J)/e,this._x=.25*e,this._y=(g+I)/e,this._z=(E+Y)/e}else if(V>me){const e=2*Math.sqrt(1+V-m-me);this._w=(E-Y)/e,this._x=(g+I)/e,this._y=.25*e,this._z=(J+Z)/e}else{const e=2*Math.sqrt(1+me-m-V);this._w=(I-g)/e,this._x=(E+Y)/e,this._y=(J+Z)/e,this._z=.25*e}return this._onChangeCallback(),this},setFromUnitVectors:function(t,u){let m=t.dot(u)+1;return m<1e-6?(m=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=m):(this._x=0,this._y=-t.z,this._z=t.y,this._w=m)):(this._x=t.y*u.z-t.z*u.y,this._y=t.z*u.x-t.x*u.z,this._z=t.x*u.y-t.y*u.x,this._w=m),this.normalize()},angleTo:function(t){return 2*Math.acos(Math.abs(rr.clamp(this.dot(t),-1,1)))},rotateTowards:function(t,u){const m=this.angleTo(t);if(0===m)return this;const g=Math.min(1,u/m);return this.slerp(t,g),this},identity:function(){return this.set(0,0,0,1)},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){let t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this},multiply:function(t,u){return void 0!==u?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,u)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,u){const m=t._x,g=t._y,E=t._z,I=t._w,V=u._x,J=u._y,Y=u._z,Z=u._w;return this._x=m*Z+I*V+g*Y-E*J,this._y=g*Z+I*J+E*V-m*Y,this._z=E*Z+I*Y+m*J-g*V,this._w=I*Z-m*V-g*J-E*Y,this._onChangeCallback(),this},slerp:function(t,u){if(0===u)return this;if(1===u)return this.copy(t);const m=this._x,g=this._y,E=this._z,I=this._w;let V=I*t._w+m*t._x+g*t._y+E*t._z;if(V<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,V=-V):this.copy(t),V>=1)return this._w=I,this._x=m,this._y=g,this._z=E,this;const J=1-V*V;if(J<=Number.EPSILON){const e=1-u;return this._w=e*I+u*this._w,this._x=e*m+u*this._x,this._y=e*g+u*this._y,this._z=e*E+u*this._z,this.normalize(),this._onChangeCallback(),this}const Y=Math.sqrt(J),Z=Math.atan2(Y,V),me=Math.sin((1-u)*Z)/Y,S=Math.sin(u*Z)/Y;return this._w=I*me+this._w*S,this._x=m*me+this._x*S,this._y=g*me+this._y*S,this._z=E*me+this._z*S,this._onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,u){return void 0===u&&(u=0),this._x=t[u],this._y=t[u+1],this._z=t[u+2],this._w=t[u+3],this._onChangeCallback(),this},toArray:function(t,u){return void 0===t&&(t=[]),void 0===u&&(u=0),t[u]=this._x,t[u+1]=this._y,t[u+2]=this._z,t[u+3]=this._w,t},fromBufferAttribute:function(t,u){return this._x=t.getX(u),this._y=t.getY(u),this._z=t.getZ(u),this._w=t.getW(u),this},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}});const vu=new ot,Un=new yo;function ot(t=0,u=0,m=0){this.x=t,this.y=u,this.z=m}Object.assign(ot.prototype,{isVector3:!0,set:function(t,u,m){return void 0===m&&(m=this.z),this.x=t,this.y=u,this.z=m,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,u){switch(t){case 0:this.x=u;break;case 1:this.y=u;break;case 2:this.z=u;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,u){return void 0!==u?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,u)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,u){return this.x=t.x+u.x,this.y=t.y+u.y,this.z=t.z+u.z,this},addScaledVector:function(t,u){return this.x+=t.x*u,this.y+=t.y*u,this.z+=t.z*u,this},sub:function(t,u){return void 0!==u?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,u)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,u){return this.x=t.x-u.x,this.y=t.y-u.y,this.z=t.z-u.z,this},multiply:function(t,u){return void 0!==u?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,u)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,u){return this.x=t.x*u.x,this.y=t.y*u.y,this.z=t.z*u.z,this},applyEuler:function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Un.setFromEuler(t))},applyAxisAngle:function(t,u){return this.applyQuaternion(Un.setFromAxisAngle(t,u))},applyMatrix3:function(t){const u=this.x,m=this.y,g=this.z,E=t.elements;return this.x=E[0]*u+E[3]*m+E[6]*g,this.y=E[1]*u+E[4]*m+E[7]*g,this.z=E[2]*u+E[5]*m+E[8]*g,this},applyNormalMatrix:function(t){return this.applyMatrix3(t).normalize()},applyMatrix4:function(t){const u=this.x,m=this.y,g=this.z,E=t.elements,I=1/(E[3]*u+E[7]*m+E[11]*g+E[15]);return this.x=(E[0]*u+E[4]*m+E[8]*g+E[12])*I,this.y=(E[1]*u+E[5]*m+E[9]*g+E[13])*I,this.z=(E[2]*u+E[6]*m+E[10]*g+E[14])*I,this},applyQuaternion:function(t){const u=this.x,m=this.y,g=this.z,E=t.x,I=t.y,V=t.z,J=t.w,Y=J*u+I*g-V*m,Z=J*m+V*u-E*g,me=J*g+E*m-I*u,S=-E*u-I*m-V*g;return this.x=Y*J+S*-E+Z*-V-me*-I,this.y=Z*J+S*-I+me*-E-Y*-V,this.z=me*J+S*-V+Y*-I-Z*-E,this},project:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},unproject:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},transformDirection:function(t){const u=this.x,m=this.y,g=this.z,E=t.elements;return this.x=E[0]*u+E[4]*m+E[8]*g,this.y=E[1]*u+E[5]*m+E[9]*g,this.z=E[2]*u+E[6]*m+E[10]*g,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,u){return this.x=Math.max(t.x,Math.min(u.x,this.x)),this.y=Math.max(t.y,Math.min(u.y,this.y)),this.z=Math.max(t.z,Math.min(u.z,this.z)),this},clampScalar:function(t,u){return this.x=Math.max(t,Math.min(u,this.x)),this.y=Math.max(t,Math.min(u,this.y)),this.z=Math.max(t,Math.min(u,this.z)),this},clampLength:function(t,u){const m=this.length();return this.divideScalar(m||1).multiplyScalar(Math.max(t,Math.min(u,m)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,u){return this.x+=(t.x-this.x)*u,this.y+=(t.y-this.y)*u,this.z+=(t.z-this.z)*u,this},lerpVectors:function(t,u,m){return this.x=t.x+(u.x-t.x)*m,this.y=t.y+(u.y-t.y)*m,this.z=t.z+(u.z-t.z)*m,this},cross:function(t,u){return void 0!==u?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,u)):this.crossVectors(this,t)},crossVectors:function(t,u){const m=t.x,g=t.y,E=t.z,I=u.x,V=u.y,J=u.z;return this.x=g*J-E*V,this.y=E*I-m*J,this.z=m*V-g*I,this},projectOnVector:function(t){const u=t.lengthSq();if(0===u)return this.set(0,0,0);const m=t.dot(this)/u;return this.copy(t).multiplyScalar(m)},projectOnPlane:function(t){return vu.copy(this).projectOnVector(t),this.sub(vu)},reflect:function(t){return this.sub(vu.copy(t).multiplyScalar(2*this.dot(t)))},angleTo:function(t){const u=Math.sqrt(this.lengthSq()*t.lengthSq());if(0===u)return Math.PI/2;const m=this.dot(t)/u;return Math.acos(rr.clamp(m,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){const u=this.x-t.x,m=this.y-t.y,g=this.z-t.z;return u*u+m*m+g*g},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},setFromSphericalCoords:function(t,u,m){const g=Math.sin(u)*t;return this.x=g*Math.sin(m),this.y=Math.cos(u)*t,this.z=g*Math.cos(m),this},setFromCylindrical:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},setFromCylindricalCoords:function(t,u,m){return this.x=t*Math.sin(u),this.y=m,this.z=t*Math.cos(u),this},setFromMatrixPosition:function(t){const u=t.elements;return this.x=u[12],this.y=u[13],this.z=u[14],this},setFromMatrixScale:function(t){const u=this.setFromMatrixColumn(t,0).length(),m=this.setFromMatrixColumn(t,1).length(),g=this.setFromMatrixColumn(t,2).length();return this.x=u,this.y=m,this.z=g,this},setFromMatrixColumn:function(t,u){return this.fromArray(t.elements,4*u)},setFromMatrix3Column:function(t,u){return this.fromArray(t.elements,3*u)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,u){return void 0===u&&(u=0),this.x=t[u],this.y=t[u+1],this.z=t[u+2],this},toArray:function(t,u){return void 0===t&&(t=[]),void 0===u&&(u=0),t[u]=this.x,t[u+1]=this.y,t[u+2]=this.z,t},fromBufferAttribute:function(t,u,m){return void 0!==m&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(u),this.y=t.getY(u),this.z=t.getZ(u),this},random:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}});const wl=new ot,Ts=new ti,Tp=new ot(0,0,0),Ms=new ot(1,1,1),hc=new ot,Hi=new ot,io=new ot;function ti(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}Object.assign(ti.prototype,{isMatrix4:!0,set:function(t,u,m,g,E,I,V,J,Y,Z,me,S,e,c,p,_){const w=this.elements;return w[0]=t,w[4]=u,w[8]=m,w[12]=g,w[1]=E,w[5]=I,w[9]=V,w[13]=J,w[2]=Y,w[6]=Z,w[10]=me,w[14]=S,w[3]=e,w[7]=c,w[11]=p,w[15]=_,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new ti).fromArray(this.elements)},copy:function(t){const u=this.elements,m=t.elements;return u[0]=m[0],u[1]=m[1],u[2]=m[2],u[3]=m[3],u[4]=m[4],u[5]=m[5],u[6]=m[6],u[7]=m[7],u[8]=m[8],u[9]=m[9],u[10]=m[10],u[11]=m[11],u[12]=m[12],u[13]=m[13],u[14]=m[14],u[15]=m[15],this},copyPosition:function(t){const u=this.elements,m=t.elements;return u[12]=m[12],u[13]=m[13],u[14]=m[14],this},extractBasis:function(t,u,m){return t.setFromMatrixColumn(this,0),u.setFromMatrixColumn(this,1),m.setFromMatrixColumn(this,2),this},makeBasis:function(t,u,m){return this.set(t.x,u.x,m.x,0,t.y,u.y,m.y,0,t.z,u.z,m.z,0,0,0,0,1),this},extractRotation:function(t){const u=this.elements,m=t.elements,g=1/wl.setFromMatrixColumn(t,0).length(),E=1/wl.setFromMatrixColumn(t,1).length(),I=1/wl.setFromMatrixColumn(t,2).length();return u[0]=m[0]*g,u[1]=m[1]*g,u[2]=m[2]*g,u[3]=0,u[4]=m[4]*E,u[5]=m[5]*E,u[6]=m[6]*E,u[7]=0,u[8]=m[8]*I,u[9]=m[9]*I,u[10]=m[10]*I,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,this},makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const u=this.elements,m=t.x,g=t.y,E=t.z,I=Math.cos(m),V=Math.sin(m),J=Math.cos(g),Y=Math.sin(g),Z=Math.cos(E),me=Math.sin(E);if("XYZ"===t.order){const S=I*Z,e=I*me,c=V*Z,p=V*me;u[0]=J*Z,u[4]=-J*me,u[8]=Y,u[1]=e+c*Y,u[5]=S-p*Y,u[9]=-V*J,u[2]=p-S*Y,u[6]=c+e*Y,u[10]=I*J}else if("YXZ"===t.order){const S=J*Z,e=J*me,c=Y*Z,p=Y*me;u[0]=S+p*V,u[4]=c*V-e,u[8]=I*Y,u[1]=I*me,u[5]=I*Z,u[9]=-V,u[2]=e*V-c,u[6]=p+S*V,u[10]=I*J}else if("ZXY"===t.order){const S=J*Z,e=J*me,c=Y*Z,p=Y*me;u[0]=S-p*V,u[4]=-I*me,u[8]=c+e*V,u[1]=e+c*V,u[5]=I*Z,u[9]=p-S*V,u[2]=-I*Y,u[6]=V,u[10]=I*J}else if("ZYX"===t.order){const S=I*Z,e=I*me,c=V*Z,p=V*me;u[0]=J*Z,u[4]=c*Y-e,u[8]=S*Y+p,u[1]=J*me,u[5]=p*Y+S,u[9]=e*Y-c,u[2]=-Y,u[6]=V*J,u[10]=I*J}else if("YZX"===t.order){const S=I*J,e=I*Y,c=V*J,p=V*Y;u[0]=J*Z,u[4]=p-S*me,u[8]=c*me+e,u[1]=me,u[5]=I*Z,u[9]=-V*Z,u[2]=-Y*Z,u[6]=e*me+c,u[10]=S-p*me}else if("XZY"===t.order){const S=I*J,e=I*Y,c=V*J,p=V*Y;u[0]=J*Z,u[4]=-me,u[8]=Y*Z,u[1]=S*me+p,u[5]=I*Z,u[9]=e*me-c,u[2]=c*me-e,u[6]=V*Z,u[10]=p*me+S}return u[3]=0,u[7]=0,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,this},makeRotationFromQuaternion:function(t){return this.compose(Tp,t,Ms)},lookAt:function(t,u,m){const g=this.elements;return io.subVectors(t,u),0===io.lengthSq()&&(io.z=1),io.normalize(),hc.crossVectors(m,io),0===hc.lengthSq()&&(1===Math.abs(m.z)?io.x+=1e-4:io.z+=1e-4,io.normalize(),hc.crossVectors(m,io)),hc.normalize(),Hi.crossVectors(io,hc),g[0]=hc.x,g[4]=Hi.x,g[8]=io.x,g[1]=hc.y,g[5]=Hi.y,g[9]=io.y,g[2]=hc.z,g[6]=Hi.z,g[10]=io.z,this},multiply:function(t,u){return void 0!==u?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,u)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,u){const m=t.elements,g=u.elements,E=this.elements,I=m[0],V=m[4],J=m[8],Y=m[12],Z=m[1],me=m[5],S=m[9],e=m[13],c=m[2],p=m[6],_=m[10],w=m[14],L=m[3],O=m[7],D=m[11],z=m[15],Q=g[0],ae=g[4],ie=g[8],he=g[12],ye=g[1],Me=g[5],Ne=g[9],$e=g[13],ze=g[2],Ye=g[6],We=g[10],nt=g[14],it=g[3],mt=g[7],xt=g[11],Dt=g[15];return E[0]=I*Q+V*ye+J*ze+Y*it,E[4]=I*ae+V*Me+J*Ye+Y*mt,E[8]=I*ie+V*Ne+J*We+Y*xt,E[12]=I*he+V*$e+J*nt+Y*Dt,E[1]=Z*Q+me*ye+S*ze+e*it,E[5]=Z*ae+me*Me+S*Ye+e*mt,E[9]=Z*ie+me*Ne+S*We+e*xt,E[13]=Z*he+me*$e+S*nt+e*Dt,E[2]=c*Q+p*ye+_*ze+w*it,E[6]=c*ae+p*Me+_*Ye+w*mt,E[10]=c*ie+p*Ne+_*We+w*xt,E[14]=c*he+p*$e+_*nt+w*Dt,E[3]=L*Q+O*ye+D*ze+z*it,E[7]=L*ae+O*Me+D*Ye+z*mt,E[11]=L*ie+O*Ne+D*We+z*xt,E[15]=L*he+O*$e+D*nt+z*Dt,this},multiplyScalar:function(t){const u=this.elements;return u[0]*=t,u[4]*=t,u[8]*=t,u[12]*=t,u[1]*=t,u[5]*=t,u[9]*=t,u[13]*=t,u[2]*=t,u[6]*=t,u[10]*=t,u[14]*=t,u[3]*=t,u[7]*=t,u[11]*=t,u[15]*=t,this},determinant:function(){const t=this.elements,u=t[0],m=t[4],g=t[8],E=t[12],I=t[1],V=t[5],J=t[9],Y=t[13],Z=t[2],me=t[6],S=t[10],e=t[14];return t[3]*(+E*J*me-g*Y*me-E*V*S+m*Y*S+g*V*e-m*J*e)+t[7]*(+u*J*e-u*Y*S+E*I*S-g*I*e+g*Y*Z-E*J*Z)+t[11]*(+u*Y*me-u*V*e-E*I*me+m*I*e+E*V*Z-m*Y*Z)+t[15]*(-g*V*Z-u*J*me+u*V*S+g*I*me-m*I*S+m*J*Z)},transpose:function(){const t=this.elements;let u;return u=t[1],t[1]=t[4],t[4]=u,u=t[2],t[2]=t[8],t[8]=u,u=t[6],t[6]=t[9],t[9]=u,u=t[3],t[3]=t[12],t[12]=u,u=t[7],t[7]=t[13],t[13]=u,u=t[11],t[11]=t[14],t[14]=u,this},setPosition:function(t,u,m){const g=this.elements;return t.isVector3?(g[12]=t.x,g[13]=t.y,g[14]=t.z):(g[12]=t,g[13]=u,g[14]=m),this},getInverse:function(t,u){void 0!==u&&console.warn("THREE.Matrix4: .getInverse() can no longer be configured to throw on degenerate.");const m=this.elements,g=t.elements,E=g[0],I=g[1],V=g[2],J=g[3],Y=g[4],Z=g[5],me=g[6],S=g[7],e=g[8],c=g[9],p=g[10],_=g[11],w=g[12],L=g[13],O=g[14],D=g[15],z=c*O*S-L*p*S+L*me*_-Z*O*_-c*me*D+Z*p*D,Q=w*p*S-e*O*S-w*me*_+Y*O*_+e*me*D-Y*p*D,ae=e*L*S-w*c*S+w*Z*_-Y*L*_-e*Z*D+Y*c*D,ie=w*c*me-e*L*me-w*Z*p+Y*L*p+e*Z*O-Y*c*O,he=E*z+I*Q+V*ae+J*ie;if(0===he)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const ye=1/he;return m[0]=z*ye,m[1]=(L*p*J-c*O*J-L*V*_+I*O*_+c*V*D-I*p*D)*ye,m[2]=(Z*O*J-L*me*J+L*V*S-I*O*S-Z*V*D+I*me*D)*ye,m[3]=(c*me*J-Z*p*J-c*V*S+I*p*S+Z*V*_-I*me*_)*ye,m[4]=Q*ye,m[5]=(e*O*J-w*p*J+w*V*_-E*O*_-e*V*D+E*p*D)*ye,m[6]=(w*me*J-Y*O*J-w*V*S+E*O*S+Y*V*D-E*me*D)*ye,m[7]=(Y*p*J-e*me*J+e*V*S-E*p*S-Y*V*_+E*me*_)*ye,m[8]=ae*ye,m[9]=(w*c*J-e*L*J-w*I*_+E*L*_+e*I*D-E*c*D)*ye,m[10]=(Y*L*J-w*Z*J+w*I*S-E*L*S-Y*I*D+E*Z*D)*ye,m[11]=(e*Z*J-Y*c*J-e*I*S+E*c*S+Y*I*_-E*Z*_)*ye,m[12]=ie*ye,m[13]=(e*L*V-w*c*V+w*I*p-E*L*p-e*I*O+E*c*O)*ye,m[14]=(w*Z*V-Y*L*V-w*I*me+E*L*me+Y*I*O-E*Z*O)*ye,m[15]=(Y*c*V-e*Z*V+e*I*me-E*c*me-Y*I*p+E*Z*p)*ye,this},scale:function(t){const u=this.elements,m=t.x,g=t.y,E=t.z;return u[0]*=m,u[4]*=g,u[8]*=E,u[1]*=m,u[5]*=g,u[9]*=E,u[2]*=m,u[6]*=g,u[10]*=E,u[3]*=m,u[7]*=g,u[11]*=E,this},getMaxScaleOnAxis:function(){const t=this.elements;return Math.sqrt(Math.max(t[0]*t[0]+t[1]*t[1]+t[2]*t[2],t[4]*t[4]+t[5]*t[5]+t[6]*t[6],t[8]*t[8]+t[9]*t[9]+t[10]*t[10]))},makeTranslation:function(t,u,m){return this.set(1,0,0,t,0,1,0,u,0,0,1,m,0,0,0,1),this},makeRotationX:function(t){const u=Math.cos(t),m=Math.sin(t);return this.set(1,0,0,0,0,u,-m,0,0,m,u,0,0,0,0,1),this},makeRotationY:function(t){const u=Math.cos(t),m=Math.sin(t);return this.set(u,0,m,0,0,1,0,0,-m,0,u,0,0,0,0,1),this},makeRotationZ:function(t){const u=Math.cos(t),m=Math.sin(t);return this.set(u,-m,0,0,m,u,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,u){const m=Math.cos(u),g=Math.sin(u),E=1-m,I=t.x,V=t.y,J=t.z,Y=E*I,Z=E*V;return this.set(Y*I+m,Y*V-g*J,Y*J+g*V,0,Y*V+g*J,Z*V+m,Z*J-g*I,0,Y*J-g*V,Z*J+g*I,E*J*J+m,0,0,0,0,1),this},makeScale:function(t,u,m){return this.set(t,0,0,0,0,u,0,0,0,0,m,0,0,0,0,1),this},makeShear:function(t,u,m){return this.set(1,u,m,0,t,1,m,0,t,u,1,0,0,0,0,1),this},compose:function(t,u,m){const g=this.elements,E=u._x,I=u._y,V=u._z,J=u._w,Y=E+E,Z=I+I,me=V+V,S=E*Y,e=E*Z,c=E*me,p=I*Z,_=I*me,w=V*me,L=J*Y,O=J*Z,D=J*me,z=m.x,Q=m.y,ae=m.z;return g[0]=(1-(p+w))*z,g[1]=(e+D)*z,g[2]=(c-O)*z,g[3]=0,g[4]=(e-D)*Q,g[5]=(1-(S+w))*Q,g[6]=(_+L)*Q,g[7]=0,g[8]=(c+O)*ae,g[9]=(_-L)*ae,g[10]=(1-(S+p))*ae,g[11]=0,g[12]=t.x,g[13]=t.y,g[14]=t.z,g[15]=1,this},decompose:function(t,u,m){const g=this.elements;let E=wl.set(g[0],g[1],g[2]).length(),I=wl.set(g[4],g[5],g[6]).length(),V=wl.set(g[8],g[9],g[10]).length();this.determinant()<0&&(E=-E),t.x=g[12],t.y=g[13],t.z=g[14],Ts.copy(this);const J=1/E,Y=1/I,Z=1/V;return Ts.elements[0]*=J,Ts.elements[1]*=J,Ts.elements[2]*=J,Ts.elements[4]*=Y,Ts.elements[5]*=Y,Ts.elements[6]*=Y,Ts.elements[8]*=Z,Ts.elements[9]*=Z,Ts.elements[10]*=Z,u.setFromRotationMatrix(Ts),m.x=E,m.y=I,m.z=V,this},makePerspective:function(t,u,m,g,E,I){void 0===I&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const V=this.elements,Y=2*E/(m-g),Z=(u+t)/(u-t),me=(m+g)/(m-g),S=-(I+E)/(I-E),e=-2*I*E/(I-E);return V[0]=2*E/(u-t),V[4]=0,V[8]=Z,V[12]=0,V[1]=0,V[5]=Y,V[9]=me,V[13]=0,V[2]=0,V[6]=0,V[10]=S,V[14]=e,V[3]=0,V[7]=0,V[11]=-1,V[15]=0,this},makeOrthographic:function(t,u,m,g,E,I){const V=this.elements,J=1/(u-t),Y=1/(m-g),Z=1/(I-E),me=(u+t)*J,S=(m+g)*Y,e=(I+E)*Z;return V[0]=2*J,V[4]=0,V[8]=0,V[12]=-me,V[1]=0,V[5]=2*Y,V[9]=0,V[13]=-S,V[2]=0,V[6]=0,V[10]=-2*Z,V[14]=-e,V[3]=0,V[7]=0,V[11]=0,V[15]=1,this},equals:function(t){const u=this.elements,m=t.elements;for(let g=0;g<16;g++)if(u[g]!==m[g])return!1;return!0},fromArray:function(t,u){void 0===u&&(u=0);for(let m=0;m<16;m++)this.elements[m]=t[m+u];return this},toArray:function(t,u){void 0===t&&(t=[]),void 0===u&&(u=0);const m=this.elements;return t[u]=m[0],t[u+1]=m[1],t[u+2]=m[2],t[u+3]=m[3],t[u+4]=m[4],t[u+5]=m[5],t[u+6]=m[6],t[u+7]=m[7],t[u+8]=m[8],t[u+9]=m[9],t[u+10]=m[10],t[u+11]=m[11],t[u+12]=m[12],t[u+13]=m[13],t[u+14]=m[14],t[u+15]=m[15],t}});const zc=new ti,Li=new yo;function lt(t=0,u=0,m=0,g=lt.DefaultOrder){this._x=t,this._y=u,this._z=m,this._order=g}function yu(){this.mask=1}lt.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],lt.DefaultOrder="XYZ",Object.defineProperties(lt.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this._onChangeCallback()}}}),Object.assign(lt.prototype,{isEuler:!0,set:function(t,u,m,g){return this._x=t,this._y=u,this._z=m,this._order=g||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this},setFromRotationMatrix:function(t,u,m){const g=rr.clamp,E=t.elements,I=E[0],V=E[4],J=E[8],Y=E[1],Z=E[5],me=E[9],S=E[2],e=E[6],c=E[10];switch(u=u||this._order){case"XYZ":this._y=Math.asin(g(J,-1,1)),Math.abs(J)<.9999999?(this._x=Math.atan2(-me,c),this._z=Math.atan2(-V,I)):(this._x=Math.atan2(e,Z),this._z=0);break;case"YXZ":this._x=Math.asin(-g(me,-1,1)),Math.abs(me)<.9999999?(this._y=Math.atan2(J,c),this._z=Math.atan2(Y,Z)):(this._y=Math.atan2(-S,I),this._z=0);break;case"ZXY":this._x=Math.asin(g(e,-1,1)),Math.abs(e)<.9999999?(this._y=Math.atan2(-S,c),this._z=Math.atan2(-V,Z)):(this._y=0,this._z=Math.atan2(Y,I));break;case"ZYX":this._y=Math.asin(-g(S,-1,1)),Math.abs(S)<.9999999?(this._x=Math.atan2(e,c),this._z=Math.atan2(Y,I)):(this._x=0,this._z=Math.atan2(-V,Z));break;case"YZX":this._z=Math.asin(g(Y,-1,1)),Math.abs(Y)<.9999999?(this._x=Math.atan2(-me,Z),this._y=Math.atan2(-S,I)):(this._x=0,this._y=Math.atan2(J,c));break;case"XZY":this._z=Math.asin(-g(V,-1,1)),Math.abs(V)<.9999999?(this._x=Math.atan2(e,Z),this._y=Math.atan2(J,I)):(this._x=Math.atan2(-me,c),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+u)}return this._order=u,!1!==m&&this._onChangeCallback(),this},setFromQuaternion:function(t,u,m){return zc.makeRotationFromQuaternion(t),this.setFromRotationMatrix(zc,u,m)},setFromVector3:function(t,u){return this.set(t.x,t.y,t.z,u||this._order)},reorder:function(t){return Li.setFromEuler(this),this.setFromQuaternion(Li,t)},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this._onChangeCallback(),this},toArray:function(t,u){return void 0===t&&(t=[]),void 0===u&&(u=0),t[u]=this._x,t[u+1]=this._y,t[u+2]=this._z,t[u+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new ot(this._x,this._y,this._z)},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}}),Object.assign(yu.prototype,{set:function(t){this.mask=1<<t},enable:function(t){this.mask|=1<<t},enableAll:function(){this.mask=-1},toggle:function(t){this.mask^=1<<t},disable:function(t){this.mask&=~(1<<t)},disableAll:function(){this.mask=0},test:function(t){return!!(this.mask&t.mask)}});let Mp=0;const Vi=new ot,kr=new yo,Wr=new ti,Oa=new ot,bo=new ot,oa=new ot,bu=new yo,pc=new ot(1,0,0),jc=new ot(0,1,0),xu=new ot(0,0,1),wh={type:"added"},dc={type:"removed"};function er(){Object.defineProperty(this,"id",{value:Mp++}),this.uuid=rr.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=er.DefaultUp.clone();const t=new ot,u=new lt,m=new yo,g=new ot(1,1,1);u._onChange(function(){m.setFromEuler(u,!1)}),m._onChange(function(){u.setFromQuaternion(m,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:u},quaternion:{configurable:!0,enumerable:!0,value:m},scale:{configurable:!0,enumerable:!0,value:g},modelViewMatrix:{value:new ti},normalMatrix:{value:new jo}}),this.matrix=new ti,this.matrixWorld=new ti,this.matrixAutoUpdate=er.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new yu,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function Sl(){er.call(this),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}er.DefaultUp=new ot(0,1,0),er.DefaultMatrixAutoUpdate=!0,er.prototype=Object.assign(Object.create(ia.prototype),{constructor:er,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,u){this.quaternion.setFromAxisAngle(t,u)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(t,u){return kr.setFromAxisAngle(t,u),this.quaternion.multiply(kr),this},rotateOnWorldAxis:function(t,u){return kr.setFromAxisAngle(t,u),this.quaternion.premultiply(kr),this},rotateX:function(t){return this.rotateOnAxis(pc,t)},rotateY:function(t){return this.rotateOnAxis(jc,t)},rotateZ:function(t){return this.rotateOnAxis(xu,t)},translateOnAxis:function(t,u){return Vi.copy(t).applyQuaternion(this.quaternion),this.position.add(Vi.multiplyScalar(u)),this},translateX:function(t){return this.translateOnAxis(pc,t)},translateY:function(t){return this.translateOnAxis(jc,t)},translateZ:function(t){return this.translateOnAxis(xu,t)},localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(t){return t.applyMatrix4(Wr.getInverse(this.matrixWorld))},lookAt:function(t,u,m){t.isVector3?Oa.copy(t):Oa.set(t,u,m);const g=this.parent;this.updateWorldMatrix(!0,!1),bo.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Wr.lookAt(bo,Oa,this.up):Wr.lookAt(Oa,bo,this.up),this.quaternion.setFromRotationMatrix(Wr),g&&(Wr.extractRotation(g.matrixWorld),kr.setFromRotationMatrix(Wr),this.quaternion.premultiply(kr.inverse()))},add:function(t){if(arguments.length>1){for(let u=0;u<arguments.length;u++)this.add(arguments[u]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(wh)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(arguments.length>1){for(let m=0;m<arguments.length;m++)this.remove(arguments[m]);return this}const u=this.children.indexOf(t);return-1!==u&&(t.parent=null,this.children.splice(u,1),t.dispatchEvent(dc)),this},attach:function(t){return this.updateWorldMatrix(!0,!1),Wr.getInverse(this.matrixWorld),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),Wr.multiply(t.parent.matrixWorld)),t.applyMatrix4(Wr),t.updateWorldMatrix(!1,!1),this.add(t),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,u){if(this[t]===u)return this;for(let m=0,g=this.children.length;m<g;m++){const E=this.children[m].getObjectByProperty(t,u);if(void 0!==E)return E}},getWorldPosition:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new ot),this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),t=new yo),this.updateMatrixWorld(!0),this.matrixWorld.decompose(bo,t,oa),t},getWorldScale:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),t=new ot),this.updateMatrixWorld(!0),this.matrixWorld.decompose(bo,bu,t),t},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),t=new ot),this.updateMatrixWorld(!0);const u=this.matrixWorld.elements;return t.set(u[8],u[9],u[10]).normalize()},raycast:function(){},traverse:function(t){t(this);const u=this.children;for(let m=0,g=u.length;m<g;m++)u[m].traverse(t)},traverseVisible:function(t){if(!1===this.visible)return;t(this);const u=this.children;for(let m=0,g=u.length;m<g;m++)u[m].traverseVisible(t)},traverseAncestors:function(t){const u=this.parent;null!==u&&(t(u),u.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const u=this.children;for(let m=0,g=u.length;m<g;m++)u[m].updateMatrixWorld(t)},updateWorldMatrix:function(t,u){const m=this.parent;if(!0===t&&null!==m&&m.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===u){const g=this.children;for(let E=0,I=g.length;E<I;E++)g[E].updateWorldMatrix(!1,!0)}},toJSON:function(t){const u=void 0===t||"string"==typeof t,m={};u&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{}},m.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const g={};function E(V,J){return void 0===V[J.uuid]&&(V[J.uuid]=J.toJSON(t)),J.uuid}if(g.uuid=this.uuid,g.type=this.type,""!==this.name&&(g.name=this.name),!0===this.castShadow&&(g.castShadow=!0),!0===this.receiveShadow&&(g.receiveShadow=!0),!1===this.visible&&(g.visible=!1),!1===this.frustumCulled&&(g.frustumCulled=!1),0!==this.renderOrder&&(g.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(g.userData=this.userData),g.layers=this.layers.mask,g.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(g.matrixAutoUpdate=!1),this.isInstancedMesh&&(g.type="InstancedMesh",g.count=this.count,g.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){g.geometry=E(t.geometries,this.geometry);const V=this.geometry.parameters;if(void 0!==V&&void 0!==V.shapes){const J=V.shapes;if(Array.isArray(J))for(let Y=0,Z=J.length;Y<Z;Y++)E(t.shapes,J[Y]);else E(t.shapes,J)}}if(void 0!==this.material)if(Array.isArray(this.material)){const V=[];for(let J=0,Y=this.material.length;J<Y;J++)V.push(E(t.materials,this.material[J]));g.material=V}else g.material=E(t.materials,this.material);if(this.children.length>0){g.children=[];for(let V=0;V<this.children.length;V++)g.children.push(this.children[V].toJSON(t).object)}if(u){const V=I(t.geometries),J=I(t.materials),Y=I(t.textures),Z=I(t.images),me=I(t.shapes);V.length>0&&(m.geometries=V),J.length>0&&(m.materials=J),Y.length>0&&(m.textures=Y),Z.length>0&&(m.images=Z),me.length>0&&(m.shapes=me)}return m.object=g,m;function I(V){const J=[];for(const Y in V){const Z=V[Y];delete Z.metadata,J.push(Z)}return J}},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,u){if(void 0===u&&(u=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===u)for(let m=0;m<t.children.length;m++)this.add(t.children[m].clone());return this}}),Sl.prototype=Object.assign(Object.create(er.prototype),{constructor:Sl,isScene:!0,copy:function(t,u){return er.prototype.copy.call(this,t,u),null!==t.background&&(this.background=t.background.clone()),null!==t.environment&&(this.environment=t.environment.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},toJSON:function(t){const u=er.prototype.toJSON.call(this,t);return null!==this.background&&(u.object.background=this.background.toJSON(t)),null!==this.environment&&(u.object.environment=this.environment.toJSON(t)),null!==this.fog&&(u.object.fog=this.fog.toJSON()),u},dispose:function(){this.dispatchEvent({type:"dispose"})}});const ka=[new ot,new ot,new ot,new ot,new ot,new ot,new ot,new ot],ya=new ot,Hl=new _n,wu=new ot,ba=new ot,xo=new ot,Os=new ot,mc=new ot,tt=new ot,bt=new ot,kt=new ot,vn=new ot,qt=new ot;function _n(t,u){this.min=void 0!==t?t:new ot(1/0,1/0,1/0),this.max=void 0!==u?u:new ot(-1/0,-1/0,-1/0)}function Qt(t,u,m,g,E){for(let I=0,V=t.length-3;I<=V;I+=3){qt.fromArray(t,I);const J=E.x*Math.abs(qt.x)+E.y*Math.abs(qt.y)+E.z*Math.abs(qt.z),Y=u.dot(qt),Z=m.dot(qt),me=g.dot(qt);if(Math.max(-Math.max(Y,Z,me),Math.min(Y,Z,me))>J)return!1}return!0}Object.assign(_n.prototype,{isBox3:!0,set:function(t,u){return this.min.copy(t),this.max.copy(u),this},setFromArray:function(t){let u=1/0,m=1/0,g=1/0,E=-1/0,I=-1/0,V=-1/0;for(let J=0,Y=t.length;J<Y;J+=3){const Z=t[J],me=t[J+1],S=t[J+2];Z<u&&(u=Z),me<m&&(m=me),S<g&&(g=S),Z>E&&(E=Z),me>I&&(I=me),S>V&&(V=S)}return this.min.set(u,m,g),this.max.set(E,I,V),this},setFromBufferAttribute:function(t){let u=1/0,m=1/0,g=1/0,E=-1/0,I=-1/0,V=-1/0;for(let J=0,Y=t.count;J<Y;J++){const Z=t.getX(J),me=t.getY(J),S=t.getZ(J);Z<u&&(u=Z),me<m&&(m=me),S<g&&(g=S),Z>E&&(E=Z),me>I&&(I=me),S>V&&(V=S)}return this.min.set(u,m,g),this.max.set(E,I,V),this},setFromPoints:function(t){this.makeEmpty();for(let u=0,m=t.length;u<m;u++)this.expandByPoint(t[u]);return this},setFromCenterAndSize:function(t,u){const m=ya.copy(u).multiplyScalar(.5);return this.min.copy(t).sub(m),this.max.copy(t).add(m),this},setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new ot),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new ot),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:function(t){t.updateWorldMatrix(!1,!1);const u=t.geometry;void 0!==u&&(null===u.boundingBox&&u.computeBoundingBox(),Hl.copy(u.boundingBox),Hl.applyMatrix4(t.matrixWorld),this.union(Hl));const m=t.children;for(let g=0,E=m.length;g<E;g++)this.expandByObject(m[g]);return this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,u){return void 0===u&&(console.warn("THREE.Box3: .getParameter() target is now required"),u=new ot),u.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(t){return this.clampPoint(t.center,ya),ya.distanceToSquared(t.center)<=t.radius*t.radius},intersectsPlane:function(t){let u,m;return t.normal.x>0?(u=t.normal.x*this.min.x,m=t.normal.x*this.max.x):(u=t.normal.x*this.max.x,m=t.normal.x*this.min.x),t.normal.y>0?(u+=t.normal.y*this.min.y,m+=t.normal.y*this.max.y):(u+=t.normal.y*this.max.y,m+=t.normal.y*this.min.y),t.normal.z>0?(u+=t.normal.z*this.min.z,m+=t.normal.z*this.max.z):(u+=t.normal.z*this.max.z,m+=t.normal.z*this.min.z),u<=-t.constant&&m>=-t.constant},intersectsTriangle:function(t){if(this.isEmpty())return!1;this.getCenter(bt),kt.subVectors(this.max,bt),wu.subVectors(t.a,bt),ba.subVectors(t.b,bt),xo.subVectors(t.c,bt),Os.subVectors(ba,wu),mc.subVectors(xo,ba),tt.subVectors(wu,xo);let u=[0,-Os.z,Os.y,0,-mc.z,mc.y,0,-tt.z,tt.y,Os.z,0,-Os.x,mc.z,0,-mc.x,tt.z,0,-tt.x,-Os.y,Os.x,0,-mc.y,mc.x,0,-tt.y,tt.x,0];return!!Qt(u,wu,ba,xo,kt)&&(u=[1,0,0,0,1,0,0,0,1],!!Qt(u,wu,ba,xo,kt)&&(vn.crossVectors(Os,mc),u=[vn.x,vn.y,vn.z],Qt(u,wu,ba,xo,kt)))},clampPoint:function(t,u){return void 0===u&&(console.warn("THREE.Box3: .clampPoint() target is now required"),u=new ot),u.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return ya.copy(t).clamp(this.min,this.max).sub(t).length()},getBoundingSphere:function(t){return void 0===t&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(t.center),t.radius=.5*this.getSize(ya).length(),t},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(t){return this.isEmpty()||(ka[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),ka[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),ka[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),ka[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),ka[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),ka[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),ka[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),ka[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(ka)),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}});const Jn=new _n;function zn(t,u){this.center=void 0!==t?t:new ot,this.radius=void 0!==u?u:-1}Object.assign(zn.prototype,{set:function(t,u){return this.center.copy(t),this.radius=u,this},setFromPoints:function(t,u){const m=this.center;void 0!==u?m.copy(u):Jn.setFromPoints(t).getCenter(m);let g=0;for(let E=0,I=t.length;E<I;E++)g=Math.max(g,m.distanceToSquared(t[E]));return this.radius=Math.sqrt(g),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},isEmpty:function(){return this.radius<0},makeEmpty:function(){return this.center.set(0,0,0),this.radius=-1,this},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){const u=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=u*u},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},clampPoint:function(t,u){const m=this.center.distanceToSquared(t);return void 0===u&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),u=new ot),u.copy(t),m>this.radius*this.radius&&(u.sub(this.center).normalize(),u.multiplyScalar(this.radius).add(this.center)),u},getBoundingBox:function(t){return void 0===t&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),t=new _n),this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}});const Sr=new ot,$r=new ot,yr=new ot,qr=new ot,hi=new ot,Rr=new ot,es=new ot;function co(t,u){this.origin=void 0!==t?t:new ot,this.direction=void 0!==u?u:new ot(0,0,-1)}Object.assign(co.prototype,{set:function(t,u){return this.origin.copy(t),this.direction.copy(u),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,u){return void 0===u&&(console.warn("THREE.Ray: .at() target is now required"),u=new ot),u.copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(t){return this.origin.copy(this.at(t,Sr)),this},closestPointToPoint:function(t,u){void 0===u&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),u=new ot),u.subVectors(t,this.origin);const m=u.dot(this.direction);return m<0?u.copy(this.origin):u.copy(this.direction).multiplyScalar(m).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(t){const u=Sr.subVectors(t,this.origin).dot(this.direction);return u<0?this.origin.distanceToSquared(t):(Sr.copy(this.direction).multiplyScalar(u).add(this.origin),Sr.distanceToSquared(t))},distanceSqToSegment:function(t,u,m,g){$r.copy(t).add(u).multiplyScalar(.5),yr.copy(u).sub(t).normalize(),qr.copy(this.origin).sub($r);const E=.5*t.distanceTo(u),I=-this.direction.dot(yr),V=qr.dot(this.direction),J=-qr.dot(yr),Y=qr.lengthSq(),Z=Math.abs(1-I*I);let me,S,e,c;if(Z>0)if(me=I*J-V,S=I*V-J,c=E*Z,me>=0)if(S>=-c)if(S<=c){const p=1/Z;me*=p,S*=p,e=me*(me+I*S+2*V)+S*(I*me+S+2*J)+Y}else S=E,me=Math.max(0,-(I*S+V)),e=-me*me+S*(S+2*J)+Y;else S=-E,me=Math.max(0,-(I*S+V)),e=-me*me+S*(S+2*J)+Y;else S<=-c?(me=Math.max(0,-(-I*E+V)),S=me>0?-E:Math.min(Math.max(-E,-J),E),e=-me*me+S*(S+2*J)+Y):S<=c?(me=0,S=Math.min(Math.max(-E,-J),E),e=S*(S+2*J)+Y):(me=Math.max(0,-(I*E+V)),S=me>0?E:Math.min(Math.max(-E,-J),E),e=-me*me+S*(S+2*J)+Y);else S=I>0?-E:E,me=Math.max(0,-(I*S+V)),e=-me*me+S*(S+2*J)+Y;return m&&m.copy(this.direction).multiplyScalar(me).add(this.origin),g&&g.copy(yr).multiplyScalar(S).add($r),e},intersectSphere:function(t,u){Sr.subVectors(t.center,this.origin);const m=Sr.dot(this.direction),g=Sr.dot(Sr)-m*m,E=t.radius*t.radius;if(g>E)return null;const I=Math.sqrt(E-g),V=m-I,J=m+I;return V<0&&J<0?null:this.at(V<0?J:V,u)},intersectsSphere:function(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius},distanceToPlane:function(t){const u=t.normal.dot(this.direction);if(0===u)return 0===t.distanceToPoint(this.origin)?0:null;const m=-(this.origin.dot(t.normal)+t.constant)/u;return m>=0?m:null},intersectPlane:function(t,u){const m=this.distanceToPlane(t);return null===m?null:this.at(m,u)},intersectsPlane:function(t){const u=t.distanceToPoint(this.origin);return 0===u||t.normal.dot(this.direction)*u<0},intersectBox:function(t,u){let m,g,E,I,V,J;const Y=1/this.direction.x,Z=1/this.direction.y,me=1/this.direction.z,S=this.origin;return Y>=0?(m=(t.min.x-S.x)*Y,g=(t.max.x-S.x)*Y):(m=(t.max.x-S.x)*Y,g=(t.min.x-S.x)*Y),Z>=0?(E=(t.min.y-S.y)*Z,I=(t.max.y-S.y)*Z):(E=(t.max.y-S.y)*Z,I=(t.min.y-S.y)*Z),m>I||E>g?null:((E>m||m!=m)&&(m=E),(I<g||g!=g)&&(g=I),me>=0?(V=(t.min.z-S.z)*me,J=(t.max.z-S.z)*me):(V=(t.max.z-S.z)*me,J=(t.min.z-S.z)*me),m>J||V>g?null:((V>m||m!=m)&&(m=V),(J<g||g!=g)&&(g=J),g<0?null:this.at(m>=0?m:g,u)))},intersectsBox:function(t){return null!==this.intersectBox(t,Sr)},intersectTriangle:function(t,u,m,g,E){hi.subVectors(u,t),Rr.subVectors(m,t),es.crossVectors(hi,Rr);let I,V=this.direction.dot(es);if(V>0){if(g)return null;I=1}else{if(!(V<0))return null;I=-1,V=-V}qr.subVectors(this.origin,t);const J=I*this.direction.dot(Rr.crossVectors(qr,Rr));if(J<0)return null;const Y=I*this.direction.dot(hi.cross(qr));if(Y<0||J+Y>V)return null;const Z=-I*qr.dot(es);return Z<0?null:this.at(Z/V,E)},applyMatrix4:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}});const qs=new ot,No=new ot,Vl=new jo;function Wo(t,u){this.normal=void 0!==t?t:new ot(1,0,0),this.constant=void 0!==u?u:0}Object.assign(Wo.prototype,{isPlane:!0,set:function(t,u){return this.normal.copy(t),this.constant=u,this},setComponents:function(t,u,m,g){return this.normal.set(t,u,m),this.constant=g,this},setFromNormalAndCoplanarPoint:function(t,u){return this.normal.copy(t),this.constant=-u.dot(this.normal),this},setFromCoplanarPoints:function(t,u,m){const g=qs.subVectors(m,u).cross(No.subVectors(t,u)).normalize();return this.setFromNormalAndCoplanarPoint(g,t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,u){return void 0===u&&(console.warn("THREE.Plane: .projectPoint() target is now required"),u=new ot),u.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},intersectLine:function(t,u){void 0===u&&(console.warn("THREE.Plane: .intersectLine() target is now required"),u=new ot);const m=t.delta(qs),g=this.normal.dot(m);if(0===g)return 0===this.distanceToPoint(t.start)?u.copy(t.start):void 0;const E=-(t.start.dot(this.normal)+this.constant)/g;return E<0||E>1?void 0:u.copy(m).multiplyScalar(E).add(t.start)},intersectsLine:function(t){const u=this.distanceToPoint(t.start),m=this.distanceToPoint(t.end);return u<0&&m>0||m<0&&u>0},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return void 0===t&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),t=new ot),t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(t,u){const m=u||Vl.getNormalMatrix(t),g=this.coplanarPoint(qs).applyMatrix4(t),E=this.normal.applyMatrix3(m).normalize();return this.constant=-g.dot(E),this},translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}});const Ji=new ot,_c=new ot,Qh=new ot,Zu=new ot,Ap=new ot,Sh=new ot,bd=new ot,Eh=new ot,zd=new ot,xd=new ot;function Ir(t,u,m){this.a=void 0!==t?t:new ot,this.b=void 0!==u?u:new ot,this.c=void 0!==m?m:new ot}Object.assign(Ir,{getNormal:function(t,u,m,g){void 0===g&&(console.warn("THREE.Triangle: .getNormal() target is now required"),g=new ot),g.subVectors(m,u),Ji.subVectors(t,u),g.cross(Ji);const E=g.lengthSq();return E>0?g.multiplyScalar(1/Math.sqrt(E)):g.set(0,0,0)},getBarycoord:function(t,u,m,g,E){Ji.subVectors(g,u),_c.subVectors(m,u),Qh.subVectors(t,u);const I=Ji.dot(Ji),V=Ji.dot(_c),J=Ji.dot(Qh),Y=_c.dot(_c),Z=_c.dot(Qh),me=I*Y-V*V;if(void 0===E&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),E=new ot),0===me)return E.set(-2,-1,-1);const S=1/me,e=(Y*J-V*Z)*S,c=(I*Z-V*J)*S;return E.set(1-e-c,c,e)},containsPoint:function(t,u,m,g){return Ir.getBarycoord(t,u,m,g,Zu),Zu.x>=0&&Zu.y>=0&&Zu.x+Zu.y<=1},getUV:function(t,u,m,g,E,I,V,J){return this.getBarycoord(t,u,m,g,Zu),J.set(0,0),J.addScaledVector(E,Zu.x),J.addScaledVector(I,Zu.y),J.addScaledVector(V,Zu.z),J},isFrontFacing:function(t,u,m,g){return Ji.subVectors(m,u),_c.subVectors(t,u),Ji.cross(_c).dot(g)<0}}),Object.assign(Ir.prototype,{set:function(t,u,m){return this.a.copy(t),this.b.copy(u),this.c.copy(m),this},setFromPointsAndIndices:function(t,u,m,g){return this.a.copy(t[u]),this.b.copy(t[m]),this.c.copy(t[g]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},getArea:function(){return Ji.subVectors(this.c,this.b),_c.subVectors(this.a,this.b),.5*Ji.cross(_c).length()},getMidpoint:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),t=new ot),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(.3333333333333333)},getNormal:function(t){return Ir.getNormal(this.a,this.b,this.c,t)},getPlane:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getPlane() target is now required"),t=new Wo),t.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(t,u){return Ir.getBarycoord(t,this.a,this.b,this.c,u)},getUV:function(t,u,m,g,E){return Ir.getUV(t,this.a,this.b,this.c,u,m,g,E)},containsPoint:function(t){return Ir.containsPoint(t,this.a,this.b,this.c)},isFrontFacing:function(t){return Ir.isFrontFacing(this.a,this.b,this.c,t)},intersectsBox:function(t){return t.intersectsTriangle(this)},closestPointToPoint:function(t,u){void 0===u&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),u=new ot);const m=this.a,g=this.b,E=this.c;let I,V;Ap.subVectors(g,m),Sh.subVectors(E,m),Eh.subVectors(t,m);const J=Ap.dot(Eh),Y=Sh.dot(Eh);if(J<=0&&Y<=0)return u.copy(m);zd.subVectors(t,g);const Z=Ap.dot(zd),me=Sh.dot(zd);if(Z>=0&&me<=Z)return u.copy(g);const S=J*me-Z*Y;if(S<=0&&J>=0&&Z<=0)return I=J/(J-Z),u.copy(m).addScaledVector(Ap,I);xd.subVectors(t,E);const e=Ap.dot(xd),c=Sh.dot(xd);if(c>=0&&e<=c)return u.copy(E);const p=e*Y-J*c;if(p<=0&&Y>=0&&c<=0)return V=Y/(Y-c),u.copy(m).addScaledVector(Sh,V);const _=Z*c-e*me;if(_<=0&&me-Z>=0&&e-c>=0)return bd.subVectors(E,g),V=(me-Z)/(me-Z+(e-c)),u.copy(g).addScaledVector(bd,V);const w=1/(_+p+S);return I=p*w,V=S*w,u.copy(m).addScaledVector(Ap,I).addScaledVector(Sh,V)},equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}});const vc={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Xs={h:0,s:0,l:0},$p={h:0,s:0,l:0};function lr(t,u,m){return void 0===u&&void 0===m?this.set(t):this.setRGB(t,u,m)}function El(t,u,m){return m<0&&(m+=1),m>1&&(m-=1),m<.16666666666666666?t+6*(u-t)*m:m<.5?u:m<.6666666666666666?t+6*(u-t)*(.6666666666666666-m):t}function Th(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function Kh(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}function sa(t,u,m,g,E,I){this.a=t,this.b=u,this.c=m,this.normal=g&&g.isVector3?g:new ot,this.vertexNormals=Array.isArray(g)?g:[],this.color=E&&E.isColor?E:new lr,this.vertexColors=Array.isArray(E)?E:[],this.materialIndex=void 0!==I?I:0}Object.assign(lr.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){return this.r=t,this.g=t,this.b=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,u,m){return this.r=t,this.g=u,this.b=m,this},setHSL:function(t,u,m){if(t=rr.euclideanModulo(t,1),u=rr.clamp(u,0,1),m=rr.clamp(m,0,1),0===u)this.r=this.g=this.b=m;else{const g=m<=.5?m*(1+u):m+u-m*u,E=2*m-g;this.r=El(E,g,t+.3333333333333333),this.g=El(E,g,t),this.b=El(E,g,t-.3333333333333333)}return this},setStyle:function(t){function u(g){void 0!==g&&parseFloat(g)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let m;if(m=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){let g;const I=m[2];switch(m[1]){case"rgb":case"rgba":if(g=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(I))return this.r=Math.min(255,parseInt(g[1],10))/255,this.g=Math.min(255,parseInt(g[2],10))/255,this.b=Math.min(255,parseInt(g[3],10))/255,u(g[5]),this;if(g=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(I))return this.r=Math.min(100,parseInt(g[1],10))/100,this.g=Math.min(100,parseInt(g[2],10))/100,this.b=Math.min(100,parseInt(g[3],10))/100,u(g[5]),this;break;case"hsl":case"hsla":if(g=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(I)){const V=parseFloat(g[1])/360,J=parseInt(g[2],10)/100,Y=parseInt(g[3],10)/100;return u(g[5]),this.setHSL(V,J,Y)}}}else if(m=/^\#([A-Fa-f0-9]+)$/.exec(t)){const g=m[1],E=g.length;if(3===E)return this.r=parseInt(g.charAt(0)+g.charAt(0),16)/255,this.g=parseInt(g.charAt(1)+g.charAt(1),16)/255,this.b=parseInt(g.charAt(2)+g.charAt(2),16)/255,this;if(6===E)return this.r=parseInt(g.charAt(0)+g.charAt(1),16)/255,this.g=parseInt(g.charAt(2)+g.charAt(3),16)/255,this.b=parseInt(g.charAt(4)+g.charAt(5),16)/255,this}return t&&t.length>0?this.setColorName(t):this},setColorName:function(t){const u=vc[t];return void 0!==u?this.setHex(u):console.warn("THREE.Color: Unknown color "+t),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,u){return void 0===u&&(u=2),this.r=Math.pow(t.r,u),this.g=Math.pow(t.g,u),this.b=Math.pow(t.b,u),this},copyLinearToGamma:function(t,u){void 0===u&&(u=2);const m=u>0?1/u:1;return this.r=Math.pow(t.r,m),this.g=Math.pow(t.g,m),this.b=Math.pow(t.b,m),this},convertGammaToLinear:function(t){return this.copyGammaToLinear(this,t),this},convertLinearToGamma:function(t){return this.copyLinearToGamma(this,t),this},copySRGBToLinear:function(t){return this.r=Th(t.r),this.g=Th(t.g),this.b=Th(t.b),this},copyLinearToSRGB:function(t){return this.r=Kh(t.r),this.g=Kh(t.g),this.b=Kh(t.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){void 0===t&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});const u=this.r,m=this.g,g=this.b,E=Math.max(u,m,g),I=Math.min(u,m,g);let V,J;const Y=(I+E)/2;if(I===E)V=0,J=0;else{const Z=E-I;switch(J=Y<=.5?Z/(E+I):Z/(2-E-I),E){case u:V=(m-g)/Z+(m<g?6:0);break;case m:V=(g-u)/Z+2;break;case g:V=(u-m)/Z+4}V/=6}return t.h=V,t.s=J,t.l=Y,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,u,m){return this.getHSL(Xs),Xs.h+=t,Xs.s+=u,Xs.l+=m,this.setHSL(Xs.h,Xs.s,Xs.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,u){return this.r=t.r+u.r,this.g=t.g+u.g,this.b=t.b+u.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,u){return this.r+=(t.r-this.r)*u,this.g+=(t.g-this.g)*u,this.b+=(t.b-this.b)*u,this},lerpHSL:function(t,u){this.getHSL(Xs),t.getHSL($p);const m=rr.lerp(Xs.h,$p.h,u),g=rr.lerp(Xs.s,$p.s,u),E=rr.lerp(Xs.l,$p.l,u);return this.setHSL(m,g,E),this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,u){return void 0===u&&(u=0),this.r=t[u],this.g=t[u+1],this.b=t[u+2],this},toArray:function(t,u){return void 0===t&&(t=[]),void 0===u&&(u=0),t[u]=this.r,t[u+1]=this.g,t[u+2]=this.b,t},fromBufferAttribute:function(t,u){return this.r=t.getX(u),this.g=t.getY(u),this.b=t.getZ(u),!0===t.normalized&&(this.r/=255,this.g/=255,this.b/=255),this},toJSON:function(){return this.getHex()}}),lr.NAMES=vc,Object.assign(sa.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(let u=0,m=t.vertexNormals.length;u<m;u++)this.vertexNormals[u]=t.vertexNormals[u].clone();for(let u=0,m=t.vertexColors.length;u<m;u++)this.vertexColors[u]=t.vertexColors[u].clone();return this}});let wd=0;function Ur(){Object.defineProperty(this,"id",{value:wd++}),this.uuid=rr.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=ee,this.side=_e,this.flatShading=!1,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=Ft,this.blendDst=Ot,this.blendEquation=Ae,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=ur,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=na,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Ve,this.stencilZFail=Ve,this.stencilZPass=Ve,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}function eo(t){Ur.call(this),this.type="MeshBasicMaterial",this.color=new lr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Jr,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(t)}Ur.prototype=Object.assign(Object.create(ia.prototype),{constructor:Ur,isMaterial:!0,onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(t){if(void 0!==t)for(const u in t){const m=t[u];if(void 0===m){console.warn("THREE.Material: '"+u+"' parameter is undefined.");continue}if("shading"===u){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=m===T;continue}const g=this[u];void 0!==g?g&&g.isColor?g.set(m):g&&g.isVector3&&m&&m.isVector3?g.copy(m):this[u]=m:console.warn("THREE."+this.type+": '"+u+"' is not a property of this material.")}},toJSON:function(t){const u=void 0===t||"string"==typeof t;u&&(t={textures:{},images:{}});const m={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function g(E){const I=[];for(const V in E){const J=E[V];delete J.metadata,I.push(J)}return I}if(m.uuid=this.uuid,m.type=this.type,""!==this.name&&(m.name=this.name),this.color&&this.color.isColor&&(m.color=this.color.getHex()),void 0!==this.roughness&&(m.roughness=this.roughness),void 0!==this.metalness&&(m.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(m.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(m.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(m.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(m.specular=this.specular.getHex()),void 0!==this.shininess&&(m.shininess=this.shininess),void 0!==this.clearcoat&&(m.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(m.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(m.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(m.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(m.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,m.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(m.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(m.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(m.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(m.lightMap=this.lightMap.toJSON(t).uuid),this.aoMap&&this.aoMap.isTexture&&(m.aoMap=this.aoMap.toJSON(t).uuid,m.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(m.bumpMap=this.bumpMap.toJSON(t).uuid,m.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(m.normalMap=this.normalMap.toJSON(t).uuid,m.normalMapType=this.normalMapType,m.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(m.displacementMap=this.displacementMap.toJSON(t).uuid,m.displacementScale=this.displacementScale,m.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(m.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(m.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(m.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(m.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(m.envMap=this.envMap.toJSON(t).uuid,m.reflectivity=this.reflectivity,m.refractionRatio=this.refractionRatio,void 0!==this.combine&&(m.combine=this.combine),void 0!==this.envMapIntensity&&(m.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(m.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.size&&(m.size=this.size),void 0!==this.sizeAttenuation&&(m.sizeAttenuation=this.sizeAttenuation),this.blending!==ee&&(m.blending=this.blending),!0===this.flatShading&&(m.flatShading=this.flatShading),this.side!==_e&&(m.side=this.side),this.vertexColors&&(m.vertexColors=!0),this.opacity<1&&(m.opacity=this.opacity),!0===this.transparent&&(m.transparent=this.transparent),m.depthFunc=this.depthFunc,m.depthTest=this.depthTest,m.depthWrite=this.depthWrite,m.stencilWrite=this.stencilWrite,m.stencilWriteMask=this.stencilWriteMask,m.stencilFunc=this.stencilFunc,m.stencilRef=this.stencilRef,m.stencilFuncMask=this.stencilFuncMask,m.stencilFail=this.stencilFail,m.stencilZFail=this.stencilZFail,m.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(m.rotation=this.rotation),!0===this.polygonOffset&&(m.polygonOffset=!0),0!==this.polygonOffsetFactor&&(m.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(m.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(m.linewidth=this.linewidth),void 0!==this.dashSize&&(m.dashSize=this.dashSize),void 0!==this.gapSize&&(m.gapSize=this.gapSize),void 0!==this.scale&&(m.scale=this.scale),!0===this.dithering&&(m.dithering=!0),this.alphaTest>0&&(m.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(m.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(m.wireframe=this.wireframe),this.wireframeLinewidth>1&&(m.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(m.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(m.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(m.morphTargets=!0),!0===this.morphNormals&&(m.morphNormals=!0),!0===this.skinning&&(m.skinning=!0),!1===this.visible&&(m.visible=!1),!1===this.toneMapped&&(m.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(m.userData=this.userData),u){const E=g(t.textures),I=g(t.images);E.length>0&&(m.textures=E),I.length>0&&(m.images=I)}return m},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const u=t.clippingPlanes;let m=null;if(null!==u){const g=u.length;m=new Array(g);for(let E=0;E!==g;++E)m[E]=u[E].clone()}return this.clippingPlanes=m,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(Ur.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),(eo.prototype=Object.create(Ur.prototype)).constructor=eo,eo.prototype.isMeshBasicMaterial=!0,eo.prototype.copy=function(t){return Ur.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this};const Ro=new ot,As=new wn;function Gr(t,u,m){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=u,this.count=void 0!==t?t.length/u:0,this.normalized=!0===m,this.usage=_i,this.updateRange={offset:0,count:-1},this.version=0}function tl(t,u,m){Gr.call(this,new Int8Array(t),u,m)}function yc(t,u,m){Gr.call(this,new Uint8Array(t),u,m)}function Qu(t,u,m){Gr.call(this,new Uint8ClampedArray(t),u,m)}function ep(t,u,m){Gr.call(this,new Int16Array(t),u,m)}function Tl(t,u,m){Gr.call(this,new Uint16Array(t),u,m)}function tr(t,u,m){Gr.call(this,new Int32Array(t),u,m)}function nl(t,u,m){Gr.call(this,new Uint32Array(t),u,m)}function Fn(t,u,m){Gr.call(this,new Float32Array(t),u,m)}function Ml(t,u,m){Gr.call(this,new Float64Array(t),u,m)}function zi(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function jd(t){if(0===t.length)return-1/0;let u=t[0];for(let m=1,g=t.length;m<g;++m)t[m]>u&&(u=t[m]);return u}Object.defineProperty(Gr.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(Gr.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this},copyAt:function(t,u,m){t*=this.itemSize,m*=u.itemSize;for(let g=0,E=this.itemSize;g<E;g++)this.array[t+g]=u.array[m+g];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){const u=this.array;let m=0;for(let g=0,E=t.length;g<E;g++){let I=t[g];void 0===I&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",g),I=new lr),u[m++]=I.r,u[m++]=I.g,u[m++]=I.b}return this},copyVector2sArray:function(t){const u=this.array;let m=0;for(let g=0,E=t.length;g<E;g++){let I=t[g];void 0===I&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",g),I=new wn),u[m++]=I.x,u[m++]=I.y}return this},copyVector3sArray:function(t){const u=this.array;let m=0;for(let g=0,E=t.length;g<E;g++){let I=t[g];void 0===I&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",g),I=new ot),u[m++]=I.x,u[m++]=I.y,u[m++]=I.z}return this},copyVector4sArray:function(t){const u=this.array;let m=0;for(let g=0,E=t.length;g<E;g++){let I=t[g];void 0===I&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",g),I=new gi),u[m++]=I.x,u[m++]=I.y,u[m++]=I.z,u[m++]=I.w}return this},applyMatrix3:function(t){if(2===this.itemSize)for(let u=0,m=this.count;u<m;u++)As.fromBufferAttribute(this,u),As.applyMatrix3(t),this.setXY(u,As.x,As.y);else if(3===this.itemSize)for(let u=0,m=this.count;u<m;u++)Ro.fromBufferAttribute(this,u),Ro.applyMatrix3(t),this.setXYZ(u,Ro.x,Ro.y,Ro.z);return this},applyMatrix4:function(t){for(let u=0,m=this.count;u<m;u++)Ro.x=this.getX(u),Ro.y=this.getY(u),Ro.z=this.getZ(u),Ro.applyMatrix4(t),this.setXYZ(u,Ro.x,Ro.y,Ro.z);return this},applyNormalMatrix:function(t){for(let u=0,m=this.count;u<m;u++)Ro.x=this.getX(u),Ro.y=this.getY(u),Ro.z=this.getZ(u),Ro.applyNormalMatrix(t),this.setXYZ(u,Ro.x,Ro.y,Ro.z);return this},transformDirection:function(t){for(let u=0,m=this.count;u<m;u++)Ro.x=this.getX(u),Ro.y=this.getY(u),Ro.z=this.getZ(u),Ro.transformDirection(t),this.setXYZ(u,Ro.x,Ro.y,Ro.z);return this},set:function(t,u){return void 0===u&&(u=0),this.array.set(t,u),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,u){return this.array[t*this.itemSize]=u,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,u){return this.array[t*this.itemSize+1]=u,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,u){return this.array[t*this.itemSize+2]=u,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,u){return this.array[t*this.itemSize+3]=u,this},setXY:function(t,u,m){return this.array[0+(t*=this.itemSize)]=u,this.array[t+1]=m,this},setXYZ:function(t,u,m,g){return this.array[0+(t*=this.itemSize)]=u,this.array[t+1]=m,this.array[t+2]=g,this},setXYZW:function(t,u,m,g,E){return this.array[0+(t*=this.itemSize)]=u,this.array[t+1]=m,this.array[t+2]=g,this.array[t+3]=E,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),(tl.prototype=Object.create(Gr.prototype)).constructor=tl,(yc.prototype=Object.create(Gr.prototype)).constructor=yc,(Qu.prototype=Object.create(Gr.prototype)).constructor=Qu,(ep.prototype=Object.create(Gr.prototype)).constructor=ep,(Tl.prototype=Object.create(Gr.prototype)).constructor=Tl,(tr.prototype=Object.create(Gr.prototype)).constructor=tr,(nl.prototype=Object.create(Gr.prototype)).constructor=nl,(Fn.prototype=Object.create(Gr.prototype)).constructor=Fn,(Ml.prototype=Object.create(Gr.prototype)).constructor=Ml,Object.assign(zi.prototype,{computeGroups:function(t){const u=[];let m,g,E;const I=t.faces;for(g=0;g<I.length;g++){const V=I[g];V.materialIndex!==E&&(E=V.materialIndex,void 0!==m&&(m.count=3*g-m.start,u.push(m)),m={start:3*g,materialIndex:E})}void 0!==m&&(m.count=3*g-m.start,u.push(m)),this.groups=u},fromGeometry:function(t){const u=t.faces,m=t.vertices,g=t.faceVertexUvs,E=g[0]&&g[0].length>0,I=g[1]&&g[1].length>0,V=t.morphTargets,J=V.length;let Y;if(J>0){Y=[];for(let w=0;w<J;w++)Y[w]={name:V[w].name,data:[]};this.morphTargets.position=Y}const Z=t.morphNormals,me=Z.length;let S;if(me>0){S=[];for(let w=0;w<me;w++)S[w]={name:Z[w].name,data:[]};this.morphTargets.normal=S}const e=t.skinIndices,c=t.skinWeights,p=e.length===m.length,_=c.length===m.length;m.length>0&&0===u.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(let w=0;w<u.length;w++){const L=u[w];this.vertices.push(m[L.a],m[L.b],m[L.c]);const O=L.vertexNormals;if(3===O.length)this.normals.push(O[0],O[1],O[2]);else{const z=L.normal;this.normals.push(z,z,z)}const D=L.vertexColors;if(3===D.length)this.colors.push(D[0],D[1],D[2]);else{const z=L.color;this.colors.push(z,z,z)}if(!0===E){const z=g[0][w];void 0!==z?this.uvs.push(z[0],z[1],z[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",w),this.uvs.push(new wn,new wn,new wn))}if(!0===I){const z=g[1][w];void 0!==z?this.uvs2.push(z[0],z[1],z[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",w),this.uvs2.push(new wn,new wn,new wn))}for(let z=0;z<J;z++){const Q=V[z].vertices;Y[z].data.push(Q[L.a],Q[L.b],Q[L.c])}for(let z=0;z<me;z++){const Q=Z[z].vertexNormals[w];S[z].data.push(Q.a,Q.b,Q.c)}p&&this.skinIndices.push(e[L.a],e[L.b],e[L.c]),_&&this.skinWeights.push(c[L.a],c[L.b],c[L.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this}});let Cp=1;const xa=new ti,Ku=new er,eh=new ot,wa=new _n,oi=new _n,Yr=new ot;function dn(){Object.defineProperty(this,"id",{value:Cp+=2}),this.uuid=rr.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}dn.prototype=Object.assign(Object.create(ia.prototype),{constructor:dn,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){this.index=Array.isArray(t)?new(jd(t)>65535?nl:Tl)(t,1):t},getAttribute:function(t){return this.attributes[t]},setAttribute:function(t,u){return this.attributes[t]=u,this},deleteAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,u,m){this.groups.push({start:t,count:u,materialIndex:void 0!==m?m:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,u){this.drawRange.start=t,this.drawRange.count=u},applyMatrix4:function(t){const u=this.attributes.position;void 0!==u&&(u.applyMatrix4(t),u.needsUpdate=!0);const m=this.attributes.normal;if(void 0!==m){const E=(new jo).getNormalMatrix(t);m.applyNormalMatrix(E),m.needsUpdate=!0}const g=this.attributes.tangent;return void 0!==g&&(g.transformDirection(t),g.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(t){return xa.makeRotationX(t),this.applyMatrix4(xa),this},rotateY:function(t){return xa.makeRotationY(t),this.applyMatrix4(xa),this},rotateZ:function(t){return xa.makeRotationZ(t),this.applyMatrix4(xa),this},translate:function(t,u,m){return xa.makeTranslation(t,u,m),this.applyMatrix4(xa),this},scale:function(t,u,m){return xa.makeScale(t,u,m),this.applyMatrix4(xa),this},lookAt:function(t){return Ku.lookAt(t),Ku.updateMatrix(),this.applyMatrix4(Ku.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(eh).negate(),this.translate(eh.x,eh.y,eh.z),this},setFromObject:function(t){const u=t.geometry;if(t.isPoints||t.isLine){const m=new Fn(3*u.vertices.length,3),g=new Fn(3*u.colors.length,3);if(this.setAttribute("position",m.copyVector3sArray(u.vertices)),this.setAttribute("color",g.copyColorsArray(u.colors)),u.lineDistances&&u.lineDistances.length===u.vertices.length){const E=new Fn(u.lineDistances.length,1);this.setAttribute("lineDistance",E.copyArray(u.lineDistances))}null!==u.boundingSphere&&(this.boundingSphere=u.boundingSphere.clone()),null!==u.boundingBox&&(this.boundingBox=u.boundingBox.clone())}else t.isMesh&&u&&u.isGeometry&&this.fromGeometry(u);return this},setFromPoints:function(t){const u=[];for(let m=0,g=t.length;m<g;m++){const E=t[m];u.push(E.x,E.y,E.z||0)}return this.setAttribute("position",new Fn(u,3)),this},updateFromObject:function(t){let u=t.geometry;if(t.isMesh){let m=u.__directGeometry;if(!0===u.elementsNeedUpdate&&(m=void 0,u.elementsNeedUpdate=!1),void 0===m)return this.fromGeometry(u);m.verticesNeedUpdate=u.verticesNeedUpdate,m.normalsNeedUpdate=u.normalsNeedUpdate,m.colorsNeedUpdate=u.colorsNeedUpdate,m.uvsNeedUpdate=u.uvsNeedUpdate,m.groupsNeedUpdate=u.groupsNeedUpdate,u.verticesNeedUpdate=!1,u.normalsNeedUpdate=!1,u.colorsNeedUpdate=!1,u.uvsNeedUpdate=!1,u.groupsNeedUpdate=!1,u=m}if(!0===u.verticesNeedUpdate){const m=this.attributes.position;void 0!==m&&(m.copyVector3sArray(u.vertices),m.needsUpdate=!0),u.verticesNeedUpdate=!1}if(!0===u.normalsNeedUpdate){const m=this.attributes.normal;void 0!==m&&(m.copyVector3sArray(u.normals),m.needsUpdate=!0),u.normalsNeedUpdate=!1}if(!0===u.colorsNeedUpdate){const m=this.attributes.color;void 0!==m&&(m.copyColorsArray(u.colors),m.needsUpdate=!0),u.colorsNeedUpdate=!1}if(u.uvsNeedUpdate){const m=this.attributes.uv;void 0!==m&&(m.copyVector2sArray(u.uvs),m.needsUpdate=!0),u.uvsNeedUpdate=!1}if(u.lineDistancesNeedUpdate){const m=this.attributes.lineDistance;void 0!==m&&(m.copyArray(u.lineDistances),m.needsUpdate=!0),u.lineDistancesNeedUpdate=!1}return u.groupsNeedUpdate&&(u.computeGroups(t.geometry),this.groups=u.groups,u.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new zi).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){const u=new Float32Array(3*t.vertices.length);if(this.setAttribute("position",new Gr(u,3).copyVector3sArray(t.vertices)),t.normals.length>0){const m=new Float32Array(3*t.normals.length);this.setAttribute("normal",new Gr(m,3).copyVector3sArray(t.normals))}if(t.colors.length>0){const m=new Float32Array(3*t.colors.length);this.setAttribute("color",new Gr(m,3).copyColorsArray(t.colors))}if(t.uvs.length>0){const m=new Float32Array(2*t.uvs.length);this.setAttribute("uv",new Gr(m,2).copyVector2sArray(t.uvs))}if(t.uvs2.length>0){const m=new Float32Array(2*t.uvs2.length);this.setAttribute("uv2",new Gr(m,2).copyVector2sArray(t.uvs2))}this.groups=t.groups;for(const m in t.morphTargets){const g=[],E=t.morphTargets[m];for(let I=0,V=E.length;I<V;I++){const J=E[I],Y=new Fn(3*J.data.length,3);Y.name=J.name,g.push(Y.copyVector3sArray(J.data))}this.morphAttributes[m]=g}if(t.skinIndices.length>0){const m=new Fn(4*t.skinIndices.length,4);this.setAttribute("skinIndex",m.copyVector4sArray(t.skinIndices))}if(t.skinWeights.length>0){const m=new Fn(4*t.skinWeights.length,4);this.setAttribute("skinWeight",m.copyVector4sArray(t.skinWeights))}return null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new _n);const t=this.attributes.position,u=this.morphAttributes.position;if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),u)for(let m=0,g=u.length;m<g;m++)wa.setFromBufferAttribute(u[m]),this.morphTargetsRelative?(Yr.addVectors(this.boundingBox.min,wa.min),this.boundingBox.expandByPoint(Yr),Yr.addVectors(this.boundingBox.max,wa.max),this.boundingBox.expandByPoint(Yr)):(this.boundingBox.expandByPoint(wa.min),this.boundingBox.expandByPoint(wa.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new zn);const t=this.attributes.position,u=this.morphAttributes.position;if(t){const m=this.boundingSphere.center;if(wa.setFromBufferAttribute(t),u)for(let E=0,I=u.length;E<I;E++)oi.setFromBufferAttribute(u[E]),this.morphTargetsRelative?(Yr.addVectors(wa.min,oi.min),wa.expandByPoint(Yr),Yr.addVectors(wa.max,oi.max),wa.expandByPoint(Yr)):(wa.expandByPoint(oi.min),wa.expandByPoint(oi.max));wa.getCenter(m);let g=0;for(let E=0,I=t.count;E<I;E++)Yr.fromBufferAttribute(t,E),g=Math.max(g,m.distanceToSquared(Yr));if(u)for(let E=0,I=u.length;E<I;E++){const V=u[E],J=this.morphTargetsRelative;for(let Y=0,Z=V.count;Y<Z;Y++)Yr.fromBufferAttribute(V,Y),J&&(eh.fromBufferAttribute(t,Y),Yr.add(eh)),g=Math.max(g,m.distanceToSquared(Yr))}this.boundingSphere.radius=Math.sqrt(g),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){const t=this.index,u=this.getAttribute("position");if(void 0!==u){let m=this.getAttribute("normal");if(void 0===m)m=new Gr(new Float32Array(3*u.count),3),this.setAttribute("normal",m);else for(let S=0,e=m.count;S<e;S++)m.setXYZ(S,0,0,0);const g=new ot,E=new ot,I=new ot,V=new ot,J=new ot,Y=new ot,Z=new ot,me=new ot;if(t)for(let S=0,e=t.count;S<e;S+=3){const c=t.getX(S+0),p=t.getX(S+1),_=t.getX(S+2);g.fromBufferAttribute(u,c),E.fromBufferAttribute(u,p),I.fromBufferAttribute(u,_),Z.subVectors(I,E),me.subVectors(g,E),Z.cross(me),V.fromBufferAttribute(m,c),J.fromBufferAttribute(m,p),Y.fromBufferAttribute(m,_),V.add(Z),J.add(Z),Y.add(Z),m.setXYZ(c,V.x,V.y,V.z),m.setXYZ(p,J.x,J.y,J.z),m.setXYZ(_,Y.x,Y.y,Y.z)}else for(let S=0,e=u.count;S<e;S+=3)g.fromBufferAttribute(u,S+0),E.fromBufferAttribute(u,S+1),I.fromBufferAttribute(u,S+2),Z.subVectors(I,E),me.subVectors(g,E),Z.cross(me),m.setXYZ(S+0,Z.x,Z.y,Z.z),m.setXYZ(S+1,Z.x,Z.y,Z.z),m.setXYZ(S+2,Z.x,Z.y,Z.z);this.normalizeNormals(),m.needsUpdate=!0}},merge:function(t,u){if(!t||!t.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t);void 0===u&&(u=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const m=this.attributes;for(const g in m){if(void 0===t.attributes[g])continue;const E=m[g].array,I=t.attributes[g],V=I.array,J=I.itemSize*u,Y=Math.min(V.length,E.length-J);for(let Z=0,me=J;Z<Y;Z++,me++)E[me]=V[Z]}return this},normalizeNormals:function(){const t=this.attributes.normal;for(let u=0,m=t.count;u<m;u++)Yr.fromBufferAttribute(t,u),Yr.normalize(),t.setXYZ(u,Yr.x,Yr.y,Yr.z)},toNonIndexed:function(){function t(V,J){const Y=V.array,Z=V.itemSize,me=V.normalized,S=new Y.constructor(J.length*Z);let e=0,c=0;for(let p=0,_=J.length;p<_;p++){e=J[p]*Z;for(let w=0;w<Z;w++)S[c++]=Y[e++]}return new Gr(S,Z,me)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;const u=new dn,m=this.index.array,g=this.attributes;for(const V in g){const J=t(g[V],m);u.setAttribute(V,J)}const E=this.morphAttributes;for(const V in E){const J=[],Y=E[V];for(let Z=0,me=Y.length;Z<me;Z++){const S=t(Y[Z],m);J.push(S)}u.morphAttributes[V]=J}u.morphTargetsRelative=this.morphTargetsRelative;const I=this.groups;for(let V=0,J=I.length;V<J;V++){const Y=I[V];u.addGroup(Y.start,Y.count,Y.materialIndex)}return u},toJSON:function(){const t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),void 0!==this.parameters){const J=this.parameters;for(const Y in J)void 0!==J[Y]&&(t[Y]=J[Y]);return t}t.data={attributes:{}};const u=this.index;null!==u&&(t.data.index={type:u.array.constructor.name,array:Array.prototype.slice.call(u.array)});const m=this.attributes;for(const J in m){const Y=m[J],Z=Y.toJSON(t.data);""!==Y.name&&(Z.name=Y.name),t.data.attributes[J]=Z}const g={};let E=!1;for(const J in this.morphAttributes){const Y=this.morphAttributes[J],Z=[];for(let me=0,S=Y.length;me<S;me++){const e=Y[me],c=e.toJSON(t.data);""!==e.name&&(c.name=e.name),Z.push(c)}Z.length>0&&(g[J]=Z,E=!0)}E&&(t.data.morphAttributes=g,t.data.morphTargetsRelative=this.morphTargetsRelative);const I=this.groups;I.length>0&&(t.data.groups=JSON.parse(JSON.stringify(I)));const V=this.boundingSphere;return null!==V&&(t.data.boundingSphere={center:V.center.toArray(),radius:V.radius}),t},clone:function(){return(new dn).copy(this)},copy:function(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const u={};this.name=t.name;const m=t.index;null!==m&&this.setIndex(m.clone(u));const g=t.attributes;for(const Y in g)this.setAttribute(Y,g[Y].clone(u));const E=t.morphAttributes;for(const Y in E){const Z=[],me=E[Y];for(let S=0,e=me.length;S<e;S++)Z.push(me[S].clone(u));this.morphAttributes[Y]=Z}this.morphTargetsRelative=t.morphTargetsRelative;const I=t.groups;for(let Y=0,Z=I.length;Y<Z;Y++){const me=I[Y];this.addGroup(me.start,me.count,me.materialIndex)}const V=t.boundingBox;null!==V&&(this.boundingBox=V.clone());const J=t.boundingSphere;return null!==J&&(this.boundingSphere=J.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});const Gc=new ti,ai=new co,aa=new zn,Fa=new ot,Bn=new ot,vi=new ot,gs=new ot,vs=new ot,$s=new ot,ni=new ot,Tr=new ot,br=new ot,rl=new wn,bc=new wn,th=new wn,Da=new ot,ts=new ot;function Bi(t,u){er.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new dn,this.material=void 0!==u?u:new eo,this.updateMorphTargets()}function tp(t,u,m,g,E,I,V,J){let Y;if(Y=u.side===le?g.intersectTriangle(V,I,E,!0,J):g.intersectTriangle(E,I,V,u.side!==pe,J),null===Y)return null;ts.copy(J),ts.applyMatrix4(t.matrixWorld);const Z=m.ray.origin.distanceTo(ts);return Z<m.near||Z>m.far?null:{distance:Z,point:ts.clone(),object:t}}function Mh(t,u,m,g,E,I,V,J,Y,Z,me,S){Fa.fromBufferAttribute(E,Z),Bn.fromBufferAttribute(E,me),vi.fromBufferAttribute(E,S);const e=t.morphTargetInfluences;if(u.morphTargets&&I&&e){ni.set(0,0,0),Tr.set(0,0,0),br.set(0,0,0);for(let p=0,_=I.length;p<_;p++){const w=e[p],L=I[p];0!==w&&(gs.fromBufferAttribute(L,Z),vs.fromBufferAttribute(L,me),$s.fromBufferAttribute(L,S),V?(ni.addScaledVector(gs,w),Tr.addScaledVector(vs,w),br.addScaledVector($s,w)):(ni.addScaledVector(gs.sub(Fa),w),Tr.addScaledVector(vs.sub(Bn),w),br.addScaledVector($s.sub(vi),w)))}Fa.add(ni),Bn.add(Tr),vi.add(br)}t.isSkinnedMesh&&(t.boneTransform(Z,Fa),t.boneTransform(me,Bn),t.boneTransform(S,vi));const c=tp(t,u,m,g,Fa,Bn,vi,Da);if(c){J&&(rl.fromBufferAttribute(J,Z),bc.fromBufferAttribute(J,me),th.fromBufferAttribute(J,S),c.uv=Ir.getUV(Da,Fa,Bn,vi,rl,bc,th,new wn)),Y&&(rl.fromBufferAttribute(Y,Z),bc.fromBufferAttribute(Y,me),th.fromBufferAttribute(Y,S),c.uv2=Ir.getUV(Da,Fa,Bn,vi,rl,bc,th,new wn));const p=new sa(Z,me,S);Ir.getNormal(Fa,Bn,vi,p.normal),c.face=p}return c}Bi.prototype=Object.assign(Object.create(er.prototype),{constructor:Bi,isMesh:!0,copy:function(t){return er.prototype.copy.call(this,t),void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this},updateMorphTargets:function(){const t=this.geometry;if(t.isBufferGeometry){const u=t.morphAttributes,m=Object.keys(u);if(m.length>0){const g=u[m[0]];if(void 0!==g){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let E=0,I=g.length;E<I;E++){const V=g[E].name||String(E);this.morphTargetInfluences.push(0),this.morphTargetDictionary[V]=E}}}}else{const u=t.morphTargets;void 0!==u&&u.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(t,u){const m=this.geometry,g=this.material,E=this.matrixWorld;if(void 0===g||(null===m.boundingSphere&&m.computeBoundingSphere(),aa.copy(m.boundingSphere),aa.applyMatrix4(E),!1===t.ray.intersectsSphere(aa))||(Gc.getInverse(E),ai.copy(t.ray).applyMatrix4(Gc),null!==m.boundingBox&&!1===ai.intersectsBox(m.boundingBox)))return;let I;if(m.isBufferGeometry){const V=m.index,J=m.attributes.position,Y=m.morphAttributes.position,Z=m.morphTargetsRelative,me=m.attributes.uv,S=m.attributes.uv2,e=m.groups,c=m.drawRange;if(null!==V)if(Array.isArray(g))for(let p=0,_=e.length;p<_;p++){const w=e[p],L=g[w.materialIndex];for(let O=Math.max(w.start,c.start),D=Math.min(w.start+w.count,c.start+c.count);O<D;O+=3){const z=V.getX(O),Q=V.getX(O+1),ae=V.getX(O+2);I=Mh(this,L,t,ai,J,Y,Z,me,S,z,Q,ae),I&&(I.faceIndex=Math.floor(O/3),I.face.materialIndex=w.materialIndex,u.push(I))}}else for(let p=Math.max(0,c.start),_=Math.min(V.count,c.start+c.count);p<_;p+=3){const w=V.getX(p),L=V.getX(p+1),O=V.getX(p+2);I=Mh(this,g,t,ai,J,Y,Z,me,S,w,L,O),I&&(I.faceIndex=Math.floor(p/3),u.push(I))}else if(void 0!==J)if(Array.isArray(g))for(let p=0,_=e.length;p<_;p++){const w=e[p],L=g[w.materialIndex];for(let O=Math.max(w.start,c.start),D=Math.min(w.start+w.count,c.start+c.count);O<D;O+=3)I=Mh(this,L,t,ai,J,Y,Z,me,S,O,O+1,O+2),I&&(I.faceIndex=Math.floor(O/3),I.face.materialIndex=w.materialIndex,u.push(I))}else for(let p=Math.max(0,c.start),_=Math.min(J.count,c.start+c.count);p<_;p+=3)I=Mh(this,g,t,ai,J,Y,Z,me,S,p,p+1,p+2),I&&(I.faceIndex=Math.floor(p/3),u.push(I))}else if(m.isGeometry){const V=Array.isArray(g),J=m.vertices,Y=m.faces;let Z;const me=m.faceVertexUvs[0];me.length>0&&(Z=me);for(let S=0,e=Y.length;S<e;S++){const c=Y[S],p=V?g[c.materialIndex]:g;if(void 0===p)continue;const _=J[c.a],w=J[c.b],L=J[c.c];if(I=tp(this,p,t,ai,_,w,L,Da),I){if(Z&&Z[S]){const O=Z[S];rl.copy(O[0]),bc.copy(O[1]),th.copy(O[2]),I.uv=Ir.getUV(Da,_,w,L,rl,bc,th,new wn)}I.face=c,I.faceIndex=S,u.push(I)}}}}});let np=0;const fr=new ti,qo=new er,il=new ot;function Fr(){Object.defineProperty(this,"id",{value:np+=2}),this.uuid=rr.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}Fr.prototype=Object.assign(Object.create(ia.prototype),{constructor:Fr,isGeometry:!0,applyMatrix4:function(t){const u=(new jo).getNormalMatrix(t);for(let m=0,g=this.vertices.length;m<g;m++)this.vertices[m].applyMatrix4(t);for(let m=0,g=this.faces.length;m<g;m++){const E=this.faces[m];E.normal.applyMatrix3(u).normalize();for(let I=0,V=E.vertexNormals.length;I<V;I++)E.vertexNormals[I].applyMatrix3(u).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(t){return fr.makeRotationX(t),this.applyMatrix4(fr),this},rotateY:function(t){return fr.makeRotationY(t),this.applyMatrix4(fr),this},rotateZ:function(t){return fr.makeRotationZ(t),this.applyMatrix4(fr),this},translate:function(t,u,m){return fr.makeTranslation(t,u,m),this.applyMatrix4(fr),this},scale:function(t,u,m){return fr.makeScale(t,u,m),this.applyMatrix4(fr),this},lookAt:function(t){return qo.lookAt(t),qo.updateMatrix(),this.applyMatrix4(qo.matrix),this},fromBufferGeometry:function(t){const u=this,m=null!==t.index?t.index:void 0,g=t.attributes;if(void 0===g.position)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;const E=g.position,I=g.normal,V=g.color,J=g.uv,Y=g.uv2;void 0!==Y&&(this.faceVertexUvs[1]=[]);for(let S=0;S<E.count;S++)u.vertices.push((new ot).fromBufferAttribute(E,S)),void 0!==V&&u.colors.push((new lr).fromBufferAttribute(V,S));function Z(S,e,c,p){const _=void 0===V?[]:[u.colors[S].clone(),u.colors[e].clone(),u.colors[c].clone()],w=new sa(S,e,c,void 0===I?[]:[(new ot).fromBufferAttribute(I,S),(new ot).fromBufferAttribute(I,e),(new ot).fromBufferAttribute(I,c)],_,p);u.faces.push(w),void 0!==J&&u.faceVertexUvs[0].push([(new wn).fromBufferAttribute(J,S),(new wn).fromBufferAttribute(J,e),(new wn).fromBufferAttribute(J,c)]),void 0!==Y&&u.faceVertexUvs[1].push([(new wn).fromBufferAttribute(Y,S),(new wn).fromBufferAttribute(Y,e),(new wn).fromBufferAttribute(Y,c)])}const me=t.groups;if(me.length>0)for(let S=0;S<me.length;S++){const e=me[S],c=e.start;for(let p=c,_=c+e.count;p<_;p+=3)void 0!==m?Z(m.getX(p),m.getX(p+1),m.getX(p+2),e.materialIndex):Z(p,p+1,p+2,e.materialIndex)}else if(void 0!==m)for(let S=0;S<m.count;S+=3)Z(m.getX(S),m.getX(S+1),m.getX(S+2));else for(let S=0;S<E.count;S+=3)Z(S,S+1,S+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(il).negate(),this.translate(il.x,il.y,il.z),this},normalize:function(){this.computeBoundingSphere();const t=this.boundingSphere.center,u=this.boundingSphere.radius,m=0===u?1:1/u,g=new ti;return g.set(m,0,0,-m*t.x,0,m,0,-m*t.y,0,0,m,-m*t.z,0,0,0,1),this.applyMatrix4(g),this},computeFaceNormals:function(){const t=new ot,u=new ot;for(let m=0,g=this.faces.length;m<g;m++){const E=this.faces[m],I=this.vertices[E.a],V=this.vertices[E.b];t.subVectors(this.vertices[E.c],V),u.subVectors(I,V),t.cross(u),t.normalize(),E.normal.copy(t)}},computeVertexNormals:function(t){void 0===t&&(t=!0);const u=new Array(this.vertices.length);for(let m=0,g=this.vertices.length;m<g;m++)u[m]=new ot;if(t){const m=new ot,g=new ot;for(let E=0,I=this.faces.length;E<I;E++){const V=this.faces[E],J=this.vertices[V.a],Y=this.vertices[V.b];m.subVectors(this.vertices[V.c],Y),g.subVectors(J,Y),m.cross(g),u[V.a].add(m),u[V.b].add(m),u[V.c].add(m)}}else{this.computeFaceNormals();for(let m=0,g=this.faces.length;m<g;m++){const E=this.faces[m];u[E.a].add(E.normal),u[E.b].add(E.normal),u[E.c].add(E.normal)}}for(let m=0,g=this.vertices.length;m<g;m++)u[m].normalize();for(let m=0,g=this.faces.length;m<g;m++){const E=this.faces[m],I=E.vertexNormals;3===I.length?(I[0].copy(u[E.a]),I[1].copy(u[E.b]),I[2].copy(u[E.c])):(I[0]=u[E.a].clone(),I[1]=u[E.b].clone(),I[2]=u[E.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){this.computeFaceNormals();for(let t=0,u=this.faces.length;t<u;t++){const m=this.faces[t],g=m.vertexNormals;3===g.length?(g[0].copy(m.normal),g[1].copy(m.normal),g[2].copy(m.normal)):(g[0]=m.normal.clone(),g[1]=m.normal.clone(),g[2]=m.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){for(let u=0,m=this.faces.length;u<m;u++){const g=this.faces[u];g.__originalFaceNormal?g.__originalFaceNormal.copy(g.normal):g.__originalFaceNormal=g.normal.clone(),g.__originalVertexNormals||(g.__originalVertexNormals=[]);for(let E=0,I=g.vertexNormals.length;E<I;E++)g.__originalVertexNormals[E]?g.__originalVertexNormals[E].copy(g.vertexNormals[E]):g.__originalVertexNormals[E]=g.vertexNormals[E].clone()}const t=new Fr;t.faces=this.faces;for(let u=0,m=this.morphTargets.length;u<m;u++){if(!this.morphNormals[u]){this.morphNormals[u]={},this.morphNormals[u].faceNormals=[],this.morphNormals[u].vertexNormals=[];const E=this.morphNormals[u].faceNormals,I=this.morphNormals[u].vertexNormals;for(let V=0,J=this.faces.length;V<J;V++){const Y=new ot,Z={a:new ot,b:new ot,c:new ot};E.push(Y),I.push(Z)}}const g=this.morphNormals[u];t.vertices=this.morphTargets[u].vertices,t.computeFaceNormals(),t.computeVertexNormals();for(let E=0,I=this.faces.length;E<I;E++){const V=this.faces[E],Y=g.vertexNormals[E];g.faceNormals[E].copy(V.normal),Y.a.copy(V.vertexNormals[0]),Y.b.copy(V.vertexNormals[1]),Y.c.copy(V.vertexNormals[2])}}for(let u=0,m=this.faces.length;u<m;u++){const g=this.faces[u];g.normal=g.__originalFaceNormal,g.vertexNormals=g.__originalVertexNormals}},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new _n),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new zn),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,u,m){if(!t||!t.isGeometry)return void console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t);let g,E=this.vertices.length,I=this.vertices,V=t.vertices,J=this.faces,Y=t.faces,Z=this.colors,me=t.colors;void 0===m&&(m=0),void 0!==u&&(g=(new jo).getNormalMatrix(u));for(let S=0,e=V.length;S<e;S++){const c=V[S].clone();void 0!==u&&c.applyMatrix4(u),I.push(c)}for(let S=0,e=me.length;S<e;S++)Z.push(me[S].clone());for(let S=0,e=Y.length;S<e;S++){let c,p,_,w=Y[S],L=w.vertexNormals,O=w.vertexColors;c=new sa(w.a+E,w.b+E,w.c+E),c.normal.copy(w.normal),void 0!==g&&c.normal.applyMatrix3(g).normalize();for(let D=0,z=L.length;D<z;D++)p=L[D].clone(),void 0!==g&&p.applyMatrix3(g).normalize(),c.vertexNormals.push(p);c.color.copy(w.color);for(let D=0,z=O.length;D<z;D++)_=O[D],c.vertexColors.push(_.clone());c.materialIndex=w.materialIndex+m,J.push(c)}for(let S=0,e=t.faceVertexUvs.length;S<e;S++){const c=t.faceVertexUvs[S];void 0===this.faceVertexUvs[S]&&(this.faceVertexUvs[S]=[]);for(let p=0,_=c.length;p<_;p++){const w=c[p],L=[];for(let O=0,D=w.length;O<D;O++)L.push(w[O].clone());this.faceVertexUvs[S].push(L)}}},mergeMesh:function(t){t&&t.isMesh?(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t)},mergeVertices:function(){const t={},u=[],m=[],g=Math.pow(10,4);for(let V=0,J=this.vertices.length;V<J;V++){const Y=this.vertices[V],Z=Math.round(Y.x*g)+"_"+Math.round(Y.y*g)+"_"+Math.round(Y.z*g);void 0===t[Z]?(t[Z]=V,u.push(this.vertices[V]),m[V]=u.length-1):m[V]=m[t[Z]]}const E=[];for(let V=0,J=this.faces.length;V<J;V++){const Y=this.faces[V];Y.a=m[Y.a],Y.b=m[Y.b],Y.c=m[Y.c];const Z=[Y.a,Y.b,Y.c];for(let me=0;me<3;me++)if(Z[me]===Z[(me+1)%3]){E.push(V);break}}for(let V=E.length-1;V>=0;V--){const J=E[V];this.faces.splice(J,1);for(let Y=0,Z=this.faceVertexUvs.length;Y<Z;Y++)this.faceVertexUvs[Y].splice(J,1)}const I=this.vertices.length-u.length;return this.vertices=u,I},setFromPoints:function(t){this.vertices=[];for(let u=0,m=t.length;u<m;u++){const g=t[u];this.vertices.push(new ot(g.x,g.y,g.z||0))}return this},sortFacesByMaterialIndex:function(){const t=this.faces,u=t.length;for(let V=0;V<u;V++)t[V]._id=V;t.sort(function(V,J){return V.materialIndex-J.materialIndex});const m=this.faceVertexUvs[0],g=this.faceVertexUvs[1];let E,I;m&&m.length===u&&(E=[]),g&&g.length===u&&(I=[]);for(let V=0;V<u;V++){const J=t[V]._id;E&&E.push(m[J]),I&&I.push(g[J])}E&&(this.faceVertexUvs[0]=E),I&&(this.faceVertexUvs[1]=I)},toJSON:function(){const t={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){const c=this.parameters;for(const p in c)void 0!==c[p]&&(t[p]=c[p]);return t}const u=[];for(let c=0;c<this.vertices.length;c++){const p=this.vertices[c];u.push(p.x,p.y,p.z)}const m=[],g=[],E={},I=[],V={},J=[],Y={};for(let c=0;c<this.faces.length;c++){const p=this.faces[c],_=!0,w=!1,L=void 0!==this.faceVertexUvs[0][c],O=p.normal.length()>0,D=p.vertexNormals.length>0,z=1!==p.color.r||1!==p.color.g||1!==p.color.b,Q=p.vertexColors.length>0;let ae=0;if(ae=Z(ae,0,0),ae=Z(ae,1,_),ae=Z(ae,2,w),ae=Z(ae,3,L),ae=Z(ae,4,O),ae=Z(ae,5,D),ae=Z(ae,6,z),ae=Z(ae,7,Q),m.push(ae),m.push(p.a,p.b,p.c),m.push(p.materialIndex),L){const ie=this.faceVertexUvs[0][c];m.push(e(ie[0]),e(ie[1]),e(ie[2]))}if(O&&m.push(me(p.normal)),D){const ie=p.vertexNormals;m.push(me(ie[0]),me(ie[1]),me(ie[2]))}if(z&&m.push(S(p.color)),Q){const ie=p.vertexColors;m.push(S(ie[0]),S(ie[1]),S(ie[2]))}}function Z(c,p,_){return _?c|1<<p:c&~(1<<p)}function me(c){const p=c.x.toString()+c.y.toString()+c.z.toString();return void 0!==E[p]||(E[p]=g.length/3,g.push(c.x,c.y,c.z)),E[p]}function S(c){const p=c.r.toString()+c.g.toString()+c.b.toString();return void 0!==V[p]||(V[p]=I.length,I.push(c.getHex())),V[p]}function e(c){const p=c.x.toString()+c.y.toString();return void 0!==Y[p]||(Y[p]=J.length/2,J.push(c.x,c.y)),Y[p]}return t.data={},t.data.vertices=u,t.data.normals=g,I.length>0&&(t.data.colors=I),J.length>0&&(t.data.uvs=[J]),t.data.faces=m,t},clone:function(){return(new Fr).copy(this)},copy:function(t){this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;const u=t.vertices;for(let S=0,e=u.length;S<e;S++)this.vertices.push(u[S].clone());const m=t.colors;for(let S=0,e=m.length;S<e;S++)this.colors.push(m[S].clone());const g=t.faces;for(let S=0,e=g.length;S<e;S++)this.faces.push(g[S].clone());for(let S=0,e=t.faceVertexUvs.length;S<e;S++){const c=t.faceVertexUvs[S];void 0===this.faceVertexUvs[S]&&(this.faceVertexUvs[S]=[]);for(let p=0,_=c.length;p<_;p++){const w=c[p],L=[];for(let O=0,D=w.length;O<D;O++)L.push(w[O].clone());this.faceVertexUvs[S].push(L)}}const E=t.morphTargets;for(let S=0,e=E.length;S<e;S++){const c={};if(c.name=E[S].name,void 0!==E[S].vertices){c.vertices=[];for(let p=0,_=E[S].vertices.length;p<_;p++)c.vertices.push(E[S].vertices[p].clone())}if(void 0!==E[S].normals){c.normals=[];for(let p=0,_=E[S].normals.length;p<_;p++)c.normals.push(E[S].normals[p].clone())}this.morphTargets.push(c)}const I=t.morphNormals;for(let S=0,e=I.length;S<e;S++){const c={};if(void 0!==I[S].vertexNormals){c.vertexNormals=[];for(let p=0,_=I[S].vertexNormals.length;p<_;p++){const w=I[S].vertexNormals[p],L={};L.a=w.a.clone(),L.b=w.b.clone(),L.c=w.c.clone(),c.vertexNormals.push(L)}}if(void 0!==I[S].faceNormals){c.faceNormals=[];for(let p=0,_=I[S].faceNormals.length;p<_;p++)c.faceNormals.push(I[S].faceNormals[p].clone())}this.morphNormals.push(c)}const V=t.skinWeights;for(let S=0,e=V.length;S<e;S++)this.skinWeights.push(V[S].clone());const J=t.skinIndices;for(let S=0,e=J.length;S<e;S++)this.skinIndices.push(J[S].clone());const Y=t.lineDistances;for(let S=0,e=Y.length;S<e;S++)this.lineDistances.push(Y[S]);const Z=t.boundingBox;null!==Z&&(this.boundingBox=Z.clone());const me=t.boundingSphere;return null!==me&&(this.boundingSphere=me.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});class Cs extends Fr{constructor(u,m,g,E,I,V){super(),this.type="BoxGeometry",this.parameters={width:u,height:m,depth:g,widthSegments:E,heightSegments:I,depthSegments:V},this.fromBufferGeometry(new nh(u,m,g,E,I,V)),this.mergeVertices()}}class nh extends dn{constructor(u=1,m=1,g=1,E=1,I=1,V=1){super(),this.type="BoxBufferGeometry",this.parameters={width:u,height:m,depth:g,widthSegments:E,heightSegments:I,depthSegments:V};const J=this;E=Math.floor(E),I=Math.floor(I),V=Math.floor(V);const Y=[],Z=[],me=[],S=[];let e=0,c=0;function p(_,w,L,O,D,z,Q,ae,ie,he,ye){const Me=z/ie,Ne=Q/he,$e=z/2,ze=Q/2,Ye=ae/2,We=ie+1,nt=he+1;let it=0,mt=0;const xt=new ot;for(let Dt=0;Dt<nt;Dt++){const Ht=Dt*Ne-ze;for(let Je=0;Je<We;Je++)xt[_]=(Je*Me-$e)*O,xt[w]=Ht*D,xt[L]=Ye,Z.push(xt.x,xt.y,xt.z),xt[_]=0,xt[w]=0,xt[L]=ae>0?1:-1,me.push(xt.x,xt.y,xt.z),S.push(Je/ie),S.push(1-Dt/he),it+=1}for(let Dt=0;Dt<he;Dt++)for(let Ht=0;Ht<ie;Ht++){const pt=e+Ht+We*(Dt+1),Vt=e+(Ht+1)+We*(Dt+1),Nt=e+(Ht+1)+We*Dt;Y.push(e+Ht+We*Dt,pt,Nt),Y.push(pt,Vt,Nt),mt+=6}J.addGroup(c,mt,ye),c+=mt,e+=it}p("z","y","x",-1,-1,g,m,u,V,I,0),p("z","y","x",1,-1,g,m,-u,V,I,1),p("x","z","y",1,1,u,g,m,E,V,2),p("x","z","y",1,-1,u,g,-m,E,V,3),p("x","y","z",1,-1,u,m,g,E,I,4),p("x","y","z",-1,-1,u,m,-g,E,I,5),this.setIndex(Y),this.setAttribute("position",new Fn(Z,3)),this.setAttribute("normal",new Fn(me,3)),this.setAttribute("uv",new Fn(S,2))}}function Hc(t){const u={};for(const m in t){u[m]={};for(const g in t[m]){const E=t[m][g];u[m][g]=E&&(E.isColor||E.isMatrix3||E.isMatrix4||E.isVector2||E.isVector3||E.isVector4||E.isTexture)?E.clone():Array.isArray(E)?E.slice():E}}return u}function Ls(t){const u={};for(let m=0;m<t.length;m++){const g=Hc(t[m]);for(const E in g)u[E]=g[E]}return u}const Po={clone:Hc,merge:Ls};var rp="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",Wl="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}";function uo(t){Ur.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=rp,this.fragmentShader=Wl,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function Mi(){er.call(this),this.type="Camera",this.matrixWorldInverse=new ti,this.projectionMatrix=new ti,this.projectionMatrixInverse=new ti}function Bs(t,u,m,g){Mi.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==m?m:.1,this.far=void 0!==g?g:2e3,this.focus=10,this.aspect=void 0!==u?u:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}(uo.prototype=Object.create(Ur.prototype)).constructor=uo,uo.prototype.isShaderMaterial=!0,uo.prototype.copy=function(t){return Ur.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Hc(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=Object.assign({},t.extensions),this},uo.prototype.toJSON=function(t){const u=Ur.prototype.toJSON.call(this,t);u.uniforms={};for(const g in this.uniforms){const E=this.uniforms[g].value;u.uniforms[g]=E&&E.isTexture?{type:"t",value:E.toJSON(t).uuid}:E&&E.isColor?{type:"c",value:E.getHex()}:E&&E.isVector2?{type:"v2",value:E.toArray()}:E&&E.isVector3?{type:"v3",value:E.toArray()}:E&&E.isVector4?{type:"v4",value:E.toArray()}:E&&E.isMatrix3?{type:"m3",value:E.toArray()}:E&&E.isMatrix4?{type:"m4",value:E.toArray()}:{value:E}}Object.keys(this.defines).length>0&&(u.defines=this.defines),u.vertexShader=this.vertexShader,u.fragmentShader=this.fragmentShader;const m={};for(const g in this.extensions)!0===this.extensions[g]&&(m[g]=!0);return Object.keys(m).length>0&&(u.extensions=m),u},Mi.prototype=Object.assign(Object.create(er.prototype),{constructor:Mi,isCamera:!0,copy:function(t,u){return er.prototype.copy.call(this,t,u),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),t=new ot),this.updateMatrixWorld(!0);const u=this.matrixWorld.elements;return t.set(-u[8],-u[9],-u[10]).normalize()},updateMatrixWorld:function(t){er.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(t,u){er.prototype.updateWorldMatrix.call(this,t,u),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),Bs.prototype=Object.assign(Object.create(Mi.prototype),{constructor:Bs,isPerspectiveCamera:!0,copy:function(t,u){return Mi.prototype.copy.call(this,t,u),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){const u=.5*this.getFilmHeight()/t;this.fov=2*rr.RAD2DEG*Math.atan(u),this.updateProjectionMatrix()},getFocalLength:function(){const t=Math.tan(.5*rr.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*rr.RAD2DEG*Math.atan(Math.tan(.5*rr.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,u,m,g,E,I){this.aspect=t/u,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=u,this.view.offsetX=m,this.view.offsetY=g,this.view.width=E,this.view.height=I,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){let t=this.near,u=t*Math.tan(.5*rr.DEG2RAD*this.fov)/this.zoom,m=2*u,g=this.aspect*m,E=-.5*g,I=this.view;if(null!==this.view&&this.view.enabled){const J=I.fullWidth,Y=I.fullHeight;E+=I.offsetX*g/J,u-=I.offsetY*m/Y,g*=I.width/J,m*=I.height/Y}const V=this.filmOffset;0!==V&&(E+=t*V/this.getFilmWidth()),this.projectionMatrix.makePerspective(E,E+g,u,u-m,t,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){const u=er.prototype.toJSON.call(this,t);return u.object.fov=this.fov,u.object.zoom=this.zoom,u.object.near=this.near,u.object.far=this.far,u.object.focus=this.focus,u.object.aspect=this.aspect,null!==this.view&&(u.object.view=Object.assign({},this.view)),u.object.filmGauge=this.filmGauge,u.object.filmOffset=this.filmOffset,u}});const Ns=90,Al=1;function Io(t,u,m){if(er.call(this),this.type="CubeCamera",!0!==m.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=m;const g=new Bs(Ns,Al,t,u);g.layers=this.layers,g.up.set(0,-1,0),g.lookAt(new ot(1,0,0)),this.add(g);const E=new Bs(Ns,Al,t,u);E.layers=this.layers,E.up.set(0,-1,0),E.lookAt(new ot(-1,0,0)),this.add(E);const I=new Bs(Ns,Al,t,u);I.layers=this.layers,I.up.set(0,0,1),I.lookAt(new ot(0,1,0)),this.add(I);const V=new Bs(Ns,Al,t,u);V.layers=this.layers,V.up.set(0,0,-1),V.lookAt(new ot(0,-1,0)),this.add(V);const J=new Bs(Ns,Al,t,u);J.layers=this.layers,J.up.set(0,-1,0),J.lookAt(new ot(0,0,1)),this.add(J);const Y=new Bs(Ns,Al,t,u);Y.layers=this.layers,Y.up.set(0,-1,0),Y.lookAt(new ot(0,0,-1)),this.add(Y),this.update=function(Z,me){null===this.parent&&this.updateMatrixWorld();const S=Z.xr.enabled,e=Z.getRenderTarget();Z.xr.enabled=!1;const c=m.texture.generateMipmaps;m.texture.generateMipmaps=!1,Z.setRenderTarget(m,0),Z.render(me,g),Z.setRenderTarget(m,1),Z.render(me,E),Z.setRenderTarget(m,2),Z.render(me,I),Z.setRenderTarget(m,3),Z.render(me,V),Z.setRenderTarget(m,4),Z.render(me,J),m.texture.generateMipmaps=c,Z.setRenderTarget(m,5),Z.render(me,Y),Z.setRenderTarget(e),Z.xr.enabled=S},this.clear=function(Z,me,S,e){const c=Z.getRenderTarget();for(let p=0;p<6;p++)Z.setRenderTarget(m,p),Z.clear(me,S,e);Z.setRenderTarget(c)}}function $l(t,u,m){Number.isInteger(u)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),u=m),Is.call(this,t,t,u)}function ol(t,u,m,g,E,I,V,J,Y,Z,me,S){ui.call(this,null,I,V,J,Y,Z,g,E,me,S),this.image={data:t||null,width:u||1,height:m||1},this.magFilter=void 0!==Y?Y:Or,this.minFilter=void 0!==Z?Z:Or,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}(Io.prototype=Object.create(er.prototype)).constructor=Io,($l.prototype=Object.create(Is.prototype)).constructor=$l,$l.prototype.isWebGLCubeRenderTarget=!0,$l.prototype.fromEquirectangularTexture=function(t,u){this.texture.type=u.type,this.texture.format=lo,this.texture.encoding=u.encoding,this.texture.generateMipmaps=u.generateMipmaps,this.texture.minFilter=u.minFilter,this.texture.magFilter=u.magFilter;const m=new Sl,I=new uo({name:"CubemapFromEquirect",uniforms:Hc({tEquirect:{value:null}}),vertexShader:"\n\n\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t#include <begin_vertex>\n\t\t\t\t#include <project_vertex>\n\n\t\t\t}\n\t\t",fragmentShader:"\n\n\t\t\tuniform sampler2D tEquirect;\n\n\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t}\n\t\t",side:le,blending:q});I.uniforms.tEquirect.value=u;const V=new Bi(new nh(5,5,5),I);return m.add(V),new Io(1,10,this).update(t,m),V.geometry.dispose(),V.material.dispose(),this},(ol.prototype=Object.create(ui.prototype)).constructor=ol,ol.prototype.isDataTexture=!0;const ql=new zn,xc=new ot;function Vc(t,u,m,g,E,I){this.planes=[void 0!==t?t:new Wo,void 0!==u?u:new Wo,void 0!==m?m:new Wo,void 0!==g?g:new Wo,void 0!==E?E:new Wo,void 0!==I?I:new Wo]}Object.assign(Vc.prototype,{set:function(t,u,m,g,E,I){const V=this.planes;return V[0].copy(t),V[1].copy(u),V[2].copy(m),V[3].copy(g),V[4].copy(E),V[5].copy(I),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){const u=this.planes;for(let m=0;m<6;m++)u[m].copy(t.planes[m]);return this},setFromProjectionMatrix:function(t){const u=this.planes,m=t.elements,g=m[0],E=m[1],I=m[2],V=m[3],J=m[4],Y=m[5],Z=m[6],me=m[7],S=m[8],e=m[9],c=m[10],p=m[11],_=m[12],w=m[13],L=m[14],O=m[15];return u[0].setComponents(V-g,me-J,p-S,O-_).normalize(),u[1].setComponents(V+g,me+J,p+S,O+_).normalize(),u[2].setComponents(V+E,me+Y,p+e,O+w).normalize(),u[3].setComponents(V-E,me-Y,p-e,O-w).normalize(),u[4].setComponents(V-I,me-Z,p-c,O-L).normalize(),u[5].setComponents(V+I,me+Z,p+c,O+L).normalize(),this},intersectsObject:function(t){const u=t.geometry;return null===u.boundingSphere&&u.computeBoundingSphere(),ql.copy(u.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(ql)},intersectsSprite:function(t){return ql.center.set(0,0,0),ql.radius=.7071067811865476,ql.applyMatrix4(t.matrixWorld),this.intersectsSphere(ql)},intersectsSphere:function(t){const u=this.planes,m=t.center,g=-t.radius;for(let E=0;E<6;E++)if(u[E].distanceToPoint(m)<g)return!1;return!0},intersectsBox:function(t){const u=this.planes;for(let m=0;m<6;m++){const g=u[m];if(xc.x=g.normal.x>0?t.max.x:t.min.x,xc.y=g.normal.y>0?t.max.y:t.min.y,xc.z=g.normal.z>0?t.max.z:t.min.z,g.distanceToPoint(xc)<0)return!1}return!0},containsPoint:function(t){const u=this.planes;for(let m=0;m<6;m++)if(u[m].distanceToPoint(t)<0)return!1;return!0}});const pr={common:{diffuse:{value:new lr(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new jo},uv2Transform:{value:new jo},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new wn(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new lr(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new lr(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new jo}},sprite:{diffuse:{value:new lr(15658734)},opacity:{value:1},center:{value:new wn(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new jo}}};function Lp(){let t=null,u=!1,m=null,g=null;function E(I,V){m(I,V),g=t.requestAnimationFrame(E)}return{start:function(){!0!==u&&null!==m&&(g=t.requestAnimationFrame(E),u=!0)},stop:function(){t.cancelAnimationFrame(g),u=!1},setAnimationLoop:function(I){m=I},setContext:function(I){t=I}}}function Sa(t,u){const m=u.isWebGL2,g=new WeakMap;return{get:function(E){return E.isInterleavedBufferAttribute&&(E=E.data),g.get(E)},remove:function(E){E.isInterleavedBufferAttribute&&(E=E.data);const I=g.get(E);I&&(t.deleteBuffer(I.buffer),g.delete(E))},update:function(E,I){E.isInterleavedBufferAttribute&&(E=E.data);const V=g.get(E);void 0===V?g.set(E,function(J,Y){const Z=J.array,me=J.usage,S=t.createBuffer();t.bindBuffer(Y,S),t.bufferData(Y,Z,me),J.onUploadCallback();let e=5126;return Z instanceof Float32Array?e=5126:Z instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):Z instanceof Uint16Array?e=5123:Z instanceof Int16Array?e=5122:Z instanceof Uint32Array?e=5125:Z instanceof Int32Array?e=5124:Z instanceof Int8Array?e=5120:Z instanceof Uint8Array&&(e=5121),{buffer:S,type:e,bytesPerElement:Z.BYTES_PER_ELEMENT,version:J.version}}(E,I)):V.version<E.version&&(function(J,Y,Z){const me=Y.array,S=Y.updateRange;t.bindBuffer(Z,J),-1===S.count?t.bufferSubData(Z,0,me):(m?t.bufferSubData(Z,S.offset*me.BYTES_PER_ELEMENT,me,S.offset,S.count):t.bufferSubData(Z,S.offset*me.BYTES_PER_ELEMENT,me.subarray(S.offset,S.offset+S.count)),S.count=-1)}(V.buffer,E,I),V.version=E.version)}}}function Ua(t,u,m,g){Fr.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:u,widthSegments:m,heightSegments:g},this.fromBufferGeometry(new Cl(t,u,m,g)),this.mergeVertices()}function Cl(t,u,m,g){dn.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:u,widthSegments:m,heightSegments:g};const E=(t=t||1)/2,I=(u=u||1)/2,V=Math.floor(m)||1,J=Math.floor(g)||1,Y=V+1,Z=J+1,me=t/V,S=u/J,e=[],c=[],p=[],_=[];for(let w=0;w<Z;w++){const L=w*S-I;for(let O=0;O<Y;O++)c.push(O*me-E,-L,0),p.push(0,0,1),_.push(O/V),_.push(1-w/J)}for(let w=0;w<J;w++)for(let L=0;L<V;L++){const D=L+Y*(w+1),z=L+1+Y*(w+1),Q=L+1+Y*w;e.push(L+Y*w,D,Q),e.push(D,z,Q)}this.setIndex(e),this.setAttribute("position",new Fn(c,3)),this.setAttribute("normal",new Fn(p,3)),this.setAttribute("uv",new Fn(_,2))}(Ua.prototype=Object.create(Fr.prototype)).constructor=Ua,(Cl.prototype=Object.create(dn.prototype)).constructor=Cl;const Dr={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha  = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_maxMipLevel 8.0\n#define cubeUV_minMipLevel 4.0\n#define cubeUV_maxTileSize 256.0\n#define cubeUV_minTileSize 16.0\nfloat getFace(vec3 direction) {\n    vec3 absDirection = abs(direction);\n    float face = -1.0;\n    if (absDirection.x > absDirection.z) {\n      if (absDirection.x > absDirection.y)\n        face = direction.x > 0.0 ? 0.0 : 3.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    } else {\n      if (absDirection.z > absDirection.y)\n        face = direction.z > 0.0 ? 2.0 : 5.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    }\n    return face;\n}\nvec2 getUV(vec3 direction, float face) {\n    vec2 uv;\n    if (face == 0.0) {\n      uv = vec2(direction.z, direction.y) / abs(direction.x);    } else if (face == 1.0) {\n      uv = vec2(-direction.x, -direction.z) / abs(direction.y);    } else if (face == 2.0) {\n      uv = vec2(-direction.x, direction.y) / abs(direction.z);    } else if (face == 3.0) {\n      uv = vec2(-direction.z, direction.y) / abs(direction.x);    } else if (face == 4.0) {\n      uv = vec2(-direction.x, direction.z) / abs(direction.y);    } else {\n      uv = vec2(direction.x, direction.y) / abs(direction.z);    }\n    return 0.5 * (uv + 1.0);\n}\nvec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {\n  float face = getFace(direction);\n  float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);\n  mipInt = max(mipInt, cubeUV_minMipLevel);\n  float faceSize = exp2(mipInt);\n  float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);\n  vec2 uv = getUV(direction, face) * (faceSize - 1.0);\n  vec2 f = fract(uv);\n  uv += 0.5 - f;\n  if (face > 2.0) {\n    uv.y += faceSize;\n    face -= 3.0;\n  }\n  uv.x += face * faceSize;\n  if(mipInt < cubeUV_maxMipLevel){\n    uv.y += 2.0 * cubeUV_maxTileSize;\n  }\n  uv.y += filterInt * 2.0 * cubeUV_minTileSize;\n  uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);\n  uv *= texelSize;\n  vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x += texelSize;\n  vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.y += texelSize;\n  vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x -= texelSize;\n  vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  vec3 tm = mix(tl, tr, f.x);\n  vec3 bm = mix(bl, br, f.x);\n  return mix(tm, bm, f.y);\n}\n#define r0 1.0\n#define v0 0.339\n#define m0 -2.0\n#define r1 0.8\n#define v1 0.276\n#define m1 -1.0\n#define r4 0.4\n#define v4 0.046\n#define m4 2.0\n#define r5 0.305\n#define v5 0.016\n#define m5 3.0\n#define r6 0.21\n#define v6 0.0038\n#define m6 4.0\nfloat roughnessToMip(float roughness) {\n  float mip = 0.0;\n  if (roughness >= r1) {\n    mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;\n  } else if (roughness >= r4) {\n    mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;\n  } else if (roughness >= r5) {\n    mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;\n  } else if (roughness >= r6) {\n    mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;\n  } else {\n    mip = -2.0 * log2(1.16 * roughness);  }\n  return mip;\n}\nvec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {\n  float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);\n  float mipF = fract(mip);\n  float mipInt = floor(mip);\n  vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);\n  if (mipF == 0.0) {\n    return vec4(color0, 1.0);\n  } else {\n    vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);\n    return vec4(mix(color0, color1, mipF), 1.0);\n  }\n}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\t\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t}  else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec2 sampleUV = equirectUv( reflectVec );\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t  vec3 reflectVec = reflect( -viewDir, normal );\n\t\t  reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t  vec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV = equirectUv( reflectVec );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat specularRoughness;\n\tvec3 specularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\t\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\t\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N = normalize( surf_norm );\n\t\tmat3 tsn = mat3( S, T, N );\n\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmissionmap_fragment:"#ifdef USE_TRANSMISSIONMAP\n\ttotalTransmission *= texture2D( transmissionMap, vUv ).r;\n#endif",transmissionmap_pars_fragment:"#ifdef USE_TRANSMISSIONMAP\n\tuniform sampler2D transmissionMap;\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSMISSION\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSMISSION\n\tuniform float transmission;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <transmissionmap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#ifdef TRANSMISSION\n\t\tfloat totalTransmission = transmission;\n\t#endif\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <transmissionmap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSMISSION\n\t\tdiffuseColor.a *= saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},wc={basic:{uniforms:Ls([pr.common,pr.specularmap,pr.envmap,pr.aomap,pr.lightmap,pr.fog]),vertexShader:Dr.meshbasic_vert,fragmentShader:Dr.meshbasic_frag},lambert:{uniforms:Ls([pr.common,pr.specularmap,pr.envmap,pr.aomap,pr.lightmap,pr.emissivemap,pr.fog,pr.lights,{emissive:{value:new lr(0)}}]),vertexShader:Dr.meshlambert_vert,fragmentShader:Dr.meshlambert_frag},phong:{uniforms:Ls([pr.common,pr.specularmap,pr.envmap,pr.aomap,pr.lightmap,pr.emissivemap,pr.bumpmap,pr.normalmap,pr.displacementmap,pr.fog,pr.lights,{emissive:{value:new lr(0)},specular:{value:new lr(1118481)},shininess:{value:30}}]),vertexShader:Dr.meshphong_vert,fragmentShader:Dr.meshphong_frag},standard:{uniforms:Ls([pr.common,pr.envmap,pr.aomap,pr.lightmap,pr.emissivemap,pr.bumpmap,pr.normalmap,pr.displacementmap,pr.roughnessmap,pr.metalnessmap,pr.fog,pr.lights,{emissive:{value:new lr(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Dr.meshphysical_vert,fragmentShader:Dr.meshphysical_frag},toon:{uniforms:Ls([pr.common,pr.aomap,pr.lightmap,pr.emissivemap,pr.bumpmap,pr.normalmap,pr.displacementmap,pr.gradientmap,pr.fog,pr.lights,{emissive:{value:new lr(0)}}]),vertexShader:Dr.meshtoon_vert,fragmentShader:Dr.meshtoon_frag},matcap:{uniforms:Ls([pr.common,pr.bumpmap,pr.normalmap,pr.displacementmap,pr.fog,{matcap:{value:null}}]),vertexShader:Dr.meshmatcap_vert,fragmentShader:Dr.meshmatcap_frag},points:{uniforms:Ls([pr.points,pr.fog]),vertexShader:Dr.points_vert,fragmentShader:Dr.points_frag},dashed:{uniforms:Ls([pr.common,pr.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Dr.linedashed_vert,fragmentShader:Dr.linedashed_frag},depth:{uniforms:Ls([pr.common,pr.displacementmap]),vertexShader:Dr.depth_vert,fragmentShader:Dr.depth_frag},normal:{uniforms:Ls([pr.common,pr.bumpmap,pr.normalmap,pr.displacementmap,{opacity:{value:1}}]),vertexShader:Dr.normal_vert,fragmentShader:Dr.normal_frag},sprite:{uniforms:Ls([pr.sprite,pr.fog]),vertexShader:Dr.sprite_vert,fragmentShader:Dr.sprite_frag},background:{uniforms:{uvTransform:{value:new jo},t2D:{value:null}},vertexShader:Dr.background_vert,fragmentShader:Dr.background_frag},cube:{uniforms:Ls([pr.envmap,{opacity:{value:1}}]),vertexShader:Dr.cube_vert,fragmentShader:Dr.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Dr.equirect_vert,fragmentShader:Dr.equirect_frag},distanceRGBA:{uniforms:Ls([pr.common,pr.displacementmap,{referencePosition:{value:new ot},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Dr.distanceRGBA_vert,fragmentShader:Dr.distanceRGBA_frag},shadow:{uniforms:Ls([pr.lights,pr.fog,{color:{value:new lr(0)},opacity:{value:1}}]),vertexShader:Dr.shadow_vert,fragmentShader:Dr.shadow_frag}};function ed(t,u,m,g){const E=new lr(0);let I,V,J=0,Y=null,Z=0,me=null;function S(e,c){u.buffers.color.setClear(e.r,e.g,e.b,c,g)}return{getClearColor:function(){return E},setClearColor:function(e,c){E.set(e),J=void 0!==c?c:1,S(E,J)},getClearAlpha:function(){return J},setClearAlpha:function(e){J=e,S(E,J)},render:function(e,c,p,_){let w=!0===c.isScene?c.background:null;const L=t.xr,O=L.getSession&&L.getSession();if(O&&"additive"===O.environmentBlendMode&&(w=null),null===w?S(E,J):w&&w.isColor&&(S(w,1),_=!0),(t.autoClear||_)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),w&&(w.isCubeTexture||w.isWebGLCubeRenderTarget||w.mapping===Di)){void 0===V&&(V=new Bi(new nh(1,1,1),new uo({name:"BackgroundCubeMaterial",uniforms:Hc(wc.cube.uniforms),vertexShader:wc.cube.vertexShader,fragmentShader:wc.cube.fragmentShader,side:le,depthTest:!1,depthWrite:!1,fog:!1})),V.geometry.deleteAttribute("normal"),V.geometry.deleteAttribute("uv"),V.onBeforeRender=function(z,Q,ae){this.matrixWorld.copyPosition(ae.matrixWorld)},Object.defineProperty(V.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),m.update(V));const D=w.isWebGLCubeRenderTarget?w.texture:w;V.material.uniforms.envMap.value=D,V.material.uniforms.flipEnvMap.value=D.isCubeTexture?-1:1,Y===w&&Z===D.version&&me===t.toneMapping||(V.material.needsUpdate=!0,Y=w,Z=D.version,me=t.toneMapping),e.unshift(V,V.geometry,V.material,0,0,null)}else w&&w.isTexture&&(void 0===I&&(I=new Bi(new Cl(2,2),new uo({name:"BackgroundMaterial",uniforms:Hc(wc.background.uniforms),vertexShader:wc.background.vertexShader,fragmentShader:wc.background.fragmentShader,side:_e,depthTest:!1,depthWrite:!1,fog:!1})),I.geometry.deleteAttribute("normal"),Object.defineProperty(I.material,"map",{get:function(){return this.uniforms.t2D.value}}),m.update(I)),I.material.uniforms.t2D.value=w,!0===w.matrixAutoUpdate&&w.updateMatrix(),I.material.uniforms.uvTransform.value.copy(w.matrix),Y===w&&Z===w.version&&me===t.toneMapping||(I.material.needsUpdate=!0,Y=w,Z=w.version,me=t.toneMapping),e.unshift(I,I.geometry,I.material,0,0,null))}}}function Su(t,u,m,g){const E=t.getParameter(34921),I=g.isWebGL2?null:u.get("OES_vertex_array_object"),V=g.isWebGL2||null!==I,J={},Y=e(null);let Z=Y;function me(z){return g.isWebGL2?t.bindVertexArray(z):I.bindVertexArrayOES(z)}function S(z){return g.isWebGL2?t.deleteVertexArray(z):I.deleteVertexArrayOES(z)}function e(z){const Q=[],ae=[],ie=[];for(let he=0;he<E;he++)Q[he]=0,ae[he]=0,ie[he]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Q,enabledAttributes:ae,attributeDivisors:ie,object:z,attributes:{}}}function c(){const z=Z.newAttributes;for(let Q=0,ae=z.length;Q<ae;Q++)z[Q]=0}function p(z){_(z,0)}function _(z,Q){const ie=Z.enabledAttributes,he=Z.attributeDivisors;Z.newAttributes[z]=1,0===ie[z]&&(t.enableVertexAttribArray(z),ie[z]=1),he[z]!==Q&&((g.isWebGL2?t:u.get("ANGLE_instanced_arrays"))[g.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](z,Q),he[z]=Q)}function w(){const z=Z.newAttributes,Q=Z.enabledAttributes;for(let ae=0,ie=Q.length;ae<ie;ae++)Q[ae]!==z[ae]&&(t.disableVertexAttribArray(ae),Q[ae]=0)}function L(z,Q,ae,ie,he,ye){!0!==g.isWebGL2||5124!==ae&&5125!==ae?t.vertexAttribPointer(z,Q,ae,ie,he,ye):t.vertexAttribIPointer(z,Q,ae,he,ye)}function O(){D(),Z!==Y&&(Z=Y,me(Z.object))}function D(){Y.geometry=null,Y.program=null,Y.wireframe=!1}return{setup:function(z,Q,ae,ie,he){let ye=!1;if(V){const Me=function(Ne,$e,ze){const Ye=!0===ze.wireframe;let We=J[Ne.id];void 0===We&&(We={},J[Ne.id]=We);let nt=We[$e.id];void 0===nt&&(nt={},We[$e.id]=nt);let it=nt[Ye];return void 0===it&&(it=e(g.isWebGL2?t.createVertexArray():I.createVertexArrayOES()),nt[Ye]=it),it}(ie,ae,Q);Z!==Me&&(Z=Me,me(Z.object)),ye=function(Ne){const $e=Z.attributes,ze=Ne.attributes;if(Object.keys($e).length!==Object.keys(ze).length)return!0;for(const Ye in ze){const We=$e[Ye],nt=ze[Ye];if(We.attribute!==nt||We.data!==nt.data)return!0}return!1}(ie),ye&&function(Ne){const $e={},ze=Ne.attributes;for(const Ye in ze){const We=ze[Ye],nt={};nt.attribute=We,We.data&&(nt.data=We.data),$e[Ye]=nt}Z.attributes=$e}(ie)}else{const Me=!0===Q.wireframe;Z.geometry===ie.id&&Z.program===ae.id&&Z.wireframe===Me||(Z.geometry=ie.id,Z.program=ae.id,Z.wireframe=Me,ye=!0)}!0===z.isInstancedMesh&&(ye=!0),null!==he&&m.update(he,34963),ye&&(function(Me,Ne,$e,ze){if(!1===g.isWebGL2&&(Me.isInstancedMesh||ze.isInstancedBufferGeometry)&&null===u.get("ANGLE_instanced_arrays"))return;c();const Ye=ze.attributes,We=$e.getAttributes(),nt=Ne.defaultAttributeValues;for(const it in We){const mt=We[it];if(mt>=0){const xt=Ye[it];if(void 0!==xt){const Dt=xt.normalized,Ht=xt.itemSize,Je=m.get(xt);if(void 0===Je)continue;const pt=Je.buffer,Vt=Je.type,Nt=Je.bytesPerElement;if(xt.isInterleavedBufferAttribute){const ct=xt.data,Yt=ct.stride,St=xt.offset;ct&&ct.isInstancedInterleavedBuffer?(_(mt,ct.meshPerAttribute),void 0===ze._maxInstanceCount&&(ze._maxInstanceCount=ct.meshPerAttribute*ct.count)):p(mt),t.bindBuffer(34962,pt),L(mt,Ht,Vt,Dt,Yt*Nt,St*Nt)}else xt.isInstancedBufferAttribute?(_(mt,xt.meshPerAttribute),void 0===ze._maxInstanceCount&&(ze._maxInstanceCount=xt.meshPerAttribute*xt.count)):p(mt),t.bindBuffer(34962,pt),L(mt,Ht,Vt,Dt,0,0)}else if("instanceMatrix"===it){const Dt=m.get(Me.instanceMatrix);if(void 0===Dt)continue;const Ht=Dt.buffer,Je=Dt.type;_(mt+0,1),_(mt+1,1),_(mt+2,1),_(mt+3,1),t.bindBuffer(34962,Ht),t.vertexAttribPointer(mt+0,4,Je,!1,64,0),t.vertexAttribPointer(mt+1,4,Je,!1,64,16),t.vertexAttribPointer(mt+2,4,Je,!1,64,32),t.vertexAttribPointer(mt+3,4,Je,!1,64,48)}else if(void 0!==nt){const Dt=nt[it];if(void 0!==Dt)switch(Dt.length){case 2:t.vertexAttrib2fv(mt,Dt);break;case 3:t.vertexAttrib3fv(mt,Dt);break;case 4:t.vertexAttrib4fv(mt,Dt);break;default:t.vertexAttrib1fv(mt,Dt)}}}}w()}(z,Q,ae,ie),null!==he&&t.bindBuffer(34963,m.get(he).buffer))},reset:O,resetDefaultState:D,dispose:function(){O();for(const z in J){const Q=J[z];for(const ae in Q){const ie=Q[ae];for(const he in ie)S(ie[he].object),delete ie[he];delete Q[ae]}delete J[z]}},releaseStatesOfGeometry:function(z){if(void 0===J[z.id])return;const Q=J[z.id];for(const ae in Q){const ie=Q[ae];for(const he in ie)S(ie[he].object),delete ie[he];delete Q[ae]}delete J[z.id]},releaseStatesOfProgram:function(z){for(const Q in J){const ae=J[Q];if(void 0===ae[z.id])continue;const ie=ae[z.id];for(const he in ie)S(ie[he].object),delete ie[he];delete ae[z.id]}},initAttributes:c,enableAttribute:p,disableUnusedAttributes:w}}function li(t,u,m,g){const E=g.isWebGL2;let I;this.setMode=function(V){I=V},this.render=function(V,J){t.drawArrays(I,V,J),m.update(J,I,1)},this.renderInstances=function(V,J,Y){if(0===Y)return;let Z,me;if(E)Z=t,me="drawArraysInstanced";else if(Z=u.get("ANGLE_instanced_arrays"),me="drawArraysInstancedANGLE",null===Z)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");Z[me](I,V,J,Y),m.update(J,I,Y)}}function ar(t,u,m){let g;function E(D){if("highp"===D){if(t.getShaderPrecisionFormat(35633,36338).precision>0&&t.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";D="mediump"}return"mediump"===D&&t.getShaderPrecisionFormat(35633,36337).precision>0&&t.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const I=typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext<"u"&&t instanceof WebGL2ComputeRenderingContext;let V=void 0!==m.precision?m.precision:"highp";const J=E(V);J!==V&&(console.warn("THREE.WebGLRenderer:",V,"not supported, using",J,"instead."),V=J);const Y=!0===m.logarithmicDepthBuffer,Z=t.getParameter(34930),me=t.getParameter(35660),S=t.getParameter(3379),e=t.getParameter(34076),c=t.getParameter(34921),p=t.getParameter(36347),_=t.getParameter(36348),w=t.getParameter(36349),L=me>0,O=I||!!u.get("OES_texture_float");return{isWebGL2:I,getMaxAnisotropy:function(){if(void 0!==g)return g;const D=u.get("EXT_texture_filter_anisotropic");return g=null!==D?t.getParameter(D.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,g},getMaxPrecision:E,precision:V,logarithmicDepthBuffer:Y,maxTextures:Z,maxVertexTextures:me,maxTextureSize:S,maxCubemapSize:e,maxAttributes:c,maxVertexUniforms:p,maxVaryings:_,maxFragmentUniforms:w,vertexTextures:L,floatFragmentTextures:O,floatVertexTextures:L&&O,maxSamples:I?t.getParameter(36183):0}}function Ll(){const t=this;let u=null,m=0,g=!1,E=!1;const I=new Wo,V=new jo,J={value:null,needsUpdate:!1};function Y(){J.value!==u&&(J.value=u,J.needsUpdate=m>0),t.numPlanes=m,t.numIntersection=0}function Z(me,S,e,c){let p=null!==me?me.length:0,_=null;if(0!==p){if(_=J.value,!0!==c||null===_){const w=e+4*p,L=S.matrixWorldInverse;V.getNormalMatrix(L),(null===_||_.length<w)&&(_=new Float32Array(w));for(let O=0,D=e;O!==p;++O,D+=4)I.copy(me[O]).applyMatrix4(L,V),I.normal.toArray(_,D),_[D+3]=I.constant}J.value=_,J.needsUpdate=!0}return t.numPlanes=p,t.numIntersection=0,_}this.uniform=J,this.numPlanes=0,this.numIntersection=0,this.init=function(me,S,e){const c=0!==me.length||S||0!==m||g;return g=S,u=Z(me,e,0),m=me.length,c},this.beginShadows=function(){E=!0,Z(null)},this.endShadows=function(){E=!1,Y()},this.setState=function(me,S,e,c,p,_){if(!g||null===me||0===me.length||E&&!e)E?Z(null):Y();else{const w=E?0:m,L=4*w;let O=p.clippingState||null;J.value=O,O=Z(me,c,L,_);for(let D=0;D!==L;++D)O[D]=u[D];p.clippingState=O,this.numIntersection=S?this.numPlanes:0,this.numPlanes+=w}}}function Wc(t){const u={};return{has:function(m){if(void 0!==u[m])return u[m];let g;switch(m){case"WEBGL_depth_texture":g=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":g=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":g=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":g=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:g=t.getExtension(m)}return u[m]=g,!!g},get:function(m){return this.has(m)||console.warn("THREE.WebGLRenderer: "+m+" extension not supported."),u[m]}}}function Mo(t,u,m,g){const E=new WeakMap,I=new WeakMap;function V(Y){const Z=Y.target,me=E.get(Z);null!==me.index&&u.remove(me.index);for(const e in me.attributes)u.remove(me.attributes[e]);Z.removeEventListener("dispose",V),E.delete(Z);const S=I.get(me);S&&(u.remove(S),I.delete(me)),g.releaseStatesOfGeometry(Z),!0===Z.isInstancedBufferGeometry&&delete Z._maxInstanceCount,m.memory.geometries--}function J(Y){const Z=[],me=Y.index,S=Y.attributes.position;let e=0;if(null!==me){const _=me.array;e=me.version;for(let w=0,L=_.length;w<L;w+=3){const O=_[w+0],D=_[w+1],z=_[w+2];Z.push(O,D,D,z,z,O)}}else{e=S.version;for(let w=0,L=S.array.length/3-1;w<L;w+=3){const O=w+0,D=w+1,z=w+2;Z.push(O,D,D,z,z,O)}}const c=new(jd(Z)>65535?nl:Tl)(Z,1);c.version=e;const p=I.get(Y);p&&u.remove(p),I.set(Y,c)}return{get:function(Y,Z){let me=E.get(Z);return me||(Z.addEventListener("dispose",V),Z.isBufferGeometry?me=Z:Z.isGeometry&&(void 0===Z._bufferGeometry&&(Z._bufferGeometry=(new dn).setFromObject(Y)),me=Z._bufferGeometry),E.set(Z,me),m.memory.geometries++,me)},update:function(Y){const Z=Y.attributes;for(const S in Z)u.update(Z[S],34962);const me=Y.morphAttributes;for(const S in me){const e=me[S];for(let c=0,p=e.length;c<p;c++)u.update(e[c],34962)}},getWireframeAttribute:function(Y){const Z=I.get(Y);if(Z){const me=Y.index;null!==me&&Z.version<me.version&&J(Y)}else J(Y);return I.get(Y)}}}function Xn(t,u,m,g){const E=g.isWebGL2;let I,V,J;this.setMode=function(Y){I=Y},this.setIndex=function(Y){V=Y.type,J=Y.bytesPerElement},this.render=function(Y,Z){t.drawElements(I,Z,V,Y*J),m.update(Z,I,1)},this.renderInstances=function(Y,Z,me){if(0===me)return;let S,e;if(E)S=t,e="drawElementsInstanced";else if(S=u.get("ANGLE_instanced_arrays"),e="drawElementsInstancedANGLE",null===S)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");S[e](I,Z,V,Y*J,me),m.update(Z,I,me)}}function qc(t){const u={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:u,programs:null,autoReset:!0,reset:function(){u.frame++,u.calls=0,u.triangles=0,u.points=0,u.lines=0},update:function(m,g,E){switch(u.calls++,g){case 4:u.triangles+=E*(m/3);break;case 1:u.lines+=E*(m/2);break;case 3:u.lines+=E*(m-1);break;case 2:u.lines+=E*m;break;case 0:u.points+=E*m;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",g)}}}}function Eu(t,u){return t[0]-u[0]}function sl(t,u){return Math.abs(u[1])-Math.abs(t[1])}function Xl(t){const u={},m=new Float32Array(8),g=[];for(let E=0;E<8;E++)g[E]=[E,0];return{update:function(E,I,V,J){const Y=E.morphTargetInfluences,Z=void 0===Y?0:Y.length;let me=u[I.id];if(void 0===me){me=[];for(let _=0;_<Z;_++)me[_]=[_,0];u[I.id]=me}for(let _=0;_<Z;_++){const w=me[_];w[0]=_,w[1]=Y[_]}me.sort(sl);for(let _=0;_<8;_++)_<Z&&me[_][1]?(g[_][0]=me[_][0],g[_][1]=me[_][1]):(g[_][0]=Number.MAX_SAFE_INTEGER,g[_][1]=0);g.sort(Eu);const S=V.morphTargets&&I.morphAttributes.position,e=V.morphNormals&&I.morphAttributes.normal;let c=0;for(let _=0;_<8;_++){const w=g[_],L=w[0],O=w[1];L!==Number.MAX_SAFE_INTEGER&&O?(S&&I.getAttribute("morphTarget"+_)!==S[L]&&I.setAttribute("morphTarget"+_,S[L]),e&&I.getAttribute("morphNormal"+_)!==e[L]&&I.setAttribute("morphNormal"+_,e[L]),m[_]=O,c+=O):(S&&void 0!==I.getAttribute("morphTarget"+_)&&I.deleteAttribute("morphTarget"+_),e&&void 0!==I.getAttribute("morphNormal"+_)&&I.deleteAttribute("morphNormal"+_),m[_]=0)}const p=I.morphTargetsRelative?1:1-c;J.getUniforms().setValue(t,"morphTargetBaseInfluence",p),J.getUniforms().setValue(t,"morphTargetInfluences",m)}}}function Tu(t,u,m,g){let E=new WeakMap;return{update:function(I){const V=g.render.frame,J=I.geometry,Y=u.get(I,J);return E.get(Y)!==V&&(J.isGeometry&&Y.updateFromObject(I),u.update(Y),E.set(Y,V)),I.isInstancedMesh&&m.update(I.instanceMatrix,34962),Y},dispose:function(){E=new WeakMap}}}function ls(t,u,m,g,E,I,V,J,Y,Z){ui.call(this,t=void 0!==t?t:[],u=void 0!==u?u:bi,m,g,E,I,V=void 0!==V?V:Rs,J,Y,Z),this.flipY=!1}function za(t,u,m,g){ui.call(this,null),this.image={data:t||null,width:u||1,height:m||1,depth:g||1},this.magFilter=Or,this.minFilter=Or,this.wrapR=Xr,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}function Mu(t,u,m,g){ui.call(this,null),this.image={data:t||null,width:u||1,height:m||1,depth:g||1},this.magFilter=Or,this.minFilter=Or,this.wrapR=Xr,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}wc.physical={uniforms:Ls([wc.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new wn(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new lr(0)},transmission:{value:0},transmissionMap:{value:null}}]),vertexShader:Dr.meshphysical_vert,fragmentShader:Dr.meshphysical_frag},(ls.prototype=Object.create(ui.prototype)).constructor=ls,ls.prototype.isCubeTexture=!0,Object.defineProperty(ls.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}}),(za.prototype=Object.create(ui.prototype)).constructor=za,za.prototype.isDataTexture2DArray=!0,(Mu.prototype=Object.create(ui.prototype)).constructor=Mu,Mu.prototype.isDataTexture3D=!0;const Ea=new ui,td=new za,Bp=new Mu,ip=new ls,Xc=[],rh=[],ll=new Float32Array(16),Sc=new Float32Array(9),ys=new Float32Array(4);function Ie(t,u,m){const g=t[0];if(g<=0||g>0)return t;let E=u*m,I=Xc[E];if(void 0===I&&(I=new Float32Array(E),Xc[E]=I),0!==u){g.toArray(I,0);for(let V=1,J=0;V!==u;++V)J+=m,t[V].toArray(I,J)}return I}function je(t,u){if(t.length!==u.length)return!1;for(let m=0,g=t.length;m<g;m++)if(t[m]!==u[m])return!1;return!0}function De(t,u){for(let m=0,g=u.length;m<g;m++)t[m]=u[m]}function xe(t,u){let m=rh[u];void 0===m&&(m=new Int32Array(u),rh[u]=m);for(let g=0;g!==u;++g)m[g]=t.allocateTextureUnit();return m}function Ue(t,u){const m=this.cache;m[0]!==u&&(t.uniform1f(this.addr,u),m[0]=u)}function Xe(t,u){const m=this.cache;if(void 0!==u.x)m[0]===u.x&&m[1]===u.y||(t.uniform2f(this.addr,u.x,u.y),m[0]=u.x,m[1]=u.y);else{if(je(m,u))return;t.uniform2fv(this.addr,u),De(m,u)}}function yt(t,u){const m=this.cache;if(void 0!==u.x)m[0]===u.x&&m[1]===u.y&&m[2]===u.z||(t.uniform3f(this.addr,u.x,u.y,u.z),m[0]=u.x,m[1]=u.y,m[2]=u.z);else if(void 0!==u.r)m[0]===u.r&&m[1]===u.g&&m[2]===u.b||(t.uniform3f(this.addr,u.r,u.g,u.b),m[0]=u.r,m[1]=u.g,m[2]=u.b);else{if(je(m,u))return;t.uniform3fv(this.addr,u),De(m,u)}}function Pt(t,u){const m=this.cache;if(void 0!==u.x)m[0]===u.x&&m[1]===u.y&&m[2]===u.z&&m[3]===u.w||(t.uniform4f(this.addr,u.x,u.y,u.z,u.w),m[0]=u.x,m[1]=u.y,m[2]=u.z,m[3]=u.w);else{if(je(m,u))return;t.uniform4fv(this.addr,u),De(m,u)}}function Jt(t,u){const m=this.cache,g=u.elements;if(void 0===g){if(je(m,u))return;t.uniformMatrix2fv(this.addr,!1,u),De(m,u)}else{if(je(m,g))return;ys.set(g),t.uniformMatrix2fv(this.addr,!1,ys),De(m,g)}}function An(t,u){const m=this.cache,g=u.elements;if(void 0===g){if(je(m,u))return;t.uniformMatrix3fv(this.addr,!1,u),De(m,u)}else{if(je(m,g))return;Sc.set(g),t.uniformMatrix3fv(this.addr,!1,Sc),De(m,g)}}function Wn(t,u){const m=this.cache,g=u.elements;if(void 0===g){if(je(m,u))return;t.uniformMatrix4fv(this.addr,!1,u),De(m,u)}else{if(je(m,g))return;ll.set(g),t.uniformMatrix4fv(this.addr,!1,ll),De(m,g)}}function Dn(t,u,m){const g=this.cache,E=m.allocateTextureUnit();g[0]!==E&&(t.uniform1i(this.addr,E),g[0]=E),m.safeSetTexture2D(u||Ea,E)}function cr(t,u,m){const g=this.cache,E=m.allocateTextureUnit();g[0]!==E&&(t.uniform1i(this.addr,E),g[0]=E),m.setTexture2DArray(u||td,E)}function Pr(t,u,m){const g=this.cache,E=m.allocateTextureUnit();g[0]!==E&&(t.uniform1i(this.addr,E),g[0]=E),m.setTexture3D(u||Bp,E)}function Gn(t,u,m){const g=this.cache,E=m.allocateTextureUnit();g[0]!==E&&(t.uniform1i(this.addr,E),g[0]=E),m.safeSetTextureCube(u||ip,E)}function Zi(t,u){const m=this.cache;m[0]!==u&&(t.uniform1i(this.addr,u),m[0]=u)}function Bl(t,u){const m=this.cache;je(m,u)||(t.uniform2iv(this.addr,u),De(m,u))}function Nl(t,u){const m=this.cache;je(m,u)||(t.uniform3iv(this.addr,u),De(m,u))}function ns(t,u){const m=this.cache;je(m,u)||(t.uniform4iv(this.addr,u),De(m,u))}function ln(t,u){const m=this.cache;m[0]!==u&&(t.uniform1ui(this.addr,u),m[0]=u)}function cl(t,u){t.uniform1fv(this.addr,u)}function Gd(t,u){t.uniform1iv(this.addr,u)}function Mf(t,u){t.uniform2iv(this.addr,u)}function xi(t,u){t.uniform3iv(this.addr,u)}function Ln(t,u){t.uniform4iv(this.addr,u)}function Yf(t,u){const m=Ie(u,this.size,2);t.uniform2fv(this.addr,m)}function Jf(t,u){const m=Ie(u,this.size,3);t.uniform3fv(this.addr,m)}function gr(t,u){const m=Ie(u,this.size,4);t.uniform4fv(this.addr,m)}function Np(t,u){const m=Ie(u,this.size,4);t.uniformMatrix2fv(this.addr,!1,m)}function ul(t,u){const m=Ie(u,this.size,9);t.uniformMatrix3fv(this.addr,!1,m)}function hl(t,u){const m=Ie(u,this.size,16);t.uniformMatrix4fv(this.addr,!1,m)}function Au(t,u,m){const g=u.length,E=xe(m,g);t.uniform1iv(this.addr,E);for(let I=0;I!==g;++I)m.safeSetTexture2D(u[I]||Ea,E[I])}function Zf(t,u,m){const g=u.length,E=xe(m,g);t.uniform1iv(this.addr,E);for(let I=0;I!==g;++I)m.safeSetTextureCube(u[I]||ip,E[I])}function Ta(t,u,m){this.id=t,this.addr=m,this.cache=[],this.setValue=function(g){switch(g){case 5126:return Ue;case 35664:return Xe;case 35665:return yt;case 35666:return Pt;case 35674:return Jt;case 35675:return An;case 35676:return Wn;case 5124:case 35670:return Zi;case 35667:case 35671:return Bl;case 35668:case 35672:return Nl;case 35669:case 35673:return ns;case 5125:return ln;case 35678:case 36198:case 36298:case 36306:case 35682:return Dn;case 35679:case 36299:case 36307:return Pr;case 35680:case 36300:case 36308:case 36293:return Gn;case 36289:case 36303:case 36311:case 36292:return cr}}(u.type)}function ih(t,u,m){this.id=t,this.addr=m,this.cache=[],this.size=u.size,this.setValue=function(g){switch(g){case 5126:return cl;case 35664:return Yf;case 35665:return Jf;case 35666:return gr;case 35674:return Np;case 35675:return ul;case 35676:return hl;case 5124:case 35670:return Gd;case 35667:case 35671:return Mf;case 35668:case 35672:return xi;case 35669:case 35673:return Ln;case 35678:case 36198:case 36298:case 36306:case 35682:return Au;case 35680:case 36300:case 36308:case 36293:return Zf}}(u.type)}function oh(t){this.id=t,this.seq=[],this.map={}}ih.prototype.updateCache=function(t){let u=this.cache;t instanceof Float32Array&&u.length!==t.length&&(this.cache=new Float32Array(t.length)),De(u,t)},oh.prototype.setValue=function(t,u,m){const g=this.seq;for(let E=0,I=g.length;E!==I;++E){const V=g[E];V.setValue(t,u[V.id],m)}};const Hd=/([\w\d_]+)(\])?(\[|\.)?/g;function cf(t,u){t.seq.push(u),t.map[u.id]=u}function $m(t,u,m){const g=t.name,E=g.length;for(Hd.lastIndex=0;;){const I=Hd.exec(g);let J=I[1],Z=I[3];if("]"===I[2]&&(J|=0),void 0===Z||"["===Z&&Hd.lastIndex+2===E){cf(m,void 0===Z?new Ta(J,t,u):new ih(J,t,u));break}{let me=m.map[J];void 0===me&&(me=new oh(J),cf(m,me)),m=me}}}function Rp(t,u){this.seq=[],this.map={};const m=t.getProgramParameter(u,35718);for(let g=0;g<m;++g){const E=t.getActiveUniform(u,g);$m(E,t.getUniformLocation(u,E.name),this)}}function Qf(t,u,m){const g=t.createShader(u);return t.shaderSource(g,m),t.compileShader(g),g}Rp.prototype.setValue=function(t,u,m,g){const E=this.map[u];void 0!==E&&E.setValue(t,m,g)},Rp.prototype.setOptional=function(t,u,m){const g=u[m];void 0!==g&&this.setValue(t,m,g)},Rp.upload=function(t,u,m,g){for(let E=0,I=u.length;E!==I;++E){const V=u[E],J=m[V.id];!1!==J.needsUpdate&&V.setValue(t,J.value,g)}},Rp.seqWithValue=function(t,u){const m=[];for(let g=0,E=t.length;g!==E;++g){const I=t[g];I.id in u&&m.push(I)}return m};let Cm=0;function Kf(t){switch(t){case Qi:return["Linear","( value )"];case Ka:return["sRGB","( value )"];case Uc:return["RGBE","( value )"];case cc:return["RGBM","( value, 7.0 )"];case Ju:return["RGBM","( value, 16.0 )"];case gu:return["RGBD","( value, 256.0 )"];case Gl:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case Yh:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",t),["Linear","( value )"]}}function em(t,u,m){const g=t.getShaderParameter(u,35713),E=t.getShaderInfoLog(u).trim();return g&&""===E?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+m+"\n"+E+function(I){const V=I.split("\n");for(let J=0;J<V.length;J++)V[J]=J+1+": "+V[J];return V.join("\n")}(t.getShaderSource(u))}function Vd(t,u){const m=Kf(u);return"vec4 "+t+"( vec4 value ) { return "+m[0]+"ToLinear"+m[1]+"; }"}function Lm(t,u){const m=Kf(u);return"vec4 "+t+"( vec4 value ) { return LinearTo"+m[0]+m[1]+"; }"}function Bm(t,u){let m;switch(u){case pi:m="Linear";break;case go:m="Reinhard";break;case Nr:m="OptimizedCineon";break;case Zr:m="ACESFilmic";break;case Vr:m="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",u),m="Linear"}return"vec3 "+t+"( vec3 color ) { return "+m+"ToneMapping( color ); }"}function Wd(t){return""!==t}function tm(t,u){return t.replace(/NUM_DIR_LIGHTS/g,u.numDirLights).replace(/NUM_SPOT_LIGHTS/g,u.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,u.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,u.numPointLights).replace(/NUM_HEMI_LIGHTS/g,u.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,u.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,u.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,u.numPointLightShadows)}function nm(t,u){return t.replace(/NUM_CLIPPING_PLANES/g,u.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,u.numClippingPlanes-u.numClipIntersection)}const Nm=/^[ \t]*#include +<([\w\d./]+)>/gm;function Af(t){return t.replace(Nm,qd)}function qd(t,u){const m=Dr[u];if(void 0===m)throw new Error("Can not resolve #include <"+u+">");return Af(m)}const Rm=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,Xd=/#pragma unroll_loop_start[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}[\s]+?#pragma unroll_loop_end/g;function Pp(t){return t.replace(Xd,rm).replace(Rm,Pm)}function Pm(t,u,m,g){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),rm(0,u,m,g)}function rm(t,u,m,g){let E="";for(let I=parseInt(u);I<parseInt(m);I++)E+=g.replace(/\[ i \]/g,"[ "+I+" ]").replace(/UNROLLED_LOOP_INDEX/g,I);return E}function im(t){let u="precision "+t.precision+" float;\nprecision "+t.precision+" int;";return"highp"===t.precision?u+="\n#define HIGH_PRECISION":"mediump"===t.precision?u+="\n#define MEDIUM_PRECISION":"lowp"===t.precision&&(u+="\n#define LOW_PRECISION"),u}function Im(t,u,m,g){const E=t.getContext(),I=m.defines;let V=m.vertexShader,J=m.fragmentShader;const Y=function(ie){let he="SHADOWMAP_TYPE_BASIC";return ie.shadowMapType===te?he="SHADOWMAP_TYPE_PCF":ie.shadowMapType===ce?he="SHADOWMAP_TYPE_PCF_SOFT":ie.shadowMapType===fe&&(he="SHADOWMAP_TYPE_VSM"),he}(m),Z=function(ie){let he="ENVMAP_TYPE_CUBE";if(ie.envMap)switch(ie.envMapMode){case bi:case So:he="ENVMAP_TYPE_CUBE";break;case Di:case Eo:he="ENVMAP_TYPE_CUBE_UV";break;case Gs:case Ks:he="ENVMAP_TYPE_EQUIREC"}return he}(m),me=function(ie){let he="ENVMAP_MODE_REFLECTION";if(ie.envMap)switch(ie.envMapMode){case So:case Ks:case Eo:he="ENVMAP_MODE_REFRACTION"}return he}(m),S=function(ie){let he="ENVMAP_BLENDING_NONE";if(ie.envMap)switch(ie.combine){case Jr:he="ENVMAP_BLENDING_MULTIPLY";break;case ci:he="ENVMAP_BLENDING_MIX";break;case ir:he="ENVMAP_BLENDING_ADD"}return he}(m),e=t.gammaFactor>0?t.gammaFactor:1,c=m.isWebGL2?"":[(ie=m).extensionDerivatives||ie.envMapCubeUV||ie.bumpMap||ie.tangentSpaceNormalMap||ie.clearcoatNormalMap||ie.flatShading||"physical"===ie.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(ie.extensionFragDepth||ie.logarithmicDepthBuffer)&&ie.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",ie.extensionDrawBuffers&&ie.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(ie.extensionShaderTextureLOD||ie.envMap)&&ie.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Wd).join("\n"),p=function(ie){const he=[];for(const ye in ie){const Me=ie[ye];!1!==Me&&he.push("#define "+ye+" "+Me)}return he.join("\n")}(I),_=E.createProgram();var ie;let w,L;m.isRawShaderMaterial?(w=[p].filter(Wd).join("\n"),w.length>0&&(w+="\n"),L=[c,p].filter(Wd).join("\n"),L.length>0&&(L+="\n")):(w=[im(m),"#define SHADER_NAME "+m.shaderName,p,m.instancing?"#define USE_INSTANCING":"",m.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+e,"#define MAX_BONES "+m.maxBones,m.useFog&&m.fog?"#define USE_FOG":"",m.useFog&&m.fogExp2?"#define FOG_EXP2":"",m.map?"#define USE_MAP":"",m.envMap?"#define USE_ENVMAP":"",m.envMap?"#define "+me:"",m.lightMap?"#define USE_LIGHTMAP":"",m.aoMap?"#define USE_AOMAP":"",m.emissiveMap?"#define USE_EMISSIVEMAP":"",m.bumpMap?"#define USE_BUMPMAP":"",m.normalMap?"#define USE_NORMALMAP":"",m.normalMap&&m.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",m.normalMap&&m.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",m.clearcoatMap?"#define USE_CLEARCOATMAP":"",m.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",m.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",m.displacementMap&&m.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",m.specularMap?"#define USE_SPECULARMAP":"",m.roughnessMap?"#define USE_ROUGHNESSMAP":"",m.metalnessMap?"#define USE_METALNESSMAP":"",m.alphaMap?"#define USE_ALPHAMAP":"",m.transmissionMap?"#define USE_TRANSMISSIONMAP":"",m.vertexTangents?"#define USE_TANGENT":"",m.vertexColors?"#define USE_COLOR":"",m.vertexUvs?"#define USE_UV":"",m.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",m.flatShading?"#define FLAT_SHADED":"",m.skinning?"#define USE_SKINNING":"",m.useVertexTexture?"#define BONE_TEXTURE":"",m.morphTargets?"#define USE_MORPHTARGETS":"",m.morphNormals&&!1===m.flatShading?"#define USE_MORPHNORMALS":"",m.doubleSided?"#define DOUBLE_SIDED":"",m.flipSided?"#define FLIP_SIDED":"",m.shadowMapEnabled?"#define USE_SHADOWMAP":"",m.shadowMapEnabled?"#define "+Y:"",m.sizeAttenuation?"#define USE_SIZEATTENUATION":"",m.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",m.logarithmicDepthBuffer&&m.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING"," attribute mat4 instanceMatrix;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Wd).join("\n"),L=[c,im(m),"#define SHADER_NAME "+m.shaderName,p,m.alphaTest?"#define ALPHATEST "+m.alphaTest+(m.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+e,m.useFog&&m.fog?"#define USE_FOG":"",m.useFog&&m.fogExp2?"#define FOG_EXP2":"",m.map?"#define USE_MAP":"",m.matcap?"#define USE_MATCAP":"",m.envMap?"#define USE_ENVMAP":"",m.envMap?"#define "+Z:"",m.envMap?"#define "+me:"",m.envMap?"#define "+S:"",m.lightMap?"#define USE_LIGHTMAP":"",m.aoMap?"#define USE_AOMAP":"",m.emissiveMap?"#define USE_EMISSIVEMAP":"",m.bumpMap?"#define USE_BUMPMAP":"",m.normalMap?"#define USE_NORMALMAP":"",m.normalMap&&m.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",m.normalMap&&m.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",m.clearcoatMap?"#define USE_CLEARCOATMAP":"",m.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",m.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",m.specularMap?"#define USE_SPECULARMAP":"",m.roughnessMap?"#define USE_ROUGHNESSMAP":"",m.metalnessMap?"#define USE_METALNESSMAP":"",m.alphaMap?"#define USE_ALPHAMAP":"",m.sheen?"#define USE_SHEEN":"",m.transmissionMap?"#define USE_TRANSMISSIONMAP":"",m.vertexTangents?"#define USE_TANGENT":"",m.vertexColors?"#define USE_COLOR":"",m.vertexUvs?"#define USE_UV":"",m.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",m.gradientMap?"#define USE_GRADIENTMAP":"",m.flatShading?"#define FLAT_SHADED":"",m.doubleSided?"#define DOUBLE_SIDED":"",m.flipSided?"#define FLIP_SIDED":"",m.shadowMapEnabled?"#define USE_SHADOWMAP":"",m.shadowMapEnabled?"#define "+Y:"",m.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",m.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",m.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",m.logarithmicDepthBuffer&&m.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(m.extensionShaderTextureLOD||m.envMap)&&m.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",m.toneMapping!==vr?"#define TONE_MAPPING":"",m.toneMapping!==vr?Dr.tonemapping_pars_fragment:"",m.toneMapping!==vr?Bm("toneMapping",m.toneMapping):"",m.dithering?"#define DITHERING":"",Dr.encodings_pars_fragment,m.map?Vd("mapTexelToLinear",m.mapEncoding):"",m.matcap?Vd("matcapTexelToLinear",m.matcapEncoding):"",m.envMap?Vd("envMapTexelToLinear",m.envMapEncoding):"",m.emissiveMap?Vd("emissiveMapTexelToLinear",m.emissiveMapEncoding):"",m.lightMap?Vd("lightMapTexelToLinear",m.lightMapEncoding):"",Lm("linearToOutputTexel",m.outputEncoding),m.depthPacking?"#define DEPTH_PACKING "+m.depthPacking:"","\n"].filter(Wd).join("\n")),V=Af(V),V=tm(V,m),V=nm(V,m),J=Af(J),J=tm(J,m),J=nm(J,m),V=Pp(V),J=Pp(J),m.isWebGL2&&!m.isRawShaderMaterial&&(w=["#version 300 es\n","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+w,L=["#version 300 es\n","#define varying in","out highp vec4 pc_fragColor;","#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+L);const O=L+J,D=Qf(E,35633,w+V),z=Qf(E,35632,O);if(E.attachShader(_,D),E.attachShader(_,z),void 0!==m.index0AttributeName?E.bindAttribLocation(_,0,m.index0AttributeName):!0===m.morphTargets&&E.bindAttribLocation(_,0,"position"),E.linkProgram(_),t.debug.checkShaderErrors){const ie=E.getProgramInfoLog(_).trim(),he=E.getShaderInfoLog(D).trim(),ye=E.getShaderInfoLog(z).trim();let Me=!0,Ne=!0;if(!1===E.getProgramParameter(_,35714)){Me=!1;const $e=em(E,D,"vertex"),ze=em(E,z,"fragment");console.error("THREE.WebGLProgram: shader error: ",E.getError(),"35715",E.getProgramParameter(_,35715),"gl.getProgramInfoLog",ie,$e,ze)}else""!==ie?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",ie):""!==he&&""!==ye||(Ne=!1);Ne&&(this.diagnostics={runnable:Me,programLog:ie,vertexShader:{log:he,prefix:w},fragmentShader:{log:ye,prefix:L}})}let Q,ae;return E.deleteShader(D),E.deleteShader(z),this.getUniforms=function(){return void 0===Q&&(Q=new Rp(E,_)),Q},this.getAttributes=function(){return void 0===ae&&(ae=function(ie,he){const ye={},Me=ie.getProgramParameter(he,35721);for(let Ne=0;Ne<Me;Ne++){const $e=ie.getActiveAttrib(he,Ne).name;ye[$e]=ie.getAttribLocation(he,$e)}return ye}(E,_)),ae},this.destroy=function(){g.releaseStatesOfProgram(this),E.deleteProgram(_),this.program=void 0},this.name=m.shaderName,this.id=Cm++,this.cacheKey=u,this.usedTimes=1,this.program=_,this.vertexShader=D,this.fragmentShader=z,this}function Om(t,u,m,g){const E=[],I=m.isWebGL2,V=m.logarithmicDepthBuffer,J=m.floatVertexTextures,Y=m.maxVertexUniforms,Z=m.vertexTextures;let me=m.precision;const S={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},e=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmissionMap"];function c(p){let _;return p?p.isTexture?_=p.encoding:p.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),_=p.texture.encoding):_=Qi,_}return{getParameters:function(p,_,w,L,O,D,z){const Q=L.fog,ie=p.envMap||(p.isMeshStandardMaterial?L.environment:null),he=S[p.type],ye=z.isSkinnedMesh?function(ze){const Ye=ze.skeleton.bones;if(J)return 1024;{const nt=Math.floor((Y-20)/4),it=Math.min(nt,Ye.length);return it<Ye.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+Ye.length+" bones. This GPU supports "+it+"."),0):it}}(z):0;let Me,Ne;if(null!==p.precision&&(me=m.getMaxPrecision(p.precision),me!==p.precision&&console.warn("THREE.WebGLProgram.getParameters:",p.precision,"not supported, using",me,"instead.")),he){const ze=wc[he];Me=ze.vertexShader,Ne=ze.fragmentShader}else Me=p.vertexShader,Ne=p.fragmentShader;const $e=t.getRenderTarget();return{isWebGL2:I,shaderID:he,shaderName:p.type,vertexShader:Me,fragmentShader:Ne,defines:p.defines,isRawShaderMaterial:p.isRawShaderMaterial,isShaderMaterial:p.isShaderMaterial,precision:me,instancing:!0===z.isInstancedMesh,supportsVertexTextures:Z,outputEncoding:null!==$e?c($e.texture):t.outputEncoding,map:!!p.map,mapEncoding:c(p.map),matcap:!!p.matcap,matcapEncoding:c(p.matcap),envMap:!!ie,envMapMode:ie&&ie.mapping,envMapEncoding:c(ie),envMapCubeUV:!!ie&&(ie.mapping===Di||ie.mapping===Eo),lightMap:!!p.lightMap,lightMapEncoding:c(p.lightMap),aoMap:!!p.aoMap,emissiveMap:!!p.emissiveMap,emissiveMapEncoding:c(p.emissiveMap),bumpMap:!!p.bumpMap,normalMap:!!p.normalMap,objectSpaceNormalMap:p.normalMapType===Le,tangentSpaceNormalMap:p.normalMapType===Te,clearcoatMap:!!p.clearcoatMap,clearcoatRoughnessMap:!!p.clearcoatRoughnessMap,clearcoatNormalMap:!!p.clearcoatNormalMap,displacementMap:!!p.displacementMap,roughnessMap:!!p.roughnessMap,metalnessMap:!!p.metalnessMap,specularMap:!!p.specularMap,alphaMap:!!p.alphaMap,gradientMap:!!p.gradientMap,sheen:!!p.sheen,transmissionMap:!!p.transmissionMap,combine:p.combine,vertexTangents:p.normalMap&&p.vertexTangents,vertexColors:p.vertexColors,vertexUvs:!!(p.map||p.bumpMap||p.normalMap||p.specularMap||p.alphaMap||p.emissiveMap||p.roughnessMap||p.metalnessMap||p.clearcoatMap||p.clearcoatRoughnessMap||p.clearcoatNormalMap||p.displacementMap||p.transmissionMap),uvsVertexOnly:!(p.map||p.bumpMap||p.normalMap||p.specularMap||p.alphaMap||p.emissiveMap||p.roughnessMap||p.metalnessMap||p.clearcoatNormalMap||p.transmissionMap||!p.displacementMap),fog:!!Q,useFog:p.fog,fogExp2:Q&&Q.isFogExp2,flatShading:p.flatShading,sizeAttenuation:p.sizeAttenuation,logarithmicDepthBuffer:V,skinning:p.skinning&&ye>0,maxBones:ye,useVertexTexture:J,morphTargets:p.morphTargets,morphNormals:p.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:_.directional.length,numPointLights:_.point.length,numSpotLights:_.spot.length,numRectAreaLights:_.rectArea.length,numHemiLights:_.hemi.length,numDirLightShadows:_.directionalShadowMap.length,numPointLightShadows:_.pointShadowMap.length,numSpotLightShadows:_.spotShadowMap.length,numClippingPlanes:O,numClipIntersection:D,dithering:p.dithering,shadowMapEnabled:t.shadowMap.enabled&&w.length>0,shadowMapType:t.shadowMap.type,toneMapping:p.toneMapped?t.toneMapping:vr,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:p.premultipliedAlpha,alphaTest:p.alphaTest,doubleSided:p.side===pe,flipSided:p.side===le,depthPacking:void 0!==p.depthPacking&&p.depthPacking,index0AttributeName:p.index0AttributeName,extensionDerivatives:p.extensions&&p.extensions.derivatives,extensionFragDepth:p.extensions&&p.extensions.fragDepth,extensionDrawBuffers:p.extensions&&p.extensions.drawBuffers,extensionShaderTextureLOD:p.extensions&&p.extensions.shaderTextureLOD,rendererExtensionFragDepth:I||null!==u.get("EXT_frag_depth"),rendererExtensionDrawBuffers:I||null!==u.get("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:I||null!==u.get("EXT_shader_texture_lod"),customProgramCacheKey:p.customProgramCacheKey()}},getProgramCacheKey:function(p){const _=[];if(p.shaderID?_.push(p.shaderID):(_.push(p.fragmentShader),_.push(p.vertexShader)),void 0!==p.defines)for(const w in p.defines)_.push(w),_.push(p.defines[w]);if(void 0===p.isRawShaderMaterial){for(let w=0;w<e.length;w++)_.push(p[e[w]]);_.push(t.outputEncoding),_.push(t.gammaFactor)}return _.push(p.customProgramCacheKey),_.join()},getUniforms:function(p){const _=S[p.type];let w;return w=_?Po.clone(wc[_].uniforms):p.uniforms,w},acquireProgram:function(p,_){let w;for(let L=0,O=E.length;L<O;L++){const D=E[L];if(D.cacheKey===_){w=D,++w.usedTimes;break}}return void 0===w&&(w=new Im(t,_,p,g),E.push(w)),w},releaseProgram:function(p){if(0==--p.usedTimes){const _=E.indexOf(p);E[_]=E[E.length-1],E.pop(),p.destroy()}},programs:E}}function uf(){let t=new WeakMap;return{get:function(u){let m=t.get(u);return void 0===m&&(m={},t.set(u,m)),m},remove:function(u){t.delete(u)},update:function(u,m,g){t.get(u)[m]=g},dispose:function(){t=new WeakMap}}}function km(t,u){return t.groupOrder!==u.groupOrder?t.groupOrder-u.groupOrder:t.renderOrder!==u.renderOrder?t.renderOrder-u.renderOrder:t.program!==u.program?t.program.id-u.program.id:t.material.id!==u.material.id?t.material.id-u.material.id:t.z!==u.z?t.z-u.z:t.id-u.id}function Fm(t,u){return t.groupOrder!==u.groupOrder?t.groupOrder-u.groupOrder:t.renderOrder!==u.renderOrder?t.renderOrder-u.renderOrder:t.z!==u.z?u.z-t.z:t.id-u.id}function Yl(t){const u=[];let m=0;const g=[],E=[],I={id:-1};function V(J,Y,Z,me,S,e){let c=u[m];const p=t.get(Z);return void 0===c?(c={id:J.id,object:J,geometry:Y,material:Z,program:p.program||I,groupOrder:me,renderOrder:J.renderOrder,z:S,group:e},u[m]=c):(c.id=J.id,c.object=J,c.geometry=Y,c.material=Z,c.program=p.program||I,c.groupOrder=me,c.renderOrder=J.renderOrder,c.z=S,c.group=e),m++,c}return{opaque:g,transparent:E,init:function(){m=0,g.length=0,E.length=0},push:function(J,Y,Z,me,S,e){const c=V(J,Y,Z,me,S,e);(!0===Z.transparent?E:g).push(c)},unshift:function(J,Y,Z,me,S,e){const c=V(J,Y,Z,me,S,e);(!0===Z.transparent?E:g).unshift(c)},finish:function(){for(let J=m,Y=u.length;J<Y;J++){const Z=u[J];if(null===Z.id)break;Z.id=null,Z.object=null,Z.geometry=null,Z.material=null,Z.program=null,Z.group=null}},sort:function(J,Y){g.length>1&&g.sort(J||km),E.length>1&&E.sort(Y||Fm)}}}function $f(t){let u=new WeakMap;function m(g){const E=g.target;E.removeEventListener("dispose",m),u.delete(E)}return{get:function(g,E){const I=u.get(g);let V;return void 0===I?(V=new Yl(t),u.set(g,new WeakMap),u.get(g).set(E,V),g.addEventListener("dispose",m)):(V=I.get(E),void 0===V&&(V=new Yl(t),I.set(E,V))),V},dispose:function(){u=new WeakMap}}}function om(){const t={};return{get:function(u){if(void 0!==t[u.id])return t[u.id];let m;switch(u.type){case"DirectionalLight":m={direction:new ot,color:new lr};break;case"SpotLight":m={position:new ot,direction:new ot,color:new lr,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":m={position:new ot,color:new lr,distance:0,decay:0};break;case"HemisphereLight":m={direction:new ot,skyColor:new lr,groundColor:new lr};break;case"RectAreaLight":m={color:new lr,position:new ot,halfWidth:new ot,halfHeight:new ot}}return t[u.id]=m,m}}}let sm=0;function Cf(t,u){return(u.castShadow?1:0)-(t.castShadow?1:0)}function am(){const t=new om,u=function(){const V={};return{get:function(J){if(void 0!==V[J.id])return V[J.id];let Y;switch(J.type){case"DirectionalLight":case"SpotLight":Y={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new wn};break;case"PointLight":Y={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new wn,shadowCameraNear:1,shadowCameraFar:1e3}}return V[J.id]=Y,Y}}}(),m={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let V=0;V<9;V++)m.probe.push(new ot);const g=new ot,E=new ti,I=new ti;return{setup:function(V,J,Y){let Z=0,me=0,S=0;for(let ae=0;ae<9;ae++)m.probe[ae].set(0,0,0);let e=0,c=0,p=0,_=0,w=0,L=0,O=0,D=0;const z=Y.matrixWorldInverse;V.sort(Cf);for(let ae=0,ie=V.length;ae<ie;ae++){const he=V[ae],ye=he.color,Me=he.intensity,Ne=he.distance,$e=he.shadow&&he.shadow.map?he.shadow.map.texture:null;if(he.isAmbientLight)Z+=ye.r*Me,me+=ye.g*Me,S+=ye.b*Me;else if(he.isLightProbe)for(let ze=0;ze<9;ze++)m.probe[ze].addScaledVector(he.sh.coefficients[ze],Me);else if(he.isDirectionalLight){const ze=t.get(he);if(ze.color.copy(he.color).multiplyScalar(he.intensity),ze.direction.setFromMatrixPosition(he.matrixWorld),g.setFromMatrixPosition(he.target.matrixWorld),ze.direction.sub(g),ze.direction.transformDirection(z),he.castShadow){const Ye=he.shadow,We=u.get(he);We.shadowBias=Ye.bias,We.shadowNormalBias=Ye.normalBias,We.shadowRadius=Ye.radius,We.shadowMapSize=Ye.mapSize,m.directionalShadow[e]=We,m.directionalShadowMap[e]=$e,m.directionalShadowMatrix[e]=he.shadow.matrix,L++}m.directional[e]=ze,e++}else if(he.isSpotLight){const ze=t.get(he);if(ze.position.setFromMatrixPosition(he.matrixWorld),ze.position.applyMatrix4(z),ze.color.copy(ye).multiplyScalar(Me),ze.distance=Ne,ze.direction.setFromMatrixPosition(he.matrixWorld),g.setFromMatrixPosition(he.target.matrixWorld),ze.direction.sub(g),ze.direction.transformDirection(z),ze.coneCos=Math.cos(he.angle),ze.penumbraCos=Math.cos(he.angle*(1-he.penumbra)),ze.decay=he.decay,he.castShadow){const Ye=he.shadow,We=u.get(he);We.shadowBias=Ye.bias,We.shadowNormalBias=Ye.normalBias,We.shadowRadius=Ye.radius,We.shadowMapSize=Ye.mapSize,m.spotShadow[p]=We,m.spotShadowMap[p]=$e,m.spotShadowMatrix[p]=he.shadow.matrix,D++}m.spot[p]=ze,p++}else if(he.isRectAreaLight){const ze=t.get(he);ze.color.copy(ye).multiplyScalar(Me),ze.position.setFromMatrixPosition(he.matrixWorld),ze.position.applyMatrix4(z),I.identity(),E.copy(he.matrixWorld),E.premultiply(z),I.extractRotation(E),ze.halfWidth.set(.5*he.width,0,0),ze.halfHeight.set(0,.5*he.height,0),ze.halfWidth.applyMatrix4(I),ze.halfHeight.applyMatrix4(I),m.rectArea[_]=ze,_++}else if(he.isPointLight){const ze=t.get(he);if(ze.position.setFromMatrixPosition(he.matrixWorld),ze.position.applyMatrix4(z),ze.color.copy(he.color).multiplyScalar(he.intensity),ze.distance=he.distance,ze.decay=he.decay,he.castShadow){const Ye=he.shadow,We=u.get(he);We.shadowBias=Ye.bias,We.shadowNormalBias=Ye.normalBias,We.shadowRadius=Ye.radius,We.shadowMapSize=Ye.mapSize,We.shadowCameraNear=Ye.camera.near,We.shadowCameraFar=Ye.camera.far,m.pointShadow[c]=We,m.pointShadowMap[c]=$e,m.pointShadowMatrix[c]=he.shadow.matrix,O++}m.point[c]=ze,c++}else if(he.isHemisphereLight){const ze=t.get(he);ze.direction.setFromMatrixPosition(he.matrixWorld),ze.direction.transformDirection(z),ze.direction.normalize(),ze.skyColor.copy(he.color).multiplyScalar(Me),ze.groundColor.copy(he.groundColor).multiplyScalar(Me),m.hemi[w]=ze,w++}}m.ambient[0]=Z,m.ambient[1]=me,m.ambient[2]=S;const Q=m.hash;Q.directionalLength===e&&Q.pointLength===c&&Q.spotLength===p&&Q.rectAreaLength===_&&Q.hemiLength===w&&Q.numDirectionalShadows===L&&Q.numPointShadows===O&&Q.numSpotShadows===D||(m.directional.length=e,m.spot.length=p,m.rectArea.length=_,m.point.length=c,m.hemi.length=w,m.directionalShadow.length=L,m.directionalShadowMap.length=L,m.pointShadow.length=O,m.pointShadowMap.length=O,m.spotShadow.length=D,m.spotShadowMap.length=D,m.directionalShadowMatrix.length=L,m.pointShadowMatrix.length=O,m.spotShadowMatrix.length=D,Q.directionalLength=e,Q.pointLength=c,Q.spotLength=p,Q.rectAreaLength=_,Q.hemiLength=w,Q.numDirectionalShadows=L,Q.numPointShadows=O,Q.numSpotShadows=D,m.version=sm++)},state:m}}function hf(){const t=new am,u=[],m=[];return{init:function(){u.length=0,m.length=0},state:{lightsArray:u,shadowsArray:m,lights:t},setupLights:function(g){t.setup(u,m,g)},pushLight:function(g){u.push(g)},pushShadow:function(g){m.push(g)}}}function Lf(){let t=new WeakMap;function u(m){const g=m.target;g.removeEventListener("dispose",u),t.delete(g)}return{get:function(m,g){let E;return!1===t.has(m)?(E=new hf,t.set(m,new WeakMap),t.get(m).set(g,E),m.addEventListener("dispose",u)):!1===t.get(m).has(g)?(E=new hf,t.get(m).set(g,E)):E=t.get(m).get(g),E},dispose:function(){t=new WeakMap}}}function sh(t){Ur.call(this),this.type="MeshDepthMaterial",this.depthPacking=W,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(t)}function Ip(t){Ur.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new ot,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(t)}(sh.prototype=Object.create(Ur.prototype)).constructor=sh,sh.prototype.isMeshDepthMaterial=!0,sh.prototype.copy=function(t){return Ur.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},(Ip.prototype=Object.create(Ur.prototype)).constructor=Ip,Ip.prototype.isMeshDistanceMaterial=!0,Ip.prototype.copy=function(t){return Ur.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this};var Ah="uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n  float mean = 0.0;\n  float squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy  ) / resolution ) );\n  for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n    #ifdef HORIZONAL_PASS\n      vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n      mean += distribution.x;\n      squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n    #else\n      float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0,  i )  * radius ) / resolution ) );\n      mean += depth;\n      squared_mean += depth * depth;\n    #endif\n  }\n  mean = mean * HALF_SAMPLE_RATE;\n  squared_mean = squared_mean * HALF_SAMPLE_RATE;\n  float std_dev = sqrt( squared_mean - mean * mean );\n  gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}",Yd="void main() {\n\tgl_Position = vec4( position, 1.0 );\n}";function lm(t,u,m){let g=new Vc;const E=new wn,I=new wn,V=new gi,J=[],Y=[],Z={},me={0:le,1:_e,2:pe},S=new uo({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new wn},radius:{value:4}},vertexShader:Yd,fragmentShader:Ah}),e=S.clone();e.defines.HORIZONAL_PASS=1;const c=new dn;c.setAttribute("position",new Gr(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const p=new Bi(c,S),_=this;function w(Q,ae){const ie=u.update(p);S.uniforms.shadow_pass.value=Q.map.texture,S.uniforms.resolution.value=Q.mapSize,S.uniforms.radius.value=Q.radius,t.setRenderTarget(Q.mapPass),t.clear(),t.renderBufferDirect(ae,null,ie,S,p,null),e.uniforms.shadow_pass.value=Q.mapPass.texture,e.uniforms.resolution.value=Q.mapSize,e.uniforms.radius.value=Q.radius,t.setRenderTarget(Q.map),t.clear(),t.renderBufferDirect(ae,null,ie,e,p,null)}function L(Q,ae,ie){const he=Q|ae<<1|ie<<2;let ye=J[he];return void 0===ye&&(ye=new sh({depthPacking:ue,morphTargets:Q,skinning:ae}),J[he]=ye),ye}function O(Q,ae,ie){const he=Q|ae<<1|ie<<2;let ye=Y[he];return void 0===ye&&(ye=new Ip({morphTargets:Q,skinning:ae}),Y[he]=ye),ye}function D(Q,ae,ie,he,ye,Me,Ne){let $e=null,ze=L,Ye=Q.customDepthMaterial;if(!0===he.isPointLight&&(ze=O,Ye=Q.customDistanceMaterial),void 0===Ye){let We=!1;!0===ie.morphTargets&&(We=ae.morphAttributes&&ae.morphAttributes.position&&ae.morphAttributes.position.length>0);let nt=!1;!0===Q.isSkinnedMesh&&(!0===ie.skinning?nt=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",Q)),$e=ze(We,nt,!0===Q.isInstancedMesh)}else $e=Ye;if(t.localClippingEnabled&&!0===ie.clipShadows&&0!==ie.clippingPlanes.length){const We=$e.uuid,nt=ie.uuid;let it=Z[We];void 0===it&&(it={},Z[We]=it);let mt=it[nt];void 0===mt&&(mt=$e.clone(),it[nt]=mt),$e=mt}return $e.visible=ie.visible,$e.wireframe=ie.wireframe,$e.side=Ne===fe?null!==ie.shadowSide?ie.shadowSide:ie.side:null!==ie.shadowSide?ie.shadowSide:me[ie.side],$e.clipShadows=ie.clipShadows,$e.clippingPlanes=ie.clippingPlanes,$e.clipIntersection=ie.clipIntersection,$e.wireframeLinewidth=ie.wireframeLinewidth,$e.linewidth=ie.linewidth,!0===he.isPointLight&&!0===$e.isMeshDistanceMaterial&&($e.referencePosition.setFromMatrixPosition(he.matrixWorld),$e.nearDistance=ye,$e.farDistance=Me),$e}function z(Q,ae,ie,he,ye){if(!1===Q.visible)return;if(Q.layers.test(ae.layers)&&(Q.isMesh||Q.isLine||Q.isPoints)&&(Q.castShadow||Q.receiveShadow&&ye===fe)&&(!Q.frustumCulled||g.intersectsObject(Q))){Q.modelViewMatrix.multiplyMatrices(ie.matrixWorldInverse,Q.matrixWorld);const Ne=u.update(Q),$e=Q.material;if(Array.isArray($e)){const ze=Ne.groups;for(let Ye=0,We=ze.length;Ye<We;Ye++){const nt=ze[Ye],it=$e[nt.materialIndex];if(it&&it.visible){const mt=D(Q,Ne,it,he,ie.near,ie.far,ye);t.renderBufferDirect(ie,null,Ne,mt,Q,nt)}}}else if($e.visible){const ze=D(Q,Ne,$e,he,ie.near,ie.far,ye);t.renderBufferDirect(ie,null,Ne,ze,Q,null)}}const Me=Q.children;for(let Ne=0,$e=Me.length;Ne<$e;Ne++)z(Me[Ne],ae,ie,he,ye)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=te,this.render=function(Q,ae,ie){if(!1===_.enabled||!1===_.autoUpdate&&!1===_.needsUpdate||0===Q.length)return;const he=t.getRenderTarget(),ye=t.getActiveCubeFace(),Me=t.getActiveMipmapLevel(),Ne=t.state;Ne.setBlending(q),Ne.buffers.color.setClear(1,1,1,1),Ne.buffers.depth.setTest(!0),Ne.setScissorTest(!1);for(let $e=0,ze=Q.length;$e<ze;$e++){const Ye=Q[$e],We=Ye.shadow;if(!1===We.autoUpdate&&!1===We.needsUpdate)continue;if(void 0===We){console.warn("THREE.WebGLShadowMap:",Ye,"has no shadow.");continue}E.copy(We.mapSize);const nt=We.getFrameExtents();if(E.multiply(nt),I.copy(We.mapSize),(E.x>m||E.y>m)&&(E.x>m&&(I.x=Math.floor(m/nt.x),E.x=I.x*nt.x,We.mapSize.x=I.x),E.y>m&&(I.y=Math.floor(m/nt.y),E.y=I.y*nt.y,We.mapSize.y=I.y)),null===We.map&&!We.isPointLightShadow&&this.type===fe){const mt={minFilter:ii,magFilter:ii,format:lo,stencilBuffer:!1};We.map=new Is(E.x,E.y,mt),We.map.texture.name=Ye.name+".shadowMap",We.mapPass=new Is(E.x,E.y,mt),We.camera.updateProjectionMatrix()}null===We.map&&(We.map=new Is(E.x,E.y,{minFilter:Or,magFilter:Or,format:lo,stencilBuffer:!1}),We.map.texture.name=Ye.name+".shadowMap",We.camera.updateProjectionMatrix()),t.setRenderTarget(We.map),t.clear();const it=We.getViewportCount();for(let mt=0;mt<it;mt++){const xt=We.getViewport(mt);V.set(I.x*xt.x,I.y*xt.y,I.x*xt.z,I.y*xt.w),Ne.viewport(V),We.updateMatrices(Ye,mt),g=We.getFrustum(),z(ae,ie,We.camera,Ye,this.type)}We.isPointLightShadow||this.type!==fe||w(We,ie),We.needsUpdate=!1}_.needsUpdate=!1,t.setRenderTarget(he,ye,Me)}}function Yc(t,u,m){const g=m.isWebGL2,E=new function(){let ct=!1;const Yt=new gi;let St=null;const jt=new gi(0,0,0,0);return{setMask:function(It){St===It||ct||(t.colorMask(It,It,It,It),St=It)},setLocked:function(It){ct=It},setClear:function(It,an,Ze,st,Rt){!0===Rt&&(It*=st,an*=st,Ze*=st),Yt.set(It,an,Ze,st),!1===jt.equals(Yt)&&(t.clearColor(It,an,Ze,st),jt.copy(Yt))},reset:function(){ct=!1,St=null,jt.set(-1,0,0,0)}}},I=new function(){let ct=!1,Yt=null,St=null,jt=null;return{setTest:function(It){It?it(2929):mt(2929)},setMask:function(It){Yt===It||ct||(t.depthMask(It),Yt=It)},setFunc:function(It){if(St!==It){if(It)switch(It){case Pn:t.depthFunc(512);break;case $n:t.depthFunc(519);break;case gn:t.depthFunc(513);break;case ur:t.depthFunc(515);break;case or:t.depthFunc(514);break;case hr:t.depthFunc(518);break;case sr:t.depthFunc(516);break;case ei:t.depthFunc(517);break;default:t.depthFunc(515)}else t.depthFunc(515);St=It}},setLocked:function(It){ct=It},setClear:function(It){jt!==It&&(t.clearDepth(It),jt=It)},reset:function(){ct=!1,Yt=null,St=null,jt=null}}},V=new function(){let ct=!1,Yt=null,St=null,jt=null,It=null,an=null,Ze=null,st=null,Rt=null;return{setTest:function(Gt){ct||(Gt?it(2960):mt(2960))},setMask:function(Gt){Yt===Gt||ct||(t.stencilMask(Gt),Yt=Gt)},setFunc:function(Gt,tn,En){St===Gt&&jt===tn&&It===En||(t.stencilFunc(Gt,tn,En),St=Gt,jt=tn,It=En)},setOp:function(Gt,tn,En){an===Gt&&Ze===tn&&st===En||(t.stencilOp(Gt,tn,En),an=Gt,Ze=tn,st=En)},setLocked:function(Gt){ct=Gt},setClear:function(Gt){Rt!==Gt&&(t.clearStencil(Gt),Rt=Gt)},reset:function(){ct=!1,Yt=null,St=null,jt=null,It=null,an=null,Ze=null,st=null,Rt=null}}};let J={},Y=null,Z=null,me=null,S=null,e=null,c=null,p=null,_=null,w=null,L=!1,O=null,D=null,z=null,Q=null,ae=null;const ie=t.getParameter(35661);let he=!1,ye=0;const Me=t.getParameter(7938);-1!==Me.indexOf("WebGL")?(ye=parseFloat(/^WebGL\ ([0-9])/.exec(Me)[1]),he=ye>=1):-1!==Me.indexOf("OpenGL ES")&&(ye=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(Me)[1]),he=ye>=2);let Ne=null,$e={};const ze=new gi,Ye=new gi;function We(ct,Yt,St){const jt=new Uint8Array(4),It=t.createTexture();t.bindTexture(ct,It),t.texParameteri(ct,10241,9728),t.texParameteri(ct,10240,9728);for(let an=0;an<St;an++)t.texImage2D(Yt+an,0,6408,1,1,0,6408,5121,jt);return It}const nt={};function it(ct){!0!==J[ct]&&(t.enable(ct),J[ct]=!0)}function mt(ct){!1!==J[ct]&&(t.disable(ct),J[ct]=!1)}nt[3553]=We(3553,3553,1),nt[34067]=We(34067,34069,6),E.setClear(0,0,0,1),I.setClear(1),V.setClear(0),it(2929),I.setFunc(ur),Je(!1),pt(A),it(2884),Ht(q);const xt={[Ae]:32774,[Fe]:32778,[Ee]:32779};if(g)xt[qe]=32775,xt[Ke]=32776;else{const ct=u.get("EXT_blend_minmax");null!==ct&&(xt[qe]=ct.MIN_EXT,xt[Ke]=ct.MAX_EXT)}const Dt={[gt]:0,[at]:1,[Ct]:768,[Ft]:770,[mn]:776,[Tn]:774,[rn]:772,[wt]:769,[Ot]:771,[Cn]:775,[ft]:773};function Ht(ct,Yt,St,jt,It,an,Ze,st){if(ct!==q){if(Z||(it(3042),Z=!0),ct===ve)It=It||Yt,an=an||St,Ze=Ze||jt,Yt===S&&It===p||(t.blendEquationSeparate(xt[Yt],xt[It]),S=Yt,p=It),St===e&&jt===c&&an===_&&Ze===w||(t.blendFuncSeparate(Dt[St],Dt[jt],Dt[an],Dt[Ze]),e=St,c=jt,_=an,w=Ze),me=ct,L=null;else if(ct!==me||st!==L){if(S===Ae&&p===Ae||(t.blendEquation(32774),S=Ae,p=Ae),st)switch(ct){case ee:t.blendFuncSeparate(1,771,1,771);break;case F:t.blendFunc(1,1);break;case Be:t.blendFuncSeparate(0,0,769,771);break;case K:t.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",ct)}else switch(ct){case ee:t.blendFuncSeparate(770,771,1,771);break;case F:t.blendFunc(770,1);break;case Be:t.blendFunc(0,769);break;case K:t.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",ct)}e=null,c=null,_=null,w=null,me=ct,L=st}}else Z&&(mt(3042),Z=!1)}function Je(ct){O!==ct&&(t.frontFace(ct?2304:2305),O=ct)}function pt(ct){ct!==G?(it(2884),ct!==D&&t.cullFace(ct===A?1029:ct===P?1028:1032)):mt(2884),D=ct}function Vt(ct,Yt,St){ct?(it(32823),Q===Yt&&ae===St||(t.polygonOffset(Yt,St),Q=Yt,ae=St)):mt(32823)}function Nt(ct){void 0===ct&&(ct=33984+ie-1),Ne!==ct&&(t.activeTexture(ct),Ne=ct)}return{buffers:{color:E,depth:I,stencil:V},enable:it,disable:mt,useProgram:function(ct){return Y!==ct&&(t.useProgram(ct),Y=ct,!0)},setBlending:Ht,setMaterial:function(ct,Yt){ct.side===pe?mt(2884):it(2884);let St=ct.side===le;Yt&&(St=!St),Je(St),ct.blending===ee&&!1===ct.transparent?Ht(q):Ht(ct.blending,ct.blendEquation,ct.blendSrc,ct.blendDst,ct.blendEquationAlpha,ct.blendSrcAlpha,ct.blendDstAlpha,ct.premultipliedAlpha),I.setFunc(ct.depthFunc),I.setTest(ct.depthTest),I.setMask(ct.depthWrite),E.setMask(ct.colorWrite);const jt=ct.stencilWrite;V.setTest(jt),jt&&(V.setMask(ct.stencilWriteMask),V.setFunc(ct.stencilFunc,ct.stencilRef,ct.stencilFuncMask),V.setOp(ct.stencilFail,ct.stencilZFail,ct.stencilZPass)),Vt(ct.polygonOffset,ct.polygonOffsetFactor,ct.polygonOffsetUnits)},setFlipSided:Je,setCullFace:pt,setLineWidth:function(ct){ct!==z&&(he&&t.lineWidth(ct),z=ct)},setPolygonOffset:Vt,setScissorTest:function(ct){ct?it(3089):mt(3089)},activeTexture:Nt,bindTexture:function(ct,Yt){null===Ne&&Nt();let St=$e[Ne];void 0===St&&(St={type:void 0,texture:void 0},$e[Ne]=St),St.type===ct&&St.texture===Yt||(t.bindTexture(ct,Yt||nt[ct]),St.type=ct,St.texture=Yt)},unbindTexture:function(){const ct=$e[Ne];void 0!==ct&&void 0!==ct.type&&(t.bindTexture(ct.type,null),ct.type=void 0,ct.texture=void 0)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(ct){console.error("THREE.WebGLState:",ct)}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(ct){console.error("THREE.WebGLState:",ct)}},texImage3D:function(){try{t.texImage3D.apply(t,arguments)}catch(ct){console.error("THREE.WebGLState:",ct)}},scissor:function(ct){!1===ze.equals(ct)&&(t.scissor(ct.x,ct.y,ct.z,ct.w),ze.copy(ct))},viewport:function(ct){!1===Ye.equals(ct)&&(t.viewport(ct.x,ct.y,ct.z,ct.w),Ye.copy(ct))},reset:function(){J={},Ne=null,$e={},Y=null,me=null,O=null,D=null,E.reset(),I.reset(),V.reset()}}}function $h(t,u,m,g,E,I,V){const J=E.isWebGL2,Y=E.maxTextures,Z=E.maxCubemapSize,me=E.maxTextureSize,S=E.maxSamples,e=new WeakMap;let c,p=!1;try{p=typeof OffscreenCanvas<"u"&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch{}function _(Je,pt){return p?new OffscreenCanvas(Je,pt):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function w(Je,pt,Vt,Nt){let ct=1;if((Je.width>Nt||Je.height>Nt)&&(ct=Nt/Math.max(Je.width,Je.height)),ct<1||!0===pt){if(typeof HTMLImageElement<"u"&&Je instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Je instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Je instanceof ImageBitmap){const Yt=pt?rr.floorPowerOfTwo:Math.floor,St=Yt(ct*Je.width),jt=Yt(ct*Je.height);void 0===c&&(c=_(St,jt));const It=Vt?_(St,jt):c;return It.width=St,It.height=jt,It.getContext("2d").drawImage(Je,0,0,St,jt),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Je.width+"x"+Je.height+") to ("+St+"x"+jt+")."),It}return"data"in Je&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Je.width+"x"+Je.height+")."),Je}return Je}function L(Je){return rr.isPowerOfTwo(Je.width)&&rr.isPowerOfTwo(Je.height)}function O(Je,pt){return Je.generateMipmaps&&pt&&Je.minFilter!==Or&&Je.minFilter!==ii}function D(Je,pt,Vt,Nt){t.generateMipmap(Je),g.get(pt).__maxMipLevel=Math.log(Math.max(Vt,Nt))*Math.LOG2E}function z(Je,pt,Vt){if(!1===J)return pt;if(null!==Je){if(void 0!==t[Je])return t[Je];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Je+"'")}let Nt=pt;return 6403===pt&&(5126===Vt&&(Nt=33326),5131===Vt&&(Nt=33325),5121===Vt&&(Nt=33321)),6407===pt&&(5126===Vt&&(Nt=34837),5131===Vt&&(Nt=34843),5121===Vt&&(Nt=32849)),6408===pt&&(5126===Vt&&(Nt=34836),5131===Vt&&(Nt=34842),5121===Vt&&(Nt=32856)),33325!==Nt&&33326!==Nt&&34842!==Nt&&34836!==Nt||u.get("EXT_color_buffer_float"),Nt}function Q(Je){return Je===Or||Je===Na||Je===ps?9728:9729}function ae(Je){const pt=Je.target;pt.removeEventListener("dispose",ae),function(Vt){const Nt=g.get(Vt);void 0!==Nt.__webglInit&&(t.deleteTexture(Nt.__webglTexture),g.remove(Vt))}(pt),pt.isVideoTexture&&e.delete(pt),V.memory.textures--}function ie(Je){const pt=Je.target;pt.removeEventListener("dispose",ie),function(Vt){const Nt=g.get(Vt),ct=g.get(Vt.texture);if(Vt){if(void 0!==ct.__webglTexture&&t.deleteTexture(ct.__webglTexture),Vt.depthTexture&&Vt.depthTexture.dispose(),Vt.isWebGLCubeRenderTarget)for(let Yt=0;Yt<6;Yt++)t.deleteFramebuffer(Nt.__webglFramebuffer[Yt]),Nt.__webglDepthbuffer&&t.deleteRenderbuffer(Nt.__webglDepthbuffer[Yt]);else t.deleteFramebuffer(Nt.__webglFramebuffer),Nt.__webglDepthbuffer&&t.deleteRenderbuffer(Nt.__webglDepthbuffer),Nt.__webglMultisampledFramebuffer&&t.deleteFramebuffer(Nt.__webglMultisampledFramebuffer),Nt.__webglColorRenderbuffer&&t.deleteRenderbuffer(Nt.__webglColorRenderbuffer),Nt.__webglDepthRenderbuffer&&t.deleteRenderbuffer(Nt.__webglDepthRenderbuffer);g.remove(Vt.texture),g.remove(Vt)}}(pt),V.memory.textures--}let he=0;function ye(Je,pt){const Vt=g.get(Je);if(Je.isVideoTexture&&function(Nt){const ct=V.render.frame;e.get(Nt)!==ct&&(e.set(Nt,ct),Nt.update())}(Je),Je.version>0&&Vt.__version!==Je.version){const Nt=Je.image;if(void 0===Nt)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==Nt.complete)return void nt(Vt,Je,pt);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}m.activeTexture(33984+pt),m.bindTexture(3553,Vt.__webglTexture)}function Me(Je,pt){if(6!==Je.image.length)return;const Vt=g.get(Je);if(Je.version>0&&Vt.__version!==Je.version){We(Vt,Je),m.activeTexture(33984+pt),m.bindTexture(34067,Vt.__webglTexture),t.pixelStorei(37440,Je.flipY);const Nt=Je&&(Je.isCompressedTexture||Je.image[0].isCompressedTexture),ct=Je.image[0]&&Je.image[0].isDataTexture,Yt=[];for(let Rt=0;Rt<6;Rt++)Yt[Rt]=Nt||ct?ct?Je.image[Rt].image:Je.image[Rt]:w(Je.image[Rt],!1,!0,Z);const St=Yt[0],jt=L(St)||J,It=I.convert(Je.format),an=I.convert(Je.type),Ze=z(Je.internalFormat,It,an);let st;if(Ye(34067,Je,jt),Nt){for(let Rt=0;Rt<6;Rt++){st=Yt[Rt].mipmaps;for(let Gt=0;Gt<st.length;Gt++){const tn=st[Gt];Je.format!==lo&&Je.format!==Rs?null!==It?m.compressedTexImage2D(34069+Rt,Gt,Ze,tn.width,tn.height,0,tn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):m.texImage2D(34069+Rt,Gt,Ze,tn.width,tn.height,0,It,an,tn.data)}}Vt.__maxMipLevel=st.length-1}else{st=Je.mipmaps;for(let Rt=0;Rt<6;Rt++)if(ct){m.texImage2D(34069+Rt,0,Ze,Yt[Rt].width,Yt[Rt].height,0,It,an,Yt[Rt].data);for(let Gt=0;Gt<st.length;Gt++){const tn=st[Gt].image[Rt].image;m.texImage2D(34069+Rt,Gt+1,Ze,tn.width,tn.height,0,It,an,tn.data)}}else{m.texImage2D(34069+Rt,0,Ze,It,an,Yt[Rt]);for(let Gt=0;Gt<st.length;Gt++)m.texImage2D(34069+Rt,Gt+1,Ze,It,an,st[Gt].image[Rt])}Vt.__maxMipLevel=st.length}O(Je,jt)&&D(34067,Je,St.width,St.height),Vt.__version=Je.version,Je.onUpdate&&Je.onUpdate(Je)}else m.activeTexture(33984+pt),m.bindTexture(34067,Vt.__webglTexture)}function Ne(Je,pt){m.activeTexture(33984+pt),m.bindTexture(34067,g.get(Je).__webglTexture)}const $e={[vo]:10497,[Xr]:33071,[ss]:33648},ze={[Or]:9728,[Na]:9984,[ps]:9986,[ii]:9729,[Pc]:9985,[Ya]:9987};function Ye(Je,pt,Vt){Vt?(t.texParameteri(Je,10242,$e[pt.wrapS]),t.texParameteri(Je,10243,$e[pt.wrapT]),32879!==Je&&35866!==Je||t.texParameteri(Je,32882,$e[pt.wrapR]),t.texParameteri(Je,10240,ze[pt.magFilter]),t.texParameteri(Je,10241,ze[pt.minFilter])):(t.texParameteri(Je,10242,33071),t.texParameteri(Je,10243,33071),32879!==Je&&35866!==Je||t.texParameteri(Je,32882,33071),pt.wrapS===Xr&&pt.wrapT===Xr||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(Je,10240,Q(pt.magFilter)),t.texParameteri(Je,10241,Q(pt.minFilter)),pt.minFilter!==Or&&pt.minFilter!==ii&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter."));const Nt=u.get("EXT_texture_filter_anisotropic");if(Nt){if(pt.type===Vo&&null===u.get("OES_texture_float_linear")||pt.type===ds&&null===(J||u.get("OES_texture_half_float_linear")))return;(pt.anisotropy>1||g.get(pt).__currentAnisotropy)&&(t.texParameterf(Je,Nt.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(pt.anisotropy,E.getMaxAnisotropy())),g.get(pt).__currentAnisotropy=pt.anisotropy)}}function We(Je,pt){void 0===Je.__webglInit&&(Je.__webglInit=!0,pt.addEventListener("dispose",ae),Je.__webglTexture=t.createTexture(),V.memory.textures++)}function nt(Je,pt,Vt){let Nt=3553;pt.isDataTexture2DArray&&(Nt=35866),pt.isDataTexture3D&&(Nt=32879),We(Je,pt),m.activeTexture(33984+Vt),m.bindTexture(Nt,Je.__webglTexture),t.pixelStorei(37440,pt.flipY),t.pixelStorei(37441,pt.premultiplyAlpha),t.pixelStorei(3317,pt.unpackAlignment);const ct=(Rt=pt,!J&&(Rt.wrapS!==Xr||Rt.wrapT!==Xr||Rt.minFilter!==Or&&Rt.minFilter!==ii)&&!1===L(pt.image)),Yt=w(pt.image,ct,!1,me),St=L(Yt)||J,jt=I.convert(pt.format);var Rt;let It,an=I.convert(pt.type),Ze=z(pt.internalFormat,jt,an);Ye(Nt,pt,St);const st=pt.mipmaps;if(pt.isDepthTexture)Ze=6402,J?Ze=pt.type===Vo?36012:pt.type===Vs?33190:pt.type===Es?35056:33189:pt.type===Vo&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),pt.format===To&&6402===Ze&&pt.type!==Ic&&pt.type!==Vs&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),pt.type=Ic,an=I.convert(pt.type)),pt.format===Ws&&6402===Ze&&(Ze=34041,pt.type!==Es&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),pt.type=Es,an=I.convert(pt.type))),m.texImage2D(3553,0,Ze,Yt.width,Yt.height,0,jt,an,null);else if(pt.isDataTexture)if(st.length>0&&St){for(let Rt=0,Gt=st.length;Rt<Gt;Rt++)It=st[Rt],m.texImage2D(3553,Rt,Ze,It.width,It.height,0,jt,an,It.data);pt.generateMipmaps=!1,Je.__maxMipLevel=st.length-1}else m.texImage2D(3553,0,Ze,Yt.width,Yt.height,0,jt,an,Yt.data),Je.__maxMipLevel=0;else if(pt.isCompressedTexture){for(let Rt=0,Gt=st.length;Rt<Gt;Rt++)It=st[Rt],pt.format!==lo&&pt.format!==Rs?null!==jt?m.compressedTexImage2D(3553,Rt,Ze,It.width,It.height,0,It.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):m.texImage2D(3553,Rt,Ze,It.width,It.height,0,jt,an,It.data);Je.__maxMipLevel=st.length-1}else if(pt.isDataTexture2DArray)m.texImage3D(35866,0,Ze,Yt.width,Yt.height,Yt.depth,0,jt,an,Yt.data),Je.__maxMipLevel=0;else if(pt.isDataTexture3D)m.texImage3D(32879,0,Ze,Yt.width,Yt.height,Yt.depth,0,jt,an,Yt.data),Je.__maxMipLevel=0;else if(st.length>0&&St){for(let Rt=0,Gt=st.length;Rt<Gt;Rt++)It=st[Rt],m.texImage2D(3553,Rt,Ze,jt,an,It);pt.generateMipmaps=!1,Je.__maxMipLevel=st.length-1}else m.texImage2D(3553,0,Ze,jt,an,Yt),Je.__maxMipLevel=0;O(pt,St)&&D(Nt,pt,Yt.width,Yt.height),Je.__version=pt.version,pt.onUpdate&&pt.onUpdate(pt)}function it(Je,pt,Vt,Nt){const ct=I.convert(pt.texture.format),Yt=I.convert(pt.texture.type),St=z(pt.texture.internalFormat,ct,Yt);m.texImage2D(Nt,0,St,pt.width,pt.height,0,ct,Yt,null),t.bindFramebuffer(36160,Je),t.framebufferTexture2D(36160,Vt,Nt,g.get(pt.texture).__webglTexture,0),t.bindFramebuffer(36160,null)}function mt(Je,pt,Vt){if(t.bindRenderbuffer(36161,Je),pt.depthBuffer&&!pt.stencilBuffer){let Nt=33189;if(Vt){const ct=pt.depthTexture;ct&&ct.isDepthTexture&&(ct.type===Vo?Nt=36012:ct.type===Vs&&(Nt=33190));const Yt=xt(pt);t.renderbufferStorageMultisample(36161,Yt,Nt,pt.width,pt.height)}else t.renderbufferStorage(36161,Nt,pt.width,pt.height);t.framebufferRenderbuffer(36160,36096,36161,Je)}else if(pt.depthBuffer&&pt.stencilBuffer){if(Vt){const Nt=xt(pt);t.renderbufferStorageMultisample(36161,Nt,35056,pt.width,pt.height)}else t.renderbufferStorage(36161,34041,pt.width,pt.height);t.framebufferRenderbuffer(36160,33306,36161,Je)}else{const Nt=I.convert(pt.texture.format),ct=I.convert(pt.texture.type),Yt=z(pt.texture.internalFormat,Nt,ct);if(Vt){const St=xt(pt);t.renderbufferStorageMultisample(36161,St,Yt,pt.width,pt.height)}else t.renderbufferStorage(36161,Yt,pt.width,pt.height)}t.bindRenderbuffer(36161,null)}function xt(Je){return J&&Je.isWebGLMultisampleRenderTarget?Math.min(S,Je.samples):0}let Dt=!1,Ht=!1;this.allocateTextureUnit=function(){const Je=he;return Je>=Y&&console.warn("THREE.WebGLTextures: Trying to use "+Je+" texture units while this GPU supports only "+Y),he+=1,Je},this.resetTextureUnits=function(){he=0},this.setTexture2D=ye,this.setTexture2DArray=function(Je,pt){const Vt=g.get(Je);Je.version>0&&Vt.__version!==Je.version?nt(Vt,Je,pt):(m.activeTexture(33984+pt),m.bindTexture(35866,Vt.__webglTexture))},this.setTexture3D=function(Je,pt){const Vt=g.get(Je);Je.version>0&&Vt.__version!==Je.version?nt(Vt,Je,pt):(m.activeTexture(33984+pt),m.bindTexture(32879,Vt.__webglTexture))},this.setTextureCube=Me,this.setTextureCubeDynamic=Ne,this.setupRenderTarget=function(Je){const pt=g.get(Je),Vt=g.get(Je.texture);Je.addEventListener("dispose",ie),Vt.__webglTexture=t.createTexture(),V.memory.textures++;const Nt=!0===Je.isWebGLCubeRenderTarget,ct=!0===Je.isWebGLMultisampleRenderTarget,Yt=L(Je)||J;if(!J||Je.texture.format!==Rs||Je.texture.type!==Vo&&Je.texture.type!==ds||(Je.texture.format=lo,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),Nt){pt.__webglFramebuffer=[];for(let St=0;St<6;St++)pt.__webglFramebuffer[St]=t.createFramebuffer()}else if(pt.__webglFramebuffer=t.createFramebuffer(),ct)if(J){pt.__webglMultisampledFramebuffer=t.createFramebuffer(),pt.__webglColorRenderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(36161,pt.__webglColorRenderbuffer);const St=I.convert(Je.texture.format),jt=I.convert(Je.texture.type),It=z(Je.texture.internalFormat,St,jt),an=xt(Je);t.renderbufferStorageMultisample(36161,an,It,Je.width,Je.height),t.bindFramebuffer(36160,pt.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064,36161,pt.__webglColorRenderbuffer),t.bindRenderbuffer(36161,null),Je.depthBuffer&&(pt.__webglDepthRenderbuffer=t.createRenderbuffer(),mt(pt.__webglDepthRenderbuffer,Je,!0)),t.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(Nt){m.bindTexture(34067,Vt.__webglTexture),Ye(34067,Je.texture,Yt);for(let St=0;St<6;St++)it(pt.__webglFramebuffer[St],Je,36064,34069+St);O(Je.texture,Yt)&&D(34067,Je.texture,Je.width,Je.height),m.bindTexture(34067,null)}else m.bindTexture(3553,Vt.__webglTexture),Ye(3553,Je.texture,Yt),it(pt.__webglFramebuffer,Je,36064,3553),O(Je.texture,Yt)&&D(3553,Je.texture,Je.width,Je.height),m.bindTexture(3553,null);Je.depthBuffer&&function(St){const jt=g.get(St),It=!0===St.isWebGLCubeRenderTarget;if(St.depthTexture){if(It)throw new Error("target.depthTexture not supported in Cube render targets");!function(an,Ze){if(Ze&&Ze.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,an),!Ze.depthTexture||!Ze.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");g.get(Ze.depthTexture).__webglTexture&&Ze.depthTexture.image.width===Ze.width&&Ze.depthTexture.image.height===Ze.height||(Ze.depthTexture.image.width=Ze.width,Ze.depthTexture.image.height=Ze.height,Ze.depthTexture.needsUpdate=!0),ye(Ze.depthTexture,0);const st=g.get(Ze.depthTexture).__webglTexture;if(Ze.depthTexture.format===To)t.framebufferTexture2D(36160,36096,3553,st,0);else{if(Ze.depthTexture.format!==Ws)throw new Error("Unknown depthTexture format");t.framebufferTexture2D(36160,33306,3553,st,0)}}(jt.__webglFramebuffer,St)}else if(It){jt.__webglDepthbuffer=[];for(let an=0;an<6;an++)t.bindFramebuffer(36160,jt.__webglFramebuffer[an]),jt.__webglDepthbuffer[an]=t.createRenderbuffer(),mt(jt.__webglDepthbuffer[an],St,!1)}else t.bindFramebuffer(36160,jt.__webglFramebuffer),jt.__webglDepthbuffer=t.createRenderbuffer(),mt(jt.__webglDepthbuffer,St,!1);t.bindFramebuffer(36160,null)}(Je)},this.updateRenderTargetMipmap=function(Je){const pt=Je.texture;if(O(pt,L(Je)||J)){const Vt=Je.isWebGLCubeRenderTarget?34067:3553,Nt=g.get(pt).__webglTexture;m.bindTexture(Vt,Nt),D(Vt,pt,Je.width,Je.height),m.bindTexture(Vt,null)}},this.updateMultisampleRenderTarget=function(Je){if(Je.isWebGLMultisampleRenderTarget)if(J){const pt=g.get(Je);t.bindFramebuffer(36008,pt.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,pt.__webglFramebuffer);const Vt=Je.width,Nt=Je.height;let ct=16384;Je.depthBuffer&&(ct|=256),Je.stencilBuffer&&(ct|=1024),t.blitFramebuffer(0,0,Vt,Nt,0,0,Vt,Nt,ct,9728),t.bindFramebuffer(36160,pt.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(Je,pt){Je&&Je.isWebGLRenderTarget&&(!1===Dt&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),Dt=!0),Je=Je.texture),ye(Je,pt)},this.safeSetTextureCube=function(Je,pt){Je&&Je.isWebGLCubeRenderTarget&&(!1===Ht&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),Ht=!0),Je=Je.texture),Je&&Je.isCubeTexture||Array.isArray(Je.image)&&6===Je.image.length?Me(Je,pt):Ne(Je,pt)}}function la(t,u,m){const g=m.isWebGL2;return{convert:function(E){let I;if(E===ea)return 5121;if(E===Du)return 32819;if(E===pu)return 32820;if(E===du)return 33635;if(E===kl)return 5120;if(E===Ra)return 5122;if(E===Ic)return 5123;if(E===Zp)return 5124;if(E===Vs)return 5125;if(E===Vo)return 5126;if(E===ds)return g?5131:(I=u.get("OES_texture_half_float"),null!==I?I.HALF_FLOAT_OES:null);if(E===dp)return 6406;if(E===Rs)return 6407;if(E===lo)return 6408;if(E===Oc)return 6409;if(E===Uu)return 6410;if(E===To)return 6402;if(E===Ws)return 34041;if(E===Qp)return 6403;if(E===Ja)return 36244;if(E===fu)return 33319;if(E===fp)return 33320;if(E===mp)return 36248;if(E===vh)return 36249;if(E===zh||E===ic||E===jh||E===yh){if(I=u.get("WEBGL_compressed_texture_s3tc"),null===I)return null;if(E===zh)return I.COMPRESSED_RGB_S3TC_DXT1_EXT;if(E===ic)return I.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(E===jh)return I.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(E===yh)return I.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(E===Gh||E===vl||E===yl||E===Fl){if(I=u.get("WEBGL_compressed_texture_pvrtc"),null===I)return null;if(E===Gh)return I.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(E===vl)return I.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(E===yl)return I.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(E===Fl)return I.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(E===zu)return I=u.get("WEBGL_compressed_texture_etc1"),null!==I?I.COMPRESSED_RGB_ETC1_WEBGL:null;if((E===fs||E===Dl)&&(I=u.get("WEBGL_compressed_texture_etc"),null!==I)){if(E===fs)return I.COMPRESSED_RGB8_ETC2;if(E===Dl)return I.COMPRESSED_RGBA8_ETC2_EAC}return E===ju||E===_p||E===gp||E===kc||E===oc||E===bh||E===vp||E===Gu||E===Hu||E===Za||E===Hh||E===Qa||E===Vh||E===Vu||E===ac||E===xh||E===mu||E===Fc||E===yp||E===Dc||E===Wu||E===Ul||E===bp||E===Wh||E===xp||E===wp||E===qh||E===Kp?(I=u.get("WEBGL_compressed_texture_astc"),null!==I?E:null):E===sc?(I=u.get("EXT_texture_compression_bptc"),null!==I?E:null):E===Es?g?34042:(I=u.get("WEBGL_depth_texture"),null!==I?I.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}function Ch(t){Bs.call(this),this.cameras=t||[]}function Ys(){er.call(this),this.type="Group"}function Ec(){this._targetRay=null,this._grip=null,this._hand=null}function Jd(t,u){const m=this;let g=null,E=1,I=null,V="local-floor",J=null;const Y=[],Z=new Map,me=new Bs;me.layers.enable(1),me.viewport=new gi;const S=new Bs;S.layers.enable(2),S.viewport=new gi;const e=[me,S],c=new Ch;c.layers.enable(1),c.layers.enable(2);let p=null,_=null;function w(ye){const Me=Z.get(ye.inputSource);Me&&Me.dispatchEvent({type:ye.type})}function L(){Z.forEach(function(ye,Me){ye.disconnect(Me)}),Z.clear(),t.setFramebuffer(null),t.setRenderTarget(t.getRenderTarget()),he.stop(),m.isPresenting=!1,m.dispatchEvent({type:"sessionend"})}function O(ye){I=ye,he.setContext(g),he.start(),m.isPresenting=!0,m.dispatchEvent({type:"sessionstart"})}function D(ye){const Me=g.inputSources;for(let Ne=0;Ne<Y.length;Ne++)Z.set(Me[Ne],Y[Ne]);for(let Ne=0;Ne<ye.removed.length;Ne++){const $e=ye.removed[Ne],ze=Z.get($e);ze&&(ze.dispatchEvent({type:"disconnected",data:$e}),Z.delete($e))}for(let Ne=0;Ne<ye.added.length;Ne++){const $e=ye.added[Ne],ze=Z.get($e);ze&&ze.dispatchEvent({type:"connected",data:$e})}}this.enabled=!1,this.isPresenting=!1,this.getController=function(ye){let Me=Y[ye];return void 0===Me&&(Me=new Ec,Y[ye]=Me),Me.getTargetRaySpace()},this.getControllerGrip=function(ye){let Me=Y[ye];return void 0===Me&&(Me=new Ec,Y[ye]=Me),Me.getGripSpace()},this.getHand=function(ye){let Me=Y[ye];return void 0===Me&&(Me=new Ec,Y[ye]=Me),Me.getHandSpace()},this.setFramebufferScaleFactor=function(ye){E=ye,!0===m.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(ye){V=ye,!0===m.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return I},this.getSession=function(){return g},this.setSession=function(ye){if(g=ye,null!==g){g.addEventListener("select",w),g.addEventListener("selectstart",w),g.addEventListener("selectend",w),g.addEventListener("squeeze",w),g.addEventListener("squeezestart",w),g.addEventListener("squeezeend",w),g.addEventListener("end",L);const Me=u.getContextAttributes();!0!==Me.xrCompatible&&u.makeXRCompatible();const $e=new XRWebGLLayer(g,u,{antialias:Me.antialias,alpha:Me.alpha,depth:Me.depth,stencil:Me.stencil,framebufferScaleFactor:E});g.updateRenderState({baseLayer:$e}),g.requestReferenceSpace(V).then(O),g.addEventListener("inputsourceschange",D)}};const z=new ot,Q=new ot;function ae(ye,Me){null===Me?ye.matrixWorld.copy(ye.matrix):ye.matrixWorld.multiplyMatrices(Me.matrixWorld,ye.matrix),ye.matrixWorldInverse.getInverse(ye.matrixWorld)}this.getCamera=function(ye){c.near=S.near=me.near=ye.near,c.far=S.far=me.far=ye.far,p===c.near&&_===c.far||(g.updateRenderState({depthNear:c.near,depthFar:c.far}),p=c.near,_=c.far);const Me=ye.parent,Ne=c.cameras;ae(c,Me);for(let ze=0;ze<Ne.length;ze++)ae(Ne[ze],Me);ye.matrixWorld.copy(c.matrixWorld);const $e=ye.children;for(let ze=0,Ye=$e.length;ze<Ye;ze++)$e[ze].updateMatrixWorld(!0);return 2===Ne.length?function(ze,Ye,We){z.setFromMatrixPosition(Ye.matrixWorld),Q.setFromMatrixPosition(We.matrixWorld);const nt=z.distanceTo(Q),it=Ye.projectionMatrix.elements,mt=We.projectionMatrix.elements,xt=it[14]/(it[10]-1),Dt=it[14]/(it[10]+1),Ht=(it[9]+1)/it[5],Je=(it[9]-1)/it[5],pt=(it[8]-1)/it[0],Vt=(mt[8]+1)/mt[0],Nt=xt*pt,ct=xt*Vt,Yt=nt/(-pt+Vt),St=Yt*-pt;Ye.matrixWorld.decompose(ze.position,ze.quaternion,ze.scale),ze.translateX(St),ze.translateZ(Yt),ze.matrixWorld.compose(ze.position,ze.quaternion,ze.scale),ze.matrixWorldInverse.getInverse(ze.matrixWorld);const jt=xt+Yt,It=Dt+Yt;ze.projectionMatrix.makePerspective(Nt-St,ct+(nt-St),Ht*Dt/It*jt,Je*Dt/It*jt,jt,It)}(c,me,S):c.projectionMatrix.copy(me.projectionMatrix),c};let ie=null;const he=new Lp;he.setAnimationLoop(function(ye,Me){if(J=Me.getViewerPose(I),null!==J){const $e=J.views,ze=g.renderState.baseLayer;t.setFramebuffer(ze.framebuffer);let Ye=!1;$e.length!==c.cameras.length&&(c.cameras.length=0,Ye=!0);for(let We=0;We<$e.length;We++){const nt=$e[We],it=ze.getViewport(nt),mt=e[We];mt.matrix.fromArray(nt.transform.matrix),mt.projectionMatrix.fromArray(nt.projectionMatrix),mt.viewport.set(it.x,it.y,it.width,it.height),0===We&&c.matrix.copy(mt.matrix),!0===Ye&&c.cameras.push(mt)}}const Ne=g.inputSources;for(let $e=0;$e<Y.length;$e++)Y[$e].update(Ne[$e],Me,I);ie&&ie(ye,Me)}),this.setAnimationLoop=function(ye){ie=ye},this.dispose=function(){}}function Bf(t){function u(g,E,I){g.opacity.value=E.opacity,E.color&&g.diffuse.value.copy(E.color),E.emissive&&g.emissive.value.copy(E.emissive).multiplyScalar(E.emissiveIntensity),E.map&&(g.map.value=E.map),E.alphaMap&&(g.alphaMap.value=E.alphaMap),E.specularMap&&(g.specularMap.value=E.specularMap);const V=E.envMap||I;if(V){g.envMap.value=V,g.flipEnvMap.value=V.isCubeTexture?-1:1,g.reflectivity.value=E.reflectivity,g.refractionRatio.value=E.refractionRatio;var J=t.get(V).__maxMipLevel;void 0!==J&&(g.maxMipLevel.value=J)}let Y,Z;E.lightMap&&(g.lightMap.value=E.lightMap,g.lightMapIntensity.value=E.lightMapIntensity),E.aoMap&&(g.aoMap.value=E.aoMap,g.aoMapIntensity.value=E.aoMapIntensity),E.map?Y=E.map:E.specularMap?Y=E.specularMap:E.displacementMap?Y=E.displacementMap:E.normalMap?Y=E.normalMap:E.bumpMap?Y=E.bumpMap:E.roughnessMap?Y=E.roughnessMap:E.metalnessMap?Y=E.metalnessMap:E.alphaMap?Y=E.alphaMap:E.emissiveMap&&(Y=E.emissiveMap),void 0!==Y&&(Y.isWebGLRenderTarget&&(Y=Y.texture),!0===Y.matrixAutoUpdate&&Y.updateMatrix(),g.uvTransform.value.copy(Y.matrix)),E.aoMap?Z=E.aoMap:E.lightMap&&(Z=E.lightMap),void 0!==Z&&(Z.isWebGLRenderTarget&&(Z=Z.texture),!0===Z.matrixAutoUpdate&&Z.updateMatrix(),g.uv2Transform.value.copy(Z.matrix))}function m(g,E,I){g.roughness.value=E.roughness,g.metalness.value=E.metalness,E.roughnessMap&&(g.roughnessMap.value=E.roughnessMap),E.metalnessMap&&(g.metalnessMap.value=E.metalnessMap),E.emissiveMap&&(g.emissiveMap.value=E.emissiveMap),E.bumpMap&&(g.bumpMap.value=E.bumpMap,g.bumpScale.value=E.bumpScale,E.side===le&&(g.bumpScale.value*=-1)),E.normalMap&&(g.normalMap.value=E.normalMap,g.normalScale.value.copy(E.normalScale),E.side===le&&g.normalScale.value.negate()),E.displacementMap&&(g.displacementMap.value=E.displacementMap,g.displacementScale.value=E.displacementScale,g.displacementBias.value=E.displacementBias),(E.envMap||I)&&(g.envMapIntensity.value=E.envMapIntensity)}return{refreshFogUniforms:function(g,E){g.fogColor.value.copy(E.color),E.isFog?(g.fogNear.value=E.near,g.fogFar.value=E.far):E.isFogExp2&&(g.fogDensity.value=E.density)},refreshMaterialUniforms:function(g,E,I,V,J){var Z;E.isMeshBasicMaterial?u(g,E):E.isMeshLambertMaterial?(u(g,E),(Z=E).emissiveMap&&(g.emissiveMap.value=Z.emissiveMap)):E.isMeshToonMaterial?(u(g,E),function(Y,Z){Z.gradientMap&&(Y.gradientMap.value=Z.gradientMap),Z.emissiveMap&&(Y.emissiveMap.value=Z.emissiveMap),Z.bumpMap&&(Y.bumpMap.value=Z.bumpMap,Y.bumpScale.value=Z.bumpScale,Z.side===le&&(Y.bumpScale.value*=-1)),Z.normalMap&&(Y.normalMap.value=Z.normalMap,Y.normalScale.value.copy(Z.normalScale),Z.side===le&&Y.normalScale.value.negate()),Z.displacementMap&&(Y.displacementMap.value=Z.displacementMap,Y.displacementScale.value=Z.displacementScale,Y.displacementBias.value=Z.displacementBias)}(g,E)):E.isMeshPhongMaterial?(u(g,E),function(Y,Z){Y.specular.value.copy(Z.specular),Y.shininess.value=Math.max(Z.shininess,1e-4),Z.emissiveMap&&(Y.emissiveMap.value=Z.emissiveMap),Z.bumpMap&&(Y.bumpMap.value=Z.bumpMap,Y.bumpScale.value=Z.bumpScale,Z.side===le&&(Y.bumpScale.value*=-1)),Z.normalMap&&(Y.normalMap.value=Z.normalMap,Y.normalScale.value.copy(Z.normalScale),Z.side===le&&Y.normalScale.value.negate()),Z.displacementMap&&(Y.displacementMap.value=Z.displacementMap,Y.displacementScale.value=Z.displacementScale,Y.displacementBias.value=Z.displacementBias)}(g,E)):E.isMeshStandardMaterial?(u(g,E,I),E.isMeshPhysicalMaterial?function(Y,Z,me){m(Y,Z,me),Y.reflectivity.value=Z.reflectivity,Y.clearcoat.value=Z.clearcoat,Y.clearcoatRoughness.value=Z.clearcoatRoughness,Z.sheen&&Y.sheen.value.copy(Z.sheen),Z.clearcoatMap&&(Y.clearcoatMap.value=Z.clearcoatMap),Z.clearcoatRoughnessMap&&(Y.clearcoatRoughnessMap.value=Z.clearcoatRoughnessMap),Z.clearcoatNormalMap&&(Y.clearcoatNormalScale.value.copy(Z.clearcoatNormalScale),Y.clearcoatNormalMap.value=Z.clearcoatNormalMap,Z.side===le&&Y.clearcoatNormalScale.value.negate()),Y.transmission.value=Z.transmission,Z.transmissionMap&&(Y.transmissionMap.value=Z.transmissionMap)}(g,E,I):m(g,E,I)):E.isMeshMatcapMaterial?(u(g,E),function(Y,Z){Z.matcap&&(Y.matcap.value=Z.matcap),Z.bumpMap&&(Y.bumpMap.value=Z.bumpMap,Y.bumpScale.value=Z.bumpScale,Z.side===le&&(Y.bumpScale.value*=-1)),Z.normalMap&&(Y.normalMap.value=Z.normalMap,Y.normalScale.value.copy(Z.normalScale),Z.side===le&&Y.normalScale.value.negate()),Z.displacementMap&&(Y.displacementMap.value=Z.displacementMap,Y.displacementScale.value=Z.displacementScale,Y.displacementBias.value=Z.displacementBias)}(g,E)):E.isMeshDepthMaterial?(u(g,E),function(Y,Z){Z.displacementMap&&(Y.displacementMap.value=Z.displacementMap,Y.displacementScale.value=Z.displacementScale,Y.displacementBias.value=Z.displacementBias)}(g,E)):E.isMeshDistanceMaterial?(u(g,E),function(Y,Z){Z.displacementMap&&(Y.displacementMap.value=Z.displacementMap,Y.displacementScale.value=Z.displacementScale,Y.displacementBias.value=Z.displacementBias),Y.referencePosition.value.copy(Z.referencePosition),Y.nearDistance.value=Z.nearDistance,Y.farDistance.value=Z.farDistance}(g,E)):E.isMeshNormalMaterial?(u(g,E),function(Y,Z){Z.bumpMap&&(Y.bumpMap.value=Z.bumpMap,Y.bumpScale.value=Z.bumpScale,Z.side===le&&(Y.bumpScale.value*=-1)),Z.normalMap&&(Y.normalMap.value=Z.normalMap,Y.normalScale.value.copy(Z.normalScale),Z.side===le&&Y.normalScale.value.negate()),Z.displacementMap&&(Y.displacementMap.value=Z.displacementMap,Y.displacementScale.value=Z.displacementScale,Y.displacementBias.value=Z.displacementBias)}(g,E)):E.isLineBasicMaterial?(function(Y,Z){Y.diffuse.value.copy(Z.color),Y.opacity.value=Z.opacity}(g,E),E.isLineDashedMaterial&&function(Y,Z){Y.dashSize.value=Z.dashSize,Y.totalSize.value=Z.dashSize+Z.gapSize,Y.scale.value=Z.scale}(g,E)):E.isPointsMaterial?function(Y,Z,me,S){let e;Y.diffuse.value.copy(Z.color),Y.opacity.value=Z.opacity,Y.size.value=Z.size*me,Y.scale.value=.5*S,Z.map&&(Y.map.value=Z.map),Z.alphaMap&&(Y.alphaMap.value=Z.alphaMap),Z.map?e=Z.map:Z.alphaMap&&(e=Z.alphaMap),void 0!==e&&(!0===e.matrixAutoUpdate&&e.updateMatrix(),Y.uvTransform.value.copy(e.matrix))}(g,E,V,J):E.isSpriteMaterial?function(Y,Z){let me;Y.diffuse.value.copy(Z.color),Y.opacity.value=Z.opacity,Y.rotation.value=Z.rotation,Z.map&&(Y.map.value=Z.map),Z.alphaMap&&(Y.alphaMap.value=Z.alphaMap),Z.map?me=Z.map:Z.alphaMap&&(me=Z.alphaMap),void 0!==me&&(!0===me.matrixAutoUpdate&&me.updateMatrix(),Y.uvTransform.value.copy(me.matrix))}(g,E):E.isShadowMaterial?(g.color.value.copy(E.color),g.opacity.value=E.opacity):E.isShaderMaterial&&(E.uniformsNeedUpdate=!1)}}}function $u(t){const u=void 0!==(t=t||{}).canvas?t.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),m=void 0!==t.context?t.context:null,g=void 0!==t.alpha&&t.alpha,E=void 0===t.depth||t.depth,I=void 0===t.stencil||t.stencil,V=void 0!==t.antialias&&t.antialias,J=void 0===t.premultipliedAlpha||t.premultipliedAlpha,Y=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,Z=void 0!==t.powerPreference?t.powerPreference:"default",me=void 0!==t.failIfMajorPerformanceCaveat&&t.failIfMajorPerformanceCaveat;let S=null,e=null;this.domElement=u,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=Qi,this.physicallyCorrectLights=!1,this.toneMapping=vr,this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4;const c=this;let p=!1,_=null,w=0,L=0,O=null,D=null,z=-1,Q=null,ae=null;const ie=new gi,he=new gi;let ye=null,Me=u.width,Ne=u.height,$e=1,ze=null,Ye=null;const We=new gi(0,0,Me,Ne),nt=new gi(0,0,Me,Ne);let it=!1;const mt=new Vc,xt=new Ll;let Dt=!1,Ht=!1;const Je=new ti,pt=new ot,Vt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Nt(){return null===O?$e:1}let ct,Yt,St,jt,It,an,Ze,st,Rt,Gt,tn,En,Zn,qn,on,dt,sn,Sn,hn,Wt=m;function xr(Mt,Rn){for(let pn=0;pn<Mt.length;pn++){const _r=u.getContext(Mt[pn],Rn);if(null!==_r)return _r}return null}try{const Mt={alpha:g,depth:E,stencil:I,antialias:V,premultipliedAlpha:J,preserveDrawingBuffer:Y,powerPreference:Z,failIfMajorPerformanceCaveat:me};if(u.addEventListener("webglcontextlost",_o,!1),u.addEventListener("webglcontextrestored",ml,!1),null===Wt){const Rn=["webgl2","webgl","experimental-webgl"];if(!0===c.isWebGL1Renderer&&Rn.shift(),Wt=xr(Rn,Mt),null===Wt)throw xr(Rn)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===Wt.getShaderPrecisionFormat&&(Wt.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Mt){throw console.error("THREE.WebGLRenderer: "+Mt.message),Mt}function mr(){ct=new Wc(Wt),Yt=new ar(Wt,ct,t),!1===Yt.isWebGL2&&(ct.get("WEBGL_depth_texture"),ct.get("OES_texture_float"),ct.get("OES_texture_half_float"),ct.get("OES_texture_half_float_linear"),ct.get("OES_standard_derivatives"),ct.get("OES_element_index_uint"),ct.get("OES_vertex_array_object"),ct.get("ANGLE_instanced_arrays")),ct.get("OES_texture_float_linear"),Sn=new la(Wt,ct,Yt),St=new Yc(Wt,ct,Yt),St.scissor(he.copy(nt).multiplyScalar($e).floor()),St.viewport(ie.copy(We).multiplyScalar($e).floor()),jt=new qc(Wt),It=new uf,an=new $h(Wt,ct,St,It,Yt,Sn,jt),Ze=new Sa(Wt,Yt),hn=new Su(Wt,ct,Ze,Yt),st=new Mo(Wt,Ze,jt,hn),Rt=new Tu(Wt,st,Ze,jt),on=new Xl(Wt),Gt=new Om(c,ct,Yt,hn),tn=new Bf(It),En=new $f(It),Zn=new Lf,qn=new ed(c,St,Rt,J),dt=new li(Wt,ct,jt,Yt),sn=new Xn(Wt,ct,jt,Yt),jt.programs=Gt.programs,c.capabilities=Yt,c.extensions=ct,c.properties=It,c.renderLists=En,c.state=St,c.info=jt}mr();const Br=new Jd(c,Wt);this.xr=Br;const Gi=new lm(c,Rt,Yt.maxTextureSize);function _o(Mt){Mt.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),p=!0}function ml(){console.log("THREE.WebGLRenderer: Context Restored."),p=!1,mr()}function Ho(Mt){const Rn=Mt.target;var pn;Rn.removeEventListener("dispose",Ho),_l(pn=Rn),It.remove(pn)}function _l(Mt){const Rn=It.get(Mt).program;void 0!==Rn&&Gt.releaseProgram(Rn)}this.shadowMap=Gi,this.getContext=function(){return Wt},this.getContextAttributes=function(){return Wt.getContextAttributes()},this.forceContextLoss=function(){const Mt=ct.get("WEBGL_lose_context");Mt&&Mt.loseContext()},this.forceContextRestore=function(){const Mt=ct.get("WEBGL_lose_context");Mt&&Mt.restoreContext()},this.getPixelRatio=function(){return $e},this.setPixelRatio=function(Mt){void 0!==Mt&&($e=Mt,this.setSize(Me,Ne,!1))},this.getSize=function(Mt){return void 0===Mt&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),Mt=new wn),Mt.set(Me,Ne)},this.setSize=function(Mt,Rn,pn){Br.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(Me=Mt,Ne=Rn,u.width=Math.floor(Mt*$e),u.height=Math.floor(Rn*$e),!1!==pn&&(u.style.width=Mt+"px",u.style.height=Rn+"px"),this.setViewport(0,0,Mt,Rn))},this.getDrawingBufferSize=function(Mt){return void 0===Mt&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),Mt=new wn),Mt.set(Me*$e,Ne*$e).floor()},this.setDrawingBufferSize=function(Mt,Rn,pn){Me=Mt,Ne=Rn,$e=pn,u.width=Math.floor(Mt*pn),u.height=Math.floor(Rn*pn),this.setViewport(0,0,Mt,Rn)},this.getCurrentViewport=function(Mt){return void 0===Mt&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),Mt=new gi),Mt.copy(ie)},this.getViewport=function(Mt){return Mt.copy(We)},this.setViewport=function(Mt,Rn,pn,kn){Mt.isVector4?We.set(Mt.x,Mt.y,Mt.z,Mt.w):We.set(Mt,Rn,pn,kn),St.viewport(ie.copy(We).multiplyScalar($e).floor())},this.getScissor=function(Mt){return Mt.copy(nt)},this.setScissor=function(Mt,Rn,pn,kn){Mt.isVector4?nt.set(Mt.x,Mt.y,Mt.z,Mt.w):nt.set(Mt,Rn,pn,kn),St.scissor(he.copy(nt).multiplyScalar($e).floor())},this.getScissorTest=function(){return it},this.setScissorTest=function(Mt){St.setScissorTest(it=Mt)},this.setOpaqueSort=function(Mt){ze=Mt},this.setTransparentSort=function(Mt){Ye=Mt},this.getClearColor=function(){return qn.getClearColor()},this.setClearColor=function(){qn.setClearColor.apply(qn,arguments)},this.getClearAlpha=function(){return qn.getClearAlpha()},this.setClearAlpha=function(){qn.setClearAlpha.apply(qn,arguments)},this.clear=function(Mt,Rn,pn){let kn=0;(void 0===Mt||Mt)&&(kn|=16384),(void 0===Rn||Rn)&&(kn|=256),(void 0===pn||pn)&&(kn|=1024),Wt.clear(kn)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){u.removeEventListener("webglcontextlost",_o,!1),u.removeEventListener("webglcontextrestored",ml,!1),En.dispose(),Zn.dispose(),It.dispose(),Rt.dispose(),hn.dispose(),Br.dispose(),pp.stop()},this.renderBufferImmediate=function(Mt,Rn){hn.initAttributes();const pn=It.get(Mt);Mt.hasPositions&&!pn.position&&(pn.position=Wt.createBuffer()),Mt.hasNormals&&!pn.normal&&(pn.normal=Wt.createBuffer()),Mt.hasUvs&&!pn.uv&&(pn.uv=Wt.createBuffer()),Mt.hasColors&&!pn.color&&(pn.color=Wt.createBuffer());const kn=Rn.getAttributes();Mt.hasPositions&&(Wt.bindBuffer(34962,pn.position),Wt.bufferData(34962,Mt.positionArray,35048),hn.enableAttribute(kn.position),Wt.vertexAttribPointer(kn.position,3,5126,!1,0,0)),Mt.hasNormals&&(Wt.bindBuffer(34962,pn.normal),Wt.bufferData(34962,Mt.normalArray,35048),hn.enableAttribute(kn.normal),Wt.vertexAttribPointer(kn.normal,3,5126,!1,0,0)),Mt.hasUvs&&(Wt.bindBuffer(34962,pn.uv),Wt.bufferData(34962,Mt.uvArray,35048),hn.enableAttribute(kn.uv),Wt.vertexAttribPointer(kn.uv,2,5126,!1,0,0)),Mt.hasColors&&(Wt.bindBuffer(34962,pn.color),Wt.bufferData(34962,Mt.colorArray,35048),hn.enableAttribute(kn.color),Wt.vertexAttribPointer(kn.color,3,5126,!1,0,0)),hn.disableUnusedAttributes(),Wt.drawArrays(4,0,Mt.count),Mt.count=0},this.renderBufferDirect=function(Mt,Rn,pn,kn,_r,Ti){null===Rn&&(Rn=Vt);const Ii=_r.isMesh&&_r.matrixWorld.determinant()<0,ri=Vn(Mt,Rn,kn,_r);St.setMaterial(kn,Ii);let xs=pn.index;const os=pn.attributes.position;if(null===xs){if(void 0===os||0===os.count)return}else if(0===xs.count)return;let Qs,ws=1;!0===kn.wireframe&&(xs=st.getWireframeAttribute(pn),ws=2),(kn.morphTargets||kn.morphNormals)&&on.update(_r,pn,kn,ri),hn.setup(_r,kn,ri,pn,xs);let Oi=dt;null!==xs&&(Qs=Ze.get(xs),Oi=sn,Oi.setIndex(Qs));const ga=null!==xs?xs.count:os.count,Ba=pn.drawRange.start*ws,Qo=pn.drawRange.count*ws,hu=null!==Ti?Ti.start*ws:0,_t=null!==Ti?Ti.count*ws:1/0,bn=Math.max(Ba,hu),en=Math.min(ga,Ba+Qo,hu+_t)-1,yn=Math.max(0,en-bn+1);if(0!==yn){if(_r.isMesh)!0===kn.wireframe?(St.setLineWidth(kn.wireframeLinewidth*Nt()),Oi.setMode(1)):Oi.setMode(4);else if(_r.isLine){let jn=kn.linewidth;void 0===jn&&(jn=1),St.setLineWidth(jn*Nt()),Oi.setMode(_r.isLineSegments?1:_r.isLineLoop?2:3)}else _r.isPoints?Oi.setMode(0):_r.isSprite&&Oi.setMode(4);if(_r.isInstancedMesh)Oi.renderInstances(bn,yn,_r.count);else if(pn.isInstancedBufferGeometry){const jn=Math.min(pn.instanceCount,pn._maxInstanceCount);Oi.renderInstances(bn,yn,jn)}else Oi.render(bn,yn)}},this.compile=function(Mt,Rn){e=Zn.get(Mt,Rn),e.init(),Mt.traverse(function(kn){kn.isLight&&(e.pushLight(kn),kn.castShadow&&e.pushShadow(kn))}),e.setupLights(Rn);const pn=new WeakMap;Mt.traverse(function(kn){let _r=kn.material;if(_r)if(Array.isArray(_r))for(let Ti=0;Ti<_r.length;Ti++){let Ii=_r[Ti];!1===pn.has(Ii)&&(gl(Ii,Mt,kn),pn.set(Ii))}else!1===pn.has(_r)&&(gl(_r,Mt,kn),pn.set(_r))})};let uu=null;const pp=new Lp;function Fd(Mt,Rn,pn,kn){if(!1===Mt.visible)return;if(Mt.layers.test(Rn.layers))if(Mt.isGroup)pn=Mt.renderOrder;else if(Mt.isLOD)!0===Mt.autoUpdate&&Mt.update(Rn);else if(Mt.isLight)e.pushLight(Mt),Mt.castShadow&&e.pushShadow(Mt);else if(Mt.isSprite){if(!Mt.frustumCulled||mt.intersectsSprite(Mt)){kn&&pt.setFromMatrixPosition(Mt.matrixWorld).applyMatrix4(Je);const Ti=Rt.update(Mt),Ii=Mt.material;Ii.visible&&S.push(Mt,Ti,Ii,pn,pt.z,null)}}else if(Mt.isImmediateRenderObject)kn&&pt.setFromMatrixPosition(Mt.matrixWorld).applyMatrix4(Je),S.push(Mt,null,Mt.material,pn,pt.z,null);else if((Mt.isMesh||Mt.isLine||Mt.isPoints)&&(Mt.isSkinnedMesh&&Mt.skeleton.frame!==jt.render.frame&&(Mt.skeleton.update(),Mt.skeleton.frame=jt.render.frame),!Mt.frustumCulled||mt.intersectsObject(Mt))){kn&&pt.setFromMatrixPosition(Mt.matrixWorld).applyMatrix4(Je);const Ti=Rt.update(Mt),Ii=Mt.material;if(Array.isArray(Ii)){const ri=Ti.groups;for(let xs=0,os=ri.length;xs<os;xs++){const Qs=ri[xs],ws=Ii[Qs.materialIndex];ws&&ws.visible&&S.push(Mt,Ti,ws,pn,pt.z,Qs)}}else Ii.visible&&S.push(Mt,Ti,Ii,pn,pt.z,null)}const _r=Mt.children;for(let Ti=0,Ii=_r.length;Ti<Ii;Ti++)Fd(_r[Ti],Rn,pn,kn)}function Dd(Mt,Rn,pn){const kn=!0===Rn.isScene?Rn.overrideMaterial:null;for(let _r=0,Ti=Mt.length;_r<Ti;_r++){const Ii=Mt[_r],ri=Ii.object,xs=Ii.geometry,os=null===kn?Ii.material:kn,Qs=Ii.group;if(pn.isArrayCamera){ae=pn;const ws=pn.cameras;for(let Oi=0,ga=ws.length;Oi<ga;Oi++){const Ba=ws[Oi];ri.layers.test(Ba.layers)&&(St.viewport(ie.copy(Ba.viewport)),e.setupLights(Ba),_h(ri,Rn,Ba,xs,os,Qs))}}else ae=null,_h(ri,Rn,pn,xs,os,Qs)}}function _h(Mt,Rn,pn,kn,_r,Ti){if(Mt.onBeforeRender(c,Rn,pn,kn,_r,Ti),e=Zn.get(Rn,ae||pn),Mt.modelViewMatrix.multiplyMatrices(pn.matrixWorldInverse,Mt.matrixWorld),Mt.normalMatrix.getNormalMatrix(Mt.modelViewMatrix),Mt.isImmediateRenderObject){const Ii=Vn(pn,Rn,_r,Mt);St.setMaterial(_r),hn.reset(),xs=Ii,Mt.render(function(os){c.renderBufferImmediate(os,xs)})}else c.renderBufferDirect(pn,Rn,kn,_r,Mt,Ti);var xs;Mt.onAfterRender(c,Rn,pn,kn,_r,Ti),e=Zn.get(Rn,ae||pn)}function gl(Mt,Rn,pn){!0!==Rn.isScene&&(Rn=Vt);const kn=It.get(Mt),_r=e.state.lights,Ii=_r.state.version,ri=Gt.getParameters(Mt,_r.state,e.state.shadowsArray,Rn,xt.numPlanes,xt.numIntersection,pn),xs=Gt.getProgramCacheKey(ri);let os=kn.program,Qs=!0;if(void 0===os)Mt.addEventListener("dispose",Ho);else if(os.cacheKey!==xs)_l(Mt);else if(kn.lightsStateVersion!==Ii)kn.lightsStateVersion=Ii,Qs=!1;else{if(void 0!==ri.shaderID)return;Qs=!1}Qs&&(ri.uniforms=Gt.getUniforms(Mt,ri),Mt.onBeforeCompile(ri,c),os=Gt.acquireProgram(ri,xs),kn.program=os,kn.uniforms=ri.uniforms,kn.outputEncoding=ri.outputEncoding);const ws=os.getAttributes();if(Mt.morphTargets){Mt.numSupportedMorphTargets=0;for(let Qo=0;Qo<c.maxMorphTargets;Qo++)ws["morphTarget"+Qo]>=0&&Mt.numSupportedMorphTargets++}if(Mt.morphNormals){Mt.numSupportedMorphNormals=0;for(let Qo=0;Qo<c.maxMorphNormals;Qo++)ws["morphNormal"+Qo]>=0&&Mt.numSupportedMorphNormals++}const Oi=kn.uniforms;var Qo;(Mt.isShaderMaterial||Mt.isRawShaderMaterial)&&!0!==Mt.clipping||(kn.numClippingPlanes=xt.numPlanes,kn.numIntersection=xt.numIntersection,Oi.clippingPlanes=xt.uniform),kn.environment=Mt.isMeshStandardMaterial?Rn.environment:null,kn.fog=Rn.fog,kn.needsLights=(Qo=Mt).isMeshLambertMaterial||Qo.isMeshToonMaterial||Qo.isMeshPhongMaterial||Qo.isMeshStandardMaterial||Qo.isShadowMaterial||Qo.isShaderMaterial&&!0===Qo.lights,kn.lightsStateVersion=Ii,kn.needsLights&&(Oi.ambientLightColor.value=_r.state.ambient,Oi.lightProbe.value=_r.state.probe,Oi.directionalLights.value=_r.state.directional,Oi.directionalLightShadows.value=_r.state.directionalShadow,Oi.spotLights.value=_r.state.spot,Oi.spotLightShadows.value=_r.state.spotShadow,Oi.rectAreaLights.value=_r.state.rectArea,Oi.pointLights.value=_r.state.point,Oi.pointLightShadows.value=_r.state.pointShadow,Oi.hemisphereLights.value=_r.state.hemi,Oi.directionalShadowMap.value=_r.state.directionalShadowMap,Oi.directionalShadowMatrix.value=_r.state.directionalShadowMatrix,Oi.spotShadowMap.value=_r.state.spotShadowMap,Oi.spotShadowMatrix.value=_r.state.spotShadowMatrix,Oi.pointShadowMap.value=_r.state.pointShadowMap,Oi.pointShadowMatrix.value=_r.state.pointShadowMatrix);const ga=kn.program.getUniforms(),Ba=Rp.seqWithValue(ga.seq,Oi);kn.uniformsList=Ba}function Vn(Mt,Rn,pn,kn){!0!==Rn.isScene&&(Rn=Vt),an.resetTextureUnits();const _r=Rn.fog,Ti=pn.isMeshStandardMaterial?Rn.environment:null,Ii=null===O?c.outputEncoding:O.texture.encoding,ri=It.get(pn),xs=e.state.lights;!0!==Dt||!0!==Ht&&Mt===Q||xt.setState(pn.clippingPlanes,pn.clipIntersection,pn.clipShadows,Mt,ri,Mt===Q&&pn.id===z),pn.version===ri.__version?void 0===ri.program||pn.fog&&ri.fog!==_r||ri.environment!==Ti||ri.needsLights&&ri.lightsStateVersion!==xs.state.version?gl(pn,Rn,kn):void 0===ri.numClippingPlanes||ri.numClippingPlanes===xt.numPlanes&&ri.numIntersection===xt.numIntersection?ri.outputEncoding!==Ii&&gl(pn,Rn,kn):gl(pn,Rn,kn):(gl(pn,Rn,kn),ri.__version=pn.version);let os=!1,Qs=!1,ws=!1;const Oi=ri.program,ga=Oi.getUniforms(),Ba=ri.uniforms;if(St.useProgram(Oi.program)&&(os=!0,Qs=!0,ws=!0),pn.id!==z&&(z=pn.id,Qs=!0),os||Q!==Mt){if(ga.setValue(Wt,"projectionMatrix",Mt.projectionMatrix),Yt.logarithmicDepthBuffer&&ga.setValue(Wt,"logDepthBufFC",2/(Math.log(Mt.far+1)/Math.LN2)),Q!==Mt&&(Q=Mt,Qs=!0,ws=!0),pn.isShaderMaterial||pn.isMeshPhongMaterial||pn.isMeshToonMaterial||pn.isMeshStandardMaterial||pn.envMap){const _t=ga.map.cameraPosition;void 0!==_t&&_t.setValue(Wt,pt.setFromMatrixPosition(Mt.matrixWorld))}(pn.isMeshPhongMaterial||pn.isMeshToonMaterial||pn.isMeshLambertMaterial||pn.isMeshBasicMaterial||pn.isMeshStandardMaterial||pn.isShaderMaterial)&&ga.setValue(Wt,"isOrthographic",!0===Mt.isOrthographicCamera),(pn.isMeshPhongMaterial||pn.isMeshToonMaterial||pn.isMeshLambertMaterial||pn.isMeshBasicMaterial||pn.isMeshStandardMaterial||pn.isShaderMaterial||pn.isShadowMaterial||pn.skinning)&&ga.setValue(Wt,"viewMatrix",Mt.matrixWorldInverse)}if(pn.skinning){ga.setOptional(Wt,kn,"bindMatrix"),ga.setOptional(Wt,kn,"bindMatrixInverse");const _t=kn.skeleton;if(_t)if(Yt.floatVertexTextures){if(void 0===_t.boneTexture){let en=Math.sqrt(4*_t.bones.length);en=rr.ceilPowerOfTwo(en),en=Math.max(en,4);const yn=new Float32Array(en*en*4);yn.set(_t.boneMatrices);const jn=new ol(yn,en,en,lo,Vo);_t.boneMatrices=yn,_t.boneTexture=jn,_t.boneTextureSize=en}ga.setValue(Wt,"boneTexture",_t.boneTexture,an),ga.setValue(Wt,"boneTextureSize",_t.boneTextureSize)}else ga.setOptional(Wt,_t,"boneMatrices")}var Qo,hu;return(Qs||ri.receiveShadow!==kn.receiveShadow)&&(ri.receiveShadow=kn.receiveShadow,ga.setValue(Wt,"receiveShadow",kn.receiveShadow)),Qs&&(ga.setValue(Wt,"toneMappingExposure",c.toneMappingExposure),ri.needsLights&&((Qo=Ba).ambientLightColor.needsUpdate=hu=ws,Qo.lightProbe.needsUpdate=hu,Qo.directionalLights.needsUpdate=hu,Qo.directionalLightShadows.needsUpdate=hu,Qo.pointLights.needsUpdate=hu,Qo.pointLightShadows.needsUpdate=hu,Qo.spotLights.needsUpdate=hu,Qo.spotLightShadows.needsUpdate=hu,Qo.rectAreaLights.needsUpdate=hu,Qo.hemisphereLights.needsUpdate=hu),_r&&pn.fog&&tn.refreshFogUniforms(Ba,_r),tn.refreshMaterialUniforms(Ba,pn,Ti,$e,Ne),void 0!==Ba.ltc_1&&(Ba.ltc_1.value=pr.LTC_1),void 0!==Ba.ltc_2&&(Ba.ltc_2.value=pr.LTC_2),Rp.upload(Wt,ri.uniformsList,Ba,an)),pn.isShaderMaterial&&!0===pn.uniformsNeedUpdate&&(Rp.upload(Wt,ri.uniformsList,Ba,an),pn.uniformsNeedUpdate=!1),pn.isSpriteMaterial&&ga.setValue(Wt,"center",kn.center),ga.setValue(Wt,"modelViewMatrix",kn.modelViewMatrix),ga.setValue(Wt,"normalMatrix",kn.normalMatrix),ga.setValue(Wt,"modelMatrix",kn.matrixWorld),Oi}pp.setAnimationLoop(function(Mt){Br.isPresenting||uu&&uu(Mt)}),typeof window<"u"&&pp.setContext(window),this.setAnimationLoop=function(Mt){uu=Mt,Br.setAnimationLoop(Mt),null===Mt?pp.stop():pp.start()},this.render=function(Mt,Rn){let pn,kn;if(void 0!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),pn=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),kn=arguments[3]),void 0!==Rn&&!0!==Rn.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!0===p)return;hn.resetDefaultState(),z=-1,Q=null,!0===Mt.autoUpdate&&Mt.updateMatrixWorld(),null===Rn.parent&&Rn.updateMatrixWorld(),!0===Br.enabled&&!0===Br.isPresenting&&(Rn=Br.getCamera(Rn)),!0===Mt.isScene&&Mt.onBeforeRender(c,Mt,Rn,pn||O),e=Zn.get(Mt,Rn),e.init(),Je.multiplyMatrices(Rn.projectionMatrix,Rn.matrixWorldInverse),mt.setFromProjectionMatrix(Je),Ht=this.localClippingEnabled,Dt=xt.init(this.clippingPlanes,Ht,Rn),S=En.get(Mt,Rn),S.init(),Fd(Mt,Rn,0,c.sortObjects),S.finish(),!0===c.sortObjects&&S.sort(ze,Ye),!0===Dt&&xt.beginShadows(),Gi.render(e.state.shadowsArray,Mt,Rn),e.setupLights(Rn),!0===Dt&&xt.endShadows(),!0===this.info.autoReset&&this.info.reset(),void 0!==pn&&this.setRenderTarget(pn),qn.render(S,Mt,Rn,kn);const Ti=S.opaque,Ii=S.transparent;Ti.length>0&&Dd(Ti,Mt,Rn),Ii.length>0&&Dd(Ii,Mt,Rn),!0===Mt.isScene&&Mt.onAfterRender(c,Mt,Rn),null!==O&&(an.updateRenderTargetMipmap(O),an.updateMultisampleRenderTarget(O)),St.buffers.depth.setTest(!0),St.buffers.depth.setMask(!0),St.buffers.color.setMask(!0),St.setPolygonOffset(!1),S=null,e=null},this.setFramebuffer=function(Mt){_!==Mt&&null===O&&Wt.bindFramebuffer(36160,Mt),_=Mt},this.getActiveCubeFace=function(){return w},this.getActiveMipmapLevel=function(){return L},this.getRenderTarget=function(){return O},this.setRenderTarget=function(Mt,Rn,pn){O=Mt,w=Rn,L=pn,Mt&&void 0===It.get(Mt).__webglFramebuffer&&an.setupRenderTarget(Mt);let kn=_,_r=!1;if(Mt){const Ti=It.get(Mt).__webglFramebuffer;Mt.isWebGLCubeRenderTarget?(kn=Ti[Rn||0],_r=!0):kn=Mt.isWebGLMultisampleRenderTarget?It.get(Mt).__webglMultisampledFramebuffer:Ti,ie.copy(Mt.viewport),he.copy(Mt.scissor),ye=Mt.scissorTest}else ie.copy(We).multiplyScalar($e).floor(),he.copy(nt).multiplyScalar($e).floor(),ye=it;if(D!==kn&&(Wt.bindFramebuffer(36160,kn),D=kn),St.viewport(ie),St.scissor(he),St.setScissorTest(ye),_r){const Ti=It.get(Mt.texture);Wt.framebufferTexture2D(36160,36064,34069+(Rn||0),Ti.__webglTexture,pn||0)}},this.readRenderTargetPixels=function(Mt,Rn,pn,kn,_r,Ti,Ii){if(!Mt||!Mt.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let ri=It.get(Mt).__webglFramebuffer;if(Mt.isWebGLCubeRenderTarget&&void 0!==Ii&&(ri=ri[Ii]),ri){let xs=!1;ri!==D&&(Wt.bindFramebuffer(36160,ri),xs=!0);try{const os=Mt.texture,Qs=os.format,ws=os.type;if(Qs!==lo&&Sn.convert(Qs)!==Wt.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(ws===ea||Sn.convert(ws)===Wt.getParameter(35738)||ws===Vo&&(Yt.isWebGL2||ct.get("OES_texture_float")||ct.get("WEBGL_color_buffer_float"))||ws===ds&&ct.get(Yt.isWebGL2?"EXT_color_buffer_float":"EXT_color_buffer_half_float")))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===Wt.checkFramebufferStatus(36160)?Rn>=0&&Rn<=Mt.width-kn&&pn>=0&&pn<=Mt.height-_r&&Wt.readPixels(Rn,pn,kn,_r,Sn.convert(Qs),Sn.convert(ws),Ti):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{xs&&Wt.bindFramebuffer(36160,D)}}},this.copyFramebufferToTexture=function(Mt,Rn,pn){void 0===pn&&(pn=0);const kn=Math.pow(2,-pn),_r=Math.floor(Rn.image.width*kn),Ti=Math.floor(Rn.image.height*kn),Ii=Sn.convert(Rn.format);an.setTexture2D(Rn,0),Wt.copyTexImage2D(3553,pn,Ii,Mt.x,Mt.y,_r,Ti,0),St.unbindTexture()},this.copyTextureToTexture=function(Mt,Rn,pn,kn){void 0===kn&&(kn=0);const _r=Rn.image.width,Ti=Rn.image.height,Ii=Sn.convert(pn.format),ri=Sn.convert(pn.type);an.setTexture2D(pn,0),Wt.pixelStorei(37440,pn.flipY),Wt.pixelStorei(37441,pn.premultiplyAlpha),Wt.pixelStorei(3317,pn.unpackAlignment),Rn.isDataTexture?Wt.texSubImage2D(3553,kn,Mt.x,Mt.y,_r,Ti,Ii,ri,Rn.image.data):Rn.isCompressedTexture?Wt.compressedTexSubImage2D(3553,kn,Mt.x,Mt.y,Rn.mipmaps[0].width,Rn.mipmaps[0].height,Ii,Rn.mipmaps[0].data):Wt.texSubImage2D(3553,kn,Mt.x,Mt.y,Ii,ri,Rn.image),0===kn&&pn.generateMipmaps&&Wt.generateMipmap(3553),St.unbindTexture()},this.initTexture=function(Mt){an.setTexture2D(Mt,0),St.unbindTexture()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function Op(t){$u.call(this,t)}function Sd(t,u){this.name="",this.color=new lr(t),this.density=void 0!==u?u:25e-5}function pf(t,u,m){this.name="",this.color=new lr(t),this.near=void 0!==u?u:1,this.far=void 0!==m?m:1e3}function Jc(t,u){this.array=t,this.stride=u,this.count=void 0!==t?t.length/u:0,this.usage=_i,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=rr.generateUUID()}Ch.prototype=Object.assign(Object.create(Bs.prototype),{constructor:Ch,isArrayCamera:!0}),Ys.prototype=Object.assign(Object.create(er.prototype),{constructor:Ys,isGroup:!0}),Object.assign(Ec.prototype,{constructor:Ec,getHandSpace:function(){if(null===this._hand&&(this._hand=new Ys,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints=[],this._hand.inputState={pinching:!1},window.XRHand))for(let t=0;t<=window.XRHand.LITTLE_PHALANX_TIP;t++){let u=new Ys;u.matrixAutoUpdate=!1,u.visible=!1,this._hand.joints.push(u),this._hand.add(u)}return this._hand},getTargetRaySpace:function(){return null===this._targetRay&&(this._targetRay=new Ys,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return null===this._grip&&(this._grip=new Ys,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(t){return null!==this._targetRay&&this._targetRay.dispatchEvent(t),null!==this._grip&&this._grip.dispatchEvent(t),null!==this._hand&&this._hand.dispatchEvent(t),this},disconnect:function(t){return this.dispatchEvent({type:"disconnected",data:t}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this},update:function(t,u,m){let g=null,E=null,I=null;const V=this._targetRay,J=this._grip,Y=this._hand;if(t)if(t.hand){I=!0;for(let Z=0;Z<=window.XRHand.LITTLE_PHALANX_TIP;Z++)if(t.hand[Z]){let me=u.getJointPose(t.hand[Z],m);const S=Y.joints[Z];null!==me&&(S.matrix.fromArray(me.transform.matrix),S.matrix.decompose(S.position,S.rotation,S.scale),S.jointRadius=me.radius),S.visible=null!==me;const e=Y.joints[window.XRHand.INDEX_PHALANX_TIP],c=Y.joints[window.XRHand.THUMB_PHALANX_TIP],p=e.position.distanceTo(c.position),_=.02,w=.005;Y.inputState.pinching&&p>_+w?(Y.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!Y.inputState.pinching&&p<=_-w&&(Y.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}}else null!==V&&(g=u.getPose(t.targetRaySpace,m),null!==g&&(V.matrix.fromArray(g.transform.matrix),V.matrix.decompose(V.position,V.rotation,V.scale))),null!==J&&t.gripSpace&&(E=u.getPose(t.gripSpace,m),null!==E&&(J.matrix.fromArray(E.transform.matrix),J.matrix.decompose(J.position,J.rotation,J.scale)));return null!==V&&(V.visible=null!==g),null!==J&&(J.visible=null!==E),null!==Y&&(Y.visible=null!==I),this}}),Object.assign(Jd.prototype,ia.prototype),Op.prototype=Object.assign(Object.create($u.prototype),{constructor:Op,isWebGL1Renderer:!0}),Object.assign(Sd.prototype,{isFogExp2:!0,clone:function(){return new Sd(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}),Object.assign(pf.prototype,{isFog:!0,clone:function(){return new pf(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}),Object.defineProperty(Jc.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(Jc.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this},copyAt:function(t,u,m){t*=this.stride,m*=u.stride;for(let g=0,E=this.stride;g<E;g++)this.array[t+g]=u.array[m+g];return this},set:function(t,u){return void 0===u&&(u=0),this.array.set(t,u),this},clone:function(t){void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=rr.generateUUID()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const u=new Jc(new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),this.stride);return u.setUsage(this.usage),u},onUpload:function(t){return this.onUploadCallback=t,this},toJSON:function(t){return void 0===t.arrayBuffers&&(t.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=rr.generateUUID()),void 0===t.arrayBuffers[this.array.buffer._uuid]&&(t.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}});const kp=new ot;function Fp(t,u,m,g){this.name="",this.data=t,this.itemSize=u,this.offset=m,this.normalized=!0===g}function Lh(t){Ur.call(this),this.type="SpriteMaterial",this.color=new lr(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(t)}let Zc;Object.defineProperties(Fp.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}},needsUpdate:{set:function(t){this.data.needsUpdate=t}}}),Object.assign(Fp.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(t){for(let u=0,m=this.data.count;u<m;u++)kp.x=this.getX(u),kp.y=this.getY(u),kp.z=this.getZ(u),kp.applyMatrix4(t),this.setXYZ(u,kp.x,kp.y,kp.z);return this},setX:function(t,u){return this.data.array[t*this.data.stride+this.offset]=u,this},setY:function(t,u){return this.data.array[t*this.data.stride+this.offset+1]=u,this},setZ:function(t,u){return this.data.array[t*this.data.stride+this.offset+2]=u,this},setW:function(t,u){return this.data.array[t*this.data.stride+this.offset+3]=u,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,u,m){return this.data.array[(t=t*this.data.stride+this.offset)+0]=u,this.data.array[t+1]=m,this},setXYZ:function(t,u,m,g){return this.data.array[(t=t*this.data.stride+this.offset)+0]=u,this.data.array[t+1]=m,this.data.array[t+2]=g,this},setXYZW:function(t,u,m,g,E){return this.data.array[(t=t*this.data.stride+this.offset)+0]=u,this.data.array[t+1]=m,this.data.array[t+2]=g,this.data.array[t+3]=E,this},clone:function(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const u=[];for(let m=0;m<this.count;m++){const g=m*this.data.stride+this.offset;for(let E=0;E<this.itemSize;E++)u.push(this.data.array[g+E])}return new Gr(new this.array.constructor(u),this.itemSize,this.normalized)}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new Fp(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)},toJSON:function(t){if(void 0===t){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const u=[];for(let m=0;m<this.count;m++){const g=m*this.data.stride+this.offset;for(let E=0;E<this.itemSize;E++)u.push(this.data.array[g+E])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:u,normalized:this.normalized}}return void 0===t.interleavedBuffers&&(t.interleavedBuffers={}),void 0===t.interleavedBuffers[this.data.uuid]&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}),(Lh.prototype=Object.create(Ur.prototype)).constructor=Lh,Lh.prototype.isSpriteMaterial=!0,Lh.prototype.copy=function(t){return Ur.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this};const Bh=new ot,Dp=new ot,wi=new ot,Ed=new wn,Td=new wn,df=new ti,ff=new ot,nd=new ot,mf=new ot,Jl=new wn,Nf=new wn,Rf=new wn;function Zd(t){if(er.call(this),this.type="Sprite",void 0===Zc){Zc=new dn;const u=new Jc(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);Zc.setIndex([0,1,2,0,2,3]),Zc.setAttribute("position",new Fp(u,3,0,!1)),Zc.setAttribute("uv",new Fp(u,2,3,!1))}this.geometry=Zc,this.material=void 0!==t?t:new Lh,this.center=new wn(.5,.5)}function Up(t,u,m,g,E,I){Ed.subVectors(t,m).addScalar(.5).multiply(g),void 0!==E?(Td.x=I*Ed.x-E*Ed.y,Td.y=E*Ed.x+I*Ed.y):Td.copy(Ed),t.copy(u),t.x+=Td.x,t.y+=Td.y,t.applyMatrix4(df)}Zd.prototype=Object.assign(Object.create(er.prototype),{constructor:Zd,isSprite:!0,raycast:function(t,u){null===t.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Dp.setFromMatrixScale(this.matrixWorld),df.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),wi.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Dp.multiplyScalar(-wi.z);const m=this.material.rotation;let g,E;0!==m&&(E=Math.cos(m),g=Math.sin(m));const I=this.center;Up(ff.set(-.5,-.5,0),wi,I,Dp,g,E),Up(nd.set(.5,-.5,0),wi,I,Dp,g,E),Up(mf.set(.5,.5,0),wi,I,Dp,g,E),Jl.set(0,0),Nf.set(1,0),Rf.set(1,1);let V=t.ray.intersectTriangle(ff,nd,mf,!1,Bh);if(null===V&&(Up(nd.set(-.5,.5,0),wi,I,Dp,g,E),Nf.set(0,1),V=t.ray.intersectTriangle(ff,mf,nd,!1,Bh),null===V))return;const J=t.ray.origin.distanceTo(Bh);J<t.near||J>t.far||u.push({distance:J,point:Bh.clone(),uv:Ir.getUV(Bh,ff,nd,mf,Jl,Nf,Rf,new wn),face:null,object:this})},copy:function(t){return er.prototype.copy.call(this,t),void 0!==t.center&&this.center.copy(t.center),this.material=t.material,this}});const rd=new ot,cm=new ot;function ja(){er.call(this),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}function zp(t,u){t&&t.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),Bi.call(this,t,u),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new ti,this.bindMatrixInverse=new ti}ja.prototype=Object.assign(Object.create(er.prototype),{constructor:ja,isLOD:!0,copy:function(t){er.prototype.copy.call(this,t,!1);const u=t.levels;for(let m=0,g=u.length;m<g;m++){const E=u[m];this.addLevel(E.object.clone(),E.distance)}return this.autoUpdate=t.autoUpdate,this},addLevel:function(t,u){void 0===u&&(u=0),u=Math.abs(u);const m=this.levels;let g;for(g=0;g<m.length&&!(u<m[g].distance);g++);return m.splice(g,0,{distance:u,object:t}),this.add(t),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(t){const u=this.levels;if(u.length>0){let m,g;for(m=1,g=u.length;m<g&&!(t<u[m].distance);m++);return u[m-1].object}return null},raycast:function(t,u){if(this.levels.length>0){rd.setFromMatrixPosition(this.matrixWorld);const m=t.ray.origin.distanceTo(rd);this.getObjectForDistance(m).raycast(t,u)}},update:function(t){const u=this.levels;if(u.length>1){rd.setFromMatrixPosition(t.matrixWorld),cm.setFromMatrixPosition(this.matrixWorld);const m=rd.distanceTo(cm)/t.zoom;let g,E;for(u[0].object.visible=!0,g=1,E=u.length;g<E&&m>=u[g].distance;g++)u[g-1].object.visible=!1,u[g].object.visible=!0;for(this._currentLevel=g-1;g<E;g++)u[g].object.visible=!1}},toJSON:function(t){const u=er.prototype.toJSON.call(this,t);!1===this.autoUpdate&&(u.object.autoUpdate=!1),u.object.levels=[];const m=this.levels;for(let g=0,E=m.length;g<E;g++){const I=m[g];u.object.levels.push({object:I.object.uuid,distance:I.distance})}return u}}),zp.prototype=Object.assign(Object.create(Bi.prototype),{constructor:zp,isSkinnedMesh:!0,copy:function(t){return Bi.prototype.copy.call(this,t),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,this},bind:function(t,u){this.skeleton=t,void 0===u&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),u=this.matrixWorld),this.bindMatrix.copy(u),this.bindMatrixInverse.getInverse(u)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){const t=new gi,u=this.geometry.attributes.skinWeight;for(let m=0,g=u.count;m<g;m++){t.x=u.getX(m),t.y=u.getY(m),t.z=u.getZ(m),t.w=u.getW(m);const E=1/t.manhattanLength();E!==1/0?t.multiplyScalar(E):t.set(1,0,0,0),u.setXYZW(m,t.x,t.y,t.z,t.w)}},updateMatrixWorld:function(t){Bi.prototype.updateMatrixWorld.call(this,t),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},boneTransform:function(){const t=new ot,u=new gi,m=new gi,g=new ot,E=new ti;return function(I,V){const J=this.skeleton,Y=this.geometry;u.fromBufferAttribute(Y.attributes.skinIndex,I),m.fromBufferAttribute(Y.attributes.skinWeight,I),t.fromBufferAttribute(Y.attributes.position,I).applyMatrix4(this.bindMatrix),V.set(0,0,0);for(let Z=0;Z<4;Z++){const me=m.getComponent(Z);if(0!==me){const S=u.getComponent(Z);E.multiplyMatrices(J.bones[S].matrixWorld,J.boneInverses[S]),V.addScaledVector(g.copy(t).applyMatrix4(E),me)}}return V.applyMatrix4(this.bindMatrixInverse)}}()});const um=new ti,Dm=new ti;function Qd(t,u){if(this.bones=(t=t||[]).slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),this.frame=-1,void 0===u)this.calculateInverses();else if(this.bones.length===u.length)this.boneInverses=u.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(let m=0,g=this.bones.length;m<g;m++)this.boneInverses.push(new ti)}}function Kd(){er.call(this),this.type="Bone"}Object.assign(Qd.prototype,{calculateInverses:function(){this.boneInverses=[];for(let t=0,u=this.bones.length;t<u;t++){const m=new ti;this.bones[t]&&m.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(m)}},pose:function(){for(let t=0,u=this.bones.length;t<u;t++){const m=this.bones[t];m&&m.matrixWorld.getInverse(this.boneInverses[t])}for(let t=0,u=this.bones.length;t<u;t++){const m=this.bones[t];m&&(m.parent&&m.parent.isBone?(m.matrix.getInverse(m.parent.matrixWorld),m.matrix.multiply(m.matrixWorld)):m.matrix.copy(m.matrixWorld),m.matrix.decompose(m.position,m.quaternion,m.scale))}},update:function(){const t=this.bones,u=this.boneInverses,m=this.boneMatrices,g=this.boneTexture;for(let E=0,I=t.length;E<I;E++)um.multiplyMatrices(t[E]?t[E].matrixWorld:Dm,u[E]),um.toArray(m,16*E);void 0!==g&&(g.needsUpdate=!0)},clone:function(){return new Qd(this.bones,this.boneInverses)},getBoneByName:function(t){for(let u=0,m=this.bones.length;u<m;u++){const g=this.bones[u];if(g.name===t)return g}},dispose:function(){this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=void 0)}}),Kd.prototype=Object.assign(Object.create(er.prototype),{constructor:Kd,isBone:!0});const jp=new ti,hm=new ti,Md=[],Tc=new Bi;function Ad(t,u,m){Bi.call(this,t,u),this.instanceMatrix=new Gr(new Float32Array(16*m),16),this.count=m,this.frustumCulled=!1}function Qn(t){Ur.call(this),this.type="LineBasicMaterial",this.color=new lr(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.morphTargets=!1,this.setValues(t)}Ad.prototype=Object.assign(Object.create(Bi.prototype),{constructor:Ad,isInstancedMesh:!0,copy:function(t){return Bi.prototype.copy.call(this,t),this.instanceMatrix.copy(t.instanceMatrix),this.count=t.count,this},getMatrixAt:function(t,u){u.fromArray(this.instanceMatrix.array,16*t)},raycast:function(t,u){const m=this.matrixWorld,g=this.count;if(Tc.geometry=this.geometry,Tc.material=this.material,void 0!==Tc.material)for(let E=0;E<g;E++){this.getMatrixAt(E,jp),hm.multiplyMatrices(m,jp),Tc.matrixWorld=hm,Tc.raycast(t,Md);for(let I=0,V=Md.length;I<V;I++){const J=Md[I];J.instanceId=E,J.object=this,u.push(J)}Md.length=0}},setMatrixAt:function(t,u){u.toArray(this.instanceMatrix.array,16*t)},updateMorphTargets:function(){}}),(Qn.prototype=Object.create(Ur.prototype)).constructor=Qn,Qn.prototype.isLineBasicMaterial=!0,Qn.prototype.copy=function(t){return Ur.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.morphTargets=t.morphTargets,this};const cn=new ot,Gp=new ot,Xo=new ti,Qc=new co,Nh=new zn;function Ni(t,u,m){1===m&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),er.call(this),this.type="Line",this.geometry=void 0!==t?t:new dn,this.material=void 0!==u?u:new Qn,this.updateMorphTargets()}Ni.prototype=Object.assign(Object.create(er.prototype),{constructor:Ni,isLine:!0,copy:function(t){return er.prototype.copy.call(this,t),this.material=t.material,this.geometry=t.geometry,this},computeLineDistances:function(){const t=this.geometry;if(t.isBufferGeometry)if(null===t.index){const u=t.attributes.position,m=[0];for(let g=1,E=u.count;g<E;g++)cn.fromBufferAttribute(u,g-1),Gp.fromBufferAttribute(u,g),m[g]=m[g-1],m[g]+=cn.distanceTo(Gp);t.setAttribute("lineDistance",new Fn(m,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry){const u=t.vertices,m=t.lineDistances;m[0]=0;for(let g=1,E=u.length;g<E;g++)m[g]=m[g-1],m[g]+=u[g-1].distanceTo(u[g])}return this},raycast:function(t,u){const m=this.geometry,g=this.matrixWorld,E=t.params.Line.threshold;if(null===m.boundingSphere&&m.computeBoundingSphere(),Nh.copy(m.boundingSphere),Nh.applyMatrix4(g),Nh.radius+=E,!1===t.ray.intersectsSphere(Nh))return;Xo.getInverse(g),Qc.copy(t.ray).applyMatrix4(Xo);const I=E/((this.scale.x+this.scale.y+this.scale.z)/3),V=I*I,J=new ot,Y=new ot,Z=new ot,me=new ot,S=this&&this.isLineSegments?2:1;if(m.isBufferGeometry){const e=m.index,c=m.attributes.position.array;if(null!==e){const p=e.array;for(let _=0,w=p.length-1;_<w;_+=S){const O=p[_+1];if(J.fromArray(c,3*p[_]),Y.fromArray(c,3*O),Qc.distanceSqToSegment(J,Y,me,Z)>V)continue;me.applyMatrix4(this.matrixWorld);const D=t.ray.origin.distanceTo(me);D<t.near||D>t.far||u.push({distance:D,point:Z.clone().applyMatrix4(this.matrixWorld),index:_,face:null,faceIndex:null,object:this})}}else for(let p=0,_=c.length/3-1;p<_;p+=S){if(J.fromArray(c,3*p),Y.fromArray(c,3*p+3),Qc.distanceSqToSegment(J,Y,me,Z)>V)continue;me.applyMatrix4(this.matrixWorld);const w=t.ray.origin.distanceTo(me);w<t.near||w>t.far||u.push({distance:w,point:Z.clone().applyMatrix4(this.matrixWorld),index:p,face:null,faceIndex:null,object:this})}}else if(m.isGeometry){const e=m.vertices,c=e.length;for(let p=0;p<c-1;p+=S){if(Qc.distanceSqToSegment(e[p],e[p+1],me,Z)>V)continue;me.applyMatrix4(this.matrixWorld);const _=t.ray.origin.distanceTo(me);_<t.near||_>t.far||u.push({distance:_,point:Z.clone().applyMatrix4(this.matrixWorld),index:p,face:null,faceIndex:null,object:this})}}},updateMorphTargets:function(){const t=this.geometry;if(t.isBufferGeometry){const u=t.morphAttributes,m=Object.keys(u);if(m.length>0){const g=u[m[0]];if(void 0!==g){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let E=0,I=g.length;E<I;E++){const V=g[E].name||String(E);this.morphTargetInfluences.push(0),this.morphTargetDictionary[V]=E}}}}else{const u=t.morphTargets;void 0!==u&&u.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});const Rl=new ot,ah=new ot;function Wi(t,u){Ni.call(this,t,u),this.type="LineSegments"}function Mc(t,u){Ni.call(this,t,u),this.type="LineLoop"}function ca(t){Ur.call(this),this.type="PointsMaterial",this.color=new lr(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(t)}Wi.prototype=Object.assign(Object.create(Ni.prototype),{constructor:Wi,isLineSegments:!0,computeLineDistances:function(){const t=this.geometry;if(t.isBufferGeometry)if(null===t.index){const u=t.attributes.position,m=[];for(let g=0,E=u.count;g<E;g+=2)Rl.fromBufferAttribute(u,g),ah.fromBufferAttribute(u,g+1),m[g]=0===g?0:m[g-1],m[g+1]=m[g]+Rl.distanceTo(ah);t.setAttribute("lineDistance",new Fn(m,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry){const u=t.vertices,m=t.lineDistances;for(let g=0,E=u.length;g<E;g+=2)Rl.copy(u[g]),ah.copy(u[g+1]),m[g]=0===g?0:m[g-1],m[g+1]=m[g]+Rl.distanceTo(ah)}return this}}),Mc.prototype=Object.assign(Object.create(Ni.prototype),{constructor:Mc,isLineLoop:!0}),(ca.prototype=Object.create(Ur.prototype)).constructor=ca,ca.prototype.isPointsMaterial=!0,ca.prototype.copy=function(t){return Ur.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.morphTargets=t.morphTargets,this};const od=new ti,Ga=new co,Hp=new zn,ef=new ot;function wo(t,u){er.call(this),this.type="Points",this.geometry=void 0!==t?t:new dn,this.material=void 0!==u?u:new ca,this.updateMorphTargets()}function Zl(t,u,m,g,E,I,V){const J=Ga.distanceSqToPoint(t);if(J<m){const Y=new ot;Ga.closestPointToPoint(t,Y),Y.applyMatrix4(g);const Z=E.ray.origin.distanceTo(Y);if(Z<E.near||Z>E.far)return;I.push({distance:Z,distanceToRay:Math.sqrt(J),point:Y,index:u,face:null,object:V})}}function Ha(t,u,m,g,E,I,V,J,Y){ui.call(this,t,u,m,g,E,I,V,J,Y),this.format=void 0!==V?V:Rs,this.minFilter=void 0!==I?I:ii,this.magFilter=void 0!==E?E:ii,this.generateMipmaps=!1;const Z=this;"requestVideoFrameCallback"in t&&t.requestVideoFrameCallback(function me(){Z.needsUpdate=!0,t.requestVideoFrameCallback(me)})}function sd(t,u,m,g,E,I,V,J,Y,Z,me,S){ui.call(this,null,I,V,J,Y,Z,g,E,me,S),this.image={width:u,height:m},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}function Cu(t,u,m,g,E,I,V,J,Y){ui.call(this,t,u,m,g,E,I,V,J,Y),this.needsUpdate=!0}function lh(t,u,m,g,E,I,V,J,Y,Z){if((Z=void 0!==Z?Z:To)!==To&&Z!==Ws)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===m&&Z===To&&(m=Ic),void 0===m&&Z===Ws&&(m=Es),ui.call(this,null,g,E,I,V,J,Z,m,Y),this.image={width:t,height:u},this.magFilter=void 0!==V?V:Or,this.minFilter=void 0!==J?J:Or,this.flipY=!1,this.generateMipmaps=!1}function Ql(t){dn.call(this),this.type="WireframeGeometry";const u=[],m=[0,0],g={},E=["a","b","c"];if(t&&t.isGeometry){const I=t.faces;for(let V=0,J=I.length;V<J;V++){const Y=I[V];for(let Z=0;Z<3;Z++){const me=Y[E[Z]],S=Y[E[(Z+1)%3]];m[0]=Math.min(me,S),m[1]=Math.max(me,S);const e=m[0]+","+m[1];void 0===g[e]&&(g[e]={index1:m[0],index2:m[1]})}}for(const V in g){const J=g[V];let Y=t.vertices[J.index1];u.push(Y.x,Y.y,Y.z),Y=t.vertices[J.index2],u.push(Y.x,Y.y,Y.z)}}else if(t&&t.isBufferGeometry){let I=new ot;if(null!==t.index){const V=t.attributes.position,J=t.index;let Y=t.groups;0===Y.length&&(Y=[{start:0,count:J.count,materialIndex:0}]);for(let Z=0,me=Y.length;Z<me;++Z){const S=Y[Z],e=S.start;for(let c=e,p=e+S.count;c<p;c+=3)for(let _=0;_<3;_++){const w=J.getX(c+_),L=J.getX(c+(_+1)%3);m[0]=Math.min(w,L),m[1]=Math.max(w,L);const O=m[0]+","+m[1];void 0===g[O]&&(g[O]={index1:m[0],index2:m[1]})}}for(const Z in g){const me=g[Z];I.fromBufferAttribute(V,me.index1),u.push(I.x,I.y,I.z),I.fromBufferAttribute(V,me.index2),u.push(I.x,I.y,I.z)}}else{const V=t.attributes.position;for(let J=0,Y=V.count/3;J<Y;J++)for(let Z=0;Z<3;Z++)I.fromBufferAttribute(V,3*J+Z),u.push(I.x,I.y,I.z),I.fromBufferAttribute(V,3*J+(Z+1)%3),u.push(I.x,I.y,I.z)}}this.setAttribute("position",new Fn(u,3))}function Kl(t,u,m){Fr.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:u,stacks:m},this.fromBufferGeometry(new Ac(t,u,m)),this.mergeVertices()}function Ac(t,u,m){dn.call(this),this.type="ParametricBufferGeometry",this.parameters={func:t,slices:u,stacks:m};const g=[],E=[],I=[],V=[],J=1e-5,Y=new ot,Z=new ot,me=new ot,S=new ot,e=new ot;t.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");const c=u+1;for(let p=0;p<=m;p++){const _=p/m;for(let w=0;w<=u;w++){const L=w/u;t(L,_,Z),E.push(Z.x,Z.y,Z.z),L-J>=0?(t(L-J,_,me),S.subVectors(Z,me)):(t(L+J,_,me),S.subVectors(me,Z)),_-J>=0?(t(L,_-J,me),e.subVectors(Z,me)):(t(L,_+J,me),e.subVectors(me,Z)),Y.crossVectors(S,e).normalize(),I.push(Y.x,Y.y,Y.z),V.push(L,_)}}for(let p=0;p<m;p++)for(let _=0;_<u;_++){const L=p*c+_+1,O=(p+1)*c+_+1,D=(p+1)*c+_;g.push(p*c+_,L,D),g.push(L,O,D)}this.setIndex(g),this.setAttribute("position",new Fn(E,3)),this.setAttribute("normal",new Fn(I,3)),this.setAttribute("uv",new Fn(V,2))}function ch(t,u,m,g){Fr.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:u,radius:m,detail:g},this.fromBufferGeometry(new Ma(t,u,m,g)),this.mergeVertices()}function Ma(t,u,m,g){dn.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:t,indices:u,radius:m,detail:g},m=m||1;const E=[],I=[];function V(e,c,p,_){const w=Math.pow(2,_),L=[];for(let O=0;O<=w;O++){L[O]=[];const D=e.clone().lerp(p,O/w),z=c.clone().lerp(p,O/w),Q=w-O;for(let ae=0;ae<=Q;ae++)L[O][ae]=0===ae&&O===w?D:D.clone().lerp(z,ae/Q)}for(let O=0;O<w;O++)for(let D=0;D<2*(w-O)-1;D++){const z=Math.floor(D/2);D%2==0?(J(L[O][z+1]),J(L[O+1][z]),J(L[O][z])):(J(L[O][z+1]),J(L[O+1][z+1]),J(L[O+1][z]))}}function J(e){E.push(e.x,e.y,e.z)}function Y(e,c){const p=3*e;c.x=t[p+0],c.y=t[p+1],c.z=t[p+2]}function Z(e,c,p,_){_<0&&1===e.x&&(I[c]=e.x-1),0===p.x&&0===p.z&&(I[c]=_/2/Math.PI+.5)}function me(e){return Math.atan2(e.z,-e.x)}function S(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}(function(e){const c=new ot,p=new ot,_=new ot;for(let w=0;w<u.length;w+=3)Y(u[w+0],c),Y(u[w+1],p),Y(u[w+2],_),V(c,p,_,e)})(g=g||0),function(e){const c=new ot;for(let p=0;p<E.length;p+=3)c.x=E[p+0],c.y=E[p+1],c.z=E[p+2],c.normalize().multiplyScalar(e),E[p+0]=c.x,E[p+1]=c.y,E[p+2]=c.z}(m),function(){const e=new ot;for(let c=0;c<E.length;c+=3){e.x=E[c+0],e.y=E[c+1],e.z=E[c+2];const p=me(e)/2/Math.PI+.5,_=S(e)/Math.PI+.5;I.push(p,1-_)}(function(){const c=new ot,p=new ot,_=new ot,w=new ot,L=new wn,O=new wn,D=new wn;for(let z=0,Q=0;z<E.length;z+=9,Q+=6){c.set(E[z+0],E[z+1],E[z+2]),p.set(E[z+3],E[z+4],E[z+5]),_.set(E[z+6],E[z+7],E[z+8]),L.set(I[Q+0],I[Q+1]),O.set(I[Q+2],I[Q+3]),D.set(I[Q+4],I[Q+5]),w.copy(c).add(p).add(_).divideScalar(3);const ae=me(w);Z(L,Q+0,c,ae),Z(O,Q+2,p,ae),Z(D,Q+4,_,ae)}})(),function(){for(let c=0;c<I.length;c+=6){const p=I[c+0],_=I[c+2],w=I[c+4],L=Math.max(p,_,w),O=Math.min(p,_,w);L>.9&&O<.1&&(p<.2&&(I[c+0]+=1),_<.2&&(I[c+2]+=1),w<.2&&(I[c+4]+=1))}}()}(),this.setAttribute("position",new Fn(E,3)),this.setAttribute("normal",new Fn(E.slice(),3)),this.setAttribute("uv",new Fn(I,2)),0===g?this.computeVertexNormals():this.normalizeNormals()}function Kc(t,u){Fr.call(this),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:u},this.fromBufferGeometry(new eu(t,u)),this.mergeVertices()}function eu(t,u){Ma.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,u),this.type="TetrahedronBufferGeometry",this.parameters={radius:t,detail:u}}function Rh(t,u){Fr.call(this),this.type="OctahedronGeometry",this.parameters={radius:t,detail:u},this.fromBufferGeometry(new uh(t,u)),this.mergeVertices()}function uh(t,u){Ma.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,u),this.type="OctahedronBufferGeometry",this.parameters={radius:t,detail:u}}function ua(t,u){Fr.call(this),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:u},this.fromBufferGeometry(new Aa(t,u)),this.mergeVertices()}function Aa(t,u){const m=(1+Math.sqrt(5))/2;Ma.call(this,[-1,m,0,1,m,0,-1,-m,0,1,-m,0,0,-1,m,0,1,m,0,-1,-m,0,1,-m,m,0,-1,m,0,1,-m,0,-1,-m,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,u),this.type="IcosahedronBufferGeometry",this.parameters={radius:t,detail:u}}function ks(t,u){Fr.call(this),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:u},this.fromBufferGeometry(new Fs(t,u)),this.mergeVertices()}function Fs(t,u){const m=(1+Math.sqrt(5))/2,g=1/m;Ma.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-g,-m,0,-g,m,0,g,-m,0,g,m,-g,-m,0,-g,m,0,g,-m,0,g,m,0,-m,0,-g,m,0,-g,-m,0,g,m,0,g],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,u),this.type="DodecahedronBufferGeometry",this.parameters={radius:t,detail:u}}function tu(t,u,m,g,E,I){Fr.call(this),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:u,radius:m,radialSegments:g,closed:E},void 0!==I&&console.warn("THREE.TubeGeometry: taper has been removed.");const V=new ec(t,u,m,g,E);this.tangents=V.tangents,this.normals=V.normals,this.binormals=V.binormals,this.fromBufferGeometry(V),this.mergeVertices()}function ec(t,u,m,g,E){dn.call(this),this.type="TubeBufferGeometry",this.parameters={path:t,tubularSegments:u,radius:m,radialSegments:g,closed:E},m=m||1,g=g||8;const I=t.computeFrenetFrames(u=u||64,E=E||!1);this.tangents=I.tangents,this.normals=I.normals,this.binormals=I.binormals;const V=new ot,J=new ot,Y=new wn;let Z=new ot;const me=[],S=[],e=[],c=[];function p(_){Z=t.getPointAt(_/u,Z);const w=I.normals[_],L=I.binormals[_];for(let O=0;O<=g;O++){const D=O/g*Math.PI*2,z=Math.sin(D),Q=-Math.cos(D);J.x=Q*w.x+z*L.x,J.y=Q*w.y+z*L.y,J.z=Q*w.z+z*L.z,J.normalize(),S.push(J.x,J.y,J.z),V.x=Z.x+m*J.x,V.y=Z.y+m*J.y,V.z=Z.z+m*J.z,me.push(V.x,V.y,V.z)}}(function(){for(let _=0;_<u;_++)p(_);p(!1===E?u:0),function(){for(let _=0;_<=u;_++)for(let w=0;w<=g;w++)Y.x=_/u,Y.y=w/g,e.push(Y.x,Y.y)}(),function(){for(let _=1;_<=u;_++)for(let w=1;w<=g;w++){const O=(g+1)*_+(w-1),D=(g+1)*_+w,z=(g+1)*(_-1)+w;c.push((g+1)*(_-1)+(w-1),O,z),c.push(O,D,z)}}()})(),this.setIndex(c),this.setAttribute("position",new Fn(me,3)),this.setAttribute("normal",new Fn(S,3)),this.setAttribute("uv",new Fn(e,2))}function Va(t,u,m,g,E,I,V){Fr.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:u,tubularSegments:m,radialSegments:g,p:E,q:I},void 0!==V&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new Pl(t,u,m,g,E,I)),this.mergeVertices()}function Pl(t,u,m,g,E,I){dn.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:u,tubularSegments:m,radialSegments:g,p:E,q:I},t=t||1,u=u||.4,m=Math.floor(m)||64,g=Math.floor(g)||8,E=E||2,I=I||3;const V=[],J=[],Y=[],Z=[],me=new ot,S=new ot,e=new ot,c=new ot,p=new ot,_=new ot,w=new ot;for(let O=0;O<=m;++O){const D=O/m*E*Math.PI*2;L(D,E,I,t,e),L(D+.01,E,I,t,c),_.subVectors(c,e),w.addVectors(c,e),p.crossVectors(_,w),w.crossVectors(p,_),p.normalize(),w.normalize();for(let z=0;z<=g;++z){const Q=z/g*Math.PI*2,ae=-u*Math.cos(Q),ie=u*Math.sin(Q);me.x=e.x+(ae*w.x+ie*p.x),me.y=e.y+(ae*w.y+ie*p.y),me.z=e.z+(ae*w.z+ie*p.z),J.push(me.x,me.y,me.z),S.subVectors(me,e).normalize(),Y.push(S.x,S.y,S.z),Z.push(O/m),Z.push(z/g)}}for(let O=1;O<=m;O++)for(let D=1;D<=g;D++){const Q=(g+1)*O+(D-1),ae=(g+1)*O+D,ie=(g+1)*(O-1)+D;V.push((g+1)*(O-1)+(D-1),Q,ie),V.push(Q,ae,ie)}function L(O,D,z,Q,ae){const ie=Math.cos(O),he=Math.sin(O),ye=z/D*O,Me=Math.cos(ye);ae.x=Q*(2+Me)*.5*ie,ae.y=Q*(2+Me)*he*.5,ae.z=Q*Math.sin(ye)*.5}this.setIndex(V),this.setAttribute("position",new Fn(J,3)),this.setAttribute("normal",new Fn(Y,3)),this.setAttribute("uv",new Fn(Z,2))}function Ao(t,u,m,g,E){Fr.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:u,radialSegments:m,tubularSegments:g,arc:E},this.fromBufferGeometry(new Vp(t,u,m,g,E)),this.mergeVertices()}function Vp(t,u,m,g,E){dn.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:u,radialSegments:m,tubularSegments:g,arc:E},t=t||1,u=u||.4,m=Math.floor(m)||8,g=Math.floor(g)||6,E=E||2*Math.PI;const I=[],V=[],J=[],Y=[],Z=new ot,me=new ot,S=new ot;for(let e=0;e<=m;e++)for(let c=0;c<=g;c++){const p=c/g*E,_=e/m*Math.PI*2;me.x=(t+u*Math.cos(_))*Math.cos(p),me.y=(t+u*Math.cos(_))*Math.sin(p),me.z=u*Math.sin(_),V.push(me.x,me.y,me.z),Z.x=t*Math.cos(p),Z.y=t*Math.sin(p),S.subVectors(me,Z).normalize(),J.push(S.x,S.y,S.z),Y.push(c/g),Y.push(e/m)}for(let e=1;e<=m;e++)for(let c=1;c<=g;c++){const _=(g+1)*(e-1)+c-1,w=(g+1)*(e-1)+c,L=(g+1)*e+c;I.push((g+1)*e+c-1,_,L),I.push(_,w,L)}this.setIndex(I),this.setAttribute("position",new Fn(V,3)),this.setAttribute("normal",new Fn(J,3)),this.setAttribute("uv",new Fn(Y,2))}function $d(t,u,m,g,E){let I,V;if(E===function(J,Y,Z,me){let S=0;for(let e=Y,c=Z-me;e<Z;e+=me)S+=(J[c]-J[e])*(J[e+1]+J[c+1]),c=e;return S}(t,u,m,g)>0)for(I=u;I<m;I+=g)V=iu(I,t[I],t[I+1],V);else for(I=m-g;I>=u;I-=g)V=iu(I,t[I],t[I+1],V);return V&&Ai(V,V.next)&&(Ds(V),V=V.next),V}function nu(t,u){if(!t)return t;u||(u=t);let m,g=t;do{if(m=!1,g.steiner||!Ai(g,g.next)&&0!==Co(g.prev,g,g.next))g=g.next;else{if(Ds(g),g=u=g.prev,g===g.next)break;m=!0}}while(m||g!==u);return u}function Ph(t,u,m,g,E,I,V){if(!t)return;!V&&I&&function(me,S,e,c){let p=me;do{null===p.z&&(p.z=$o(p.x,p.y,S,e,c)),p.prevZ=p.prev,p.nextZ=p.next,p=p.next}while(p!==me);p.prevZ.nextZ=null,p.prevZ=null,function(_){let w,L,O,D,z,Q,ae,ie,he=1;do{for(L=_,_=null,z=null,Q=0;L;){for(Q++,O=L,ae=0,w=0;w<he&&(ae++,O=O.nextZ,O);w++);for(ie=he;ae>0||ie>0&&O;)0!==ae&&(0===ie||!O||L.z<=O.z)?(D=L,L=L.nextZ,ae--):(D=O,O=O.nextZ,ie--),z?z.nextZ=D:_=D,D.prevZ=z,z=D;L=O}z.nextZ=null,he*=2}while(Q>1)}(p)}(t,g,E,I);let J,Y,Z=t;for(;t.prev!==t.next;)if(J=t.prev,Y=t.next,I?Yo(t,g,E,I):ji(t))u.push(J.i/m),u.push(t.i/m),u.push(Y.i/m),Ds(t),t=Y.next,Z=Y.next;else if((t=Y)===Z){V?1===V?Ph(t=ru(nu(t),u,m),u,m,g,E,I,2):2===V&&Ut(t,u,m,g,E,I):Ph(nu(t),u,m,g,E,I,1);break}}function ji(t){let u=t.prev,m=t,g=t.next;if(Co(u,m,g)>=0)return!1;let E=t.next.next;for(;E!==t.prev;){if(Fo(u.x,u.y,m.x,m.y,g.x,g.y,E.x,E.y)&&Co(E.prev,E,E.next)>=0)return!1;E=E.next}return!0}function Yo(t,u,m,g){let E=t.prev,I=t,V=t.next;if(Co(E,I,V)>=0)return!1;let Z=E.x>I.x?E.x>V.x?E.x:V.x:I.x>V.x?I.x:V.x,me=E.y>I.y?E.y>V.y?E.y:V.y:I.y>V.y?I.y:V.y,S=$o(E.x<I.x?E.x<V.x?E.x:V.x:I.x<V.x?I.x:V.x,E.y<I.y?E.y<V.y?E.y:V.y:I.y<V.y?I.y:V.y,u,m,g),e=$o(Z,me,u,m,g),c=t.prevZ,p=t.nextZ;for(;c&&c.z>=S&&p&&p.z<=e;){if(c!==t.prev&&c!==t.next&&Fo(E.x,E.y,I.x,I.y,V.x,V.y,c.x,c.y)&&Co(c.prev,c,c.next)>=0||(c=c.prevZ,p!==t.prev&&p!==t.next&&Fo(E.x,E.y,I.x,I.y,V.x,V.y,p.x,p.y)&&Co(p.prev,p,p.next)>=0))return!1;p=p.nextZ}for(;c&&c.z>=S;){if(c!==t.prev&&c!==t.next&&Fo(E.x,E.y,I.x,I.y,V.x,V.y,c.x,c.y)&&Co(c.prev,c,c.next)>=0)return!1;c=c.prevZ}for(;p&&p.z<=e;){if(p!==t.prev&&p!==t.next&&Fo(E.x,E.y,I.x,I.y,V.x,V.y,p.x,p.y)&&Co(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function ru(t,u,m){let g=t;do{let E=g.prev,I=g.next.next;!Ai(E,I)&&cs(E,g,g.next,I)&&Qr(E,I)&&Qr(I,E)&&(u.push(E.i/m),u.push(g.i/m),u.push(I.i/m),Ds(g),Ds(g.next),g=t=I),g=g.next}while(g!==t);return nu(g)}function Ut(t,u,m,g,E,I){let V=t;do{let J=V.next.next;for(;J!==V.prev;){if(V.i!==J.i&&tf(V,J)){let Y=bs(V,J);return V=nu(V,V.next),Y=nu(Y,Y.next),Ph(V,u,m,g,E,I),void Ph(Y,u,m,g,E,I)}J=J.next}V=V.next}while(V!==t)}function sp(t,u){return t.x-u.x}function Ri(t,u){if(u=function(m,g){let E,I=g,V=m.x,J=m.y,Y=-1/0;do{if(J<=I.y&&J>=I.next.y&&I.next.y!==I.y){let p=I.x+(J-I.y)*(I.next.x-I.x)/(I.next.y-I.y);if(p<=V&&p>Y){if(Y=p,p===V){if(J===I.y)return I;if(J===I.next.y)return I.next}E=I.x<I.next.x?I:I.next}}I=I.next}while(I!==g);if(!E)return null;if(V===Y)return E;let Z,me=E,S=E.x,e=E.y,c=1/0;I=E;do{V>=I.x&&I.x>=S&&V!==I.x&&Fo(J<e?V:Y,J,S,e,J<e?Y:V,J,I.x,I.y)&&(Z=Math.abs(J-I.y)/(V-I.x),Qr(I,m)&&(Z<c||Z===c&&(I.x>E.x||I.x===E.x&&Oo(E,I)))&&(E=I,c=Z)),I=I.next}while(I!==me);return E}(t,u)){const m=bs(u,t);nu(u,u.next),nu(m,m.next)}}function Oo(t,u){return Co(t.prev,t,u.prev)<0&&Co(u.next,t,t.next)<0}function $o(t,u,m,g,E){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-m)*E)|t<<8))|t<<4))|t<<2))|t<<1))|(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=32767*(u-g)*E)|u<<8))|u<<4))|u<<2))|u<<1))<<1}function ko(t){let u=t,m=t;do{(u.x<m.x||u.x===m.x&&u.y<m.y)&&(m=u),u=u.next}while(u!==t);return m}function Fo(t,u,m,g,E,I,V,J){return(E-V)*(u-J)-(t-V)*(I-J)>=0&&(t-V)*(g-J)-(m-V)*(u-J)>=0&&(m-V)*(I-J)-(E-V)*(g-J)>=0}function tf(t,u){return t.next.i!==u.i&&t.prev.i!==u.i&&!function(m,g){let E=m;do{if(E.i!==m.i&&E.next.i!==m.i&&E.i!==g.i&&E.next.i!==g.i&&cs(E,E.next,m,g))return!0;E=E.next}while(E!==m);return!1}(t,u)&&(Qr(t,u)&&Qr(u,t)&&function(m,g){let E=m,I=!1,V=(m.x+g.x)/2,J=(m.y+g.y)/2;do{E.y>J!=E.next.y>J&&E.next.y!==E.y&&V<(E.next.x-E.x)*(J-E.y)/(E.next.y-E.y)+E.x&&(I=!I),E=E.next}while(E!==m);return I}(t,u)&&(Co(t.prev,t,u.prev)||Co(t,u.prev,u))||Ai(t,u)&&Co(t.prev,t,t.next)>0&&Co(u.prev,u,u.next)>0)}function Co(t,u,m){return(u.y-t.y)*(m.x-u.x)-(u.x-t.x)*(m.y-u.y)}function Ai(t,u){return t.x===u.x&&t.y===u.y}function cs(t,u,m,g){const E=Lo(Co(t,u,m)),I=Lo(Co(t,u,g)),V=Lo(Co(m,g,t)),J=Lo(Co(m,g,u));return E!==I&&V!==J||!(0!==E||!mi(t,m,u))||!(0!==I||!mi(t,g,u))||!(0!==V||!mi(m,t,g))||!(0!==J||!mi(m,u,g))}function mi(t,u,m){return u.x<=Math.max(t.x,m.x)&&u.x>=Math.min(t.x,m.x)&&u.y<=Math.max(t.y,m.y)&&u.y>=Math.min(t.y,m.y)}function Lo(t){return t>0?1:t<0?-1:0}function Qr(t,u){return Co(t.prev,t,t.next)<0?Co(t,u,t.next)>=0&&Co(t,t.prev,u)>=0:Co(t,u,t.prev)<0||Co(t,t.next,u)<0}function bs(t,u){let m=new _f(t.i,t.x,t.y),g=new _f(u.i,u.x,u.y),E=t.next,I=u.prev;return t.next=u,u.prev=t,m.next=E,E.prev=m,g.next=m,m.prev=g,I.next=g,g.prev=I,g}function iu(t,u,m,g){const E=new _f(t,u,m);return g?(E.next=g.next,E.prev=g,g.next.prev=E,g.next=E):(E.prev=E,E.next=E),E}function Ds(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function _f(t,u,m){this.i=t,this.x=u,this.y=m,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}wo.prototype=Object.assign(Object.create(er.prototype),{constructor:wo,isPoints:!0,copy:function(t){return er.prototype.copy.call(this,t),this.material=t.material,this.geometry=t.geometry,this},raycast:function(t,u){const m=this.geometry,g=this.matrixWorld,E=t.params.Points.threshold;if(null===m.boundingSphere&&m.computeBoundingSphere(),Hp.copy(m.boundingSphere),Hp.applyMatrix4(g),Hp.radius+=E,!1===t.ray.intersectsSphere(Hp))return;od.getInverse(g),Ga.copy(t.ray).applyMatrix4(od);const I=E/((this.scale.x+this.scale.y+this.scale.z)/3),V=I*I;if(m.isBufferGeometry){const J=m.index,Y=m.attributes.position.array;if(null!==J){const Z=J.array;for(let me=0,S=Z.length;me<S;me++){const e=Z[me];ef.fromArray(Y,3*e),Zl(ef,e,V,g,t,u,this)}}else for(let Z=0,me=Y.length/3;Z<me;Z++)ef.fromArray(Y,3*Z),Zl(ef,Z,V,g,t,u,this)}else{const J=m.vertices;for(let Y=0,Z=J.length;Y<Z;Y++)Zl(J[Y],Y,V,g,t,u,this)}},updateMorphTargets:function(){const t=this.geometry;if(t.isBufferGeometry){const u=t.morphAttributes,m=Object.keys(u);if(m.length>0){const g=u[m[0]];if(void 0!==g){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let E=0,I=g.length;E<I;E++){const V=g[E].name||String(E);this.morphTargetInfluences.push(0),this.morphTargetDictionary[V]=E}}}}else{const u=t.morphTargets;void 0!==u&&u.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}),Ha.prototype=Object.assign(Object.create(ui.prototype),{constructor:Ha,isVideoTexture:!0,update:function(){const t=this.image;!("requestVideoFrameCallback"in t)&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),(sd.prototype=Object.create(ui.prototype)).constructor=sd,sd.prototype.isCompressedTexture=!0,(Cu.prototype=Object.create(ui.prototype)).constructor=Cu,Cu.prototype.isCanvasTexture=!0,(lh.prototype=Object.create(ui.prototype)).constructor=lh,lh.prototype.isDepthTexture=!0,(Ql.prototype=Object.create(dn.prototype)).constructor=Ql,(Kl.prototype=Object.create(Fr.prototype)).constructor=Kl,(Ac.prototype=Object.create(dn.prototype)).constructor=Ac,(ch.prototype=Object.create(Fr.prototype)).constructor=ch,(Ma.prototype=Object.create(dn.prototype)).constructor=Ma,(Kc.prototype=Object.create(Fr.prototype)).constructor=Kc,(eu.prototype=Object.create(Ma.prototype)).constructor=eu,(Rh.prototype=Object.create(Fr.prototype)).constructor=Rh,(uh.prototype=Object.create(Ma.prototype)).constructor=uh,(ua.prototype=Object.create(Fr.prototype)).constructor=ua,(Aa.prototype=Object.create(Ma.prototype)).constructor=Aa,(ks.prototype=Object.create(Fr.prototype)).constructor=ks,(Fs.prototype=Object.create(Ma.prototype)).constructor=Fs,(tu.prototype=Object.create(Fr.prototype)).constructor=tu,(ec.prototype=Object.create(dn.prototype)).constructor=ec,ec.prototype.toJSON=function(){const t=dn.prototype.toJSON.call(this);return t.path=this.parameters.path.toJSON(),t},(Va.prototype=Object.create(Fr.prototype)).constructor=Va,(Pl.prototype=Object.create(dn.prototype)).constructor=Pl,(Ao.prototype=Object.create(Fr.prototype)).constructor=Ao,(Vp.prototype=Object.create(dn.prototype)).constructor=Vp;const $c={area:function(t){const u=t.length;let m=0;for(let g=u-1,E=0;E<u;g=E++)m+=t[g].x*t[E].y-t[E].x*t[g].y;return.5*m},isClockWise:function(t){return $c.area(t)<0},triangulateShape:function(t,u){const m=[],g=[],E=[];Wp(t),Ih(m,t);let I=t.length;u.forEach(Wp);for(let J=0;J<u.length;J++)g.push(I),I+=u[J].length,Ih(m,u[J]);const V=function(J,Y,Z){Z=Z||2;let me,S,e,c,p,_,w,L=Y&&Y.length,O=L?Y[0]*Z:J.length,D=$d(J,0,O,Z,!0),z=[];if(!D||D.next===D.prev)return z;if(L&&(D=function(Q,ae,ie,he){let ye,Me,Ne,$e,ze,Ye=[];for(ye=0,Me=ae.length;ye<Me;ye++)Ne=ae[ye]*he,$e=ye<Me-1?ae[ye+1]*he:Q.length,ze=$d(Q,Ne,$e,he,!1),ze===ze.next&&(ze.steiner=!0),Ye.push(ko(ze));for(Ye.sort(sp),ye=0;ye<Ye.length;ye++)Ri(Ye[ye],ie),ie=nu(ie,ie.next);return ie}(J,Y,D,Z)),J.length>80*Z){me=e=J[0],S=c=J[1];for(let Q=Z;Q<O;Q+=Z)p=J[Q],_=J[Q+1],p<me&&(me=p),_<S&&(S=_),p>e&&(e=p),_>c&&(c=_);w=Math.max(e-me,c-S),w=0!==w?1/w:0}return Ph(D,z,Z,me,S,w),z}(m,g);for(let J=0;J<V.length;J+=3)E.push(V.slice(J,J+3));return E}};function Wp(t){const u=t.length;u>2&&t[u-1].equals(t[0])&&t.pop()}function Ih(t,u){for(let m=0;m<u.length;m++)t.push(u[m].x),t.push(u[m].y)}function Cc(t,u){Fr.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:u},this.fromBufferGeometry(new ha(t,u)),this.mergeVertices()}function ha(t,u){dn.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:t,options:u},t=Array.isArray(t)?t:[t];const m=this,g=[],E=[];for(let V=0,J=t.length;V<J;V++)I(t[V]);function I(V){const J=[],Y=void 0!==u.curveSegments?u.curveSegments:12,Z=void 0!==u.steps?u.steps:1;let me=void 0!==u.depth?u.depth:100,S=void 0===u.bevelEnabled||u.bevelEnabled,e=void 0!==u.bevelThickness?u.bevelThickness:6,c=void 0!==u.bevelSize?u.bevelSize:e-2,p=void 0!==u.bevelOffset?u.bevelOffset:0,_=void 0!==u.bevelSegments?u.bevelSegments:3;const w=u.extrudePath,L=void 0!==u.UVGenerator?u.UVGenerator:ad;void 0!==u.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),me=u.amount);let O,D,z,Q,ae,ie=!1;w&&(O=w.getSpacedPoints(Z),ie=!0,S=!1,D=w.computeFrenetFrames(Z,!1),z=new ot,Q=new ot,ae=new ot),S||(_=0,e=0,c=0,p=0);const he=V.extractPoints(Y);let ye=he.shape;const Me=he.holes;if(!$c.isClockWise(ye)){ye=ye.reverse();for(let St=0,jt=Me.length;St<jt;St++){const It=Me[St];$c.isClockWise(It)&&(Me[St]=It.reverse())}}const Ne=$c.triangulateShape(ye,Me),$e=ye;for(let St=0,jt=Me.length;St<jt;St++)ye=ye.concat(Me[St]);function ze(St,jt,It){return jt||console.error("THREE.ExtrudeGeometry: vec does not exist"),jt.clone().multiplyScalar(It).add(St)}const Ye=ye.length,We=Ne.length;function nt(St,jt,It){let an,Ze,st;const Rt=St.x-jt.x,Gt=St.y-jt.y,tn=It.x-St.x,En=It.y-St.y,Zn=Rt*Rt+Gt*Gt;if(Math.abs(Rt*En-Gt*tn)>Number.EPSILON){const on=Math.sqrt(Zn),dt=Math.sqrt(tn*tn+En*En),sn=jt.x-Gt/on,Sn=jt.y+Rt/on,hn=((It.x-En/dt-sn)*En-(It.y+tn/dt-Sn)*tn)/(Rt*En-Gt*tn);an=sn+Rt*hn-St.x,Ze=Sn+Gt*hn-St.y;const Wt=an*an+Ze*Ze;if(Wt<=2)return new wn(an,Ze);st=Math.sqrt(Wt/2)}else{let on=!1;Rt>Number.EPSILON?tn>Number.EPSILON&&(on=!0):Rt<-Number.EPSILON?tn<-Number.EPSILON&&(on=!0):Math.sign(Gt)===Math.sign(En)&&(on=!0),on?(an=-Gt,Ze=Rt,st=Math.sqrt(Zn)):(an=Rt,Ze=Gt,st=Math.sqrt(Zn/2))}return new wn(an/st,Ze/st)}const it=[];for(let St=0,jt=$e.length,It=jt-1,an=St+1;St<jt;St++,It++,an++)It===jt&&(It=0),an===jt&&(an=0),it[St]=nt($e[St],$e[It],$e[an]);const mt=[];let xt,Dt=it.concat();for(let St=0,jt=Me.length;St<jt;St++){const It=Me[St];xt=[];for(let an=0,Ze=It.length,st=Ze-1,Rt=an+1;an<Ze;an++,st++,Rt++)st===Ze&&(st=0),Rt===Ze&&(Rt=0),xt[an]=nt(It[an],It[st],It[Rt]);mt.push(xt),Dt=Dt.concat(xt)}for(let St=0;St<_;St++){const jt=St/_,It=e*Math.cos(jt*Math.PI/2),an=c*Math.sin(jt*Math.PI/2)+p;for(let Ze=0,st=$e.length;Ze<st;Ze++){const Rt=ze($e[Ze],it[Ze],an);pt(Rt.x,Rt.y,-It)}for(let Ze=0,st=Me.length;Ze<st;Ze++){const Rt=Me[Ze];xt=mt[Ze];for(let Gt=0,tn=Rt.length;Gt<tn;Gt++){const En=ze(Rt[Gt],xt[Gt],an);pt(En.x,En.y,-It)}}}const Ht=c+p;for(let St=0;St<Ye;St++){const jt=S?ze(ye[St],Dt[St],Ht):ye[St];ie?(Q.copy(D.normals[0]).multiplyScalar(jt.x),z.copy(D.binormals[0]).multiplyScalar(jt.y),ae.copy(O[0]).add(Q).add(z),pt(ae.x,ae.y,ae.z)):pt(jt.x,jt.y,0)}for(let St=1;St<=Z;St++)for(let jt=0;jt<Ye;jt++){const It=S?ze(ye[jt],Dt[jt],Ht):ye[jt];ie?(Q.copy(D.normals[St]).multiplyScalar(It.x),z.copy(D.binormals[St]).multiplyScalar(It.y),ae.copy(O[St]).add(Q).add(z),pt(ae.x,ae.y,ae.z)):pt(It.x,It.y,me/Z*St)}for(let St=_-1;St>=0;St--){const jt=St/_,It=e*Math.cos(jt*Math.PI/2),an=c*Math.sin(jt*Math.PI/2)+p;for(let Ze=0,st=$e.length;Ze<st;Ze++){const Rt=ze($e[Ze],it[Ze],an);pt(Rt.x,Rt.y,me+It)}for(let Ze=0,st=Me.length;Ze<st;Ze++){const Rt=Me[Ze];xt=mt[Ze];for(let Gt=0,tn=Rt.length;Gt<tn;Gt++){const En=ze(Rt[Gt],xt[Gt],an);ie?pt(En.x,En.y+O[Z-1].y,O[Z-1].x+It):pt(En.x,En.y,me+It)}}}function Je(St,jt){let It=St.length;for(;--It>=0;){const an=It;let Ze=It-1;Ze<0&&(Ze=St.length-1);for(let st=0,Rt=Z+2*_;st<Rt;st++){const Gt=Ye*st,tn=Ye*(st+1);Nt(jt+an+Gt,jt+Ze+Gt,jt+Ze+tn,jt+an+tn)}}}function pt(St,jt,It){J.push(St),J.push(jt),J.push(It)}function Vt(St,jt,It){ct(St),ct(jt),ct(It);const an=g.length/3,Ze=L.generateTopUV(m,g,an-3,an-2,an-1);Yt(Ze[0]),Yt(Ze[1]),Yt(Ze[2])}function Nt(St,jt,It,an){ct(St),ct(jt),ct(an),ct(jt),ct(It),ct(an);const Ze=g.length/3,st=L.generateSideWallUV(m,g,Ze-6,Ze-3,Ze-2,Ze-1);Yt(st[0]),Yt(st[1]),Yt(st[3]),Yt(st[1]),Yt(st[2]),Yt(st[3])}function ct(St){g.push(J[3*St+0]),g.push(J[3*St+1]),g.push(J[3*St+2])}function Yt(St){E.push(St.x),E.push(St.y)}(function(){const St=g.length/3;if(S){let jt=0,It=Ye*jt;for(let an=0;an<We;an++){const Ze=Ne[an];Vt(Ze[2]+It,Ze[1]+It,Ze[0]+It)}jt=Z+2*_,It=Ye*jt;for(let an=0;an<We;an++){const Ze=Ne[an];Vt(Ze[0]+It,Ze[1]+It,Ze[2]+It)}}else{for(let jt=0;jt<We;jt++){const It=Ne[jt];Vt(It[2],It[1],It[0])}for(let jt=0;jt<We;jt++){const It=Ne[jt];Vt(It[0]+Ye*Z,It[1]+Ye*Z,It[2]+Ye*Z)}}m.addGroup(St,g.length/3-St,0)})(),function(){const St=g.length/3;let jt=0;Je($e,jt),jt+=$e.length;for(let It=0,an=Me.length;It<an;It++){const Ze=Me[It];Je(Ze,jt),jt+=Ze.length}m.addGroup(St,g.length/3-St,1)}()}this.setAttribute("position",new Fn(g,3)),this.setAttribute("uv",new Fn(E,2)),this.computeVertexNormals()}(Cc.prototype=Object.create(Fr.prototype)).constructor=Cc,Cc.prototype.toJSON=function(){const t=Fr.prototype.toJSON.call(this);return Cd(this.parameters.shapes,this.parameters.options,t)},(ha.prototype=Object.create(dn.prototype)).constructor=ha,ha.prototype.toJSON=function(){const t=dn.prototype.toJSON.call(this);return Cd(this.parameters.shapes,this.parameters.options,t)};const ad={generateTopUV:function(t,u,m,g,E){const J=u[3*g],Y=u[3*g+1],Z=u[3*E],me=u[3*E+1];return[new wn(u[3*m],u[3*m+1]),new wn(J,Y),new wn(Z,me)]},generateSideWallUV:function(t,u,m,g,E,I){const V=u[3*m],J=u[3*m+1],Y=u[3*m+2],Z=u[3*g],me=u[3*g+1],S=u[3*g+2],e=u[3*E],c=u[3*E+1],p=u[3*E+2],_=u[3*I],w=u[3*I+1],L=u[3*I+2];return Math.abs(J-me)<.01?[new wn(V,1-Y),new wn(Z,1-S),new wn(e,1-p),new wn(_,1-L)]:[new wn(J,1-Y),new wn(me,1-S),new wn(c,1-p),new wn(w,1-L)]}};function Cd(t,u,m){if(m.shapes=[],Array.isArray(t))for(let g=0,E=t.length;g<E;g++)m.shapes.push(t[g].uuid);else m.shapes.push(t.uuid);return void 0!==u.extrudePath&&(m.options.extrudePath=u.extrudePath.toJSON()),m}function Oh(t,u){Fr.call(this),this.type="TextGeometry",this.parameters={text:t,parameters:u},this.fromBufferGeometry(new ho(t,u)),this.mergeVertices()}function ho(t,u){const m=(u=u||{}).font;if(!m||!m.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new Fr;const g=m.generateShapes(t,u.size);u.depth=void 0!==u.height?u.height:50,void 0===u.bevelThickness&&(u.bevelThickness=10),void 0===u.bevelSize&&(u.bevelSize=8),void 0===u.bevelEnabled&&(u.bevelEnabled=!1),ha.call(this,g,u),this.type="TextBufferGeometry"}function Cr(t,u,m,g,E,I,V){Fr.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:u,heightSegments:m,phiStart:g,phiLength:E,thetaStart:I,thetaLength:V},this.fromBufferGeometry(new Hr(t,u,m,g,E,I,V)),this.mergeVertices()}function Hr(t,u,m,g,E,I,V){dn.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:u,heightSegments:m,phiStart:g,phiLength:E,thetaStart:I,thetaLength:V},t=t||1,u=Math.max(3,Math.floor(u)||8),m=Math.max(2,Math.floor(m)||6),g=void 0!==g?g:0,E=void 0!==E?E:2*Math.PI,I=void 0!==I?I:0,V=void 0!==V?V:Math.PI;const J=Math.min(I+V,Math.PI);let Y=0;const Z=[],me=new ot,S=new ot,e=[],c=[],p=[],_=[];for(let w=0;w<=m;w++){const L=[],O=w/m;let D=0;0==w&&0==I?D=.5/u:w==m&&J==Math.PI&&(D=-.5/u);for(let z=0;z<=u;z++){const Q=z/u;me.x=-t*Math.cos(g+Q*E)*Math.sin(I+O*V),me.y=t*Math.cos(I+O*V),me.z=t*Math.sin(g+Q*E)*Math.sin(I+O*V),c.push(me.x,me.y,me.z),S.copy(me).normalize(),p.push(S.x,S.y,S.z),_.push(Q+D,1-O),L.push(Y++)}Z.push(L)}for(let w=0;w<m;w++)for(let L=0;L<u;L++){const D=Z[w][L],z=Z[w+1][L],Q=Z[w+1][L+1];(0!==w||I>0)&&e.push(Z[w][L+1],D,Q),(w!==m-1||J<Math.PI)&&e.push(D,z,Q)}this.setIndex(e),this.setAttribute("position",new Fn(c,3)),this.setAttribute("normal",new Fn(p,3)),this.setAttribute("uv",new Fn(_,2))}function pa(t,u,m,g,E,I){Fr.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:u,thetaSegments:m,phiSegments:g,thetaStart:E,thetaLength:I},this.fromBufferGeometry(new Lc(t,u,m,g,E,I)),this.mergeVertices()}function Lc(t,u,m,g,E,I){dn.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:u,thetaSegments:m,phiSegments:g,thetaStart:E,thetaLength:I},t=t||.5,u=u||1,E=void 0!==E?E:0,I=void 0!==I?I:2*Math.PI,m=void 0!==m?Math.max(3,m):8;const V=[],J=[],Y=[],Z=[];let me=t;const S=(u-t)/(g=void 0!==g?Math.max(1,g):1),e=new ot,c=new wn;for(let p=0;p<=g;p++){for(let _=0;_<=m;_++){const w=E+_/m*I;e.x=me*Math.cos(w),e.y=me*Math.sin(w),J.push(e.x,e.y,e.z),Y.push(0,0,1),c.x=(e.x/u+1)/2,c.y=(e.y/u+1)/2,Z.push(c.x,c.y)}me+=S}for(let p=0;p<g;p++){const _=p*(m+1);for(let w=0;w<m;w++){const L=w+_,D=L+m+1,z=L+m+2,Q=L+1;V.push(L,D,Q),V.push(D,z,Q)}}this.setIndex(V),this.setAttribute("position",new Fn(J,3)),this.setAttribute("normal",new Fn(Y,3)),this.setAttribute("uv",new Fn(Z,2))}function Lu(t,u,m,g){Fr.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:u,phiStart:m,phiLength:g},this.fromBufferGeometry(new kh(t,u,m,g)),this.mergeVertices()}function kh(t,u,m,g){dn.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:u,phiStart:m,phiLength:g},u=Math.floor(u)||12,m=m||0,g=g||2*Math.PI,g=rr.clamp(g,0,2*Math.PI);const E=[],I=[],V=[],J=1/u,Y=new ot,Z=new wn;for(let me=0;me<=u;me++){const S=m+me*J*g,e=Math.sin(S),c=Math.cos(S);for(let p=0;p<=t.length-1;p++)Y.x=t[p].x*e,Y.y=t[p].y,Y.z=t[p].x*c,I.push(Y.x,Y.y,Y.z),Z.x=me/u,Z.y=p/(t.length-1),V.push(Z.x,Z.y)}for(let me=0;me<u;me++)for(let S=0;S<t.length-1;S++){const e=S+me*t.length,p=e+t.length,_=e+t.length+1,w=e+1;E.push(e,p,w),E.push(p,_,w)}if(this.setIndex(E),this.setAttribute("position",new Fn(I,3)),this.setAttribute("uv",new Fn(V,2)),this.computeVertexNormals(),g===2*Math.PI){const me=this.attributes.normal.array,S=new ot,e=new ot,c=new ot,p=u*t.length*3;for(let _=0,w=0;_<t.length;_++,w+=3)S.x=me[w+0],S.y=me[w+1],S.z=me[w+2],e.x=me[p+w+0],e.y=me[p+w+1],e.z=me[p+w+2],c.addVectors(S,e).normalize(),me[w+0]=me[p+w+0]=c.x,me[w+1]=me[p+w+1]=c.y,me[w+2]=me[p+w+2]=c.z}}function Bu(t,u){Fr.call(this),this.type="ShapeGeometry","object"==typeof u&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),u=u.curveSegments),this.parameters={shapes:t,curveSegments:u},this.fromBufferGeometry(new ou(t,u)),this.mergeVertices()}function ou(t,u){dn.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:u},u=u||12;const m=[],g=[],E=[],I=[];let V=0,J=0;if(!1===Array.isArray(t))Y(t);else for(let Z=0;Z<t.length;Z++)Y(t[Z]),this.addGroup(V,J,Z),V+=J,J=0;function Y(Z){const me=g.length/3,S=Z.extractPoints(u);let e=S.shape;const c=S.holes;!1===$c.isClockWise(e)&&(e=e.reverse());for(let _=0,w=c.length;_<w;_++){const L=c[_];!0===$c.isClockWise(L)&&(c[_]=L.reverse())}const p=$c.triangulateShape(e,c);for(let _=0,w=c.length;_<w;_++)e=e.concat(c[_]);for(let _=0,w=e.length;_<w;_++){const L=e[_];g.push(L.x,L.y,0),E.push(0,0,1),I.push(L.x,L.y)}for(let _=0,w=p.length;_<w;_++){const L=p[_];m.push(L[0]+me,L[1]+me,L[2]+me),J+=3}}this.setIndex(m),this.setAttribute("position",new Fn(g,3)),this.setAttribute("normal",new Fn(E,3)),this.setAttribute("uv",new Fn(I,2))}function nr(t,u){if(u.shapes=[],Array.isArray(t))for(let m=0,g=t.length;m<g;m++)u.shapes.push(t[m].uuid);else u.shapes.push(t.uuid);return u}function Si(t,u){dn.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:u},u=void 0!==u?u:1;const m=[],g=Math.cos(rr.DEG2RAD*u),E=[0,0],I={};let V,J,Y;const Z=["a","b","c"];let me;t.isBufferGeometry?(me=new Fr,me.fromBufferGeometry(t)):me=t.clone(),me.mergeVertices(),me.computeFaceNormals();const S=me.vertices,e=me.faces;for(let c=0,p=e.length;c<p;c++){const _=e[c];for(let w=0;w<3;w++)V=_[Z[w]],J=_[Z[(w+1)%3]],E[0]=Math.min(V,J),E[1]=Math.max(V,J),Y=E[0]+","+E[1],void 0===I[Y]?I[Y]={index1:E[0],index2:E[1],face1:c,face2:void 0}:I[Y].face2=c}for(Y in I){const c=I[Y];if(void 0===c.face2||e[c.face1].normal.dot(e[c.face2].normal)<=g){let p=S[c.index1];m.push(p.x,p.y,p.z),p=S[c.index2],m.push(p.x,p.y,p.z)}}this.setAttribute("position",new Fn(m,3))}function hh(t,u,m,g,E,I,V,J){Fr.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:u,height:m,radialSegments:g,heightSegments:E,openEnded:I,thetaStart:V,thetaLength:J},this.fromBufferGeometry(new Nn(t,u,m,g,E,I,V,J)),this.mergeVertices()}function Nn(t,u,m,g,E,I,V,J){dn.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:t,radiusBottom:u,height:m,radialSegments:g,heightSegments:E,openEnded:I,thetaStart:V,thetaLength:J};const Y=this;t=void 0!==t?t:1,u=void 0!==u?u:1,m=m||1,g=Math.floor(g)||8,E=Math.floor(E)||1,I=void 0!==I&&I,V=void 0!==V?V:0,J=void 0!==J?J:2*Math.PI;const Z=[],me=[],S=[],e=[];let c=0;const p=[],_=m/2;let w=0;function L(O){let D,z;const Q=new wn,ae=new ot;let ie=0;const he=!0===O?t:u,ye=!0===O?1:-1;D=c;for(let Me=1;Me<=g;Me++)me.push(0,_*ye,0),S.push(0,ye,0),e.push(.5,.5),c++;z=c;for(let Me=0;Me<=g;Me++){const Ne=Me/g*J+V,$e=Math.cos(Ne),ze=Math.sin(Ne);ae.x=he*ze,ae.y=_*ye,ae.z=he*$e,me.push(ae.x,ae.y,ae.z),S.push(0,ye,0),Q.x=.5*$e+.5,Q.y=.5*ze*ye+.5,e.push(Q.x,Q.y),c++}for(let Me=0;Me<g;Me++){const Ne=D+Me,$e=z+Me;!0===O?Z.push($e,$e+1,Ne):Z.push($e+1,$e,Ne),ie+=3}Y.addGroup(w,ie,!0===O?1:2),w+=ie}(function(){const O=new ot,D=new ot;let z=0;const Q=(u-t)/m;for(let ae=0;ae<=E;ae++){const ie=[],he=ae/E,ye=he*(u-t)+t;for(let Me=0;Me<=g;Me++){const Ne=Me/g,$e=Ne*J+V,ze=Math.sin($e),Ye=Math.cos($e);D.x=ye*ze,D.y=-he*m+_,D.z=ye*Ye,me.push(D.x,D.y,D.z),O.set(ze,Q,Ye).normalize(),S.push(O.x,O.y,O.z),e.push(Ne,1-he),ie.push(c++)}p.push(ie)}for(let ae=0;ae<g;ae++)for(let ie=0;ie<E;ie++){const ye=p[ie+1][ae],Me=p[ie+1][ae+1],Ne=p[ie][ae+1];Z.push(p[ie][ae],ye,Ne),Z.push(ye,Me,Ne),z+=6}Y.addGroup(w,z,0),w+=z})(),!1===I&&(t>0&&L(!0),u>0&&L(!1)),this.setIndex(Z),this.setAttribute("position",new Fn(me,3)),this.setAttribute("normal",new Fn(S,3)),this.setAttribute("uv",new Fn(e,2))}function Jo(t,u,m,g,E,I,V){hh.call(this,0,t,u,m,g,E,I,V),this.type="ConeGeometry",this.parameters={radius:t,height:u,radialSegments:m,heightSegments:g,openEnded:E,thetaStart:I,thetaLength:V}}function Pi(t,u,m,g,E,I,V){Nn.call(this,0,t,u,m,g,E,I,V),this.type="ConeBufferGeometry",this.parameters={radius:t,height:u,radialSegments:m,heightSegments:g,openEnded:E,thetaStart:I,thetaLength:V}}function ap(t,u,m,g){Fr.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:u,thetaStart:m,thetaLength:g},this.fromBufferGeometry(new lp(t,u,m,g)),this.mergeVertices()}function lp(t,u,m,g){dn.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:u,thetaStart:m,thetaLength:g},t=t||1,u=void 0!==u?Math.max(3,u):8,m=void 0!==m?m:0,g=void 0!==g?g:2*Math.PI;const E=[],I=[],V=[],J=[],Y=new ot,Z=new wn;I.push(0,0,0),V.push(0,0,1),J.push(.5,.5);for(let me=0,S=3;me<=u;me++,S+=3){const e=m+me/u*g;Y.x=t*Math.cos(e),Y.y=t*Math.sin(e),I.push(Y.x,Y.y,Y.z),V.push(0,0,1),Z.x=(I[S]/t+1)/2,Z.y=(I[S+1]/t+1)/2,J.push(Z.x,Z.y)}for(let me=1;me<=u;me++)E.push(me,me+1,0);this.setIndex(E),this.setAttribute("position",new Fn(I,3)),this.setAttribute("normal",new Fn(V,3)),this.setAttribute("uv",new Fn(J,2))}(Oh.prototype=Object.create(Fr.prototype)).constructor=Oh,(ho.prototype=Object.create(ha.prototype)).constructor=ho,(Cr.prototype=Object.create(Fr.prototype)).constructor=Cr,(Hr.prototype=Object.create(dn.prototype)).constructor=Hr,(pa.prototype=Object.create(Fr.prototype)).constructor=pa,(Lc.prototype=Object.create(dn.prototype)).constructor=Lc,(Lu.prototype=Object.create(Fr.prototype)).constructor=Lu,(kh.prototype=Object.create(dn.prototype)).constructor=kh,(Bu.prototype=Object.create(Fr.prototype)).constructor=Bu,Bu.prototype.toJSON=function(){const t=Fr.prototype.toJSON.call(this);return nr(this.parameters.shapes,t)},(ou.prototype=Object.create(dn.prototype)).constructor=ou,ou.prototype.toJSON=function(){const t=dn.prototype.toJSON.call(this);return nr(this.parameters.shapes,t)},(Si.prototype=Object.create(dn.prototype)).constructor=Si,(hh.prototype=Object.create(Fr.prototype)).constructor=hh,(Nn.prototype=Object.create(dn.prototype)).constructor=Nn,(Jo.prototype=Object.create(hh.prototype)).constructor=Jo,(Pi.prototype=Object.create(Nn.prototype)).constructor=Pi,(ap.prototype=Object.create(Fr.prototype)).constructor=ap,(lp.prototype=Object.create(dn.prototype)).constructor=lp;var Js=Object.freeze({__proto__:null,WireframeGeometry:Ql,ParametricGeometry:Kl,ParametricBufferGeometry:Ac,TetrahedronGeometry:Kc,TetrahedronBufferGeometry:eu,OctahedronGeometry:Rh,OctahedronBufferGeometry:uh,IcosahedronGeometry:ua,IcosahedronBufferGeometry:Aa,DodecahedronGeometry:ks,DodecahedronBufferGeometry:Fs,PolyhedronGeometry:ch,PolyhedronBufferGeometry:Ma,TubeGeometry:tu,TubeBufferGeometry:ec,TorusKnotGeometry:Va,TorusKnotBufferGeometry:Pl,TorusGeometry:Ao,TorusBufferGeometry:Vp,TextGeometry:Oh,TextBufferGeometry:ho,SphereGeometry:Cr,SphereBufferGeometry:Hr,RingGeometry:pa,RingBufferGeometry:Lc,PlaneGeometry:Ua,PlaneBufferGeometry:Cl,LatheGeometry:Lu,LatheBufferGeometry:kh,ShapeGeometry:Bu,ShapeBufferGeometry:ou,ExtrudeGeometry:Cc,ExtrudeBufferGeometry:ha,EdgesGeometry:Si,ConeGeometry:Jo,ConeBufferGeometry:Pi,CylinderGeometry:hh,CylinderBufferGeometry:Nn,CircleGeometry:ap,CircleBufferGeometry:lp,BoxGeometry:Cs,BoxBufferGeometry:nh});function ph(t){Ur.call(this),this.type="ShadowMaterial",this.color=new lr(0),this.transparent=!0,this.setValues(t)}function qi(t){uo.call(this,t),this.type="RawShaderMaterial"}function da(t){Ur.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new lr(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new lr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Te,this.normalScale=new wn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.vertexTangents=!1,this.setValues(t)}function pl(t){da.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new wn(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,this.sheen=null,this.transmission=0,this.transmissionMap=null,this.setValues(t)}function po(t){Ur.call(this),this.type="MeshPhongMaterial",this.color=new lr(16777215),this.specular=new lr(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new lr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Te,this.normalScale=new wn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Jr,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function us(t){Ur.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new lr(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new lr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Te,this.normalScale=new wn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Go(t){Ur.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Te,this.normalScale=new wn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function to(t){Ur.call(this),this.type="MeshLambertMaterial",this.color=new lr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new lr(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Jr,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Zo(t){Ur.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new lr(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Te,this.normalScale=new wn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function $a(t){Qn.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}(ph.prototype=Object.create(Ur.prototype)).constructor=ph,ph.prototype.isShadowMaterial=!0,ph.prototype.copy=function(t){return Ur.prototype.copy.call(this,t),this.color.copy(t.color),this},(qi.prototype=Object.create(uo.prototype)).constructor=qi,qi.prototype.isRawShaderMaterial=!0,(da.prototype=Object.create(Ur.prototype)).constructor=da,da.prototype.isMeshStandardMaterial=!0,da.prototype.copy=function(t){return Ur.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.vertexTangents=t.vertexTangents,this},(pl.prototype=Object.create(da.prototype)).constructor=pl,pl.prototype.isMeshPhysicalMaterial=!0,pl.prototype.copy=function(t){return da.prototype.copy.call(this,t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.reflectivity=t.reflectivity,this.sheen=t.sheen?(this.sheen||new lr).copy(t.sheen):null,this.transmission=t.transmission,this.transmissionMap=t.transmissionMap,this},(po.prototype=Object.create(Ur.prototype)).constructor=po,po.prototype.isMeshPhongMaterial=!0,po.prototype.copy=function(t){return Ur.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(us.prototype=Object.create(Ur.prototype)).constructor=us,us.prototype.isMeshToonMaterial=!0,us.prototype.copy=function(t){return Ur.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(Go.prototype=Object.create(Ur.prototype)).constructor=Go,Go.prototype.isMeshNormalMaterial=!0,Go.prototype.copy=function(t){return Ur.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(to.prototype=Object.create(Ur.prototype)).constructor=to,to.prototype.isMeshLambertMaterial=!0,to.prototype.copy=function(t){return Ur.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},(Zo.prototype=Object.create(Ur.prototype)).constructor=Zo,Zo.prototype.isMeshMatcapMaterial=!0,Zo.prototype.copy=function(t){return Ur.prototype.copy.call(this,t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},($a.prototype=Object.create(Qn.prototype)).constructor=$a,$a.prototype.isLineDashedMaterial=!0,$a.prototype.copy=function(t){return Qn.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var Fh=Object.freeze({__proto__:null,ShadowMaterial:ph,SpriteMaterial:Lh,RawShaderMaterial:qi,ShaderMaterial:uo,PointsMaterial:ca,MeshPhysicalMaterial:pl,MeshStandardMaterial:da,MeshPhongMaterial:po,MeshToonMaterial:us,MeshNormalMaterial:Go,MeshLambertMaterial:to,MeshDepthMaterial:sh,MeshDistanceMaterial:Ip,MeshBasicMaterial:eo,MeshMatcapMaterial:Zo,LineDashedMaterial:$a,LineBasicMaterial:Qn,Material:Ur});const oo={arraySlice:function(t,u,m){return oo.isTypedArray(t)?new t.constructor(t.subarray(u,void 0!==m?m:t.length)):t.slice(u,m)},convertArray:function(t,u,m){return!t||!m&&t.constructor===u?t:"number"==typeof u.BYTES_PER_ELEMENT?new u(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){const u=t.length,m=new Array(u);for(let g=0;g!==u;++g)m[g]=g;return m.sort(function(g,E){return t[g]-t[E]}),m},sortedArray:function(t,u,m){const g=t.length,E=new t.constructor(g);for(let I=0,V=0;V!==g;++I){const J=m[I]*u;for(let Y=0;Y!==u;++Y)E[V++]=t[J+Y]}return E},flattenJSON:function(t,u,m,g){let E=1,I=t[0];for(;void 0!==I&&void 0===I[g];)I=t[E++];if(void 0===I)return;let V=I[g];if(void 0!==V)if(Array.isArray(V))do{V=I[g],void 0!==V&&(u.push(I.time),m.push.apply(m,V)),I=t[E++]}while(void 0!==I);else if(void 0!==V.toArray)do{V=I[g],void 0!==V&&(u.push(I.time),V.toArray(m,m.length)),I=t[E++]}while(void 0!==I);else do{V=I[g],void 0!==V&&(u.push(I.time),m.push(V)),I=t[E++]}while(void 0!==I)},subclip:function(t,u,m,g,E){E=E||30;const I=t.clone();I.name=u;const V=[];for(let Y=0;Y<I.tracks.length;++Y){const Z=I.tracks[Y],me=Z.getValueSize(),S=[],e=[];for(let c=0;c<Z.times.length;++c){const p=Z.times[c]*E;if(!(p<m||p>=g)){S.push(Z.times[c]);for(let _=0;_<me;++_)e.push(Z.values[c*me+_])}}0!==S.length&&(Z.times=oo.convertArray(S,Z.times.constructor),Z.values=oo.convertArray(e,Z.values.constructor),V.push(Z))}I.tracks=V;let J=1/0;for(let Y=0;Y<I.tracks.length;++Y)J>I.tracks[Y].times[0]&&(J=I.tracks[Y].times[0]);for(let Y=0;Y<I.tracks.length;++Y)I.tracks[Y].shift(-1*J);return I.resetDuration(),I},makeClipAdditive:function(t,u,m,g){void 0===u&&(u=0),void 0===m&&(m=t),(void 0===g||g<=0)&&(g=30);const E=t.tracks.length,I=u/g;for(let V=0;V<E;++V){const J=m.tracks[V],Y=J.ValueTypeName;if("bool"===Y||"string"===Y)continue;const Z=t.tracks.find(function(p){return p.name===J.name&&p.ValueTypeName===Y});if(void 0===Z)continue;const me=J.getValueSize(),S=J.times.length-1;let e;if(I<=J.times[0])e=oo.arraySlice(J.values,0,J.valueSize);else if(I>=J.times[S])e=oo.arraySlice(J.values,S*me);else{const p=J.createInterpolant();p.evaluate(I),e=p.resultBuffer}"quaternion"===Y&&new yo(e[0],e[1],e[2],e[3]).normalize().conjugate().toArray(e);const c=Z.times.length;for(let p=0;p<c;++p){const _=p*me;if("quaternion"===Y)yo.multiplyQuaternionsFlat(Z.values,_,e,0,Z.values,_);else for(let w=0;w<me;++w)Z.values[_+w]-=e[w]}}return t.blendMode=Yu,t}};function Us(t,u,m,g){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==g?g:new u.constructor(m),this.sampleValues=u,this.valueSize=m}function dh(t,u,m,g){Us.call(this,t,u,m,g),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function Wa(t,u,m,g){Us.call(this,t,u,m,g)}function Bc(t,u,m,g){Us.call(this,t,u,m,g)}function fo(t,u,m,g){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===u||0===u.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=oo.convertArray(u,this.TimeBufferType),this.values=oo.convertArray(m,this.ValueBufferType),this.setInterpolation(g||this.DefaultInterpolation)}function dl(t,u,m){fo.call(this,t,u,m)}function nf(t,u,m,g){fo.call(this,t,u,m,g)}function $i(t,u,m,g){fo.call(this,t,u,m,g)}function Nu(t,u,m,g){Us.call(this,t,u,m,g)}function Nc(t,u,m,g){fo.call(this,t,u,m,g)}function Ru(t,u,m,g){fo.call(this,t,u,m,g)}function su(t,u,m,g){fo.call(this,t,u,m,g)}function zs(t,u,m,g){this.name=t,this.tracks=m,this.duration=void 0!==u?u:-1,this.blendMode=void 0!==g?g:Xu,this.uuid=rr.generateUUID(),this.duration<0&&this.resetDuration()}function Pu(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const u=function(m){switch(m.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return $i;case"vector":case"vector2":case"vector3":case"vector4":return su;case"color":return nf;case"quaternion":return Nc;case"bool":case"boolean":return dl;case"string":return Ru}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+m)}(t.type);if(void 0===t.times){const m=[],g=[];oo.flattenJSON(t.keys,m,g,"value"),t.times=m,t.values=g}return void 0!==u.parse?u.parse(t):new u(t.name,t.times,t.values,t.interpolation)}Object.assign(Us.prototype,{evaluate:function(t){let u=this.parameterPositions,m=this._cachedIndex,g=u[m],E=u[m-1];e:{t:{let I;n:{r:if(!(t<g)){for(let V=m+2;;){if(void 0===g){if(t<E)break r;return m=u.length,this._cachedIndex=m,this.afterEnd_(m-1,t,E)}if(m===V)break;if(E=g,g=u[++m],t<g)break t}I=u.length;break n}if(t>=E)break e;{const V=u[1];t<V&&(m=2,E=V);for(let J=m-2;;){if(void 0===E)return this._cachedIndex=0,this.beforeStart_(0,t,g);if(m===J)break;if(g=E,E=u[--m-1],t>=E)break t}I=m,m=0}}for(;m<I;){const V=m+I>>>1;t<u[V]?I=V:m=V+1}if(g=u[m],E=u[m-1],void 0===E)return this._cachedIndex=0,this.beforeStart_(0,t,g);if(void 0===g)return m=u.length,this._cachedIndex=m,this.afterEnd_(m-1,E,t)}this._cachedIndex=m,this.intervalChanged_(m,E,g)}return this.interpolate_(m,E,t,g)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){const u=this.resultBuffer,m=this.sampleValues,g=this.valueSize,E=t*g;for(let I=0;I!==g;++I)u[I]=m[E+I];return u},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(Us.prototype,{beforeStart_:Us.prototype.copySampleValue_,afterEnd_:Us.prototype.copySampleValue_}),dh.prototype=Object.assign(Object.create(Us.prototype),{constructor:dh,DefaultSettings_:{endingStart:va,endingEnd:va},intervalChanged_:function(t,u,m){let g=this.parameterPositions,E=t-2,I=t+1,V=g[E],J=g[I];if(void 0===V)switch(this.getSettings_().endingStart){case ta:E=t,V=2*u-m;break;case xl:E=g.length-2,V=u+g[E]-g[E+1];break;default:E=t,V=m}if(void 0===J)switch(this.getSettings_().endingEnd){case ta:I=t,J=2*m-u;break;case xl:I=1,J=m+g[1]-g[0];break;default:I=t-1,J=u}const Y=.5*(m-u),Z=this.valueSize;this._weightPrev=Y/(u-V),this._weightNext=Y/(J-m),this._offsetPrev=E*Z,this._offsetNext=I*Z},interpolate_:function(t,u,m,g){const E=this.resultBuffer,I=this.sampleValues,V=this.valueSize,J=t*V,Y=J-V,Z=this._offsetPrev,me=this._offsetNext,S=this._weightPrev,e=this._weightNext,c=(m-u)/(g-u),p=c*c,_=p*c,w=-S*_+2*S*p-S*c,L=(1+S)*_+(-1.5-2*S)*p+(-.5+S)*c+1,O=(-1-e)*_+(1.5+e)*p+.5*c,D=e*_-e*p;for(let z=0;z!==V;++z)E[z]=w*I[Z+z]+L*I[Y+z]+O*I[J+z]+D*I[me+z];return E}}),Wa.prototype=Object.assign(Object.create(Us.prototype),{constructor:Wa,interpolate_:function(t,u,m,g){const E=this.resultBuffer,I=this.sampleValues,V=this.valueSize,J=t*V,Y=J-V,Z=(m-u)/(g-u),me=1-Z;for(let S=0;S!==V;++S)E[S]=I[Y+S]*me+I[J+S]*Z;return E}}),Bc.prototype=Object.assign(Object.create(Us.prototype),{constructor:Bc,interpolate_:function(t){return this.copySampleValue_(t-1)}}),Object.assign(fo,{toJSON:function(t){const u=t.constructor;let m;if(void 0!==u.toJSON)m=u.toJSON(t);else{m={name:t.name,times:oo.convertArray(t.times,Array),values:oo.convertArray(t.values,Array)};const g=t.getInterpolation();g!==t.DefaultInterpolation&&(m.interpolation=g)}return m.type=t.ValueTypeName,m}}),Object.assign(fo.prototype,{constructor:fo,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:jl,InterpolantFactoryMethodDiscrete:function(t){return new Bc(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new Wa(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new dh(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){let u;switch(t){case zl:u=this.InterpolantFactoryMethodDiscrete;break;case jl:u=this.InterpolantFactoryMethodLinear;break;case qu:u=this.InterpolantFactoryMethodSmooth}if(void 0===u){const m="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(m);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",m),this}return this.createInterpolant=u,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return zl;case this.InterpolantFactoryMethodLinear:return jl;case this.InterpolantFactoryMethodSmooth:return qu}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t){const u=this.times;for(let m=0,g=u.length;m!==g;++m)u[m]+=t}return this},scale:function(t){if(1!==t){const u=this.times;for(let m=0,g=u.length;m!==g;++m)u[m]*=t}return this},trim:function(t,u){const m=this.times,g=m.length;let E=0,I=g-1;for(;E!==g&&m[E]<t;)++E;for(;-1!==I&&m[I]>u;)--I;if(++I,0!==E||I!==g){E>=I&&(I=Math.max(I,1),E=I-1);const V=this.getValueSize();this.times=oo.arraySlice(m,E,I),this.values=oo.arraySlice(this.values,E*V,I*V)}return this},validate:function(){let t=!0;const u=this.getValueSize();u-Math.floor(u)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);const m=this.times,g=this.values,E=m.length;0===E&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);let I=null;for(let V=0;V!==E;V++){const J=m[V];if("number"==typeof J&&isNaN(J)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,V,J),t=!1;break}if(null!==I&&I>J){console.error("THREE.KeyframeTrack: Out of order keys.",this,V,J,I),t=!1;break}I=J}if(void 0!==g&&oo.isTypedArray(g))for(let V=0,J=g.length;V!==J;++V){const Y=g[V];if(isNaN(Y)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,V,Y),t=!1;break}}return t},optimize:function(){const t=oo.arraySlice(this.times),u=oo.arraySlice(this.values),m=this.getValueSize(),g=this.getInterpolation()===qu,E=t.length-1;let I=1;for(let V=1;V<E;++V){let J=!1;const Y=t[V];if(Y!==t[V+1]&&(1!==V||Y!==Y[0]))if(g)J=!0;else{const Z=V*m,me=Z-m,S=Z+m;for(let e=0;e!==m;++e){const c=u[Z+e];if(c!==u[me+e]||c!==u[S+e]){J=!0;break}}}if(J){if(V!==I){t[I]=t[V];const Z=V*m,me=I*m;for(let S=0;S!==m;++S)u[me+S]=u[Z+S]}++I}}if(E>0){t[I]=t[E];for(let V=E*m,J=I*m,Y=0;Y!==m;++Y)u[J+Y]=u[V+Y];++I}return I!==t.length?(this.times=oo.arraySlice(t,0,I),this.values=oo.arraySlice(u,0,I*m)):(this.times=t,this.values=u),this},clone:function(){const t=oo.arraySlice(this.times,0),u=oo.arraySlice(this.values,0),m=new this.constructor(this.name,t,u);return m.createInterpolant=this.createInterpolant,m}}),dl.prototype=Object.assign(Object.create(fo.prototype),{constructor:dl,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:zl,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),nf.prototype=Object.assign(Object.create(fo.prototype),{constructor:nf,ValueTypeName:"color"}),$i.prototype=Object.assign(Object.create(fo.prototype),{constructor:$i,ValueTypeName:"number"}),Nu.prototype=Object.assign(Object.create(Us.prototype),{constructor:Nu,interpolate_:function(t,u,m,g){const E=this.resultBuffer,I=this.sampleValues,V=this.valueSize,J=(m-u)/(g-u);let Y=t*V;for(let Z=Y+V;Y!==Z;Y+=4)yo.slerpFlat(E,0,I,Y-V,I,Y,J);return E}}),Nc.prototype=Object.assign(Object.create(fo.prototype),{constructor:Nc,ValueTypeName:"quaternion",DefaultInterpolation:jl,InterpolantFactoryMethodLinear:function(t){return new Nu(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),Ru.prototype=Object.assign(Object.create(fo.prototype),{constructor:Ru,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:zl,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),su.prototype=Object.assign(Object.create(fo.prototype),{constructor:su,ValueTypeName:"vector"}),Object.assign(zs,{parse:function(t){const u=[],m=t.tracks,g=1/(t.fps||1);for(let E=0,I=m.length;E!==I;++E)u.push(Pu(m[E]).scale(g));return new zs(t.name,t.duration,u,t.blendMode)},toJSON:function(t){const u=[],m=t.tracks,g={name:t.name,duration:t.duration,tracks:u,uuid:t.uuid,blendMode:t.blendMode};for(let E=0,I=m.length;E!==I;++E)u.push(fo.toJSON(m[E]));return g},CreateFromMorphTargetSequence:function(t,u,m,g){const E=u.length,I=[];for(let V=0;V<E;V++){let J=[],Y=[];J.push((V+E-1)%E,V,(V+1)%E),Y.push(0,1,0);const Z=oo.getKeyframeOrder(J);J=oo.sortedArray(J,1,Z),Y=oo.sortedArray(Y,1,Z),g||0!==J[0]||(J.push(E),Y.push(Y[0])),I.push(new $i(".morphTargetInfluences["+u[V].name+"]",J,Y).scale(1/m))}return new zs(t,-1,I)},findByName:function(t,u){let m=t;Array.isArray(t)||(m=t.geometry&&t.geometry.animations||t.animations);for(let g=0;g<m.length;g++)if(m[g].name===u)return m[g];return null},CreateClipsFromMorphTargetSequences:function(t,u,m){const g={},E=/^([\w-]*?)([\d]+)$/;for(let V=0,J=t.length;V<J;V++){const Y=t[V],Z=Y.name.match(E);if(Z&&Z.length>1){const me=Z[1];let S=g[me];S||(g[me]=S=[]),S.push(Y)}}const I=[];for(const V in g)I.push(zs.CreateFromMorphTargetSequence(V,g[V],u,m));return I},parseAnimation:function(t,u){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const m=function(Z,me,S,e,c){if(0!==S.length){const p=[],_=[];oo.flattenJSON(S,p,_,e),0!==p.length&&c.push(new Z(me,p,_))}},g=[],E=t.name||"default",I=t.fps||30,V=t.blendMode;let J=t.length||-1;const Y=t.hierarchy||[];for(let Z=0;Z<Y.length;Z++){const me=Y[Z].keys;if(me&&0!==me.length)if(me[0].morphTargets){const S={};let e;for(e=0;e<me.length;e++)if(me[e].morphTargets)for(let c=0;c<me[e].morphTargets.length;c++)S[me[e].morphTargets[c]]=-1;for(const c in S){const p=[],_=[];for(let w=0;w!==me[e].morphTargets.length;++w){const L=me[e];p.push(L.time),_.push(L.morphTarget===c?1:0)}g.push(new $i(".morphTargetInfluence["+c+"]",p,_))}J=S.length*(I||1)}else{const S=".bones["+u[Z].name+"]";m(su,S+".position",me,"pos",g),m(Nc,S+".quaternion",me,"rot",g),m(su,S+".scale",me,"scl",g)}}return 0===g.length?null:new zs(E,J,g,V)}}),Object.assign(zs.prototype,{resetDuration:function(){let t=0;for(let u=0,m=this.tracks.length;u!==m;++u){const g=this.tracks[u];t=Math.max(t,g.times[g.times.length-1])}return this.duration=t,this},trim:function(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},validate:function(){let t=!0;for(let u=0;u<this.tracks.length;u++)t=t&&this.tracks[u].validate();return t},optimize:function(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this},clone:function(){const t=[];for(let u=0;u<this.tracks.length;u++)t.push(this.tracks[u].clone());return new zs(this.name,this.duration,t,this.blendMode)}});const Ei={enabled:!1,files:{},add:function(t,u){!1!==this.enabled&&(this.files[t]=u)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};function fa(t,u,m){const g=this;let E,I=!1,V=0,J=0;const Y=[];this.onStart=void 0,this.onLoad=t,this.onProgress=u,this.onError=m,this.itemStart=function(Z){J++,!1===I&&void 0!==g.onStart&&g.onStart(Z,V,J),I=!0},this.itemEnd=function(Z){V++,void 0!==g.onProgress&&g.onProgress(Z,V,J),V===J&&(I=!1,void 0!==g.onLoad&&g.onLoad())},this.itemError=function(Z){void 0!==g.onError&&g.onError(Z)},this.resolveURL=function(Z){return E?E(Z):Z},this.setURLModifier=function(Z){return E=Z,this},this.addHandler=function(Z,me){return Y.push(Z,me),this},this.removeHandler=function(Z){const me=Y.indexOf(Z);return-1!==me&&Y.splice(me,2),this},this.getHandler=function(Z){for(let me=0,S=Y.length;me<S;me+=2){const e=Y[me],c=Y[me+1];if(e.global&&(e.lastIndex=0),e.test(Z))return c}return null}}const rf=new fa;function Ci(t){this.manager=void 0!==t?t:rf,this.crossOrigin="anonymous",this.path="",this.resourcePath="",this.requestHeader={}}Object.assign(Ci.prototype,{load:function(){},loadAsync:function(t,u){const m=this;return new Promise(function(g,E){m.load(t,g,u,E)})},parse:function(){},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this},setResourcePath:function(t){return this.resourcePath=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}});const ma={};function tc(t){Ci.call(this,t)}function Il(t){Ci.call(this,t)}function Ld(t){Ci.call(this,t)}function Iu(t){Ci.call(this,t)}function Ol(t){Ci.call(this,t)}function fl(t){Ci.call(this,t)}function ld(t){Ci.call(this,t)}function Hn(){this.type="Curve",this.arcLengthDivisions=200}function rs(t,u,m,g,E,I,V,J){Hn.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=u||0,this.xRadius=m||1,this.yRadius=g||1,this.aStartAngle=E||0,this.aEndAngle=I||2*Math.PI,this.aClockwise=V||!1,this.aRotation=J||0}function a(t,u,m,g,E,I){rs.call(this,t,u,m,m,g,E,I),this.type="ArcCurve"}function r(){let t=0,u=0,m=0,g=0;function E(I,V,J,Y){t=I,u=J,m=-3*I+3*V-2*J-Y,g=2*I-2*V+J+Y}return{initCatmullRom:function(I,V,J,Y,Z){E(V,J,Z*(J-I),Z*(Y-V))},initNonuniformCatmullRom:function(I,V,J,Y,Z,me,S){let e=(V-I)/Z-(J-I)/(Z+me)+(J-V)/me,c=(J-V)/me-(Y-V)/(me+S)+(Y-J)/S;e*=me,c*=me,E(V,J,e,c)},calc:function(I){const V=I*I;return t+u*I+m*V+g*(V*I)}}}tc.prototype=Object.assign(Object.create(Ci.prototype),{constructor:tc,load:function(t,u,m,g){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const E=this,I=Ei.get(t);if(void 0!==I)return E.manager.itemStart(t),setTimeout(function(){u&&u(I),E.manager.itemEnd(t)},0),I;if(void 0!==ma[t])return void ma[t].push({onLoad:u,onProgress:m,onError:g});const V=t.match(/^data:(.*?)(;base64)?,(.*)$/);let J;if(V){const Y=V[1],Z=!!V[2];let me=V[3];me=decodeURIComponent(me),Z&&(me=atob(me));try{let S;const e=(this.responseType||"").toLowerCase();switch(e){case"arraybuffer":case"blob":const c=new Uint8Array(me.length);for(let _=0;_<me.length;_++)c[_]=me.charCodeAt(_);S="blob"===e?new Blob([c.buffer],{type:Y}):c.buffer;break;case"document":S=(new DOMParser).parseFromString(me,Y);break;case"json":S=JSON.parse(me);break;default:S=me}setTimeout(function(){u&&u(S),E.manager.itemEnd(t)},0)}catch(S){setTimeout(function(){g&&g(S),E.manager.itemError(t),E.manager.itemEnd(t)},0)}}else{ma[t]=[],ma[t].push({onLoad:u,onProgress:m,onError:g}),J=new XMLHttpRequest,J.open("GET",t,!0),J.addEventListener("load",function(Y){const Z=this.response,me=ma[t];if(delete ma[t],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),Ei.add(t,Z);for(let S=0,e=me.length;S<e;S++){const c=me[S];c.onLoad&&c.onLoad(Z)}E.manager.itemEnd(t)}else{for(let S=0,e=me.length;S<e;S++){const c=me[S];c.onError&&c.onError(Y)}E.manager.itemError(t),E.manager.itemEnd(t)}},!1),J.addEventListener("progress",function(Y){const Z=ma[t];for(let me=0,S=Z.length;me<S;me++){const e=Z[me];e.onProgress&&e.onProgress(Y)}},!1),J.addEventListener("error",function(Y){const Z=ma[t];delete ma[t];for(let me=0,S=Z.length;me<S;me++){const e=Z[me];e.onError&&e.onError(Y)}E.manager.itemError(t),E.manager.itemEnd(t)},!1),J.addEventListener("abort",function(Y){const Z=ma[t];delete ma[t];for(let me=0,S=Z.length;me<S;me++){const e=Z[me];e.onError&&e.onError(Y)}E.manager.itemError(t),E.manager.itemEnd(t)},!1),void 0!==this.responseType&&(J.responseType=this.responseType),void 0!==this.withCredentials&&(J.withCredentials=this.withCredentials),J.overrideMimeType&&J.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain");for(const Y in this.requestHeader)J.setRequestHeader(Y,this.requestHeader[Y]);J.send(null)}return E.manager.itemStart(t),J},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setMimeType:function(t){return this.mimeType=t,this}}),Il.prototype=Object.assign(Object.create(Ci.prototype),{constructor:Il,load:function(t,u,m,g){const E=this,I=new tc(E.manager);I.setPath(E.path),I.setRequestHeader(E.requestHeader),I.load(t,function(V){try{u(E.parse(JSON.parse(V)))}catch(J){g?g(J):console.error(J),E.manager.itemError(t)}},m,g)},parse:function(t){const u=[];for(let m=0;m<t.length;m++){const g=zs.parse(t[m]);u.push(g)}return u}}),Ld.prototype=Object.assign(Object.create(Ci.prototype),{constructor:Ld,load:function(t,u,m,g){const E=this,I=[],V=new sd;V.image=I;const J=new tc(this.manager);J.setPath(this.path),J.setResponseType("arraybuffer"),J.setRequestHeader(this.requestHeader);let Y=0;function Z(me){J.load(t[me],function(S){const e=E.parse(S,!0);I[me]={width:e.width,height:e.height,format:e.format,mipmaps:e.mipmaps},Y+=1,6===Y&&(1===e.mipmapCount&&(V.minFilter=ii),V.format=e.format,V.needsUpdate=!0,u&&u(V))},m,g)}if(Array.isArray(t))for(let me=0,S=t.length;me<S;++me)Z(me);else J.load(t,function(me){const S=E.parse(me,!0);if(S.isCubemap){const e=S.mipmaps.length/S.mipmapCount;for(let c=0;c<e;c++){I[c]={mipmaps:[]};for(let p=0;p<S.mipmapCount;p++)I[c].mipmaps.push(S.mipmaps[c*S.mipmapCount+p]),I[c].format=S.format,I[c].width=S.width,I[c].height=S.height}}else V.image.width=S.width,V.image.height=S.height,V.mipmaps=S.mipmaps;1===S.mipmapCount&&(V.minFilter=ii),V.format=S.format,V.needsUpdate=!0,u&&u(V)},m,g);return V}}),Iu.prototype=Object.assign(Object.create(Ci.prototype),{constructor:Iu,load:function(t,u,m,g){const E=this,I=new ol,V=new tc(this.manager);return V.setResponseType("arraybuffer"),V.setRequestHeader(this.requestHeader),V.setPath(this.path),V.load(t,function(J){const Y=E.parse(J);Y&&(void 0!==Y.image?I.image=Y.image:void 0!==Y.data&&(I.image.width=Y.width,I.image.height=Y.height,I.image.data=Y.data),I.wrapS=void 0!==Y.wrapS?Y.wrapS:Xr,I.wrapT=void 0!==Y.wrapT?Y.wrapT:Xr,I.magFilter=void 0!==Y.magFilter?Y.magFilter:ii,I.minFilter=void 0!==Y.minFilter?Y.minFilter:ii,I.anisotropy=void 0!==Y.anisotropy?Y.anisotropy:1,void 0!==Y.format&&(I.format=Y.format),void 0!==Y.type&&(I.type=Y.type),void 0!==Y.mipmaps&&(I.mipmaps=Y.mipmaps,I.minFilter=Ya),1===Y.mipmapCount&&(I.minFilter=ii),I.needsUpdate=!0,u&&u(I,Y))},m,g),I}}),Ol.prototype=Object.assign(Object.create(Ci.prototype),{constructor:Ol,load:function(t,u,m,g){void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const E=this,I=Ei.get(t);if(void 0!==I)return E.manager.itemStart(t),setTimeout(function(){u&&u(I),E.manager.itemEnd(t)},0),I;const V=document.createElementNS("http://www.w3.org/1999/xhtml","img");function J(){V.removeEventListener("load",J,!1),V.removeEventListener("error",Y,!1),Ei.add(t,this),u&&u(this),E.manager.itemEnd(t)}function Y(Z){V.removeEventListener("load",J,!1),V.removeEventListener("error",Y,!1),g&&g(Z),E.manager.itemError(t),E.manager.itemEnd(t)}return V.addEventListener("load",J,!1),V.addEventListener("error",Y,!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(V.crossOrigin=this.crossOrigin),E.manager.itemStart(t),V.src=t,V}}),fl.prototype=Object.assign(Object.create(Ci.prototype),{constructor:fl,load:function(t,u,m,g){const E=new ls,I=new Ol(this.manager);I.setCrossOrigin(this.crossOrigin),I.setPath(this.path);let V=0;function J(Y){I.load(t[Y],function(Z){E.images[Y]=Z,V++,6===V&&(E.needsUpdate=!0,u&&u(E))},void 0,g)}for(let Y=0;Y<t.length;++Y)J(Y);return E}}),ld.prototype=Object.assign(Object.create(Ci.prototype),{constructor:ld,load:function(t,u,m,g){const E=new ui,I=new Ol(this.manager);return I.setCrossOrigin(this.crossOrigin),I.setPath(this.path),I.load(t,function(V){E.image=V;const J=t.search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/);E.format=J?Rs:lo,E.needsUpdate=!0,void 0!==u&&u(E)},m,g),E}}),Object.assign(Hn.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t,u){const m=this.getUtoTmapping(t);return this.getPoint(m,u)},getPoints:function(t){void 0===t&&(t=5);const u=[];for(let m=0;m<=t;m++)u.push(this.getPoint(m/t));return u},getSpacedPoints:function(t){void 0===t&&(t=5);const u=[];for(let m=0;m<=t;m++)u.push(this.getPointAt(m/t));return u},getLength:function(){const t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const u=[];let m,g=this.getPoint(0),E=0;u.push(0);for(let I=1;I<=t;I++)m=this.getPoint(I/t),E+=m.distanceTo(g),u.push(E),g=m;return this.cacheArcLengths=u,u},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,u){const m=this.getLengths();let g,E=0,I=m.length;g=u||t*m[I-1];let V,J=0,Y=I-1;for(;J<=Y;)if(E=Math.floor(J+(Y-J)/2),V=m[E]-g,V<0)J=E+1;else{if(!(V>0)){Y=E;break}Y=E-1}if(E=Y,m[E]===g)return E/(I-1);const Z=m[E];return(E+(g-Z)/(m[E+1]-Z))/(I-1)},getTangent:function(t,u){let g=t-1e-4,E=t+1e-4;g<0&&(g=0),E>1&&(E=1);const I=this.getPoint(g),V=this.getPoint(E),J=u||(I.isVector2?new wn:new ot);return J.copy(V).sub(I).normalize(),J},getTangentAt:function(t,u){const m=this.getUtoTmapping(t);return this.getTangent(m,u)},computeFrenetFrames:function(t,u){const m=new ot,g=[],E=[],I=[],V=new ot,J=new ti;for(let e=0;e<=t;e++)g[e]=this.getTangentAt(e/t,new ot),g[e].normalize();E[0]=new ot,I[0]=new ot;let Y=Number.MAX_VALUE;const Z=Math.abs(g[0].x),me=Math.abs(g[0].y),S=Math.abs(g[0].z);Z<=Y&&(Y=Z,m.set(1,0,0)),me<=Y&&(Y=me,m.set(0,1,0)),S<=Y&&m.set(0,0,1),V.crossVectors(g[0],m).normalize(),E[0].crossVectors(g[0],V),I[0].crossVectors(g[0],E[0]);for(let e=1;e<=t;e++){if(E[e]=E[e-1].clone(),I[e]=I[e-1].clone(),V.crossVectors(g[e-1],g[e]),V.length()>Number.EPSILON){V.normalize();const c=Math.acos(rr.clamp(g[e-1].dot(g[e]),-1,1));E[e].applyMatrix4(J.makeRotationAxis(V,c))}I[e].crossVectors(g[e],E[e])}if(!0===u){let e=Math.acos(rr.clamp(E[0].dot(E[t]),-1,1));e/=t,g[0].dot(V.crossVectors(E[0],E[t]))>0&&(e=-e);for(let c=1;c<=t;c++)E[c].applyMatrix4(J.makeRotationAxis(g[c],e*c)),I[c].crossVectors(g[c],E[c])}return{tangents:g,normals:E,binormals:I}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){const t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}),(rs.prototype=Object.create(Hn.prototype)).constructor=rs,rs.prototype.isEllipseCurve=!0,rs.prototype.getPoint=function(t,u){const m=u||new wn,g=2*Math.PI;let E=this.aEndAngle-this.aStartAngle;const I=Math.abs(E)<Number.EPSILON;for(;E<0;)E+=g;for(;E>g;)E-=g;E<Number.EPSILON&&(E=I?0:g),!0!==this.aClockwise||I||(E===g?E=-g:E-=g);const V=this.aStartAngle+t*E;let J=this.aX+this.xRadius*Math.cos(V),Y=this.aY+this.yRadius*Math.sin(V);if(0!==this.aRotation){const Z=Math.cos(this.aRotation),me=Math.sin(this.aRotation),S=J-this.aX,e=Y-this.aY;J=S*Z-e*me+this.aX,Y=S*me+e*Z+this.aY}return m.set(J,Y)},rs.prototype.copy=function(t){return Hn.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},rs.prototype.toJSON=function(){const t=Hn.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t},rs.prototype.fromJSON=function(t){return Hn.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},(a.prototype=Object.create(rs.prototype)).constructor=a,a.prototype.isArcCurve=!0;const h=new ot,d=new r,y=new r,b=new r;function R(t,u,m,g){Hn.call(this),this.type="CatmullRomCurve3",this.points=t||[],this.closed=u||!1,this.curveType=m||"centripetal",this.tension=void 0!==g?g:.5}function k(t,u,m,g,E){const I=.5*(g-u),V=.5*(E-m),J=t*t;return(2*m-2*g+I+V)*(t*J)+(-3*m+3*g-2*I-V)*J+I*t+m}function M(t,u,m,g){return function(E,I){const V=1-E;return V*V*I}(t,u)+2*(1-(E=t))*E*m+function(E,I){return E*E*I}(t,g);var E}function H(t,u,m,g,E){return function(I,V){const J=1-I;return J*J*J*V}(t,u)+function(I,V){const J=1-I;return 3*J*J*I*V}(t,m)+3*(1-(I=t))*I*I*g+function(I,V){return I*I*I*V}(t,E);var I}function X(t,u,m,g){Hn.call(this),this.type="CubicBezierCurve",this.v0=t||new wn,this.v1=u||new wn,this.v2=m||new wn,this.v3=g||new wn}function oe(t,u,m,g){Hn.call(this),this.type="CubicBezierCurve3",this.v0=t||new ot,this.v1=u||new ot,this.v2=m||new ot,this.v3=g||new ot}function ne(t,u){Hn.call(this),this.type="LineCurve",this.v1=t||new wn,this.v2=u||new wn}function ge(t,u){Hn.call(this),this.type="LineCurve3",this.v1=t||new ot,this.v2=u||new ot}function we(t,u,m){Hn.call(this),this.type="QuadraticBezierCurve",this.v0=t||new wn,this.v1=u||new wn,this.v2=m||new wn}function Se(t,u,m){Hn.call(this),this.type="QuadraticBezierCurve3",this.v0=t||new ot,this.v1=u||new ot,this.v2=m||new ot}function Ce(t){Hn.call(this),this.type="SplineCurve",this.points=t||[]}(R.prototype=Object.create(Hn.prototype)).constructor=R,R.prototype.isCatmullRomCurve3=!0,R.prototype.getPoint=function(t,u){const m=u||new ot,g=this.points,E=g.length,I=(E-(this.closed?0:1))*t;let V,J,Y,Z,me=Math.floor(I),S=I-me;if(this.closed?me+=me>0?0:(Math.floor(Math.abs(me)/E)+1)*E:0===S&&me===E-1&&(me=E-2,S=1),this.closed||me>0?V=g[(me-1)%E]:(h.subVectors(g[0],g[1]).add(g[0]),V=h),J=g[me%E],Y=g[(me+1)%E],this.closed||me+2<E?Z=g[(me+2)%E]:(h.subVectors(g[E-1],g[E-2]).add(g[E-1]),Z=h),"centripetal"===this.curveType||"chordal"===this.curveType){const e="chordal"===this.curveType?.5:.25;let c=Math.pow(V.distanceToSquared(J),e),p=Math.pow(J.distanceToSquared(Y),e),_=Math.pow(Y.distanceToSquared(Z),e);p<1e-4&&(p=1),c<1e-4&&(c=p),_<1e-4&&(_=p),d.initNonuniformCatmullRom(V.x,J.x,Y.x,Z.x,c,p,_),y.initNonuniformCatmullRom(V.y,J.y,Y.y,Z.y,c,p,_),b.initNonuniformCatmullRom(V.z,J.z,Y.z,Z.z,c,p,_)}else"catmullrom"===this.curveType&&(d.initCatmullRom(V.x,J.x,Y.x,Z.x,this.tension),y.initCatmullRom(V.y,J.y,Y.y,Z.y,this.tension),b.initCatmullRom(V.z,J.z,Y.z,Z.z,this.tension));return m.set(d.calc(S),y.calc(S),b.calc(S)),m},R.prototype.copy=function(t){Hn.prototype.copy.call(this,t),this.points=[];for(let u=0,m=t.points.length;u<m;u++)this.points.push(t.points[u].clone());return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},R.prototype.toJSON=function(){const t=Hn.prototype.toJSON.call(this);t.points=[];for(let u=0,m=this.points.length;u<m;u++)t.points.push(this.points[u].toArray());return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},R.prototype.fromJSON=function(t){Hn.prototype.fromJSON.call(this,t),this.points=[];for(let u=0,m=t.points.length;u<m;u++){const g=t.points[u];this.points.push((new ot).fromArray(g))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},(X.prototype=Object.create(Hn.prototype)).constructor=X,X.prototype.isCubicBezierCurve=!0,X.prototype.getPoint=function(t,u){const m=u||new wn,g=this.v0,E=this.v1,I=this.v2,V=this.v3;return m.set(H(t,g.x,E.x,I.x,V.x),H(t,g.y,E.y,I.y,V.y)),m},X.prototype.copy=function(t){return Hn.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},X.prototype.toJSON=function(){const t=Hn.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},X.prototype.fromJSON=function(t){return Hn.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},(oe.prototype=Object.create(Hn.prototype)).constructor=oe,oe.prototype.isCubicBezierCurve3=!0,oe.prototype.getPoint=function(t,u){const m=u||new ot,g=this.v0,E=this.v1,I=this.v2,V=this.v3;return m.set(H(t,g.x,E.x,I.x,V.x),H(t,g.y,E.y,I.y,V.y),H(t,g.z,E.z,I.z,V.z)),m},oe.prototype.copy=function(t){return Hn.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},oe.prototype.toJSON=function(){const t=Hn.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},oe.prototype.fromJSON=function(t){return Hn.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},(ne.prototype=Object.create(Hn.prototype)).constructor=ne,ne.prototype.isLineCurve=!0,ne.prototype.getPoint=function(t,u){const m=u||new wn;return 1===t?m.copy(this.v2):(m.copy(this.v2).sub(this.v1),m.multiplyScalar(t).add(this.v1)),m},ne.prototype.getPointAt=function(t,u){return this.getPoint(t,u)},ne.prototype.getTangent=function(t,u){const m=u||new wn;return m.copy(this.v2).sub(this.v1).normalize(),m},ne.prototype.copy=function(t){return Hn.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},ne.prototype.toJSON=function(){const t=Hn.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},ne.prototype.fromJSON=function(t){return Hn.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},(ge.prototype=Object.create(Hn.prototype)).constructor=ge,ge.prototype.isLineCurve3=!0,ge.prototype.getPoint=function(t,u){const m=u||new ot;return 1===t?m.copy(this.v2):(m.copy(this.v2).sub(this.v1),m.multiplyScalar(t).add(this.v1)),m},ge.prototype.getPointAt=function(t,u){return this.getPoint(t,u)},ge.prototype.copy=function(t){return Hn.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},ge.prototype.toJSON=function(){const t=Hn.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},ge.prototype.fromJSON=function(t){return Hn.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},(we.prototype=Object.create(Hn.prototype)).constructor=we,we.prototype.isQuadraticBezierCurve=!0,we.prototype.getPoint=function(t,u){const m=u||new wn,g=this.v0,E=this.v1,I=this.v2;return m.set(M(t,g.x,E.x,I.x),M(t,g.y,E.y,I.y)),m},we.prototype.copy=function(t){return Hn.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},we.prototype.toJSON=function(){const t=Hn.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},we.prototype.fromJSON=function(t){return Hn.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},(Se.prototype=Object.create(Hn.prototype)).constructor=Se,Se.prototype.isQuadraticBezierCurve3=!0,Se.prototype.getPoint=function(t,u){const m=u||new ot,g=this.v0,E=this.v1,I=this.v2;return m.set(M(t,g.x,E.x,I.x),M(t,g.y,E.y,I.y),M(t,g.z,E.z,I.z)),m},Se.prototype.copy=function(t){return Hn.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Se.prototype.toJSON=function(){const t=Hn.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Se.prototype.fromJSON=function(t){return Hn.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},(Ce.prototype=Object.create(Hn.prototype)).constructor=Ce,Ce.prototype.isSplineCurve=!0,Ce.prototype.getPoint=function(t,u){const m=u||new wn,g=this.points,E=(g.length-1)*t,I=Math.floor(E),V=E-I,J=g[0===I?I:I-1],Y=g[I],Z=g[I>g.length-2?g.length-1:I+1],me=g[I>g.length-3?g.length-1:I+2];return m.set(k(V,J.x,Y.x,Z.x,me.x),k(V,J.y,Y.y,Z.y,me.y)),m},Ce.prototype.copy=function(t){Hn.prototype.copy.call(this,t),this.points=[];for(let u=0,m=t.points.length;u<m;u++)this.points.push(t.points[u].clone());return this},Ce.prototype.toJSON=function(){const t=Hn.prototype.toJSON.call(this);t.points=[];for(let u=0,m=this.points.length;u<m;u++)t.points.push(this.points[u].toArray());return t},Ce.prototype.fromJSON=function(t){Hn.prototype.fromJSON.call(this,t),this.points=[];for(let u=0,m=t.points.length;u<m;u++){const g=t.points[u];this.points.push((new wn).fromArray(g))}return this};var Pe=Object.freeze({__proto__:null,ArcCurve:a,CatmullRomCurve3:R,CubicBezierCurve:X,CubicBezierCurve3:oe,EllipseCurve:rs,LineCurve:ne,LineCurve3:ge,QuadraticBezierCurve:we,QuadraticBezierCurve3:Se,SplineCurve:Ce});function Re(){Hn.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function Oe(t){Re.call(this),this.type="Path",this.currentPoint=new wn,t&&this.setFromPoints(t)}function Ge(t){Oe.call(this,t),this.uuid=rr.generateUUID(),this.type="Shape",this.holes=[]}function ke(t,u){er.call(this),this.type="Light",this.color=new lr(t),this.intensity=void 0!==u?u:1,this.receiveShadow=void 0}function et(t,u,m){ke.call(this,t,m),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(er.DefaultUp),this.updateMatrix(),this.groundColor=new lr(u)}function rt(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new wn(512,512),this.map=null,this.mapPass=null,this.matrix=new ti,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Vc,this._frameExtents=new wn(1,1),this._viewportCount=1,this._viewports=[new gi(0,0,1,1)]}function ut(){rt.call(this,new Bs(50,1,.5,500))}function vt(t,u,m,g,E,I){ke.call(this,t,u),this.type="SpotLight",this.position.copy(er.DefaultUp),this.updateMatrix(),this.target=new er,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(V){this.intensity=V/Math.PI}}),this.distance=void 0!==m?m:0,this.angle=void 0!==g?g:Math.PI/3,this.penumbra=void 0!==E?E:0,this.decay=void 0!==I?I:1,this.shadow=new ut}function Lt(){rt.call(this,new Bs(90,1,.5,500)),this._frameExtents=new wn(4,2),this._viewportCount=6,this._viewports=[new gi(2,1,1,1),new gi(0,1,1,1),new gi(3,1,1,1),new gi(1,1,1,1),new gi(3,0,1,1),new gi(1,0,1,1)],this._cubeDirections=[new ot(1,0,0),new ot(-1,0,0),new ot(0,0,1),new ot(0,0,-1),new ot(0,1,0),new ot(0,-1,0)],this._cubeUps=[new ot(0,1,0),new ot(0,1,0),new ot(0,1,0),new ot(0,1,0),new ot(0,0,1),new ot(0,0,-1)]}function Kt(t,u,m,g){ke.call(this,t,u),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(E){this.intensity=E/(4*Math.PI)}}),this.distance=void 0!==m?m:0,this.decay=void 0!==g?g:1,this.shadow=new Lt}function zt(t,u,m,g,E,I){Mi.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=void 0!==t?t:-1,this.right=void 0!==u?u:1,this.top=void 0!==m?m:1,this.bottom=void 0!==g?g:-1,this.near=void 0!==E?E:.1,this.far=void 0!==I?I:2e3,this.updateProjectionMatrix()}function Bt(){rt.call(this,new zt(-5,5,5,-5,.5,500))}function $t(t,u){ke.call(this,t,u),this.type="DirectionalLight",this.position.copy(er.DefaultUp),this.updateMatrix(),this.target=new er,this.shadow=new Bt}function ht(t,u){ke.call(this,t,u),this.type="AmbientLight",this.castShadow=void 0}function Tt(t,u,m,g){ke.call(this,t,u),this.type="RectAreaLight",this.width=void 0!==m?m:10,this.height=void 0!==g?g:10}function Zt(){this.coefficients=[];for(let t=0;t<9;t++)this.coefficients.push(new ot)}function un(t,u){ke.call(this,void 0,u),this.type="LightProbe",this.sh=void 0!==t?t:new Zt}function Mn(t){Ci.call(this,t),this.textures={}}Re.prototype=Object.assign(Object.create(Hn.prototype),{constructor:Re,add:function(t){this.curves.push(t)},closePath:function(){const t=this.curves[0].getPoint(0),u=this.curves[this.curves.length-1].getPoint(1);t.equals(u)||this.curves.push(new ne(u,t))},getPoint:function(t){const u=t*this.getLength(),m=this.getCurveLengths();let g=0;for(;g<m.length;){if(m[g]>=u){const E=m[g]-u,I=this.curves[g],V=I.getLength();return I.getPointAt(0===V?0:1-E/V)}g++}return null},getLength:function(){const t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const t=[];let u=0;for(let m=0,g=this.curves.length;m<g;m++)u+=this.curves[m].getLength(),t.push(u);return this.cacheLengths=t,t},getSpacedPoints:function(t){void 0===t&&(t=40);const u=[];for(let m=0;m<=t;m++)u.push(this.getPoint(m/t));return this.autoClose&&u.push(u[0]),u},getPoints:function(t){t=t||12;const u=[];let m;for(let g=0,E=this.curves;g<E.length;g++){const I=E[g],J=I.getPoints(I&&I.isEllipseCurve?2*t:I&&(I.isLineCurve||I.isLineCurve3)?1:I&&I.isSplineCurve?t*I.points.length:t);for(let Y=0;Y<J.length;Y++){const Z=J[Y];m&&m.equals(Z)||(u.push(Z),m=Z)}}return this.autoClose&&u.length>1&&!u[u.length-1].equals(u[0])&&u.push(u[0]),u},copy:function(t){Hn.prototype.copy.call(this,t),this.curves=[];for(let u=0,m=t.curves.length;u<m;u++)this.curves.push(t.curves[u].clone());return this.autoClose=t.autoClose,this},toJSON:function(){const t=Hn.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(let u=0,m=this.curves.length;u<m;u++)t.curves.push(this.curves[u].toJSON());return t},fromJSON:function(t){Hn.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(let u=0,m=t.curves.length;u<m;u++){const g=t.curves[u];this.curves.push((new Pe[g.type]).fromJSON(g))}return this}}),Oe.prototype=Object.assign(Object.create(Re.prototype),{constructor:Oe,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(let u=1,m=t.length;u<m;u++)this.lineTo(t[u].x,t[u].y);return this},moveTo:function(t,u){return this.currentPoint.set(t,u),this},lineTo:function(t,u){const m=new ne(this.currentPoint.clone(),new wn(t,u));return this.curves.push(m),this.currentPoint.set(t,u),this},quadraticCurveTo:function(t,u,m,g){const E=new we(this.currentPoint.clone(),new wn(t,u),new wn(m,g));return this.curves.push(E),this.currentPoint.set(m,g),this},bezierCurveTo:function(t,u,m,g,E,I){const V=new X(this.currentPoint.clone(),new wn(t,u),new wn(m,g),new wn(E,I));return this.curves.push(V),this.currentPoint.set(E,I),this},splineThru:function(t){const u=new Ce([this.currentPoint.clone()].concat(t));return this.curves.push(u),this.currentPoint.copy(t[t.length-1]),this},arc:function(t,u,m,g,E,I){return this.absarc(t+this.currentPoint.x,u+this.currentPoint.y,m,g,E,I),this},absarc:function(t,u,m,g,E,I){return this.absellipse(t,u,m,m,g,E,I),this},ellipse:function(t,u,m,g,E,I,V,J){return this.absellipse(t+this.currentPoint.x,u+this.currentPoint.y,m,g,E,I,V,J),this},absellipse:function(t,u,m,g,E,I,V,J){const Y=new rs(t,u,m,g,E,I,V,J);if(this.curves.length>0){const me=Y.getPoint(0);me.equals(this.currentPoint)||this.lineTo(me.x,me.y)}this.curves.push(Y);const Z=Y.getPoint(1);return this.currentPoint.copy(Z),this},copy:function(t){return Re.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},toJSON:function(){const t=Re.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},fromJSON:function(t){return Re.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this}}),Ge.prototype=Object.assign(Object.create(Oe.prototype),{constructor:Ge,getPointsHoles:function(t){const u=[];for(let m=0,g=this.holes.length;m<g;m++)u[m]=this.holes[m].getPoints(t);return u},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){Oe.prototype.copy.call(this,t),this.holes=[];for(let u=0,m=t.holes.length;u<m;u++)this.holes.push(t.holes[u].clone());return this},toJSON:function(){const t=Oe.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(let u=0,m=this.holes.length;u<m;u++)t.holes.push(this.holes[u].toJSON());return t},fromJSON:function(t){Oe.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(let u=0,m=t.holes.length;u<m;u++){const g=t.holes[u];this.holes.push((new Oe).fromJSON(g))}return this}}),ke.prototype=Object.assign(Object.create(er.prototype),{constructor:ke,isLight:!0,copy:function(t){return er.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){const u=er.prototype.toJSON.call(this,t);return u.object.color=this.color.getHex(),u.object.intensity=this.intensity,void 0!==this.groundColor&&(u.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(u.object.distance=this.distance),void 0!==this.angle&&(u.object.angle=this.angle),void 0!==this.decay&&(u.object.decay=this.decay),void 0!==this.penumbra&&(u.object.penumbra=this.penumbra),void 0!==this.shadow&&(u.object.shadow=this.shadow.toJSON()),u}}),et.prototype=Object.assign(Object.create(ke.prototype),{constructor:et,isHemisphereLight:!0,copy:function(t){return ke.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),Object.assign(rt.prototype,{_projScreenMatrix:new ti,_lightPositionWorld:new ot,_lookTarget:new ot,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(t){const u=this.camera,m=this.matrix,g=this._projScreenMatrix,E=this._lookTarget,I=this._lightPositionWorld;I.setFromMatrixPosition(t.matrixWorld),u.position.copy(I),E.setFromMatrixPosition(t.target.matrixWorld),u.lookAt(E),u.updateMatrixWorld(),g.multiplyMatrices(u.projectionMatrix,u.matrixWorldInverse),this._frustum.setFromProjectionMatrix(g),m.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),m.multiply(u.projectionMatrix),m.multiply(u.matrixWorldInverse)},getViewport:function(t){return this._viewports[t]},getFrameExtents:function(){return this._frameExtents},copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){const t={};return 0!==this.bias&&(t.bias=this.bias),0!==this.normalBias&&(t.normalBias=this.normalBias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),ut.prototype=Object.assign(Object.create(rt.prototype),{constructor:ut,isSpotLightShadow:!0,updateMatrices:function(t){const u=this.camera,m=2*rr.RAD2DEG*t.angle,g=this.mapSize.width/this.mapSize.height,E=t.distance||u.far;m===u.fov&&g===u.aspect&&E===u.far||(u.fov=m,u.aspect=g,u.far=E,u.updateProjectionMatrix()),rt.prototype.updateMatrices.call(this,t)}}),vt.prototype=Object.assign(Object.create(ke.prototype),{constructor:vt,isSpotLight:!0,copy:function(t){return ke.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),Lt.prototype=Object.assign(Object.create(rt.prototype),{constructor:Lt,isPointLightShadow:!0,updateMatrices:function(t,u){void 0===u&&(u=0);const m=this.camera,g=this.matrix,E=this._lightPositionWorld,I=this._lookTarget,V=this._projScreenMatrix;E.setFromMatrixPosition(t.matrixWorld),m.position.copy(E),I.copy(m.position),I.add(this._cubeDirections[u]),m.up.copy(this._cubeUps[u]),m.lookAt(I),m.updateMatrixWorld(),g.makeTranslation(-E.x,-E.y,-E.z),V.multiplyMatrices(m.projectionMatrix,m.matrixWorldInverse),this._frustum.setFromProjectionMatrix(V)}}),Kt.prototype=Object.assign(Object.create(ke.prototype),{constructor:Kt,isPointLight:!0,copy:function(t){return ke.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),zt.prototype=Object.assign(Object.create(Mi.prototype),{constructor:zt,isOrthographicCamera:!0,copy:function(t,u){return Mi.prototype.copy.call(this,t,u),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,u,m,g,E,I){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=u,this.view.offsetX=m,this.view.offsetY=g,this.view.width=E,this.view.height=I,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){const t=(this.right-this.left)/(2*this.zoom),u=(this.top-this.bottom)/(2*this.zoom),m=(this.right+this.left)/2,g=(this.top+this.bottom)/2;let E=m-t,I=m+t,V=g+u,J=g-u;if(null!==this.view&&this.view.enabled){const Y=(this.right-this.left)/this.view.fullWidth/this.zoom,Z=(this.top-this.bottom)/this.view.fullHeight/this.zoom;E+=Y*this.view.offsetX,I=E+Y*this.view.width,V-=Z*this.view.offsetY,J=V-Z*this.view.height}this.projectionMatrix.makeOrthographic(E,I,V,J,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){const u=er.prototype.toJSON.call(this,t);return u.object.zoom=this.zoom,u.object.left=this.left,u.object.right=this.right,u.object.top=this.top,u.object.bottom=this.bottom,u.object.near=this.near,u.object.far=this.far,null!==this.view&&(u.object.view=Object.assign({},this.view)),u}}),Bt.prototype=Object.assign(Object.create(rt.prototype),{constructor:Bt,isDirectionalLightShadow:!0,updateMatrices:function(t){rt.prototype.updateMatrices.call(this,t)}}),$t.prototype=Object.assign(Object.create(ke.prototype),{constructor:$t,isDirectionalLight:!0,copy:function(t){return ke.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),ht.prototype=Object.assign(Object.create(ke.prototype),{constructor:ht,isAmbientLight:!0}),Tt.prototype=Object.assign(Object.create(ke.prototype),{constructor:Tt,isRectAreaLight:!0,copy:function(t){return ke.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},toJSON:function(t){const u=ke.prototype.toJSON.call(this,t);return u.object.width=this.width,u.object.height=this.height,u}}),Object.assign(Zt.prototype,{isSphericalHarmonics3:!0,set:function(t){for(let u=0;u<9;u++)this.coefficients[u].copy(t[u]);return this},zero:function(){for(let t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this},getAt:function(t,u){const m=t.x,g=t.y,E=t.z,I=this.coefficients;return u.copy(I[0]).multiplyScalar(.282095),u.addScaledVector(I[1],.488603*g),u.addScaledVector(I[2],.488603*E),u.addScaledVector(I[3],.488603*m),u.addScaledVector(I[4],m*g*1.092548),u.addScaledVector(I[5],g*E*1.092548),u.addScaledVector(I[6],.315392*(3*E*E-1)),u.addScaledVector(I[7],m*E*1.092548),u.addScaledVector(I[8],.546274*(m*m-g*g)),u},getIrradianceAt:function(t,u){const m=t.x,g=t.y,E=t.z,I=this.coefficients;return u.copy(I[0]).multiplyScalar(.886227),u.addScaledVector(I[1],1.023328*g),u.addScaledVector(I[2],1.023328*E),u.addScaledVector(I[3],1.023328*m),u.addScaledVector(I[4],.858086*m*g),u.addScaledVector(I[5],.858086*g*E),u.addScaledVector(I[6],.743125*E*E-.247708),u.addScaledVector(I[7],.858086*m*E),u.addScaledVector(I[8],.429043*(m*m-g*g)),u},add:function(t){for(let u=0;u<9;u++)this.coefficients[u].add(t.coefficients[u]);return this},addScaledSH:function(t,u){for(let m=0;m<9;m++)this.coefficients[m].addScaledVector(t.coefficients[m],u);return this},scale:function(t){for(let u=0;u<9;u++)this.coefficients[u].multiplyScalar(t);return this},lerp:function(t,u){for(let m=0;m<9;m++)this.coefficients[m].lerp(t.coefficients[m],u);return this},equals:function(t){for(let u=0;u<9;u++)if(!this.coefficients[u].equals(t.coefficients[u]))return!1;return!0},copy:function(t){return this.set(t.coefficients)},clone:function(){return(new this.constructor).copy(this)},fromArray:function(t,u){void 0===u&&(u=0);const m=this.coefficients;for(let g=0;g<9;g++)m[g].fromArray(t,u+3*g);return this},toArray:function(t,u){void 0===t&&(t=[]),void 0===u&&(u=0);const m=this.coefficients;for(let g=0;g<9;g++)m[g].toArray(t,u+3*g);return t}}),Object.assign(Zt,{getBasisAt:function(t,u){const m=t.x,g=t.y,E=t.z;u[0]=.282095,u[1]=.488603*g,u[2]=.488603*E,u[3]=.488603*m,u[4]=1.092548*m*g,u[5]=1.092548*g*E,u[6]=.315392*(3*E*E-1),u[7]=1.092548*m*E,u[8]=.546274*(m*m-g*g)}}),un.prototype=Object.assign(Object.create(ke.prototype),{constructor:un,isLightProbe:!0,copy:function(t){return ke.prototype.copy.call(this,t),this.sh.copy(t.sh),this},fromJSON:function(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this},toJSON:function(t){const u=ke.prototype.toJSON.call(this,t);return u.object.sh=this.sh.toArray(),u}}),Mn.prototype=Object.assign(Object.create(Ci.prototype),{constructor:Mn,load:function(t,u,m,g){const E=this,I=new tc(E.manager);I.setPath(E.path),I.setRequestHeader(E.requestHeader),I.load(t,function(V){try{u(E.parse(JSON.parse(V)))}catch(J){g?g(J):console.error(J),E.manager.itemError(t)}},m,g)},parse:function(t){const u=this.textures;function m(E){return void 0===u[E]&&console.warn("THREE.MaterialLoader: Undefined texture",E),u[E]}const g=new Fh[t.type];if(void 0!==t.uuid&&(g.uuid=t.uuid),void 0!==t.name&&(g.name=t.name),void 0!==t.color&&g.color.setHex(t.color),void 0!==t.roughness&&(g.roughness=t.roughness),void 0!==t.metalness&&(g.metalness=t.metalness),void 0!==t.sheen&&(g.sheen=(new lr).setHex(t.sheen)),void 0!==t.emissive&&g.emissive.setHex(t.emissive),void 0!==t.specular&&g.specular.setHex(t.specular),void 0!==t.shininess&&(g.shininess=t.shininess),void 0!==t.clearcoat&&(g.clearcoat=t.clearcoat),void 0!==t.clearcoatRoughness&&(g.clearcoatRoughness=t.clearcoatRoughness),void 0!==t.fog&&(g.fog=t.fog),void 0!==t.flatShading&&(g.flatShading=t.flatShading),void 0!==t.blending&&(g.blending=t.blending),void 0!==t.combine&&(g.combine=t.combine),void 0!==t.side&&(g.side=t.side),void 0!==t.opacity&&(g.opacity=t.opacity),void 0!==t.transparent&&(g.transparent=t.transparent),void 0!==t.alphaTest&&(g.alphaTest=t.alphaTest),void 0!==t.depthTest&&(g.depthTest=t.depthTest),void 0!==t.depthWrite&&(g.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(g.colorWrite=t.colorWrite),void 0!==t.stencilWrite&&(g.stencilWrite=t.stencilWrite),void 0!==t.stencilWriteMask&&(g.stencilWriteMask=t.stencilWriteMask),void 0!==t.stencilFunc&&(g.stencilFunc=t.stencilFunc),void 0!==t.stencilRef&&(g.stencilRef=t.stencilRef),void 0!==t.stencilFuncMask&&(g.stencilFuncMask=t.stencilFuncMask),void 0!==t.stencilFail&&(g.stencilFail=t.stencilFail),void 0!==t.stencilZFail&&(g.stencilZFail=t.stencilZFail),void 0!==t.stencilZPass&&(g.stencilZPass=t.stencilZPass),void 0!==t.wireframe&&(g.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(g.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(g.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(g.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(g.rotation=t.rotation),1!==t.linewidth&&(g.linewidth=t.linewidth),void 0!==t.dashSize&&(g.dashSize=t.dashSize),void 0!==t.gapSize&&(g.gapSize=t.gapSize),void 0!==t.scale&&(g.scale=t.scale),void 0!==t.polygonOffset&&(g.polygonOffset=t.polygonOffset),void 0!==t.polygonOffsetFactor&&(g.polygonOffsetFactor=t.polygonOffsetFactor),void 0!==t.polygonOffsetUnits&&(g.polygonOffsetUnits=t.polygonOffsetUnits),void 0!==t.skinning&&(g.skinning=t.skinning),void 0!==t.morphTargets&&(g.morphTargets=t.morphTargets),void 0!==t.morphNormals&&(g.morphNormals=t.morphNormals),void 0!==t.dithering&&(g.dithering=t.dithering),void 0!==t.vertexTangents&&(g.vertexTangents=t.vertexTangents),void 0!==t.visible&&(g.visible=t.visible),void 0!==t.toneMapped&&(g.toneMapped=t.toneMapped),void 0!==t.userData&&(g.userData=t.userData),void 0!==t.vertexColors&&(g.vertexColors="number"==typeof t.vertexColors?t.vertexColors>0:t.vertexColors),void 0!==t.uniforms)for(const E in t.uniforms){const I=t.uniforms[E];switch(g.uniforms[E]={},I.type){case"t":g.uniforms[E].value=m(I.value);break;case"c":g.uniforms[E].value=(new lr).setHex(I.value);break;case"v2":g.uniforms[E].value=(new wn).fromArray(I.value);break;case"v3":g.uniforms[E].value=(new ot).fromArray(I.value);break;case"v4":g.uniforms[E].value=(new gi).fromArray(I.value);break;case"m3":g.uniforms[E].value=(new jo).fromArray(I.value);case"m4":g.uniforms[E].value=(new ti).fromArray(I.value);break;default:g.uniforms[E].value=I.value}}if(void 0!==t.defines&&(g.defines=t.defines),void 0!==t.vertexShader&&(g.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(g.fragmentShader=t.fragmentShader),void 0!==t.extensions)for(const E in t.extensions)g.extensions[E]=t.extensions[E];if(void 0!==t.shading&&(g.flatShading=1===t.shading),void 0!==t.size&&(g.size=t.size),void 0!==t.sizeAttenuation&&(g.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(g.map=m(t.map)),void 0!==t.matcap&&(g.matcap=m(t.matcap)),void 0!==t.alphaMap&&(g.alphaMap=m(t.alphaMap)),void 0!==t.bumpMap&&(g.bumpMap=m(t.bumpMap)),void 0!==t.bumpScale&&(g.bumpScale=t.bumpScale),void 0!==t.normalMap&&(g.normalMap=m(t.normalMap)),void 0!==t.normalMapType&&(g.normalMapType=t.normalMapType),void 0!==t.normalScale){let E=t.normalScale;!1===Array.isArray(E)&&(E=[E,E]),g.normalScale=(new wn).fromArray(E)}return void 0!==t.displacementMap&&(g.displacementMap=m(t.displacementMap)),void 0!==t.displacementScale&&(g.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(g.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(g.roughnessMap=m(t.roughnessMap)),void 0!==t.metalnessMap&&(g.metalnessMap=m(t.metalnessMap)),void 0!==t.emissiveMap&&(g.emissiveMap=m(t.emissiveMap)),void 0!==t.emissiveIntensity&&(g.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(g.specularMap=m(t.specularMap)),void 0!==t.envMap&&(g.envMap=m(t.envMap)),void 0!==t.envMapIntensity&&(g.envMapIntensity=t.envMapIntensity),void 0!==t.reflectivity&&(g.reflectivity=t.reflectivity),void 0!==t.refractionRatio&&(g.refractionRatio=t.refractionRatio),void 0!==t.lightMap&&(g.lightMap=m(t.lightMap)),void 0!==t.lightMapIntensity&&(g.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(g.aoMap=m(t.aoMap)),void 0!==t.aoMapIntensity&&(g.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(g.gradientMap=m(t.gradientMap)),void 0!==t.clearcoatMap&&(g.clearcoatMap=m(t.clearcoatMap)),void 0!==t.clearcoatRoughnessMap&&(g.clearcoatRoughnessMap=m(t.clearcoatRoughnessMap)),void 0!==t.clearcoatNormalMap&&(g.clearcoatNormalMap=m(t.clearcoatNormalMap)),void 0!==t.clearcoatNormalScale&&(g.clearcoatNormalScale=(new wn).fromArray(t.clearcoatNormalScale)),void 0!==t.transmission&&(g.transmission=t.transmission),void 0!==t.transmissionMap&&(g.transmissionMap=m(t.transmissionMap)),g},setTextures:function(t){return this.textures=t,this}});const wr={decodeText:function(t){if(typeof TextDecoder<"u")return(new TextDecoder).decode(t);let u="";for(let m=0,g=t.length;m<g;m++)u+=String.fromCharCode(t[m]);try{return decodeURIComponent(escape(u))}catch{return u}},extractUrlBase:function(t){const u=t.lastIndexOf("/");return-1===u?"./":t.substr(0,u+1)}};function Yn(){dn.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}function On(t,u,m,g){"number"==typeof m&&(g=m,m=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),Gr.call(this,t,u,m),this.meshPerAttribute=g||1}function Kn(t){Ci.call(this,t)}Yn.prototype=Object.assign(Object.create(dn.prototype),{constructor:Yn,isInstancedBufferGeometry:!0,copy:function(t){return dn.prototype.copy.call(this,t),this.instanceCount=t.instanceCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){const t=dn.prototype.toJSON.call(this);return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}}),On.prototype=Object.assign(Object.create(Gr.prototype),{constructor:On,isInstancedBufferAttribute:!0,copy:function(t){return Gr.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},toJSON:function(){const t=Gr.prototype.toJSON.call(this);return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}),Kn.prototype=Object.assign(Object.create(Ci.prototype),{constructor:Kn,load:function(t,u,m,g){const E=this,I=new tc(E.manager);I.setPath(E.path),I.setRequestHeader(E.requestHeader),I.load(t,function(V){try{u(E.parse(JSON.parse(V)))}catch(J){g?g(J):console.error(J),E.manager.itemError(t)}},m,g)},parse:function(t){const u={},m={};function g(me,S){if(void 0!==u[S])return u[S];const e=me.interleavedBuffers[S],c=function(_,w){if(void 0!==m[w])return m[w];const O=new Uint32Array(_.arrayBuffers[w]).buffer;return m[w]=O,O}(me,e.buffer),p=new Jc(new dr[e.type](c),e.stride);return p.uuid=e.uuid,u[S]=p,p}const E=t.isInstancedBufferGeometry?new Yn:new dn,I=t.data.index;if(void 0!==I){const me=new dr[I.type](I.array);E.setIndex(new Gr(me,1))}const V=t.data.attributes;for(const me in V){const S=V[me];let e;if(S.isInterleavedBufferAttribute)e=new Fp(g(t.data,S.data),S.itemSize,S.offset,S.normalized);else{const c=new dr[S.type](S.array);e=new(S.isInstancedBufferAttribute?On:Gr)(c,S.itemSize,S.normalized)}void 0!==S.name&&(e.name=S.name),E.setAttribute(me,e)}const J=t.data.morphAttributes;if(J)for(const me in J){const S=J[me],e=[];for(let c=0,p=S.length;c<p;c++){const _=S[c];let w;w=_.isInterleavedBufferAttribute?new Fp(g(t.data,_.data),_.itemSize,_.offset,_.normalized):new Gr(new dr[_.type](_.array),_.itemSize,_.normalized),void 0!==_.name&&(w.name=_.name),e.push(w)}E.morphAttributes[me]=e}t.data.morphTargetsRelative&&(E.morphTargetsRelative=!0);const Y=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==Y)for(let me=0,S=Y.length;me!==S;++me){const e=Y[me];E.addGroup(e.start,e.count,e.materialIndex)}const Z=t.data.boundingSphere;if(void 0!==Z){const me=new ot;void 0!==Z.center&&me.fromArray(Z.center),E.boundingSphere=new zn(me,Z.radius)}return t.name&&(E.name=t.name),t.userData&&(E.userData=t.userData),E}});const dr={Int8Array,Uint8Array,Uint8ClampedArray:typeof Uint8ClampedArray<"u"?Uint8ClampedArray:Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Mr(t){Ci.call(this,t)}Mr.prototype=Object.assign(Object.create(Ci.prototype),{constructor:Mr,load:function(t,u,m,g){const E=this,I=""===this.path?wr.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||I;const V=new tc(E.manager);V.setPath(this.path),V.setRequestHeader(this.requestHeader),V.load(t,function(J){let Y=null;try{Y=JSON.parse(J)}catch(me){return void 0!==g&&g(me),void console.error("THREE:ObjectLoader: Can't parse "+t+".",me.message)}const Z=Y.metadata;void 0!==Z&&void 0!==Z.type&&"geometry"!==Z.type.toLowerCase()?E.parse(Y,u):console.error("THREE.ObjectLoader: Can't load "+t)},m,g)},parse:function(t,u){const m=this.parseShape(t.shapes),g=this.parseGeometries(t.geometries,m),E=this.parseImages(t.images,function(){void 0!==u&&u(J)}),I=this.parseTextures(t.textures,E),V=this.parseMaterials(t.materials,I),J=this.parseObject(t.object,g,V);return t.animations&&(J.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0!==u&&u(J),J},parseShape:function(t){const u={};if(void 0!==t)for(let m=0,g=t.length;m<g;m++){const E=(new Ge).fromJSON(t[m]);u[E.uuid]=E}return u},parseGeometries:function(t,u){const m={};let g;if(void 0!==t){const E=new Kn;for(let I=0,V=t.length;I<V;I++){let J;const Y=t[I];switch(Y.type){case"PlaneGeometry":case"PlaneBufferGeometry":J=new Js[Y.type](Y.width,Y.height,Y.widthSegments,Y.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":J=new Js[Y.type](Y.width,Y.height,Y.depth,Y.widthSegments,Y.heightSegments,Y.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":J=new Js[Y.type](Y.radius,Y.segments,Y.thetaStart,Y.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":J=new Js[Y.type](Y.radiusTop,Y.radiusBottom,Y.height,Y.radialSegments,Y.heightSegments,Y.openEnded,Y.thetaStart,Y.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":J=new Js[Y.type](Y.radius,Y.height,Y.radialSegments,Y.heightSegments,Y.openEnded,Y.thetaStart,Y.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":J=new Js[Y.type](Y.radius,Y.widthSegments,Y.heightSegments,Y.phiStart,Y.phiLength,Y.thetaStart,Y.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":J=new Js[Y.type](Y.radius,Y.detail);break;case"RingGeometry":case"RingBufferGeometry":J=new Js[Y.type](Y.innerRadius,Y.outerRadius,Y.thetaSegments,Y.phiSegments,Y.thetaStart,Y.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":J=new Js[Y.type](Y.radius,Y.tube,Y.radialSegments,Y.tubularSegments,Y.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":J=new Js[Y.type](Y.radius,Y.tube,Y.tubularSegments,Y.radialSegments,Y.p,Y.q);break;case"TubeGeometry":case"TubeBufferGeometry":J=new Js[Y.type]((new Pe[Y.path.type]).fromJSON(Y.path),Y.tubularSegments,Y.radius,Y.radialSegments,Y.closed);break;case"LatheGeometry":case"LatheBufferGeometry":J=new Js[Y.type](Y.points,Y.segments,Y.phiStart,Y.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":J=new Js[Y.type](Y.vertices,Y.indices,Y.radius,Y.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":g=[];for(let me=0,S=Y.shapes.length;me<S;me++)g.push(u[Y.shapes[me]]);J=new Js[Y.type](g,Y.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":g=[];for(let me=0,S=Y.shapes.length;me<S;me++)g.push(u[Y.shapes[me]]);const Z=Y.options.extrudePath;void 0!==Z&&(Y.options.extrudePath=(new Pe[Z.type]).fromJSON(Z)),J=new Js[Y.type](g,Y.options);break;case"BufferGeometry":case"InstancedBufferGeometry":J=E.parse(Y);break;case"Geometry":console.error('THREE.ObjectLoader: Loading "Geometry" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+Y.type+'"');continue}J.uuid=Y.uuid,void 0!==Y.name&&(J.name=Y.name),!0===J.isBufferGeometry&&void 0!==Y.userData&&(J.userData=Y.userData),m[Y.uuid]=J}}return m},parseMaterials:function(t,u){const m={},g={};if(void 0!==t){const E=new Mn;E.setTextures(u);for(let I=0,V=t.length;I<V;I++){const J=t[I];if("MultiMaterial"===J.type){const Y=[];for(let Z=0;Z<J.materials.length;Z++){const me=J.materials[Z];void 0===m[me.uuid]&&(m[me.uuid]=E.parse(me)),Y.push(m[me.uuid])}g[J.uuid]=Y}else void 0===m[J.uuid]&&(m[J.uuid]=E.parse(J)),g[J.uuid]=m[J.uuid]}}return g},parseAnimations:function(t){const u=[];for(let m=0;m<t.length;m++){const g=t[m],E=zs.parse(g);void 0!==g.uuid&&(E.uuid=g.uuid),u.push(E)}return u},parseImages:function(t,u){const m=this,g={};let E;function I(V){return m.manager.itemStart(V),E.load(V,function(){m.manager.itemEnd(V)},void 0,function(){m.manager.itemError(V),m.manager.itemEnd(V)})}if(void 0!==t&&t.length>0){const V=new fa(u);E=new Ol(V),E.setCrossOrigin(this.crossOrigin);for(let J=0,Y=t.length;J<Y;J++){const Z=t[J],me=Z.url;if(Array.isArray(me)){g[Z.uuid]=[];for(let S=0,e=me.length;S<e;S++){const c=me[S],p=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:m.resourcePath+c;g[Z.uuid].push(I(p))}}else{const S=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(Z.url)?Z.url:m.resourcePath+Z.url;g[Z.uuid]=I(S)}}}return g},parseTextures:function(t,u){function m(E,I){return"number"==typeof E?E:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",E),I[E])}const g={};if(void 0!==t)for(let E=0,I=t.length;E<I;E++){const V=t[E];let J;void 0===V.image&&console.warn('THREE.ObjectLoader: No "image" specified for',V.uuid),void 0===u[V.image]&&console.warn("THREE.ObjectLoader: Undefined image",V.image),J=Array.isArray(u[V.image])?new ls(u[V.image]):new ui(u[V.image]),J.needsUpdate=!0,J.uuid=V.uuid,void 0!==V.name&&(J.name=V.name),void 0!==V.mapping&&(J.mapping=m(V.mapping,di)),void 0!==V.offset&&J.offset.fromArray(V.offset),void 0!==V.repeat&&J.repeat.fromArray(V.repeat),void 0!==V.center&&J.center.fromArray(V.center),void 0!==V.rotation&&(J.rotation=V.rotation),void 0!==V.wrap&&(J.wrapS=m(V.wrap[0],so),J.wrapT=m(V.wrap[1],so)),void 0!==V.format&&(J.format=V.format),void 0!==V.type&&(J.type=V.type),void 0!==V.encoding&&(J.encoding=V.encoding),void 0!==V.minFilter&&(J.minFilter=m(V.minFilter,ao)),void 0!==V.magFilter&&(J.magFilter=m(V.magFilter,ao)),void 0!==V.anisotropy&&(J.anisotropy=V.anisotropy),void 0!==V.flipY&&(J.flipY=V.flipY),void 0!==V.premultiplyAlpha&&(J.premultiplyAlpha=V.premultiplyAlpha),void 0!==V.unpackAlignment&&(J.unpackAlignment=V.unpackAlignment),g[V.uuid]=J}return g},parseObject:function(t,u,m){let g,E,I;function V(Y){return void 0===u[Y]&&console.warn("THREE.ObjectLoader: Undefined geometry",Y),u[Y]}function J(Y){if(void 0!==Y){if(Array.isArray(Y)){const Z=[];for(let me=0,S=Y.length;me<S;me++){const e=Y[me];void 0===m[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),Z.push(m[e])}return Z}return void 0===m[Y]&&console.warn("THREE.ObjectLoader: Undefined material",Y),m[Y]}}switch(t.type){case"Scene":g=new Sl,void 0!==t.background&&Number.isInteger(t.background)&&(g.background=new lr(t.background)),void 0!==t.fog&&("Fog"===t.fog.type?g.fog=new pf(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(g.fog=new Sd(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":g=new Bs(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(g.focus=t.focus),void 0!==t.zoom&&(g.zoom=t.zoom),void 0!==t.filmGauge&&(g.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(g.filmOffset=t.filmOffset),void 0!==t.view&&(g.view=Object.assign({},t.view));break;case"OrthographicCamera":g=new zt(t.left,t.right,t.top,t.bottom,t.near,t.far),void 0!==t.zoom&&(g.zoom=t.zoom),void 0!==t.view&&(g.view=Object.assign({},t.view));break;case"AmbientLight":g=new ht(t.color,t.intensity);break;case"DirectionalLight":g=new $t(t.color,t.intensity);break;case"PointLight":g=new Kt(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":g=new Tt(t.color,t.intensity,t.width,t.height);break;case"SpotLight":g=new vt(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":g=new et(t.color,t.groundColor,t.intensity);break;case"LightProbe":g=(new un).fromJSON(t);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":E=V(t.geometry),I=J(t.material),g=new Bi(E,I);break;case"InstancedMesh":E=V(t.geometry),I=J(t.material);const Z=t.instanceMatrix;g=new Ad(E,I,t.count),g.instanceMatrix=new Gr(new Float32Array(Z.array),16);break;case"LOD":g=new ja;break;case"Line":g=new Ni(V(t.geometry),J(t.material),t.mode);break;case"LineLoop":g=new Mc(V(t.geometry),J(t.material));break;case"LineSegments":g=new Wi(V(t.geometry),J(t.material));break;case"PointCloud":case"Points":g=new wo(V(t.geometry),J(t.material));break;case"Sprite":g=new Zd(J(t.material));break;case"Group":g=new Ys;break;default:g=new er}if(g.uuid=t.uuid,void 0!==t.name&&(g.name=t.name),void 0!==t.matrix?(g.matrix.fromArray(t.matrix),void 0!==t.matrixAutoUpdate&&(g.matrixAutoUpdate=t.matrixAutoUpdate),g.matrixAutoUpdate&&g.matrix.decompose(g.position,g.quaternion,g.scale)):(void 0!==t.position&&g.position.fromArray(t.position),void 0!==t.rotation&&g.rotation.fromArray(t.rotation),void 0!==t.quaternion&&g.quaternion.fromArray(t.quaternion),void 0!==t.scale&&g.scale.fromArray(t.scale)),void 0!==t.castShadow&&(g.castShadow=t.castShadow),void 0!==t.receiveShadow&&(g.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(g.shadow.bias=t.shadow.bias),void 0!==t.shadow.normalBias&&(g.shadow.normalBias=t.shadow.normalBias),void 0!==t.shadow.radius&&(g.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&g.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(g.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(g.visible=t.visible),void 0!==t.frustumCulled&&(g.frustumCulled=t.frustumCulled),void 0!==t.renderOrder&&(g.renderOrder=t.renderOrder),void 0!==t.userData&&(g.userData=t.userData),void 0!==t.layers&&(g.layers.mask=t.layers),void 0!==t.children){const Y=t.children;for(let Z=0;Z<Y.length;Z++)g.add(this.parseObject(Y[Z],u,m))}if("LOD"===t.type){void 0!==t.autoUpdate&&(g.autoUpdate=t.autoUpdate);const Y=t.levels;for(let Z=0;Z<Y.length;Z++){const me=Y[Z],S=g.getObjectByProperty("uuid",me.object);void 0!==S&&g.addLevel(S,me.distance)}}return g}});const di={UVMapping:fi,CubeReflectionMapping:bi,CubeRefractionMapping:So,EquirectangularReflectionMapping:Gs,EquirectangularRefractionMapping:Ks,CubeUVReflectionMapping:Di,CubeUVRefractionMapping:Eo},so={RepeatWrapping:vo,ClampToEdgeWrapping:Xr,MirroredRepeatWrapping:ss},ao={NearestFilter:Or,NearestMipmapNearestFilter:Na,NearestMipmapLinearFilter:ps,LinearFilter:ii,LinearMipmapNearestFilter:Pc,LinearMipmapLinearFilter:Ya};function Do(t){typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),Ci.call(this,t),this.options={premultiplyAlpha:"none"}}function Uo(){this.type="ShapePath",this.color=new lr,this.subPaths=[],this.currentPath=null}function hs(t){this.type="Font",this.data=t}function is(t,u,m,g,E){const I=E.glyphs[t]||E.glyphs["?"];if(!I)return void console.error('THREE.Font: character "'+t+'" does not exists in font family '+E.familyName+".");const V=new Uo;let J,Y,Z,me,S,e,c,p;if(I.o){const _=I._cachedOutline||(I._cachedOutline=I.o.split(" "));for(let w=0,L=_.length;w<L;)switch(_[w++]){case"m":J=_[w++]*u+m,Y=_[w++]*u+g,V.moveTo(J,Y);break;case"l":J=_[w++]*u+m,Y=_[w++]*u+g,V.lineTo(J,Y);break;case"q":Z=_[w++]*u+m,me=_[w++]*u+g,S=_[w++]*u+m,e=_[w++]*u+g,V.quadraticCurveTo(S,e,Z,me);break;case"b":Z=_[w++]*u+m,me=_[w++]*u+g,S=_[w++]*u+m,e=_[w++]*u+g,c=_[w++]*u+m,p=_[w++]*u+g,V.bezierCurveTo(S,e,c,p,Z,me)}}return{offsetX:I.ha*u,path:V}}function Bo(t){Ci.call(this,t)}let qa;Do.prototype=Object.assign(Object.create(Ci.prototype),{constructor:Do,isImageBitmapLoader:!0,setOptions:function(t){return this.options=t,this},load:function(t,u,m,g){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);const E=this,I=Ei.get(t);if(void 0!==I)return E.manager.itemStart(t),setTimeout(function(){u&&u(I),E.manager.itemEnd(t)},0),I;fetch(t).then(function(V){return V.blob()}).then(function(V){return createImageBitmap(V,E.options)}).then(function(V){Ei.add(t,V),u&&u(V),E.manager.itemEnd(t)}).catch(function(V){g&&g(V),E.manager.itemError(t),E.manager.itemEnd(t)}),E.manager.itemStart(t)}}),Object.assign(Uo.prototype,{moveTo:function(t,u){return this.currentPath=new Oe,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,u),this},lineTo:function(t,u){return this.currentPath.lineTo(t,u),this},quadraticCurveTo:function(t,u,m,g){return this.currentPath.quadraticCurveTo(t,u,m,g),this},bezierCurveTo:function(t,u,m,g,E,I){return this.currentPath.bezierCurveTo(t,u,m,g,E,I),this},splineThru:function(t){return this.currentPath.splineThru(t),this},toShapes:function(t,u){function m(L){const O=[];for(let D=0,z=L.length;D<z;D++){const Q=L[D],ae=new Ge;ae.curves=Q.curves,O.push(ae)}return O}function g(L,O){const D=O.length;let z=!1;for(let Q=D-1,ae=0;ae<D;Q=ae++){let ie=O[Q],he=O[ae],ye=he.x-ie.x,Me=he.y-ie.y;if(Math.abs(Me)>Number.EPSILON){if(Me<0&&(ie=O[ae],ye=-ye,he=O[Q],Me=-Me),L.y<ie.y||L.y>he.y)continue;if(L.y===ie.y){if(L.x===ie.x)return!0}else{const Ne=Me*(L.x-ie.x)-ye*(L.y-ie.y);if(0===Ne)return!0;if(Ne<0)continue;z=!z}}else{if(L.y!==ie.y)continue;if(he.x<=L.x&&L.x<=ie.x||ie.x<=L.x&&L.x<=he.x)return!0}}return z}const E=$c.isClockWise,I=this.subPaths;if(0===I.length)return[];if(!0===u)return m(I);let V,J,Y,Z=[];if(1===I.length)return J=I[0],Y=new Ge,Y.curves=J.curves,Z.push(Y),Z;let me=!E(I[0].getPoints());me=t?!me:me;const S=[],e=[];let c,p,_=[],w=0;e[w]=void 0,_[w]=[];for(let L=0,O=I.length;L<O;L++)J=I[L],c=J.getPoints(),V=E(c),V=t?!V:V,V?(!me&&e[w]&&w++,e[w]={s:new Ge,p:c},e[w].s.curves=J.curves,me&&w++,_[w]=[]):_[w].push({h:J,p:c[0]});if(!e[0])return m(I);if(e.length>1){let L=!1;const O=[];for(let D=0,z=e.length;D<z;D++)S[D]=[];for(let D=0,z=e.length;D<z;D++){const Q=_[D];for(let ae=0;ae<Q.length;ae++){const ie=Q[ae];let he=!0;for(let ye=0;ye<e.length;ye++)g(ie.p,e[ye].p)&&(D!==ye&&O.push({froms:D,tos:ye,hole:ae}),he?(he=!1,S[ye].push(ie)):L=!0);he&&S[D].push(ie)}}O.length>0&&(L||(_=S))}for(let L=0,O=e.length;L<O;L++){Y=e[L].s,Z.push(Y),p=_[L];for(let D=0,z=p.length;D<z;D++)Y.holes.push(p[D].h)}return Z}}),Object.assign(hs.prototype,{isFont:!0,generateShapes:function(t,u){void 0===u&&(u=100);const m=[],g=function(E,I,V){const J=Array.from?Array.from(E):String(E).split(""),Y=I/V.resolution,Z=(V.boundingBox.yMax-V.boundingBox.yMin+V.underlineThickness)*Y,me=[];let S=0,e=0;for(let c=0;c<J.length;c++){const p=J[c];if("\n"===p)S=0,e-=Z;else{const _=is(p,Y,S,e,V);S+=_.offsetX,me.push(_.path)}}return me}(t,u,this.data);for(let E=0,I=g.length;E<I;E++)Array.prototype.push.apply(m,g[E].toShapes());return m}}),Bo.prototype=Object.assign(Object.create(Ci.prototype),{constructor:Bo,load:function(t,u,m,g){const E=this,I=new tc(this.manager);I.setPath(this.path),I.setRequestHeader(this.requestHeader),I.load(t,function(V){let J;try{J=JSON.parse(V)}catch{console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),J=JSON.parse(V.substring(65,V.length-2))}const Y=E.parse(J);u&&u(Y)},m,g)},parse:function(t){return new hs(t)}});const Ou={getContext:function(){return void 0===qa&&(qa=new(window.AudioContext||window.webkitAudioContext)),qa},setContext:function(t){qa=t}};function qp(t){Ci.call(this,t)}function cd(t,u,m){un.call(this,void 0,m);const g=(new lr).set(t),E=(new lr).set(u),I=new ot(g.r,g.g,g.b),V=new ot(E.r,E.g,E.b),J=Math.sqrt(Math.PI),Y=J*Math.sqrt(.75);this.sh.coefficients[0].copy(I).add(V).multiplyScalar(J),this.sh.coefficients[1].copy(I).sub(V).multiplyScalar(Y)}function Dh(t,u){un.call(this,void 0,u);const m=(new lr).set(t);this.sh.coefficients[0].set(m.r,m.g,m.b).multiplyScalar(2*Math.sqrt(Math.PI))}qp.prototype=Object.assign(Object.create(Ci.prototype),{constructor:qp,load:function(t,u,m,g){const E=this,I=new tc(E.manager);I.setResponseType("arraybuffer"),I.setPath(E.path),I.setRequestHeader(E.requestHeader),I.load(t,function(V){try{const J=V.slice(0);Ou.getContext().decodeAudioData(J,function(Y){u(Y)})}catch(J){g?g(J):console.error(J),E.manager.itemError(t)}},m,g)}}),cd.prototype=Object.assign(Object.create(un.prototype),{constructor:cd,isHemisphereLightProbe:!0,copy:function(t){return un.prototype.copy.call(this,t),this},toJSON:function(t){return un.prototype.toJSON.call(this,t)}}),Dh.prototype=Object.assign(Object.create(un.prototype),{constructor:Dh,isAmbientLightProbe:!0,copy:function(t){return un.prototype.copy.call(this,t),this},toJSON:function(t){return un.prototype.toJSON.call(this,t)}});const ud=new ti,hd=new ti;function au(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Bs,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Bs,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}function lu(t){this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}Object.assign(au.prototype,{update:function(t){const u=this._cache;if(u.focus!==t.focus||u.fov!==t.fov||u.aspect!==t.aspect*this.aspect||u.near!==t.near||u.far!==t.far||u.zoom!==t.zoom||u.eyeSep!==this.eyeSep){u.focus=t.focus,u.fov=t.fov,u.aspect=t.aspect*this.aspect,u.near=t.near,u.far=t.far,u.zoom=t.zoom,u.eyeSep=this.eyeSep;const m=t.projectionMatrix.clone(),g=u.eyeSep/2,E=g*u.near/u.focus,I=u.near*Math.tan(rr.DEG2RAD*u.fov*.5)/u.zoom;let V,J;hd.elements[12]=-g,ud.elements[12]=g,V=-I*u.aspect+E,J=I*u.aspect+E,m.elements[0]=2*u.near/(J-V),m.elements[8]=(J+V)/(J-V),this.cameraL.projectionMatrix.copy(m),V=-I*u.aspect-E,J=I*u.aspect-E,m.elements[0]=2*u.near/(J-V),m.elements[8]=(J+V)/(J-V),this.cameraR.projectionMatrix.copy(m)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(hd),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(ud)}}),Object.assign(lu.prototype,{start:function(){this.startTime=(typeof performance>"u"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){let t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const u=(typeof performance>"u"?Date:performance).now();t=(u-this.oldTime)/1e3,this.oldTime=u,this.elapsedTime+=t}return t}});const nc=new ot,cu=new yo,Bd=new ot,Nd=new ot;function Pf(){er.call(this),this.type="AudioListener",this.context=Ou.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new lu}function Rd(t){er.call(this),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this._startedAt=0,this._progress=0,this.filters=[]}Pf.prototype=Object.assign(Object.create(er.prototype),{constructor:Pf,getInput:function(){return this.gain},removeFilter:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(t){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this},updateMatrixWorld:function(t){er.prototype.updateMatrixWorld.call(this,t);const u=this.context.listener,m=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(nc,cu,Bd),Nd.set(0,0,-1).applyQuaternion(cu),u.positionX){const g=this.context.currentTime+this.timeDelta;u.positionX.linearRampToValueAtTime(nc.x,g),u.positionY.linearRampToValueAtTime(nc.y,g),u.positionZ.linearRampToValueAtTime(nc.z,g),u.forwardX.linearRampToValueAtTime(Nd.x,g),u.forwardY.linearRampToValueAtTime(Nd.y,g),u.forwardZ.linearRampToValueAtTime(Nd.z,g),u.upX.linearRampToValueAtTime(m.x,g),u.upY.linearRampToValueAtTime(m.y,g),u.upZ.linearRampToValueAtTime(m.z,g)}else u.setPosition(nc.x,nc.y,nc.z),u.setOrientation(Nd.x,Nd.y,Nd.z,m.x,m.y,m.z)}}),Rd.prototype=Object.assign(Object.create(er.prototype),{constructor:Rd,getOutput:function(){return this.gain},setNodeSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},setMediaElementSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this},setMediaStreamSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this},setBuffer:function(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(t){if(void 0===t&&(t=0),!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+t;const u=this.context.createBufferSource();return u.buffer=this.buffer,u.loop=this.loop,u.loopStart=this.loopStart,u.loopEnd=this.loopEnd,u.onended=this.onEnded.bind(this),u.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=u,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let t=1,u=this.filters.length;t<u;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let t=1,u=this.filters.length;t<u;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(t){return t||(t=[]),!0===this.isPlaying?(this.disconnect(),this.filters=t,this.connect()):this.filters=t,this},setDetune:function(t){if(this.detune=t,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(t){return this.setFilters(t?[t]:[])},setPlaybackRate:function(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},setLoopStart:function(t){return this.loopStart=t,this},setLoopEnd:function(t){return this.loopEnd=t,this},getVolume:function(){return this.gain.gain.value},setVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}});const pd=new ot,pm=new yo,If=new ot,Pd=new ot;function gf(t){Rd.call(this,t),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}function Of(t,u){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=void 0!==u?u:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}function dm(t,u,m){let g,E,I;switch(this.binding=t,this.valueSize=m,u){case"quaternion":g=this._slerp,E=this._slerpAdditive,I=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*m),this._workIndex=5;break;case"string":case"bool":g=this._select,E=this._select,I=this._setAdditiveIdentityOther,this.buffer=new Array(5*m);break;default:g=this._lerp,E=this._lerpAdditive,I=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*m)}this._mixBufferRegion=g,this._mixBufferRegionAdditive=E,this._setIdentity=I,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}gf.prototype=Object.assign(Object.create(Rd.prototype),{constructor:gf,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(t){return this.panner.refDistance=t,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(t){return this.panner.rolloffFactor=t,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(t){return this.panner.distanceModel=t,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(t){return this.panner.maxDistance=t,this},setDirectionalCone:function(t,u,m){return this.panner.coneInnerAngle=t,this.panner.coneOuterAngle=u,this.panner.coneOuterGain=m,this},updateMatrixWorld:function(t){if(er.prototype.updateMatrixWorld.call(this,t),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(pd,pm,If),Pd.set(0,0,1).applyQuaternion(pm);const u=this.panner;if(u.positionX){const m=this.context.currentTime+this.listener.timeDelta;u.positionX.linearRampToValueAtTime(pd.x,m),u.positionY.linearRampToValueAtTime(pd.y,m),u.positionZ.linearRampToValueAtTime(pd.z,m),u.orientationX.linearRampToValueAtTime(Pd.x,m),u.orientationY.linearRampToValueAtTime(Pd.y,m),u.orientationZ.linearRampToValueAtTime(Pd.z,m)}else u.setPosition(pd.x,pd.y,pd.z),u.setOrientation(Pd.x,Pd.y,Pd.z)}}),Object.assign(Of.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){let t=0;const u=this.getFrequencyData();for(let m=0;m<u.length;m++)t+=u[m];return t/u.length}}),Object.assign(dm.prototype,{accumulate:function(t,u){const m=this.buffer,g=this.valueSize,E=t*g+g;let I=this.cumulativeWeight;if(0===I){for(let V=0;V!==g;++V)m[E+V]=m[V];I=u}else I+=u,this._mixBufferRegion(m,E,0,u/I,g);this.cumulativeWeight=I},accumulateAdditive:function(t){const u=this.buffer,m=this.valueSize,g=m*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(u,g,0,t,m),this.cumulativeWeightAdditive+=t},apply:function(t){const u=this.valueSize,m=this.buffer,g=t*u+u,E=this.cumulativeWeight,I=this.cumulativeWeightAdditive,V=this.binding;this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,E<1&&this._mixBufferRegion(m,g,u*this._origIndex,1-E,u),I>0&&this._mixBufferRegionAdditive(m,g,this._addIndex*u,1,u);for(let J=u,Y=u+u;J!==Y;++J)if(m[J]!==m[J+u]){V.setValue(m,g);break}},saveOriginalState:function(){const u=this.buffer,m=this.valueSize,g=m*this._origIndex;this.binding.getValue(u,g);for(let E=m,I=g;E!==I;++E)u[E]=u[g+E%m];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0},restoreOriginalState:function(){this.binding.setValue(this.buffer,3*this.valueSize)},_setAdditiveIdentityNumeric:function(){const t=this._addIndex*this.valueSize,u=t+this.valueSize;for(let m=t;m<u;m++)this.buffer[m]=0},_setAdditiveIdentityQuaternion:function(){this._setAdditiveIdentityNumeric(),this.buffer[4*this._addIndex+3]=1},_setAdditiveIdentityOther:function(){const t=this._origIndex*this.valueSize,u=this._addIndex*this.valueSize;for(let m=0;m<this.valueSize;m++)this.buffer[u+m]=this.buffer[t+m]},_select:function(t,u,m,g,E){if(g>=.5)for(let I=0;I!==E;++I)t[u+I]=t[m+I]},_slerp:function(t,u,m,g){yo.slerpFlat(t,u,t,u,t,m,g)},_slerpAdditive:function(t,u,m,g,E){const I=this._workIndex*E;yo.multiplyQuaternionsFlat(t,I,t,u,t,m),yo.slerpFlat(t,u,t,u,t,I,g)},_lerp:function(t,u,m,g,E){const I=1-g;for(let V=0;V!==E;++V){const J=u+V;t[J]=t[J]*I+t[m+V]*g}},_lerpAdditive:function(t,u,m,g,E){for(let I=0;I!==E;++I){const V=u+I;t[V]=t[V]+t[m+I]*g}}});const Um="\\[\\]\\.:\\/",y_=new RegExp("["+Um+"]","g"),fm="[^"+Um+"]",t_="[^"+Um.replace("\\.","")+"]",n_=/((?:WC+[\/:])*)/.source.replace("WC",fm),r_=/(WCOD+)?/.source.replace("WCOD",t_),zm=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",fm),b_=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",fm),x_=new RegExp("^"+n_+r_+zm+b_+"$"),mm=["material","materials","bones"];function _m(t,u,m){const g=m||rc.parseTrackName(u);this._targetGroup=t,this._bindings=t.subscribe_(u,g)}function rc(t,u,m){this.path=u,this.parsedPath=m||rc.parseTrackName(u),this.node=rc.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function jm(){this.uuid=rr.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const t={};this._indicesByUUID=t;for(let m=0,g=arguments.length;m!==g;++m)t[arguments[m].uuid]=m;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const u=this;this.stats={objects:{get total(){return u._objects.length},get inUse(){return this.total-u.nCachedObjects_}},get bindingsPerObject(){return u._bindings.length}}}function Gm(t,u,m,g){this._mixer=t,this._clip=u,this._localRoot=m||null,this.blendMode=g||u.blendMode;const E=u.tracks,I=E.length,V=new Array(I),J={endingStart:va,endingEnd:va};for(let Y=0;Y!==I;++Y){const Z=E[Y].createInterpolant(null);V[Y]=Z,Z.settings=J}this._interpolantSettings=J,this._interpolants=V,this._propertyBindings=new Array(I),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Pa,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function gm(t){this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function kf(t){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}function Hm(t,u,m){Jc.call(this,t,u),this.meshPerAttribute=m||1}function vm(t,u,m,g){this.ray=new co(t,u),this.near=m||0,this.far=g||1/0,this.camera=null,this.layers=new yu,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Vm(t,u){return t.distance-u.distance}function dd(t,u,m,g){if(t.layers.test(u.layers)&&t.raycast(u,m),!0===g){const E=t.children;for(let I=0,V=E.length;I<V;I++)dd(E[I],u,m,!0)}}Object.assign(_m.prototype,{getValue:function(t,u){this.bind();const g=this._bindings[this._targetGroup.nCachedObjects_];void 0!==g&&g.getValue(t,u)},setValue:function(t,u){const m=this._bindings;for(let g=this._targetGroup.nCachedObjects_,E=m.length;g!==E;++g)m[g].setValue(t,u)},bind:function(){const t=this._bindings;for(let u=this._targetGroup.nCachedObjects_,m=t.length;u!==m;++u)t[u].bind()},unbind:function(){const t=this._bindings;for(let u=this._targetGroup.nCachedObjects_,m=t.length;u!==m;++u)t[u].unbind()}}),Object.assign(rc,{Composite:_m,create:function(t,u,m){return t&&t.isAnimationObjectGroup?new rc.Composite(t,u,m):new rc(t,u,m)},sanitizeNodeName:function(t){return t.replace(/\s/g,"_").replace(y_,"")},parseTrackName:function(t){const u=x_.exec(t);if(!u)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const m={nodeName:u[2],objectName:u[3],objectIndex:u[4],propertyName:u[5],propertyIndex:u[6]},g=m.nodeName&&m.nodeName.lastIndexOf(".");if(void 0!==g&&-1!==g){const E=m.nodeName.substring(g+1);-1!==mm.indexOf(E)&&(m.nodeName=m.nodeName.substring(0,g),m.objectName=E)}if(null===m.propertyName||0===m.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return m},findNode:function(t,u){if(!u||""===u||"."===u||-1===u||u===t.name||u===t.uuid)return t;if(t.skeleton){const m=t.skeleton.getBoneByName(u);if(void 0!==m)return m}if(t.children){const m=function(E){for(let I=0;I<E.length;I++){const V=E[I];if(V.name===u||V.uuid===u)return V;const J=m(V.children);if(J)return J}return null},g=m(t.children);if(g)return g}return null}}),Object.assign(rc.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,u){t[u]=this.node[this.propertyName]},function(t,u){const m=this.resolvedProperty;for(let g=0,E=m.length;g!==E;++g)t[u++]=m[g]},function(t,u){t[u]=this.resolvedProperty[this.propertyIndex]},function(t,u){this.resolvedProperty.toArray(t,u)}],SetterByBindingTypeAndVersioning:[[function(t,u){this.targetObject[this.propertyName]=t[u]},function(t,u){this.targetObject[this.propertyName]=t[u],this.targetObject.needsUpdate=!0},function(t,u){this.targetObject[this.propertyName]=t[u],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,u){const m=this.resolvedProperty;for(let g=0,E=m.length;g!==E;++g)m[g]=t[u++]},function(t,u){const m=this.resolvedProperty;for(let g=0,E=m.length;g!==E;++g)m[g]=t[u++];this.targetObject.needsUpdate=!0},function(t,u){const m=this.resolvedProperty;for(let g=0,E=m.length;g!==E;++g)m[g]=t[u++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,u){this.resolvedProperty[this.propertyIndex]=t[u]},function(t,u){this.resolvedProperty[this.propertyIndex]=t[u],this.targetObject.needsUpdate=!0},function(t,u){this.resolvedProperty[this.propertyIndex]=t[u],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,u){this.resolvedProperty.fromArray(t,u)},function(t,u){this.resolvedProperty.fromArray(t,u),this.targetObject.needsUpdate=!0},function(t,u){this.resolvedProperty.fromArray(t,u),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,u){this.bind(),this.getValue(t,u)},setValue:function(t,u){this.bind(),this.setValue(t,u)},bind:function(){let t=this.node,u=this.parsedPath,m=u.objectName,g=u.propertyName,E=u.propertyIndex;if(t||(t=rc.findNode(this.rootNode,u.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(m){let Y=u.objectIndex;switch(m){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(let Z=0;Z<t.length;Z++)if(t[Z].name===Y){Y=Z;break}break;default:if(void 0===t[m])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[m]}if(void 0!==Y){if(void 0===t[Y])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[Y]}}const I=t[g];if(void 0===I)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+u.nodeName+"."+g+" but it wasn't found.",t);let V=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?V=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(V=this.Versioning.MatrixWorldNeedsUpdate);let J=this.BindingType.Direct;if(void 0!==E){if("morphTargetInfluences"===g){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[E]&&(E=t.morphTargetDictionary[E])}J=this.BindingType.ArrayElement,this.resolvedProperty=I,this.propertyIndex=E}else void 0!==I.fromArray&&void 0!==I.toArray?(J=this.BindingType.HasFromToArray,this.resolvedProperty=I):Array.isArray(I)?(J=this.BindingType.EntireArray,this.resolvedProperty=I):this.propertyName=g;this.getValue=this.GetterByBindingType[J],this.setValue=this.SetterByBindingTypeAndVersioning[J][V]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(rc.prototype,{_getValue_unbound:rc.prototype.getValue,_setValue_unbound:rc.prototype.setValue}),Object.assign(jm.prototype,{isAnimationObjectGroup:!0,add:function(){const t=this._objects,u=this._indicesByUUID,m=this._paths,g=this._parsedPaths,E=this._bindings,I=E.length;let V,J=t.length,Y=this.nCachedObjects_;for(let Z=0,me=arguments.length;Z!==me;++Z){const S=arguments[Z],e=S.uuid;let c=u[e];if(void 0===c){c=J++,u[e]=c,t.push(S);for(let p=0,_=I;p!==_;++p)E[p].push(new rc(S,m[p],g[p]))}else if(c<Y){V=t[c];const p=--Y,_=t[p];u[_.uuid]=c,t[c]=_,u[e]=p,t[p]=S;for(let w=0,L=I;w!==L;++w){const O=E[w];let z=O[c];O[c]=O[p],void 0===z&&(z=new rc(S,m[w],g[w])),O[p]=z}}else t[c]!==V&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=Y},remove:function(){const t=this._objects,u=this._indicesByUUID,m=this._bindings,g=m.length;let E=this.nCachedObjects_;for(let I=0,V=arguments.length;I!==V;++I){const J=arguments[I],Y=J.uuid,Z=u[Y];if(void 0!==Z&&Z>=E){const me=E++,S=t[me];u[S.uuid]=Z,t[Z]=S,u[Y]=me,t[me]=J;for(let e=0,c=g;e!==c;++e){const p=m[e],w=p[Z];p[Z]=p[me],p[me]=w}}}this.nCachedObjects_=E},uncache:function(){const t=this._objects,u=this._indicesByUUID,m=this._bindings,g=m.length;let E=this.nCachedObjects_,I=t.length;for(let V=0,J=arguments.length;V!==J;++V){const Y=arguments[V].uuid,Z=u[Y];if(void 0!==Z)if(delete u[Y],Z<E){const me=--E,S=t[me],e=--I,c=t[e];u[S.uuid]=Z,t[Z]=S,u[c.uuid]=me,t[me]=c,t.pop();for(let p=0,_=g;p!==_;++p){const w=m[p],O=w[e];w[Z]=w[me],w[me]=O,w.pop()}}else{const me=--I,S=t[me];u[S.uuid]=Z,t[Z]=S,t.pop();for(let e=0,c=g;e!==c;++e){const p=m[e];p[Z]=p[me],p.pop()}}}this.nCachedObjects_=E},subscribe_:function(t,u){let m=this._bindingsIndicesByPath,g=m[t],E=this._bindings;if(void 0!==g)return E[g];const I=this._paths,V=this._parsedPaths,J=this._objects,Z=this.nCachedObjects_,me=new Array(J.length);g=E.length,m[t]=g,I.push(t),V.push(u),E.push(me);for(let S=Z,e=J.length;S!==e;++S)me[S]=new rc(J[S],t,u);return me},unsubscribe_:function(t){const u=this._bindingsIndicesByPath,m=u[t];if(void 0!==m){const g=this._paths,E=this._parsedPaths,I=this._bindings,V=I.length-1,J=I[V];u[t[V]]=m,I[m]=J,I.pop(),E[m]=E[V],E.pop(),g[m]=g[V],g.pop()}}}),Object.assign(Gm.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,u){return this.loop=t,this.repetitions=u,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,u,m){if(t.fadeOut(u),this.fadeIn(u),m){const g=this._clip.duration,E=t._clip.duration,V=g/E;t.warp(1,E/g,u),this.warp(V,1,u)}return this},crossFadeTo:function(t,u,m){return t.crossFadeFrom(this,u,m)},stopFading:function(){let t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,u,m){const g=this._mixer,E=g.time,I=this.timeScale;let V=this._timeScaleInterpolant;null===V&&(V=g._lendControlInterpolant(),this._timeScaleInterpolant=V);const J=V.parameterPositions,Y=V.sampleValues;return J[0]=E,J[1]=E+m,Y[0]=t/I,Y[1]=u/I,this},stopWarping:function(){let t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,u,m,g){if(!this.enabled)return void this._updateWeight(t);const E=this._startTime;if(null!==E){const J=(t-E)*m;if(J<0||0===m)return;this._startTime=null,u=m*J}u*=this._updateTimeScale(t);const I=this._updateTime(u),V=this._updateWeight(t);if(V>0){const J=this._interpolants,Y=this._propertyBindings;if(this.blendMode===Yu)for(let Z=0,me=J.length;Z!==me;++Z)J[Z].evaluate(I),Y[Z].accumulateAdditive(V);else for(let Z=0,me=J.length;Z!==me;++Z)J[Z].evaluate(I),Y[Z].accumulate(g,V)}},_updateWeight:function(t){let u=0;if(this.enabled){u=this.weight;const m=this._weightInterpolant;if(null!==m){const g=m.evaluate(t)[0];u*=g,t>m.parameterPositions[1]&&(this.stopFading(),0===g&&(this.enabled=!1))}}return this._effectiveWeight=u,u},_updateTimeScale:function(t){let u=0;if(!this.paused){u=this.timeScale;const m=this._timeScaleInterpolant;null!==m&&(u*=m.evaluate(t)[0],t>m.parameterPositions[1]&&(this.stopWarping(),0===u?this.paused=!0:this.timeScale=u))}return this._effectiveTimeScale=u,u},_updateTime:function(t){const u=this._clip.duration,m=this.loop;let g=this.time+t,E=this._loopCount;const I=m===lc;if(0===t)return-1===E||!I||1&~E?g:u-g;if(m===_u){-1===E&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(g>=u)g=u;else{if(!(g<0)){this.time=g;break e}g=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=g,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(-1===E&&(t>=0?(E=0,this._setEndings(!0,0===this.repetitions,I)):this._setEndings(0===this.repetitions,!0,I)),g>=u||g<0){const V=Math.floor(g/u);g-=u*V,E+=Math.abs(V);const J=this.repetitions-E;if(J<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,g=t>0?u:0,this.time=g,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(1===J){const Y=t<0;this._setEndings(Y,!Y,I)}else this._setEndings(!1,!1,I);this._loopCount=E,this.time=g,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:V})}}else this.time=g;if(I&&!(1&~E))return u-g}return g},_setEndings:function(t,u,m){const g=this._interpolantSettings;m?(g.endingStart=ta,g.endingEnd=ta):(g.endingStart=t?this.zeroSlopeAtStart?ta:va:xl,g.endingEnd=u?this.zeroSlopeAtEnd?ta:va:xl)},_scheduleFading:function(t,u,m){const g=this._mixer,E=g.time;let I=this._weightInterpolant;null===I&&(I=g._lendControlInterpolant(),this._weightInterpolant=I);const V=I.parameterPositions,J=I.sampleValues;return V[0]=E,J[0]=u,V[1]=E+t,J[1]=m,this}}),gm.prototype=Object.assign(Object.create(ia.prototype),{constructor:gm,_bindAction:function(t,u){const m=t._localRoot||this._root,g=t._clip.tracks,E=g.length,I=t._propertyBindings,V=t._interpolants,J=m.uuid,Y=this._bindingsByRootAndName;let Z=Y[J];void 0===Z&&(Z={},Y[J]=Z);for(let me=0;me!==E;++me){const S=g[me],e=S.name;let c=Z[e];if(void 0!==c)I[me]=c;else{if(c=I[me],void 0!==c){null===c._cacheIndex&&(++c.referenceCount,this._addInactiveBinding(c,J,e));continue}c=new dm(rc.create(m,e,u&&u._propertyBindings[me].binding.parsedPath),S.ValueTypeName,S.getValueSize()),++c.referenceCount,this._addInactiveBinding(c,J,e),I[me]=c}V[me].resultBuffer=c.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){const m=(t._localRoot||this._root).uuid,g=t._clip.uuid,E=this._actionsByClip[g];this._bindAction(t,E&&E.knownActions[0]),this._addInactiveAction(t,g,m)}const u=t._propertyBindings;for(let m=0,g=u.length;m!==g;++m){const E=u[m];0==E.useCount++&&(this._lendBinding(E),E.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){const u=t._propertyBindings;for(let m=0,g=u.length;m!==g;++m){const E=u[m];0==--E.useCount&&(E.restoreOriginalState(),this._takeBackBinding(E))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){const u=t._cacheIndex;return null!==u&&u<this._nActiveActions},_addInactiveAction:function(t,u,m){const g=this._actions,E=this._actionsByClip;let I=E[u];if(void 0===I)I={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,E[u]=I;else{const V=I.knownActions;t._byClipCacheIndex=V.length,V.push(t)}t._cacheIndex=g.length,g.push(t),I.actionByRoot[m]=t},_removeInactiveAction:function(t){const u=this._actions,m=u[u.length-1],g=t._cacheIndex;m._cacheIndex=g,u[g]=m,u.pop(),t._cacheIndex=null;const E=t._clip.uuid,I=this._actionsByClip,V=I[E],J=V.knownActions,Y=J[J.length-1],Z=t._byClipCacheIndex;Y._byClipCacheIndex=Z,J[Z]=Y,J.pop(),t._byClipCacheIndex=null,delete V.actionByRoot[(t._localRoot||this._root).uuid],0===J.length&&delete I[E],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){const u=t._propertyBindings;for(let m=0,g=u.length;m!==g;++m){const E=u[m];0==--E.referenceCount&&this._removeInactiveBinding(E)}},_lendAction:function(t){const u=this._actions,m=t._cacheIndex,g=this._nActiveActions++,E=u[g];t._cacheIndex=g,u[g]=t,E._cacheIndex=m,u[m]=E},_takeBackAction:function(t){const u=this._actions,m=t._cacheIndex,g=--this._nActiveActions,E=u[g];t._cacheIndex=g,u[g]=t,E._cacheIndex=m,u[m]=E},_addInactiveBinding:function(t,u,m){const g=this._bindingsByRootAndName,E=this._bindings;let I=g[u];void 0===I&&(I={},g[u]=I),I[m]=t,t._cacheIndex=E.length,E.push(t)},_removeInactiveBinding:function(t){const u=this._bindings,m=t.binding,g=m.rootNode.uuid,E=m.path,I=this._bindingsByRootAndName,V=I[g],J=u[u.length-1],Y=t._cacheIndex;J._cacheIndex=Y,u[Y]=J,u.pop(),delete V[E],0===Object.keys(V).length&&delete I[g]},_lendBinding:function(t){const u=this._bindings,m=t._cacheIndex,g=this._nActiveBindings++,E=u[g];t._cacheIndex=g,u[g]=t,E._cacheIndex=m,u[m]=E},_takeBackBinding:function(t){const u=this._bindings,m=t._cacheIndex,g=--this._nActiveBindings,E=u[g];t._cacheIndex=g,u[g]=t,E._cacheIndex=m,u[m]=E},_lendControlInterpolant:function(){const t=this._controlInterpolants,u=this._nActiveControlInterpolants++;let m=t[u];return void 0===m&&(m=new Wa(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),m.__cacheIndex=u,t[u]=m),m},_takeBackControlInterpolant:function(t){const u=this._controlInterpolants,m=t.__cacheIndex,g=--this._nActiveControlInterpolants,E=u[g];t.__cacheIndex=g,u[g]=t,E.__cacheIndex=m,u[m]=E},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,u,m){const g=u||this._root,E=g.uuid;let I="string"==typeof t?zs.findByName(g,t):t;const V=null!==I?I.uuid:t;let J=this._actionsByClip[V],Y=null;if(void 0===m&&(m=null!==I?I.blendMode:Xu),void 0!==J){const me=J.actionByRoot[E];if(void 0!==me&&me.blendMode===m)return me;Y=J.knownActions[0],null===I&&(I=Y._clip)}if(null===I)return null;const Z=new Gm(this,I,u,m);return this._bindAction(Z,Y),this._addInactiveAction(Z,V,E),Z},existingAction:function(t,u){const m=u||this._root,g=m.uuid,E="string"==typeof t?zs.findByName(m,t):t,V=this._actionsByClip[E?E.uuid:t];return void 0!==V&&V.actionByRoot[g]||null},stopAllAction:function(){const t=this._actions;for(let u=this._nActiveActions-1;u>=0;--u)t[u].stop();return this},update:function(t){const u=this._actions,m=this._nActiveActions,g=this.time+=t*=this.timeScale,E=Math.sign(t),I=this._accuIndex^=1;for(let Y=0;Y!==m;++Y)u[Y]._update(g,t,E,I);const V=this._bindings,J=this._nActiveBindings;for(let Y=0;Y!==J;++Y)V[Y].apply(I);return this},setTime:function(t){this.time=0;for(let u=0;u<this._actions.length;u++)this._actions[u].time=0;return this.update(t)},getRoot:function(){return this._root},uncacheClip:function(t){const u=this._actions,m=t.uuid,g=this._actionsByClip,E=g[m];if(void 0!==E){const I=E.knownActions;for(let V=0,J=I.length;V!==J;++V){const Y=I[V];this._deactivateAction(Y);const Z=Y._cacheIndex,me=u[u.length-1];Y._cacheIndex=null,Y._byClipCacheIndex=null,me._cacheIndex=Z,u[Z]=me,u.pop(),this._removeInactiveBindingsForAction(Y)}delete g[m]}},uncacheRoot:function(t){const u=t.uuid,m=this._actionsByClip;for(const E in m){const I=m[E].actionByRoot[u];void 0!==I&&(this._deactivateAction(I),this._removeInactiveAction(I))}const g=this._bindingsByRootAndName[u];if(void 0!==g)for(const E in g){const I=g[E];I.restoreOriginalState(),this._removeInactiveBinding(I)}},uncacheAction:function(t,u){const m=this.existingAction(t,u);null!==m&&(this._deactivateAction(m),this._removeInactiveAction(m))}}),kf.prototype.clone=function(){return new kf(void 0===this.value.clone?this.value:this.value.clone())},Hm.prototype=Object.assign(Object.create(Jc.prototype),{constructor:Hm,isInstancedInterleavedBuffer:!0,copy:function(t){return Jc.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},clone:function(t){const u=Jc.prototype.clone.call(this,t);return u.meshPerAttribute=this.meshPerAttribute,u},toJSON:function(t){const u=Jc.prototype.toJSON.call(this,t);return u.isInstancedInterleavedBuffer=!0,u.meshPerAttribute=this.meshPerAttribute,u}}),Object.assign(vm.prototype,{set:function(t,u){this.ray.set(t,u)},setFromCamera:function(t,u){u&&u.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(u.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(u).sub(this.ray.origin).normalize(),this.camera=u):u&&u.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(u.near+u.far)/(u.near-u.far)).unproject(u),this.ray.direction.set(0,0,-1).transformDirection(u.matrixWorld),this.camera=u):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,u,m){const g=m||[];return dd(t,this,g,u),g.sort(Vm),g},intersectObjects:function(t,u,m){const g=m||[];if(!1===Array.isArray(t))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),g;for(let E=0,I=t.length;E<I;E++)dd(t[E],this,g,u);return g.sort(Vm),g}});class i_{constructor(u=1,m=0,g=0){return this.radius=u,this.phi=m,this.theta=g,this}set(u,m,g){return this.radius=u,this.phi=m,this.theta=g,this}clone(){return(new this.constructor).copy(this)}copy(u){return this.radius=u.radius,this.phi=u.phi,this.theta=u.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(u){return this.setFromCartesianCoords(u.x,u.y,u.z)}setFromCartesianCoords(u,m,g){return this.radius=Math.sqrt(u*u+m*m+g*g),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(u,g),this.phi=Math.acos(rr.clamp(m/this.radius,-1,1))),this}}function o_(t,u,m){return this.radius=void 0!==t?t:1,this.theta=void 0!==u?u:0,this.y=void 0!==m?m:0,this}Object.assign(o_.prototype,{set:function(t,u,m){return this.radius=t,this.theta=u,this.y=m,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,u,m){return this.radius=Math.sqrt(t*t+m*m),this.theta=Math.atan2(t,m),this.y=u,this}});const Id=new wn;function Wm(t,u){this.min=void 0!==t?t:new wn(1/0,1/0),this.max=void 0!==u?u:new wn(-1/0,-1/0)}Object.assign(Wm.prototype,{set:function(t,u){return this.min.copy(t),this.max.copy(u),this},setFromPoints:function(t){this.makeEmpty();for(let u=0,m=t.length;u<m;u++)this.expandByPoint(t[u]);return this},setFromCenterAndSize:function(t,u){const m=Id.copy(u).multiplyScalar(.5);return this.min.copy(t).sub(m),this.max.copy(t).add(m),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box2: .getCenter() target is now required"),t=new wn),this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box2: .getSize() target is now required"),t=new wn),this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,u){return void 0===u&&(console.warn("THREE.Box2: .getParameter() target is now required"),u=new wn),u.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,u){return void 0===u&&(console.warn("THREE.Box2: .clampPoint() target is now required"),u=new wn),u.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return Id.copy(t).clamp(this.min,this.max).sub(t).length()},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}});const ym=new ot,Xp=new ot;function bm(t,u){this.start=void 0!==t?t:new ot,this.end=void 0!==u?u:new ot}function Ff(t){er.call(this),this.material=t,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}Object.assign(bm.prototype,{set:function(t,u){return this.start.copy(t),this.end.copy(u),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},getCenter:function(t){return void 0===t&&(console.warn("THREE.Line3: .getCenter() target is now required"),t=new ot),t.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){return void 0===t&&(console.warn("THREE.Line3: .delta() target is now required"),t=new ot),t.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,u){return void 0===u&&(console.warn("THREE.Line3: .at() target is now required"),u=new ot),this.delta(u).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(t,u){ym.subVectors(t,this.start),Xp.subVectors(this.end,this.start);const m=Xp.dot(Xp);let g=Xp.dot(ym)/m;return u&&(g=rr.clamp(g,0,1)),g},closestPointToPoint:function(t,u,m){const g=this.closestPointToPointParameter(t,u);return void 0===m&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),m=new ot),this.delta(m).multiplyScalar(g).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}}),(Ff.prototype=Object.create(er.prototype)).constructor=Ff,Ff.prototype.isImmediateRenderObject=!0;const Od=new ot;function vf(t,u){er.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=u;const m=new dn,g=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let I=0,V=1,J=32;I<J;I++,V++){const Y=I/J*Math.PI*2,Z=V/J*Math.PI*2;g.push(Math.cos(Y),Math.sin(Y),1,Math.cos(Z),Math.sin(Z),1)}m.setAttribute("position",new Fn(g,3));const E=new Qn({fog:!1,toneMapped:!1});this.cone=new Wi(m,E),this.add(this.cone),this.update()}(vf.prototype=Object.create(er.prototype)).constructor=vf,vf.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},vf.prototype.update=function(){this.light.updateMatrixWorld();const t=this.light.distance?this.light.distance:1e3,u=t*Math.tan(this.light.angle);this.cone.scale.set(u,u,t),Od.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Od),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)};const fd=new ot,Df=new ti,Uf=new ti;function s_(t){const u=[];t&&t.isBone&&u.push(t);for(let m=0;m<t.children.length;m++)u.push.apply(u,s_(t.children[m]));return u}function md(t){const u=s_(t),m=new dn,g=[],E=[],I=new lr(0,0,1),V=new lr(0,1,0);for(let Y=0;Y<u.length;Y++){const Z=u[Y];Z.parent&&Z.parent.isBone&&(g.push(0,0,0),g.push(0,0,0),E.push(I.r,I.g,I.b),E.push(V.r,V.g,V.b))}m.setAttribute("position",new Fn(g,3)),m.setAttribute("color",new Fn(E,3));const J=new Qn({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});Wi.call(this,m,J),this.type="SkeletonHelper",this.root=t,this.bones=u,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}function yf(t,u,m){this.light=t,this.light.updateMatrixWorld(),this.color=m;const g=new Hr(u,4,2),E=new eo({wireframe:!0,fog:!1,toneMapped:!1});Bi.call(this,g,E),this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}(md.prototype=Object.create(Wi.prototype)).constructor=md,md.prototype.isSkeletonHelper=!0,md.prototype.updateMatrixWorld=function(t){const u=this.bones,m=this.geometry,g=m.getAttribute("position");Uf.getInverse(this.root.matrixWorld);for(let E=0,I=0;E<u.length;E++){const V=u[E];V.parent&&V.parent.isBone&&(Df.multiplyMatrices(Uf,V.matrixWorld),fd.setFromMatrixPosition(Df),g.setXYZ(I,fd.x,fd.y,fd.z),Df.multiplyMatrices(Uf,V.parent.matrixWorld),fd.setFromMatrixPosition(Df),g.setXYZ(I+1,fd.x,fd.y,fd.z),I+=2)}m.getAttribute("position").needsUpdate=!0,er.prototype.updateMatrixWorld.call(this,t)},(yf.prototype=Object.create(Bi.prototype)).constructor=yf,yf.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},yf.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)};const w_=new ot,a_=new lr,l_=new lr;function bf(t,u,m){er.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=m;const g=new uh(u);g.rotateY(.5*Math.PI),this.material=new eo({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);const E=g.getAttribute("position"),I=new Float32Array(3*E.count);g.setAttribute("color",new Gr(I,3)),this.add(new Bi(g,this.material)),this.update()}function zf(t,u,m,g){t=t||10,u=u||10,m=new lr(void 0!==m?m:4473924),g=new lr(void 0!==g?g:8947848);const E=u/2,I=t/u,V=t/2,J=[],Y=[];for(let S=0,e=0,c=-V;S<=u;S++,c+=I){J.push(-V,0,c,V,0,c),J.push(c,0,-V,c,0,V);const p=S===E?m:g;p.toArray(Y,e),e+=3,p.toArray(Y,e),e+=3,p.toArray(Y,e),e+=3,p.toArray(Y,e),e+=3}const Z=new dn;Z.setAttribute("position",new Fn(J,3)),Z.setAttribute("color",new Fn(Y,3));const me=new Qn({vertexColors:!0,toneMapped:!1});Wi.call(this,Z,me),this.type="GridHelper"}function xm(t,u,m,g,E,I){t=t||10,u=u||16,m=m||8,g=g||64,E=new lr(void 0!==E?E:4473924),I=new lr(void 0!==I?I:8947848);const V=[],J=[];for(let me=0;me<=u;me++){const S=me/u*(2*Math.PI),e=Math.sin(S)*t,c=Math.cos(S)*t;V.push(0,0,0),V.push(e,0,c);const p=1&me?E:I;J.push(p.r,p.g,p.b),J.push(p.r,p.g,p.b)}for(let me=0;me<=m;me++){const S=1&me?E:I,e=t-t/m*me;for(let c=0;c<g;c++){let p=c/g*(2*Math.PI),_=Math.sin(p)*e,w=Math.cos(p)*e;V.push(_,0,w),J.push(S.r,S.g,S.b),p=(c+1)/g*(2*Math.PI),_=Math.sin(p)*e,w=Math.cos(p)*e,V.push(_,0,w),J.push(S.r,S.g,S.b)}}const Y=new dn;Y.setAttribute("position",new Fn(V,3)),Y.setAttribute("color",new Fn(J,3));const Z=new Qn({vertexColors:!0,toneMapped:!1});Wi.call(this,Y,Z),this.type="PolarGridHelper"}(bf.prototype=Object.create(er.prototype)).constructor=bf,bf.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},bf.prototype.update=function(){const t=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{const u=t.geometry.getAttribute("color");a_.copy(this.light.color),l_.copy(this.light.groundColor);for(let m=0,g=u.count;m<g;m++){const E=m<g/2?a_:l_;u.setXYZ(m,E.r,E.g,E.b)}u.needsUpdate=!0}t.lookAt(w_.setFromMatrixPosition(this.light.matrixWorld).negate())},(zf.prototype=Object.create(Wi.prototype)).constructor=zf,(xm.prototype=Object.create(Wi.prototype)).constructor=xm;const mo=new ot,jf=new ot,c_=new ot;function of(t,u,m){er.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=m,void 0===u&&(u=1);let g=new dn;g.setAttribute("position",new Fn([-u,u,0,u,u,0,u,-u,0,-u,-u,0,-u,u,0],3));const E=new Qn({fog:!1,toneMapped:!1});this.lightPlane=new Ni(g,E),this.add(this.lightPlane),g=new dn,g.setAttribute("position",new Fn([0,0,0,0,0,1],3)),this.targetLine=new Ni(g,E),this.add(this.targetLine),this.update()}(of.prototype=Object.create(er.prototype)).constructor=of,of.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},of.prototype.update=function(){mo.setFromMatrixPosition(this.light.matrixWorld),jf.setFromMatrixPosition(this.light.target.matrixWorld),c_.subVectors(jf,mo),this.lightPlane.lookAt(jf),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(jf),this.targetLine.scale.z=c_.length()};const sf=new ot,Zs=new Mi;function xf(t){const u=new dn,m=new Qn({color:16777215,vertexColors:!0,toneMapped:!1}),g=[],E=[],I={},V=new lr(16755200),J=new lr(16711680),Y=new lr(43775),Z=new lr(16777215),me=new lr(3355443);function S(c,p,_){e(c,_),e(p,_)}function e(c,p){g.push(0,0,0),E.push(p.r,p.g,p.b),void 0===I[c]&&(I[c]=[]),I[c].push(g.length/3-1)}S("n1","n2",V),S("n2","n4",V),S("n4","n3",V),S("n3","n1",V),S("f1","f2",V),S("f2","f4",V),S("f4","f3",V),S("f3","f1",V),S("n1","f1",V),S("n2","f2",V),S("n3","f3",V),S("n4","f4",V),S("p","n1",J),S("p","n2",J),S("p","n3",J),S("p","n4",J),S("u1","u2",Y),S("u2","u3",Y),S("u3","u1",Y),S("c","t",Z),S("p","c",me),S("cn1","cn2",me),S("cn3","cn4",me),S("cf1","cf2",me),S("cf3","cf4",me),u.setAttribute("position",new Fn(g,3)),u.setAttribute("color",new Fn(E,3)),Wi.call(this,u,m),this.type="CameraHelper",this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=I,this.update()}function Ca(t,u,m,g,E,I,V){sf.set(E,I,V).unproject(g);const J=u[t];if(void 0!==J){const Y=m.getAttribute("position");for(let Z=0,me=J.length;Z<me;Z++)Y.setXYZ(J[Z],sf.x,sf.y,sf.z)}}(xf.prototype=Object.create(Wi.prototype)).constructor=xf,xf.prototype.update=function(){const t=this.geometry,u=this.pointMap;Zs.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Ca("c",u,t,Zs,0,0,-1),Ca("t",u,t,Zs,0,0,1),Ca("n1",u,t,Zs,-1,-1,-1),Ca("n2",u,t,Zs,1,-1,-1),Ca("n3",u,t,Zs,-1,1,-1),Ca("n4",u,t,Zs,1,1,-1),Ca("f1",u,t,Zs,-1,-1,1),Ca("f2",u,t,Zs,1,-1,1),Ca("f3",u,t,Zs,-1,1,1),Ca("f4",u,t,Zs,1,1,1),Ca("u1",u,t,Zs,.7,1.1,-1),Ca("u2",u,t,Zs,-.7,1.1,-1),Ca("u3",u,t,Zs,0,2,-1),Ca("cf1",u,t,Zs,-1,0,1),Ca("cf2",u,t,Zs,1,0,1),Ca("cf3",u,t,Zs,0,-1,1),Ca("cf4",u,t,Zs,0,1,1),Ca("cn1",u,t,Zs,-1,0,-1),Ca("cn2",u,t,Zs,1,0,-1),Ca("cn3",u,t,Zs,0,-1,-1),Ca("cn4",u,t,Zs,0,1,-1),t.getAttribute("position").needsUpdate=!0};const Gf=new _n;function Yp(t,u){this.object=t,void 0===u&&(u=16776960);const m=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),g=new Float32Array(24),E=new dn;E.setIndex(new Gr(m,1)),E.setAttribute("position",new Gr(g,3)),Wi.call(this,E,new Qn({color:u,toneMapped:!1})),this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}function Hf(t,u){this.type="Box3Helper",this.box=t,void 0===u&&(u=16776960);const m=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),g=new dn;g.setIndex(new Gr(m,1)),g.setAttribute("position",new Fn([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),Wi.call(this,g,new Qn({color:u,toneMapped:!1})),this.type="Box3Helper",this.geometry.computeBoundingSphere()}function Vf(t,u,m){this.plane=t,this.size=void 0===u?1:u;const g=void 0!==m?m:16776960,E=new dn;E.setAttribute("position",new Fn([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),E.computeBoundingSphere(),Ni.call(this,E,new Qn({color:g,toneMapped:!1})),this.type="PlaneHelper";const I=new dn;I.setAttribute("position",new Fn([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),I.computeBoundingSphere(),this.add(new Bi(I,new eo({color:g,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}(Yp.prototype=Object.create(Wi.prototype)).constructor=Yp,Yp.prototype.update=function(t){if(void 0!==t&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&Gf.setFromObject(this.object),Gf.isEmpty())return;const u=Gf.min,m=Gf.max,g=this.geometry.attributes.position,E=g.array;E[0]=m.x,E[1]=m.y,E[2]=m.z,E[3]=u.x,E[4]=m.y,E[5]=m.z,E[6]=u.x,E[7]=u.y,E[8]=m.z,E[9]=m.x,E[10]=u.y,E[11]=m.z,E[12]=m.x,E[13]=m.y,E[14]=u.z,E[15]=u.x,E[16]=m.y,E[17]=u.z,E[18]=u.x,E[19]=u.y,E[20]=u.z,E[21]=m.x,E[22]=u.y,E[23]=u.z,g.needsUpdate=!0,this.geometry.computeBoundingSphere()},Yp.prototype.setFromObject=function(t){return this.object=t,this.update(),this},Yp.prototype.copy=function(t){return Wi.prototype.copy.call(this,t),this.object=t.object,this},(Hf.prototype=Object.create(Wi.prototype)).constructor=Hf,Hf.prototype.updateMatrixWorld=function(t){const u=this.box;u.isEmpty()||(u.getCenter(this.position),u.getSize(this.scale),this.scale.multiplyScalar(.5),er.prototype.updateMatrixWorld.call(this,t))},(Vf.prototype=Object.create(Ni.prototype)).constructor=Vf,Vf.prototype.updateMatrixWorld=function(t){let u=-this.plane.constant;Math.abs(u)<1e-8&&(u=1e-8),this.scale.set(.5*this.size,.5*this.size,u),this.children[0].material.side=u<0?le:_e,this.lookAt(this.plane.normal),er.prototype.updateMatrixWorld.call(this,t)};const qm=new ot;let _d,wm;function up(t,u,m,g,E,I){er.call(this),this.type="ArrowHelper",void 0===t&&(t=new ot(0,0,1)),void 0===u&&(u=new ot(0,0,0)),void 0===m&&(m=1),void 0===g&&(g=16776960),void 0===E&&(E=.2*m),void 0===I&&(I=.2*E),void 0===_d&&(_d=new dn,_d.setAttribute("position",new Fn([0,0,0,0,1,0],3)),wm=new Nn(0,.5,1,5,1),wm.translate(0,-.5,0)),this.position.copy(u),this.line=new Ni(_d,new Qn({color:g,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Bi(wm,new eo({color:g,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(m,E,I)}function wf(t){const u=[0,0,0,t=t||1,0,0,0,0,0,0,t,0,0,0,0,0,0,t],m=new dn;m.setAttribute("position",new Fn(u,3)),m.setAttribute("color",new Fn([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));const g=new Qn({vertexColors:!0,toneMapped:!1});Wi.call(this,m,g),this.type="AxesHelper"}(up.prototype=Object.create(er.prototype)).constructor=up,up.prototype.setDirection=function(t){if(t.y>.99999)this.quaternion.set(0,0,0,1);else if(t.y<-.99999)this.quaternion.set(1,0,0,0);else{qm.set(t.z,0,-t.x).normalize();const u=Math.acos(t.y);this.quaternion.setFromAxisAngle(qm,u)}},up.prototype.setLength=function(t,u,m){void 0===u&&(u=.2*t),void 0===m&&(m=.2*u),this.line.scale.set(1,Math.max(1e-4,t-u),1),this.line.updateMatrix(),this.cone.scale.set(m,u,m),this.cone.position.y=t,this.cone.updateMatrix()},up.prototype.setColor=function(t){this.line.material.color.set(t),this.cone.material.color.set(t)},up.prototype.copy=function(t){return er.prototype.copy.call(this,t,!1),this.line.copy(t.line),this.cone.copy(t.cone),this},(wf.prototype=Object.create(Wi.prototype)).constructor=wf;const hp=Math.pow(2,8),Xm=[.125,.215,.35,.446,.526,.582],u_=5+Xm.length,fh=20,mh={[Qi]:0,[Ka]:1,[Uc]:2,[cc]:3,[Ju]:4,[gu]:5,[Gl]:6},Wf=new zt,{_lodPlanes:Sf,_sizeLods:Ym,_sigmas:Sm}=function(){const t=[],u=[],m=[];let g=8;for(let E=0;E<u_;E++){const I=Math.pow(2,g);u.push(I);let V=1/I;E>4?V=Xm[E-8+4-1]:0==E&&(V=0),m.push(V);const J=1/(I-1),Y=-J/2,Z=1+J/2,me=[Y,Y,Z,Y,Z,Z,Y,Y,Z,Z,Y,Z],S=6,e=6,c=3,p=2,_=1,w=new Float32Array(c*e*S),L=new Float32Array(p*e*S),O=new Float32Array(_*e*S);for(let z=0;z<S;z++){const Q=z%3*2/3-1,ae=z>2?0:-1;w.set([Q,ae,0,Q+2/3,ae,0,Q+2/3,ae+1,0,Q,ae,0,Q+2/3,ae+1,0,Q,ae+1,0],c*e*z),L.set(me,p*e*z),O.set([z,z,z,z,z,z],_*e*z)}const D=new dn;D.setAttribute("position",new Gr(w,c)),D.setAttribute("uv",new Gr(L,p)),D.setAttribute("faceIndex",new Gr(O,_)),t.push(D),g>4&&g--}return{_lodPlanes:t,_sizeLods:u,_sigmas:m}}();let Jm=null;const kd=(1+Math.sqrt(5))/2,af=1/kd,h_=[new ot(1,1,1),new ot(-1,1,1),new ot(1,1,-1),new ot(-1,1,-1),new ot(0,kd,af),new ot(0,kd,-af),new ot(af,0,kd),new ot(-af,0,kd),new ot(kd,af,0),new ot(-kd,af,0)];function Em(t){var u;this._renderer=t,this._pingPongRenderTarget=null,this._blurMaterial=new qi({name:"SphericalGaussianBlur",defines:{n:u=fh},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:new Float32Array(u)},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:new ot(0,1,0)},inputEncoding:{value:mh[Qi]},outputEncoding:{value:mh[Qi]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:q,depthTest:!1,depthWrite:!1}),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}function S_(t){return void 0!==t&&t.type===ea&&(t.encoding===Qi||t.encoding===Ka||t.encoding===Gl)}function Zm(t){const u=new Is(3*hp,3*hp,t);return u.texture.mapping=Di,u.texture.name="PMREM.cubeUv",u.scissorTest=!0,u}function lf(t,u,m,g,E){t.viewport.set(u,m,g,E),t.scissor.set(u,m,g,E)}function Qm(){return new qi({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:new wn(1,1)},inputEncoding:{value:mh[Qi]},outputEncoding:{value:mh[Qi]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tvec2 f = fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -= f * texelSize;\n\t\t\t\tvec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x += texelSize.x;\n\t\t\t\tvec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.y += texelSize.y;\n\t\t\t\tvec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x -= texelSize.x;\n\t\t\t\tvec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\n\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb = mix( tm, bm, f.y );\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:q,depthTest:!1,depthWrite:!1})}function p_(){return new qi({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:mh[Qi]},outputEncoding:{value:mh[Qi]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\t\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t",blending:q,depthTest:!1,depthWrite:!1})}function Tm(t,u,m,g,E,I,V){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new sa(t,u,m,E,I,V)}Em.prototype={constructor:Em,fromScene:function(t,u=0,m=.1,g=100){Jm=this._renderer.getRenderTarget();const E=this._allocateTargets();return this._sceneToCubeUV(t,m,g,E),u>0&&this._blur(E,0,0,u),this._applyPMREM(E),this._cleanup(E),E},fromEquirectangular:function(t){return this._fromTexture(t)},fromCubemap:function(t){return this._fromTexture(t)},compileCubemapShader:function(){null===this._cubemapShader&&(this._cubemapShader=p_(),this._compileMaterial(this._cubemapShader))},compileEquirectangularShader:function(){null===this._equirectShader&&(this._equirectShader=Qm(),this._compileMaterial(this._equirectShader))},dispose:function(){this._blurMaterial.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(let t=0;t<Sf.length;t++)Sf[t].dispose()},_cleanup:function(t){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(Jm),t.scissorTest=!1,lf(t,0,0,t.width,t.height)},_fromTexture:function(t){Jm=this._renderer.getRenderTarget();const u=this._allocateTargets(t);return this._textureToCubeUV(t,u),this._applyPMREM(u),this._cleanup(u),u},_allocateTargets:function(t){const u={magFilter:Or,minFilter:Or,generateMipmaps:!1,type:ea,format:gh,encoding:S_(t)?t.encoding:Uc,depthBuffer:!1,stencilBuffer:!1},m=Zm(u);return m.depthBuffer=!t,this._pingPongRenderTarget=Zm(u),m},_compileMaterial:function(t){const u=new Bi(Sf[0],t);this._renderer.compile(u,Wf)},_sceneToCubeUV:function(t,u,m,g){const E=new Bs(90,1,u,m),I=[1,-1,1,1,1,1],V=[1,1,1,-1,-1,-1],J=this._renderer,Y=J.outputEncoding,Z=J.toneMapping,me=J.getClearColor(),S=J.getClearAlpha();J.toneMapping=vr,J.outputEncoding=Qi;let e=t.background;if(e&&e.isColor){e.convertSRGBToLinear();const c=Math.max(e.r,e.g,e.b),p=Math.min(Math.max(Math.ceil(Math.log2(c)),-128),127);e=e.multiplyScalar(Math.pow(2,-p)),J.setClearColor(e,(p+128)/255),t.background=null}for(let c=0;c<6;c++){const p=c%3;0==p?(E.up.set(0,I[c],0),E.lookAt(V[c],0,0)):1==p?(E.up.set(0,0,I[c]),E.lookAt(0,V[c],0)):(E.up.set(0,I[c],0),E.lookAt(0,0,V[c])),lf(g,p*hp,c>2?hp:0,hp,hp),J.setRenderTarget(g),J.render(t,E)}J.toneMapping=Z,J.outputEncoding=Y,J.setClearColor(me,S)},_textureToCubeUV:function(t,u){const m=this._renderer;t.isCubeTexture?null==this._cubemapShader&&(this._cubemapShader=p_()):null==this._equirectShader&&(this._equirectShader=Qm());const g=t.isCubeTexture?this._cubemapShader:this._equirectShader,E=new Bi(Sf[0],g),I=g.uniforms;I.envMap.value=t,t.isCubeTexture||I.texelSize.value.set(1/t.image.width,1/t.image.height),I.inputEncoding.value=mh[t.encoding],I.outputEncoding.value=mh[u.texture.encoding],lf(u,0,0,3*hp,2*hp),m.setRenderTarget(u),m.render(E,Wf)},_applyPMREM:function(t){const u=this._renderer,m=u.autoClear;u.autoClear=!1;for(let g=1;g<u_;g++){const E=Math.sqrt(Sm[g]*Sm[g]-Sm[g-1]*Sm[g-1]);this._blur(t,g-1,g,E,h_[(g-1)%h_.length])}u.autoClear=m},_blur:function(t,u,m,g,E){const I=this._pingPongRenderTarget;this._halfBlur(t,I,u,m,g,"latitudinal",E),this._halfBlur(I,t,m,m,g,"longitudinal",E)},_halfBlur:function(t,u,m,g,E,I,V){const J=this._renderer,Y=this._blurMaterial;"latitudinal"!==I&&"longitudinal"!==I&&console.error("blur direction must be either latitudinal or longitudinal!");const Z=new Bi(Sf[g],Y),me=Y.uniforms,S=Ym[m]-1,e=isFinite(E)?Math.PI/(2*S):2*Math.PI/(2*fh-1),c=E/e,p=isFinite(E)?1+Math.floor(3*c):fh;p>fh&&console.warn(`sigmaRadians, ${E}, is too large and will clip, as it requested ${p} samples when the maximum is set to ${fh}`);const _=[];let w=0;for(let O=0;O<fh;++O){const D=O/c,z=Math.exp(-D*D/2);_.push(z),0==O?w+=z:O<p&&(w+=2*z)}for(let O=0;O<_.length;O++)_[O]=_[O]/w;me.envMap.value=t.texture,me.samples.value=p,me.weights.value=_,me.latitudinal.value="latitudinal"===I,V&&(me.poleAxis.value=V),me.dTheta.value=e,me.mipInt.value=8-m,me.inputEncoding.value=mh[t.texture.encoding],me.outputEncoding.value=mh[t.texture.encoding];const L=Ym[g];lf(u,3*Math.max(0,hp-2*L),(0===g?0:2*hp)+2*L*(g>4?g-8+4:0),3*L,2*L),J.setRenderTarget(u),J.render(Z,Wf)}};const _a=0,E_=1,La=0,Mm=1,d_=2;function T_(t){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),t}function M_(t){return void 0===t&&(t=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),t.isMultiMaterial=!0,t.materials=t,t.clone=function(){return t.slice()},t}function f_(t,u){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new wo(t,u)}function Am(t){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new Zd(t)}function Km(t,u){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new wo(t,u)}function A_(t){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new ca(t)}function m_(t){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new ca(t)}function __(t){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new ca(t)}function $_(t,u,m){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new ot(t,u,m)}function C_(t,u){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new Gr(t,u).setUsage(Lr)}function L_(t,u){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new tl(t,u)}function B_(t,u){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new yc(t,u)}function N_(t,u){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new Qu(t,u)}function R_(t,u){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new ep(t,u)}function P_(t,u){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new Tl(t,u)}function I_(t,u){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new tr(t,u)}function O_(t,u){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new nl(t,u)}function k_(t,u){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new Fn(t,u)}function F_(t,u){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new Ml(t,u)}function g_(t){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),R.call(this,t),this.type="catmullrom",this.closed=!0}function v_(t){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),R.call(this,t),this.type="catmullrom"}function e_(t){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),R.call(this,t),this.type="catmullrom"}function D_(t){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new wf(t)}function U_(t,u){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new Yp(t,u)}function z_(t,u){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new Wi(new Si(t.geometry),new Qn({color:void 0!==u?u:16777215}))}function j_(t,u){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new Wi(new Ql(t.geometry),new Qn({color:void 0!==u?u:16777215}))}function G_(t){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new tc(t)}function H_(t){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Iu(t)}function V_(t,u,m){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new $l(t,m)}Hn.create=function(t,u){return console.log("THREE.Curve.create() has been deprecated"),t.prototype=Object.create(Hn.prototype),t.prototype.constructor=t,t.prototype.getPoint=u,t},Object.assign(Re.prototype,{createPointsGeometry:function(t){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");const u=this.getPoints(t);return this.createGeometry(u)},createSpacedPointsGeometry:function(t){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");const u=this.getSpacedPoints(t);return this.createGeometry(u)},createGeometry:function(t){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");const u=new Fr;for(let m=0,g=t.length;m<g;m++){const E=t[m];u.vertices.push(new ot(E.x,E.y,E.z||0))}return u}}),Object.assign(Oe.prototype,{fromPoints:function(t){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)}}),g_.prototype=Object.create(R.prototype),v_.prototype=Object.create(R.prototype),e_.prototype=Object.create(R.prototype),Object.assign(e_.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),zf.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},md.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(Ci.prototype,{extractUrlBase:function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),wr.extractUrlBase(t)}}),Ci.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Object.assign(Mr.prototype,{setTexturePath:function(t){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(t)}}),Object.assign(Wm.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(_n.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(zn.prototype,{empty:function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()}}),Vc.prototype.setFromMatrix=function(t){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(t)},bm.prototype.center=function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)},Object.assign(rr,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(t){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),rr.floorPowerOfTwo(t)},nextPowerOfTwo:function(t){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),rr.ceilPowerOfTwo(t)}}),Object.assign(jo.prototype,{flattenToArrayOffset:function(t,u){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,u)},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(ti.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},flattenToArrayOffset:function(t,u){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,u)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new ot).setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(t,u,m,g,E,I){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,u,g,m,E,I)}}),Wo.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},yo.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},Object.assign(co.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),Object.assign(Ir.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(t,u){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(t,u)},midpoint:function(t){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(t)},normal:function(t){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(t)},plane:function(t){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(t)}}),Object.assign(Ir,{barycoordFromPoint:function(t,u,m,g,E){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Ir.getBarycoord(t,u,m,g,E)},normal:function(t,u,m,g){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Ir.getNormal(t,u,m,g)}}),Object.assign(Ge.prototype,{extractAllPoints:function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Cc(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Bu(this,t)}}),Object.assign(wn.prototype,{fromAttribute:function(t,u,m){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,u,m)},distanceToManhattan:function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(ot.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,u){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(u,t)},applyProjection:function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},fromAttribute:function(t,u,m){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,u,m)},distanceToManhattan:function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(gi.prototype,{fromAttribute:function(t,u,m){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,u,m)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Fr.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function(t){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.assign(er.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,u){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(u,t)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(t){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.defineProperties(er.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.assign(Bi.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Object.defineProperties(Bi.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),Xh},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Object.defineProperties(ja.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(Qd.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),zp.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(Hn.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(t){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=t}}),Bs.prototype.setLens=function(t,u){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==u&&(this.filmGauge=u),this.setFocalLength(t)},Object.defineProperties(ke.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(Gr.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Lr},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Lr)}}}),Object.assign(Gr.prototype,{setDynamic:function(t){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?Lr:_i),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(dn.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addAttribute:function(t,u){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),u&&u.isBufferAttribute||u&&u.isInterleavedBufferAttribute?"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(u),this):this.setAttribute(t,u):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(t,new Gr(arguments[1],arguments[2])))},addDrawCall:function(t,u,m){void 0!==m&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,u)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(t){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(t)},applyMatrix:function(t){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Object.defineProperties(dn.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(Yn.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(t){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=t}}}),Object.defineProperties(vm.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(t){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=t}}}),Object.defineProperties(Jc.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===Lr},set:function(t){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(t)}}}),Object.assign(Jc.prototype,{setDynamic:function(t){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===t?Lr:_i),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),Object.assign(ha.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.defineProperties(kf.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(Ur.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new lr}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=t===T}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(t){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=t}}}),Object.defineProperties(po.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(pl.prototype,{transparency:{get:function(){return console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission},set:function(t){console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission=t}}}),Object.defineProperties(uo.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),Object.assign($u.prototype,{clearTarget:function(t,u,m,g){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(t),this.clear(u,m,g)},animate:function(t){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(t)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Object.defineProperties($u.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(t){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===t?Ka:Qi}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(lm.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Is.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),Object.defineProperties(Rd.prototype,{load:{value:function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const u=this;return(new qp).load(t,function(m){u.setBuffer(m)}),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),Of.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Io.prototype.updateCubeMap=function(t,u){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,u)};const W_={merge:function(t,u,m){let g;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),u.isMesh&&(u.matrixAutoUpdate&&u.updateMatrix(),g=u.matrix,u=u.geometry),t.merge(u,g,m)},center:function(t){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),t.center()}};function q_(){console.error("THREE.CanvasRenderer has been removed")}function X_(){console.error("THREE.JSONLoader has been removed.")}Ki.crossOrigin=void 0,Ki.loadTexture=function(t,u,m,g){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const E=new ld;E.setCrossOrigin(this.crossOrigin);const I=E.load(t,m,void 0,g);return u&&(I.mapping=u),I},Ki.loadTextureCube=function(t,u,m,g){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const E=new fl;E.setCrossOrigin(this.crossOrigin);const I=E.load(t,m,void 0,g);return u&&(I.mapping=u),I},Ki.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Ki.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};const Y_={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};function J_(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:x}}))},759:(n,o,l)=>{"use strict";l.d(o,{U:()=>x}),n=l.hmd(n),function(N){"object"==typeof exports?n.exports=N():"function"==typeof define&&l.amdO?define([],N):(typeof window<"u"?window:void 0!==l.g?l.g:typeof self<"u"?self:this).opentype=N()}(function(){return function N(U,G,A){function P(te,ce){if(!G[te]){if(!U[te]){if(de)return de(te,!0);var fe=new Error("Cannot find module '"+te+"'");throw fe.code="MODULE_NOT_FOUND",fe}var _e=G[te]={exports:{}};U[te][0].call(_e.exports,function(le){return P(U[te][1][le]||le)},_e,_e.exports,N,U,G,A)}return G[te].exports}for(var de=void 0,be=0;be<A.length;be++)P(A[be]);return P}({1:[function(N,U,G){function A(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}function P(Ke,gt){this.source=Ke,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=gt,this.destLen=0,this.ltree=new A,this.dtree=new A}function de(Ke,gt,at,Ct){var wt,Ft;for(wt=0;at>wt;++wt)Ke[wt]=0;for(wt=0;30-at>wt;++wt)Ke[wt+at]=wt/at|0;for(Ft=Ct,wt=0;30>wt;++wt)gt[wt]=Ft,Ft+=1<<Ke[wt]}function be(Ke,gt,at,Ct){var wt,Ft;for(wt=0;16>wt;++wt)Ke.table[wt]=0;for(wt=0;Ct>wt;++wt)Ke.table[gt[at+wt]]++;for(Ke.table[0]=0,Ft=0,wt=0;16>wt;++wt)qe[wt]=Ft,Ft+=Ke.table[wt];for(wt=0;Ct>wt;++wt)gt[at+wt]&&(Ke.trans[qe[gt[at+wt]]++]=wt)}function te(Ke){Ke.bitcount--||(Ke.tag=Ke.source[Ke.sourceIndex++],Ke.bitcount=7);var gt=1&Ke.tag;return Ke.tag>>>=1,gt}function ce(Ke,gt,at){if(!gt)return at;for(;Ke.bitcount<24;)Ke.tag|=Ke.source[Ke.sourceIndex++]<<Ke.bitcount,Ke.bitcount+=8;var Ct=Ke.tag&65535>>>16-gt;return Ke.tag>>>=gt,Ke.bitcount-=gt,Ct+at}function fe(Ke,gt){for(;Ke.bitcount<24;)Ke.tag|=Ke.source[Ke.sourceIndex++]<<Ke.bitcount,Ke.bitcount+=8;var at=0,Ct=0,wt=0,Ft=Ke.tag;do{Ct=2*Ct+(1&Ft),Ft>>>=1,++wt,at+=gt.table[wt],Ct-=gt.table[wt]}while(Ct>=0);return Ke.tag=Ft,Ke.bitcount-=wt,gt.trans[at+Ct]}function _e(Ke,gt,at){var Ct,wt,Ft,Ot,rn,ft;for(Ct=ce(Ke,5,257),wt=ce(Ke,5,1),Ft=ce(Ke,4,4),Ot=0;19>Ot;++Ot)Ee[Ot]=0;for(Ot=0;Ft>Ot;++Ot){var Tn=ce(Ke,3,0);Ee[Ae[Ot]]=Tn}for(be(Fe,Ee,0,19),rn=0;Ct+wt>rn;){var Cn=fe(Ke,Fe);switch(Cn){case 16:var mn=Ee[rn-1];for(ft=ce(Ke,2,3);ft;--ft)Ee[rn++]=mn;break;case 17:for(ft=ce(Ke,3,3);ft;--ft)Ee[rn++]=0;break;case 18:for(ft=ce(Ke,7,11);ft;--ft)Ee[rn++]=0;break;default:Ee[rn++]=Cn}}be(gt,Ee,0,Ct),be(at,Ee,Ct,wt)}function le(Ke,gt,at){for(;;){var Ct,wt,Ft,Ot,rn=fe(Ke,gt);if(256===rn)return T;if(256>rn)Ke.dest[Ke.destLen++]=rn;else for(Ct=ce(Ke,F[rn-=257],Be[rn]),wt=fe(Ke,at),Ot=Ft=Ke.destLen-ce(Ke,K[wt],ve[wt]);Ft+Ct>Ot;++Ot)Ke.dest[Ke.destLen++]=Ke.dest[Ot]}}function pe(Ke){for(var gt,at;Ke.bitcount>8;)Ke.sourceIndex--,Ke.bitcount-=8;if((gt=256*(gt=Ke.source[Ke.sourceIndex+1])+Ke.source[Ke.sourceIndex])!==(65535&~(256*Ke.source[Ke.sourceIndex+3]+Ke.source[Ke.sourceIndex+2])))return B;for(Ke.sourceIndex+=4,at=gt;at;--at)Ke.dest[Ke.destLen++]=Ke.source[Ke.sourceIndex++];return Ke.bitcount=0,T}var T=0,B=-3,q=new A,ee=new A,F=new Uint8Array(30),Be=new Uint16Array(30),K=new Uint8Array(30),ve=new Uint16Array(30),Ae=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Fe=new A,Ee=new Uint8Array(320),qe=new Uint16Array(16);(function(Ke,gt){var at;for(at=0;7>at;++at)Ke.table[at]=0;for(Ke.table[7]=24,Ke.table[8]=152,Ke.table[9]=112,at=0;24>at;++at)Ke.trans[at]=256+at;for(at=0;144>at;++at)Ke.trans[24+at]=at;for(at=0;8>at;++at)Ke.trans[168+at]=280+at;for(at=0;112>at;++at)Ke.trans[176+at]=144+at;for(at=0;5>at;++at)gt.table[at]=0;for(gt.table[5]=32,at=0;32>at;++at)gt.trans[at]=at})(q,ee),de(F,Be,4,3),de(K,ve,2,1),F[28]=0,Be[28]=258,U.exports=function(Ke,gt){var at,Ct,wt=new P(Ke,gt);do{switch(at=te(wt),ce(wt,2,0)){case 0:Ct=pe(wt);break;case 1:Ct=le(wt,q,ee);break;case 2:_e(wt,wt.ltree,wt.dtree),Ct=le(wt,wt.ltree,wt.dtree);break;default:Ct=B}if(Ct!==T)throw new Error("Data error")}while(!at);return wt.destLen<wt.dest.length?"function"==typeof wt.dest.slice?wt.dest.slice(0,wt.destLen):wt.dest.subarray(0,wt.destLen):wt.dest}},{}],2:[function(N,U,G){G.fail=function(A){throw new Error(A)},G.argument=function(A,P){A||G.fail(P)},G.assert=G.argument},{}],3:[function(N,U,G){G.line=function(A,P,de,be,te){A.beginPath(),A.moveTo(P,de),A.lineTo(be,te),A.stroke()}},{}],4:[function(N,U,G){function A(te){this.font=te}function P(te){this.cmap=te}function de(te,ce){this.encoding=te,this.charset=ce}function be(te){var ce;switch(te.version){case 1:this.names=G.standardNames.slice();break;case 2:for(this.names=new Array(te.numberOfGlyphs),ce=0;ce<te.numberOfGlyphs;ce++)this.names[ce]=te.glyphNameIndex[ce]<G.standardNames.length?G.standardNames[te.glyphNameIndex[ce]]:te.names[te.glyphNameIndex[ce]-G.standardNames.length];break;case 2.5:for(this.names=new Array(te.numberOfGlyphs),ce=0;ce<te.numberOfGlyphs;ce++)this.names[ce]=G.standardNames[ce+te.glyphNameIndex[ce]];break;case 3:this.names=[]}}A.prototype.charToGlyphIndex=function(te){var ce=te.charCodeAt(0),fe=this.font.glyphs;if(!fe)return null;for(var _e=0;_e<fe.length;_e+=1)for(var le=fe.get(_e),pe=0;pe<le.unicodes.length;pe+=1)if(le.unicodes[pe]===ce)return _e},P.prototype.charToGlyphIndex=function(te){return this.cmap.glyphIndexMap[te.charCodeAt(0)]||0},de.prototype.charToGlyphIndex=function(te){var ce=te.charCodeAt(0);return this.charset.indexOf(this.encoding[ce])},be.prototype.nameToGlyphIndex=function(te){return this.names.indexOf(te)},be.prototype.glyphIndexToName=function(te){return this.names[te]},G.cffStandardStrings=[".notdef","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","endash","dagger","daggerdbl","periodcentered","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","questiondown","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","ring","cedilla","hungarumlaut","ogonek","caron","emdash","AE","ordfeminine","Lslash","Oslash","OE","ordmasculine","ae","dotlessi","lslash","oslash","oe","germandbls","onesuperior","logicalnot","mu","trademark","Eth","onehalf","plusminus","Thorn","onequarter","divide","brokenbar","degree","thorn","threequarters","twosuperior","registered","minus","eth","multiply","threesuperior","copyright","Aacute","Acircumflex","Adieresis","Agrave","Aring","Atilde","Ccedilla","Eacute","Ecircumflex","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Ntilde","Oacute","Ocircumflex","Odieresis","Ograve","Otilde","Scaron","Uacute","Ucircumflex","Udieresis","Ugrave","Yacute","Ydieresis","Zcaron","aacute","acircumflex","adieresis","agrave","aring","atilde","ccedilla","eacute","ecircumflex","edieresis","egrave","iacute","icircumflex","idieresis","igrave","ntilde","oacute","ocircumflex","odieresis","ograve","otilde","scaron","uacute","ucircumflex","udieresis","ugrave","yacute","ydieresis","zcaron","exclamsmall","Hungarumlautsmall","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","266 ff","onedotenleader","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","commasuperior","threequartersemdash","periodsuperior","questionsmall","asuperior","bsuperior","centsuperior","dsuperior","esuperior","isuperior","lsuperior","msuperior","nsuperior","osuperior","rsuperior","ssuperior","tsuperior","ff","ffi","ffl","parenleftinferior","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","exclamdownsmall","centoldstyle","Lslashsmall","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","Dotaccentsmall","Macronsmall","figuredash","hypheninferior","Ogoneksmall","Ringsmall","Cedillasmall","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","zerosuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall","001.000","001.001","001.002","001.003","Black","Bold","Book","Light","Medium","Regular","Roman","Semibold"],G.cffStandardEncoding=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quoteright","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","quoteleft","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdown","cent","sterling","fraction","yen","florin","section","currency","quotesingle","quotedblleft","guillemotleft","guilsinglleft","guilsinglright","fi","fl","","endash","dagger","daggerdbl","periodcentered","","paragraph","bullet","quotesinglbase","quotedblbase","quotedblright","guillemotright","ellipsis","perthousand","","questiondown","","grave","acute","circumflex","tilde","macron","breve","dotaccent","dieresis","","ring","cedilla","","hungarumlaut","ogonek","caron","emdash","","","","","","","","","","","","","","","","","AE","","ordfeminine","","","","","Lslash","Oslash","OE","ordmasculine","","","","","","ae","","","","dotlessi","","","lslash","oslash","oe","germandbls"],G.cffExpertEncoding=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","space","exclamsmall","Hungarumlautsmall","","dollaroldstyle","dollarsuperior","ampersandsmall","Acutesmall","parenleftsuperior","parenrightsuperior","twodotenleader","onedotenleader","comma","hyphen","period","fraction","zerooldstyle","oneoldstyle","twooldstyle","threeoldstyle","fouroldstyle","fiveoldstyle","sixoldstyle","sevenoldstyle","eightoldstyle","nineoldstyle","colon","semicolon","commasuperior","threequartersemdash","periodsuperior","questionsmall","","asuperior","bsuperior","centsuperior","dsuperior","esuperior","","","isuperior","","","lsuperior","msuperior","nsuperior","osuperior","","","rsuperior","ssuperior","tsuperior","","ff","fi","fl","ffi","ffl","parenleftinferior","","parenrightinferior","Circumflexsmall","hyphensuperior","Gravesmall","Asmall","Bsmall","Csmall","Dsmall","Esmall","Fsmall","Gsmall","Hsmall","Ismall","Jsmall","Ksmall","Lsmall","Msmall","Nsmall","Osmall","Psmall","Qsmall","Rsmall","Ssmall","Tsmall","Usmall","Vsmall","Wsmall","Xsmall","Ysmall","Zsmall","colonmonetary","onefitted","rupiah","Tildesmall","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","exclamdownsmall","centoldstyle","Lslashsmall","","","Scaronsmall","Zcaronsmall","Dieresissmall","Brevesmall","Caronsmall","","Dotaccentsmall","","","Macronsmall","","","figuredash","hypheninferior","","","Ogoneksmall","Ringsmall","Cedillasmall","","","","onequarter","onehalf","threequarters","questiondownsmall","oneeighth","threeeighths","fiveeighths","seveneighths","onethird","twothirds","","","zerosuperior","onesuperior","twosuperior","threesuperior","foursuperior","fivesuperior","sixsuperior","sevensuperior","eightsuperior","ninesuperior","zeroinferior","oneinferior","twoinferior","threeinferior","fourinferior","fiveinferior","sixinferior","seveninferior","eightinferior","nineinferior","centinferior","dollarinferior","periodinferior","commainferior","Agravesmall","Aacutesmall","Acircumflexsmall","Atildesmall","Adieresissmall","Aringsmall","AEsmall","Ccedillasmall","Egravesmall","Eacutesmall","Ecircumflexsmall","Edieresissmall","Igravesmall","Iacutesmall","Icircumflexsmall","Idieresissmall","Ethsmall","Ntildesmall","Ogravesmall","Oacutesmall","Ocircumflexsmall","Otildesmall","Odieresissmall","OEsmall","Oslashsmall","Ugravesmall","Uacutesmall","Ucircumflexsmall","Udieresissmall","Yacutesmall","Thornsmall","Ydieresissmall"],G.standardNames=[".notdef",".null","nonmarkingreturn","space","exclam","quotedbl","numbersign","dollar","percent","ampersand","quotesingle","parenleft","parenright","asterisk","plus","comma","hyphen","period","slash","zero","one","two","three","four","five","six","seven","eight","nine","colon","semicolon","less","equal","greater","question","at","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","bracketleft","backslash","bracketright","asciicircum","underscore","grave","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","braceleft","bar","braceright","asciitilde","Adieresis","Aring","Ccedilla","Eacute","Ntilde","Odieresis","Udieresis","aacute","agrave","acircumflex","adieresis","atilde","aring","ccedilla","eacute","egrave","ecircumflex","edieresis","iacute","igrave","icircumflex","idieresis","ntilde","oacute","ograve","ocircumflex","odieresis","otilde","uacute","ugrave","ucircumflex","udieresis","dagger","degree","cent","sterling","section","bullet","paragraph","germandbls","registered","copyright","trademark","acute","dieresis","notequal","AE","Oslash","infinity","plusminus","lessequal","greaterequal","yen","mu","partialdiff","summation","product","pi","integral","ordfeminine","ordmasculine","Omega","ae","oslash","questiondown","exclamdown","logicalnot","radical","florin","approxequal","Delta","guillemotleft","guillemotright","ellipsis","nonbreakingspace","Agrave","Atilde","Otilde","OE","oe","endash","emdash","quotedblleft","quotedblright","quoteleft","quoteright","divide","lozenge","ydieresis","Ydieresis","fraction","currency","guilsinglleft","guilsinglright","fi","fl","daggerdbl","periodcentered","quotesinglbase","quotedblbase","perthousand","Acircumflex","Ecircumflex","Aacute","Edieresis","Egrave","Iacute","Icircumflex","Idieresis","Igrave","Oacute","Ocircumflex","apple","Ograve","Uacute","Ucircumflex","Ugrave","dotlessi","circumflex","tilde","macron","breve","dotaccent","ring","cedilla","hungarumlaut","ogonek","caron","Lslash","lslash","Scaron","scaron","Zcaron","zcaron","brokenbar","Eth","eth","Yacute","yacute","Thorn","thorn","minus","multiply","onesuperior","twosuperior","threesuperior","onehalf","onequarter","threequarters","franc","Gbreve","gbreve","Idotaccent","Scedilla","scedilla","Cacute","cacute","Ccaron","ccaron","dcroat"],G.DefaultEncoding=A,G.CmapEncoding=P,G.CffEncoding=de,G.GlyphNames=be,G.addGlyphNames=function(te){for(var ce,fe=te.tables.cmap.glyphIndexMap,_e=Object.keys(fe),le=0;le<_e.length;le+=1){var pe=_e[le];(ce=te.glyphs.get(fe[pe])).addUnicode(parseInt(pe))}for(le=0;le<te.glyphs.length;le+=1)ce=te.glyphs.get(le),te.cffEncoding?ce.name=te.cffEncoding.charset[le]:te.glyphNames.names&&(ce.name=te.glyphNames.glyphIndexToName(le))}},{}],5:[function(N,U,G){function A(_e){(_e=_e||{}).empty||(fe.checkArgument(_e.familyName,"When creating a new Font object, familyName is required."),fe.checkArgument(_e.styleName,"When creating a new Font object, styleName is required."),fe.checkArgument(_e.unitsPerEm,"When creating a new Font object, unitsPerEm is required."),fe.checkArgument(_e.ascender,"When creating a new Font object, ascender is required."),fe.checkArgument(_e.descender,"When creating a new Font object, descender is required."),fe.checkArgument(_e.descender<0,"Descender should be negative (e.g. -512)."),this.names={fontFamily:{en:_e.familyName||" "},fontSubfamily:{en:_e.styleName||" "},fullName:{en:_e.fullName||_e.familyName+" "+_e.styleName},postScriptName:{en:_e.postScriptName||_e.familyName+_e.styleName},designer:{en:_e.designer||" "},designerURL:{en:_e.designerURL||" "},manufacturer:{en:_e.manufacturer||" "},manufacturerURL:{en:_e.manufacturerURL||" "},license:{en:_e.license||" "},licenseURL:{en:_e.licenseURL||" "},version:{en:_e.version||"Version 0.1"},description:{en:_e.description||" "},copyright:{en:_e.copyright||" "},trademark:{en:_e.trademark||" "}},this.unitsPerEm=_e.unitsPerEm||1e3,this.ascender=_e.ascender,this.descender=_e.descender,this.createdTimestamp=_e.createdTimestamp,this.tables={os2:{usWeightClass:_e.weightClass||this.usWeightClasses.MEDIUM,usWidthClass:_e.widthClass||this.usWidthClasses.MEDIUM,fsSelection:_e.fsSelection||this.fsSelectionValues.REGULAR}}),this.supported=!0,this.glyphs=new te.GlyphSet(this,_e.glyphs||[]),this.encoding=new be.DefaultEncoding(this),this.substitution=new ce(this),this.tables=this.tables||{}}var P=N("./path"),de=N("./tables/sfnt"),be=N("./encoding"),te=N("./glyphset"),ce=N("./substitution"),fe=N("./util");A.prototype.hasChar=function(_e){return null!==this.encoding.charToGlyphIndex(_e)},A.prototype.charToGlyphIndex=function(_e){return this.encoding.charToGlyphIndex(_e)},A.prototype.charToGlyph=function(_e){var le=this.charToGlyphIndex(_e),pe=this.glyphs.get(le);return pe||(pe=this.glyphs.get(0)),pe},A.prototype.stringToGlyphs=function(_e){for(var le=[],pe=0;pe<_e.length;pe+=1)le.push(this.charToGlyph(_e[pe]));return le},A.prototype.nameToGlyphIndex=function(_e){return this.glyphNames.nameToGlyphIndex(_e)},A.prototype.nameToGlyph=function(_e){var le=this.nametoGlyphIndex(_e),pe=this.glyphs.get(le);return pe||(pe=this.glyphs.get(0)),pe},A.prototype.glyphIndexToName=function(_e){return this.glyphNames.glyphIndexToName?this.glyphNames.glyphIndexToName(_e):""},A.prototype.getKerningValue=function(_e,le){_e=_e.index||_e,le=le.index||le;var pe=this.getGposKerningValue;return pe?pe(_e,le):this.kerningPairs[_e+","+le]||0},A.prototype.forEachGlyph=function(_e,le,pe,T,B,q){le=void 0!==le?le:0,pe=void 0!==pe?pe:0;for(var ee=void 0===(B=B||{}).kerning||B.kerning,F=1/this.unitsPerEm*(T=void 0!==T?T:72),Be=this.stringToGlyphs(_e),K=0;K<Be.length;K+=1){var ve=Be[K];q(ve,le,pe,T,B),ve.advanceWidth&&(le+=ve.advanceWidth*F),ee&&K<Be.length-1&&(le+=this.getKerningValue(ve,Be[K+1])*F)}},A.prototype.getPath=function(_e,le,pe,T,B){var q=new P.Path;return this.forEachGlyph(_e,le,pe,T,B,function(ee,F,Be,K){var ve=ee.getPath(F,Be,K);q.extend(ve)}),q},A.prototype.getPaths=function(_e,le,pe,T,B){var q=[];return this.forEachGlyph(_e,le,pe,T,B,function(ee,F,Be,K){var ve=ee.getPath(F,Be,K);q.push(ve)}),q},A.prototype.draw=function(_e,le,pe,T,B,q){this.getPath(le,pe,T,B,q).draw(_e)},A.prototype.drawPoints=function(_e,le,pe,T,B,q){this.forEachGlyph(le,pe,T,B,q,function(ee,F,Be,K){ee.drawPoints(_e,F,Be,K)})},A.prototype.drawMetrics=function(_e,le,pe,T,B,q){this.forEachGlyph(le,pe,T,B,q,function(ee,F,Be,K){ee.drawMetrics(_e,F,Be,K)})},A.prototype.getEnglishName=function(_e){var le=this.names[_e];return le?le.en:void 0},A.prototype.validate=function(){function _e(B,q){B||pe.push(q)}function le(B){var q=T.getEnglishName(B);_e(q&&q.trim().length>0,"No English "+B+" specified.")}var pe=[],T=this;le("fontFamily"),le("weightName"),le("manufacturer"),le("copyright"),le("version"),_e(this.unitsPerEm>0,"No unitsPerEm specified.")},A.prototype.toTables=function(){return de.fontToTable(this)},A.prototype.toBuffer=function(){return console.warn("Font.toBuffer is deprecated. Use Font.toArrayBuffer instead."),this.toArrayBuffer()},A.prototype.toArrayBuffer=function(){for(var _e=this.toTables().encode(),le=new ArrayBuffer(_e.length),pe=new Uint8Array(le),T=0;T<_e.length;T++)pe[T]=_e[T];return le},A.prototype.download=function(){var _e=this.getEnglishName("fontFamily"),le=this.getEnglishName("fontSubfamily"),pe=_e.replace(/\s/g,"")+"-"+le+".otf",T=this.toArrayBuffer();if(fe.isBrowser())window.requestFileSystem=window.requestFileSystem||window.webkitRequestFileSystem,window.requestFileSystem(window.TEMPORARY,T.byteLength,function(ee){ee.root.getFile(pe,{create:!0},function(F){F.createWriter(function(Be){var K=new DataView(T),ve=new Blob([K],{type:"font/opentype"});Be.write(ve),Be.addEventListener("writeend",function(){location.href=F.toURL()},!1)})})},function(ee){throw new Error(ee.name+": "+ee.message)});else{var B=N("fs"),q=fe.arrayBufferToNodeBuffer(T);B.writeFileSync(pe,q)}},A.prototype.fsSelectionValues={ITALIC:1,UNDERSCORE:2,NEGATIVE:4,OUTLINED:8,STRIKEOUT:16,BOLD:32,REGULAR:64,USER_TYPO_METRICS:128,WWS:256,OBLIQUE:512},A.prototype.usWidthClasses={ULTRA_CONDENSED:1,EXTRA_CONDENSED:2,CONDENSED:3,SEMI_CONDENSED:4,MEDIUM:5,SEMI_EXPANDED:6,EXPANDED:7,EXTRA_EXPANDED:8,ULTRA_EXPANDED:9},A.prototype.usWeightClasses={THIN:100,EXTRA_LIGHT:200,LIGHT:300,NORMAL:400,MEDIUM:500,SEMI_BOLD:600,BOLD:700,EXTRA_BOLD:800,BLACK:900},G.Font=A},{"./encoding":4,"./glyphset":7,"./path":11,"./substitution":12,"./tables/sfnt":31,"./util":33,fs:void 0}],6:[function(N,U,G){function A(te){this.bindConstructorValues(te)}var P=N("./check"),de=N("./draw"),be=N("./path");A.prototype.bindConstructorValues=function(te){var fe;this.index=te.index||0,this.name=te.name||null,this.unicode=te.unicode||void 0,this.unicodes=te.unicodes||void 0!==te.unicode?[te.unicode]:[],te.xMin&&(this.xMin=te.xMin),te.yMin&&(this.yMin=te.yMin),te.xMax&&(this.xMax=te.xMax),te.yMax&&(this.yMax=te.yMax),te.advanceWidth&&(this.advanceWidth=te.advanceWidth),Object.defineProperty(this,"path",(fe=te.path||{commands:[]},{configurable:!0,get:function(){return"function"==typeof fe&&(fe=fe()),fe},set:function(_e){fe=_e}}))},A.prototype.addUnicode=function(te){0===this.unicodes.length&&(this.unicode=te),this.unicodes.push(te)},A.prototype.getPath=function(te,ce,fe,_e){te=void 0!==te?te:0,ce=void 0!==ce?ce:0;for(var le=1/this.path.unitsPerEm*(fe=void 0!==fe?fe:72),pe=(_e=void 0!==_e?_e:{xScale:1,yScale:1}).xScale*le,T=_e.yScale*le,B=new be.Path,q=this.path.commands,ee=0;ee<q.length;ee+=1){var F=q[ee];"M"===F.type?B.moveTo(te+F.x*pe,ce+-F.y*T):"L"===F.type?B.lineTo(te+F.x*pe,ce+-F.y*T):"Q"===F.type?B.quadraticCurveTo(te+F.x1*pe,ce+-F.y1*T,te+F.x*pe,ce+-F.y*T):"C"===F.type?B.curveTo(te+F.x1*pe,ce+-F.y1*T,te+F.x2*pe,ce+-F.y2*T,te+F.x*pe,ce+-F.y*T):"Z"===F.type&&B.closePath()}return B},A.prototype.getContours=function(){if(void 0===this.points)return[];for(var te=[],ce=[],fe=0;fe<this.points.length;fe+=1){var _e=this.points[fe];ce.push(_e),_e.lastPointOfContour&&(te.push(ce),ce=[])}return P.argument(0===ce.length,"There are still points left in the current contour."),te},A.prototype.getMetrics=function(){for(var te=this.path.commands,ce=[],fe=[],_e=0;_e<te.length;_e+=1){var le=te[_e];"Z"!==le.type&&(ce.push(le.x),fe.push(le.y)),("Q"===le.type||"C"===le.type)&&(ce.push(le.x1),fe.push(le.y1)),"C"===le.type&&(ce.push(le.x2),fe.push(le.y2))}var pe={xMin:Math.min.apply(null,ce),yMin:Math.min.apply(null,fe),xMax:Math.max.apply(null,ce),yMax:Math.max.apply(null,fe),leftSideBearing:this.leftSideBearing};return isFinite(pe.xMin)||(pe.xMin=0),isFinite(pe.xMax)||(pe.xMax=this.advanceWidth),isFinite(pe.yMin)||(pe.yMin=0),isFinite(pe.yMax)||(pe.yMax=0),pe.rightSideBearing=this.advanceWidth-pe.leftSideBearing-(pe.xMax-pe.xMin),pe},A.prototype.draw=function(te,ce,fe,_e,le){this.getPath(ce,fe,_e,le).draw(te)},A.prototype.drawPoints=function(te,ce,fe,_e){function le(Be,K,ve,Ae){var Fe=2*Math.PI;te.beginPath();for(var Ee=0;Ee<Be.length;Ee+=1)te.moveTo(K+Be[Ee].x*Ae,ve+Be[Ee].y*Ae),te.arc(K+Be[Ee].x*Ae,ve+Be[Ee].y*Ae,2,0,Fe,!1);te.closePath(),te.fill()}ce=void 0!==ce?ce:0,fe=void 0!==fe?fe:0;for(var pe=1/this.path.unitsPerEm*(_e=void 0!==_e?_e:24),T=[],B=[],q=this.path,ee=0;ee<q.commands.length;ee+=1){var F=q.commands[ee];void 0!==F.x&&T.push({x:F.x,y:-F.y}),void 0!==F.x1&&B.push({x:F.x1,y:-F.y1}),void 0!==F.x2&&B.push({x:F.x2,y:-F.y2})}te.fillStyle="blue",le(T,ce,fe,pe),te.fillStyle="red",le(B,ce,fe,pe)},A.prototype.drawMetrics=function(te,ce,fe,_e){var le;ce=void 0!==ce?ce:0,fe=void 0!==fe?fe:0,le=1/this.path.unitsPerEm*(_e=void 0!==_e?_e:24),te.lineWidth=1,te.strokeStyle="black",de.line(te,ce,-1e4,ce,1e4),de.line(te,-1e4,fe,1e4,fe);var pe=this.xMin||0,T=this.yMin||0,B=this.xMax||0,q=this.yMax||0,ee=this.advanceWidth||0;te.strokeStyle="blue",de.line(te,ce+pe*le,-1e4,ce+pe*le,1e4),de.line(te,ce+B*le,-1e4,ce+B*le,1e4),de.line(te,-1e4,fe+-T*le,1e4,fe+-T*le),de.line(te,-1e4,fe+-q*le,1e4,fe+-q*le),te.strokeStyle="green",de.line(te,ce+ee*le,-1e4,ce+ee*le,1e4)},G.Glyph=A},{"./check":2,"./draw":3,"./path":11}],7:[function(N,U,G){function A(be,te,ce){Object.defineProperty(be,te,{get:function(){return be[ce]},set:function(fe){be[ce]=fe},enumerable:!0,configurable:!0})}function P(be,te){if(this.font=be,this.glyphs={},Array.isArray(te))for(var ce=0;ce<te.length;ce++)this.glyphs[ce]=te[ce];this.length=te&&te.length||0}var de=N("./glyph");P.prototype.get=function(be){return"function"==typeof this.glyphs[be]&&(this.glyphs[be]=this.glyphs[be]()),this.glyphs[be]},P.prototype.push=function(be,te){this.glyphs[be]=te,this.length++},G.GlyphSet=P,G.glyphLoader=function(be,te){return new de.Glyph({index:te,font:be})},G.ttfGlyphLoader=function(be,te,ce,fe,_e,le){return function(){var pe=new de.Glyph({index:te,font:be});return pe.path=function(){ce(pe,fe,_e);var T=le(be.glyphs,pe);return T.unitsPerEm=be.unitsPerEm,T},A(pe,"xMin","_xMin"),A(pe,"xMax","_xMax"),A(pe,"yMin","_yMin"),A(pe,"yMax","_yMax"),pe}},G.cffGlyphLoader=function(be,te,ce,fe){return function(){var _e=new de.Glyph({index:te,font:be});return _e.path=function(){var le=ce(be,_e,fe);return le.unitsPerEm=be.unitsPerEm,le},_e}}},{"./glyph":6}],8:[function(N,U,G){function A(be,te){for(var ce=0,fe=be.length-1;fe>=ce;){var _e=ce+fe>>>1,le=be[_e].tag;if(le===te)return _e;te>le?ce=_e+1:fe=_e-1}return-ce-1}var P=N("./check");U.exports={searchTag:A,binSearch:function(be,te){for(var ce=0,fe=be.length-1;fe>=ce;){var _e=ce+fe>>>1,le=be[_e];if(le===te)return _e;te>le?ce=_e+1:fe=_e-1}return-ce-1},getScriptNames:function(){var be=this.getGsubTable();return be?be.scripts.map(function(te){return te.tag}):[]},getScriptTable:function(be,te){var ce=this.getGsubTable(te);if(ce){var fe=ce.scripts,_e=A(ce.scripts,be);if(_e>=0)return fe[_e].script;var le={tag:be,script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}};return fe.splice(-1-_e,0,le.script),le}},getLangSysTable:function(be,te,ce){var fe=this.getScriptTable(be,ce);if(fe){if("DFLT"===te)return fe.defaultLangSys;var _e=A(fe.langSysRecords,te);if(_e>=0)return fe.langSysRecords[_e].langSys;if(ce){var le={tag:te,langSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]}};return fe.langSysRecords.splice(-1-_e,0,le),le.langSys}}},getFeatureTable:function(be,te,ce,fe){var _e=this.getLangSysTable(be,te,fe);if(_e){for(var le,pe=_e.featureIndexes,T=this.font.tables.gsub.features,B=0;B<pe.length;B++)if((le=T[pe[B]]).tag===ce)return le.feature;if(fe){var q=T.length;return P.assert(0===q||ce>=T[q-1].tag,"Features must be added in alphabetical order."),T.push(le={tag:ce,feature:{params:0,lookupListIndexes:[]}}),pe.push(q),le.feature}}},getLookupTable:function(be,te,ce,fe,_e){var le=this.getFeatureTable(be,te,ce,_e);if(le){for(var pe,T=le.lookupListIndexes,B=this.font.tables.gsub.lookups,q=0;q<T.length;q++)if((pe=B[T[q]]).lookupType===fe)return pe;if(_e){var ee=B.length;return B.push(pe={lookupType:fe,lookupFlag:0,subtables:[],markFilteringSet:void 0}),T.push(ee),pe}}},expandCoverage:function(be){if(1===be.format)return be.glyphs;for(var te=[],ce=be.ranges,fe=0;ce>fe;fe++)for(var _e=ce[fe],pe=_e.end,T=_e.start;pe>=T;T++)te.push(T);return te}}},{"./check":2}],9:[function(N,U,G){function A(rn,ft){N("fs").readFile(rn,function(Tn,Cn){return Tn?ft(Tn.message):void ft(null,B.nodeBufferToArrayBuffer(Cn))})}function P(rn,ft){var Tn=new XMLHttpRequest;Tn.open("get",rn,!0),Tn.responseType="arraybuffer",Tn.onload=function(){return 200!==Tn.status?ft("Font could not be loaded: "+Tn.statusText):ft(null,Tn.response)},Tn.send()}function de(rn,ft){for(var Tn=[],Cn=12,mn=0;ft>mn;mn+=1){var Pn=pe.getTag(rn,Cn),$n=pe.getULong(rn,Cn+4),gn=pe.getULong(rn,Cn+8),ur=pe.getULong(rn,Cn+12);Tn.push({tag:Pn,checksum:$n,offset:gn,length:ur,compression:!1}),Cn+=16}return Tn}function be(rn,ft){if("WOFF"===ft.compression){var Tn=new Uint8Array(rn.buffer,ft.offset+2,ft.compressedLength-2),Cn=new Uint8Array(ft.originalLength);if(ce(Tn,Cn),Cn.byteLength!==ft.originalLength)throw new Error("Decompression error: "+ft.tag+" decompressed length doesn't match recorded length");return{data:new DataView(Cn.buffer,0),offset:0}}return{data:rn,offset:ft.offset}}function te(rn){var ft,Tn,Cn,mn=new _e.Font({empty:!0}),Pn=new DataView(rn,0),$n=[],gn=pe.getTag(Pn,0);if("\0\x01\0\0"===gn)mn.outlinesFormat="truetype",$n=de(Pn,Cn=pe.getUShort(Pn,4));else if("OTTO"===gn)mn.outlinesFormat="cff",$n=de(Pn,Cn=pe.getUShort(Pn,4));else{if("wOFF"!==gn)throw new Error("Unsupported OpenType signature "+gn);var ur=pe.getTag(Pn,4);if("\0\x01\0\0"===ur)mn.outlinesFormat="truetype";else{if("OTTO"!==ur)throw new Error("Unsupported OpenType flavor "+gn);mn.outlinesFormat="cff"}$n=function(Fu,ps){for(var Hs=[],ii=44,Pc=0;ps>Pc;Pc+=1){var Ya=pe.getTag(Fu,ii),Jp=pe.getULong(Fu,ii+4),ea=pe.getULong(Fu,ii+8),kl=pe.getULong(Fu,ii+12);Hs.push({tag:Ya,offset:Jp,compression:kl>ea&&"WOFF",compressedLength:ea,originalLength:kl}),ii+=20}return Hs}(Pn,Cn=pe.getUShort(Pn,12))}for(var or,hr,sr,ei,Jr,ci,ir,vr,pi,go,Nr=0;Cn>Nr;Nr+=1){var Zr,Vr=$n[Nr];switch(Vr.tag){case"cmap":Zr=be(Pn,Vr),mn.tables.cmap=q.parse(Zr.data,Zr.offset),mn.encoding=new fe.CmapEncoding(mn.tables.cmap);break;case"fvar":hr=Vr;break;case"head":Zr=be(Pn,Vr),mn.tables.head=Ae.parse(Zr.data,Zr.offset),mn.unitsPerEm=mn.tables.head.unitsPerEm,ft=mn.tables.head.indexToLocFormat;break;case"hhea":Zr=be(Pn,Vr),mn.tables.hhea=Fe.parse(Zr.data,Zr.offset),mn.ascender=mn.tables.hhea.ascender,mn.descender=mn.tables.hhea.descender,mn.numberOfHMetrics=mn.tables.hhea.numberOfHMetrics;break;case"hmtx":ci=Vr;break;case"ltag":Zr=be(Pn,Vr),Tn=Ke.parse(Zr.data,Zr.offset);break;case"maxp":Zr=be(Pn,Vr),mn.tables.maxp=at.parse(Zr.data,Zr.offset),mn.numGlyphs=mn.tables.maxp.numGlyphs;break;case"name":pi=Vr;break;case"OS/2":Zr=be(Pn,Vr),mn.tables.os2=wt.parse(Zr.data,Zr.offset);break;case"post":Zr=be(Pn,Vr),mn.tables.post=Ft.parse(Zr.data,Zr.offset),mn.glyphNames=new fe.GlyphNames(mn.tables.post);break;case"glyf":sr=Vr;break;case"loca":vr=Vr;break;case"CFF ":or=Vr;break;case"kern":ir=Vr;break;case"GPOS":ei=Vr;break;case"GSUB":Jr=Vr;break;case"meta":go=Vr}}var fi=be(Pn,pi);if(mn.tables.name=Ct.parse(fi.data,fi.offset,Tn),mn.names=mn.tables.name,sr&&vr){var bi=0===ft,So=be(Pn,vr),Gs=gt.parse(So.data,So.offset,mn.numGlyphs,bi),Ks=be(Pn,sr);mn.glyphs=Be.parse(Ks.data,Ks.offset,Gs,mn)}else{if(!or)throw new Error("Font doesn't contain TrueType or CFF outlines.");var Di=be(Pn,or);ee.parse(Di.data,Di.offset,mn)}var Eo=be(Pn,ci);if(Ee.parse(Eo.data,Eo.offset,mn.numberOfHMetrics,mn.numGlyphs,mn.glyphs),fe.addGlyphNames(mn),ir){var vo=be(Pn,ir);mn.kerningPairs=qe.parse(vo.data,vo.offset)}else mn.kerningPairs={};if(ei){var Xr=be(Pn,ei);K.parse(Xr.data,Xr.offset,mn)}if(Jr){var ss=be(Pn,Jr);mn.tables.gsub=ve.parse(ss.data,ss.offset)}if(hr){var Or=be(Pn,hr);mn.tables.fvar=F.parse(Or.data,Or.offset,mn.names)}if(go){var Na=be(Pn,go);mn.tables.meta=Ot.parse(Na.data,Na.offset),mn.metas=mn.tables.meta}return mn}var ce=N("tiny-inflate"),fe=N("./encoding"),_e=N("./font"),le=N("./glyph"),pe=N("./parse"),T=N("./path"),B=N("./util"),q=N("./tables/cmap"),ee=N("./tables/cff"),F=N("./tables/fvar"),Be=N("./tables/glyf"),K=N("./tables/gpos"),ve=N("./tables/gsub"),Ae=N("./tables/head"),Fe=N("./tables/hhea"),Ee=N("./tables/hmtx"),qe=N("./tables/kern"),Ke=N("./tables/ltag"),gt=N("./tables/loca"),at=N("./tables/maxp"),Ct=N("./tables/name"),wt=N("./tables/os2"),Ft=N("./tables/post"),Ot=N("./tables/meta");G._parse=pe,G.Font=_e.Font,G.Glyph=le.Glyph,G.Path=T.Path,G.parse=te,G.load=function(rn,ft){(typeof window>"u"?A:P)(rn,function(Tn,Cn){if(Tn)return ft(Tn);var mn;try{mn=te(Cn)}catch(Pn){return ft(Pn,null)}return ft(null,mn)})},G.loadSync=function(rn){var ft=N("fs").readFileSync(rn);return te(B.nodeBufferToArrayBuffer(ft))}},{"./encoding":4,"./font":5,"./glyph":6,"./parse":10,"./path":11,"./tables/cff":14,"./tables/cmap":15,"./tables/fvar":16,"./tables/glyf":17,"./tables/gpos":18,"./tables/gsub":19,"./tables/head":20,"./tables/hhea":21,"./tables/hmtx":22,"./tables/kern":23,"./tables/loca":24,"./tables/ltag":25,"./tables/maxp":26,"./tables/meta":27,"./tables/name":28,"./tables/os2":29,"./tables/post":30,"./util":33,fs:void 0,"tiny-inflate":1}],10:[function(N,U,G){function A(ce,fe){return ce.getUint16(fe,!1)}function P(ce,fe){this.data=ce,this.offset=fe,this.relativeOffset=0}var de=N("./check");G.getByte=function(ce,fe){return ce.getUint8(fe)},G.getCard8=G.getByte,G.getUShort=G.getCard16=A,G.getShort=function(ce,fe){return ce.getInt16(fe,!1)},G.getULong=function(ce,fe){return ce.getUint32(fe,!1)},G.getFixed=function(ce,fe){return ce.getInt16(fe,!1)+ce.getUint16(fe+2,!1)/65535},G.getTag=function(ce,fe){for(var _e="",le=fe;fe+4>le;le+=1)_e+=String.fromCharCode(ce.getInt8(le));return _e},G.getOffset=function(ce,fe,_e){for(var le=0,pe=0;_e>pe;pe+=1)le<<=8,le+=ce.getUint8(fe+pe);return le},G.getBytes=function(ce,fe,_e){for(var le=[],pe=fe;_e>pe;pe+=1)le.push(ce.getUint8(pe));return le},G.bytesToString=function(ce){for(var fe="",_e=0;_e<ce.length;_e+=1)fe+=String.fromCharCode(ce[_e]);return fe};var be={byte:1,uShort:2,short:2,uLong:4,fixed:4,longDateTime:8,tag:4};P.prototype.parseByte=function(){var ce=this.data.getUint8(this.offset+this.relativeOffset);return this.relativeOffset+=1,ce},P.prototype.parseChar=function(){var ce=this.data.getInt8(this.offset+this.relativeOffset);return this.relativeOffset+=1,ce},P.prototype.parseCard8=P.prototype.parseByte,P.prototype.parseCard16=P.prototype.parseUShort=function(){var ce=this.data.getUint16(this.offset+this.relativeOffset);return this.relativeOffset+=2,ce},P.prototype.parseSID=P.prototype.parseUShort,P.prototype.parseOffset16=P.prototype.parseUShort,P.prototype.parseShort=function(){var ce=this.data.getInt16(this.offset+this.relativeOffset);return this.relativeOffset+=2,ce},P.prototype.parseF2Dot14=function(){var ce=this.data.getInt16(this.offset+this.relativeOffset)/16384;return this.relativeOffset+=2,ce},P.prototype.parseULong=function(){var ce=G.getULong(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,ce},P.prototype.parseFixed=function(){var ce=G.getFixed(this.data,this.offset+this.relativeOffset);return this.relativeOffset+=4,ce},P.prototype.parseString=function(ce){var fe=this.data,_e=this.offset+this.relativeOffset,le="";this.relativeOffset+=ce;for(var pe=0;ce>pe;pe++)le+=String.fromCharCode(fe.getUint8(_e+pe));return le},P.prototype.parseTag=function(){return this.parseString(4)},P.prototype.parseLongDateTime=function(){var ce=G.getULong(this.data,this.offset+this.relativeOffset+4);return ce-=2082844800,this.relativeOffset+=8,ce},P.prototype.parseVersion=function(){var ce=A(this.data,this.offset+this.relativeOffset),fe=A(this.data,this.offset+this.relativeOffset+2);return this.relativeOffset+=4,ce+fe/4096/10},P.prototype.skip=function(ce,fe){void 0===fe&&(fe=1),this.relativeOffset+=be[ce]*fe},P.prototype.parseOffset16List=P.prototype.parseUShortList=function(ce){void 0===ce&&(ce=this.parseUShort());for(var fe=new Array(ce),_e=this.data,le=this.offset+this.relativeOffset,pe=0;ce>pe;pe++)fe[pe]=_e.getUint16(le),le+=2;return this.relativeOffset+=2*ce,fe},P.prototype.parseList=function(ce,fe){fe||(fe=ce,ce=this.parseUShort());for(var _e=new Array(ce),le=0;ce>le;le++)_e[le]=fe.call(this);return _e},P.prototype.parseRecordList=function(ce,fe){fe||(fe=ce,ce=this.parseUShort());for(var _e=new Array(ce),le=Object.keys(fe),pe=0;ce>pe;pe++){for(var T={},B=0;B<le.length;B++){var q=le[B];T[q]=fe[q].call(this)}_e[pe]=T}return _e},P.prototype.parseStruct=function(ce){if("function"==typeof ce)return ce.call(this);for(var fe=Object.keys(ce),_e={},le=0;le<fe.length;le++){var pe=fe[le];_e[pe]=ce[pe].call(this)}return _e},P.prototype.parsePointer=function(ce){var fe=this.parseOffset16();return fe>0?new P(this.data,this.offset+fe).parseStruct(ce):void 0},P.prototype.parseListOfLists=function(ce){for(var fe=this.parseOffset16List(),_e=fe.length,le=this.relativeOffset,pe=new Array(_e),T=0;_e>T;T++){var B=fe[T];if(0!==B)if(this.relativeOffset=B,ce){for(var q=this.parseOffset16List(),ee=new Array(q.length),F=0;F<q.length;F++)this.relativeOffset=B+q[F],ee[F]=ce.call(this);pe[T]=ee}else pe[T]=this.parseUShortList();else pe[T]=void 0}return this.relativeOffset=le,pe},P.prototype.parseCoverage=function(){var ce=this.offset+this.relativeOffset,fe=this.parseUShort(),_e=this.parseUShort();if(1===fe)return{format:1,glyphs:this.parseUShortList(_e)};if(2===fe){for(var le=new Array(_e),pe=0;_e>pe;pe++)le[pe]={start:this.parseUShort(),end:this.parseUShort(),index:this.parseUShort()};return{format:2,ranges:le}}de.assert(!1,"0x"+ce.toString(16)+": Coverage format must be 1 or 2.")},P.prototype.parseClassDef=function(){var ce=this.offset+this.relativeOffset,fe=this.parseUShort();return 1===fe?{format:1,startGlyph:this.parseUShort(),classes:this.parseUShortList()}:2===fe?{format:2,ranges:this.parseRecordList({start:P.uShort,end:P.uShort,classId:P.uShort})}:void de.assert(!1,"0x"+ce.toString(16)+": ClassDef format must be 1 or 2.")},P.list=function(ce,fe){return function(){return this.parseList(ce,fe)}},P.recordList=function(ce,fe){return function(){return this.parseRecordList(ce,fe)}},P.pointer=function(ce){return function(){return this.parsePointer(ce)}},P.tag=P.prototype.parseTag,P.byte=P.prototype.parseByte,P.uShort=P.offset16=P.prototype.parseUShort,P.uShortList=P.prototype.parseUShortList,P.struct=P.prototype.parseStruct,P.coverage=P.prototype.parseCoverage,P.classDef=P.prototype.parseClassDef;var te={reserved:P.uShort,reqFeatureIndex:P.uShort,featureIndexes:P.uShortList};P.prototype.parseScriptList=function(){return this.parsePointer(P.recordList({tag:P.tag,script:P.pointer({defaultLangSys:P.pointer(te),langSysRecords:P.recordList({tag:P.tag,langSys:P.pointer(te)})})}))},P.prototype.parseFeatureList=function(){return this.parsePointer(P.recordList({tag:P.tag,feature:P.pointer({featureParams:P.offset16,lookupListIndexes:P.uShortList})}))},P.prototype.parseLookupList=function(ce){return this.parsePointer(P.list(P.pointer(function(){var fe=this.parseUShort();de.argument(fe>=1&&8>=fe,"GSUB lookup type "+fe+" unknown.");var _e=this.parseUShort(),le=16&_e;return{lookupType:fe,lookupFlag:_e,subtables:this.parseList(P.pointer(ce[fe])),markFilteringSet:le?this.parseUShort():void 0}})))},G.Parser=P},{"./check":2}],11:[function(N,U,G){function A(){this.commands=[],this.fill="black",this.stroke=null,this.strokeWidth=1}A.prototype.moveTo=function(P,de){this.commands.push({type:"M",x:P,y:de})},A.prototype.lineTo=function(P,de){this.commands.push({type:"L",x:P,y:de})},A.prototype.curveTo=A.prototype.bezierCurveTo=function(P,de,be,te,ce,fe){this.commands.push({type:"C",x1:P,y1:de,x2:be,y2:te,x:ce,y:fe})},A.prototype.quadTo=A.prototype.quadraticCurveTo=function(P,de,be,te){this.commands.push({type:"Q",x1:P,y1:de,x:be,y:te})},A.prototype.close=A.prototype.closePath=function(){this.commands.push({type:"Z"})},A.prototype.extend=function(P){P.commands&&(P=P.commands),Array.prototype.push.apply(this.commands,P)},A.prototype.draw=function(P){P.beginPath();for(var de=0;de<this.commands.length;de+=1){var be=this.commands[de];"M"===be.type?P.moveTo(be.x,be.y):"L"===be.type?P.lineTo(be.x,be.y):"C"===be.type?P.bezierCurveTo(be.x1,be.y1,be.x2,be.y2,be.x,be.y):"Q"===be.type?P.quadraticCurveTo(be.x1,be.y1,be.x,be.y):"Z"===be.type&&P.closePath()}this.fill&&(P.fillStyle=this.fill,P.fill()),this.stroke&&(P.strokeStyle=this.stroke,P.lineWidth=this.strokeWidth,P.stroke())},A.prototype.toPathData=function(P){function de(_e){return Math.round(_e)===_e?""+Math.round(_e):_e.toFixed(P)}function be(){for(var _e="",le=0;le<arguments.length;le+=1){var pe=arguments[le];pe>=0&&le>0&&(_e+=" "),_e+=de(pe)}return _e}P=void 0!==P?P:2;for(var te="",ce=0;ce<this.commands.length;ce+=1){var fe=this.commands[ce];"M"===fe.type?te+="M"+be(fe.x,fe.y):"L"===fe.type?te+="L"+be(fe.x,fe.y):"C"===fe.type?te+="C"+be(fe.x1,fe.y1,fe.x2,fe.y2,fe.x,fe.y):"Q"===fe.type?te+="Q"+be(fe.x1,fe.y1,fe.x,fe.y):"Z"===fe.type&&(te+="Z")}return te},A.prototype.toSVG=function(P){var de='<path d="';return de+=this.toPathData(P),de+='"',this.fill&&"black"!==this.fill&&(de+=null===this.fill?' fill="none"':' fill="'+this.fill+'"'),this.stroke&&(de+=' stroke="'+this.stroke+'" stroke-width="'+this.strokeWidth+'"'),de+"/>"},G.Path=A},{}],12:[function(N,U,G){function A(ce,fe){var _e=ce.length;if(_e!==fe.length)return!1;for(var le=0;_e>le;le++)if(ce[le]!==fe[le])return!1;return!0}function P(ce,fe,_e){for(var le=ce.subtables,pe=0;pe<le.length;pe++){var T=le[pe];if(T.substFormat===fe)return T}return _e?(le.push(_e),_e):void 0}var de=N("./check"),be=N("./layout"),te=function(ce){this.font=ce};(te.prototype=be).getGsubTable=function(ce){var fe=this.font.tables.gsub;return!fe&&ce&&(this.font.tables.gsub=fe={version:1,scripts:[{tag:"DFLT",script:{defaultLangSys:{reserved:0,reqFeatureIndex:65535,featureIndexes:[]},langSysRecords:[]}}],features:[],lookups:[]}),fe},te.prototype.getSingle=function(ce,fe,_e){var le=[],pe=this.getLookupTable(fe,_e,ce,1);if(!pe)return le;for(var T=pe.subtables,B=0;B<T.length;B++){var q,ee=T[B],F=this.expandCoverage(ee.coverage);if(1===ee.substFormat){var Be=ee.deltaGlyphId;for(q=0;q<F.length;q++){var K=F[q];le.push({sub:K,by:K+Be})}}else{var ve=ee.substitute;for(q=0;q<F.length;q++)le.push({sub:F[q],by:ve[q]})}}return le},te.prototype.getAlternates=function(ce,fe,_e){var le=[],pe=this.getLookupTable(fe,_e,ce,3);if(!pe)return le;for(var T=pe.subtables,B=0;B<T.length;B++)for(var q=T[B],ee=this.expandCoverage(q.coverage),F=q.alternateSets,Be=0;Be<ee.length;Be++)le.push({sub:ee[Be],by:F[Be]});return le},te.prototype.getLigatures=function(ce,fe,_e){var le=[],pe=this.getLookupTable(fe,_e,ce,4);if(!pe)return[];for(var T=pe.subtables,B=0;B<T.length;B++)for(var q=T[B],ee=this.expandCoverage(q.coverage),F=q.ligatureSets,Be=0;Be<ee.length;Be++)for(var K=ee[Be],ve=F[Be],Ae=0;Ae<ve.length;Ae++){var Fe=ve[Ae];le.push({sub:[K].concat(Fe.components),by:Fe.ligGlyph})}return le},te.prototype.addSingle=function(ce,fe,_e,le){var pe=P(this.getLookupTable(_e,le,ce,1,!0),2,{substFormat:2,coverage:{format:1,glyphs:[]},substitute:[]});de.assert(1===pe.coverage.format,"Ligature: unable to modify coverage table format "+pe.coverage.format);var T=fe.sub,B=this.binSearch(pe.coverage.glyphs,T);0>B&&(pe.coverage.glyphs.splice(B=-1-B,0,T),pe.substitute.splice(B,0,0)),pe.substitute[B]=fe.by},te.prototype.addAlternate=function(ce,fe,_e,le){var pe=P(this.getLookupTable(_e,le,ce,3,!0),1,{substFormat:1,coverage:{format:1,glyphs:[]},alternateSets:[]});de.assert(1===pe.coverage.format,"Ligature: unable to modify coverage table format "+pe.coverage.format);var T=fe.sub,B=this.binSearch(pe.coverage.glyphs,T);0>B&&(pe.coverage.glyphs.splice(B=-1-B,0,T),pe.alternateSets.splice(B,0,0)),pe.alternateSets[B]=fe.by},te.prototype.addLigature=function(ce,fe,_e,le){var pe=this.getLookupTable(_e=_e||"DFLT",le=le||"DFLT",ce,4,!0),T=pe.subtables[0];T||(pe.subtables[0]=T={substFormat:1,coverage:{format:1,glyphs:[]},ligatureSets:[]}),de.assert(1===T.coverage.format,"Ligature: unable to modify coverage table format "+T.coverage.format);var B=fe.sub[0],q=fe.sub.slice(1),ee={ligGlyph:fe.by,components:q},F=this.binSearch(T.coverage.glyphs,B);if(F>=0){for(var Be=T.ligatureSets[F],K=0;K<Be.length;K++)if(A(Be[K].components,q))return;Be.push(ee)}else T.coverage.glyphs.splice(F=-1-F,0,B),T.ligatureSets.splice(F,0,[ee])},te.prototype.getFeature=function(ce,fe,_e){if(fe=fe||"DFLT",_e=_e||"DFLT",/ss\d\d/.test(ce))return this.getSingle(ce,fe,_e);switch(ce){case"aalt":case"salt":return this.getSingle(ce,fe,_e).concat(this.getAlternates(ce,fe,_e));case"dlig":case"liga":case"rlig":return this.getLigatures(ce,fe,_e)}},te.prototype.add=function(ce,fe,_e,le){if(_e=_e||"DFLT",le=le||"DFLT",/ss\d\d/.test(ce))return this.addSingle(ce,fe,_e,le);switch(ce){case"aalt":case"salt":return"number"==typeof fe.by?this.addSingle(ce,fe,_e,le):this.addAlternate(ce,fe,_e,le);case"dlig":case"liga":case"rlig":return this.addLigature(ce,fe,_e,le)}},U.exports=te},{"./check":2,"./layout":8}],13:[function(N,U,G){function A(B,q,ee){var F;for(F=0;F<q.length;F+=1){var Be=q[F];this[Be.name]=Be.value}if(this.tableName=B,this.fields=q,ee){var K=Object.keys(ee);for(F=0;F<K.length;F+=1){var ve=K[F];void 0!==this[ve]&&(this[ve]=ee[ve])}}}function P(B,q,ee){void 0===ee&&(ee=q.length);var F=new Array(q.length+1);F[0]={name:B+"Count",type:"USHORT",value:ee};for(var Be=0;Be<q.length;Be++)F[Be+1]={name:B+Be,type:"USHORT",value:q[Be]};return F}function de(B,q,ee){var F=q.length,Be=new Array(F+1);Be[0]={name:B+"Count",type:"USHORT",value:F};for(var K=0;F>K;K++)Be[K+1]={name:B+K,type:"TABLE",value:ee(q[K],K)};return Be}function be(B,q,ee){var F=q.length,Be=[];Be[0]={name:B+"Count",type:"USHORT",value:F};for(var K=0;F>K;K++)Be=Be.concat(ee(q[K],K));return Be}function te(B){1===B.format?A.call(this,"coverageTable",[{name:"coverageFormat",type:"USHORT",value:1}].concat(P("glyph",B.glyphs))):le.assert(!1,"Can't create coverage table format 2 yet.")}function ce(B){A.call(this,"scriptListTable",be("scriptRecord",B,function(q,ee){var F=q.script,Be=F.defaultLangSys;return le.assert(!!Be,"Unable to write GSUB: script "+q.tag+" has no default language system."),[{name:"scriptTag"+ee,type:"TAG",value:q.tag},{name:"script"+ee,type:"TABLE",value:new A("scriptTable",[{name:"defaultLangSys",type:"TABLE",value:new A("defaultLangSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:Be.reqFeatureIndex}].concat(P("featureIndex",Be.featureIndexes)))}].concat(be("langSys",F.langSysRecords,function(K,ve){var Ae=K.langSys;return[{name:"langSysTag"+ve,type:"TAG",value:K.tag},{name:"langSys"+ve,type:"TABLE",value:new A("langSys",[{name:"lookupOrder",type:"USHORT",value:0},{name:"reqFeatureIndex",type:"USHORT",value:Ae.reqFeatureIndex}].concat(P("featureIndex",Ae.featureIndexes)))}]})))}]}))}function fe(B){A.call(this,"featureListTable",be("featureRecord",B,function(q,ee){var F=q.feature;return[{name:"featureTag"+ee,type:"TAG",value:q.tag},{name:"feature"+ee,type:"TABLE",value:new A("featureTable",[{name:"featureParams",type:"USHORT",value:F.featureParams}].concat(P("lookupListIndex",F.lookupListIndexes)))}]}))}function _e(B,q){A.call(this,"lookupListTable",de("lookup",B,function(ee){var F=q[ee.lookupType];return le.assert(!!F,"Unable to write GSUB lookup type "+ee.lookupType+" tables."),new A("lookupTable",[{name:"lookupType",type:"USHORT",value:ee.lookupType},{name:"lookupFlag",type:"USHORT",value:ee.lookupFlag}].concat(de("subtable",ee.subtables,F)))}))}var le=N("./check"),pe=N("./types").encode,T=N("./types").sizeOf;A.prototype.encode=function(){return pe.TABLE(this)},A.prototype.sizeOf=function(){return T.TABLE(this)},(te.prototype=Object.create(A.prototype)).constructor=te,(ce.prototype=Object.create(A.prototype)).constructor=ce,(fe.prototype=Object.create(A.prototype)).constructor=fe,(_e.prototype=Object.create(A.prototype)).constructor=_e,G.Record=G.Table=A,G.Coverage=te,G.ScriptList=ce,G.FeatureList=fe,G.LookupList=_e,G.ushortList=P,G.tableList=de,G.recordList=be},{"./check":2,"./types":32}],14:[function(N,U,G){function A(Ee,qe){if(Ee===qe)return!0;if(Array.isArray(Ee)&&Array.isArray(qe)){if(Ee.length!==qe.length)return!1;for(var Ke=0;Ke<Ee.length;Ke+=1)if(!A(Ee[Ke],qe[Ke]))return!1;return!0}return!1}function P(Ee,qe,Ke){var gt,at,Ct,wt=[],Ft=[],Ot=Be.getCard16(Ee,qe);if(0!==Ot){var rn=Be.getByte(Ee,qe+2);at=qe+(Ot+1)*rn+2;var ft=qe+3;for(gt=0;Ot+1>gt;gt+=1)wt.push(Be.getOffset(Ee,ft,rn)),ft+=rn;Ct=at+wt[Ot]}else Ct=qe+2;for(gt=0;gt<wt.length-1;gt+=1){var Tn=Be.getBytes(Ee,at+wt[gt],at+wt[gt+1]);Ke&&(Tn=Ke(Tn)),Ft.push(Tn)}return{objects:Ft,startOffset:qe,endOffset:Ct}}function de(Ee,qe){if(28===qe)return Ee.parseByte()<<8|Ee.parseByte();if(29===qe)return Ee.parseByte()<<24|Ee.parseByte()<<16|Ee.parseByte()<<8|Ee.parseByte();if(30===qe)return function(Ke){for(var gt="",at=["0","1","2","3","4","5","6","7","8","9",".","E","E-",null,"-"];;){var Ct=Ke.parseByte(),wt=Ct>>4,Ft=15&Ct;if(15===wt||(gt+=at[wt],15===Ft))break;gt+=at[Ft]}return parseFloat(gt)}(Ee);if(qe>=32&&246>=qe)return qe-139;if(qe>=247&&250>=qe)return 256*(qe-247)+Ee.parseByte()+108;if(qe>=251&&254>=qe)return 256*-(qe-251)-Ee.parseByte()-108;throw new Error("Invalid b0 "+qe)}function be(Ee,qe,Ke){var gt=new Be.Parser(Ee,qe=void 0!==qe?qe:0),at=[],Ct=[];for(Ke=void 0!==Ke?Ke:Ee.length;gt.relativeOffset<Ke;){var wt=gt.parseByte();21>=wt?(12===wt&&(wt=1200+gt.parseByte()),at.push([wt,Ct]),Ct=[]):Ct.push(de(gt,wt))}return function(Ft){for(var Ot={},rn=0;rn<Ft.length;rn+=1){var ft,Tn=Ft[rn][0],Cn=Ft[rn][1];if(ft=1===Cn.length?Cn[0]:Cn,Ot.hasOwnProperty(Tn))throw new Error("Object "+Ot+" already has key "+Tn);Ot[Tn]=ft}return Ot}(at)}function te(Ee,qe){return 390>=qe?ee.cffStandardStrings[qe]:Ee[qe-391]}function ce(Ee,qe,Ke){for(var gt={},at=0;at<qe.length;at+=1){var Ct=qe[at],wt=Ee[Ct.op];void 0===wt&&(wt=void 0!==Ct.value?Ct.value:null),"SID"===Ct.type&&(wt=te(Ke,wt)),gt[Ct.name]=wt}return gt}function fe(Ee,qe,Ke){function gt(ur,or){Pn&&rn.closePath(),rn.moveTo(ur,or),Pn=!0}function at(){ft.length%2!=0&&!Cn&&(mn=ft.shift()+Ee.nominalWidthX),Tn+=ft.length>>1,ft.length=0,Cn=!0}var Ct,wt,Ft,Ot,rn=new K.Path,ft=[],Tn=0,Cn=!1,mn=Ee.defaultWidthX,Pn=!1,$n=0,gn=0;return function ur(or){for(var hr,sr,ei,Jr,ci,ir,vr,pi,go,Nr,Zr,Vr,fi=0;fi<or.length;){var bi=or[fi];switch(fi+=1,bi){case 1:case 3:case 18:case 23:at();break;case 4:ft.length>1&&!Cn&&(mn=ft.shift()+Ee.nominalWidthX,Cn=!0),gn+=ft.pop(),gt($n,gn);break;case 5:for(;ft.length>0;)$n+=ft.shift(),gn+=ft.shift(),rn.lineTo($n,gn);break;case 6:for(;ft.length>0&&($n+=ft.shift(),rn.lineTo($n,gn),0!==ft.length);)gn+=ft.shift(),rn.lineTo($n,gn);break;case 7:for(;ft.length>0&&(gn+=ft.shift(),rn.lineTo($n,gn),0!==ft.length);)$n+=ft.shift(),rn.lineTo($n,gn);break;case 8:for(;ft.length>0;)Ct=$n+ft.shift(),wt=gn+ft.shift(),Ft=Ct+ft.shift(),Ot=wt+ft.shift(),$n=Ft+ft.shift(),gn=Ot+ft.shift(),rn.curveTo(Ct,wt,Ft,Ot,$n,gn);break;case 10:ci=ft.pop()+Ee.subrsBias,(ir=Ee.subrs[ci])&&ur(ir);break;case 11:return;case 12:switch(bi=or[fi],fi+=1,bi){case 35:Ct=$n+ft.shift(),wt=gn+ft.shift(),Ft=Ct+ft.shift(),Ot=wt+ft.shift(),vr=Ft+ft.shift(),pi=Ot+ft.shift(),go=vr+ft.shift(),Nr=pi+ft.shift(),Zr=go+ft.shift(),Vr=Nr+ft.shift(),$n=Zr+ft.shift(),gn=Vr+ft.shift(),ft.shift(),rn.curveTo(Ct,wt,Ft,Ot,vr,pi),rn.curveTo(go,Nr,Zr,Vr,$n,gn);break;case 34:Ct=$n+ft.shift(),wt=gn,Ft=Ct+ft.shift(),Ot=wt+ft.shift(),vr=Ft+ft.shift(),pi=Ot,go=vr+ft.shift(),Nr=Ot,Zr=go+ft.shift(),Vr=gn,$n=Zr+ft.shift(),rn.curveTo(Ct,wt,Ft,Ot,vr,pi),rn.curveTo(go,Nr,Zr,Vr,$n,gn);break;case 36:Ct=$n+ft.shift(),wt=gn+ft.shift(),Ft=Ct+ft.shift(),Ot=wt+ft.shift(),vr=Ft+ft.shift(),pi=Ot,go=vr+ft.shift(),Nr=Ot,Zr=go+ft.shift(),Vr=Nr+ft.shift(),$n=Zr+ft.shift(),rn.curveTo(Ct,wt,Ft,Ot,vr,pi),rn.curveTo(go,Nr,Zr,Vr,$n,gn);break;case 37:Ct=$n+ft.shift(),wt=gn+ft.shift(),Ft=Ct+ft.shift(),Ot=wt+ft.shift(),vr=Ft+ft.shift(),pi=Ot+ft.shift(),go=vr+ft.shift(),Nr=pi+ft.shift(),Zr=go+ft.shift(),Vr=Nr+ft.shift(),Math.abs(Zr-$n)>Math.abs(Vr-gn)?$n=Zr+ft.shift():gn=Vr+ft.shift(),rn.curveTo(Ct,wt,Ft,Ot,vr,pi),rn.curveTo(go,Nr,Zr,Vr,$n,gn);break;default:console.log("Glyph "+qe.index+": unknown operator 1200"+bi),ft.length=0}break;case 14:ft.length>0&&!Cn&&(mn=ft.shift()+Ee.nominalWidthX,Cn=!0),Pn&&(rn.closePath(),Pn=!1);break;case 19:case 20:at(),fi+=Tn+7>>3;break;case 21:ft.length>2&&!Cn&&(mn=ft.shift()+Ee.nominalWidthX,Cn=!0),gn+=ft.pop(),gt($n+=ft.pop(),gn);break;case 22:ft.length>1&&!Cn&&(mn=ft.shift()+Ee.nominalWidthX,Cn=!0),gt($n+=ft.pop(),gn);break;case 24:for(;ft.length>2;)Ct=$n+ft.shift(),wt=gn+ft.shift(),Ft=Ct+ft.shift(),Ot=wt+ft.shift(),$n=Ft+ft.shift(),gn=Ot+ft.shift(),rn.curveTo(Ct,wt,Ft,Ot,$n,gn);$n+=ft.shift(),gn+=ft.shift(),rn.lineTo($n,gn);break;case 25:for(;ft.length>6;)$n+=ft.shift(),gn+=ft.shift(),rn.lineTo($n,gn);Ct=$n+ft.shift(),wt=gn+ft.shift(),Ft=Ct+ft.shift(),Ot=wt+ft.shift(),$n=Ft+ft.shift(),gn=Ot+ft.shift(),rn.curveTo(Ct,wt,Ft,Ot,$n,gn);break;case 26:for(ft.length%2&&($n+=ft.shift());ft.length>0;)Ct=$n,wt=gn+ft.shift(),Ft=Ct+ft.shift(),Ot=wt+ft.shift(),$n=Ft,gn=Ot+ft.shift(),rn.curveTo(Ct,wt,Ft,Ot,$n,gn);break;case 27:for(ft.length%2&&(gn+=ft.shift());ft.length>0;)Ct=$n+ft.shift(),wt=gn,Ft=Ct+ft.shift(),Ot=wt+ft.shift(),$n=Ft+ft.shift(),rn.curveTo(Ct,wt,Ft,Ot,$n,gn=Ot);break;case 28:ft.push(((hr=or[fi])<<24|(sr=or[fi+1])<<16)>>16),fi+=2;break;case 29:ci=ft.pop()+Ee.gsubrsBias,(ir=Ee.gsubrs[ci])&&ur(ir);break;case 30:for(;ft.length>0&&(Ct=$n,wt=gn+ft.shift(),Ft=Ct+ft.shift(),Ot=wt+ft.shift(),$n=Ft+ft.shift(),gn=Ot+(1===ft.length?ft.shift():0),rn.curveTo(Ct,wt,Ft,Ot,$n,gn),0!==ft.length);)Ct=$n+ft.shift(),wt=gn,Ft=Ct+ft.shift(),Ot=wt+ft.shift(),gn=Ot+ft.shift(),$n=Ft+(1===ft.length?ft.shift():0),rn.curveTo(Ct,wt,Ft,Ot,$n,gn);break;case 31:for(;ft.length>0&&(Ct=$n+ft.shift(),wt=gn,Ft=Ct+ft.shift(),Ot=wt+ft.shift(),gn=Ot+ft.shift(),$n=Ft+(1===ft.length?ft.shift():0),rn.curveTo(Ct,wt,Ft,Ot,$n,gn),0!==ft.length);)Ct=$n,wt=gn+ft.shift(),Ft=Ct+ft.shift(),Ot=wt+ft.shift(),$n=Ft+ft.shift(),gn=Ot+(1===ft.length?ft.shift():0),rn.curveTo(Ct,wt,Ft,Ot,$n,gn);break;default:32>bi?console.log("Glyph "+qe.index+": unknown operator "+bi):247>bi?ft.push(bi-139):251>bi?(hr=or[fi],fi+=1,ft.push(256*(bi-247)+hr+108)):255>bi?(hr=or[fi],fi+=1,ft.push(256*-(bi-251)-hr-108)):(hr=or[fi],sr=or[fi+1],ei=or[fi+2],Jr=or[fi+3],fi+=4,ft.push((hr<<24|sr<<16|ei<<8|Jr)/65536))}}}(Ke),qe.advanceWidth=mn,rn}function _e(Ee){return Ee.length<1240?107:Ee.length<33900?1131:32768}function le(Ee,qe){var Ke,gt=ee.cffStandardStrings.indexOf(Ee);return gt>=0&&(Ke=gt),(gt=qe.indexOf(Ee))>=0?Ke=gt+ee.cffStandardStrings.length:(Ke=ee.cffStandardStrings.length+qe.length,qe.push(Ee)),Ke}function pe(Ee,qe,Ke){for(var gt={},at=0;at<Ee.length;at+=1){var Ct=Ee[at],wt=qe[Ct.name];void 0===wt||A(wt,Ct.value)||("SID"===Ct.type&&(wt=le(wt,Ke)),gt[Ct.op]={name:Ct.name,type:Ct.type,value:wt})}return gt}function T(Ee,qe){var Ke=new ve.Record("Top DICT",[{name:"dict",type:"DICT",value:{}}]);return Ke.dict=pe(Ae,Ee,qe),Ke}function B(Ee){var qe=new ve.Record("Top DICT INDEX",[{name:"topDicts",type:"INDEX",value:[]}]);return qe.topDicts=[{name:"topDict_0",type:"TABLE",value:Ee}],qe}function q(Ee){var qe=[],Ke=Ee.path;qe.push({name:"width",type:"NUMBER",value:Ee.advanceWidth});for(var gt=0,at=0,Ct=0;Ct<Ke.commands.length;Ct+=1){var wt,Ft,Ot=Ke.commands[Ct];if("Q"===Ot.type){var rn=.3333333333333333,ft=2/3;Ot={type:"C",x:Ot.x,y:Ot.y,x1:rn*gt+ft*Ot.x1,y1:rn*at+ft*Ot.y1,x2:rn*Ot.x+ft*Ot.x1,y2:rn*Ot.y+ft*Ot.y1}}if("M"===Ot.type)wt=Math.round(Ot.x-gt),Ft=Math.round(Ot.y-at),qe.push({name:"dx",type:"NUMBER",value:wt}),qe.push({name:"dy",type:"NUMBER",value:Ft}),qe.push({name:"rmoveto",type:"OP",value:21}),gt=Math.round(Ot.x),at=Math.round(Ot.y);else if("L"===Ot.type)wt=Math.round(Ot.x-gt),Ft=Math.round(Ot.y-at),qe.push({name:"dx",type:"NUMBER",value:wt}),qe.push({name:"dy",type:"NUMBER",value:Ft}),qe.push({name:"rlineto",type:"OP",value:5}),gt=Math.round(Ot.x),at=Math.round(Ot.y);else if("C"===Ot.type){var Tn=Math.round(Ot.x1-gt),Cn=Math.round(Ot.y1-at),mn=Math.round(Ot.x2-Ot.x1),Pn=Math.round(Ot.y2-Ot.y1);wt=Math.round(Ot.x-Ot.x2),Ft=Math.round(Ot.y-Ot.y2),qe.push({name:"dx1",type:"NUMBER",value:Tn}),qe.push({name:"dy1",type:"NUMBER",value:Cn}),qe.push({name:"dx2",type:"NUMBER",value:mn}),qe.push({name:"dy2",type:"NUMBER",value:Pn}),qe.push({name:"dx",type:"NUMBER",value:wt}),qe.push({name:"dy",type:"NUMBER",value:Ft}),qe.push({name:"rrcurveto",type:"OP",value:8}),gt=Math.round(Ot.x),at=Math.round(Ot.y)}}return qe.push({name:"endchar",type:"OP",value:14}),qe}var ee=N("../encoding"),F=N("../glyphset"),Be=N("../parse"),K=N("../path"),ve=N("../table"),Ae=[{name:"version",op:0,type:"SID"},{name:"notice",op:1,type:"SID"},{name:"copyright",op:1200,type:"SID"},{name:"fullName",op:2,type:"SID"},{name:"familyName",op:3,type:"SID"},{name:"weight",op:4,type:"SID"},{name:"isFixedPitch",op:1201,type:"number",value:0},{name:"italicAngle",op:1202,type:"number",value:0},{name:"underlinePosition",op:1203,type:"number",value:-100},{name:"underlineThickness",op:1204,type:"number",value:50},{name:"paintType",op:1205,type:"number",value:0},{name:"charstringType",op:1206,type:"number",value:2},{name:"fontMatrix",op:1207,type:["real","real","real","real","real","real"],value:[.001,0,0,.001,0,0]},{name:"uniqueId",op:13,type:"number"},{name:"fontBBox",op:5,type:["number","number","number","number"],value:[0,0,0,0]},{name:"strokeWidth",op:1208,type:"number",value:0},{name:"xuid",op:14,type:[],value:null},{name:"charset",op:15,type:"offset",value:0},{name:"encoding",op:16,type:"offset",value:0},{name:"charStrings",op:17,type:"offset",value:0},{name:"private",op:18,type:["number","offset"],value:[0,0]}],Fe=[{name:"subrs",op:19,type:"offset",value:0},{name:"defaultWidthX",op:20,type:"number",value:0},{name:"nominalWidthX",op:21,type:"number",value:0}];G.parse=function(Ee,qe,Ke){Ke.tables.cff={};var gn,ur,or,at=P(Ee,((or={}).formatMajor=Be.getCard8(gn=Ee,ur=qe),or.formatMinor=Be.getCard8(gn,ur+1),or.size=Be.getCard8(gn,ur+2),or.offsetSize=Be.getCard8(gn,ur+3),or.startOffset=ur,or.endOffset=ur+4,or).endOffset,Be.bytesToString),Ct=P(Ee,at.endOffset),wt=P(Ee,Ct.endOffset,Be.bytesToString),Ft=P(Ee,wt.endOffset);Ke.gsubrs=Ft.objects,Ke.gsubrsBias=_e(Ke.gsubrs);var Ot=function(gn,ur){return ce(be(gn,0,gn.byteLength),Ae,ur)}(new DataView(new Uint8Array(Ct.objects[0]).buffer),wt.objects);Ke.tables.cff.topDict=Ot;var rn=qe+Ot.private[1],ft=function(gn,ur,or,hr){return ce(be(gn,ur,or),Fe,hr)}(Ee,rn,Ot.private[0],wt.objects);if(Ke.defaultWidthX=ft.defaultWidthX,Ke.nominalWidthX=ft.nominalWidthX,0!==ft.subrs){var Tn=P(Ee,rn+ft.subrs);Ke.subrs=Tn.objects,Ke.subrsBias=_e(Ke.subrs)}else Ke.subrs=[],Ke.subrsBias=0;var Cn=P(Ee,qe+Ot.charStrings);Ke.nGlyphs=Cn.objects.length;var mn=function(gn,ur,or,hr){var sr,ei,Jr,ci=new Be.Parser(gn,ur);or-=1;var ir=[".notdef"],vr=ci.parseCard8();if(0===vr)for(sr=0;or>sr;sr+=1)ei=ci.parseSID(),ir.push(te(hr,ei));else if(1===vr)for(;ir.length<=or;)for(ei=ci.parseSID(),Jr=ci.parseCard8(),sr=0;Jr>=sr;sr+=1)ir.push(te(hr,ei)),ei+=1;else{if(2!==vr)throw new Error("Unknown charset format "+vr);for(;ir.length<=or;)for(ei=ci.parseSID(),Jr=ci.parseCard16(),sr=0;Jr>=sr;sr+=1)ir.push(te(hr,ei)),ei+=1}return ir}(Ee,qe+Ot.charset,Ke.nGlyphs,wt.objects);Ke.cffEncoding=0===Ot.encoding?new ee.CffEncoding(ee.cffStandardEncoding,mn):1===Ot.encoding?new ee.CffEncoding(ee.cffExpertEncoding,mn):function(gn,ur,or){var hr,sr,ei={},Jr=new Be.Parser(gn,ur),ci=Jr.parseCard8();if(0===ci){var ir=Jr.parseCard8();for(hr=0;ir>hr;hr+=1)ei[sr=Jr.parseCard8()]=hr}else{if(1!==ci)throw new Error("Unknown encoding format "+ci);var vr=Jr.parseCard8();for(sr=1,hr=0;vr>hr;hr+=1)for(var pi=Jr.parseCard8(),go=Jr.parseCard8(),Nr=pi;pi+go>=Nr;Nr+=1)ei[Nr]=sr,sr+=1}return new ee.CffEncoding(ei,or)}(Ee,qe+Ot.encoding,mn),Ke.encoding=Ke.encoding||Ke.cffEncoding,Ke.glyphs=new F.GlyphSet(Ke);for(var Pn=0;Pn<Ke.nGlyphs;Pn+=1)Ke.glyphs.push(Pn,F.cffGlyphLoader(Ke,Pn,fe,Cn.objects[Pn]))},G.make=function(Ee,qe){for(var Ke,gt=new ve.Table("CFF ",[{name:"header",type:"RECORD"},{name:"nameIndex",type:"RECORD"},{name:"topDictIndex",type:"RECORD"},{name:"stringIndex",type:"RECORD"},{name:"globalSubrIndex",type:"RECORD"},{name:"charsets",type:"RECORD"},{name:"charStringsIndex",type:"RECORD"},{name:"privateDict",type:"RECORD"}]),at=1/qe.unitsPerEm,Ct={version:qe.version,fullName:qe.fullName,familyName:qe.familyName,weight:qe.weightName,fontBBox:qe.fontBBox||[0,0,0,0],fontMatrix:[at,0,0,at,0,0],charset:999,encoding:0,charStrings:999,private:[0,999]},wt=[],Ft=1;Ft<Ee.length;Ft+=1)Ke=Ee.get(Ft),wt.push(Ke.name);var Ot=[];gt.header=new ve.Record("Header",[{name:"major",type:"Card8",value:1},{name:"minor",type:"Card8",value:0},{name:"hdrSize",type:"Card8",value:4},{name:"major",type:"Card8",value:1}]),gt.nameIndex=function(Tn){var Cn=new ve.Record("Name INDEX",[{name:"names",type:"INDEX",value:[]}]);Cn.names=[];for(var mn=0;mn<Tn.length;mn+=1)Cn.names.push({name:"name_"+mn,type:"NAME",value:Tn[mn]});return Cn}([qe.postScriptName]);var Cn,mn,rn=T(Ct,Ot);gt.topDictIndex=B(rn),gt.globalSubrIndex=new ve.Record("Global Subr INDEX",[{name:"subrs",type:"INDEX",value:[]}]),gt.charsets=function(Tn,Cn){for(var mn=new ve.Record("Charsets",[{name:"format",type:"Card8",value:0}]),Pn=0;Pn<Tn.length;Pn+=1){var $n=le(Tn[Pn],Cn);mn.fields.push({name:"glyph_"+Pn,type:"SID",value:$n})}return mn}(wt,Ot),gt.charStringsIndex=function(Tn){for(var Cn=new ve.Record("CharStrings INDEX",[{name:"charStrings",type:"INDEX",value:[]}]),mn=0;mn<Tn.length;mn+=1){var Pn=Tn.get(mn),$n=q(Pn);Cn.charStrings.push({name:Pn.name,type:"CHARSTRING",value:$n})}return Cn}(Ee),gt.privateDict=(Cn=Ot,(mn=new ve.Record("Private DICT",[{name:"dict",type:"DICT",value:{}}])).dict=pe(Fe,{},Cn),mn),gt.stringIndex=function(Tn){var Cn=new ve.Record("String INDEX",[{name:"strings",type:"INDEX",value:[]}]);Cn.strings=[];for(var mn=0;mn<Tn.length;mn+=1)Cn.strings.push({name:"string_"+mn,type:"STRING",value:Tn[mn]});return Cn}(Ot);var ft=gt.header.sizeOf()+gt.nameIndex.sizeOf()+gt.topDictIndex.sizeOf()+gt.stringIndex.sizeOf()+gt.globalSubrIndex.sizeOf();return Ct.charset=ft,Ct.encoding=0,Ct.charStrings=Ct.charset+gt.charsets.sizeOf(),Ct.private[1]=Ct.charStrings+gt.charStringsIndex.sizeOf(),rn=T(Ct,Ot),gt.topDictIndex=B(rn),gt}},{"../encoding":4,"../glyphset":7,"../parse":10,"../path":11,"../table":13}],15:[function(N,U,G){function A(te,ce,fe){te.segments.push({end:ce,start:ce,delta:-(ce-fe),offset:0})}var P=N("../check"),de=N("../parse"),be=N("../table");G.parse=function(te,ce){var fe,_e={};_e.version=de.getUShort(te,ce),P.argument(0===_e.version,"cmap table version should be 0."),_e.numTables=de.getUShort(te,ce+2);var le=-1;for(fe=_e.numTables-1;fe>=0;fe-=1){var pe=de.getUShort(te,ce+4+8*fe),T=de.getUShort(te,ce+4+8*fe+2);if(3===pe&&(0===T||1===T||10===T)){le=de.getULong(te,ce+4+8*fe+4);break}}if(-1===le)return null;var B=new de.Parser(te,ce+le);if(_e.format=B.parseUShort(),12===_e.format)!function(q,ee){var F,Be;for(ee.parseUShort(),q.length=ee.parseULong(),q.language=ee.parseULong(),q.groupCount=Be=ee.parseULong(),q.glyphIndexMap={},F=0;Be>F;F+=1)for(var K=ee.parseULong(),ve=ee.parseULong(),Ae=ee.parseULong(),Fe=K;ve>=Fe;Fe+=1)q.glyphIndexMap[Fe]=Ae,Ae++}(_e,B);else{if(4!==_e.format)throw new Error("Only format 4 and 12 cmap tables are supported.");!function(q,ee,F,Be,K){var ve,Ae;q.length=ee.parseUShort(),q.language=ee.parseUShort(),q.segCount=Ae=ee.parseUShort()>>1,ee.skip("uShort",3),q.glyphIndexMap={};var Fe=new de.Parser(F,Be+K+14),Ee=new de.Parser(F,Be+K+16+2*Ae),qe=new de.Parser(F,Be+K+16+4*Ae),Ke=new de.Parser(F,Be+K+16+6*Ae),gt=Be+K+16+8*Ae;for(ve=0;Ae-1>ve;ve+=1)for(var at,Ct=Fe.parseUShort(),wt=Ee.parseUShort(),Ft=qe.parseShort(),Ot=Ke.parseUShort(),rn=wt;Ct>=rn;rn+=1)0!==Ot?(gt=Ke.offset+Ke.relativeOffset-2,gt+=Ot,0!==(at=de.getUShort(F,gt+=2*(rn-wt)))&&(at=at+Ft&65535)):at=rn+Ft&65535,q.glyphIndexMap[rn]=at}(_e,B,te,ce,le)}return _e},G.make=function(te){var ce,fe,_e=new be.Table("cmap",[{name:"version",type:"USHORT",value:0},{name:"numTables",type:"USHORT",value:1},{name:"platformID",type:"USHORT",value:3},{name:"encodingID",type:"USHORT",value:1},{name:"offset",type:"ULONG",value:12},{name:"format",type:"USHORT",value:4},{name:"length",type:"USHORT",value:0},{name:"language",type:"USHORT",value:0},{name:"segCountX2",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);for(_e.segments=[],ce=0;ce<te.length;ce+=1){for(var le=te.get(ce),pe=0;pe<le.unicodes.length;pe+=1)A(_e,le.unicodes[pe],ce);_e.segments=_e.segments.sort(function(K,ve){return K.start-ve.start})}_e.segments.push({end:65535,start:65535,delta:1,offset:0}),_e.segCountX2=2*(fe=_e.segments.length),_e.searchRange=2*Math.pow(2,Math.floor(Math.log(fe)/Math.log(2))),_e.entrySelector=Math.log(_e.searchRange/2)/Math.log(2),_e.rangeShift=_e.segCountX2-_e.searchRange;var T=[],B=[],q=[],ee=[],F=[];for(ce=0;fe>ce;ce+=1){var Be=_e.segments[ce];T=T.concat({name:"end_"+ce,type:"USHORT",value:Be.end}),B=B.concat({name:"start_"+ce,type:"USHORT",value:Be.start}),q=q.concat({name:"idDelta_"+ce,type:"SHORT",value:Be.delta}),ee=ee.concat({name:"idRangeOffset_"+ce,type:"USHORT",value:Be.offset}),void 0!==Be.glyphId&&(F=F.concat({name:"glyph_"+ce,type:"USHORT",value:Be.glyphId}))}return _e.fields=_e.fields.concat(T),_e.fields.push({name:"reservedPad",type:"USHORT",value:0}),_e.fields=_e.fields.concat(B),_e.fields=_e.fields.concat(q),_e.fields=_e.fields.concat(ee),_e.fields=_e.fields.concat(F),_e.length=14+2*T.length+2+2*B.length+2*q.length+2*ee.length+2*F.length,_e}},{"../check":2,"../parse":10,"../table":13}],16:[function(N,U,G){function A(le,pe){var T=JSON.stringify(le),B=256;for(var q in pe){var ee=parseInt(q);if(ee&&!(256>ee)){if(JSON.stringify(pe[q])===T)return ee;ee>=B&&(B=ee+1)}}return pe[B]=le,B}function P(le,pe,T){var B=A(pe.name,T);return[{name:"tag_"+le,type:"TAG",value:pe.tag},{name:"minValue_"+le,type:"FIXED",value:pe.minValue<<16},{name:"defaultValue_"+le,type:"FIXED",value:pe.defaultValue<<16},{name:"maxValue_"+le,type:"FIXED",value:pe.maxValue<<16},{name:"flags_"+le,type:"USHORT",value:0},{name:"nameID_"+le,type:"USHORT",value:B}]}function de(le,pe,T){var B={},q=new fe.Parser(le,pe);return B.tag=q.parseTag(),B.minValue=q.parseFixed(),B.defaultValue=q.parseFixed(),B.maxValue=q.parseFixed(),q.skip("uShort",1),B.name=T[q.parseUShort()]||{},B}function be(le,pe,T,B){for(var q=[{name:"nameID_"+le,type:"USHORT",value:A(pe.name,B)},{name:"flags_"+le,type:"USHORT",value:0}],ee=0;ee<T.length;++ee){var F=T[ee].tag;q.push({name:"axis_"+le+" "+F,type:"FIXED",value:pe.coordinates[F]<<16})}return q}function te(le,pe,T,B){var q={},ee=new fe.Parser(le,pe);q.name=B[ee.parseUShort()]||{},ee.skip("uShort",1),q.coordinates={};for(var F=0;F<T.length;++F)q.coordinates[T[F].tag]=ee.parseFixed();return q}var ce=N("../check"),fe=N("../parse"),_e=N("../table");G.make=function(le,pe){var T=new _e.Table("fvar",[{name:"version",type:"ULONG",value:65536},{name:"offsetToData",type:"USHORT",value:0},{name:"countSizePairs",type:"USHORT",value:2},{name:"axisCount",type:"USHORT",value:le.axes.length},{name:"axisSize",type:"USHORT",value:20},{name:"instanceCount",type:"USHORT",value:le.instances.length},{name:"instanceSize",type:"USHORT",value:4+4*le.axes.length}]);T.offsetToData=T.sizeOf();for(var B=0;B<le.axes.length;B++)T.fields=T.fields.concat(P(B,le.axes[B],pe));for(var q=0;q<le.instances.length;q++)T.fields=T.fields.concat(be(q,le.instances[q],le.axes,pe));return T},G.parse=function(le,pe,T){var B=new fe.Parser(le,pe),q=B.parseULong();ce.argument(65536===q,"Unsupported fvar table version.");var ee=B.parseOffset16();B.skip("uShort",1);for(var F=B.parseUShort(),Be=B.parseUShort(),K=B.parseUShort(),ve=B.parseUShort(),Ae=[],Fe=0;F>Fe;Fe++)Ae.push(de(le,pe+ee+Fe*Be,T));for(var Ee=[],qe=pe+ee+F*Be,Ke=0;K>Ke;Ke++)Ee.push(te(le,qe+Ke*ve,Ae,T));return{axes:Ae,instances:Ee}}},{"../check":2,"../parse":10,"../table":13}],17:[function(N,U,G){function A(le,pe,T,B,q){var ee;return(pe&B)>0?(ee=le.parseByte(),!(pe&q)&&(ee=-ee),ee=T+ee):ee=(pe&q)>0?T:T+le.parseShort(),ee}function P(le,pe,T){var B,q,ee=new fe.Parser(pe,T);if(le.numberOfContours=ee.parseShort(),le._xMin=ee.parseShort(),le._yMin=ee.parseShort(),le._xMax=ee.parseShort(),le._yMax=ee.parseShort(),le.numberOfContours>0){var F,Be=le.endPointIndices=[];for(F=0;F<le.numberOfContours;F+=1)Be.push(ee.parseUShort());for(le.instructionLength=ee.parseUShort(),le.instructions=[],F=0;F<le.instructionLength;F+=1)le.instructions.push(ee.parseByte());var K=Be[Be.length-1]+1;for(B=[],F=0;K>F;F+=1)if(q=ee.parseByte(),B.push(q),(8&q)>0)for(var ve=ee.parseByte(),Ae=0;ve>Ae;Ae+=1)B.push(q),F+=1;if(te.argument(B.length===K,"Bad flags."),Be.length>0){var Fe,Ee=[];if(K>0){for(F=0;K>F;F+=1)(Fe={}).onCurve=!!(1&(q=B[F])),Fe.lastPointOfContour=Be.indexOf(F)>=0,Ee.push(Fe);var qe=0;for(F=0;K>F;F+=1)(Fe=Ee[F]).x=A(ee,q=B[F],qe,2,16),qe=Fe.x;var Ke=0;for(F=0;K>F;F+=1)(Fe=Ee[F]).y=A(ee,q=B[F],Ke,4,32),Ke=Fe.y}le.points=Ee}else le.points=[]}else if(0===le.numberOfContours)le.points=[];else{le.isComposite=!0,le.points=[],le.components=[];for(var gt=!0;gt;){B=ee.parseUShort();var at={glyphIndex:ee.parseUShort(),xScale:1,scale01:0,scale10:0,yScale:1,dx:0,dy:0};(1&B)>0?(2&B)>0?(at.dx=ee.parseShort(),at.dy=ee.parseShort()):at.matchedPoints=[ee.parseUShort(),ee.parseUShort()]:(2&B)>0?(at.dx=ee.parseChar(),at.dy=ee.parseChar()):at.matchedPoints=[ee.parseByte(),ee.parseByte()],(8&B)>0?at.xScale=at.yScale=ee.parseF2Dot14():(64&B)>0?(at.xScale=ee.parseF2Dot14(),at.yScale=ee.parseF2Dot14()):(128&B)>0&&(at.xScale=ee.parseF2Dot14(),at.scale01=ee.parseF2Dot14(),at.scale10=ee.parseF2Dot14(),at.yScale=ee.parseF2Dot14()),le.components.push(at),gt=!!(32&B)}}}function de(le,pe){for(var T=[],B=0;B<le.length;B+=1){var q=le[B];T.push({x:pe.xScale*q.x+pe.scale01*q.y+pe.dx,y:pe.scale10*q.x+pe.yScale*q.y+pe.dy,onCurve:q.onCurve,lastPointOfContour:q.lastPointOfContour})}return T}function be(le,pe){if(pe.isComposite)for(var T=0;T<pe.components.length;T+=1){var B=pe.components[T],q=le.get(B.glyphIndex);if(q.getPath(),q.points){var ee;if(void 0===B.matchedPoints)ee=de(q.points,B);else{if(B.matchedPoints[0]>pe.points.length-1||B.matchedPoints[1]>q.points.length-1)throw Error("Matched points out of range in "+pe.name);var F=pe.points[B.matchedPoints[0]],Be=q.points[B.matchedPoints[1]],K={xScale:B.xScale,scale01:B.scale01,scale10:B.scale10,yScale:B.yScale,dx:0,dy:0};Be=de([Be],K)[0],K.dx=F.x-Be.x,K.dy=F.y-Be.y,ee=de(q.points,K)}pe.points=pe.points.concat(ee)}}return function(ve){var Ae=new _e.Path;if(!ve)return Ae;for(var Fe=function(ft){for(var Tn=[],Cn=[],mn=0;mn<ft.length;mn+=1){var Pn=ft[mn];Cn.push(Pn),Pn.lastPointOfContour&&(Tn.push(Cn),Cn=[])}return te.argument(0===Cn.length,"There are still points left in the current contour."),Tn}(ve),Ee=0;Ee<Fe.length;Ee+=1){var qe,Ke,gt=Fe[Ee],at=gt[0],Ct=gt[gt.length-1];at.onCurve?(qe=null,Ke=!0):(qe=at=Ct.onCurve?Ct:{x:(at.x+Ct.x)/2,y:(at.y+Ct.y)/2},Ke=!1),Ae.moveTo(at.x,at.y);for(var wt=Ke?1:0;wt<gt.length;wt+=1){var Ft=gt[wt],Ot=0===wt?at:gt[wt-1];if(Ot.onCurve&&Ft.onCurve)Ae.lineTo(Ft.x,Ft.y);else if(Ot.onCurve&&!Ft.onCurve)qe=Ft;else if(Ot.onCurve||Ft.onCurve){if(Ot.onCurve||!Ft.onCurve)throw new Error("Invalid state.");Ae.quadraticCurveTo(qe.x,qe.y,Ft.x,Ft.y),qe=null}else{var rn={x:(Ot.x+Ft.x)/2,y:(Ot.y+Ft.y)/2};Ae.quadraticCurveTo(Ot.x,Ot.y,rn.x,rn.y),qe=Ft}}at!==Ct&&(qe?Ae.quadraticCurveTo(qe.x,qe.y,at.x,at.y):Ae.lineTo(at.x,at.y))}return Ae.closePath(),Ae}(pe.points)}var te=N("../check"),ce=N("../glyphset"),fe=N("../parse"),_e=N("../path");G.parse=function(le,pe,T,B){var q,ee=new ce.GlyphSet(B);for(q=0;q<T.length-1;q+=1){var F=T[q];ee.push(q,F!==T[q+1]?ce.ttfGlyphLoader(B,q,P,le,pe+F,be):ce.glyphLoader(B,q))}return ee}},{"../check":2,"../glyphset":7,"../parse":10,"../path":11}],18:[function(N,U,G){function A(fe,_e){for(var le=new ce.Parser(fe,_e),pe=le.parseUShort(),T=[],B=0;pe>B;B++)T[le.parseTag()]={offset:le.parseUShort()};return T}function P(fe,_e){var le=new ce.Parser(fe,_e),pe=le.parseUShort();if(1===pe){var T=le.parseUShort(),B=le.parseUShort(),q=le.parseUShortList(B);return function(Ae){return q[Ae-T]||0}}if(2===pe){for(var ee=le.parseUShort(),F=[],Be=[],K=[],ve=0;ee>ve;ve++)F[ve]=le.parseUShort(),Be[ve]=le.parseUShort(),K[ve]=le.parseUShort();return function(Ae){for(var Fe=0,Ee=F.length-1;Ee>Fe;){var qe=Fe+Ee+1>>1;Ae<F[qe]?Ee=qe-1:Fe=qe}return F[Fe]<=Ae&&Ae<=Be[Fe]&&K[Fe]||0}}}function de(fe,_e){var le,pe=new ce.Parser(fe,_e),T=pe.parseUShort(),B=function(Pn,$n){var gn=new ce.Parser(Pn,$n),ur=gn.parseUShort(),or=gn.parseUShort();if(1===ur)return gn.parseUShortList(or);if(2===ur){for(var hr=[];or--;)for(var sr=gn.parseUShort(),ei=gn.parseUShort(),Jr=gn.parseUShort(),ci=sr;ei>=ci;ci++)hr[Jr++]=ci;return hr}}(fe,_e+pe.parseUShort()),q=pe.parseUShort(),ee=pe.parseUShort();if(4===q&&0===ee){var F={};if(1===T){for(var Be=pe.parseUShort(),K=[],ve=pe.parseOffset16List(Be),Ae=0;Be>Ae;Ae++){var Fe=ve[Ae],Ee=F[Fe];if(!Ee){Ee={},pe.relativeOffset=Fe;for(var qe=pe.parseUShort();qe--;){var Ke=pe.parseUShort();q&&(le=pe.parseShort()),ee&&pe.parseShort(),Ee[Ke]=le}}K[B[Ae]]=Ee}return function(Pn,$n){var gn=K[Pn];return gn?gn[$n]:void 0}}if(2===T){for(var gt=pe.parseUShort(),at=pe.parseUShort(),Ct=pe.parseUShort(),wt=pe.parseUShort(),Ft=P(fe,_e+gt),Ot=P(fe,_e+at),rn=[],ft=0;Ct>ft;ft++)for(var Tn=rn[ft]=[],Cn=0;wt>Cn;Cn++)q&&(le=pe.parseShort()),ee&&pe.parseShort(),Tn[Cn]=le;var mn={};for(ft=0;ft<B.length;ft++)mn[B[ft]]=1;return function(Pn,$n){if(mn[Pn]){var gn=Ft(Pn),ur=Ot($n),or=rn[gn];return or?or[ur]:void 0}}}}}function be(fe,_e){var le=new ce.Parser(fe,_e),pe=le.parseUShort(),T=le.parseUShort(),B=16&T,q=le.parseUShort(),ee=le.parseOffset16List(q),F={lookupType:pe,lookupFlag:T,markFilteringSet:B?le.parseUShort():-1};if(2===pe){for(var Be=[],K=0;q>K;K++)Be.push(de(fe,_e+ee[K]));F.getKerningValue=function(ve,Ae){for(var Fe=Be.length;Fe--;){var Ee=Be[Fe](ve,Ae);if(void 0!==Ee)return Ee}return 0}}return F}var te=N("../check"),ce=N("../parse");G.parse=function(fe,_e,le){var pe=new ce.Parser(fe,_e),T=pe.parseFixed();te.argument(1===T,"Unsupported GPOS table version."),A(fe,_e+pe.parseUShort()),A(fe,_e+pe.parseUShort());var B=pe.parseUShort();pe.relativeOffset=B;for(var q=pe.parseUShort(),ee=pe.parseOffset16List(q),F=_e+B,Be=0;q>Be;Be++){var K=be(fe,F+ee[Be]);2!==K.lookupType||le.getGposKerningValue||(le.getGposKerningValue=K.getKerningValue)}}},{"../check":2,"../parse":10}],19:[function(N,U,G){var A=N("../check"),P=N("../parse").Parser,de=new Array(9),be=N("../table");de[1]=function(){var fe=this.offset+this.relativeOffset,_e=this.parseUShort();return 1===_e?{substFormat:1,coverage:this.parsePointer(P.coverage),deltaGlyphId:this.parseUShort()}:2===_e?{substFormat:2,coverage:this.parsePointer(P.coverage),substitute:this.parseOffset16List()}:void A.assert(!1,"0x"+fe.toString(16)+": lookup type 1 format must be 1 or 2.")},de[2]=function(){var fe=this.parseUShort();return A.argument(1===fe,"GSUB Multiple Substitution Subtable identifier-format must be 1"),{substFormat:fe,coverage:this.parsePointer(P.coverage),sequences:this.parseListOfLists()}},de[3]=function(){var fe=this.parseUShort();return A.argument(1===fe,"GSUB Alternate Substitution Subtable identifier-format must be 1"),{substFormat:fe,coverage:this.parsePointer(P.coverage),alternateSets:this.parseListOfLists()}},de[4]=function(){var fe=this.parseUShort();return A.argument(1===fe,"GSUB ligature table identifier-format must be 1"),{substFormat:fe,coverage:this.parsePointer(P.coverage),ligatureSets:this.parseListOfLists(function(){return{ligGlyph:this.parseUShort(),components:this.parseUShortList(this.parseUShort()-1)}})}};var te={sequenceIndex:P.uShort,lookupListIndex:P.uShort};de[5]=function(){var fe=this.offset+this.relativeOffset,_e=this.parseUShort();if(1===_e)return{substFormat:_e,coverage:this.parsePointer(P.coverage),ruleSets:this.parseListOfLists(function(){var T=this.parseUShort(),B=this.parseUShort();return{input:this.parseUShortList(T-1),lookupRecords:this.parseRecordList(B,te)}})};if(2===_e)return{substFormat:_e,coverage:this.parsePointer(P.coverage),classDef:this.parsePointer(P.classDef),classSets:this.parseListOfLists(function(){var T=this.parseUShort(),B=this.parseUShort();return{classes:this.parseUShortList(T-1),lookupRecords:this.parseRecordList(B,te)}})};if(3===_e){var le=this.parseUShort(),pe=this.parseUShort();return{substFormat:_e,coverages:this.parseList(le,P.pointer(P.coverage)),lookupRecords:this.parseRecordList(pe,te)}}A.assert(!1,"0x"+fe.toString(16)+": lookup type 5 format must be 1, 2 or 3.")},de[6]=function(){var fe=this.offset+this.relativeOffset,_e=this.parseUShort();return 1===_e?{substFormat:1,coverage:this.parsePointer(P.coverage),chainRuleSets:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(te)}})}:2===_e?{substFormat:2,coverage:this.parsePointer(P.coverage),backtrackClassDef:this.parsePointer(P.classDef),inputClassDef:this.parsePointer(P.classDef),lookaheadClassDef:this.parsePointer(P.classDef),chainClassSet:this.parseListOfLists(function(){return{backtrack:this.parseUShortList(),input:this.parseUShortList(this.parseShort()-1),lookahead:this.parseUShortList(),lookupRecords:this.parseRecordList(te)}})}:3===_e?{substFormat:3,backtrackCoverage:this.parseList(P.pointer(P.coverage)),inputCoverage:this.parseList(P.pointer(P.coverage)),lookaheadCoverage:this.parseList(P.pointer(P.coverage)),lookupRecords:this.parseRecordList(te)}:void A.assert(!1,"0x"+fe.toString(16)+": lookup type 6 format must be 1, 2 or 3.")},de[7]=function(){var fe=this.parseUShort();A.argument(1===fe,"GSUB Extension Substitution subtable identifier-format must be 1");var _e=this.parseUShort(),le=new P(this.data,this.offset+this.parseULong());return{substFormat:1,lookupType:_e,extension:de[_e].call(le)}},de[8]=function(){var fe=this.parseUShort();return A.argument(1===fe,"GSUB Reverse Chaining Contextual Single Substitution Subtable identifier-format must be 1"),{substFormat:fe,coverage:this.parsePointer(P.coverage),backtrackCoverage:this.parseList(P.pointer(P.coverage)),lookaheadCoverage:this.parseList(P.pointer(P.coverage)),substitutes:this.parseUShortList()}};var ce=new Array(9);ce[1]=function(fe){return new be.Table("substitutionTable",1===fe.substFormat?[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new be.Coverage(fe.coverage)},{name:"deltaGlyphID",type:"USHORT",value:fe.deltaGlyphId}]:[{name:"substFormat",type:"USHORT",value:2},{name:"coverage",type:"TABLE",value:new be.Coverage(fe.coverage)}].concat(be.ushortList("substitute",fe.substitute)))},ce[3]=function(fe){return A.assert(1===fe.substFormat,"Lookup type 3 substFormat must be 1."),new be.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new be.Coverage(fe.coverage)}].concat(be.tableList("altSet",fe.alternateSets,function(_e){return new be.Table("alternateSetTable",be.ushortList("alternate",_e))})))},ce[4]=function(fe){return A.assert(1===fe.substFormat,"Lookup type 4 substFormat must be 1."),new be.Table("substitutionTable",[{name:"substFormat",type:"USHORT",value:1},{name:"coverage",type:"TABLE",value:new be.Coverage(fe.coverage)}].concat(be.tableList("ligSet",fe.ligatureSets,function(_e){return new be.Table("ligatureSetTable",be.tableList("ligature",_e,function(le){return new be.Table("ligatureTable",[{name:"ligGlyph",type:"USHORT",value:le.ligGlyph}].concat(be.ushortList("component",le.components,le.components.length+1)))}))})))},G.parse=function(fe,_e){var le=new P(fe,_e=_e||0),pe=le.parseVersion();return A.argument(1===pe,"Unsupported GSUB table version."),{version:pe,scripts:le.parseScriptList(),features:le.parseFeatureList(),lookups:le.parseLookupList(de)}},G.make=function(fe){return new be.Table("GSUB",[{name:"version",type:"ULONG",value:65536},{name:"scripts",type:"TABLE",value:new be.ScriptList(fe.scripts)},{name:"features",type:"TABLE",value:new be.FeatureList(fe.features)},{name:"lookups",type:"TABLE",value:new be.LookupList(fe.lookups,ce)}])}},{"../check":2,"../parse":10,"../table":13}],20:[function(N,U,G){var A=N("../check"),P=N("../parse"),de=N("../table");G.parse=function(be,te){var ce={},fe=new P.Parser(be,te);return ce.version=fe.parseVersion(),ce.fontRevision=Math.round(1e3*fe.parseFixed())/1e3,ce.checkSumAdjustment=fe.parseULong(),ce.magicNumber=fe.parseULong(),A.argument(1594834165===ce.magicNumber,"Font header has wrong magic number."),ce.flags=fe.parseUShort(),ce.unitsPerEm=fe.parseUShort(),ce.created=fe.parseLongDateTime(),ce.modified=fe.parseLongDateTime(),ce.xMin=fe.parseShort(),ce.yMin=fe.parseShort(),ce.xMax=fe.parseShort(),ce.yMax=fe.parseShort(),ce.macStyle=fe.parseUShort(),ce.lowestRecPPEM=fe.parseUShort(),ce.fontDirectionHint=fe.parseShort(),ce.indexToLocFormat=fe.parseShort(),ce.glyphDataFormat=fe.parseShort(),ce},G.make=function(be){var te=Math.round((new Date).getTime()/1e3)+2082844800,ce=te;return be.createdTimestamp&&(ce=be.createdTimestamp+2082844800),new de.Table("head",[{name:"version",type:"FIXED",value:65536},{name:"fontRevision",type:"FIXED",value:65536},{name:"checkSumAdjustment",type:"ULONG",value:0},{name:"magicNumber",type:"ULONG",value:1594834165},{name:"flags",type:"USHORT",value:0},{name:"unitsPerEm",type:"USHORT",value:1e3},{name:"created",type:"LONGDATETIME",value:ce},{name:"modified",type:"LONGDATETIME",value:te},{name:"xMin",type:"SHORT",value:0},{name:"yMin",type:"SHORT",value:0},{name:"xMax",type:"SHORT",value:0},{name:"yMax",type:"SHORT",value:0},{name:"macStyle",type:"USHORT",value:0},{name:"lowestRecPPEM",type:"USHORT",value:0},{name:"fontDirectionHint",type:"SHORT",value:2},{name:"indexToLocFormat",type:"SHORT",value:0},{name:"glyphDataFormat",type:"SHORT",value:0}],be)}},{"../check":2,"../parse":10,"../table":13}],21:[function(N,U,G){var A=N("../parse"),P=N("../table");G.parse=function(de,be){var te={},ce=new A.Parser(de,be);return te.version=ce.parseVersion(),te.ascender=ce.parseShort(),te.descender=ce.parseShort(),te.lineGap=ce.parseShort(),te.advanceWidthMax=ce.parseUShort(),te.minLeftSideBearing=ce.parseShort(),te.minRightSideBearing=ce.parseShort(),te.xMaxExtent=ce.parseShort(),te.caretSlopeRise=ce.parseShort(),te.caretSlopeRun=ce.parseShort(),te.caretOffset=ce.parseShort(),ce.relativeOffset+=8,te.metricDataFormat=ce.parseShort(),te.numberOfHMetrics=ce.parseUShort(),te},G.make=function(de){return new P.Table("hhea",[{name:"version",type:"FIXED",value:65536},{name:"ascender",type:"FWORD",value:0},{name:"descender",type:"FWORD",value:0},{name:"lineGap",type:"FWORD",value:0},{name:"advanceWidthMax",type:"UFWORD",value:0},{name:"minLeftSideBearing",type:"FWORD",value:0},{name:"minRightSideBearing",type:"FWORD",value:0},{name:"xMaxExtent",type:"FWORD",value:0},{name:"caretSlopeRise",type:"SHORT",value:1},{name:"caretSlopeRun",type:"SHORT",value:0},{name:"caretOffset",type:"SHORT",value:0},{name:"reserved1",type:"SHORT",value:0},{name:"reserved2",type:"SHORT",value:0},{name:"reserved3",type:"SHORT",value:0},{name:"reserved4",type:"SHORT",value:0},{name:"metricDataFormat",type:"SHORT",value:0},{name:"numberOfHMetrics",type:"USHORT",value:0}],de)}},{"../parse":10,"../table":13}],22:[function(N,U,G){var A=N("../parse"),P=N("../table");G.parse=function(de,be,te,ce,fe){for(var _e,le,pe=new A.Parser(de,be),T=0;ce>T;T+=1){te>T&&(_e=pe.parseUShort(),le=pe.parseShort());var B=fe.get(T);B.advanceWidth=_e,B.leftSideBearing=le}},G.make=function(de){for(var be=new P.Table("hmtx",[]),te=0;te<de.length;te+=1){var ce=de.get(te),_e=ce.leftSideBearing||0;be.fields.push({name:"advanceWidth_"+te,type:"USHORT",value:ce.advanceWidth||0}),be.fields.push({name:"leftSideBearing_"+te,type:"SHORT",value:_e})}return be}},{"../parse":10,"../table":13}],23:[function(N,U,G){var A=N("../check"),P=N("../parse");G.parse=function(de,be){var te={},ce=new P.Parser(de,be),fe=ce.parseUShort();A.argument(0===fe,"Unsupported kern table version."),ce.skip("uShort",1);var _e=ce.parseUShort();A.argument(0===_e,"Unsupported kern sub-table version."),ce.skip("uShort",2);var le=ce.parseUShort();ce.skip("uShort",3);for(var pe=0;le>pe;pe+=1){var T=ce.parseUShort(),B=ce.parseUShort(),q=ce.parseShort();te[T+","+B]=q}return te}},{"../check":2,"../parse":10}],24:[function(N,U,G){var A=N("../parse");G.parse=function(P,de,be,te){for(var ce=new A.Parser(P,de),fe=te?ce.parseUShort:ce.parseULong,_e=[],le=0;be+1>le;le+=1){var pe=fe.call(ce);te&&(pe*=2),_e.push(pe)}return _e}},{"../parse":10}],25:[function(N,U,G){var A=N("../check"),P=N("../parse"),de=N("../table");G.make=function(be){for(var te=new de.Table("ltag",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"numTags",type:"ULONG",value:be.length}]),ce="",fe=12+4*be.length,_e=0;_e<be.length;++_e){var le=ce.indexOf(be[_e]);0>le&&(le=ce.length,ce+=be[_e]),te.fields.push({name:"offset "+_e,type:"USHORT",value:fe+le}),te.fields.push({name:"length "+_e,type:"USHORT",value:be[_e].length})}return te.fields.push({name:"stringPool",type:"CHARARRAY",value:ce}),te},G.parse=function(be,te){var ce=new P.Parser(be,te),fe=ce.parseULong();A.argument(1===fe,"Unsupported ltag table version."),ce.skip("uLong",1);for(var _e=ce.parseULong(),le=[],pe=0;_e>pe;pe++){for(var T="",B=te+ce.parseUShort(),q=ce.parseUShort(),ee=B;B+q>ee;++ee)T+=String.fromCharCode(be.getInt8(ee));le.push(T)}return le}},{"../check":2,"../parse":10,"../table":13}],26:[function(N,U,G){var A=N("../parse"),P=N("../table");G.parse=function(de,be){var te={},ce=new A.Parser(de,be);return te.version=ce.parseVersion(),te.numGlyphs=ce.parseUShort(),1===te.version&&(te.maxPoints=ce.parseUShort(),te.maxContours=ce.parseUShort(),te.maxCompositePoints=ce.parseUShort(),te.maxCompositeContours=ce.parseUShort(),te.maxZones=ce.parseUShort(),te.maxTwilightPoints=ce.parseUShort(),te.maxStorage=ce.parseUShort(),te.maxFunctionDefs=ce.parseUShort(),te.maxInstructionDefs=ce.parseUShort(),te.maxStackElements=ce.parseUShort(),te.maxSizeOfInstructions=ce.parseUShort(),te.maxComponentElements=ce.parseUShort(),te.maxComponentDepth=ce.parseUShort()),te},G.make=function(de){return new P.Table("maxp",[{name:"version",type:"FIXED",value:20480},{name:"numGlyphs",type:"USHORT",value:de}])}},{"../parse":10,"../table":13}],27:[function(N,U,G){var A=N("../types").decode,P=N("../check"),de=N("../parse"),be=N("../table");G.parse=function(te,ce){var fe=new de.Parser(te,ce),_e=fe.parseULong();P.argument(1===_e,"Unsupported META table version."),fe.parseULong(),fe.parseULong();for(var le=fe.parseULong(),pe={},T=0;le>T;T++){var B=fe.parseTag(),q=fe.parseULong(),ee=fe.parseULong(),F=A.UTF8(te,ce+q,ee);pe[B]=F}return pe},G.make=function(te){var ce=Object.keys(te).length,fe="",_e=16+12*ce,le=new be.Table("meta",[{name:"version",type:"ULONG",value:1},{name:"flags",type:"ULONG",value:0},{name:"offset",type:"ULONG",value:_e},{name:"numTags",type:"ULONG",value:ce}]);for(var pe in te){var T=fe.length;fe+=te[pe],le.fields.push({name:"tag "+pe,type:"TAG",value:pe}),le.fields.push({name:"offset "+pe,type:"ULONG",value:_e+T}),le.fields.push({name:"length "+pe,type:"ULONG",value:te[pe].length})}return le.fields.push({name:"stringPool",type:"CHARARRAY",value:fe}),le}},{"../check":2,"../parse":10,"../table":13,"../types":32}],28:[function(N,U,G){function A(ve,Ae,Fe){switch(ve){case 0:if(65535===Ae)return"und";if(Fe)return Fe[Ae];break;case 1:return B[Ae];case 3:return ee[Ae]}}function P(ve,Ae,Fe){switch(ve){case 0:return F;case 1:return K[Fe]||Be[Ae];case 3:if(1===Ae||10===Ae)return F}}function de(ve){var Ae={};for(var Fe in ve)Ae[ve[Fe]]=parseInt(Fe);return Ae}function be(ve,Ae,Fe,Ee,qe,Ke){return new pe.Record("NameRecord",[{name:"platformID",type:"USHORT",value:ve},{name:"encodingID",type:"USHORT",value:Ae},{name:"languageID",type:"USHORT",value:Fe},{name:"nameID",type:"USHORT",value:Ee},{name:"length",type:"USHORT",value:qe},{name:"offset",type:"USHORT",value:Ke}])}function te(ve,Ae){var Fe=function(Ke,gt){var at=Ke.length,Ct=gt.length-at+1;e:for(var wt=0;Ct>wt;wt++)for(;Ct>wt;wt++){for(var Ft=0;at>Ft;Ft++)if(gt[wt+Ft]!==Ke[Ft])continue e;return wt}return-1}(ve,Ae);if(0>Fe){Fe=Ae.length;for(var Ee=0,qe=ve.length;qe>Ee;++Ee)Ae.push(ve[Ee])}return Fe}var ce=N("../types"),fe=ce.decode,_e=ce.encode,le=N("../parse"),pe=N("../table"),T=["copyright","fontFamily","fontSubfamily","uniqueID","fullName","version","postScriptName","trademark","manufacturer","designer","description","manufacturerURL","designerURL","license","licenseURL","reserved","preferredFamily","preferredSubfamily","compatibleFullName","sampleText","postScriptFindFontName","wwsFamily","wwsSubfamily"],B={0:"en",1:"fr",2:"de",3:"it",4:"nl",5:"sv",6:"es",7:"da",8:"pt",9:"no",10:"he",11:"ja",12:"ar",13:"fi",14:"el",15:"is",16:"mt",17:"tr",18:"hr",19:"zh-Hant",20:"ur",21:"hi",22:"th",23:"ko",24:"lt",25:"pl",26:"hu",27:"es",28:"lv",29:"se",30:"fo",31:"fa",32:"ru",33:"zh",34:"nl-BE",35:"ga",36:"sq",37:"ro",38:"cz",39:"sk",40:"si",41:"yi",42:"sr",43:"mk",44:"bg",45:"uk",46:"be",47:"uz",48:"kk",49:"az-Cyrl",50:"az-Arab",51:"hy",52:"ka",53:"mo",54:"ky",55:"tg",56:"tk",57:"mn-CN",58:"mn",59:"ps",60:"ks",61:"ku",62:"sd",63:"bo",64:"ne",65:"sa",66:"mr",67:"bn",68:"as",69:"gu",70:"pa",71:"or",72:"ml",73:"kn",74:"ta",75:"te",76:"si",77:"my",78:"km",79:"lo",80:"vi",81:"id",82:"tl",83:"ms",84:"ms-Arab",85:"am",86:"ti",87:"om",88:"so",89:"sw",90:"rw",91:"rn",92:"ny",93:"mg",94:"eo",128:"cy",129:"eu",130:"ca",131:"la",132:"qu",133:"gn",134:"ay",135:"tt",136:"ug",137:"dz",138:"jv",139:"su",140:"gl",141:"af",142:"br",143:"iu",144:"gd",145:"gv",146:"ga",147:"to",148:"el-polyton",149:"kl",150:"az",151:"nn"},q={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,10:5,11:1,12:4,13:0,14:6,15:0,16:0,17:0,18:0,19:2,20:4,21:9,22:21,23:3,24:29,25:29,26:29,27:29,28:29,29:0,30:0,31:4,32:7,33:25,34:0,35:0,36:0,37:0,38:29,39:29,40:0,41:5,42:7,43:7,44:7,45:7,46:7,47:7,48:7,49:7,50:4,51:24,52:23,53:7,54:7,55:7,56:7,57:27,58:7,59:4,60:4,61:4,62:4,63:26,64:9,65:9,66:9,67:13,68:13,69:11,70:10,71:12,72:17,73:16,74:14,75:15,76:18,77:19,78:20,79:22,80:30,81:0,82:0,83:0,84:4,85:28,86:28,87:28,88:0,89:0,90:0,91:0,92:0,93:0,94:0,128:0,129:0,130:0,131:0,132:0,133:0,134:0,135:7,136:4,137:26,138:0,139:0,140:0,141:0,142:0,143:28,144:0,145:0,146:0,147:0,148:6,149:0,150:0,151:0},ee={1078:"af",1052:"sq",1156:"gsw",1118:"am",5121:"ar-DZ",15361:"ar-BH",3073:"ar",2049:"ar-IQ",11265:"ar-JO",13313:"ar-KW",12289:"ar-LB",4097:"ar-LY",6145:"ary",8193:"ar-OM",16385:"ar-QA",1025:"ar-SA",10241:"ar-SY",7169:"aeb",14337:"ar-AE",9217:"ar-YE",1067:"hy",1101:"as",2092:"az-Cyrl",1068:"az",1133:"ba",1069:"eu",1059:"be",2117:"bn",1093:"bn-IN",8218:"bs-Cyrl",5146:"bs",1150:"br",1026:"bg",1027:"ca",3076:"zh-HK",5124:"zh-MO",2052:"zh",4100:"zh-SG",1028:"zh-TW",1155:"co",1050:"hr",4122:"hr-BA",1029:"cs",1030:"da",1164:"prs",1125:"dv",2067:"nl-BE",1043:"nl",3081:"en-AU",10249:"en-BZ",4105:"en-CA",9225:"en-029",16393:"en-IN",6153:"en-IE",8201:"en-JM",17417:"en-MY",5129:"en-NZ",13321:"en-PH",18441:"en-SG",7177:"en-ZA",11273:"en-TT",2057:"en-GB",1033:"en",12297:"en-ZW",1061:"et",1080:"fo",1124:"fil",1035:"fi",2060:"fr-BE",3084:"fr-CA",1036:"fr",5132:"fr-LU",6156:"fr-MC",4108:"fr-CH",1122:"fy",1110:"gl",1079:"ka",3079:"de-AT",1031:"de",5127:"de-LI",4103:"de-LU",2055:"de-CH",1032:"el",1135:"kl",1095:"gu",1128:"ha",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig",1057:"id",1117:"iu",2141:"iu-Latn",2108:"ga",1076:"xh",1077:"zu",1040:"it",2064:"it-CH",1041:"ja",1099:"kn",1087:"kk",1107:"km",1158:"quc",1159:"rw",1089:"sw",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1062:"lv",1063:"lt",2094:"dsb",1134:"lb",1071:"mk",2110:"ms-BN",1086:"ms",1100:"ml",1082:"mt",1153:"mi",1146:"arn",1102:"mr",1148:"moh",1104:"mn",2128:"mn-CN",1121:"ne",1044:"nb",2068:"nn",1154:"oc",1096:"or",1123:"ps",1045:"pl",1046:"pt",2070:"pt-PT",1094:"pa",1131:"qu-BO",2155:"qu-EC",3179:"qu",1048:"ro",1047:"rm",1049:"ru",9275:"smn",4155:"smj-NO",5179:"smj",3131:"se-FI",1083:"se",2107:"se-SE",8251:"sms",6203:"sma-NO",7227:"sms",1103:"sa",7194:"sr-Cyrl-BA",3098:"sr",6170:"sr-Latn-BA",2074:"sr-Latn",1132:"nso",1074:"tn",1115:"si",1051:"sk",1060:"sl",11274:"es-AR",16394:"es-BO",13322:"es-CL",9226:"es-CO",5130:"es-CR",7178:"es-DO",12298:"es-EC",17418:"es-SV",4106:"es-GT",18442:"es-HN",2058:"es-MX",19466:"es-NI",6154:"es-PA",15370:"es-PY",10250:"es-PE",20490:"es-PR",3082:"es",1034:"es",21514:"es-US",14346:"es-UY",8202:"es-VE",2077:"sv-FI",1053:"sv",1114:"syr",1064:"tg",2143:"tzm",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1055:"tr",1090:"tk",1152:"ug",1058:"uk",1070:"hsb",1056:"ur",2115:"uz-Cyrl",1091:"uz",1066:"vi",1106:"cy",1160:"wo",1157:"sah",1144:"ii",1130:"yo"},F="utf-16",Be={0:"macintosh",1:"x-mac-japanese",2:"x-mac-chinesetrad",3:"x-mac-korean",6:"x-mac-greek",7:"x-mac-cyrillic",9:"x-mac-devanagai",10:"x-mac-gurmukhi",11:"x-mac-gujarati",12:"x-mac-oriya",13:"x-mac-bengali",14:"x-mac-tamil",15:"x-mac-telugu",16:"x-mac-kannada",17:"x-mac-malayalam",18:"x-mac-sinhalese",19:"x-mac-burmese",20:"x-mac-khmer",21:"x-mac-thai",22:"x-mac-lao",23:"x-mac-georgian",24:"x-mac-armenian",25:"x-mac-chinesesimp",26:"x-mac-tibetan",27:"x-mac-mongolian",28:"x-mac-ethiopic",29:"x-mac-ce",30:"x-mac-vietnamese",31:"x-mac-extarabic"},K={15:"x-mac-icelandic",17:"x-mac-turkish",18:"x-mac-croatian",24:"x-mac-ce",25:"x-mac-ce",26:"x-mac-ce",27:"x-mac-ce",28:"x-mac-ce",30:"x-mac-icelandic",37:"x-mac-romanian",38:"x-mac-ce",39:"x-mac-ce",40:"x-mac-ce",143:"x-mac-inuit",146:"x-mac-gaelic"};G.parse=function(ve,Ae,Fe){for(var Ee={},qe=new le.Parser(ve,Ae),Ke=qe.parseUShort(),gt=qe.parseUShort(),at=qe.offset+qe.parseUShort(),Ct=0;gt>Ct;Ct++){var wt,Ft=qe.parseUShort(),Ot=qe.parseUShort(),rn=qe.parseUShort(),ft=qe.parseUShort(),Tn=T[ft]||ft,Cn=qe.parseUShort(),mn=qe.parseUShort(),Pn=A(Ft,rn,Fe),$n=P(Ft,Ot,rn);if(void 0!==$n&&void 0!==Pn&&(wt=$n===F?fe.UTF16(ve,at+mn,Cn):fe.MACSTRING(ve,at+mn,Cn,$n))){var gn=Ee[Tn];void 0===gn&&(gn=Ee[Tn]={}),gn[Pn]=wt}}return 1===Ke&&qe.parseUShort(),Ee},G.make=function(ve,Ae){var Fe,Ee=[],qe={},Ke=de(T);for(var gt in ve){var at=Ke[gt];if(void 0===at&&(at=gt),Fe=parseInt(at),isNaN(Fe))throw new Error('Name table entry "'+gt+'" does not exist, see nameTableNames for complete list.');qe[Fe]=ve[gt],Ee.push(Fe)}for(var Ct=de(B),wt=de(ee),Ft=[],Ot=[],rn=0;rn<Ee.length;rn++){var ft=qe[Fe=Ee[rn]];for(var Tn in ft){var Cn=ft[Tn],mn=1,Pn=Ct[Tn],$n=q[Pn],gn=P(mn,$n,Pn),ur=_e.MACSTRING(Cn,gn);void 0===ur&&(mn=0,0>(Pn=Ae.indexOf(Tn))&&(Pn=Ae.length,Ae.push(Tn)),$n=4,ur=_e.UTF16(Cn));var or=te(ur,Ot);Ft.push(be(mn,$n,Pn,Fe,ur.length,or));var hr=wt[Tn];if(void 0!==hr){var sr=_e.UTF16(Cn),ei=te(sr,Ot);Ft.push(be(3,1,hr,Fe,sr.length,ei))}}}Ft.sort(function(ir,vr){return ir.platformID-vr.platformID||ir.encodingID-vr.encodingID||ir.languageID-vr.languageID||ir.nameID-vr.nameID});for(var Jr=new pe.Table("name",[{name:"format",type:"USHORT",value:0},{name:"count",type:"USHORT",value:Ft.length},{name:"stringOffset",type:"USHORT",value:6+12*Ft.length}]),ci=0;ci<Ft.length;ci++)Jr.fields.push({name:"record_"+ci,type:"RECORD",value:Ft[ci]});return Jr.fields.push({name:"strings",type:"LITERAL",value:Ot}),Jr}},{"../parse":10,"../table":13,"../types":32}],29:[function(N,U,G){var A=N("../parse"),P=N("../table"),de=[{begin:0,end:127},{begin:128,end:255},{begin:256,end:383},{begin:384,end:591},{begin:592,end:687},{begin:688,end:767},{begin:768,end:879},{begin:880,end:1023},{begin:11392,end:11519},{begin:1024,end:1279},{begin:1328,end:1423},{begin:1424,end:1535},{begin:42240,end:42559},{begin:1536,end:1791},{begin:1984,end:2047},{begin:2304,end:2431},{begin:2432,end:2559},{begin:2560,end:2687},{begin:2688,end:2815},{begin:2816,end:2943},{begin:2944,end:3071},{begin:3072,end:3199},{begin:3200,end:3327},{begin:3328,end:3455},{begin:3584,end:3711},{begin:3712,end:3839},{begin:4256,end:4351},{begin:6912,end:7039},{begin:4352,end:4607},{begin:7680,end:7935},{begin:7936,end:8191},{begin:8192,end:8303},{begin:8304,end:8351},{begin:8352,end:8399},{begin:8400,end:8447},{begin:8448,end:8527},{begin:8528,end:8591},{begin:8592,end:8703},{begin:8704,end:8959},{begin:8960,end:9215},{begin:9216,end:9279},{begin:9280,end:9311},{begin:9312,end:9471},{begin:9472,end:9599},{begin:9600,end:9631},{begin:9632,end:9727},{begin:9728,end:9983},{begin:9984,end:10175},{begin:12288,end:12351},{begin:12352,end:12447},{begin:12448,end:12543},{begin:12544,end:12591},{begin:12592,end:12687},{begin:43072,end:43135},{begin:12800,end:13055},{begin:13056,end:13311},{begin:44032,end:55215},{begin:55296,end:57343},{begin:67840,end:67871},{begin:19968,end:40959},{begin:57344,end:63743},{begin:12736,end:12783},{begin:64256,end:64335},{begin:64336,end:65023},{begin:65056,end:65071},{begin:65040,end:65055},{begin:65104,end:65135},{begin:65136,end:65279},{begin:65280,end:65519},{begin:65520,end:65535},{begin:3840,end:4095},{begin:1792,end:1871},{begin:1920,end:1983},{begin:3456,end:3583},{begin:4096,end:4255},{begin:4608,end:4991},{begin:5024,end:5119},{begin:5120,end:5759},{begin:5760,end:5791},{begin:5792,end:5887},{begin:6016,end:6143},{begin:6144,end:6319},{begin:10240,end:10495},{begin:40960,end:42127},{begin:5888,end:5919},{begin:66304,end:66351},{begin:66352,end:66383},{begin:66560,end:66639},{begin:118784,end:119039},{begin:119808,end:120831},{begin:1044480,end:1048573},{begin:65024,end:65039},{begin:917504,end:917631},{begin:6400,end:6479},{begin:6480,end:6527},{begin:6528,end:6623},{begin:6656,end:6687},{begin:11264,end:11359},{begin:11568,end:11647},{begin:19904,end:19967},{begin:43008,end:43055},{begin:65536,end:65663},{begin:65856,end:65935},{begin:66432,end:66463},{begin:66464,end:66527},{begin:66640,end:66687},{begin:66688,end:66735},{begin:67584,end:67647},{begin:68096,end:68191},{begin:119552,end:119647},{begin:73728,end:74751},{begin:119648,end:119679},{begin:7040,end:7103},{begin:7168,end:7247},{begin:7248,end:7295},{begin:43136,end:43231},{begin:43264,end:43311},{begin:43312,end:43359},{begin:43520,end:43615},{begin:65936,end:65999},{begin:66e3,end:66047},{begin:66208,end:66271},{begin:127024,end:127135}];G.unicodeRanges=de,G.getUnicodeRange=function(be){for(var te=0;te<de.length;te+=1){var ce=de[te];if(be>=ce.begin&&be<ce.end)return te}return-1},G.parse=function(be,te){var ce={},fe=new A.Parser(be,te);ce.version=fe.parseUShort(),ce.xAvgCharWidth=fe.parseShort(),ce.usWeightClass=fe.parseUShort(),ce.usWidthClass=fe.parseUShort(),ce.fsType=fe.parseUShort(),ce.ySubscriptXSize=fe.parseShort(),ce.ySubscriptYSize=fe.parseShort(),ce.ySubscriptXOffset=fe.parseShort(),ce.ySubscriptYOffset=fe.parseShort(),ce.ySuperscriptXSize=fe.parseShort(),ce.ySuperscriptYSize=fe.parseShort(),ce.ySuperscriptXOffset=fe.parseShort(),ce.ySuperscriptYOffset=fe.parseShort(),ce.yStrikeoutSize=fe.parseShort(),ce.yStrikeoutPosition=fe.parseShort(),ce.sFamilyClass=fe.parseShort(),ce.panose=[];for(var _e=0;10>_e;_e++)ce.panose[_e]=fe.parseByte();return ce.ulUnicodeRange1=fe.parseULong(),ce.ulUnicodeRange2=fe.parseULong(),ce.ulUnicodeRange3=fe.parseULong(),ce.ulUnicodeRange4=fe.parseULong(),ce.achVendID=String.fromCharCode(fe.parseByte(),fe.parseByte(),fe.parseByte(),fe.parseByte()),ce.fsSelection=fe.parseUShort(),ce.usFirstCharIndex=fe.parseUShort(),ce.usLastCharIndex=fe.parseUShort(),ce.sTypoAscender=fe.parseShort(),ce.sTypoDescender=fe.parseShort(),ce.sTypoLineGap=fe.parseShort(),ce.usWinAscent=fe.parseUShort(),ce.usWinDescent=fe.parseUShort(),ce.version>=1&&(ce.ulCodePageRange1=fe.parseULong(),ce.ulCodePageRange2=fe.parseULong()),ce.version>=2&&(ce.sxHeight=fe.parseShort(),ce.sCapHeight=fe.parseShort(),ce.usDefaultChar=fe.parseUShort(),ce.usBreakChar=fe.parseUShort(),ce.usMaxContent=fe.parseUShort()),ce},G.make=function(be){return new P.Table("OS/2",[{name:"version",type:"USHORT",value:3},{name:"xAvgCharWidth",type:"SHORT",value:0},{name:"usWeightClass",type:"USHORT",value:0},{name:"usWidthClass",type:"USHORT",value:0},{name:"fsType",type:"USHORT",value:0},{name:"ySubscriptXSize",type:"SHORT",value:650},{name:"ySubscriptYSize",type:"SHORT",value:699},{name:"ySubscriptXOffset",type:"SHORT",value:0},{name:"ySubscriptYOffset",type:"SHORT",value:140},{name:"ySuperscriptXSize",type:"SHORT",value:650},{name:"ySuperscriptYSize",type:"SHORT",value:699},{name:"ySuperscriptXOffset",type:"SHORT",value:0},{name:"ySuperscriptYOffset",type:"SHORT",value:479},{name:"yStrikeoutSize",type:"SHORT",value:49},{name:"yStrikeoutPosition",type:"SHORT",value:258},{name:"sFamilyClass",type:"SHORT",value:0},{name:"bFamilyType",type:"BYTE",value:0},{name:"bSerifStyle",type:"BYTE",value:0},{name:"bWeight",type:"BYTE",value:0},{name:"bProportion",type:"BYTE",value:0},{name:"bContrast",type:"BYTE",value:0},{name:"bStrokeVariation",type:"BYTE",value:0},{name:"bArmStyle",type:"BYTE",value:0},{name:"bLetterform",type:"BYTE",value:0},{name:"bMidline",type:"BYTE",value:0},{name:"bXHeight",type:"BYTE",value:0},{name:"ulUnicodeRange1",type:"ULONG",value:0},{name:"ulUnicodeRange2",type:"ULONG",value:0},{name:"ulUnicodeRange3",type:"ULONG",value:0},{name:"ulUnicodeRange4",type:"ULONG",value:0},{name:"achVendID",type:"CHARARRAY",value:"XXXX"},{name:"fsSelection",type:"USHORT",value:0},{name:"usFirstCharIndex",type:"USHORT",value:0},{name:"usLastCharIndex",type:"USHORT",value:0},{name:"sTypoAscender",type:"SHORT",value:0},{name:"sTypoDescender",type:"SHORT",value:0},{name:"sTypoLineGap",type:"SHORT",value:0},{name:"usWinAscent",type:"USHORT",value:0},{name:"usWinDescent",type:"USHORT",value:0},{name:"ulCodePageRange1",type:"ULONG",value:0},{name:"ulCodePageRange2",type:"ULONG",value:0},{name:"sxHeight",type:"SHORT",value:0},{name:"sCapHeight",type:"SHORT",value:0},{name:"usDefaultChar",type:"USHORT",value:0},{name:"usBreakChar",type:"USHORT",value:0},{name:"usMaxContext",type:"USHORT",value:0}],be)}},{"../parse":10,"../table":13}],30:[function(N,U,G){var A=N("../encoding"),P=N("../parse"),de=N("../table");G.parse=function(be,te){var ce,fe={},_e=new P.Parser(be,te);switch(fe.version=_e.parseVersion(),fe.italicAngle=_e.parseFixed(),fe.underlinePosition=_e.parseShort(),fe.underlineThickness=_e.parseShort(),fe.isFixedPitch=_e.parseULong(),fe.minMemType42=_e.parseULong(),fe.maxMemType42=_e.parseULong(),fe.minMemType1=_e.parseULong(),fe.maxMemType1=_e.parseULong(),fe.version){case 1:fe.names=A.standardNames.slice();break;case 2:for(fe.numberOfGlyphs=_e.parseUShort(),fe.glyphNameIndex=new Array(fe.numberOfGlyphs),ce=0;ce<fe.numberOfGlyphs;ce++)fe.glyphNameIndex[ce]=_e.parseUShort();for(fe.names=[],ce=0;ce<fe.numberOfGlyphs;ce++)if(fe.glyphNameIndex[ce]>=A.standardNames.length){var le=_e.parseChar();fe.names.push(_e.parseString(le))}break;case 2.5:for(fe.numberOfGlyphs=_e.parseUShort(),fe.offset=new Array(fe.numberOfGlyphs),ce=0;ce<fe.numberOfGlyphs;ce++)fe.offset[ce]=_e.parseChar()}return fe},G.make=function(){return new de.Table("post",[{name:"version",type:"FIXED",value:196608},{name:"italicAngle",type:"FIXED",value:0},{name:"underlinePosition",type:"FWORD",value:0},{name:"underlineThickness",type:"FWORD",value:0},{name:"isFixedPitch",type:"ULONG",value:0},{name:"minMemType42",type:"ULONG",value:0},{name:"maxMemType42",type:"ULONG",value:0},{name:"minMemType1",type:"ULONG",value:0},{name:"maxMemType1",type:"ULONG",value:0}])}},{"../encoding":4,"../parse":10,"../table":13}],31:[function(N,U,G){function A(Ee){return Math.log(Ee)/Math.log(2)|0}function P(Ee){for(;Ee.length%4!=0;)Ee.push(0);for(var qe=0,Ke=0;Ke<Ee.length;Ke+=4)qe+=(Ee[Ke]<<24)+(Ee[Ke+1]<<16)+(Ee[Ke+2]<<8)+Ee[Ke+3];return qe%Math.pow(2,32)}function de(Ee,qe,Ke,gt){return new _e.Record("Table Record",[{name:"tag",type:"TAG",value:void 0!==Ee?Ee:""},{name:"checkSum",type:"ULONG",value:void 0!==qe?qe:0},{name:"offset",type:"ULONG",value:void 0!==Ke?Ke:0},{name:"length",type:"ULONG",value:void 0!==gt?gt:0}])}function be(Ee){var qe=new _e.Table("sfnt",[{name:"version",type:"TAG",value:"OTTO"},{name:"numTables",type:"USHORT",value:0},{name:"searchRange",type:"USHORT",value:0},{name:"entrySelector",type:"USHORT",value:0},{name:"rangeShift",type:"USHORT",value:0}]);qe.tables=Ee,qe.numTables=Ee.length;var Ke=Math.pow(2,A(qe.numTables));qe.searchRange=16*Ke,qe.entrySelector=A(Ke),qe.rangeShift=16*qe.numTables-qe.searchRange;for(var gt=[],at=[],Ct=qe.sizeOf()+de().sizeOf()*qe.numTables;Ct%4!=0;)Ct+=1,at.push({name:"padding",type:"BYTE",value:0});for(var wt=0;wt<Ee.length;wt+=1){var Ft=Ee[wt];fe.argument(4===Ft.tableName.length,"Table name"+Ft.tableName+" is invalid.");var Ot=Ft.sizeOf(),rn=de(Ft.tableName,P(Ft.encode()),Ct,Ot);for(gt.push({name:rn.tag+" Table Record",type:"RECORD",value:rn}),at.push({name:Ft.tableName+" table",type:"RECORD",value:Ft}),Ct+=Ot,fe.argument(!isNaN(Ct),"Something went wrong calculating the offset.");Ct%4!=0;)Ct+=1,at.push({name:"padding",type:"BYTE",value:0})}return gt.sort(function(ft,Tn){return ft.value.tag>Tn.value.tag?1:-1}),qe.fields=qe.fields.concat(gt),qe.fields=qe.fields.concat(at),qe}function te(Ee,qe,Ke){for(var gt=0;gt<qe.length;gt+=1){var at=Ee.charToGlyphIndex(qe[gt]);if(at>0)return Ee.glyphs.get(at).getMetrics()}return Ke}function ce(Ee){for(var qe=0,Ke=0;Ke<Ee.length;Ke+=1)qe+=Ee[Ke];return qe/Ee.length}var fe=N("../check"),_e=N("../table"),le=N("./cmap"),pe=N("./cff"),T=N("./head"),B=N("./hhea"),q=N("./hmtx"),ee=N("./ltag"),F=N("./maxp"),Be=N("./name"),K=N("./os2"),ve=N("./post"),Ae=N("./gsub"),Fe=N("./meta");G.computeCheckSum=P,G.make=be,G.fontToTable=function(Ee){for(var qe,Ke=[],gt=[],at=[],Ct=[],wt=[],Ft=[],Ot=[],rn=0,ft=0,Tn=0,Cn=0,mn=0,Pn=0;Pn<Ee.glyphs.length;Pn+=1){var $n=Ee.glyphs.get(Pn),gn=0|$n.unicode;if(isNaN($n.advanceWidth))throw new Error("Glyph "+$n.name+" ("+Pn+"): advanceWidth is not a number.");(qe>gn||void 0===qe)&&gn>0&&(qe=gn),gn>rn&&(rn=gn);var ur=K.getUnicodeRange(gn);if(32>ur)ft|=1<<ur;else if(64>ur)Tn|=1<<ur-32;else if(96>ur)Cn|=1<<ur-64;else{if(!(123>ur))throw new Error("Unicode ranges bits > 123 are reserved for internal usage");mn|=1<<ur-96}if(".notdef"!==$n.name){var or=$n.getMetrics();Ke.push(or.xMin),gt.push(or.yMin),at.push(or.xMax),Ct.push(or.yMax),Ft.push(or.leftSideBearing),Ot.push(or.rightSideBearing),wt.push($n.advanceWidth)}}var hr={xMin:Math.min.apply(null,Ke),yMin:Math.min.apply(null,gt),xMax:Math.max.apply(null,at),yMax:Math.max.apply(null,Ct),advanceWidthMax:Math.max.apply(null,wt),advanceWidthAvg:ce(wt),minLeftSideBearing:Math.min.apply(null,Ft),maxLeftSideBearing:Math.max.apply(null,Ft),minRightSideBearing:Math.min.apply(null,Ot)};hr.ascender=Ee.ascender,hr.descender=Ee.descender;var sr=T.make({flags:3,unitsPerEm:Ee.unitsPerEm,xMin:hr.xMin,yMin:hr.yMin,xMax:hr.xMax,yMax:hr.yMax,lowestRecPPEM:3,createdTimestamp:Ee.createdTimestamp}),ei=B.make({ascender:hr.ascender,descender:hr.descender,advanceWidthMax:hr.advanceWidthMax,minLeftSideBearing:hr.minLeftSideBearing,minRightSideBearing:hr.minRightSideBearing,xMaxExtent:hr.maxLeftSideBearing+(hr.xMax-hr.xMin),numberOfHMetrics:Ee.glyphs.length}),Jr=F.make(Ee.glyphs.length),ci=K.make({xAvgCharWidth:Math.round(hr.advanceWidthAvg),usWeightClass:Ee.tables.os2.usWeightClass,usWidthClass:Ee.tables.os2.usWidthClass,usFirstCharIndex:qe,usLastCharIndex:rn,ulUnicodeRange1:ft,ulUnicodeRange2:Tn,ulUnicodeRange3:Cn,ulUnicodeRange4:mn,fsSelection:Ee.tables.os2.fsSelection,sTypoAscender:hr.ascender,sTypoDescender:hr.descender,sTypoLineGap:0,usWinAscent:hr.yMax,usWinDescent:Math.abs(hr.yMin),ulCodePageRange1:1,sxHeight:te(Ee,"xyvw",{yMax:Math.round(hr.ascender/2)}).yMax,sCapHeight:te(Ee,"HIKLEFJMNTZBDPRAGOQSUVWXY",hr).yMax,usDefaultChar:Ee.hasChar(" ")?32:0,usBreakChar:Ee.hasChar(" ")?32:0}),ir=q.make(Ee.glyphs),vr=le.make(Ee.glyphs),pi=Ee.getEnglishName("fontFamily"),go=Ee.getEnglishName("fontSubfamily"),Nr=pi+" "+go,Zr=Ee.getEnglishName("postScriptName");Zr||(Zr=pi.replace(/\s/g,"")+"-"+go);var Vr={};for(var fi in Ee.names)Vr[fi]=Ee.names[fi];Vr.uniqueID||(Vr.uniqueID={en:Ee.getEnglishName("manufacturer")+":"+Nr}),Vr.postScriptName||(Vr.postScriptName={en:Zr}),Vr.preferredFamily||(Vr.preferredFamily=Ee.names.fontFamily),Vr.preferredSubfamily||(Vr.preferredSubfamily=Ee.names.fontSubfamily);var bi=[],So=Be.make(Vr,bi),Gs=bi.length>0?ee.make(bi):void 0,Ks=ve.make(),Di=pe.make(Ee.glyphs,{version:Ee.getEnglishName("version"),fullName:Nr,familyName:pi,weightName:go,postScriptName:Zr,unitsPerEm:Ee.unitsPerEm,fontBBox:[0,hr.yMin,hr.ascender,hr.advanceWidthMax]}),Eo=Ee.metas&&Object.keys(Ee.metas).length>0?Fe.make(Ee.metas):void 0,vo=[sr,ei,Jr,ci,So,vr,Ks,Di,ir];Gs&&vo.push(Gs),Ee.tables.gsub&&vo.push(Ae.make(Ee.tables.gsub)),Eo&&vo.push(Eo);var Xr=be(vo),ss=P(Xr.encode()),Or=Xr.fields,Na=!1;for(Pn=0;Pn<Or.length;Pn+=1)if("head table"===Or[Pn].name){Or[Pn].value.checkSumAdjustment=2981146554-ss,Na=!0;break}if(!Na)throw new Error("Could not find head table with checkSum to adjust.");return Xr}},{"../check":2,"../table":13,"./cff":14,"./cmap":15,"./gsub":19,"./head":20,"./hhea":21,"./hmtx":22,"./ltag":25,"./maxp":26,"./meta":27,"./name":28,"./os2":29,"./post":30}],32:[function(N,U,G){function A(T){return function(){return T}}var P=N("./check"),de=2147483648,be={},te={},ce={};te.BYTE=function(T){return P.argument(T>=0&&255>=T,"Byte value should be between 0 and 255."),[T]},ce.BYTE=A(1),te.CHAR=function(T){return[T.charCodeAt(0)]},ce.CHAR=A(1),te.CHARARRAY=function(T){for(var B=[],q=0;q<T.length;q+=1)B[q]=T.charCodeAt(q);return B},ce.CHARARRAY=function(T){return T.length},te.USHORT=function(T){return[T>>8&255,255&T]},ce.USHORT=A(2),te.SHORT=function(T){return T>=32768&&(T=-(65536-T)),[T>>8&255,255&T]},ce.SHORT=A(2),te.UINT24=function(T){return[T>>16&255,T>>8&255,255&T]},ce.UINT24=A(3),te.ULONG=function(T){return[T>>24&255,T>>16&255,T>>8&255,255&T]},ce.ULONG=A(4),te.LONG=function(T){return T>=de&&(T=-(2*de-T)),[T>>24&255,T>>16&255,T>>8&255,255&T]},ce.LONG=A(4),te.FIXED=te.ULONG,ce.FIXED=ce.ULONG,te.FWORD=te.SHORT,ce.FWORD=ce.SHORT,te.UFWORD=te.USHORT,ce.UFWORD=ce.USHORT,te.LONGDATETIME=function(T){return[0,0,0,0,T>>24&255,T>>16&255,T>>8&255,255&T]},ce.LONGDATETIME=A(8),te.TAG=function(T){return P.argument(4===T.length,"Tag should be exactly 4 ASCII characters."),[T.charCodeAt(0),T.charCodeAt(1),T.charCodeAt(2),T.charCodeAt(3)]},ce.TAG=A(4),te.Card8=te.BYTE,ce.Card8=ce.BYTE,te.Card16=te.USHORT,ce.Card16=ce.USHORT,te.OffSize=te.BYTE,ce.OffSize=ce.BYTE,te.SID=te.USHORT,ce.SID=ce.USHORT,te.NUMBER=function(T){return T>=-107&&107>=T?[T+139]:T>=108&&1131>=T?[247+((T-=108)>>8),255&T]:T>=-1131&&-108>=T?[251+((T=-T-108)>>8),255&T]:T>=-32768&&32767>=T?te.NUMBER16(T):te.NUMBER32(T)},ce.NUMBER=function(T){return te.NUMBER(T).length},te.NUMBER16=function(T){return[28,T>>8&255,255&T]},ce.NUMBER16=A(3),te.NUMBER32=function(T){return[29,T>>24&255,T>>16&255,T>>8&255,255&T]},ce.NUMBER32=A(5),te.REAL=function(T){var B=T.toString(),q=/\.(\d*?)(?:9{5,20}|0{5,20})\d{0,2}(?:e(.+)|$)/.exec(B);if(q){var ee=parseFloat("1e"+((q[2]?+q[2]:0)+q[1].length));B=(Math.round(T*ee)/ee).toString()}var F,Be,K="";for(F=0,Be=B.length;Be>F;F+=1){var ve=B[F];K+="e"===ve?"-"===B[++F]?"c":"b":"."===ve?"a":"-"===ve?"e":ve}var Ae=[30];for(F=0,Be=(K+=1&K.length?"f":"ff").length;Be>F;F+=2)Ae.push(parseInt(K.substr(F,2),16));return Ae},ce.REAL=function(T){return te.REAL(T).length},te.NAME=te.CHARARRAY,ce.NAME=ce.CHARARRAY,te.STRING=te.CHARARRAY,ce.STRING=ce.CHARARRAY,be.UTF8=function(T,B,q){for(var ee=[],F=q,Be=0;F>Be;Be++,B+=1)ee[Be]=T.getUint8(B);return String.fromCharCode.apply(null,ee)},be.UTF16=function(T,B,q){for(var ee=[],F=q/2,Be=0;F>Be;Be++,B+=2)ee[Be]=T.getUint16(B);return String.fromCharCode.apply(null,ee)},te.UTF16=function(T){for(var B=[],q=0;q<T.length;q+=1){var ee=T.charCodeAt(q);B[B.length]=ee>>8&255,B[B.length]=255&ee}return B},ce.UTF16=function(T){return 2*T.length};var fe={"x-mac-croatian":"\xc4\xc5\xc7\xc9\xd1\xd6\xdc\xe1\xe0\xe2\xe4\xe3\xe5\xe7\xe9\xe8\xea\xeb\xed\xec\xee\xef\xf1\xf3\xf2\xf4\xf6\xf5\xfa\xf9\xfb\xfc\u2020\xb0\xa2\xa3\xa7\u2022\xb6\xdf\xae\u0160\u2122\xb4\xa8\u2260\u017d\xd8\u221e\xb1\u2264\u2265\u2206\xb5\u2202\u2211\u220f\u0161\u222b\xaa\xba\u03a9\u017e\xf8\xbf\xa1\xac\u221a\u0192\u2248\u0106\xab\u010c\u2026\xa0\xc0\xc3\xd5\u0152\u0153\u0110\u2014\u201c\u201d\u2018\u2019\xf7\u25ca\uf8ff\xa9\u2044\u20ac\u2039\u203a\xc6\xbb\u2013\xb7\u201a\u201e\u2030\xc2\u0107\xc1\u010d\xc8\xcd\xce\xcf\xcc\xd3\xd4\u0111\xd2\xda\xdb\xd9\u0131\u02c6\u02dc\xaf\u03c0\xcb\u02da\xb8\xca\xe6\u02c7","x-mac-cyrillic":"\u0410\u0411\u0412\u0413\u0414\u0415\u0416\u0417\u0418\u0419\u041a\u041b\u041c\u041d\u041e\u041f\u0420\u0421\u0422\u0423\u0424\u0425\u0426\u0427\u0428\u0429\u042a\u042b\u042c\u042d\u042e\u042f\u2020\xb0\u0490\xa3\xa7\u2022\xb6\u0406\xae\xa9\u2122\u0402\u0452\u2260\u0403\u0453\u221e\xb1\u2264\u2265\u0456\xb5\u0491\u0408\u0404\u0454\u0407\u0457\u0409\u0459\u040a\u045a\u0458\u0405\xac\u221a\u0192\u2248\u2206\xab\xbb\u2026\xa0\u040b\u045b\u040c\u045c\u0455\u2013\u2014\u201c\u201d\u2018\u2019\xf7\u201e\u040e\u045e\u040f\u045f\u2116\u0401\u0451\u044f\u0430\u0431\u0432\u0433\u0434\u0435\u0436\u0437\u0438\u0439\u043a\u043b\u043c\u043d\u043e\u043f\u0440\u0441\u0442\u0443\u0444\u0445\u0446\u0447\u0448\u0449\u044a\u044b\u044c\u044d\u044e","x-mac-gaelic":"\xc4\xc5\xc7\xc9\xd1\xd6\xdc\xe1\xe0\xe2\xe4\xe3\xe5\xe7\xe9\xe8\xea\xeb\xed\xec\xee\xef\xf1\xf3\xf2\xf4\xf6\xf5\xfa\xf9\xfb\xfc\u2020\xb0\xa2\xa3\xa7\u2022\xb6\xdf\xae\xa9\u2122\xb4\xa8\u2260\xc6\xd8\u1e02\xb1\u2264\u2265\u1e03\u010a\u010b\u1e0a\u1e0b\u1e1e\u1e1f\u0120\u0121\u1e40\xe6\xf8\u1e41\u1e56\u1e57\u027c\u0192\u017f\u1e60\xab\xbb\u2026\xa0\xc0\xc3\xd5\u0152\u0153\u2013\u2014\u201c\u201d\u2018\u2019\u1e61\u1e9b\xff\u0178\u1e6a\u20ac\u2039\u203a\u0176\u0177\u1e6b\xb7\u1ef2\u1ef3\u204a\xc2\xca\xc1\xcb\xc8\xcd\xce\xcf\xcc\xd3\xd4\u2663\xd2\xda\xdb\xd9\u0131\xdd\xfd\u0174\u0175\u1e84\u1e85\u1e80\u1e81\u1e82\u1e83","x-mac-greek":"\xc4\xb9\xb2\xc9\xb3\xd6\xdc\u0385\xe0\xe2\xe4\u0384\xa8\xe7\xe9\xe8\xea\xeb\xa3\u2122\xee\xef\u2022\xbd\u2030\xf4\xf6\xa6\u20ac\xf9\xfb\xfc\u2020\u0393\u0394\u0398\u039b\u039e\u03a0\xdf\xae\xa9\u03a3\u03aa\xa7\u2260\xb0\xb7\u0391\xb1\u2264\u2265\xa5\u0392\u0395\u0396\u0397\u0399\u039a\u039c\u03a6\u03ab\u03a8\u03a9\u03ac\u039d\xac\u039f\u03a1\u2248\u03a4\xab\xbb\u2026\xa0\u03a5\u03a7\u0386\u0388\u0153\u2013\u2015\u201c\u201d\u2018\u2019\xf7\u0389\u038a\u038c\u038e\u03ad\u03ae\u03af\u03cc\u038f\u03cd\u03b1\u03b2\u03c8\u03b4\u03b5\u03c6\u03b3\u03b7\u03b9\u03be\u03ba\u03bb\u03bc\u03bd\u03bf\u03c0\u03ce\u03c1\u03c3\u03c4\u03b8\u03c9\u03c2\u03c7\u03c5\u03b6\u03ca\u03cb\u0390\u03b0\xad","x-mac-icelandic":"\xc4\xc5\xc7\xc9\xd1\xd6\xdc\xe1\xe0\xe2\xe4\xe3\xe5\xe7\xe9\xe8\xea\xeb\xed\xec\xee\xef\xf1\xf3\xf2\xf4\xf6\xf5\xfa\xf9\xfb\xfc\xdd\xb0\xa2\xa3\xa7\u2022\xb6\xdf\xae\xa9\u2122\xb4\xa8\u2260\xc6\xd8\u221e\xb1\u2264\u2265\xa5\xb5\u2202\u2211\u220f\u03c0\u222b\xaa\xba\u03a9\xe6\xf8\xbf\xa1\xac\u221a\u0192\u2248\u2206\xab\xbb\u2026\xa0\xc0\xc3\xd5\u0152\u0153\u2013\u2014\u201c\u201d\u2018\u2019\xf7\u25ca\xff\u0178\u2044\u20ac\xd0\xf0\xde\xfe\xfd\xb7\u201a\u201e\u2030\xc2\xca\xc1\xcb\xc8\xcd\xce\xcf\xcc\xd3\xd4\uf8ff\xd2\xda\xdb\xd9\u0131\u02c6\u02dc\xaf\u02d8\u02d9\u02da\xb8\u02dd\u02db\u02c7","x-mac-inuit":"\u1403\u1404\u1405\u1406\u140a\u140b\u1431\u1432\u1433\u1434\u1438\u1439\u1449\u144e\u144f\u1450\u1451\u1455\u1456\u1466\u146d\u146e\u146f\u1470\u1472\u1473\u1483\u148b\u148c\u148d\u148e\u1490\u1491\xb0\u14a1\u14a5\u14a6\u2022\xb6\u14a7\xae\xa9\u2122\u14a8\u14aa\u14ab\u14bb\u14c2\u14c3\u14c4\u14c5\u14c7\u14c8\u14d0\u14ef\u14f0\u14f1\u14f2\u14f4\u14f5\u1505\u14d5\u14d6\u14d7\u14d8\u14da\u14db\u14ea\u1528\u1529\u152a\u152b\u152d\u2026\xa0\u152e\u153e\u1555\u1556\u1557\u2013\u2014\u201c\u201d\u2018\u2019\u1558\u1559\u155a\u155d\u1546\u1547\u1548\u1549\u154b\u154c\u1550\u157f\u1580\u1581\u1582\u1583\u1584\u1585\u158f\u1590\u1591\u1592\u1593\u1594\u1595\u1671\u1672\u1673\u1674\u1675\u1676\u1596\u15a0\u15a1\u15a2\u15a3\u15a4\u15a5\u15a6\u157c\u0141\u0142","x-mac-ce":"\xc4\u0100\u0101\xc9\u0104\xd6\xdc\xe1\u0105\u010c\xe4\u010d\u0106\u0107\xe9\u0179\u017a\u010e\xed\u010f\u0112\u0113\u0116\xf3\u0117\xf4\xf6\xf5\xfa\u011a\u011b\xfc\u2020\xb0\u0118\xa3\xa7\u2022\xb6\xdf\xae\xa9\u2122\u0119\xa8\u2260\u0123\u012e\u012f\u012a\u2264\u2265\u012b\u0136\u2202\u2211\u0142\u013b\u013c\u013d\u013e\u0139\u013a\u0145\u0146\u0143\xac\u221a\u0144\u0147\u2206\xab\xbb\u2026\xa0\u0148\u0150\xd5\u0151\u014c\u2013\u2014\u201c\u201d\u2018\u2019\xf7\u25ca\u014d\u0154\u0155\u0158\u2039\u203a\u0159\u0156\u0157\u0160\u201a\u201e\u0161\u015a\u015b\xc1\u0164\u0165\xcd\u017d\u017e\u016a\xd3\xd4\u016b\u016e\xda\u016f\u0170\u0171\u0172\u0173\xdd\xfd\u0137\u017b\u0141\u017c\u0122\u02c7",macintosh:"\xc4\xc5\xc7\xc9\xd1\xd6\xdc\xe1\xe0\xe2\xe4\xe3\xe5\xe7\xe9\xe8\xea\xeb\xed\xec\xee\xef\xf1\xf3\xf2\xf4\xf6\xf5\xfa\xf9\xfb\xfc\u2020\xb0\xa2\xa3\xa7\u2022\xb6\xdf\xae\xa9\u2122\xb4\xa8\u2260\xc6\xd8\u221e\xb1\u2264\u2265\xa5\xb5\u2202\u2211\u220f\u03c0\u222b\xaa\xba\u03a9\xe6\xf8\xbf\xa1\xac\u221a\u0192\u2248\u2206\xab\xbb\u2026\xa0\xc0\xc3\xd5\u0152\u0153\u2013\u2014\u201c\u201d\u2018\u2019\xf7\u25ca\xff\u0178\u2044\u20ac\u2039\u203a\ufb01\ufb02\u2021\xb7\u201a\u201e\u2030\xc2\xca\xc1\xcb\xc8\xcd\xce\xcf\xcc\xd3\xd4\uf8ff\xd2\xda\xdb\xd9\u0131\u02c6\u02dc\xaf\u02d8\u02d9\u02da\xb8\u02dd\u02db\u02c7","x-mac-romanian":"\xc4\xc5\xc7\xc9\xd1\xd6\xdc\xe1\xe0\xe2\xe4\xe3\xe5\xe7\xe9\xe8\xea\xeb\xed\xec\xee\xef\xf1\xf3\xf2\xf4\xf6\xf5\xfa\xf9\xfb\xfc\u2020\xb0\xa2\xa3\xa7\u2022\xb6\xdf\xae\xa9\u2122\xb4\xa8\u2260\u0102\u0218\u221e\xb1\u2264\u2265\xa5\xb5\u2202\u2211\u220f\u03c0\u222b\xaa\xba\u03a9\u0103\u0219\xbf\xa1\xac\u221a\u0192\u2248\u2206\xab\xbb\u2026\xa0\xc0\xc3\xd5\u0152\u0153\u2013\u2014\u201c\u201d\u2018\u2019\xf7\u25ca\xff\u0178\u2044\u20ac\u2039\u203a\u021a\u021b\u2021\xb7\u201a\u201e\u2030\xc2\xca\xc1\xcb\xc8\xcd\xce\xcf\xcc\xd3\xd4\uf8ff\xd2\xda\xdb\xd9\u0131\u02c6\u02dc\xaf\u02d8\u02d9\u02da\xb8\u02dd\u02db\u02c7","x-mac-turkish":"\xc4\xc5\xc7\xc9\xd1\xd6\xdc\xe1\xe0\xe2\xe4\xe3\xe5\xe7\xe9\xe8\xea\xeb\xed\xec\xee\xef\xf1\xf3\xf2\xf4\xf6\xf5\xfa\xf9\xfb\xfc\u2020\xb0\xa2\xa3\xa7\u2022\xb6\xdf\xae\xa9\u2122\xb4\xa8\u2260\xc6\xd8\u221e\xb1\u2264\u2265\xa5\xb5\u2202\u2211\u220f\u03c0\u222b\xaa\xba\u03a9\xe6\xf8\xbf\xa1\xac\u221a\u0192\u2248\u2206\xab\xbb\u2026\xa0\xc0\xc3\xd5\u0152\u0153\u2013\u2014\u201c\u201d\u2018\u2019\xf7\u25ca\xff\u0178\u011e\u011f\u0130\u0131\u015e\u015f\u2021\xb7\u201a\u201e\u2030\xc2\xca\xc1\xcb\xc8\xcd\xce\xcf\xcc\xd3\xd4\uf8ff\xd2\xda\xdb\xd9\uf8a0\u02c6\u02dc\xaf\u02d8\u02d9\u02da\xb8\u02dd\u02db\u02c7"};be.MACSTRING=function(T,B,q,ee){var F=fe[ee];if(void 0!==F){for(var Be="",K=0;q>K;K++){var ve=T.getUint8(B+K);Be+=127>=ve?String.fromCharCode(ve):F[127&ve]}return Be}};var _e,le="function"==typeof WeakMap&&new WeakMap;te.MACSTRING=function(T,B){var q=function(K){if(!_e)for(var ve in _e={},fe)_e[ve]=new String(ve);var Ae=_e[K];if(void 0!==Ae){if(le){var Fe=le.get(Ae);if(void 0!==Fe)return Fe}var Ee=fe[K];if(void 0!==Ee){for(var qe={},Ke=0;Ke<Ee.length;Ke++)qe[Ee.charCodeAt(Ke)]=Ke+128;return le&&le.set(Ae,qe),qe}}}(B);if(void 0!==q){for(var ee=[],F=0;F<T.length;F++){var Be=T.charCodeAt(F);if(Be>=128&&void 0===(Be=q[Be]))return;ee[F]=Be}return ee}},ce.MACSTRING=function(T,B){var q=te.MACSTRING(T,B);return void 0!==q?q.length:0},te.INDEX=function(T){var B,q=1,ee=[q],F=[];for(B=0;B<T.length;B+=1){var Be=te.OBJECT(T[B]);Array.prototype.push.apply(F,Be),ee.push(q+=Be.length)}if(0===F.length)return[0,0];var K=[],ve=1+Math.floor(Math.log(q)/Math.log(2))/8|0,Ae=[void 0,te.BYTE,te.USHORT,te.UINT24,te.ULONG][ve];for(B=0;B<ee.length;B+=1){var Fe=Ae(ee[B]);Array.prototype.push.apply(K,Fe)}return Array.prototype.concat(te.Card16(T.length),te.OffSize(ve),K,F)},ce.INDEX=function(T){return te.INDEX(T).length},te.DICT=function(T){for(var B=[],q=Object.keys(T),ee=q.length,F=0;ee>F;F+=1){var Be=parseInt(q[F],0),K=T[Be];B=(B=B.concat(te.OPERAND(K.value,K.type))).concat(te.OPERATOR(Be))}return B},ce.DICT=function(T){return te.DICT(T).length},te.OPERATOR=function(T){return 1200>T?[T]:[12,T-1200]},te.OPERAND=function(T,B){var q=[];if(Array.isArray(B))for(var ee=0;ee<B.length;ee+=1)P.argument(T.length===B.length,"Not enough arguments given for type"+B),q=q.concat(te.OPERAND(T[ee],B[ee]));else if("SID"===B)q=q.concat(te.NUMBER(T));else if("offset"===B)q=q.concat(te.NUMBER32(T));else if("number"===B)q=q.concat(te.NUMBER(T));else{if("real"!==B)throw new Error("Unknown operand type "+B);q=q.concat(te.REAL(T))}return q},te.OP=te.BYTE,ce.OP=ce.BYTE;var pe="function"==typeof WeakMap&&new WeakMap;te.CHARSTRING=function(T){if(pe){var B=pe.get(T);if(void 0!==B)return B}for(var q=[],ee=T.length,F=0;ee>F;F+=1){var Be=T[F];q=q.concat(te[Be.type](Be.value))}return pe&&pe.set(T,q),q},ce.CHARSTRING=function(T){return te.CHARSTRING(T).length},te.OBJECT=function(T){var B=te[T.type];return P.argument(void 0!==B,"No encoding function for type "+T.type),B(T.value)},ce.OBJECT=function(T){var B=ce[T.type];return P.argument(void 0!==B,"No sizeOf function for type "+T.type),B(T.value)},te.TABLE=function(T){var B,q=[],ee=T.fields.length,F=[],Be=[];for(B=0;ee>B;B+=1){var K=T.fields[B],ve=te[K.type];P.argument(void 0!==ve,"No encoding function for field type "+K.type+" ("+K.name+")");var Ae=T[K.name];void 0===Ae&&(Ae=K.value);var Fe=ve(Ae);"TABLE"===K.type?(Be.push(q.length),q=q.concat([0,0]),F.push(Fe)):q=q.concat(Fe)}for(B=0;B<F.length;B+=1){var Ee=Be[B],qe=q.length;P.argument(65536>qe,"Table "+T.tableName+" too big."),q[Ee]=qe>>8,q[Ee+1]=255&qe,q=q.concat(F[B])}return q},ce.TABLE=function(T){for(var B=0,q=T.fields.length,ee=0;q>ee;ee+=1){var F=T.fields[ee],Be=ce[F.type];P.argument(void 0!==Be,"No sizeOf function for field type "+F.type+" ("+F.name+")");var K=T[F.name];void 0===K&&(K=F.value),B+=Be(K),"TABLE"===F.type&&(B+=2)}return B},te.RECORD=te.TABLE,ce.RECORD=ce.TABLE,te.LITERAL=function(T){return T},ce.LITERAL=function(T){return T.length},G.decode=be,G.encode=te,G.sizeOf=ce},{"./check":2}],33:[function(N,U,G){G.isBrowser=function(){return typeof window<"u"},G.isNode=function(){return typeof window>"u"},G.nodeBufferToArrayBuffer=function(A){for(var P=new ArrayBuffer(A.length),de=new Uint8Array(P),be=0;be<A.length;++be)de[be]=A[be];return P},G.arrayBufferToNodeBuffer=function(A){for(var P=new Buffer(A.byteLength),de=new Uint8Array(A),be=0;be<P.length;++be)P[be]=de[be];return P},G.checkArgument=function(A,P){if(!A)throw P}},{}]},{},[9])(9)});var x=window.opentype},408:n=>{var o=/\n/,l=/\s/;function x(G,A,P,de){var be=G.indexOf(A,P);return-1===be||be>de?de:be}function N(G){return l.test(G)}function U(G,A,P,de){return{start:A,end:A+Math.min(de,P-A)}}n.exports=function(G,A){return n.exports.lines(G,A).map(function(P){return G.substring(P.start,P.end)}).join("\n")},n.exports.lines=function(G,A){if(0===(A=A||{}).width&&"nowrap"!==A.mode)return[];G=G||"";var P="number"==typeof A.width?A.width:Number.MAX_VALUE,de=Math.max(0,A.start||0),be="number"==typeof A.end?A.end:G.length,te=A.mode,ce=A.measure||U;return"pre"===te?function(fe,_e,le,pe,T){for(var B=[],q=le,ee=le;ee<pe&&ee<_e.length;ee++){var F=_e.charAt(ee),Be=o.test(F);if(Be||ee===pe-1){var K=fe(_e,q,Be?ee:ee+1,T);B.push(K),q=ee+1}}return B}(ce,G,de,be,P):function(fe,_e,le,pe,T,B){var q=[],ee=T;for("nowrap"===B&&(ee=Number.MAX_VALUE);le<pe&&le<_e.length;){for(var F=x(_e,"\n",le,pe);le<F&&N(_e.charAt(le));)le++;var Be=fe(_e,le,F,ee),K=le+(Be.end-Be.start),ve=K+1;if(K<F){for(;K>le&&!N(_e.charAt(K));)K--;if(K===le)ve>le+1&&ve--,K=ve;else for(ve=K;K>le&&N(_e.charAt(K-1));)K--}if(K>=le){var Ae=fe(_e,le,K,ee);q.push(Ae)}le=ve}return q}(ce,G,de,be,P,te)}},720:n=>{n.exports=function(){for(var l={},x=0;x<arguments.length;x++){var N=arguments[x];for(var U in N)o.call(N,U)&&(l[U]=N[U])}return l};var o=Object.prototype.hasOwnProperty},500:(n,o,l)=>{var x=l(412);x.KeyframeTrack.prototype.color="#FF0000",x.KeyframeTrack.prototype.setColor=function(N){this.color=N},x.KeyframeTrack.prototype.sort=function(){for(var N=0;N<this.times.length;N++)for(var U=N+1;U<this.times.length;U++)if(this.times[N]>this.times[U]){var G=this.times[U];this.times[U]=this.times[N],this.times[N]=G;for(var A=this.getValueSize(),P=U*A,de=N*A,be=0;be<A;be++)G=this.values[P+be],this.values[P+be]=this.values[de+be],this.values[de+be]=G}},x.KeyframeTrack._toJSON=x.KeyframeTrack.toJSON,x.KeyframeTrack.toJSON=function(N){var U=x.KeyframeTrack._toJSON.call(this,N);return U.color=N.color,U},x.KeyframeTrack._parse=x.KeyframeTrack.parse,x.KeyframeTrack.parse=function(N){var U=x.KeyframeTrack._parse.call(this,N);return void 0!==N.color&&(U.color=N.color),U}},10:(n,o,l)=>{l(412).Camera.prototype.render=function(x,N){x.render(N,this)}},939:(n,o,l)=>{l(412).BufferAttribute.prototype.toJSON=function(){return{type:"BufferAttribute",typedArray:{type:this.array.constructor.name,array:Array.prototype.slice.call(this.array)},itemSize:this.itemSize,normalized:this.normalized}}},12:(n,o,l)=>{l(412).InterleavedBuffer.prototype.toJSON=function(){return{typedArray:{type:this.array.constructor.name,array:Array.prototype.slice.call(this.array)},stride:this.stride,count:this.count,usage:this.usage}}},443:(n,o,l)=>{l(412).InterleavedBufferAttribute.prototype.toJSON=function(){return{type:"InterleavedBufferAttribute",data:this.data.toJSON(),itemSize:this.itemSize,offset:this.offset,normalized:this.normalized}}},870:(n,o,l)=>{var x=l(412);x.LightShadow.prototype.toJSON=function(){var N={};return N.bias=this.bias,N.radius=this.radius,N.mapSize={x:this.mapSize.x,y:this.mapSize.y},N.camera={top:this.camera.top,bottom:this.camera.bottom,far:this.camera.far,near:this.camera.near,left:this.camera.left,right:this.camera.right},N},x.LightShadow.prototype.fromJSON=function(N){if(void 0!==N.bias&&(this.bias=N.bias),void 0!==N.radius&&(this.radius=N.radius),void 0!==N.mapSize){var U=N.mapSize;this.mapSize.set(U.x,U.y)}if(void 0!==N.camera){var G=N.camera;this.camera.top=G.top,this.camera.bottom=G.bottom,this.camera.left=G.left,this.camera.right=G.right,this.camera.near=G.near,this.camera.far=G.far}}},819:(n,o,l)=>{var x=l(412);x.Fog.NONE=0,x.Fog.LINEAR=1,x.Fog.EXPONENTIAL=2}},__webpack_module_cache__={};function __webpack_require__(n){var o=__webpack_module_cache__[n];if(void 0!==o)return o.exports;var l=__webpack_module_cache__[n]={id:n,loaded:!1,exports:{}};return __webpack_modules__[n].call(l.exports,l,l.exports,__webpack_require__),l.loaded=!0,l.exports}__webpack_require__.amdO={},__webpack_require__.n=n=>{var o=n&&n.__esModule?()=>n.default:()=>n;return __webpack_require__.d(o,{a:o}),o},__webpack_require__.d=(n,o)=>{for(var l in o)__webpack_require__.o(o,l)&&!__webpack_require__.o(n,l)&&Object.defineProperty(n,l,{enumerable:!0,get:o[l]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch{if("object"==typeof window)return window}}(),__webpack_require__.hmd=n=>((n=Object.create(n)).children||(n.children=[]),Object.defineProperty(n,"exports",{enumerable:!0,set:()=>{throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+n.id)}}),n),__webpack_require__.o=(n,o)=>Object.prototype.hasOwnProperty.call(n,o),__webpack_require__.r=n=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})};var __webpack_exports__={};return(()=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{ARHandler:()=>Lo,AdaptiveToneMappingPass:()=>Wc,AfterimagePass:()=>li,AmbientLight:()=>$s,AnimationMixer:()=>iu,AnimationTimer:()=>Iu,App:()=>cs,ArraybufferUtils:()=>aa,Audio:()=>Dn,AudioEmitter:()=>ni,AudioLoader:()=>uh,Base64Utils:()=>ai,BloomPass:()=>Dr,BokehPass:()=>Ua,BufferUtils:()=>Fa,CSS3DObject:()=>sl,CSS3DRenderer:()=>Lc,CSS3DSprite:()=>Lu,CanvasSprite:()=>Sc,CanvasTexture:()=>ll,CapsuleBufferGeometry:()=>ch,ColorifyPass:()=>Lp,CompressedTexture:()=>ec,CopyPass:()=>Vc,CubeCamera:()=>br,CubeTexture:()=>Tr,DataTexture:()=>tu,DirectionalLight:()=>rl,DotScreenPass:()=>xc,EffectComposer:()=>Mo,EventManager:()=>dn,FXAAPass:()=>ed,FileSystem:()=>Bn,FilmPass:()=>ol,FirstPersonControls:()=>qc,Font:()=>An,FontLoader:()=>Rh,Gamepad:()=>Hr,GeometryLoader:()=>eu,Group:()=>Eu,Gyroscope:()=>pa,HTMLView:()=>Xl,HemisphereLight:()=>Tu,HueSaturationPass:()=>Io,Image:()=>gs,ImageLoader:()=>Ql,InstancedMesh:()=>ls,Key:()=>oi,Keyboard:()=>Xn,LegacyGeometryLoader:()=>Kc,LensFlare:()=>Ea,LightProbe:()=>Xc,LocalStorage:()=>Ol,MaterialLoader:()=>lh,MathUtils:()=>Gc,Mesh:()=>rh,Model:()=>Wn,Mouse:()=>Yr,NodeScript:()=>ma,Nunu:()=>ho,ObjectLoader:()=>Ao,ObjectUtils:()=>fl,OrbitControls:()=>je,OrthographicCamera:()=>xe,ParametricBufferGeometry:()=>Ma,ParticleEmitter:()=>$o,ParticleEmitterControl:()=>Ri,ParticleGroup:()=>Oo,ParticleShaders:()=>Ph,Pass:()=>fr,PerspectiveCamera:()=>Ue,PhysicsGenerator:()=>Hn,PhysicsObject:()=>Xe,PointLight:()=>yt,PositionalAudio:()=>cr,Program:()=>Qr,RectAreaLight:()=>Pr,RenderPass:()=>il,RendererConfiguration:()=>Fo,RendererState:()=>np,Resource:()=>vi,ResourceContainer:()=>N,ResourceManager:()=>ko,RoundedBoxBufferGeometry:()=>Ac,SSAONOHPass:()=>Mi,SSAOPass:()=>Po,SSAOShader:()=>Ls,Scene:()=>bs,Script:()=>Gn,ShaderAttribute:()=>Yo,ShaderPass:()=>qo,ShaderUtils:()=>Ut,SkinnedMesh:()=>Zi,Sky:()=>ns,SobelPass:()=>Ns,SpineAnimation:()=>Wi,SpineTexture:()=>ah,SpotLight:()=>Mc,Sprite:()=>ca,SpriteSheetTexture:()=>Fs,TargetConfig:()=>tf,TechnicolorPass:()=>Hc,TerrainBufferGeometry:()=>Kl,TextBitmap:()=>wo,TextFile:()=>Zl,TextMesh:()=>Ha,TextSprite:()=>ys,Texture:()=>vs,TextureLoader:()=>Va,Timer:()=>Ld,TizenKeyboard:()=>Cr,TwistModifier:()=>Bu,TypedArrayHelper:()=>ji,UnitConverter:()=>rs,UnrealBloomPass:()=>Cs,VRHandler:()=>mi,Video:()=>Aa,VideoLoader:()=>Pl,VideoStream:()=>kh,VideoTexture:()=>ks,Viewport:()=>De,WebcamTexture:()=>ua,WorkerPool:()=>Il,WorkerTask:()=>tc});var n={};__webpack_require__.r(n),__webpack_require__.d(n,{AABB:()=>te,ArrayCollisionMatrix:()=>_e,BODY_SLEEP_STATES:()=>gt,BODY_TYPES:()=>Ke,Body:()=>at,Box:()=>Fe,Broadphase:()=>or,COLLISION_TYPES:()=>Vi,ConeTwistConstraint:()=>zu,Constraint:()=>pu,ContactEquation:()=>To,ContactMaterial:()=>Gu,ConvexPolyhedron:()=>K,Cylinder:()=>Xt,DistanceConstraint:()=>fs,Equation:()=>Es,EventTarget:()=>le,FrictionEquation:()=>oc,GSSolver:()=>vu,GridBroadphase:()=>ci,Heightfield:()=>xn,HingeConstraint:()=>_p,JacobianElement:()=>du,LockConstraint:()=>Dl,Mat3:()=>G,Material:()=>Hu,NaiveBroadphase:()=>vr,Narrowphase:()=>kr,ObjectCollisionMatrix:()=>U,Particle:()=>fn,Plane:()=>In,PointToPointConstraint:()=>ic,Pool:()=>yu,Quaternion:()=>pe,RAY_MODES:()=>go,Ray:()=>Nr,RaycastResult:()=>pi,RaycastVehicle:()=>Wh,RigidVehicle:()=>Ju,RotationalEquation:()=>vl,RotationalMotorEquation:()=>ju,SAPBroadphase:()=>ds,SHAPE_TYPES:()=>q,SPHSystem:()=>ue,Shape:()=>ee,Solver:()=>yo,Sphere:()=>cc,SplitSolver:()=>Ts,Spring:()=>Za,Transform:()=>F,Trimesh:()=>el,Vec3:()=>A,Vec3Pool:()=>Mp,World:()=>Fn});var o={};__webpack_require__.r(o),__webpack_require__.d(o,{ARHandler:()=>Lo,AdaptiveToneMappingPass:()=>Wc,AfterimagePass:()=>li,AmbientLight:()=>$s,AnimationMixer:()=>iu,AnimationTimer:()=>Iu,App:()=>cs,ArraybufferUtils:()=>aa,Audio:()=>Dn,AudioEmitter:()=>ni,AudioLoader:()=>uh,Base64Utils:()=>ai,BloomPass:()=>Dr,BokehPass:()=>Ua,BufferUtils:()=>Fa,CSS3DObject:()=>sl,CSS3DRenderer:()=>Lc,CSS3DSprite:()=>Lu,CanvasSprite:()=>Sc,CanvasTexture:()=>ll,CapsuleBufferGeometry:()=>ch,ColorifyPass:()=>Lp,CompressedTexture:()=>ec,CopyPass:()=>Vc,CubeCamera:()=>br,CubeTexture:()=>Tr,DataTexture:()=>tu,DirectionalLight:()=>rl,DotScreenPass:()=>xc,EffectComposer:()=>Mo,EventManager:()=>dn,FXAAPass:()=>ed,FileSystem:()=>Bn,FilmPass:()=>ol,FirstPersonControls:()=>qc,Font:()=>An,FontLoader:()=>Rh,Gamepad:()=>Hr,GeometryLoader:()=>eu,Group:()=>Eu,Gyroscope:()=>pa,HTMLView:()=>Xl,HemisphereLight:()=>Tu,HueSaturationPass:()=>Io,Image:()=>gs,ImageLoader:()=>Ql,InstancedMesh:()=>ls,Key:()=>oi,Keyboard:()=>Xn,LegacyGeometryLoader:()=>Kc,LensFlare:()=>Ea,LightProbe:()=>Xc,LocalStorage:()=>Ol,MaterialLoader:()=>lh,MathUtils:()=>Gc,Mesh:()=>rh,Model:()=>Wn,Mouse:()=>Yr,NodeScript:()=>ma,Nunu:()=>ho,ObjectLoader:()=>Ao,ObjectUtils:()=>fl,OrbitControls:()=>je,OrthographicCamera:()=>xe,ParametricBufferGeometry:()=>Ma,ParticleEmitter:()=>$o,ParticleEmitterControl:()=>Ri,ParticleGroup:()=>Oo,ParticleShaders:()=>Ph,Pass:()=>fr,PerspectiveCamera:()=>Ue,PhysicsGenerator:()=>Hn,PhysicsObject:()=>Xe,PointLight:()=>yt,PositionalAudio:()=>cr,Program:()=>Qr,RectAreaLight:()=>Pr,RenderPass:()=>il,RendererConfiguration:()=>Fo,RendererState:()=>np,Resource:()=>vi,ResourceContainer:()=>N,ResourceManager:()=>ko,RoundedBoxBufferGeometry:()=>Ac,SSAONOHPass:()=>Mi,SSAOPass:()=>Po,SSAOShader:()=>Ls,Scene:()=>bs,Script:()=>Gn,ShaderAttribute:()=>Yo,ShaderPass:()=>qo,ShaderUtils:()=>Ut,SkinnedMesh:()=>Zi,Sky:()=>ns,SobelPass:()=>Ns,SpineAnimation:()=>Wi,SpineTexture:()=>ah,SpotLight:()=>Mc,Sprite:()=>ca,SpriteSheetTexture:()=>Fs,TargetConfig:()=>tf,TechnicolorPass:()=>Hc,TerrainBufferGeometry:()=>Kl,TextBitmap:()=>wo,TextFile:()=>Zl,TextMesh:()=>Ha,TextSprite:()=>ys,Texture:()=>vs,TextureLoader:()=>Va,Timer:()=>Ld,TizenKeyboard:()=>Cr,TwistModifier:()=>Bu,TypedArrayHelper:()=>ji,UnitConverter:()=>rs,UnrealBloomPass:()=>Cs,VRHandler:()=>mi,Video:()=>Aa,VideoLoader:()=>Pl,VideoStream:()=>kh,VideoTexture:()=>ks,Viewport:()=>De,WebcamTexture:()=>ua,WorkerPool:()=>Il,WorkerTask:()=>tc});var l=__webpack_require__(412),x=__webpack_require__(412);function N(){this.images=[],this.videos=[],this.audio=[],this.fonts=[],this.materials=[],this.textures=[],this.geometries=[],this.resources=[],this.shapes=[],this.skeletons=[]}x.AnimationClip.prototype.enabled=!0,x.AnimationClip.prototype.loop=l.LoopRepeat,x.AnimationClip.prototype.timeScale=1,x.AnimationClip.prototype.weight=1,x.AnimationClip._toJSON=x.AnimationClip.toJSON,x.AnimationClip.toJSON=function(a){var r=x.AnimationClip._toJSON.call(this,a);return r.enabled=a.enabled,r.loop=a.loop,r.timeScale=a.timeScale,r.weight=a.weight,r},x.AnimationClip._parse=x.AnimationClip.parse,x.AnimationClip.parse=function(a){var r=x.AnimationClip._parse.call(this,a);return void 0!==a.enabled&&(r.enabled=a.enabled,r.loop=a.loop,r.timeScale=a.timeScale,r.weight=a.weight),r},__webpack_require__(500),__webpack_require__(10),__webpack_require__(939),__webpack_require__(412).InstancedBufferAttribute.prototype.toJSON=function(){var a=l.BufferAttribute.prototype.toJSON.call(this);return a.type="InstancedBufferAttribute",a.meshPerAttribute=this.meshPerAttribute,a},__webpack_require__(12),__webpack_require__(443),N.libraries=["images","videos","audio","fonts","materials","textures","geometries","resources","shapes","skeletons"],N.prototype.copyResources=function(a){this.materials=a.materials,this.textures=a.textures,this.resources=a.resources,this.fonts=a.fonts,this.audio=a.audio,this.geometries=a.geometries,this.images=a.images,this.videos=a.videos,this.shapes=a.shapes,this.skeletons=a.skeletons},N.prototype.getTexture=function(a){return void 0===this.textures[a]&&console.warn("nunuStudio: ResourceContainer, Undefined texture",a),this.textures[a]},N.prototype.getGeometry=function(a){return void 0===this.geometries[a]&&console.warn("nunuStudio: ResourceContainer, Undefined geometry",a),this.geometries[a]},N.prototype.getMaterial=function(a){if(a instanceof Array){for(var r=[],h=0;h<a.length;h++)void 0===this.materials[a[h]]&&console.warn("nunuStudio: ResourceContainer, Undefined material",a),r.push(this.materials[a[h]]);return r}return void 0===this.materials[a]&&console.warn("nunuStudio: ResourceContainer, Undefined material",a),this.materials[a]},N.prototype.getFont=function(a){return void 0===this.fonts[a]&&console.warn("nunuStudio: ResourceContainer, Undefined font",a),this.fonts[a]},N.prototype.getAudio=function(a){return void 0===this.audio[a]&&console.warn("nunuStudio: ResourceContainer, Undefined audio",a),this.audio[a]};class U{constructor(){this.matrix={}}get(r,h){let{id:d}=r,{id:y}=h;if(y>d){const b=y;y=d,d=b}return d+"-"+y in this.matrix}set(r,h,d){let{id:y}=r,{id:b}=h;if(b>y){const R=b;b=y,y=R}d?this.matrix[y+"-"+b]=!0:delete this.matrix[y+"-"+b]}reset(){this.matrix={}}setNumObjects(r){}}class G{constructor(r=[0,0,0,0,0,0,0,0,0]){this.elements=r}identity(){const r=this.elements;r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=1,r[5]=0,r[6]=0,r[7]=0,r[8]=1}setZero(){const r=this.elements;r[0]=0,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=0,r[6]=0,r[7]=0,r[8]=0}setTrace(r){const h=this.elements;h[0]=r.x,h[4]=r.y,h[8]=r.z}getTrace(r=new A){const h=this.elements;r.x=h[0],r.y=h[4],r.z=h[8]}vmult(r,h=new A){const d=this.elements,y=r.x,b=r.y,R=r.z;return h.x=d[0]*y+d[1]*b+d[2]*R,h.y=d[3]*y+d[4]*b+d[5]*R,h.z=d[6]*y+d[7]*b+d[8]*R,h}smult(r){for(let h=0;h<this.elements.length;h++)this.elements[h]*=r}mmult(r,h=new G){const{elements:d}=r;for(let y=0;y<3;y++)for(let b=0;b<3;b++){let R=0;for(let k=0;k<3;k++)R+=d[y+3*k]*this.elements[k+3*b];h.elements[y+3*b]=R}return h}scale(r,h=new G){const d=this.elements,y=h.elements;for(let b=0;3!==b;b++)y[3*b+0]=r.x*d[3*b+0],y[3*b+1]=r.y*d[3*b+1],y[3*b+2]=r.z*d[3*b+2];return h}solve(r,h=new A){const d=[];let y,b;for(y=0;y<12;y++)d.push(0);for(y=0;y<3;y++)for(b=0;b<3;b++)d[y+4*b]=this.elements[y+3*b];d[3]=r.x,d[7]=r.y,d[11]=r.z;let R=3;const k=R;let M,H;do{if(y=k-R,0===d[y+4*y])for(b=y+1;b<k;b++)if(0!==d[y+4*b]){M=4;do{H=4-M,d[H+4*y]+=d[H+4*b]}while(--M);break}if(0!==d[y+4*y])for(b=y+1;b<k;b++){const X=d[y+4*b]/d[y+4*y];M=4;do{H=4-M,d[H+4*b]=H<=y?0:d[H+4*b]-d[H+4*y]*X}while(--M)}}while(--R);if(h.z=d[11]/d[10],h.y=(d[7]-d[6]*h.z)/d[5],h.x=(d[3]-d[2]*h.z-d[1]*h.y)/d[0],isNaN(h.x)||isNaN(h.y)||isNaN(h.z)||h.x===1/0||h.y===1/0||h.z===1/0)throw"Could not solve equation! Got x=["+h.toString()+"], b=["+r.toString()+"], A=["+this.toString()+"]";return h}e(r,h,d){if(void 0===d)return this.elements[h+3*r];this.elements[h+3*r]=d}copy(r){for(let h=0;h<r.elements.length;h++)this.elements[h]=r.elements[h];return this}toString(){let r="";for(let h=0;h<9;h++)r+=this.elements[h]+",";return r}reverse(r=new G){const h=[];let d,y;for(d=0;d<18;d++)h.push(0);for(d=0;d<3;d++)for(y=0;y<3;y++)h[d+6*y]=this.elements[d+3*y];h[3]=1,h[9]=0,h[15]=0,h[4]=0,h[10]=1,h[16]=0,h[5]=0,h[11]=0,h[17]=1;let b=3;const R=b;let k,M;do{if(d=R-b,0===h[d+6*d])for(y=d+1;y<R;y++)if(0!==h[d+6*y]){k=6;do{M=6-k,h[M+6*d]+=h[M+6*y]}while(--k);break}if(0!==h[d+6*d])for(y=d+1;y<R;y++){const H=h[d+6*y]/h[d+6*d];k=6;do{M=6-k,h[M+6*y]=M<=d?0:h[M+6*y]-h[M+6*d]*H}while(--k)}}while(--b);d=2;do{y=d-1;do{const H=h[d+6*y]/h[d+6*d];k=6;do{M=6-k,h[M+6*y]=h[M+6*y]-h[M+6*d]*H}while(--k)}while(y--)}while(--d);d=2;do{const H=1/h[d+6*d];k=6;do{M=6-k,h[M+6*d]=h[M+6*d]*H}while(--k)}while(d--);d=2;do{y=2;do{if(M=h[3+y+6*d],isNaN(M)||M===1/0)throw"Could not reverse! A=["+this.toString()+"]";r.e(d,y,M)}while(y--)}while(d--);return r}setRotationFromQuaternion(r){const h=r.x,d=r.y,y=r.z,b=r.w,R=h+h,k=d+d,M=y+y,H=h*R,X=h*k,oe=h*M,ne=d*k,ge=d*M,we=y*M,Se=b*R,Ce=b*k,Pe=b*M,Re=this.elements;return Re[0]=1-(ne+we),Re[1]=X-Pe,Re[2]=oe+Ce,Re[3]=X+Pe,Re[4]=1-(H+we),Re[5]=ge-Se,Re[6]=oe-Ce,Re[7]=ge+Se,Re[8]=1-(H+ne),this}transpose(r=new G){const h=r.elements,d=this.elements;for(let y=0;3!==y;y++)for(let b=0;3!==b;b++)h[3*y+b]=d[3*b+y];return r}}class A{constructor(r=0,h=0,d=0){this.x=r,this.y=h,this.z=d}cross(r,h=new A){const d=r.x,y=r.y,b=r.z,R=this.x,k=this.y,M=this.z;return h.x=k*b-M*y,h.y=M*d-R*b,h.z=R*y-k*d,h}set(r,h,d){return this.x=r,this.y=h,this.z=d,this}setZero(){this.x=this.y=this.z=0}vadd(r,h){if(!h)return new A(this.x+r.x,this.y+r.y,this.z+r.z);h.x=r.x+this.x,h.y=r.y+this.y,h.z=r.z+this.z}vsub(r,h){if(!h)return new A(this.x-r.x,this.y-r.y,this.z-r.z);h.x=this.x-r.x,h.y=this.y-r.y,h.z=this.z-r.z}crossmat(){return new G([0,-this.z,this.y,this.z,0,-this.x,-this.y,this.x,0])}normalize(){const r=this.x,h=this.y,d=this.z,y=Math.sqrt(r*r+h*h+d*d);if(y>0){const b=1/y;this.x*=b,this.y*=b,this.z*=b}else this.x=0,this.y=0,this.z=0;return y}unit(r=new A){const h=this.x,d=this.y,y=this.z;let b=Math.sqrt(h*h+d*d+y*y);return b>0?(b=1/b,r.x=h*b,r.y=d*b,r.z=y*b):(r.x=1,r.y=0,r.z=0),r}length(){const r=this.x,h=this.y,d=this.z;return Math.sqrt(r*r+h*h+d*d)}lengthSquared(){return this.dot(this)}distanceTo(r){const h=this.x,d=this.y,y=this.z,b=r.x,R=r.y,k=r.z;return Math.sqrt((b-h)*(b-h)+(R-d)*(R-d)+(k-y)*(k-y))}distanceSquared(r){const h=this.x,d=this.y,y=this.z,b=r.x,R=r.y,k=r.z;return(b-h)*(b-h)+(R-d)*(R-d)+(k-y)*(k-y)}scale(r,h=new A){const y=this.y,b=this.z;return h.x=r*this.x,h.y=r*y,h.z=r*b,h}vmul(r,h=new A){return h.x=r.x*this.x,h.y=r.y*this.y,h.z=r.z*this.z,h}addScaledVector(r,h,d=new A){return d.x=this.x+r*h.x,d.y=this.y+r*h.y,d.z=this.z+r*h.z,d}dot(r){return this.x*r.x+this.y*r.y+this.z*r.z}isZero(){return 0===this.x&&0===this.y&&0===this.z}negate(r=new A){return r.x=-this.x,r.y=-this.y,r.z=-this.z,r}tangents(r,h){const d=this.length();if(d>0){const y=P,b=1/d;y.set(this.x*b,this.y*b,this.z*b);const R=de;Math.abs(y.x)<.9?(R.set(1,0,0),y.cross(R,r)):(R.set(0,1,0),y.cross(R,r)),y.cross(r,h)}else r.set(1,0,0),h.set(0,1,0)}toString(){return this.x+","+this.y+","+this.z}toArray(){return[this.x,this.y,this.z]}copy(r){return this.x=r.x,this.y=r.y,this.z=r.z,this}lerp(r,h,d){const y=this.x,b=this.y,R=this.z;d.x=y+(r.x-y)*h,d.y=b+(r.y-b)*h,d.z=R+(r.z-R)*h}almostEquals(r,h=1e-6){return!(Math.abs(this.x-r.x)>h||Math.abs(this.y-r.y)>h||Math.abs(this.z-r.z)>h)}almostZero(r=1e-6){return!(Math.abs(this.x)>r||Math.abs(this.y)>r||Math.abs(this.z)>r)}isAntiparallelTo(r,h){return this.negate(be),be.almostEquals(r,h)}clone(){return new A(this.x,this.y,this.z)}}A.ZERO=new A(0,0,0),A.UNIT_X=new A(1,0,0),A.UNIT_Y=new A(0,1,0),A.UNIT_Z=new A(0,0,1);const P=new A,de=new A,be=new A;class te{constructor(r={}){this.lowerBound=new A,this.upperBound=new A,r.lowerBound&&this.lowerBound.copy(r.lowerBound),r.upperBound&&this.upperBound.copy(r.upperBound)}setFromPoints(r,h,d,y){const b=this.lowerBound,R=this.upperBound,k=d;b.copy(r[0]),k&&k.vmult(b,b),R.copy(b);for(let M=1;M<r.length;M++){let H=r[M];k&&(k.vmult(H,ce),H=ce),H.x>R.x&&(R.x=H.x),H.x<b.x&&(b.x=H.x),H.y>R.y&&(R.y=H.y),H.y<b.y&&(b.y=H.y),H.z>R.z&&(R.z=H.z),H.z<b.z&&(b.z=H.z)}return h&&(h.vadd(b,b),h.vadd(R,R)),y&&(b.x-=y,b.y-=y,b.z-=y,R.x+=y,R.y+=y,R.z+=y),this}copy(r){return this.lowerBound.copy(r.lowerBound),this.upperBound.copy(r.upperBound),this}clone(){return(new te).copy(this)}extend(r){this.lowerBound.x=Math.min(this.lowerBound.x,r.lowerBound.x),this.upperBound.x=Math.max(this.upperBound.x,r.upperBound.x),this.lowerBound.y=Math.min(this.lowerBound.y,r.lowerBound.y),this.upperBound.y=Math.max(this.upperBound.y,r.upperBound.y),this.lowerBound.z=Math.min(this.lowerBound.z,r.lowerBound.z),this.upperBound.z=Math.max(this.upperBound.z,r.upperBound.z)}overlaps(r){const h=this.lowerBound,d=this.upperBound,y=r.lowerBound,b=r.upperBound;return(y.x<=d.x&&d.x<=b.x||h.x<=b.x&&b.x<=d.x)&&(y.y<=d.y&&d.y<=b.y||h.y<=b.y&&b.y<=d.y)&&(y.z<=d.z&&d.z<=b.z||h.z<=b.z&&b.z<=d.z)}volume(){const r=this.lowerBound,h=this.upperBound;return(h.x-r.x)*(h.y-r.y)*(h.z-r.z)}contains(r){const h=this.lowerBound,d=this.upperBound,y=r.lowerBound,b=r.upperBound;return h.x<=y.x&&d.x>=b.x&&h.y<=y.y&&d.y>=b.y&&h.z<=y.z&&d.z>=b.z}getCorners(r,h,d,y,b,R,k,M){const H=this.lowerBound,X=this.upperBound;r.copy(H),h.set(X.x,H.y,H.z),d.set(X.x,X.y,H.z),y.set(H.x,X.y,X.z),b.set(X.x,H.y,X.z),R.set(H.x,X.y,H.z),k.set(H.x,H.y,X.z),M.copy(X)}toLocalFrame(r,h){const d=fe;this.getCorners(d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7]);for(let ne=0;8!==ne;ne++){const ge=d[ne];r.pointToLocal(ge,ge)}return h.setFromPoints(d)}toWorldFrame(r,h){const d=fe;this.getCorners(d[0],d[1],d[2],d[3],d[4],d[5],d[6],d[7]);for(let ne=0;8!==ne;ne++){const ge=d[ne];r.pointToWorld(ge,ge)}return h.setFromPoints(d)}overlapsRay(r){const{direction:h,from:d}=r,y=1/h.x,b=1/h.y,R=1/h.z,k=(this.lowerBound.x-d.x)*y,M=(this.upperBound.x-d.x)*y,H=(this.lowerBound.y-d.y)*b,X=(this.upperBound.y-d.y)*b,oe=(this.lowerBound.z-d.z)*R,ne=(this.upperBound.z-d.z)*R,ge=Math.max(Math.max(Math.min(k,M),Math.min(H,X)),Math.min(oe,ne)),we=Math.min(Math.min(Math.max(k,M),Math.max(H,X)),Math.max(oe,ne));return!(we<0||ge>we)}}const ce=new A,fe=[new A,new A,new A,new A,new A,new A,new A,new A];class _e{constructor(){this.matrix=[]}get(r,h){let{index:d}=r,{index:y}=h;if(y>d){const b=y;y=d,d=b}return this.matrix[(d*(d+1)>>1)+y-1]}set(r,h,d){let{index:y}=r,{index:b}=h;if(b>y){const R=b;b=y,y=R}this.matrix[(y*(y+1)>>1)+b-1]=d?1:0}reset(){for(let r=0,h=this.matrix.length;r!==h;r++)this.matrix[r]=0}setNumObjects(r){this.matrix.length=r*(r-1)>>1}}class le{constructor(){}addEventListener(r,h){void 0===this._listeners&&(this._listeners={});const d=this._listeners;return void 0===d[r]&&(d[r]=[]),d[r].includes(h)||d[r].push(h),this}hasEventListener(r,h){if(void 0===this._listeners)return!1;const d=this._listeners;return!(void 0===d[r]||!d[r].includes(h))}hasAnyEventListener(r){return void 0!==this._listeners&&void 0!==this._listeners[r]}removeEventListener(r,h){if(void 0===this._listeners)return this;const d=this._listeners;if(void 0===d[r])return this;const y=d[r].indexOf(h);return-1!==y&&d[r].splice(y,1),this}dispatchEvent(r){if(void 0===this._listeners)return this;const h=this._listeners[r.type];if(void 0!==h){r.target=this;for(let d=0,y=h.length;d<y;d++)h[d].call(this,r)}return this}}class pe{constructor(r=0,h=0,d=0,y=1){this.x=r,this.y=h,this.z=d,this.w=y}set(r,h,d,y){return this.x=r,this.y=h,this.z=d,this.w=y,this}toString(){return this.x+","+this.y+","+this.z+","+this.w}toArray(){return[this.x,this.y,this.z,this.w]}setFromAxisAngle(r,h){const d=Math.sin(.5*h);return this.x=r.x*d,this.y=r.y*d,this.z=r.z*d,this.w=Math.cos(.5*h),this}toAxisAngle(r=new A){this.normalize();const h=2*Math.acos(this.w),d=Math.sqrt(1-this.w*this.w);return d<.001?(r.x=this.x,r.y=this.y,r.z=this.z):(r.x=this.x/d,r.y=this.y/d,r.z=this.z/d),[r,h]}setFromVectors(r,h){if(r.isAntiparallelTo(h)){const d=T;r.tangents(d,B),this.setFromAxisAngle(d,Math.PI)}else{const d=r.cross(h);this.x=d.x,this.y=d.y,this.z=d.z,this.w=Math.sqrt(r.length()**2*h.length()**2)+r.dot(h),this.normalize()}return this}mult(r,h=new pe){const d=this.x,y=this.y,b=this.z,R=this.w,k=r.x,M=r.y,H=r.z,X=r.w;return h.x=d*X+R*k+y*H-b*M,h.y=y*X+R*M+b*k-d*H,h.z=b*X+R*H+d*M-y*k,h.w=R*X-d*k-y*M-b*H,h}inverse(r=new pe){const h=this.x,d=this.y,y=this.z,b=this.w;this.conjugate(r);const R=1/(h*h+d*d+y*y+b*b);return r.x*=R,r.y*=R,r.z*=R,r.w*=R,r}conjugate(r=new pe){return r.x=-this.x,r.y=-this.y,r.z=-this.z,r.w=this.w,r}normalize(){let r=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===r?(this.x=0,this.y=0,this.z=0,this.w=0):(r=1/r,this.x*=r,this.y*=r,this.z*=r,this.w*=r),this}normalizeFast(){const r=(3-(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w))/2;return 0===r?(this.x=0,this.y=0,this.z=0,this.w=0):(this.x*=r,this.y*=r,this.z*=r,this.w*=r),this}vmult(r,h=new A){const d=r.x,y=r.y,b=r.z,R=this.x,k=this.y,M=this.z,H=this.w,X=H*d+k*b-M*y,oe=H*y+M*d-R*b,ne=H*b+R*y-k*d,ge=-R*d-k*y-M*b;return h.x=X*H+ge*-R+oe*-M-ne*-k,h.y=oe*H+ge*-k+ne*-R-X*-M,h.z=ne*H+ge*-M+X*-k-oe*-R,h}copy(r){return this.x=r.x,this.y=r.y,this.z=r.z,this.w=r.w,this}toEuler(r,h="YZX"){let d,y,b;const R=this.x,k=this.y,M=this.z,H=this.w;if("YZX"!==h)throw new Error("Euler order "+h+" not supported yet.");{const X=R*k+M*H;if(X>.499&&(d=2*Math.atan2(R,H),y=Math.PI/2,b=0),X<-.499&&(d=-2*Math.atan2(R,H),y=-Math.PI/2,b=0),void 0===d){const oe=R*R,ge=M*M;d=Math.atan2(2*k*H-2*R*M,1-k*k*2-2*ge),y=Math.asin(2*X),b=Math.atan2(2*R*H-2*k*M,1-2*oe-2*ge)}}r.y=d,r.z=y,r.x=b}setFromEuler(r,h,d,y="XYZ"){const b=Math.cos(r/2),R=Math.cos(h/2),k=Math.cos(d/2),M=Math.sin(r/2),H=Math.sin(h/2),X=Math.sin(d/2);return"XYZ"===y?(this.x=M*R*k+b*H*X,this.y=b*H*k-M*R*X,this.z=b*R*X+M*H*k,this.w=b*R*k-M*H*X):"YXZ"===y?(this.x=M*R*k+b*H*X,this.y=b*H*k-M*R*X,this.z=b*R*X-M*H*k,this.w=b*R*k+M*H*X):"ZXY"===y?(this.x=M*R*k-b*H*X,this.y=b*H*k+M*R*X,this.z=b*R*X+M*H*k,this.w=b*R*k-M*H*X):"ZYX"===y?(this.x=M*R*k-b*H*X,this.y=b*H*k+M*R*X,this.z=b*R*X-M*H*k,this.w=b*R*k+M*H*X):"YZX"===y?(this.x=M*R*k+b*H*X,this.y=b*H*k+M*R*X,this.z=b*R*X-M*H*k,this.w=b*R*k-M*H*X):"XZY"===y&&(this.x=M*R*k-b*H*X,this.y=b*H*k-M*R*X,this.z=b*R*X+M*H*k,this.w=b*R*k+M*H*X),this}clone(){return new pe(this.x,this.y,this.z,this.w)}slerp(r,h,d=new pe){const y=this.x,b=this.y,R=this.z,k=this.w;let M,H,X,oe,ne,ge=r.x,we=r.y,Se=r.z,Ce=r.w;return H=y*ge+b*we+R*Se+k*Ce,H<0&&(H=-H,ge=-ge,we=-we,Se=-Se,Ce=-Ce),1-H>1e-6?(M=Math.acos(H),X=Math.sin(M),oe=Math.sin((1-h)*M)/X,ne=Math.sin(h*M)/X):(oe=1-h,ne=h),d.x=oe*y+ne*ge,d.y=oe*b+ne*we,d.z=oe*R+ne*Se,d.w=oe*k+ne*Ce,d}integrate(r,h,d,y=new pe){const b=r.x*d.x,R=r.y*d.y,k=r.z*d.z,M=this.x,H=this.y,X=this.z,oe=this.w,ne=.5*h;return y.x+=ne*(b*oe+R*X-k*H),y.y+=ne*(R*oe+k*M-b*X),y.z+=ne*(k*oe+b*H-R*M),y.w+=ne*(-b*M-R*H-k*X),y}}const T=new A,B=new A,q={SPHERE:1,PLANE:2,BOX:4,COMPOUND:8,CONVEXPOLYHEDRON:16,HEIGHTFIELD:32,PARTICLE:64,CYLINDER:128,TRIMESH:256};class ee{constructor(r={}){this.id=ee.idCounter++,this.type=r.type||0,this.boundingSphereRadius=0,this.collisionResponse=!r.collisionResponse||r.collisionResponse,this.collisionFilterGroup=void 0!==r.collisionFilterGroup?r.collisionFilterGroup:1,this.collisionFilterMask=void 0!==r.collisionFilterMask?r.collisionFilterMask:-1,this.material=r.material?r.material:null,this.body=null}updateBoundingSphereRadius(){throw"computeBoundingSphereRadius() not implemented for shape type "+this.type}volume(){throw"volume() not implemented for shape type "+this.type}calculateLocalInertia(r,h){throw"calculateLocalInertia() not implemented for shape type "+this.type}calculateWorldAABB(r,h,d,y){throw"calculateWorldAABB() not implemented for shape type "+this.type}}ee.idCounter=0,ee.types=q;class F{constructor(r={}){this.position=new A,this.quaternion=new pe,r.position&&this.position.copy(r.position),r.quaternion&&this.quaternion.copy(r.quaternion)}pointToLocal(r,h){return F.pointToLocalFrame(this.position,this.quaternion,r,h)}pointToWorld(r,h){return F.pointToWorldFrame(this.position,this.quaternion,r,h)}vectorToWorldFrame(r,h=new A){return this.quaternion.vmult(r,h),h}static pointToLocalFrame(r,h,d,y=new A){return d.vsub(r,y),h.conjugate(Be),Be.vmult(y,y),y}static pointToWorldFrame(r,h,d,y=new A){return h.vmult(d,y),y.vadd(r,y),y}static vectorToWorldFrame(r,h,d=new A){return r.vmult(h,d),d}static vectorToLocalFrame(r,h,d,y=new A){return h.w*=-1,h.vmult(d,y),h.w*=-1,y}}const Be=new pe;class K extends ee{constructor(r={}){const{vertices:h=[],faces:d=[],normals:y=[],axes:b,boundingSphereRadius:R}=r;super({type:ee.types.CONVEXPOLYHEDRON}),this.vertices=h,this.faces=d,this.faceNormals=y,0===this.faceNormals.length&&this.computeNormals(),R?this.boundingSphereRadius=R:this.updateBoundingSphereRadius(),this.worldVertices=[],this.worldVerticesNeedsUpdate=!0,this.worldFaceNormals=[],this.worldFaceNormalsNeedsUpdate=!0,this.uniqueAxes=b?b.slice():null,this.uniqueEdges=[],this.computeEdges()}computeEdges(){const r=this.faces,h=this.vertices,d=this.uniqueEdges;d.length=0;const y=new A;for(let b=0;b!==r.length;b++){const R=r[b],k=R.length;for(let M=0;M!==k;M++){h[R[M]].vsub(h[R[(M+1)%k]],y),y.normalize();let X=!1;for(let oe=0;oe!==d.length;oe++)if(d[oe].almostEquals(y)||d[oe].almostEquals(y)){X=!0;break}X||d.push(y.clone())}}}computeNormals(){this.faceNormals.length=this.faces.length;for(let r=0;r<this.faces.length;r++){for(let y=0;y<this.faces[r].length;y++)if(!this.vertices[this.faces[r][y]])throw new Error("Vertex "+this.faces[r][y]+" not found!");const h=this.faceNormals[r]||new A;if(this.getFaceNormal(r,h),h.negate(h),this.faceNormals[r]=h,h.dot(this.vertices[this.faces[r][0]])<0){console.error(".faceNormals["+r+"] = Vec3("+h.toString()+") looks like it points into the shape? The vertices follow. Make sure they are ordered CCW around the normal, using the right hand rule.");for(let y=0;y<this.faces[r].length;y++)console.warn(".vertices["+this.faces[r][y]+"] = Vec3("+this.vertices[this.faces[r][y]].toString()+")")}}}getFaceNormal(r,h){const d=this.faces[r];K.computeNormal(this.vertices[d[0]],this.vertices[d[1]],this.vertices[d[2]],h)}clipAgainstHull(r,h,d,y,b,R,k,M,H){const X=new A;let oe=-1,ne=-Number.MAX_VALUE;for(let we=0;we<d.faces.length;we++){X.copy(d.faceNormals[we]),b.vmult(X,X);const Se=X.dot(R);Se>ne&&(ne=Se,oe=we)}const ge=[];for(let we=0;we<d.faces[oe].length;we++){const Se=d.vertices[d.faces[oe][we]],Ce=new A;Ce.copy(Se),b.vmult(Ce,Ce),y.vadd(Ce,Ce),ge.push(Ce)}oe>=0&&this.clipFaceAgainstHull(R,r,h,ge,k,M,H)}findSeparatingAxis(r,h,d,y,b,R,k,M){const H=new A,X=new A,oe=new A,ne=new A,ge=new A,we=new A;let Se=Number.MAX_VALUE;const Ce=this;if(Ce.uniqueAxes)for(let Pe=0;Pe!==Ce.uniqueAxes.length;Pe++){d.vmult(Ce.uniqueAxes[Pe],H);const Re=Ce.testSepAxis(H,r,h,d,y,b);if(!1===Re)return!1;Re<Se&&(Se=Re,R.copy(H))}else{const Pe=k?k.length:Ce.faces.length;for(let Re=0;Re<Pe;Re++){H.copy(Ce.faceNormals[k?k[Re]:Re]),d.vmult(H,H);const Ge=Ce.testSepAxis(H,r,h,d,y,b);if(!1===Ge)return!1;Ge<Se&&(Se=Ge,R.copy(H))}}if(r.uniqueAxes)for(let Pe=0;Pe!==r.uniqueAxes.length;Pe++){b.vmult(r.uniqueAxes[Pe],X);const Re=Ce.testSepAxis(X,r,h,d,y,b);if(!1===Re)return!1;Re<Se&&(Se=Re,R.copy(X))}else{const Pe=M?M.length:r.faces.length;for(let Re=0;Re<Pe;Re++){X.copy(r.faceNormals[M?M[Re]:Re]),b.vmult(X,X);const Ge=Ce.testSepAxis(X,r,h,d,y,b);if(!1===Ge)return!1;Ge<Se&&(Se=Ge,R.copy(X))}}for(let Pe=0;Pe!==Ce.uniqueEdges.length;Pe++){d.vmult(Ce.uniqueEdges[Pe],ne);for(let Re=0;Re!==r.uniqueEdges.length;Re++)if(b.vmult(r.uniqueEdges[Re],ge),ne.cross(ge,we),!we.almostZero()){we.normalize();const Oe=Ce.testSepAxis(we,r,h,d,y,b);if(!1===Oe)return!1;Oe<Se&&(Se=Oe,R.copy(we))}}return y.vsub(h,oe),oe.dot(R)>0&&R.negate(R),!0}testSepAxis(r,h,d,y,b,R){K.project(this,r,d,y,ve),K.project(h,r,b,R,Ae);const k=ve[0],M=ve[1],H=Ae[0],X=Ae[1];if(k<X||H<M)return!1;const oe=k-X,ne=H-M;return oe<ne?oe:ne}calculateLocalInertia(r,h){const d=new A,y=new A;this.computeLocalAABB(y,d);const b=d.x-y.x,R=d.y-y.y,k=d.z-y.z;h.x=1/12*r*(2*R*2*R+2*k*2*k),h.y=1/12*r*(2*b*2*b+2*k*2*k),h.z=1/12*r*(2*R*2*R+2*b*2*b)}getPlaneConstantOfFace(r){return-this.faceNormals[r].dot(this.vertices[this.faces[r][0]])}clipFaceAgainstHull(r,h,d,y,b,R,k){const M=new A,H=new A,X=new A,oe=new A,ne=new A,ge=new A,we=new A,Se=new A,Ce=this,Pe=y,Re=[];let Oe=-1,Ge=Number.MAX_VALUE;for(let vt=0;vt<Ce.faces.length;vt++){M.copy(Ce.faceNormals[vt]),d.vmult(M,M);const Lt=M.dot(r);Lt<Ge&&(Ge=Lt,Oe=vt)}if(Oe<0)return;const ke=Ce.faces[Oe];ke.connectedFaces=[];for(let vt=0;vt<Ce.faces.length;vt++)for(let Lt=0;Lt<Ce.faces[vt].length;Lt++)-1!==ke.indexOf(Ce.faces[vt][Lt])&&vt!==Oe&&-1===ke.connectedFaces.indexOf(vt)&&ke.connectedFaces.push(vt);const et=ke.length;for(let vt=0;vt<et;vt++){const Lt=Ce.vertices[ke[vt]];Lt.vsub(Ce.vertices[ke[(vt+1)%et]],H),X.copy(H),d.vmult(X,X),h.vadd(X,X),oe.copy(this.faceNormals[Oe]),d.vmult(oe,oe),h.vadd(oe,oe),X.cross(oe,ne),ne.negate(ne),ge.copy(Lt),d.vmult(ge,ge),h.vadd(ge,ge);const zt=ke.connectedFaces[vt];we.copy(this.faceNormals[zt]);const Bt=this.getPlaneConstantOfFace(zt);Se.copy(we),d.vmult(Se,Se);const $t=Bt-Se.dot(h);for(this.clipFaceAgainstPlane(Pe,Re,Se,$t);Pe.length;)Pe.shift();for(;Re.length;)Pe.push(Re.shift())}we.copy(this.faceNormals[Oe]);const rt=this.getPlaneConstantOfFace(Oe);Se.copy(we),d.vmult(Se,Se);const ut=rt-Se.dot(h);for(let vt=0;vt<Pe.length;vt++){let Lt=Se.dot(Pe[vt])+ut;Lt<=b&&(console.log("clamped: depth="+Lt+" to minDist="+b),Lt=b),Lt<=R&&Lt<=1e-6&&k.push({point:Pe[vt],normal:Se,depth:Lt})}}clipFaceAgainstPlane(r,h,d,y){let b,R;const k=r.length;if(k<2)return h;let M=r[r.length-1],H=r[0];b=d.dot(M)+y;for(let X=0;X<k;X++){if(H=r[X],R=d.dot(H)+y,b<0)if(R<0){const oe=new A;oe.copy(H),h.push(oe)}else{const oe=new A;M.lerp(H,b/(b-R),oe),h.push(oe)}else if(R<0){const oe=new A;M.lerp(H,b/(b-R),oe),h.push(oe),h.push(H)}M=H,b=R}return h}computeWorldVertices(r,h){for(;this.worldVertices.length<this.vertices.length;)this.worldVertices.push(new A);const d=this.vertices,y=this.worldVertices;for(let b=0;b!==this.vertices.length;b++)h.vmult(d[b],y[b]),r.vadd(y[b],y[b]);this.worldVerticesNeedsUpdate=!1}computeLocalAABB(r,h){const d=this.vertices;r.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),h.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(let y=0;y<this.vertices.length;y++){const b=d[y];b.x<r.x?r.x=b.x:b.x>h.x&&(h.x=b.x),b.y<r.y?r.y=b.y:b.y>h.y&&(h.y=b.y),b.z<r.z?r.z=b.z:b.z>h.z&&(h.z=b.z)}}computeWorldFaceNormals(r){const h=this.faceNormals.length;for(;this.worldFaceNormals.length<h;)this.worldFaceNormals.push(new A);const d=this.faceNormals,y=this.worldFaceNormals;for(let b=0;b!==h;b++)r.vmult(d[b],y[b]);this.worldFaceNormalsNeedsUpdate=!1}updateBoundingSphereRadius(){let r=0;const h=this.vertices;for(let d=0;d!==h.length;d++){const y=h[d].lengthSquared();y>r&&(r=y)}this.boundingSphereRadius=Math.sqrt(r)}calculateWorldAABB(r,h,d,y){const b=this.vertices;let R,k,M,H,X,oe,ne=new A;for(let ge=0;ge<b.length;ge++)ne.copy(b[ge]),h.vmult(ne,ne),r.vadd(ne,ne),(void 0===R||ne.x<R)&&(R=ne.x),(void 0===H||ne.x>H)&&(H=ne.x),(void 0===k||ne.y<k)&&(k=ne.y),(void 0===X||ne.y>X)&&(X=ne.y),(void 0===M||ne.z<M)&&(M=ne.z),(void 0===oe||ne.z>oe)&&(oe=ne.z);d.set(R,k,M),y.set(H,X,oe)}volume(){return 4*Math.PI*this.boundingSphereRadius/3}getAveragePointLocal(r=new A){const h=this.vertices;for(let d=0;d<h.length;d++)r.vadd(h[d],r);return r.scale(1/h.length,r),r}transformAllPoints(r,h){const d=this.vertices.length,y=this.vertices;if(h){for(let b=0;b<d;b++){const R=y[b];h.vmult(R,R)}for(let b=0;b<this.faceNormals.length;b++){const R=this.faceNormals[b];h.vmult(R,R)}}if(r)for(let b=0;b<d;b++){const R=y[b];R.vadd(r,R)}}pointIsInside(r){const h=this.vertices,d=this.faces,y=this.faceNormals,b=new A;this.getAveragePointLocal(b);for(let R=0;R<this.faces.length;R++){let k=y[R];const M=h[d[R][0]],H=new A;r.vsub(M,H);const X=k.dot(H),oe=new A;b.vsub(M,oe);const ne=k.dot(oe);if(X<0&&ne>0||X>0&&ne<0)return!1}return-1}}K.computeNormal=(a,r,h,d)=>{const y=new A,b=new A;r.vsub(a,b),h.vsub(r,y),y.cross(b,d),d.isZero()||d.normalize()};const ve=[],Ae=[];K.project=(a,r,h,d,y)=>{const b=a.vertices.length,R=new A;let k=0,M=0;const H=new A,X=a.vertices;H.setZero(),F.vectorToLocalFrame(h,d,r,R),F.pointToLocalFrame(h,d,H,H);const oe=H.dot(R);M=k=X[0].dot(R);for(let ne=1;ne<b;ne++){const ge=X[ne].dot(R);ge>k&&(k=ge),ge<M&&(M=ge)}if(M-=oe,k-=oe,M>k){const ne=M;M=k,k=ne}y[0]=k,y[1]=M};class Fe extends ee{constructor(r){super({type:ee.types.BOX}),this.halfExtents=r,this.convexPolyhedronRepresentation=null,this.updateConvexPolyhedronRepresentation(),this.updateBoundingSphereRadius()}updateConvexPolyhedronRepresentation(){const r=this.halfExtents.x,h=this.halfExtents.y,d=this.halfExtents.z,y=A,b=[new y(-r,-h,-d),new y(r,-h,-d),new y(r,h,-d),new y(-r,h,-d),new y(-r,-h,d),new y(r,-h,d),new y(r,h,d),new y(-r,h,d)],R=[new y(0,0,1),new y(0,1,0),new y(1,0,0)],k=new K({vertices:b,faces:[[3,2,1,0],[4,5,6,7],[5,4,0,1],[2,3,7,6],[0,4,7,3],[1,2,6,5]],axes:R});this.convexPolyhedronRepresentation=k,k.material=this.material}calculateLocalInertia(r,h=new A){return Fe.calculateInertia(this.halfExtents,r,h),h}getSideNormals(r,h){const d=r,y=this.halfExtents;if(d[0].set(y.x,0,0),d[1].set(0,y.y,0),d[2].set(0,0,y.z),d[3].set(-y.x,0,0),d[4].set(0,-y.y,0),d[5].set(0,0,-y.z),void 0!==h)for(let b=0;b!==d.length;b++)h.vmult(d[b],d[b]);return d}volume(){return 8*this.halfExtents.x*this.halfExtents.y*this.halfExtents.z}updateBoundingSphereRadius(){this.boundingSphereRadius=this.halfExtents.length()}forEachWorldCorner(r,h,d){const y=this.halfExtents,b=[[y.x,y.y,y.z],[-y.x,y.y,y.z],[-y.x,-y.y,y.z],[-y.x,-y.y,-y.z],[y.x,-y.y,-y.z],[y.x,y.y,-y.z],[-y.x,y.y,-y.z],[y.x,-y.y,y.z]];for(let R=0;R<b.length;R++)Ee.set(b[R][0],b[R][1],b[R][2]),h.vmult(Ee,Ee),r.vadd(Ee,Ee),d(Ee.x,Ee.y,Ee.z)}calculateWorldAABB(r,h,d,y){const b=this.halfExtents;qe[0].set(b.x,b.y,b.z),qe[1].set(-b.x,b.y,b.z),qe[2].set(-b.x,-b.y,b.z),qe[3].set(-b.x,-b.y,-b.z),qe[4].set(b.x,-b.y,-b.z),qe[5].set(b.x,b.y,-b.z),qe[6].set(-b.x,b.y,-b.z),qe[7].set(b.x,-b.y,b.z);const R=qe[0];h.vmult(R,R),r.vadd(R,R),y.copy(R),d.copy(R);for(let k=1;k<8;k++){const M=qe[k];h.vmult(M,M),r.vadd(M,M);const H=M.x,X=M.y,oe=M.z;H>y.x&&(y.x=H),X>y.y&&(y.y=X),oe>y.z&&(y.z=oe),H<d.x&&(d.x=H),X<d.y&&(d.y=X),oe<d.z&&(d.z=oe)}}}Fe.calculateInertia=(a,r,h)=>{const d=a;h.x=1/12*r*(2*d.y*2*d.y+2*d.z*2*d.z),h.y=1/12*r*(2*d.x*2*d.x+2*d.z*2*d.z),h.z=1/12*r*(2*d.y*2*d.y+2*d.x*2*d.x)};const Ee=new A,qe=[new A,new A,new A,new A,new A,new A,new A,new A],Ke={DYNAMIC:1,STATIC:2,KINEMATIC:4},gt={AWAKE:0,SLEEPY:1,SLEEPING:2};class at extends le{constructor(r={}){super(),this.id=at.idCounter++,this.index=-1,this.world=null,this.preStep=null,this.postStep=null,this.vlambda=new A,this.collisionFilterGroup="number"==typeof r.collisionFilterGroup?r.collisionFilterGroup:1,this.collisionFilterMask="number"==typeof r.collisionFilterMask?r.collisionFilterMask:-1,this.collisionResponse="boolean"!=typeof r.collisionResponse||r.collisionResponse,this.position=new A,this.previousPosition=new A,this.interpolatedPosition=new A,this.initPosition=new A,r.position&&(this.position.copy(r.position),this.previousPosition.copy(r.position),this.interpolatedPosition.copy(r.position),this.initPosition.copy(r.position)),this.velocity=new A,r.velocity&&this.velocity.copy(r.velocity),this.initVelocity=new A,this.force=new A;const h="number"==typeof r.mass?r.mass:0;this.mass=h,this.invMass=h>0?1/h:0,this.material=r.material||null,this.linearDamping="number"==typeof r.linearDamping?r.linearDamping:.01,this.type=h<=0?at.STATIC:at.DYNAMIC,typeof r.type==typeof at.STATIC&&(this.type=r.type),this.allowSleep=void 0===r.allowSleep||r.allowSleep,this.sleepState=0,this.sleepSpeedLimit=void 0!==r.sleepSpeedLimit?r.sleepSpeedLimit:.1,this.sleepTimeLimit=void 0!==r.sleepTimeLimit?r.sleepTimeLimit:1,this.timeLastSleepy=0,this.wakeUpAfterNarrowphase=!1,this.torque=new A,this.quaternion=new pe,this.initQuaternion=new pe,this.previousQuaternion=new pe,this.interpolatedQuaternion=new pe,r.quaternion&&(this.quaternion.copy(r.quaternion),this.initQuaternion.copy(r.quaternion),this.previousQuaternion.copy(r.quaternion),this.interpolatedQuaternion.copy(r.quaternion)),this.angularVelocity=new A,r.angularVelocity&&this.angularVelocity.copy(r.angularVelocity),this.initAngularVelocity=new A,this.shapes=[],this.shapeOffsets=[],this.shapeOrientations=[],this.inertia=new A,this.invInertia=new A,this.invInertiaWorld=new G,this.invMassSolve=0,this.invInertiaSolve=new A,this.invInertiaWorldSolve=new G,this.fixedRotation=void 0!==r.fixedRotation&&r.fixedRotation,this.angularDamping=void 0!==r.angularDamping?r.angularDamping:.01,this.linearFactor=new A(1,1,1),r.linearFactor&&this.linearFactor.copy(r.linearFactor),this.angularFactor=new A(1,1,1),r.angularFactor&&this.angularFactor.copy(r.angularFactor),this.aabb=new te,this.aabbNeedsUpdate=!0,this.boundingRadius=0,this.wlambda=new A,r.shape&&this.addShape(r.shape),this.updateMassProperties()}wakeUp(){const r=this.sleepState;this.sleepState=0,this.wakeUpAfterNarrowphase=!1,r===at.SLEEPING&&this.dispatchEvent(at.wakeupEvent)}sleep(){this.sleepState=at.SLEEPING,this.velocity.set(0,0,0),this.angularVelocity.set(0,0,0),this.wakeUpAfterNarrowphase=!1}sleepTick(r){if(this.allowSleep){const h=this.sleepState,d=this.velocity.lengthSquared()+this.angularVelocity.lengthSquared(),y=this.sleepSpeedLimit**2;h===at.AWAKE&&d<y?(this.sleepState=at.SLEEPY,this.timeLastSleepy=r,this.dispatchEvent(at.sleepyEvent)):h===at.SLEEPY&&d>y?this.wakeUp():h===at.SLEEPY&&r-this.timeLastSleepy>this.sleepTimeLimit&&(this.sleep(),this.dispatchEvent(at.sleepEvent))}}updateSolveMassProperties(){this.sleepState===at.SLEEPING||this.type===at.KINEMATIC?(this.invMassSolve=0,this.invInertiaSolve.setZero(),this.invInertiaWorldSolve.setZero()):(this.invMassSolve=this.invMass,this.invInertiaSolve.copy(this.invInertia),this.invInertiaWorldSolve.copy(this.invInertiaWorld))}pointToLocalFrame(r,h=new A){return r.vsub(this.position,h),this.quaternion.conjugate().vmult(h,h),h}vectorToLocalFrame(r,h=new A){return this.quaternion.conjugate().vmult(r,h),h}pointToWorldFrame(r,h=new A){return this.quaternion.vmult(r,h),h.vadd(this.position,h),h}vectorToWorldFrame(r,h=new A){return this.quaternion.vmult(r,h),h}addShape(r,h,d){const y=new A,b=new pe;return h&&y.copy(h),d&&b.copy(d),this.shapes.push(r),this.shapeOffsets.push(y),this.shapeOrientations.push(b),this.updateMassProperties(),this.updateBoundingRadius(),this.aabbNeedsUpdate=!0,r.body=this,this}updateBoundingRadius(){const r=this.shapes,h=this.shapeOffsets,d=r.length;let y=0;for(let b=0;b!==d;b++){const R=r[b];R.updateBoundingSphereRadius();const k=h[b].length(),M=R.boundingSphereRadius;k+M>y&&(y=k+M)}this.boundingRadius=y}computeAABB(){const r=this.shapes,h=this.shapeOffsets,d=this.shapeOrientations,y=r.length,b=Ct,R=wt,k=this.quaternion,M=this.aabb,H=Ft;for(let X=0;X!==y;X++){const oe=r[X];k.vmult(h[X],b),b.vadd(this.position,b),k.mult(d[X],R),oe.calculateWorldAABB(b,R,H.lowerBound,H.upperBound),0===X?M.copy(H):M.extend(H)}this.aabbNeedsUpdate=!1}updateInertiaWorld(r){const h=this.invInertia;if(h.x!==h.y||h.y!==h.z||r){const d=Ot,y=rn;d.setRotationFromQuaternion(this.quaternion),d.transpose(y),d.scale(h,d),d.mmult(y,this.invInertiaWorld)}}applyForce(r,h){if(this.type!==at.DYNAMIC)return;const d=ft;h.cross(r,d),this.force.vadd(r,this.force),this.torque.vadd(d,this.torque)}applyLocalForce(r,h){if(this.type!==at.DYNAMIC)return;const d=Tn,y=Cn;this.vectorToWorldFrame(r,d),this.vectorToWorldFrame(h,y),this.applyForce(d,y)}applyImpulse(r,h){if(this.type!==at.DYNAMIC)return;const d=h,y=mn;y.copy(r),y.scale(this.invMass,y),this.velocity.vadd(y,this.velocity);const b=Pn;d.cross(r,b),this.invInertiaWorld.vmult(b,b),this.angularVelocity.vadd(b,this.angularVelocity)}applyLocalImpulse(r,h){if(this.type!==at.DYNAMIC)return;const d=$n,y=gn;this.vectorToWorldFrame(r,d),this.vectorToWorldFrame(h,y),this.applyImpulse(d,y)}updateMassProperties(){const r=ur;this.invMass=this.mass>0?1/this.mass:0;const h=this.inertia,d=this.fixedRotation;this.computeAABB(),r.set((this.aabb.upperBound.x-this.aabb.lowerBound.x)/2,(this.aabb.upperBound.y-this.aabb.lowerBound.y)/2,(this.aabb.upperBound.z-this.aabb.lowerBound.z)/2),Fe.calculateInertia(r,this.mass,h),this.invInertia.set(h.x>0&&!d?1/h.x:0,h.y>0&&!d?1/h.y:0,h.z>0&&!d?1/h.z:0),this.updateInertiaWorld(!0)}getVelocityAtWorldPoint(r,h){const d=new A;return r.vsub(this.position,d),this.angularVelocity.cross(d,h),this.velocity.vadd(h,h),h}integrate(r,h,d){if(this.previousPosition.copy(this.position),this.previousQuaternion.copy(this.quaternion),this.type!==at.DYNAMIC&&this.type!==at.KINEMATIC||this.sleepState===at.SLEEPING)return;const y=this.velocity,b=this.angularVelocity,R=this.position,k=this.force,M=this.torque,H=this.quaternion,oe=this.invInertiaWorld,ne=this.linearFactor,ge=this.invMass*r;y.x+=k.x*ge*ne.x,y.y+=k.y*ge*ne.y,y.z+=k.z*ge*ne.z;const we=oe.elements,Se=this.angularFactor,Ce=M.x*Se.x,Pe=M.y*Se.y,Re=M.z*Se.z;b.x+=r*(we[0]*Ce+we[1]*Pe+we[2]*Re),b.y+=r*(we[3]*Ce+we[4]*Pe+we[5]*Re),b.z+=r*(we[6]*Ce+we[7]*Pe+we[8]*Re),R.x+=y.x*r,R.y+=y.y*r,R.z+=y.z*r,H.integrate(this.angularVelocity,r,this.angularFactor,H),h&&(d?H.normalizeFast():H.normalize()),this.aabbNeedsUpdate=!0,this.updateInertiaWorld()}}at.COLLIDE_EVENT_NAME="collide",at.DYNAMIC=1,at.STATIC=2,at.KINEMATIC=4,at.AWAKE=gt.AWAKE,at.SLEEPY=gt.SLEEPY,at.SLEEPING=gt.SLEEPING,at.idCounter=0,at.wakeupEvent={type:"wakeup"},at.sleepyEvent={type:"sleepy"},at.sleepEvent={type:"sleep"};const Ct=new A,wt=new pe,Ft=new te,Ot=new G,rn=new G,ft=new A,Tn=new A,Cn=new A,mn=new A,Pn=new A,$n=new A,gn=new A,ur=new A;class or{constructor(){this.world=null,this.useBoundingBoxes=!1,this.dirty=!0}collisionPairs(r,h,d){throw new Error("collisionPairs not implemented for this BroadPhase class!")}needBroadphaseCollision(r,h){return!(!(r.collisionFilterGroup&h.collisionFilterMask)||!(h.collisionFilterGroup&r.collisionFilterMask)||(r.type&at.STATIC||r.sleepState===at.SLEEPING)&&(h.type&at.STATIC||h.sleepState===at.SLEEPING))}intersectionTest(r,h,d,y){this.useBoundingBoxes?this.doBoundingBoxBroadphase(r,h,d,y):this.doBoundingSphereBroadphase(r,h,d,y)}doBoundingSphereBroadphase(r,h,d,y){const b=hr;h.position.vsub(r.position,b);const R=(r.boundingRadius+h.boundingRadius)**2;b.lengthSquared()<R&&(d.push(r),y.push(h))}doBoundingBoxBroadphase(r,h,d,y){r.aabbNeedsUpdate&&r.computeAABB(),h.aabbNeedsUpdate&&h.computeAABB(),r.aabb.overlaps(h.aabb)&&(d.push(r),y.push(h))}makePairsUnique(r,h){const d=sr,y=ei,b=Jr,R=r.length;for(let k=0;k!==R;k++)y[k]=r[k],b[k]=h[k];r.length=0,h.length=0;for(let k=0;k!==R;k++){const M=y[k].id,H=b[k].id,X=M<H?M+","+H:H+","+M;d[X]=k,d.keys.push(X)}for(let k=0;k!==d.keys.length;k++){const M=d.keys.pop(),H=d[M];r.push(y[H]),h.push(b[H]),delete d[M]}}setWorld(r){}aabbQuery(r,h,d){return console.warn(".aabbQuery is not implemented in this Broadphase subclass."),[]}}const hr=new A,sr={keys:[]},ei=[],Jr=[];or.boundingSphereCheck=(a,r)=>{const h=new A;return a.position.vsub(r.position,h),Math.pow(a.shapes[0].boundingSphereRadius+r.shapes[0].boundingSphereRadius,2)>h.lengthSquared()};class ci extends or{constructor(r=new A(100,100,100),h=new A(-100,-100,-100),d=10,y=10,b=10){super(),this.nx=d,this.ny=y,this.nz=b,this.aabbMin=r,this.aabbMax=h;const R=this.nx*this.ny*this.nz;if(R<=0)throw"GridBroadphase: Each dimension's n must be >0";this.bins=[],this.binLengths=[],this.bins.length=R,this.binLengths.length=R;for(let k=0;k<R;k++)this.bins[k]=[],this.binLengths[k]=0}collisionPairs(r,h,d){const y=r.numObjects(),b=r.bodies,R=this.aabbMax,k=this.aabbMin,M=this.nx,H=this.ny,X=this.nz,oe=H*X,ne=X,ge=R.x,we=R.y,Se=R.z,Ce=k.x,Pe=k.y,Re=k.z,Oe=M/(ge-Ce),Ge=H/(we-Pe),ke=X/(Se-Re),et=(ge-Ce)/M,rt=(we-Pe)/H,ut=(Se-Re)/X,vt=.5*Math.sqrt(et*et+rt*rt+ut*ut),Lt=ee.types,Kt=Lt.SPHERE,zt=Lt.PLANE,Bt=this.bins,$t=this.binLengths,ht=this.bins.length;for(let un=0;un!==ht;un++)$t[un]=0;const Tt=Math.ceil;function Zt(un,Mn,wr,Yn,On,Kn,dr){let Mr=(un-Ce)*Oe|0,di=(Mn-Pe)*Ge|0,so=(wr-Re)*ke|0,ao=Tt((Yn-Ce)*Oe),Do=Tt((On-Pe)*Ge),Uo=Tt((Kn-Re)*ke);Mr<0?Mr=0:Mr>=M&&(Mr=M-1),di<0?di=0:di>=H&&(di=H-1),so<0?so=0:so>=X&&(so=X-1),ao<0?ao=0:ao>=M&&(ao=M-1),Do<0?Do=0:Do>=H&&(Do=H-1),Uo<0?Uo=0:Uo>=X&&(Uo=X-1),Mr*=oe,di*=ne,so*=1,ao*=oe,Do*=ne,Uo*=1;for(let hs=Mr;hs<=ao;hs+=oe)for(let is=di;is<=Do;is+=ne)for(let Bo=so;Bo<=Uo;Bo+=1){const qa=hs+is+Bo;Bt[qa][$t[qa]++]=dr}}for(let un=0;un!==y;un++){const Mn=b[un],wr=Mn.shapes[0];switch(wr.type){case Kt:{const On=Mn.position.x,Kn=Mn.position.y,dr=Mn.position.z,Mr=wr.radius;Zt(On-Mr,Kn-Mr,dr-Mr,On+Mr,Kn+Mr,dr+Mr,Mn);break}case zt:{const Yn=wr;Yn.worldNormalNeedsUpdate&&Yn.computeWorldNormal(Mn.quaternion);const On=Yn.worldNormal,dr=Pe+.5*rt-Mn.position.y,Mr=Re+.5*ut-Mn.position.z,di=ir;di.set(Ce+.5*et-Mn.position.x,dr,Mr);for(let so=0,ao=0;so!==M;so++,ao+=oe,di.y=dr,di.x+=et)for(let Do=0,Uo=0;Do!==H;Do++,Uo+=ne,di.z=Mr,di.y+=rt)for(let hs=0,is=0;hs!==X;hs++,is+=1,di.z+=ut)if(di.dot(On)<vt){const Bo=ao+Uo+is;Bt[Bo][$t[Bo]++]=Mn}break}default:Mn.aabbNeedsUpdate&&Mn.computeAABB(),Zt(Mn.aabb.lowerBound.x,Mn.aabb.lowerBound.y,Mn.aabb.lowerBound.z,Mn.aabb.upperBound.x,Mn.aabb.upperBound.y,Mn.aabb.upperBound.z,Mn)}}for(let un=0;un!==ht;un++){const Mn=$t[un];if(Mn>1){const wr=Bt[un];for(let Yn=0;Yn!==Mn;Yn++){const On=wr[Yn];for(let Kn=0;Kn!==Yn;Kn++){const dr=wr[Kn];this.needBroadphaseCollision(On,dr)&&this.intersectionTest(On,dr,h,d)}}}}this.makePairsUnique(h,d)}}const ir=new A;class vr extends or{constructor(){super()}collisionPairs(r,h,d){const y=r.bodies,b=y.length;let R,k;for(let M=0;M!==b;M++)for(let H=0;H!==M;H++)R=y[M],k=y[H],this.needBroadphaseCollision(R,k)&&this.intersectionTest(R,k,h,d)}aabbQuery(r,h,d=[]){for(let y=0;y<r.bodies.length;y++){const b=r.bodies[y];b.aabbNeedsUpdate&&b.computeAABB(),b.aabb.overlaps(h)&&d.push(b)}return d}}class pi{constructor(){this.rayFromWorld=new A,this.rayToWorld=new A,this.hitNormalWorld=new A,this.hitPointWorld=new A,this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}reset(){this.rayFromWorld.setZero(),this.rayToWorld.setZero(),this.hitNormalWorld.setZero(),this.hitPointWorld.setZero(),this.hasHit=!1,this.shape=null,this.body=null,this.hitFaceIndex=-1,this.distance=-1,this.shouldStop=!1}abort(){this.shouldStop=!0}set(r,h,d,y,b,R,k){this.rayFromWorld.copy(r),this.rayToWorld.copy(h),this.hitNormalWorld.copy(d),this.hitPointWorld.copy(y),this.shape=b,this.body=R,this.distance=k}}const go={CLOSEST:1,ANY:2,ALL:4};class Nr{constructor(r=new A,h=new A){this.from=r.clone(),this.to=h.clone(),this.direction=new A,this.precision=1e-4,this.checkCollisionResponse=!0,this.skipBackfaces=!1,this.collisionFilterMask=-1,this.collisionFilterGroup=-1,this.mode=Nr.ANY,this.result=new pi,this.hasHit=!1,this.callback=d=>{}}intersectWorld(r,h){return this.mode=h.mode||Nr.ANY,this.result=h.result||new pi,this.skipBackfaces=!!h.skipBackfaces,this.collisionFilterMask=void 0!==h.collisionFilterMask?h.collisionFilterMask:-1,this.collisionFilterGroup=void 0!==h.collisionFilterGroup?h.collisionFilterGroup:-1,this.checkCollisionResponse=void 0===h.checkCollisionResponse||h.checkCollisionResponse,h.from&&this.from.copy(h.from),h.to&&this.to.copy(h.to),this.callback=h.callback||(()=>{}),this.hasHit=!1,this.result.reset(),this.updateDirection(),this.getAABB(Zr),Vr.length=0,r.broadphase.aabbQuery(r,Zr,Vr),this.intersectBodies(Vr),this.hasHit}intersectBody(r,h){h&&(this.result=h,this.updateDirection());const d=this.checkCollisionResponse;if(d&&!r.collisionResponse||!(this.collisionFilterGroup&r.collisionFilterMask)||!(r.collisionFilterGroup&this.collisionFilterMask))return;const y=Gs,b=Ks;for(let R=0,k=r.shapes.length;R<k;R++){const M=r.shapes[R];if((!d||M.collisionResponse)&&(r.quaternion.mult(r.shapeOrientations[R],b),r.quaternion.vmult(r.shapeOffsets[R],y),y.vadd(r.position,y),this.intersectShape(M,b,y,r),this.result.shouldStop))break}}intersectBodies(r,h){h&&(this.result=h,this.updateDirection());for(let d=0,y=r.length;!this.result.shouldStop&&d<y;d++)this.intersectBody(r[d])}updateDirection(){this.to.vsub(this.from,this.direction),this.direction.normalize()}intersectShape(r,h,d,y){if(function(k,M,H){H.vsub(k,Vs);const X=Vs.dot(M);return M.scale(X,Vo),Vo.vadd(k,Vo),H.distanceTo(Vo)}(this.from,this.direction,d)>r.boundingSphereRadius)return;const R=this[r.type];R&&R.call(this,r,h,d,y,r)}_intersectBox(r,h,d,y,b){return this._intersectConvex(r.convexPolyhedronRepresentation,h,d,y,b)}_intersectPlane(r,h,d,y,b){const R=this.from,k=this.to,M=this.direction,H=new A(0,0,1);h.vmult(H,H);const X=new A;R.vsub(d,X);const oe=X.dot(H);if(k.vsub(d,X),oe*X.dot(H)>0||R.distanceTo(k)<oe)return;const ne=H.dot(M);if(Math.abs(ne)<this.precision)return;const ge=new A,we=new A,Se=new A;R.vsub(d,ge);const Ce=-H.dot(ge)/ne;M.scale(Ce,we),R.vadd(we,Se),this.reportIntersection(H,Se,b,y,-1)}getAABB(r){const{lowerBound:h,upperBound:d}=r,y=this.to,b=this.from;h.x=Math.min(y.x,b.x),h.y=Math.min(y.y,b.y),h.z=Math.min(y.z,b.z),d.x=Math.max(y.x,b.x),d.y=Math.max(y.y,b.y),d.z=Math.max(y.z,b.z)}_intersectHeightfield(r,h,d,y,b){const R=Na;R.from.copy(this.from),R.to.copy(this.to),F.pointToLocalFrame(d,h,R.from,R.from),F.pointToLocalFrame(d,h,R.to,R.to),R.updateDirection();const k=Fu;let M,H,X,oe;M=H=0,X=oe=r.data.length-1;const ne=new te;R.getAABB(ne),r.getIndexOfPosition(ne.lowerBound.x,ne.lowerBound.y,k,!0),M=Math.max(M,k[0]),H=Math.max(H,k[1]),r.getIndexOfPosition(ne.upperBound.x,ne.upperBound.y,k,!0),X=Math.min(X,k[0]+1),oe=Math.min(oe,k[1]+1);for(let ge=M;ge<X;ge++)for(let we=H;we<oe;we++){if(this.result.shouldStop)return;if(r.getAabbAtIndex(ge,we,ne),ne.overlapsRay(R)){if(r.getConvexTrianglePillar(ge,we,!1),F.pointToWorldFrame(d,h,r.pillarOffset,Or),this._intersectConvex(r.pillarConvex,h,Or,y,b,ss),this.result.shouldStop)return;r.getConvexTrianglePillar(ge,we,!0),F.pointToWorldFrame(d,h,r.pillarOffset,Or),this._intersectConvex(r.pillarConvex,h,Or,y,b,ss)}}}_intersectSphere(r,h,d,y,b){const R=this.from,k=this.to,H=(k.x-R.x)**2+(k.y-R.y)**2+(k.z-R.z)**2,X=2*((k.x-R.x)*(R.x-d.x)+(k.y-R.y)*(R.y-d.y)+(k.z-R.z)*(R.z-d.z)),oe=X**2-4*H*((R.x-d.x)**2+(R.y-d.y)**2+(R.z-d.z)**2-r.radius**2),ne=ps,ge=Hs;if(!(oe<0))if(0===oe)R.lerp(k,oe,ne),ne.vsub(d,ge),ge.normalize(),this.reportIntersection(ge,ne,b,y,-1);else{const we=(-X-Math.sqrt(oe))/(2*H),Se=(-X+Math.sqrt(oe))/(2*H);if(we>=0&&we<=1&&(R.lerp(k,we,ne),ne.vsub(d,ge),ge.normalize(),this.reportIntersection(ge,ne,b,y,-1)),this.result.shouldStop)return;Se>=0&&Se<=1&&(R.lerp(k,Se,ne),ne.vsub(d,ge),ge.normalize(),this.reportIntersection(ge,ne,b,y,-1))}}_intersectConvex(r,h,d,y,b,R){const k=ii,M=Pc,H=R&&R.faceList||null,X=r.faces,oe=r.vertices,ne=r.faceNormals,ge=this.direction,we=this.from,Ce=we.distanceTo(this.to),Pe=H?H.length:X.length,Re=this.result;for(let Oe=0;!Re.shouldStop&&Oe<Pe;Oe++){const Ge=H?H[Oe]:Oe,ke=X[Ge],et=ne[Ge],rt=h,ut=d;M.copy(oe[ke[0]]),rt.vmult(M,M),M.vadd(ut,M),M.vsub(we,M),rt.vmult(et,k);const vt=ge.dot(k);if(Math.abs(vt)<this.precision)continue;const Lt=k.dot(M)/vt;if(!(Lt<0)){ge.scale(Lt,Di),Di.vadd(we,Di),Eo.copy(oe[ke[0]]),rt.vmult(Eo,Eo),ut.vadd(Eo,Eo);for(let Kt=1;!Re.shouldStop&&Kt<ke.length-1;Kt++){vo.copy(oe[ke[Kt]]),Xr.copy(oe[ke[Kt+1]]),rt.vmult(vo,vo),rt.vmult(Xr,Xr),ut.vadd(vo,vo),ut.vadd(Xr,Xr);const zt=Di.distanceTo(we);!So(Di,Eo,vo,Xr)&&!So(Di,vo,Eo,Xr)||zt>Ce||this.reportIntersection(k,Di,b,y,Ge)}}}}_intersectTrimesh(r,h,d,y,b,R){const k=Uh,M=Ic,H=Zp,X=Pc,oe=Ya,ne=Jp,ge=ea,we=Ra,Se=kl,Ce=r.indices,Pe=this.from,Re=this.to,Oe=this.direction;H.position.copy(d),H.quaternion.copy(h),F.vectorToLocalFrame(d,h,Oe,oe),F.pointToLocalFrame(d,h,Pe,ne),F.pointToLocalFrame(d,h,Re,ge),ge.x*=r.scale.x,ge.y*=r.scale.y,ge.z*=r.scale.z,ne.x*=r.scale.x,ne.y*=r.scale.y,ne.z*=r.scale.z,ge.vsub(ne,oe),oe.normalize();const Ge=ne.distanceSquared(ge);r.tree.rayQuery(this,H,M);for(let ke=0,et=M.length;!this.result.shouldStop&&ke!==et;ke++){const rt=M[ke];r.getNormal(rt,k),r.getVertex(Ce[3*rt],Eo),Eo.vsub(ne,X);const ut=oe.dot(k),vt=k.dot(X)/ut;if(vt<0)continue;oe.scale(vt,Di),Di.vadd(ne,Di),r.getVertex(Ce[3*rt+1],vo),r.getVertex(Ce[3*rt+2],Xr);const Lt=Di.distanceSquared(ne);!So(Di,vo,Eo,Xr)&&!So(Di,Eo,vo,Xr)||Lt>Ge||(F.vectorToWorldFrame(h,k,Se),F.pointToWorldFrame(d,h,Di,we),this.reportIntersection(Se,we,b,y,rt))}M.length=0}reportIntersection(r,h,d,y,b){const R=this.from,k=this.to,M=R.distanceTo(h),H=this.result;if(!(this.skipBackfaces&&r.dot(this.direction)>0))switch(H.hitFaceIndex=void 0!==b?b:-1,this.mode){case Nr.ALL:this.hasHit=!0,H.set(R,k,r,h,d,y,M),H.hasHit=!0,this.callback(H);break;case Nr.CLOSEST:(M<H.distance||!H.hasHit)&&(this.hasHit=!0,H.hasHit=!0,H.set(R,k,r,h,d,y,M));break;case Nr.ANY:this.hasHit=!0,H.hasHit=!0,H.set(R,k,r,h,d,y,M),H.shouldStop=!0}}}Nr.CLOSEST=1,Nr.ANY=2,Nr.ALL=4;const Zr=new te,Vr=[],fi=new A,bi=new A;function So(a,r,h,d){d.vsub(r,Vs),h.vsub(r,fi),a.vsub(r,bi);const y=Vs.dot(Vs),b=Vs.dot(fi),R=Vs.dot(bi),k=fi.dot(fi),M=fi.dot(bi);let H,X;return(H=k*R-b*M)>=0&&(X=y*M-b*R)>=0&&H+X<y*k-b*b}Nr.pointInTriangle=So;const Gs=new A,Ks=new pe,Di=new A,Eo=new A,vo=new A,Xr=new A;Nr.prototype[ee.types.BOX]=Nr.prototype._intersectBox,Nr.prototype[ee.types.PLANE]=Nr.prototype._intersectPlane;const ss={faceList:[0]},Or=new A,Na=new Nr,Fu=[];Nr.prototype[ee.types.HEIGHTFIELD]=Nr.prototype._intersectHeightfield;const ps=new A,Hs=new A;Nr.prototype[ee.types.SPHERE]=Nr.prototype._intersectSphere;const ii=new A,Pc=new A;Nr.prototype[ee.types.CONVEXPOLYHEDRON]=Nr.prototype._intersectConvex;const Uh=new A,Ya=new A,Jp=new A,ea=new A,kl=new A,Ra=new A,Ic=(new te,[]),Zp=new F;Nr.prototype[ee.types.TRIMESH]=Nr.prototype._intersectTrimesh;const Vs=new A,Vo=new A;class ds extends or{constructor(r){super(),this.axisList=[],this.world=null,this.axisIndex=0;const h=this.axisList;this._addBodyHandler=d=>{h.push(d.body)},this._removeBodyHandler=d=>{const y=h.indexOf(d.body);-1!==y&&h.splice(y,1)},r&&this.setWorld(r)}setWorld(r){this.axisList.length=0;for(let h=0;h<r.bodies.length;h++)this.axisList.push(r.bodies[h]);r.removeEventListener("addBody",this._addBodyHandler),r.removeEventListener("removeBody",this._removeBodyHandler),r.addEventListener("addBody",this._addBodyHandler),r.addEventListener("removeBody",this._removeBodyHandler),this.world=r,this.dirty=!0}collisionPairs(r,h,d){const y=this.axisList,b=y.length,R=this.axisIndex;let k,M;for(this.dirty&&(this.sortList(),this.dirty=!1),k=0;k!==b;k++){const H=y[k];for(M=k+1;M<b;M++){const X=y[M];if(this.needBroadphaseCollision(H,X)){if(!ds.checkBounds(H,X,R))break;this.intersectionTest(H,X,h,d)}}}}sortList(){const r=this.axisList,h=this.axisIndex,d=r.length;for(let y=0;y!==d;y++){const b=r[y];b.aabbNeedsUpdate&&b.computeAABB()}0===h?ds.insertionSortX(r):1===h?ds.insertionSortY(r):2===h&&ds.insertionSortZ(r)}autoDetectAxis(){let r=0,h=0,d=0,y=0,b=0,R=0;const k=this.axisList,M=k.length,H=1/M;for(let ge=0;ge!==M;ge++){const we=k[ge],Se=we.position.x;r+=Se,h+=Se*Se;const Ce=we.position.y;d+=Ce,y+=Ce*Ce;const Pe=we.position.z;b+=Pe,R+=Pe*Pe}const X=h-r*r*H,oe=y-d*d*H,ne=R-b*b*H;this.axisIndex=X>oe?X>ne?0:2:oe>ne?1:2}aabbQuery(r,h,d=[]){this.dirty&&(this.sortList(),this.dirty=!1);const y=this.axisIndex;let b="x";1===y&&(b="y"),2===y&&(b="z");const R=this.axisList;for(let k=0;k<R.length;k++){const M=R[k];M.aabbNeedsUpdate&&M.computeAABB(),M.aabb.overlaps(h)&&d.push(M)}return d}}function Du(){}ds.insertionSortX=a=>{for(let r=1,h=a.length;r<h;r++){const d=a[r];let y;for(y=r-1;y>=0&&!(a[y].aabb.lowerBound.x<=d.aabb.lowerBound.x);y--)a[y+1]=a[y];a[y+1]=d}return a},ds.insertionSortY=a=>{for(let r=1,h=a.length;r<h;r++){const d=a[r];let y;for(y=r-1;y>=0&&!(a[y].aabb.lowerBound.y<=d.aabb.lowerBound.y);y--)a[y+1]=a[y];a[y+1]=d}return a},ds.insertionSortZ=a=>{for(let r=1,h=a.length;r<h;r++){const d=a[r];let y;for(y=r-1;y>=0&&!(a[y].aabb.lowerBound.z<=d.aabb.lowerBound.z);y--)a[y+1]=a[y];a[y+1]=d}return a},ds.checkBounds=(a,r,h)=>{let d,y;return 0===h?(d=a.position.x,y=r.position.x):1===h?(d=a.position.y,y=r.position.y):2===h&&(d=a.position.z,y=r.position.z),y-r.boundingRadius<d+a.boundingRadius},Du.defaults=(a={},r)=>{for(let h in r)h in a||(a[h]=r[h]);return a};class pu{constructor(r,h,d={}){d=Du.defaults(d,{collideConnected:!0,wakeUpBodies:!0}),this.equations=[],this.bodyA=r,this.bodyB=h,this.id=pu.idCounter++,this.collideConnected=d.collideConnected,d.wakeUpBodies&&(r&&r.wakeUp(),h&&h.wakeUp())}update(){throw new Error("method update() not implmemented in this Constraint subclass!")}enable(){const r=this.equations;for(let h=0;h<r.length;h++)r[h].enabled=!0}disable(){const r=this.equations;for(let h=0;h<r.length;h++)r[h].enabled=!1}}pu.idCounter=0;class du{constructor(){this.spatial=new A,this.rotational=new A}multiplyElement(r){return r.spatial.dot(this.spatial)+r.rotational.dot(this.rotational)}multiplyVectors(r,h){return r.dot(this.spatial)+h.dot(this.rotational)}}class Es{constructor(r,h,d=-1e6,y=1e6){this.id=Es.id++,this.minForce=d,this.maxForce=y,this.bi=r,this.bj=h,this.a=0,this.b=0,this.eps=0,this.jacobianElementA=new du,this.jacobianElementB=new du,this.enabled=!0,this.multiplier=0,this.setSpookParams(1e7,4,1/60)}setSpookParams(r,h,d){const y=h,b=r,R=d;this.a=4/(R*(1+4*y)),this.b=4*y/(1+4*y),this.eps=4/(R*R*b*(1+4*y))}computeB(r,h,d){const y=this.computeGW();return-this.computeGq()*r-y*h-this.computeGiMf()*d}computeGq(){const h=this.jacobianElementB,R=this.bj.position;return this.jacobianElementA.spatial.dot(this.bi.position)+h.spatial.dot(R)}computeGW(){const h=this.jacobianElementB,d=this.bi,y=this.bj,R=y.velocity,M=y.angularVelocity;return this.jacobianElementA.multiplyVectors(d.velocity,d.angularVelocity)+h.multiplyVectors(R,M)}computeGWlambda(){const h=this.jacobianElementB,d=this.bi,y=this.bj,R=y.vlambda,M=y.wlambda;return this.jacobianElementA.multiplyVectors(d.vlambda,d.wlambda)+h.multiplyVectors(R,M)}computeGiMf(){const r=this.jacobianElementA,h=this.jacobianElementB,d=this.bi,y=this.bj,R=d.torque,k=y.force,M=y.torque,X=y.invMassSolve;return d.force.scale(d.invMassSolve,dp),k.scale(X,Rs),d.invInertiaWorldSolve.vmult(R,lo),y.invInertiaWorldSolve.vmult(M,Oc),r.multiplyVectors(dp,lo)+h.multiplyVectors(Rs,Oc)}computeGiMGt(){const r=this.jacobianElementA,h=this.jacobianElementB,d=this.bi,y=this.bj,M=y.invInertiaWorldSolve;let H=d.invMassSolve+y.invMassSolve;return d.invInertiaWorldSolve.vmult(r.rotational,Uu),H+=Uu.dot(r.rotational),M.vmult(h.rotational,Uu),H+=Uu.dot(h.rotational),H}addToWlambda(r){const h=this.jacobianElementA,d=this.jacobianElementB,y=this.bi,b=this.bj,R=gh;y.vlambda.addScaledVector(y.invMassSolve*r,h.spatial,y.vlambda),b.vlambda.addScaledVector(b.invMassSolve*r,d.spatial,b.vlambda),y.invInertiaWorldSolve.vmult(h.rotational,R),y.wlambda.addScaledVector(r,R,y.wlambda),b.invInertiaWorldSolve.vmult(d.rotational,R),b.wlambda.addScaledVector(r,R,b.wlambda)}computeC(){return this.computeGiMGt()+this.eps}}Es.id=0;const dp=new A,Rs=new A,lo=new A,Oc=new A,Uu=new A,gh=new A;class To extends Es{constructor(r,h,d=1e6){super(r,h,0,d),this.restitution=0,this.ri=new A,this.rj=new A,this.ni=new A}computeB(r){const h=this.a,d=this.b,y=this.bi,b=this.bj,R=this.ri,k=this.rj,M=Ws,H=Qp,X=y.velocity,oe=y.angularVelocity,ne=b.velocity,ge=b.angularVelocity,we=Ja,Se=this.jacobianElementA,Ce=this.jacobianElementB,Pe=this.ni;R.cross(Pe,M),k.cross(Pe,H),Pe.negate(Se.spatial),M.negate(Se.rotational),Ce.spatial.copy(Pe),Ce.rotational.copy(H),we.copy(b.position),we.vadd(k,we),we.vsub(y.position,we),we.vsub(R,we);const Re=Pe.dot(we),Oe=this.restitution+1;return-Re*h-(Oe*ne.dot(Pe)-Oe*X.dot(Pe)+ge.dot(H)-oe.dot(M))*d-r*this.computeGiMf()}getImpactVelocityAlongNormal(){const r=fu,h=fp,d=mp,y=vh,b=zh;return this.bi.position.vadd(this.ri,d),this.bj.position.vadd(this.rj,y),this.bi.getVelocityAtWorldPoint(d,r),this.bj.getVelocityAtWorldPoint(y,h),r.vsub(h,b),this.ni.dot(b)}}const Ws=new A,Qp=new A,Ja=new A,fu=new A,fp=new A,mp=new A,vh=new A,zh=new A;class ic extends pu{constructor(r,h=new A,d,y=new A,b=1e6){super(r,d),this.pivotA=h.clone(),this.pivotB=y.clone();const R=this.equationX=new To(r,d),k=this.equationY=new To(r,d),M=this.equationZ=new To(r,d);this.equations.push(R,k,M),R.minForce=k.minForce=M.minForce=-b,R.maxForce=k.maxForce=M.maxForce=b,R.ni.set(1,0,0),k.ni.set(0,1,0),M.ni.set(0,0,1)}update(){const h=this.bodyB,d=this.equationX,y=this.equationY,b=this.equationZ;this.bodyA.quaternion.vmult(this.pivotA,d.ri),h.quaternion.vmult(this.pivotB,d.rj),y.ri.copy(d.ri),y.rj.copy(d.rj),b.ri.copy(d.ri),b.rj.copy(d.rj)}}class jh extends Es{constructor(r,h,d={}){const y=void 0!==d.maxForce?d.maxForce:1e6;super(r,h,-y,y),this.axisA=d.axisA?d.axisA.clone():new A(1,0,0),this.axisB=d.axisB?d.axisB.clone():new A(0,1,0),this.angle=void 0!==d.angle?d.angle:0}computeB(r){const h=this.a,d=this.b,y=this.axisA,b=this.axisB,R=yh,k=Gh,M=this.jacobianElementA,H=this.jacobianElementB;return y.cross(b,R),b.cross(y,k),M.rotational.copy(k),H.rotational.copy(R),-(Math.cos(this.angle)-y.dot(b))*h-this.computeGW()*d-r*this.computeGiMf()}}const yh=new A,Gh=new A;class vl extends Es{constructor(r,h,d={}){const y=void 0!==d.maxForce?d.maxForce:1e6;super(r,h,-y,y),this.axisA=d.axisA?d.axisA.clone():new A(1,0,0),this.axisB=d.axisB?d.axisB.clone():new A(0,1,0),this.maxAngle=Math.PI/2}computeB(r){const h=this.a,d=this.b,y=this.axisA,b=this.axisB,R=yl,k=Fl,M=this.jacobianElementA,H=this.jacobianElementB;return y.cross(b,R),b.cross(y,k),M.rotational.copy(k),H.rotational.copy(R),-(Math.cos(this.maxAngle)-y.dot(b))*h-this.computeGW()*d-r*this.computeGiMf()}}const yl=new A,Fl=new A;class zu extends ic{constructor(r,h,d={}){const y=void 0!==d.maxForce?d.maxForce:1e6;super(r,d.pivotA?d.pivotA.clone():new A,h,d.pivotB?d.pivotB.clone():new A,y),this.axisA=d.axisA?d.axisA.clone():new A,this.axisB=d.axisB?d.axisB.clone():new A,this.collideConnected=!!d.collideConnected,this.angle=void 0!==d.angle?d.angle:0;const b=this.coneEquation=new jh(r,h,d),R=this.twistEquation=new vl(r,h,d);this.twistAngle=void 0!==d.twistAngle?d.twistAngle:0,b.maxForce=0,b.minForce=-y,R.maxForce=0,R.minForce=-y,this.equations.push(b,R)}update(){const r=this.bodyA,h=this.bodyB,d=this.coneEquation,y=this.twistEquation;super.update(),r.vectorToWorldFrame(this.axisA,d.axisA),h.vectorToWorldFrame(this.axisB,d.axisB),this.axisA.tangents(y.axisA,y.axisA),r.vectorToWorldFrame(y.axisA,y.axisA),this.axisB.tangents(y.axisB,y.axisB),h.vectorToWorldFrame(y.axisB,y.axisB),d.angle=this.angle,y.maxAngle=this.twistAngle}}class fs extends pu{constructor(r,h,d,y=1e6){super(r,h),void 0===d&&(d=r.position.distanceTo(h.position)),this.distance=d;const b=this.distanceEquation=new To(r,h);this.equations.push(b),b.minForce=-y,b.maxForce=y}update(){const d=this.distanceEquation,y=.5*this.distance,b=d.ni;this.bodyB.position.vsub(this.bodyA.position,b),b.normalize(),b.scale(y,d.ri),b.scale(-y,d.rj)}}class Dl extends ic{constructor(r,h,d={}){const y=void 0!==d.maxForce?d.maxForce:1e6,b=new A,R=new A,k=new A;r.position.vadd(h.position,k),k.scale(.5,k),h.pointToLocalFrame(k,R),r.pointToLocalFrame(k,b),super(r,b,h,R,y),this.xA=r.vectorToLocalFrame(A.UNIT_X),this.xB=h.vectorToLocalFrame(A.UNIT_X),this.yA=r.vectorToLocalFrame(A.UNIT_Y),this.yB=h.vectorToLocalFrame(A.UNIT_Y),this.zA=r.vectorToLocalFrame(A.UNIT_Z),this.zB=h.vectorToLocalFrame(A.UNIT_Z);const M=this.rotationalEquation1=new vl(r,h,d),H=this.rotationalEquation2=new vl(r,h,d),X=this.rotationalEquation3=new vl(r,h,d);this.equations.push(M,H,X)}update(){const r=this.bodyA,h=this.bodyB,d=this.rotationalEquation1,y=this.rotationalEquation2,b=this.rotationalEquation3;super.update(),r.vectorToWorldFrame(this.xA,d.axisA),h.vectorToWorldFrame(this.yB,d.axisB),r.vectorToWorldFrame(this.yA,y.axisA),h.vectorToWorldFrame(this.zB,y.axisB),r.vectorToWorldFrame(this.zA,b.axisA),h.vectorToWorldFrame(this.xB,b.axisB)}}class ju extends Es{constructor(r,h,d=1e6){super(r,h,-d,d),this.axisA=new A,this.axisB=new A,this.targetVelocity=0}computeB(r){const h=this.b,y=this.axisB,R=this.jacobianElementB;return this.jacobianElementA.rotational.copy(this.axisA),y.negate(R.rotational),-(this.computeGW()-this.targetVelocity)*h-r*this.computeGiMf()}}class _p extends ic{constructor(r,h,d={}){const y=void 0!==d.maxForce?d.maxForce:1e6;super(r,d.pivotA?d.pivotA.clone():new A,h,d.pivotB?d.pivotB.clone():new A,y),(this.axisA=d.axisA?d.axisA.clone():new A(1,0,0)).normalize(),(this.axisB=d.axisB?d.axisB.clone():new A(1,0,0)).normalize(),this.collideConnected=!!d.collideConnected;const b=this.rotationalEquation1=new vl(r,h,d),R=this.rotationalEquation2=new vl(r,h,d),k=this.motorEquation=new ju(r,h,y);k.enabled=!1,this.equations.push(b,R,k)}enableMotor(){this.motorEquation.enabled=!0}disableMotor(){this.motorEquation.enabled=!1}setMotorSpeed(r){this.motorEquation.targetVelocity=r}setMotorMaxForce(r){this.motorEquation.maxForce=r,this.motorEquation.minForce=-r}update(){const r=this.bodyA,h=this.bodyB,d=this.motorEquation,y=this.rotationalEquation1,b=this.rotationalEquation2,R=gp,k=kc,M=this.axisA,H=this.axisB;super.update(),r.quaternion.vmult(M,R),h.quaternion.vmult(H,k),R.tangents(y.axisA,b.axisA),y.axisB.copy(k),b.axisB.copy(k),this.motorEquation.enabled&&(r.quaternion.vmult(this.axisA,d.axisA),h.quaternion.vmult(this.axisB,d.axisB))}}const gp=new A,kc=new A;class oc extends Es{constructor(r,h,d){super(r,h,-d,d),this.ri=new A,this.rj=new A,this.t=new A}computeB(r){const h=this.b,y=this.rj,b=bh,R=vp,k=this.t;this.ri.cross(k,b),y.cross(k,R);const M=this.jacobianElementA,H=this.jacobianElementB;return k.negate(M.spatial),b.negate(M.rotational),H.spatial.copy(k),H.rotational.copy(R),-this.computeGW()*h-r*this.computeGiMf()}}const bh=new A,vp=new A;class Gu{constructor(r,h,d){d=Du.defaults(d,{friction:.3,restitution:.3,contactEquationStiffness:1e7,contactEquationRelaxation:3,frictionEquationStiffness:1e7,frictionEquationRelaxation:3}),this.id=Gu.idCounter++,this.materials=[r,h],this.friction=d.friction,this.restitution=d.restitution,this.contactEquationStiffness=d.contactEquationStiffness,this.contactEquationRelaxation=d.contactEquationRelaxation,this.frictionEquationStiffness=d.frictionEquationStiffness,this.frictionEquationRelaxation=d.frictionEquationRelaxation}}Gu.idCounter=0;class Hu{constructor(r={}){let h="";"string"==typeof r&&(h=r,r={}),this.name=h,this.id=Hu.idCounter++,this.friction=void 0!==r.friction?r.friction:-1,this.restitution=void 0!==r.restitution?r.restitution:-1}}Hu.idCounter=0;class Za{constructor(r,h,d={}){this.restLength="number"==typeof d.restLength?d.restLength:1,this.stiffness=d.stiffness||100,this.damping=d.damping||1,this.bodyA=r,this.bodyB=h,this.localAnchorA=new A,this.localAnchorB=new A,d.localAnchorA&&this.localAnchorA.copy(d.localAnchorA),d.localAnchorB&&this.localAnchorB.copy(d.localAnchorB),d.worldAnchorA&&this.setWorldAnchorA(d.worldAnchorA),d.worldAnchorB&&this.setWorldAnchorB(d.worldAnchorB)}setWorldAnchorA(r){this.bodyA.pointToLocalFrame(r,this.localAnchorA)}setWorldAnchorB(r){this.bodyB.pointToLocalFrame(r,this.localAnchorB)}getWorldAnchorA(r){this.bodyA.pointToWorldFrame(this.localAnchorA,r)}getWorldAnchorB(r){this.bodyB.pointToWorldFrame(this.localAnchorB,r)}applyForce(){const r=this.stiffness,h=this.damping,d=this.restLength,y=this.bodyA,b=this.bodyB,R=Hh,k=Qa,M=Vh,H=Vu,X=Dc,oe=sc,ne=ac,ge=xh,we=mu,Se=Fc,Ce=yp;this.getWorldAnchorA(oe),this.getWorldAnchorB(ne),oe.vsub(y.position,ge),ne.vsub(b.position,we),ne.vsub(oe,R);const Pe=R.length();k.copy(R),k.normalize(),b.velocity.vsub(y.velocity,M),b.angularVelocity.cross(we,X),M.vadd(X,M),y.angularVelocity.cross(ge,X),M.vsub(X,M),k.scale(-r*(Pe-d)-h*M.dot(k),H),y.force.vsub(H,y.force),b.force.vadd(H,b.force),ge.cross(H,Se),we.cross(H,Ce),y.torque.vsub(Se,y.torque),b.torque.vadd(Ce,b.torque)}}const Hh=new A,Qa=new A,Vh=new A,Vu=new A,sc=new A,ac=new A,xh=new A,mu=new A,Fc=new A,yp=new A,Dc=new A;class Wu{constructor(r={}){r=Du.defaults(r,{chassisConnectionPointLocal:new A,chassisConnectionPointWorld:new A,directionLocal:new A,directionWorld:new A,axleLocal:new A,axleWorld:new A,suspensionRestLength:1,suspensionMaxLength:2,radius:1,suspensionStiffness:100,dampingCompression:10,dampingRelaxation:10,frictionSlip:1e4,steering:0,rotation:0,deltaRotation:0,rollInfluence:.01,maxSuspensionForce:Number.MAX_VALUE,isFrontWheel:!0,clippedInvContactDotSuspension:1,suspensionRelativeVelocity:0,suspensionForce:0,slipInfo:0,skidInfo:0,suspensionLength:0,maxSuspensionTravel:1,useCustomSlidingRotationalSpeed:!1,customSlidingRotationalSpeed:-.1}),this.maxSuspensionTravel=r.maxSuspensionTravel,this.customSlidingRotationalSpeed=r.customSlidingRotationalSpeed,this.useCustomSlidingRotationalSpeed=r.useCustomSlidingRotationalSpeed,this.sliding=!1,this.chassisConnectionPointLocal=r.chassisConnectionPointLocal.clone(),this.chassisConnectionPointWorld=r.chassisConnectionPointWorld.clone(),this.directionLocal=r.directionLocal.clone(),this.directionWorld=r.directionWorld.clone(),this.axleLocal=r.axleLocal.clone(),this.axleWorld=r.axleWorld.clone(),this.suspensionRestLength=r.suspensionRestLength,this.suspensionMaxLength=r.suspensionMaxLength,this.radius=r.radius,this.suspensionStiffness=r.suspensionStiffness,this.dampingCompression=r.dampingCompression,this.dampingRelaxation=r.dampingRelaxation,this.frictionSlip=r.frictionSlip,this.steering=0,this.rotation=0,this.deltaRotation=0,this.rollInfluence=r.rollInfluence,this.maxSuspensionForce=r.maxSuspensionForce,this.engineForce=0,this.brake=0,this.isFrontWheel=r.isFrontWheel,this.clippedInvContactDotSuspension=1,this.suspensionRelativeVelocity=0,this.suspensionForce=0,this.slipInfo=0,this.skidInfo=0,this.suspensionLength=0,this.sideImpulse=0,this.forwardImpulse=0,this.raycastResult=new pi,this.worldTransform=new F,this.isInContact=!1}updateWheel(r){const h=this.raycastResult;if(this.isInContact){const d=h.hitNormalWorld.dot(h.directionWorld);h.hitPointWorld.vsub(r.position,bp),r.getVelocityAtWorldPoint(bp,Ul);const y=h.hitNormalWorld.dot(Ul);if(d>=-.1)this.suspensionRelativeVelocity=0,this.clippedInvContactDotSuspension=10;else{const b=-1/d;this.suspensionRelativeVelocity=y*b,this.clippedInvContactDotSuspension=b}}else h.suspensionLength=this.suspensionRestLength,this.suspensionRelativeVelocity=0,h.directionWorld.scale(-1,h.hitNormalWorld),this.clippedInvContactDotSuspension=1}}const Ul=new A,bp=new A;class Wh{constructor(r){this.chassisBody=r.chassisBody,this.wheelInfos=[],this.sliding=!1,this.world=null,this.indexRightAxis=void 0!==r.indexRightAxis?r.indexRightAxis:1,this.indexForwardAxis=void 0!==r.indexForwardAxis?r.indexForwardAxis:0,this.indexUpAxis=void 0!==r.indexUpAxis?r.indexUpAxis:2,this.constraints=[],this.preStepCallback=()=>{},this.currentVehicleSpeedKmHour=0}addWheel(r={}){const h=new Wu(r),d=this.wheelInfos.length;return this.wheelInfos.push(h),d}setSteeringValue(r,h){this.wheelInfos[h].steering=r}applyEngineForce(r,h){this.wheelInfos[h].engineForce=r}setBrake(r,h){this.wheelInfos[h].brake=r}addToWorld(r){r.addBody(this.chassisBody);const h=this;this.preStepCallback=()=>{h.updateVehicle(r.dt)},r.addEventListener("preStep",this.preStepCallback),this.world=r}getVehicleAxisWorld(r,h){h.set(0===r?1:0,1===r?1:0,2===r?1:0),this.chassisBody.vectorToWorldFrame(h,h)}updateVehicle(r){const h=this.wheelInfos,d=h.length,y=this.chassisBody;for(let oe=0;oe<d;oe++)this.updateWheelTransform(oe);this.currentVehicleSpeedKmHour=3.6*y.velocity.length();const b=new A;this.getVehicleAxisWorld(this.indexForwardAxis,b),b.dot(y.velocity)<0&&(this.currentVehicleSpeedKmHour*=-1);for(let oe=0;oe<d;oe++)this.castRay(h[oe]);this.updateSuspension(r);const R=new A,k=new A;for(let oe=0;oe<d;oe++){const ne=h[oe];let ge=ne.suspensionForce;ge>ne.maxSuspensionForce&&(ge=ne.maxSuspensionForce),ne.raycastResult.hitNormalWorld.scale(ge*r,R),ne.raycastResult.hitPointWorld.vsub(y.position,k),y.applyImpulse(R,k)}this.updateFriction(r);const M=new A,H=new A,X=new A;for(let oe=0;oe<d;oe++){const ne=h[oe];y.getVelocityAtWorldPoint(ne.chassisConnectionPointWorld,X);let ge=1;if(1===this.indexUpAxis&&(ge=-1),ne.isInContact){this.getVehicleAxisWorld(this.indexForwardAxis,H);const we=H.dot(ne.raycastResult.hitNormalWorld);ne.raycastResult.hitNormalWorld.scale(we,M),H.vsub(M,H);const Se=H.dot(X);ne.deltaRotation=ge*Se*r/ne.radius}!ne.sliding&&ne.isInContact||0===ne.engineForce||!ne.useCustomSlidingRotationalSpeed||(ne.deltaRotation=(ne.engineForce>0?1:-1)*ne.customSlidingRotationalSpeed*r),Math.abs(ne.brake)>Math.abs(ne.engineForce)&&(ne.deltaRotation=0),ne.rotation+=ne.deltaRotation,ne.deltaRotation*=.99}}updateSuspension(r){const h=this.chassisBody.mass,d=this.wheelInfos,y=d.length;for(let b=0;b<y;b++){const R=d[b];if(R.isInContact){let k;k=R.suspensionStiffness*(R.suspensionRestLength-R.suspensionLength)*R.clippedInvContactDotSuspension;const H=R.suspensionRelativeVelocity;let X;X=H<0?R.dampingCompression:R.dampingRelaxation,k-=X*H,R.suspensionForce=k*h,R.suspensionForce<0&&(R.suspensionForce=0)}else R.suspensionForce=0}}removeFromWorld(r){r.removeBody(this.chassisBody),r.removeEventListener("preStep",this.preStepCallback),this.world=null}castRay(r){const h=Kp,d=_u;this.updateWheelTransformWorld(r);const y=this.chassisBody;let b=-1;r.directionWorld.scale(r.suspensionRestLength+r.radius,h);const k=r.chassisConnectionPointWorld;k.vadd(h,d);const M=r.raycastResult;M.reset();const H=y.collisionResponse;y.collisionResponse=!1,this.world.rayTest(k,d,M),y.collisionResponse=H;const X=M.body;if(r.raycastResult.groundObject=0,X){b=M.distance,r.raycastResult.hitNormalWorld=M.hitNormalWorld,r.isInContact=!0,r.suspensionLength=M.distance-r.radius;const ne=r.suspensionRestLength-r.maxSuspensionTravel,ge=r.suspensionRestLength+r.maxSuspensionTravel;r.suspensionLength<ne&&(r.suspensionLength=ne),r.suspensionLength>ge&&(r.suspensionLength=ge,r.raycastResult.reset());const we=r.raycastResult.hitNormalWorld.dot(r.directionWorld),Se=new A;y.getVelocityAtWorldPoint(r.raycastResult.hitPointWorld,Se);const Ce=r.raycastResult.hitNormalWorld.dot(Se);if(we>=-.1)r.suspensionRelativeVelocity=0,r.clippedInvContactDotSuspension=10;else{const Pe=-1/we;r.suspensionRelativeVelocity=Ce*Pe,r.clippedInvContactDotSuspension=Pe}}else r.suspensionLength=r.suspensionRestLength+0*r.maxSuspensionTravel,r.suspensionRelativeVelocity=0,r.directionWorld.scale(-1,r.raycastResult.hitNormalWorld),r.clippedInvContactDotSuspension=1;return b}updateWheelTransformWorld(r){r.isInContact=!1;const h=this.chassisBody;h.pointToWorldFrame(r.chassisConnectionPointLocal,r.chassisConnectionPointWorld),h.vectorToWorldFrame(r.directionLocal,r.directionWorld),h.vectorToWorldFrame(r.axleLocal,r.axleWorld)}updateWheelTransform(r){const h=xp,d=wp,y=qh,b=this.wheelInfos[r];this.updateWheelTransformWorld(b),b.directionLocal.scale(-1,h),d.copy(b.axleLocal),h.cross(d,y),y.normalize(),d.normalize();const R=b.steering,k=new pe;k.setFromAxisAngle(h,R);const M=new pe;M.setFromAxisAngle(d,b.rotation);const H=b.worldTransform.quaternion;this.chassisBody.quaternion.mult(k,H),H.mult(M,H),H.normalize();const X=b.worldTransform.position;X.copy(b.directionWorld),X.scale(b.suspensionLength,X),X.vadd(b.chassisConnectionPointWorld,X)}getWheelTransformWorld(r){return this.wheelInfos[r].worldTransform}updateFriction(r){const h=lc,d=this.wheelInfos,y=d.length,b=this.chassisBody,R=jl,k=zl;for(let M=0;M<y;M++){const H=d[M];H.sideImpulse=0,H.forwardImpulse=0,R[M]||(R[M]=new A),k[M]||(k[M]=new A)}for(let M=0;M<y;M++){const H=d[M],X=H.raycastResult.body;if(X){const oe=k[M];this.getWheelTransformWorld(M).vectorToWorldFrame(Pa[this.indexRightAxis],oe);const ne=H.raycastResult.hitNormalWorld,ge=oe.dot(ne);ne.scale(ge,h),oe.vsub(h,oe),oe.normalize(),ne.cross(oe,R[M]),R[M].normalize(),H.sideImpulse=Yh(b,H.raycastResult.hitPointWorld,X,H.raycastResult.hitPointWorld,oe),H.sideImpulse*=qu}}this.sliding=!1;for(let M=0;M<y;M++){const H=d[M],X=H.raycastResult.body;let oe=0;if(H.slipInfo=1,X){const ge=H.brake?H.brake:0;oe=Xu(b,X,H.raycastResult.hitPointWorld,R[M],ge),oe+=H.engineForce*r,H.slipInfo*=ge/oe}if(H.forwardImpulse=0,H.skidInfo=1,X){H.skidInfo=1;const ne=H.suspensionForce*r*H.frictionSlip,ge=ne*ne;H.forwardImpulse=oe;const we=.5*H.forwardImpulse,Se=1*H.sideImpulse,Ce=we*we+Se*Se;if(H.sliding=!1,Ce>ge){this.sliding=!0,H.sliding=!0;const Pe=ne/Math.sqrt(Ce);H.skidInfo*=Pe}}}if(this.sliding)for(let M=0;M<y;M++){const H=d[M];0!==H.sideImpulse&&H.skidInfo<1&&(H.forwardImpulse*=H.skidInfo,H.sideImpulse*=H.skidInfo)}for(let M=0;M<y;M++){const H=d[M],X=new A;if(H.raycastResult.hitPointWorld.vsub(b.position,X),0!==H.forwardImpulse){const oe=new A;R[M].scale(H.forwardImpulse,oe),b.applyImpulse(oe,X)}if(0!==H.sideImpulse){const oe=H.raycastResult.body,ne=new A;H.raycastResult.hitPointWorld.vsub(oe.position,ne);const ge=new A;k[M].scale(H.sideImpulse,ge),b.vectorToLocalFrame(X,X),X["xyz"[this.indexUpAxis]]*=H.rollInfluence,b.vectorToWorldFrame(X,X),b.applyImpulse(ge,X),ge.scale(-1,ge),oe.applyImpulse(ge,ne)}}}}const xp=new A,wp=new A,qh=new A,Kp=(new Nr,new A),_u=new A,Pa=[new A(1,0,0),new A(0,1,0),new A(0,0,1)],lc=new A,zl=[],jl=[],qu=1,va=new A,ta=new A,xl=new A;function Xu(a,r,h,d,y){let b=0;const R=h,k=va,M=ta,H=xl;return a.getVelocityAtWorldPoint(R,k),r.getVelocityAtWorldPoint(R,M),k.vsub(M,H),b=-d.dot(H)*(1/(Qi(a,h,d)+Qi(r,h,d))),y<b&&(b=y),b<-y&&(b=-y),b}const Yu=new A,Xh=new A,Sp=new A,Ep=new A;function Qi(a,r,h){const d=Yu,y=Xh,b=Sp,R=Ep;return r.vsub(a.position,d),d.cross(h,y),a.invInertiaWorld.vmult(y,R),R.cross(d,b),a.invMass+h.dot(b)}const Ka=new A,Gl=new A,Uc=new A;function Yh(a,r,h,d,y){if(y.lengthSquared()>1.1)return 0;const b=Ka,R=Gl,k=Uc;return a.getVelocityAtWorldPoint(r,b),h.getVelocityAtWorldPoint(d,R),b.vsub(R,k),-.2*y.dot(k)*(1/(a.invMass+h.invMass))}class cc extends ee{constructor(r){if(super({type:ee.types.SPHERE}),this.radius=void 0!==r?r:1,this.radius<0)throw new Error("The sphere radius cannot be negative.");this.updateBoundingSphereRadius()}calculateLocalInertia(r,h=new A){const d=2*r*this.radius*this.radius/5;return h.x=d,h.y=d,h.z=d,h}volume(){return 4*Math.PI*Math.pow(this.radius,3)/3}updateBoundingSphereRadius(){this.boundingSphereRadius=this.radius}calculateWorldAABB(r,h,d,y){const b=this.radius,R=["x","y","z"];for(let k=0;k<R.length;k++){const M=R[k];d[M]=r[M]-b,y[M]=r[M]+b}}}class Ju{constructor(r={}){this.wheelBodies=[],this.coordinateSystem=void 0!==r.coordinateSystem?r.coordinateSystem.clone():new A(1,2,3),this.chassisBody=r.chassisBody?r.chassisBody:new at({mass:1,shape:new Fe(new A(5,2,.5))}),this.constraints=[],this.wheelAxes=[],this.wheelForces=[]}addWheel(r={}){let h;h=r.body?r.body:new at({mass:1,shape:new cc(1.2)}),this.wheelBodies.push(h),this.wheelForces.push(0);const d=void 0!==r.position?r.position.clone():new A,y=new A;this.chassisBody.pointToWorldFrame(d,y),h.position.set(y.x,y.y,y.z);const b=void 0!==r.axis?r.axis.clone():new A(0,1,0);this.wheelAxes.push(b);const R=new _p(this.chassisBody,h,{pivotA:d,axisA:b,pivotB:A.ZERO,axisB:b,collideConnected:!1});return this.constraints.push(R),this.wheelBodies.length-1}setSteeringValue(r,h){const d=this.wheelAxes[h],y=Math.cos(r),b=Math.sin(r),R=d.x,k=d.y;this.constraints[h].axisA.set(y*R-b*k,b*R+y*k,0)}setMotorSpeed(r,h){const d=this.constraints[h];d.enableMotor(),d.motorTargetVelocity=r}disableMotor(r){this.constraints[r].disableMotor()}setWheelForce(r,h){this.wheelForces[h]=r}applyWheelForce(r,h){const y=this.wheelBodies[h],b=y.torque;this.wheelAxes[h].scale(r,gu),y.vectorToWorldFrame(gu,gu),b.vadd(gu,b)}addToWorld(r){const h=this.constraints,d=this.wheelBodies.concat([this.chassisBody]);for(let y=0;y<d.length;y++)r.addBody(d[y]);for(let y=0;y<h.length;y++)r.addConstraint(h[y]);r.addEventListener("preStep",this._update.bind(this))}_update(){const r=this.wheelForces;for(let h=0;h<r.length;h++)this.applyWheelForce(r[h],h)}removeFromWorld(r){const h=this.constraints,d=this.wheelBodies.concat([this.chassisBody]);for(let y=0;y<d.length;y++)r.removeBody(d[y]);for(let y=0;y<h.length;y++)r.removeConstraint(h[y])}getWheelSpeed(r){const d=this.wheelBodies[r].angularVelocity;return this.chassisBody.vectorToWorldFrame(this.wheelAxes[r],W),d.dot(W)}}const gu=new A,W=new A;class ue{constructor(){this.particles=[],this.density=1,this.smoothingRadius=1,this.speedOfSound=1,this.viscosity=.01,this.eps=1e-6,this.pressures=[],this.densities=[],this.neighbors=[]}add(r){this.particles.push(r),this.neighbors.length<this.particles.length&&this.neighbors.push([])}remove(r){const h=this.particles.indexOf(r);-1!==h&&(this.particles.splice(h,1),this.neighbors.length>this.particles.length&&this.neighbors.pop())}getNeighbors(r,h){const d=this.particles.length,y=r.id,b=this.smoothingRadius*this.smoothingRadius,R=Te;for(let k=0;k!==d;k++){const M=this.particles[k];M.position.vsub(r.position,R),y!==M.id&&R.lengthSquared()<b&&h.push(M)}}update(){const r=this.particles.length,h=Le,d=this.speedOfSound,y=this.eps;for(let X=0;X!==r;X++){const oe=this.particles[X],ne=this.neighbors[X];ne.length=0,this.getNeighbors(oe,ne),ne.push(this.particles[X]);const ge=ne.length;let we=0;for(let Se=0;Se!==ge;Se++){oe.position.vsub(ne[Se].position,h);const Ce=h.length(),Pe=this.w(Ce);we+=ne[Se].mass*Pe}this.densities[X]=we,this.pressures[X]=d*d*(this.densities[X]-this.density)}const b=He,R=Ve,k=Qe,M=Et,H=At;for(let X=0;X!==r;X++){const oe=this.particles[X];let ne,ge;b.set(0,0,0),R.set(0,0,0);const we=this.neighbors[X],Se=we.length;for(let Ce=0;Ce!==Se;Ce++){const Pe=we[Ce];oe.position.vsub(Pe.position,M);const Re=M.length();ne=-Pe.mass*(this.pressures[X]/(this.densities[X]*this.densities[X]+y)+this.pressures[Ce]/(this.densities[Ce]*this.densities[Ce]+y)),this.gradw(M,k),k.scale(ne,k),b.vadd(k,b),Pe.velocity.vsub(oe.velocity,H),H.scale(1/(1e-4+this.densities[X]*this.densities[Ce])*this.viscosity*Pe.mass,H),ge=this.nablaw(Re),H.scale(ge,H),R.vadd(H,R)}R.scale(oe.mass,R),b.scale(oe.mass,b),oe.force.vadd(R,oe.force),oe.force.vadd(b,oe.force)}}w(r){const h=this.smoothingRadius;return 315/(64*Math.PI*h**9)*(h*h-r*r)**3}gradw(r,h){const d=r.length(),y=this.smoothingRadius;r.scale(945/(32*Math.PI*y**9)*(y*y-d*d)**2,h)}nablaw(r){const h=this.smoothingRadius;return 945/(32*Math.PI*h**9)*(h*h-r*r)*(7*r*r-3*h*h)}}const Te=new A,Le=new A,He=new A,Ve=new A,Qe=new A,Et=new A,At=new A;class Xt extends K{constructor(r,h,d,y){const b=y,R=[],k=[],M=[],H=[],X=[],oe=Math.cos,ne=Math.sin;R.push(new A(h*oe(0),h*ne(0),.5*-d)),H.push(0),R.push(new A(r*oe(0),r*ne(0),.5*d)),X.push(1);for(let we=0;we<b;we++){const Se=2*Math.PI/b*(we+1),Ce=2*Math.PI/b*(we+.5);we<b-1?(R.push(new A(h*oe(Se),h*ne(Se),.5*-d)),H.push(2*we+2),R.push(new A(r*oe(Se),r*ne(Se),.5*d)),X.push(2*we+3),M.push([2*we+2,2*we+3,2*we+1,2*we])):M.push([0,1,2*we+1,2*we]),(b%2==1||we<b/2)&&k.push(new A(oe(Ce),ne(Ce),0))}M.push(X),k.push(new A(0,0,1));const ge=[];for(let we=0;we<H.length;we++)ge.push(H[H.length-we-1]);M.push(ge),super({vertices:R,faces:M,axes:k})}}class fn extends ee{constructor(){super({type:ee.types.PARTICLE})}calculateLocalInertia(r,h=new A){return h.set(0,0,0),h}volume(){return 0}updateBoundingSphereRadius(){this.boundingSphereRadius=0}calculateWorldAABB(r,h,d,y){d.copy(r),y.copy(r)}}class In extends ee{constructor(){super({type:ee.types.PLANE}),this.worldNormal=new A,this.worldNormalNeedsUpdate=!0,this.boundingSphereRadius=Number.MAX_VALUE}computeWorldNormal(r){const h=this.worldNormal;h.set(0,0,1),r.vmult(h,h),this.worldNormalNeedsUpdate=!1}calculateLocalInertia(r,h=new A){return h}volume(){return Number.MAX_VALUE}calculateWorldAABB(r,h,d,y){nn.set(0,0,1),h.vmult(nn,nn);const b=Number.MAX_VALUE;d.set(-b,-b,-b),y.set(b,b,b),1===nn.x?y.x=r.x:-1===nn.x&&(d.x=r.x),1===nn.y?y.y=r.y:-1===nn.y&&(d.y=r.y),1===nn.z?y.z=r.z:-1===nn.z&&(d.z=r.z)}updateBoundingSphereRadius(){this.boundingSphereRadius=Number.MAX_VALUE}}const nn=new A;class xn extends ee{constructor(r,h={}){h=Du.defaults(h,{maxValue:null,minValue:null,elementSize:1}),super({type:ee.types.HEIGHTFIELD}),this.data=r,this.maxValue=h.maxValue,this.minValue=h.minValue,this.elementSize=h.elementSize,null===h.minValue&&this.updateMinValue(),null===h.maxValue&&this.updateMaxValue(),this.cacheEnabled=!0,this.pillarConvex=new K,this.pillarOffset=new A,this.updateBoundingSphereRadius(),this._cachedPillars={}}update(){this._cachedPillars={}}updateMinValue(){const r=this.data;let h=r[0][0];for(let d=0;d!==r.length;d++)for(let y=0;y!==r[d].length;y++){const b=r[d][y];b<h&&(h=b)}this.minValue=h}updateMaxValue(){const r=this.data;let h=r[0][0];for(let d=0;d!==r.length;d++)for(let y=0;y!==r[d].length;y++){const b=r[d][y];b>h&&(h=b)}this.maxValue=h}setHeightValueAtIndex(r,h,d){this.data[r][h]=d,this.clearCachedConvexTrianglePillar(r,h,!1),r>0&&(this.clearCachedConvexTrianglePillar(r-1,h,!0),this.clearCachedConvexTrianglePillar(r-1,h,!1)),h>0&&(this.clearCachedConvexTrianglePillar(r,h-1,!0),this.clearCachedConvexTrianglePillar(r,h-1,!1)),h>0&&r>0&&this.clearCachedConvexTrianglePillar(r-1,h-1,!0)}getRectMinMax(r,h,d,y,b=[]){const R=this.data;let k=this.minValue;for(let M=r;M<=d;M++)for(let H=h;H<=y;H++){const X=R[M][H];X>k&&(k=X)}b[0]=this.minValue,b[1]=k}getIndexOfPosition(r,h,d,y){const b=this.elementSize,R=this.data;let k=Math.floor(r/b),M=Math.floor(h/b);return d[0]=k,d[1]=M,y&&(k<0&&(k=0),M<0&&(M=0),k>=R.length-1&&(k=R.length-1),M>=R[0].length-1&&(M=R[0].length-1)),!(k<0||M<0||k>=R.length-1||M>=R[0].length-1)}getTriangleAt(r,h,d,y,b,R){const k=Er;this.getIndexOfPosition(r,h,k,d);let M=k[0],H=k[1];const X=this.data;d&&(M=Math.min(X.length-2,Math.max(0,M)),H=Math.min(X[0].length-2,Math.max(0,H)));const oe=this.elementSize,ne=(r/oe-M)**2+(h/oe-H)**2>(r/oe-(M+1))**2+(h/oe-(H+1))**2;return this.getTriangle(M,H,ne,y,b,R),ne}getNormalAt(r,h,d,y){const b=na,R=_i,k=Lr,M=Ia,H=Xi;this.getTriangleAt(r,h,d,b,R,k),R.vsub(b,M),k.vsub(b,H),M.cross(H,y),y.normalize()}getAabbAtIndex(r,h,{lowerBound:d,upperBound:y}){const b=this.data,R=this.elementSize;d.set(r*R,h*R,b[r][h]),y.set((r+1)*R,(h+1)*R,b[r+1][h+1])}getHeightAt(r,h,d){const y=this.data,b=Ar,R=ms,k=Ko,M=Er;this.getIndexOfPosition(r,h,M,d);let H=M[0],X=M[1];d&&(H=Math.min(y.length-2,Math.max(0,H)),X=Math.min(y[0].length-2,Math.max(0,X)));const oe=this.getTriangleAt(r,h,d,b,R,k);var ge,we,Se,Ce,Pe,Re,Oe,Ge,ke;return(ke=Kr).x=(((Re=R.y)-(Ge=k.y))*((ge=r)-(Oe=k.x))+(Oe-(Pe=R.x))*((we=h)-Ge))/((Re-Ge)*((Se=b.x)-Oe)+(Oe-Pe)*((Ce=b.y)-Ge)),ke.y=((Ge-Ce)*(ge-Oe)+(Se-Oe)*(we-Ge))/((Re-Ge)*(Se-Oe)+(Oe-Pe)*(Ce-Ge)),ke.z=1-ke.x-ke.y,oe?y[H+1][X+1]*Kr.x+y[H][X+1]*Kr.y+y[H+1][X]*Kr.z:y[H][X]*Kr.x+y[H+1][X]*Kr.y+y[H][X+1]*Kr.z}getCacheConvexTrianglePillarKey(r,h,d){return r+"_"+h+"_"+(d?1:0)}getCachedConvexTrianglePillar(r,h,d){return this._cachedPillars[this.getCacheConvexTrianglePillarKey(r,h,d)]}setCachedConvexTrianglePillar(r,h,d,y,b){this._cachedPillars[this.getCacheConvexTrianglePillarKey(r,h,d)]={convex:y,offset:b}}clearCachedConvexTrianglePillar(r,h,d){delete this._cachedPillars[this.getCacheConvexTrianglePillarKey(r,h,d)]}getTriangle(r,h,d,y,b,R){const k=this.data,M=this.elementSize;d?(y.set((r+1)*M,(h+1)*M,k[r+1][h+1]),b.set(r*M,(h+1)*M,k[r][h+1]),R.set((r+1)*M,h*M,k[r+1][h])):(y.set(r*M,h*M,k[r][h]),b.set((r+1)*M,h*M,k[r+1][h]),R.set(r*M,(h+1)*M,k[r][h+1]))}getConvexTrianglePillar(r,h,d){let y=this.pillarConvex,b=this.pillarOffset;if(this.cacheEnabled){const oe=this.getCachedConvexTrianglePillar(r,h,d);if(oe)return this.pillarConvex=oe.convex,void(this.pillarOffset=oe.offset);y=new K,b=new A,this.pillarConvex=y,this.pillarOffset=b}const R=this.data,k=this.elementSize,M=y.faces;y.vertices.length=6;for(let oe=0;oe<6;oe++)y.vertices[oe]||(y.vertices[oe]=new A);M.length=5;for(let oe=0;oe<5;oe++)M[oe]||(M[oe]=[]);const H=y.vertices,X=(Math.min(R[r][h],R[r+1][h],R[r][h+1],R[r+1][h+1])-this.minValue)/2+this.minValue;d?(b.set((r+.75)*k,(h+.75)*k,X),H[0].set(.25*k,.25*k,R[r+1][h+1]-X),H[1].set(-.75*k,.25*k,R[r][h+1]-X),H[2].set(.25*k,-.75*k,R[r+1][h]-X),H[3].set(.25*k,.25*k,-X-1),H[4].set(-.75*k,.25*k,-X-1),H[5].set(.25*k,-.75*k,-X-1),M[0][0]=0,M[0][1]=1,M[0][2]=2,M[1][0]=5,M[1][1]=4,M[1][2]=3,M[2][0]=2,M[2][1]=5,M[2][2]=3,M[2][3]=0,M[3][0]=3,M[3][1]=4,M[3][2]=1,M[3][3]=0,M[4][0]=1,M[4][1]=4,M[4][2]=5,M[4][3]=2):(b.set((r+.25)*k,(h+.25)*k,X),H[0].set(-.25*k,-.25*k,R[r][h]-X),H[1].set(.75*k,-.25*k,R[r+1][h]-X),H[2].set(-.25*k,.75*k,R[r][h+1]-X),H[3].set(-.25*k,-.25*k,-X-1),H[4].set(.75*k,-.25*k,-X-1),H[5].set(-.25*k,.75*k,-X-1),M[0][0]=0,M[0][1]=1,M[0][2]=2,M[1][0]=5,M[1][1]=4,M[1][2]=3,M[2][0]=0,M[2][1]=2,M[2][2]=5,M[2][3]=3,M[3][0]=1,M[3][1]=0,M[3][2]=3,M[3][3]=4,M[4][0]=4,M[4][1]=5,M[4][2]=2,M[4][3]=1),y.computeNormals(),y.computeEdges(),y.updateBoundingSphereRadius(),this.setCachedConvexTrianglePillar(r,h,d,y,b)}calculateLocalInertia(r,h=new A){return h.set(0,0,0),h}volume(){return Number.MAX_VALUE}calculateWorldAABB(r,h,d,y){d.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),y.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)}updateBoundingSphereRadius(){const r=this.data,h=this.elementSize;this.boundingSphereRadius=new A(r.length*h,r[0].length*h,Math.max(Math.abs(this.maxValue),Math.abs(this.minValue))).length()}setHeightsFromImage(r,h){const{x:d,z:y,y:b}=h,R=document.createElement("canvas");R.width=r.width,R.height=r.height;const k=R.getContext("2d");k.drawImage(r,0,0);const M=k.getImageData(0,0,r.width,r.height),H=this.data;H.length=0,this.elementSize=Math.abs(d)/M.width;for(let X=0;X<M.height;X++){const oe=[];for(let ne=0;ne<M.width;ne++){const ge=(M.data[4*(X*M.height+ne)]+M.data[4*(X*M.height+ne)+1]+M.data[4*(X*M.height+ne)+2])/4/255*y;d<0?oe.push(ge):oe.unshift(ge)}b<0?H.unshift(oe):H.push(oe)}this.updateMaxValue(),this.updateMinValue(),this.update()}}const Er=[],Kr=new A,Ar=new A,ms=new A,Ko=new A,na=new A,_i=new A,Lr=new A,Ia=new A,Xi=new A;class Yi{constructor(r={}){this.root=r.root||null,this.aabb=r.aabb?r.aabb.clone():new te,this.data=[],this.children=[]}reset(){this.children.length=this.data.length=0}insert(r,h,d=0){const y=this.data;if(!this.aabb.contains(r))return!1;const b=this.children;if(d<(this.maxDepth||this.root.maxDepth)){let R=!1;b.length||(this.subdivide(),R=!0);for(let k=0;8!==k;k++)if(b[k].insert(r,h,d+1))return!0;R&&(b.length=0)}return y.push(h),!0}subdivide(){const r=this.aabb,h=r.lowerBound,d=r.upperBound,y=this.children;y.push(new Yi({aabb:new te({lowerBound:new A(0,0,0)})}),new Yi({aabb:new te({lowerBound:new A(1,0,0)})}),new Yi({aabb:new te({lowerBound:new A(1,1,0)})}),new Yi({aabb:new te({lowerBound:new A(1,1,1)})}),new Yi({aabb:new te({lowerBound:new A(0,1,1)})}),new Yi({aabb:new te({lowerBound:new A(0,0,1)})}),new Yi({aabb:new te({lowerBound:new A(1,0,1)})}),new Yi({aabb:new te({lowerBound:new A(0,1,0)})})),d.vsub(h,uc),uc.scale(.5,uc);const b=this.root||this;for(let R=0;8!==R;R++){const k=y[R];k.root=b;const M=k.aabb.lowerBound;M.x*=uc.x,M.y*=uc.y,M.z*=uc.z,M.vadd(h,M),M.vadd(uc,k.aabb.upperBound)}}aabbQuery(r,h){const d=[this];for(;d.length;){const y=d.pop();y.aabb.overlaps(r)&&Array.prototype.push.apply(h,y.data),Array.prototype.push.apply(d,y.children)}return h}rayQuery(r,h,d){return r.getAABB(ra),ra.toLocalFrame(h,ra),this.aabbQuery(ra,d),d}removeEmptyNodes(){for(let r=this.children.length-1;r>=0;r--)this.children[r].removeEmptyNodes(),this.children[r].children.length||this.children[r].data.length||this.children.splice(r,1)}}class Jh extends Yi{constructor(r,h={}){super({root:null,aabb:r}),this.maxDepth=void 0!==h.maxDepth?h.maxDepth:8}}const uc=new A,ra=new te;class el extends ee{constructor(r,h){super({type:ee.types.TRIMESH}),this.vertices=new Float32Array(r),this.indices=new Int16Array(h),this.normals=new Float32Array(h.length),this.aabb=new te,this.edges=null,this.scale=new A(1,1,1),this.tree=new Jh,this.updateEdges(),this.updateNormals(),this.updateAABB(),this.updateBoundingSphereRadius(),this.updateTree()}updateTree(){const r=this.tree;r.reset(),r.aabb.copy(this.aabb);const h=this.scale;r.aabb.lowerBound.x*=1/h.x,r.aabb.lowerBound.y*=1/h.y,r.aabb.lowerBound.z*=1/h.z,r.aabb.upperBound.x*=1/h.x,r.aabb.upperBound.y*=1/h.y,r.aabb.upperBound.z*=1/h.z;const d=new te,y=new A,b=new A,R=new A,k=[y,b,R];for(let M=0;M<this.indices.length/3;M++){const H=3*M;this._getUnscaledVertex(this.indices[H],y),this._getUnscaledVertex(this.indices[H+1],b),this._getUnscaledVertex(this.indices[H+2],R),d.setFromPoints(k),r.insert(d,M)}r.removeEmptyNodes()}getTrianglesInAABB(r,h){Ui.copy(r);const d=this.scale,y=d.x,b=d.y,R=d.z,k=Ui.lowerBound,M=Ui.upperBound;return k.x/=y,k.y/=b,k.z/=R,M.x/=y,M.y/=b,M.z/=R,this.tree.aabbQuery(Ui,h)}setScale(r){this.scale.x===this.scale.y&&this.scale.y===this.scale.z&&r.x===r.y&&r.y===r.z||this.updateNormals(),this.scale.copy(r),this.updateAABB(),this.updateBoundingSphereRadius()}updateNormals(){const r=ia,h=this.normals;for(let d=0;d<this.indices.length/3;d++){const y=3*d,R=this.indices[y+1],k=this.indices[y+2];this.getVertex(this.indices[y],as),this.getVertex(R,Ki),this.getVertex(k,jr),el.computeNormal(Ki,as,jr,r),h[y]=r.x,h[y+1]=r.y,h[y+2]=r.z}}updateEdges(){const r={},h=(y,b)=>{r[y<b?y+"_"+b:b+"_"+y]=!0};for(let y=0;y<this.indices.length/3;y++){const b=3*y,R=this.indices[b],k=this.indices[b+1],M=this.indices[b+2];h(R,k),h(k,M),h(M,R)}const d=Object.keys(r);this.edges=new Int16Array(2*d.length);for(let y=0;y<d.length;y++){const b=d[y].split("_");this.edges[2*y]=parseInt(b[0],10),this.edges[2*y+1]=parseInt(b[1],10)}}getEdgeVertex(r,h,d){this.getVertex(this.edges[2*r+(h?1:0)],d)}getEdgeVector(r,h){const d=Ps,y=rr;this.getEdgeVertex(r,0,d),this.getEdgeVertex(r,1,y),y.vsub(d,h)}getVertex(r,h){const d=this.scale;return this._getUnscaledVertex(r,h),h.x*=d.x,h.y*=d.y,h.z*=d.z,h}_getUnscaledVertex(r,h){const d=3*r,y=this.vertices;return h.set(y[d],y[d+1],y[d+2])}getWorldVertex(r,h,d,y){return this.getVertex(r,y),F.pointToWorldFrame(h,d,y,y),y}getTriangleVertices(r,h,d,y){const b=3*r;this.getVertex(this.indices[b],h),this.getVertex(this.indices[b+1],d),this.getVertex(this.indices[b+2],y)}getNormal(r,h){const d=3*r;return h.set(this.normals[d],this.normals[d+1],this.normals[d+2])}calculateLocalInertia(r,h){this.computeLocalAABB(ui);const d=ui.upperBound.x-ui.lowerBound.x,y=ui.upperBound.y-ui.lowerBound.y,b=ui.upperBound.z-ui.lowerBound.z;return h.set(1/12*r*(2*y*2*y+2*b*2*b),1/12*r*(2*d*2*d+2*b*2*b),1/12*r*(2*y*2*y+2*d*2*d))}computeLocalAABB(r){const h=r.lowerBound,d=r.upperBound,y=this.vertices.length,b=gi;this.getVertex(0,b),h.copy(b),d.copy(b);for(let R=0;R!==y;R++)this.getVertex(R,b),b.x<h.x?h.x=b.x:b.x>d.x&&(d.x=b.x),b.y<h.y?h.y=b.y:b.y>d.y&&(d.y=b.y),b.z<h.z?h.z=b.z:b.z>d.z&&(d.z=b.z)}updateAABB(){this.computeLocalAABB(this.aabb)}updateBoundingSphereRadius(){let r=0;const h=this.vertices,d=new A;for(let y=0,b=h.length/3;y!==b;y++){this.getVertex(y,d);const R=d.lengthSquared();R>r&&(r=R)}this.boundingSphereRadius=Math.sqrt(r)}calculateWorldAABB(r,h,d,y){const b=Is,R=Zh;b.position=r,b.quaternion=h,this.aabb.toWorldFrame(b,R),d.copy(R.lowerBound),y.copy(R.upperBound)}volume(){return 4*Math.PI*this.boundingSphereRadius/3}}const ia=new A,Ui=new te,Ps=new A,rr=new A,wn=new A,jo=new A;el.computeNormal=(a,r,h,d)=>{r.vsub(a,jo),h.vsub(r,wn),wn.cross(jo,d),d.isZero()||d.normalize()};const as=new A,Ki=new A,jr=new A,ui=new te,gi=new A,Is=new F,Zh=new te;el.createTorus=(a=1,r=.5,h=8,d=6,y=2*Math.PI)=>{const b=[],R=[];for(let k=0;k<=h;k++)for(let M=0;M<=d;M++){const H=M/d*y,X=k/h*Math.PI*2,oe=(a+r*Math.cos(X))*Math.cos(H),ne=(a+r*Math.cos(X))*Math.sin(H),ge=r*Math.sin(X);b.push(oe,ne,ge)}for(let k=1;k<=h;k++)for(let M=1;M<=d;M++){const X=(d+1)*(k-1)+M-1,oe=(d+1)*(k-1)+M,ne=(d+1)*k+M;R.push((d+1)*k+M-1,X,ne),R.push(X,oe,ne)}return new el(b,R)};class yo{constructor(){this.equations=[]}solve(r,h){return 0}addEquation(r){r.enabled&&this.equations.push(r)}removeEquation(r){const h=this.equations,d=h.indexOf(r);-1!==d&&h.splice(d,1)}removeAllEquations(){this.equations.length=0}}class vu extends yo{constructor(){super(),this.iterations=10,this.tolerance=1e-7}solve(r,h){let d=0;const y=this.iterations,b=this.tolerance*this.tolerance,R=this.equations,k=R.length,M=h.bodies,H=M.length,X=r;let oe,ne,ge,we,Se,Ce;if(0!==k)for(let Ge=0;Ge!==H;Ge++)M[Ge].updateSolveMassProperties();const Pe=ot,Re=wl,Oe=Un;Pe.length=k,Re.length=k,Oe.length=k;for(let Ge=0;Ge!==k;Ge++){const ke=R[Ge];Oe[Ge]=0,Re[Ge]=ke.computeB(X),Pe[Ge]=1/ke.computeC()}if(0!==k){for(let et=0;et!==H;et++){const rt=M[et],vt=rt.wlambda;rt.vlambda.set(0,0,0),vt.set(0,0,0)}for(d=0;d!==y;d++){we=0;for(let et=0;et!==k;et++){const rt=R[et];oe=Re[et],ne=Pe[et],Ce=Oe[et],Se=rt.computeGWlambda(),ge=ne*(oe-Se-rt.eps*Ce),Ce+ge<rt.minForce?ge=rt.minForce-Ce:Ce+ge>rt.maxForce&&(ge=rt.maxForce-Ce),Oe[et]+=ge,we+=ge>0?ge:-ge,rt.addToWlambda(ge)}if(we*we<b)break}for(let et=0;et!==H;et++){const rt=M[et],ut=rt.velocity,vt=rt.angularVelocity;rt.vlambda.vmul(rt.linearFactor,rt.vlambda),ut.vadd(rt.vlambda,ut),rt.wlambda.vmul(rt.angularFactor,rt.wlambda),vt.vadd(rt.wlambda,vt)}let Ge=R.length;const ke=1/X;for(;Ge--;)R[Ge].multiplier=Oe[Ge]*ke}return d}}const Un=[],ot=[],wl=[];class Ts extends yo{constructor(r){for(super(),this.iterations=10,this.tolerance=1e-7,this.subsolver=r,this.nodes=[],this.nodePool=[];this.nodePool.length<128;)this.nodePool.push(this.createNode())}createNode(){return{body:null,children:[],eqs:[],visited:!1}}solve(r,h){const d=Tp,y=this.nodePool,b=h.bodies,R=this.equations,k=R.length,M=b.length,H=this.subsolver;for(;y.length<M;)y.push(this.createNode());d.length=M;for(let we=0;we<M;we++)d[we]=y[we];for(let we=0;we!==M;we++){const Se=d[we];Se.body=b[we],Se.children.length=0,Se.eqs.length=0,Se.visited=!1}for(let we=0;we!==k;we++){const Se=R[we],Ce=b.indexOf(Se.bi),Pe=b.indexOf(Se.bj),Re=d[Ce],Oe=d[Pe];Re.children.push(Oe),Re.eqs.push(Se),Oe.children.push(Re),Oe.eqs.push(Se)}let X,oe=0,ne=Ms;H.tolerance=this.tolerance,H.iterations=this.iterations;const ge=hc;for(;X=io(d);){ne.length=0,ge.bodies.length=0,zc(X,Li,ge.bodies,ne);const we=ne.length;ne=ne.sort(lt);for(let Se=0;Se!==we;Se++)H.addEquation(ne[Se]);H.solve(r,ge),H.removeAllEquations(),oe++}return oe}}const Tp=[],Ms=[],hc={bodies:[]},Hi=at.STATIC;function io(a){const r=a.length;for(let h=0;h!==r;h++){const d=a[h];if(!(d.visited||d.body.type&Hi))return d}return!1}const ti=[];function zc(a,r,h,d){for(ti.push(a),a.visited=!0,r(a,h,d);ti.length;){const y=ti.pop();let b;for(;b=io(y.children);)b.visited=!0,r(b,h,d),ti.push(b)}}function Li(a,r,h){r.push(a.body);const d=a.eqs.length;for(let y=0;y!==d;y++){const b=a.eqs[y];h.includes(b)||h.push(b)}}function lt(a,r){return r.id-a.id}class yu{constructor(){this.objects=[],this.type=Object}release(...r){const h=r.length;for(let d=0;d!==h;d++)this.objects.push(r[d]);return this}get(){return 0===this.objects.length?this.constructObject():this.objects.pop()}constructObject(){throw new Error("constructObject() not implemented in this Pool subclass yet!")}resize(r){const h=this.objects;for(;h.length>r;)h.pop();for(;h.length<r;)h.push(this.constructObject());return this}}class Mp extends yu{constructor(){super(),this.type=A}constructObject(){return new A}}const Vi={sphereSphere:ee.types.SPHERE,spherePlane:ee.types.SPHERE|ee.types.PLANE,boxBox:0|ee.types.BOX,sphereBox:ee.types.SPHERE|ee.types.BOX,planeBox:ee.types.PLANE|ee.types.BOX,convexConvex:ee.types.CONVEXPOLYHEDRON,sphereConvex:ee.types.SPHERE|ee.types.CONVEXPOLYHEDRON,planeConvex:ee.types.PLANE|ee.types.CONVEXPOLYHEDRON,boxConvex:ee.types.BOX|ee.types.CONVEXPOLYHEDRON,sphereHeightfield:ee.types.SPHERE|ee.types.HEIGHTFIELD,boxHeightfield:ee.types.BOX|ee.types.HEIGHTFIELD,convexHeightfield:ee.types.CONVEXPOLYHEDRON|ee.types.HEIGHTFIELD,sphereParticle:ee.types.PARTICLE|ee.types.SPHERE,planeParticle:ee.types.PLANE|ee.types.PARTICLE,boxParticle:ee.types.BOX|ee.types.PARTICLE,convexParticle:ee.types.PARTICLE|ee.types.CONVEXPOLYHEDRON,sphereTrimesh:ee.types.SPHERE|ee.types.TRIMESH,planeTrimesh:ee.types.PLANE|ee.types.TRIMESH};class kr{constructor(r){this.contactPointPool=[],this.frictionEquationPool=[],this.result=[],this.frictionResult=[],this.v3pool=new Mp,this.world=r,this.currentContactMaterial=r.defaultContactMaterial,this.enableFrictionReduction=!1}createContactEquation(r,h,d,y,b,R){let k;this.contactPointPool.length?(k=this.contactPointPool.pop(),k.bi=r,k.bj=h):k=new To(r,h),k.enabled=r.collisionResponse&&h.collisionResponse&&d.collisionResponse&&y.collisionResponse;const M=this.currentContactMaterial;k.restitution=M.restitution,k.setSpookParams(M.contactEquationStiffness,M.contactEquationRelaxation,this.world.dt);const H=d.material||r.material,X=y.material||h.material;return H&&X&&H.restitution>=0&&X.restitution>=0&&(k.restitution=H.restitution*X.restitution),k.si=b||d,k.sj=R||y,k}createFrictionEquationsFromContact(r,h){const d=r.bi,y=r.bj,k=this.world,M=this.currentContactMaterial;let H=M.friction;const X=r.si.material||d.material,oe=r.sj.material||y.material;if(X&&oe&&X.friction>=0&&oe.friction>=0&&(H=X.friction*oe.friction),H>0){const ne=H*k.gravity.length();let ge=d.invMass+y.invMass;ge>0&&(ge=1/ge);const we=this.frictionEquationPool,Se=we.length?we.pop():new oc(d,y,ne*ge),Ce=we.length?we.pop():new oc(d,y,ne*ge);return Se.bi=Ce.bi=d,Se.bj=Ce.bj=y,Se.minForce=Ce.minForce=-ne*ge,Se.maxForce=Ce.maxForce=ne*ge,Se.ri.copy(r.ri),Se.rj.copy(r.rj),Ce.ri.copy(r.ri),Ce.rj.copy(r.rj),r.ni.tangents(Se.t,Ce.t),Se.setSpookParams(M.frictionEquationStiffness,M.frictionEquationRelaxation,k.dt),Ce.setSpookParams(M.frictionEquationStiffness,M.frictionEquationRelaxation,k.dt),Se.enabled=Ce.enabled=r.enabled,h.push(Se,Ce),!0}return!1}createFrictionFromAverage(r){let h=this.result[this.result.length-1];if(!this.createFrictionEquationsFromContact(h,this.frictionResult)||1===r)return;const d=this.frictionResult[this.frictionResult.length-2],y=this.frictionResult[this.frictionResult.length-1];Wr.setZero(),Oa.setZero(),bo.setZero();const b=h.bi;for(let k=0;k!==r;k++)h=this.result[this.result.length-1-k],h.bi!==b?(Wr.vadd(h.ni,Wr),Oa.vadd(h.ri,Oa),bo.vadd(h.rj,bo)):(Wr.vsub(h.ni,Wr),Oa.vadd(h.rj,Oa),bo.vadd(h.ri,bo));const R=1/r;Oa.scale(R,d.ri),bo.scale(R,d.rj),y.ri.copy(d.ri),y.rj.copy(d.rj),Wr.normalize(),Wr.tangents(d.t,y.t)}getContacts(r,h,d,y,b,R,k){this.contactPointPool=b,this.frictionEquationPool=k,this.result=y,this.frictionResult=R;const M=pc,H=jc,X=oa,oe=bu;for(let ne=0,ge=r.length;ne!==ge;ne++){const we=r[ne],Se=h[ne];let Ce=null;we.material&&Se.material&&(Ce=d.getContactMaterial(we.material,Se.material)||null);const Pe=we.type&at.KINEMATIC&&Se.type&at.STATIC||we.type&at.STATIC&&Se.type&at.KINEMATIC||we.type&at.KINEMATIC&&Se.type&at.KINEMATIC;for(let Re=0;Re<we.shapes.length;Re++){we.quaternion.mult(we.shapeOrientations[Re],M),we.quaternion.vmult(we.shapeOffsets[Re],X),X.vadd(we.position,X);const Oe=we.shapes[Re];for(let Ge=0;Ge<Se.shapes.length;Ge++){Se.quaternion.mult(Se.shapeOrientations[Ge],H),Se.quaternion.vmult(Se.shapeOffsets[Ge],oe),oe.vadd(Se.position,oe);const ke=Se.shapes[Ge];if(!(Oe.collisionFilterMask&ke.collisionFilterGroup&&ke.collisionFilterMask&Oe.collisionFilterGroup)||X.distanceTo(oe)>Oe.boundingSphereRadius+ke.boundingSphereRadius)continue;let et=null;Oe.material&&ke.material&&(et=d.getContactMaterial(Oe.material,ke.material)||null),this.currentContactMaterial=et||Ce||d.defaultContactMaterial;const rt=this[Oe.type|ke.type];if(rt){let ut=!1;ut=Oe.type<ke.type?rt.call(this,Oe,ke,X,oe,M,H,we,Se,Oe,ke,Pe):rt.call(this,ke,Oe,oe,X,H,M,Se,we,Oe,ke,Pe),ut&&Pe&&(d.shapeOverlapKeeper.set(Oe.id,ke.id),d.bodyOverlapKeeper.set(we.id,Se.id))}}}}}sphereSphere(r,h,d,y,b,R,k,M,H,X,oe){if(oe)return d.distanceSquared(y)<(r.radius+h.radius)**2;const ne=this.createContactEquation(k,M,r,h,H,X);y.vsub(d,ne.ni),ne.ni.normalize(),ne.ri.copy(ne.ni),ne.rj.copy(ne.ni),ne.ri.scale(r.radius,ne.ri),ne.rj.scale(-h.radius,ne.rj),ne.ri.vadd(d,ne.ri),ne.ri.vsub(k.position,ne.ri),ne.rj.vadd(y,ne.rj),ne.rj.vsub(M.position,ne.rj),this.result.push(ne),this.createFrictionEquationsFromContact(ne,this.frictionResult)}spherePlane(r,h,d,y,b,R,k,M,H,X,oe){const ne=this.createContactEquation(k,M,r,h,H,X);if(ne.ni.set(0,0,1),R.vmult(ne.ni,ne.ni),ne.ni.negate(ne.ni),ne.ni.normalize(),ne.ni.scale(r.radius,ne.ri),d.vsub(y,_n),ne.ni.scale(ne.ni.dot(_n),Qt),_n.vsub(Qt,ne.rj),-_n.dot(ne.ni)<=r.radius){if(oe)return!0;const ge=ne.ri,we=ne.rj;ge.vadd(d,ge),ge.vsub(k.position,ge),we.vadd(y,we),we.vsub(M.position,we),this.result.push(ne),this.createFrictionEquationsFromContact(ne,this.frictionResult)}}boxBox(r,h,d,y,b,R,k,M,H,X,oe){return r.convexPolyhedronRepresentation.material=r.material,h.convexPolyhedronRepresentation.material=h.material,r.convexPolyhedronRepresentation.collisionResponse=r.collisionResponse,h.convexPolyhedronRepresentation.collisionResponse=h.collisionResponse,this.convexConvex(r.convexPolyhedronRepresentation,h.convexPolyhedronRepresentation,d,y,b,R,k,M,r,h,oe)}sphereBox(r,h,d,y,b,R,k,M,H,X,oe){const ne=this.v3pool,ge=es;d.vsub(y,yr),h.getSideNormals(ge,R);const we=r.radius;let Se=!1;const Ce=qs,Pe=No,Re=Vl;let Oe=null,Ge=0,ke=0,et=0,rt=null;for(let Tt=0,Zt=ge.length;Tt!==Zt&&!1===Se;Tt++){const un=qr;un.copy(ge[Tt]);const Mn=un.length();un.normalize();const wr=yr.dot(un);if(wr<Mn+we&&wr>0){const Yn=hi,On=Rr;Yn.copy(ge[(Tt+1)%3]),On.copy(ge[(Tt+2)%3]);const Kn=Yn.length(),dr=On.length();Yn.normalize(),On.normalize();const Mr=yr.dot(Yn),di=yr.dot(On);if(Mr<Kn&&Mr>-Kn&&di<dr&&di>-dr){const so=Math.abs(wr-Mn-we);if((null===rt||so<rt)&&(rt=so,ke=Mr,et=di,Oe=Mn,Ce.copy(un),Pe.copy(Yn),Re.copy(On),Ge++,oe))return!0}}}if(Ge){Se=!0;const Tt=this.createContactEquation(k,M,r,h,H,X);Ce.scale(-we,Tt.ri),Tt.ni.copy(Ce),Tt.ni.negate(Tt.ni),Ce.scale(Oe,Ce),Pe.scale(ke,Pe),Ce.vadd(Pe,Ce),Re.scale(et,Re),Ce.vadd(Re,Tt.rj),Tt.ri.vadd(d,Tt.ri),Tt.ri.vsub(k.position,Tt.ri),Tt.rj.vadd(y,Tt.rj),Tt.rj.vsub(M.position,Tt.rj),this.result.push(Tt),this.createFrictionEquationsFromContact(Tt,this.frictionResult)}let ut=ne.get();const vt=co;for(let Tt=0;2!==Tt&&!Se;Tt++)for(let Zt=0;2!==Zt&&!Se;Zt++)for(let un=0;2!==un&&!Se;un++)if(ut.set(0,0,0),Tt?ut.vadd(ge[0],ut):ut.vsub(ge[0],ut),Zt?ut.vadd(ge[1],ut):ut.vsub(ge[1],ut),un?ut.vadd(ge[2],ut):ut.vsub(ge[2],ut),y.vadd(ut,vt),vt.vsub(d,vt),vt.lengthSquared()<we*we){if(oe)return!0;Se=!0;const Mn=this.createContactEquation(k,M,r,h,H,X);Mn.ri.copy(vt),Mn.ri.normalize(),Mn.ni.copy(Mn.ri),Mn.ri.scale(we,Mn.ri),Mn.rj.copy(ut),Mn.ri.vadd(d,Mn.ri),Mn.ri.vsub(k.position,Mn.ri),Mn.rj.vadd(y,Mn.rj),Mn.rj.vsub(M.position,Mn.rj),this.result.push(Mn),this.createFrictionEquationsFromContact(Mn,this.frictionResult)}ne.release(ut),ut=null;const Lt=ne.get(),Kt=ne.get(),zt=ne.get(),Bt=ne.get(),$t=ne.get(),ht=ge.length;for(let Tt=0;Tt!==ht&&!Se;Tt++)for(let Zt=0;Zt!==ht&&!Se;Zt++)if(Tt%3!=Zt%3){ge[Zt].cross(ge[Tt],Lt),Lt.normalize(),ge[Tt].vadd(ge[Zt],Kt),zt.copy(d),zt.vsub(Kt,zt),zt.vsub(y,zt);const un=zt.dot(Lt);Lt.scale(un,Bt);let Mn=0;for(;Mn===Tt%3||Mn===Zt%3;)Mn++;$t.copy(d),$t.vsub(Bt,$t),$t.vsub(Kt,$t),$t.vsub(y,$t);const wr=Math.abs(un),Yn=$t.length();if(wr<ge[Mn].length()&&Yn<we){if(oe)return!0;Se=!0;const On=this.createContactEquation(k,M,r,h,H,X);Kt.vadd(Bt,On.rj),On.rj.copy(On.rj),$t.negate(On.ni),On.ni.normalize(),On.ri.copy(On.rj),On.ri.vadd(y,On.ri),On.ri.vsub(d,On.ri),On.ri.normalize(),On.ri.scale(we,On.ri),On.ri.vadd(d,On.ri),On.ri.vsub(k.position,On.ri),On.rj.vadd(y,On.rj),On.rj.vsub(M.position,On.rj),this.result.push(On),this.createFrictionEquationsFromContact(On,this.frictionResult)}}ne.release(Lt,Kt,zt,Bt,$t)}planeBox(r,h,d,y,b,R,k,M,H,X,oe){return h.convexPolyhedronRepresentation.material=h.material,h.convexPolyhedronRepresentation.collisionResponse=h.collisionResponse,h.convexPolyhedronRepresentation.id=h.id,this.planeConvex(r,h.convexPolyhedronRepresentation,d,y,b,R,k,M,r,h,oe)}convexConvex(r,h,d,y,b,R,k,M,H,X,oe,ne,ge){const we=$p;if(!(d.distanceTo(y)>r.boundingSphereRadius+h.boundingSphereRadius)&&r.findSeparatingAxis(h,d,b,y,R,we,ne,ge)){const Se=[],Ce=lr;r.clipAgainstHull(d,b,h,y,R,we,-100,100,Se);let Pe=0;for(let Re=0;Re!==Se.length;Re++){if(oe)return!0;const Oe=this.createContactEquation(k,M,r,h,H,X),Ge=Oe.ri,ke=Oe.rj;we.negate(Oe.ni),Se[Re].normal.negate(Ce),Ce.scale(Se[Re].depth,Ce),Se[Re].point.vadd(Ce,Ge),ke.copy(Se[Re].point),Ge.vsub(d,Ge),ke.vsub(y,ke),Ge.vadd(d,Ge),Ge.vsub(k.position,Ge),ke.vadd(y,ke),ke.vsub(M.position,ke),this.result.push(Oe),Pe++,this.enableFrictionReduction||this.createFrictionEquationsFromContact(Oe,this.frictionResult)}this.enableFrictionReduction&&Pe&&this.createFrictionFromAverage(Pe)}}sphereConvex(r,h,d,y,b,R,k,M,H,X,oe){const ne=this.v3pool;d.vsub(y,Wo);const ge=h.faceNormals,we=h.faces,Se=h.vertices,Ce=r.radius;let Pe=!1;for(let Re=0;Re!==Se.length;Re++){const Ge=Zu;R.vmult(Se[Re],Ge),y.vadd(Ge,Ge);const ke=Qh;if(Ge.vsub(d,ke),ke.lengthSquared()<Ce*Ce){if(oe)return!0;Pe=!0;const et=this.createContactEquation(k,M,r,h,H,X);return et.ri.copy(ke),et.ri.normalize(),et.ni.copy(et.ri),et.ri.scale(Ce,et.ri),Ge.vsub(y,et.rj),et.ri.vadd(d,et.ri),et.ri.vsub(k.position,et.ri),et.rj.vadd(y,et.rj),et.rj.vsub(M.position,et.rj),this.result.push(et),void this.createFrictionEquationsFromContact(et,this.frictionResult)}}for(let Re=0,Oe=we.length;Re!==Oe&&!1===Pe;Re++){const ke=we[Re],et=Ap;R.vmult(ge[Re],et);const rt=Sh;R.vmult(Se[ke[0]],rt),rt.vadd(y,rt);const ut=bd;et.scale(-Ce,ut),d.vadd(ut,ut);const vt=Eh;ut.vsub(rt,vt);const Lt=vt.dot(et),Kt=zd;if(d.vsub(rt,Kt),Lt<0&&Kt.dot(et)>0){const zt=[];for(let Bt=0,$t=ke.length;Bt!==$t;Bt++){const ht=ne.get();R.vmult(Se[ke[Bt]],ht),y.vadd(ht,ht),zt.push(ht)}if($r(zt,et,d)){if(oe)return!0;Pe=!0;const Bt=this.createContactEquation(k,M,r,h,H,X);et.scale(-Ce,Bt.ri),et.negate(Bt.ni);const $t=ne.get();et.scale(-Lt,$t);const ht=ne.get();et.scale(-Ce,ht),d.vsub(y,Bt.rj),Bt.rj.vadd(ht,Bt.rj),Bt.rj.vadd($t,Bt.rj),Bt.rj.vadd(y,Bt.rj),Bt.rj.vsub(M.position,Bt.rj),Bt.ri.vadd(d,Bt.ri),Bt.ri.vsub(k.position,Bt.ri),ne.release($t),ne.release(ht),this.result.push(Bt),this.createFrictionEquationsFromContact(Bt,this.frictionResult);for(let Tt=0,Zt=zt.length;Tt!==Zt;Tt++)ne.release(zt[Tt]);return}for(let Bt=0;Bt!==ke.length;Bt++){const $t=ne.get(),ht=ne.get();R.vmult(Se[ke[(Bt+1)%ke.length]],$t),R.vmult(Se[ke[(Bt+2)%ke.length]],ht),y.vadd($t,$t),y.vadd(ht,ht);const Tt=Ji;ht.vsub($t,Tt);const Zt=_c;Tt.unit(Zt);const un=ne.get(),Mn=ne.get();d.vsub($t,Mn);const wr=Mn.dot(Zt);Zt.scale(wr,un),un.vadd($t,un);const Yn=ne.get();if(un.vsub(d,Yn),wr>0&&wr*wr<Tt.lengthSquared()&&Yn.lengthSquared()<Ce*Ce){if(oe)return!0;const On=this.createContactEquation(k,M,r,h,H,X);un.vsub(y,On.rj),un.vsub(d,On.ni),On.ni.normalize(),On.ni.scale(Ce,On.ri),On.rj.vadd(y,On.rj),On.rj.vsub(M.position,On.rj),On.ri.vadd(d,On.ri),On.ri.vsub(k.position,On.ri),this.result.push(On),this.createFrictionEquationsFromContact(On,this.frictionResult);for(let Kn=0,dr=zt.length;Kn!==dr;Kn++)ne.release(zt[Kn]);return ne.release($t),ne.release(ht),ne.release(un),ne.release(Yn),void ne.release(Mn)}ne.release($t),ne.release(ht),ne.release(un),ne.release(Yn),ne.release(Mn)}for(let Bt=0,$t=zt.length;Bt!==$t;Bt++)ne.release(zt[Bt])}}}planeConvex(r,h,d,y,b,R,k,M,H,X,oe){const ne=xd,ge=Ir;ge.set(0,0,1),b.vmult(ge,ge);let we=0;const Se=vc;for(let Ce=0;Ce!==h.vertices.length;Ce++)if(ne.copy(h.vertices[Ce]),R.vmult(ne,ne),y.vadd(ne,ne),ne.vsub(d,Se),ge.dot(Se)<=0){if(oe)return!0;const Pe=this.createContactEquation(k,M,r,h,H,X),Re=Xs;ge.scale(ge.dot(Se),Re),ne.vsub(Re,Re),Re.vsub(d,Pe.ri),Pe.ni.copy(ge),ne.vsub(y,Pe.rj),Pe.ri.vadd(d,Pe.ri),Pe.ri.vsub(k.position,Pe.ri),Pe.rj.vadd(y,Pe.rj),Pe.rj.vsub(M.position,Pe.rj),this.result.push(Pe),we++,this.enableFrictionReduction||this.createFrictionEquationsFromContact(Pe,this.frictionResult)}this.enableFrictionReduction&&we&&this.createFrictionFromAverage(we)}boxConvex(r,h,d,y,b,R,k,M,H,X,oe){return r.convexPolyhedronRepresentation.material=r.material,r.convexPolyhedronRepresentation.collisionResponse=r.collisionResponse,this.convexConvex(r.convexPolyhedronRepresentation,h,d,y,b,R,k,M,r,h,oe)}sphereHeightfield(r,h,d,y,b,R,k,M,H,X,oe){const ne=h.data,ge=r.radius,we=h.elementSize,Se=ep,Ce=Qu;F.pointToLocalFrame(y,R,d,Ce);let Pe=Math.floor((Ce.x-ge)/we)-1,Re=Math.ceil((Ce.x+ge)/we)+1,Oe=Math.floor((Ce.y-ge)/we)-1,Ge=Math.ceil((Ce.y+ge)/we)+1;if(Re<0||Ge<0||Pe>ne.length||Oe>ne[0].length)return;Pe<0&&(Pe=0),Re<0&&(Re=0),Oe<0&&(Oe=0),Ge<0&&(Ge=0),Pe>=ne.length&&(Pe=ne.length-1),Re>=ne.length&&(Re=ne.length-1),Ge>=ne[0].length&&(Ge=ne[0].length-1),Oe>=ne[0].length&&(Oe=ne[0].length-1);const ke=[];if(h.getRectMinMax(Pe,Oe,Re,Ge,ke),Ce.z-ge>ke[1]||Ce.z+ge<ke[0])return;const ut=this.result;for(let vt=Pe;vt<Re;vt++)for(let Lt=Oe;Lt<Ge;Lt++){const Kt=ut.length;let zt=!1;if(h.getConvexTrianglePillar(vt,Lt,!1),F.pointToWorldFrame(y,R,h.pillarOffset,Se),d.distanceTo(Se)<h.pillarConvex.boundingSphereRadius+r.boundingSphereRadius&&(zt=this.sphereConvex(r,h.pillarConvex,d,Se,b,R,k,M,r,h,oe)),oe&&zt||(h.getConvexTrianglePillar(vt,Lt,!0),F.pointToWorldFrame(y,R,h.pillarOffset,Se),d.distanceTo(Se)<h.pillarConvex.boundingSphereRadius+r.boundingSphereRadius&&(zt=this.sphereConvex(r,h.pillarConvex,d,Se,b,R,k,M,r,h,oe)),oe&&zt))return!0;if(ut.length-Kt>2)return}}boxHeightfield(r,h,d,y,b,R,k,M,H,X,oe){return r.convexPolyhedronRepresentation.material=r.material,r.convexPolyhedronRepresentation.collisionResponse=r.collisionResponse,this.convexHeightfield(r.convexPolyhedronRepresentation,h,d,y,b,R,k,M,r,h,oe)}convexHeightfield(r,h,d,y,b,R,k,M,H,X,oe){const ne=h.data,ge=h.elementSize,we=r.boundingSphereRadius,Se=tl,Ce=yc,Pe=Gr;F.pointToLocalFrame(y,R,d,Pe);let Re=Math.floor((Pe.x-we)/ge)-1,Oe=Math.ceil((Pe.x+we)/ge)+1,Ge=Math.floor((Pe.y-we)/ge)-1,ke=Math.ceil((Pe.y+we)/ge)+1;if(Oe<0||ke<0||Re>ne.length||Ge>ne[0].length)return;Re<0&&(Re=0),Oe<0&&(Oe=0),Ge<0&&(Ge=0),ke<0&&(ke=0),Re>=ne.length&&(Re=ne.length-1),Oe>=ne.length&&(Oe=ne.length-1),ke>=ne[0].length&&(ke=ne[0].length-1),Ge>=ne[0].length&&(Ge=ne[0].length-1);const et=[];if(h.getRectMinMax(Re,Ge,Oe,ke,et),!(Pe.z-we>et[1]||Pe.z+we<et[0]))for(let vt=Re;vt<Oe;vt++)for(let Lt=Ge;Lt<ke;Lt++){let Kt=!1;if(h.getConvexTrianglePillar(vt,Lt,!1),F.pointToWorldFrame(y,R,h.pillarOffset,Se),d.distanceTo(Se)<h.pillarConvex.boundingSphereRadius+r.boundingSphereRadius&&(Kt=this.convexConvex(r,h.pillarConvex,d,Se,b,R,k,M,null,null,oe,Ce,null)),oe&&Kt||(h.getConvexTrianglePillar(vt,Lt,!0),F.pointToWorldFrame(y,R,h.pillarOffset,Se),d.distanceTo(Se)<h.pillarConvex.boundingSphereRadius+r.boundingSphereRadius&&(Kt=this.convexConvex(r,h.pillarConvex,d,Se,b,R,k,M,null,null,oe,Ce,null)),oe&&Kt))return!0}}sphereParticle(r,h,d,y,b,R,k,M,H,X,oe){const ne=sa;if(ne.set(0,0,1),y.vsub(d,ne),ne.lengthSquared()<=r.radius*r.radius){if(oe)return!0;const ge=this.createContactEquation(M,k,h,r,H,X);ne.normalize(),ge.rj.copy(ne),ge.rj.scale(r.radius,ge.rj),ge.ni.copy(ne),ge.ni.negate(ge.ni),ge.ri.set(0,0,0),this.result.push(ge),this.createFrictionEquationsFromContact(ge,this.frictionResult)}}planeParticle(r,h,d,y,b,R,k,M,H,X,oe){const ne=El;ne.set(0,0,1),k.quaternion.vmult(ne,ne);const ge=Th;if(y.vsub(k.position,ge),ne.dot(ge)<=0){if(oe)return!0;const we=this.createContactEquation(M,k,h,r,H,X);we.ni.copy(ne),we.ni.negate(we.ni),we.ri.set(0,0,0);const Se=Kh;ne.scale(ne.dot(y),Se),y.vsub(Se,Se),we.rj.copy(Se),this.result.push(we),this.createFrictionEquationsFromContact(we,this.frictionResult)}}boxParticle(r,h,d,y,b,R,k,M,H,X,oe){return r.convexPolyhedronRepresentation.material=r.material,r.convexPolyhedronRepresentation.collisionResponse=r.collisionResponse,this.convexParticle(r.convexPolyhedronRepresentation,h,d,y,b,R,k,M,r,h,oe)}convexParticle(r,h,d,y,b,R,k,M,H,X,oe){let ne=-1;const ge=eo,we=As;let Se=null;const Ce=Ur;if(Ce.copy(y),Ce.vsub(d,Ce),b.conjugate(wd),wd.vmult(Ce,Ce),r.pointIsInside(Ce)){r.worldVerticesNeedsUpdate&&r.computeWorldVertices(d,b),r.worldFaceNormalsNeedsUpdate&&r.computeWorldFaceNormals(b);for(let Pe=0,Re=r.faces.length;Pe!==Re;Pe++){const Ge=r.worldFaceNormals[Pe];y.vsub(r.worldVertices[r.faces[Pe][0]],Ro);const ke=-Ge.dot(Ro);if(null===Se||Math.abs(ke)<Math.abs(Se)){if(oe)return!0;Se=ke,ne=Pe,ge.copy(Ge)}}if(-1!==ne){const Pe=this.createContactEquation(M,k,h,r,H,X);ge.scale(Se,we),we.vadd(y,we),we.vsub(d,we),Pe.rj.copy(we),ge.negate(Pe.ni),Pe.ri.set(0,0,0);const Re=Pe.ri,Oe=Pe.rj;Re.vadd(y,Re),Re.vsub(M.position,Re),Oe.vadd(d,Oe),Oe.vsub(k.position,Oe),this.result.push(Pe),this.createFrictionEquationsFromContact(Pe,this.frictionResult)}else console.warn("Point found inside convex, but did not find penetrating face!")}}sphereTrimesh(r,h,d,y,b,R,k,M,H,X,oe){const ne=Hl,ge=wu,we=ba,Se=xo,Ce=Os,Pe=mc,Re=vn,Oe=ya,Ge=Sl,ke=qt;F.pointToLocalFrame(y,R,d,Ce);const et=r.radius;Re.lowerBound.set(Ce.x-et,Ce.y-et,Ce.z-et),Re.upperBound.set(Ce.x+et,Ce.y+et,Ce.z+et),h.getTrianglesInAABB(Re,ke);const rt=ka,ut=r.radius*r.radius;for(let Bt=0;Bt<ke.length;Bt++)for(let $t=0;$t<3;$t++)if(h.getVertex(h.indices[3*ke[Bt]+$t],rt),rt.vsub(Ce,Ge),Ge.lengthSquared()<=ut){if(Oe.copy(rt),F.pointToWorldFrame(y,R,Oe,rt),rt.vsub(d,Ge),oe)return!0;let ht=this.createContactEquation(k,M,r,h,H,X);ht.ni.copy(Ge),ht.ni.normalize(),ht.ri.copy(ht.ni),ht.ri.scale(r.radius,ht.ri),ht.ri.vadd(d,ht.ri),ht.ri.vsub(k.position,ht.ri),ht.rj.copy(rt),ht.rj.vsub(M.position,ht.rj),this.result.push(ht),this.createFrictionEquationsFromContact(ht,this.frictionResult)}for(let Bt=0;Bt<ke.length;Bt++)for(let $t=0;$t<3;$t++){h.getVertex(h.indices[3*ke[Bt]+$t],ne),h.getVertex(h.indices[3*ke[Bt]+($t+1)%3],ge),ge.vsub(ne,we),Ce.vsub(ge,Pe);const ht=Pe.dot(we);Ce.vsub(ne,Pe);let Tt=Pe.dot(we);if(Tt>0&&ht<0&&(Ce.vsub(ne,Pe),Se.copy(we),Se.normalize(),Tt=Pe.dot(Se),Se.scale(Tt,Pe),Pe.vadd(ne,Pe),Pe.distanceTo(Ce)<r.radius)){if(oe)return!0;const Zt=this.createContactEquation(k,M,r,h,H,X);Pe.vsub(Ce,Zt.ni),Zt.ni.normalize(),Zt.ni.scale(r.radius,Zt.ri),Zt.ri.vadd(d,Zt.ri),Zt.ri.vsub(k.position,Zt.ri),F.pointToWorldFrame(y,R,Pe,Pe),Pe.vsub(M.position,Zt.rj),F.vectorToWorldFrame(R,Zt.ni,Zt.ni),F.vectorToWorldFrame(R,Zt.ri,Zt.ri),this.result.push(Zt),this.createFrictionEquationsFromContact(Zt,this.frictionResult)}}const vt=tt,Lt=bt,Kt=kt,zt=er;for(let Bt=0,$t=ke.length;Bt!==$t;Bt++){h.getTriangleVertices(ke[Bt],vt,Lt,Kt),h.getNormal(ke[Bt],zt),Ce.vsub(vt,Pe);let ht=Pe.dot(zt);if(zt.scale(ht,Pe),Ce.vsub(Pe,Pe),ht=Pe.distanceTo(Ce),Nr.pointInTriangle(Pe,vt,Lt,Kt)&&ht<r.radius){if(oe)return!0;let Tt=this.createContactEquation(k,M,r,h,H,X);Pe.vsub(Ce,Tt.ni),Tt.ni.normalize(),Tt.ni.scale(r.radius,Tt.ri),Tt.ri.vadd(d,Tt.ri),Tt.ri.vsub(k.position,Tt.ri),F.pointToWorldFrame(y,R,Pe,Pe),Pe.vsub(M.position,Tt.rj),F.vectorToWorldFrame(R,Tt.ni,Tt.ni),F.vectorToWorldFrame(R,Tt.ri,Tt.ri),this.result.push(Tt),this.createFrictionEquationsFromContact(Tt,this.frictionResult)}}ke.length=0}planeTrimesh(r,h,d,y,b,R,k,M,H,X,oe){const ne=new A,ge=xu;ge.set(0,0,1),b.vmult(ge,ge);for(let we=0;we<h.vertices.length/3;we++){h.getVertex(we,ne);const Se=new A;Se.copy(ne),F.pointToWorldFrame(y,R,Se,ne);const Ce=wh;if(ne.vsub(d,Ce),ge.dot(Ce)<=0){if(oe)return!0;const Pe=this.createContactEquation(k,M,r,h,H,X);Pe.ni.copy(ge);const Re=dc;ge.scale(Ce.dot(ge),Re),ne.vsub(Re,Re),Pe.ri.copy(Re),Pe.ri.vsub(k.position,Pe.ri),Pe.rj.copy(ne),Pe.rj.vsub(M.position,Pe.rj),this.result.push(Pe),this.createFrictionEquationsFromContact(Pe,this.frictionResult)}}}}const Wr=new A,Oa=new A,bo=new A,oa=new A,bu=new A,pc=new pe,jc=new pe;kr.prototype[Vi.boxBox]=kr.prototype.boxBox,kr.prototype[Vi.boxConvex]=kr.prototype.boxConvex,kr.prototype[Vi.boxParticle]=kr.prototype.boxParticle,kr.prototype[Vi.sphereSphere]=kr.prototype.sphereSphere;const xu=new A,wh=new A,dc=new A;kr.prototype[Vi.planeTrimesh]=kr.prototype.planeTrimesh;const er=new A,Sl=new A,ka=new A,ya=new A,Hl=new A,wu=new A,ba=new A,xo=new A,Os=new A,mc=new A,tt=new A,bt=new A,kt=new A,vn=new te,qt=[];kr.prototype[Vi.sphereTrimesh]=kr.prototype.sphereTrimesh;const _n=new A,Qt=new A;kr.prototype[Vi.spherePlane]=kr.prototype.spherePlane;const Jn=new A,zn=new A,Sr=new A;function $r(a,r,h){let d=null;const y=a.length;for(let b=0;b!==y;b++){const R=a[b],k=Jn;a[(b+1)%y].vsub(R,k);const M=zn;k.cross(r,M);const H=Sr;h.vsub(R,H);const X=M.dot(H);if(!(null===d||X>0&&!0===d||X<=0&&!1===d))return!1;null===d&&(d=X>0)}return!0}const yr=new A,qr=new A,hi=new A,Rr=new A,es=[new A,new A,new A,new A,new A,new A],co=new A,qs=new A,No=new A,Vl=new A;kr.prototype[Vi.sphereBox]=kr.prototype.sphereBox;const Wo=new A,Ji=new A,_c=new A,Qh=new A,Zu=new A,Ap=new A,Sh=new A,bd=new A,Eh=new A,zd=new A;kr.prototype[Vi.sphereConvex]=kr.prototype.sphereConvex,kr.prototype[Vi.planeBox]=kr.prototype.planeBox;const xd=new A,Ir=new A,vc=new A,Xs=new A;kr.prototype[Vi.planeConvex]=kr.prototype.planeConvex;const $p=new A,lr=new A;kr.prototype[Vi.convexConvex]=kr.prototype.convexConvex;const El=new A,Th=new A,Kh=new A;kr.prototype[Vi.planeParticle]=kr.prototype.planeParticle;const sa=new A;kr.prototype[Vi.sphereParticle]=kr.prototype.sphereParticle;const wd=new pe,Ur=new A,eo=new A,Ro=new A,As=new A;kr.prototype[Vi.convexParticle]=kr.prototype.convexParticle,kr.prototype[Vi.boxHeightfield]=kr.prototype.boxHeightfield;const Gr=new A,tl=new A,yc=[0];kr.prototype[Vi.convexHeightfield]=kr.prototype.convexHeightfield;const Qu=new A,ep=new A;kr.prototype[Vi.sphereHeightfield]=kr.prototype.sphereHeightfield;class Tl{constructor(){this.current=[],this.previous=[]}getKey(r,h){if(h<r){const d=h;h=r,r=d}return r<<16|h}set(r,h){const d=this.getKey(r,h),y=this.current;let b=0;for(;d>y[b];)b++;if(d!==y[b]){for(let R=y.length-1;R>=b;R--)y[R+1]=y[R];y[b]=d}}tick(){const r=this.current;this.current=this.previous,this.previous=r,this.current.length=0}getDiff(r,h){const d=this.current,y=this.previous,b=d.length,R=y.length;let k=0;for(let M=0;M<b;M++){let H=!1;const X=d[M];for(;X>y[k];)k++;H=X===y[k],H||tr(r,X)}k=0;for(let M=0;M<R;M++){let H=!1;const X=y[M];for(;X>d[k];)k++;H=d[k]===X,H||tr(h,X)}}}function tr(a,r){a.push((4294901760&r)>>16,65535&r)}class nl{constructor(){this.data={keys:[]}}get(r,h){if(r>h){const d=h;h=r,r=d}return this.data[r+"-"+h]}set(r,h,d){if(r>h){const b=h;h=r,r=b}const y=r+"-"+h;this.get(r,h)||this.data.keys.push(y),this.data[y]=d}reset(){const r=this.data,h=r.keys;for(;h.length>0;)delete r[h.pop()]}}class Fn extends le{constructor(r={}){super(),this.dt=-1,this.allowSleep=!!r.allowSleep,this.contacts=[],this.frictionEquations=[],this.quatNormalizeSkip=void 0!==r.quatNormalizeSkip?r.quatNormalizeSkip:0,this.quatNormalizeFast=void 0!==r.quatNormalizeFast&&r.quatNormalizeFast,this.time=0,this.stepnumber=0,this.default_dt=1/60,this.nextId=0,this.gravity=new A,r.gravity&&this.gravity.copy(r.gravity),this.broadphase=void 0!==r.broadphase?r.broadphase:new vr,this.bodies=[],this.hasActiveBodies=!1,this.solver=void 0!==r.solver?r.solver:new vu,this.constraints=[],this.narrowphase=new kr(this),this.collisionMatrix=new _e,this.collisionMatrixPrevious=new _e,this.bodyOverlapKeeper=new Tl,this.shapeOverlapKeeper=new Tl,this.materials=[],this.contactmaterials=[],this.contactMaterialTable=new nl,this.defaultMaterial=new Hu("default"),this.defaultContactMaterial=new Gu(this.defaultMaterial,this.defaultMaterial,{friction:.3,restitution:0}),this.doProfiling=!1,this.profile={solve:0,makeContactConstraints:0,broadphase:0,integrate:0,narrowphase:0},this.accumulator=0,this.subsystems=[],this.addBodyEvent={type:"addBody",body:null},this.removeBodyEvent={type:"removeBody",body:null},this.idToBodyMap={},this.broadphase.setWorld(this)}getContactMaterial(r,h){return this.contactMaterialTable.get(r.id,h.id)}numObjects(){return this.bodies.length}collisionMatrixTick(){const r=this.collisionMatrixPrevious;this.collisionMatrixPrevious=this.collisionMatrix,this.collisionMatrix=r,this.collisionMatrix.reset(),this.bodyOverlapKeeper.tick(),this.shapeOverlapKeeper.tick()}addConstraint(r){this.constraints.push(r)}removeConstraint(r){const h=this.constraints.indexOf(r);-1!==h&&this.constraints.splice(h,1)}rayTest(r,h,d){d instanceof pi?this.raycastClosest(r,h,{skipBackfaces:!0},d):this.raycastAll(r,h,{skipBackfaces:!0},d)}raycastAll(r,h,d={},y){return d.mode=Nr.ALL,d.from=r,d.to=h,d.callback=y,Ml.intersectWorld(this,d)}raycastAny(r,h,d={},y){return d.mode=Nr.ANY,d.from=r,d.to=h,d.result=y,Ml.intersectWorld(this,d)}raycastClosest(r,h,d={},y){return d.mode=Nr.CLOSEST,d.from=r,d.to=h,d.result=y,Ml.intersectWorld(this,d)}addBody(r){this.bodies.includes(r)||(r.index=this.bodies.length,this.bodies.push(r),r.world=this,r.initPosition.copy(r.position),r.initVelocity.copy(r.velocity),r.timeLastSleepy=this.time,r instanceof at&&(r.initAngularVelocity.copy(r.angularVelocity),r.initQuaternion.copy(r.quaternion)),this.collisionMatrix.setNumObjects(this.bodies.length),this.addBodyEvent.body=r,this.idToBodyMap[r.id]=r,this.dispatchEvent(this.addBodyEvent))}removeBody(r){r.world=null;const h=this.bodies.length-1,d=this.bodies,y=d.indexOf(r);if(-1!==y){d.splice(y,1);for(let b=0;b!==d.length;b++)d[b].index=b;this.collisionMatrix.setNumObjects(h),this.removeBodyEvent.body=r,delete this.idToBodyMap[r.id],this.dispatchEvent(this.removeBodyEvent)}}getBodyById(r){return this.idToBodyMap[r]}getShapeById(r){const h=this.bodies;for(let d=0,y=h.length;d<y;d++){const b=h[d].shapes;for(let R=0,k=b.length;R<k;R++){const M=b[R];if(M.id===r)return M}}}addMaterial(r){this.materials.push(r)}addContactMaterial(r){this.contactmaterials.push(r),this.contactMaterialTable.set(r.materials[0].id,r.materials[1].id,r)}step(r,h=0,d=10){if(0===h)this.internalStep(r),this.time+=r;else{this.accumulator+=h;let y=0;for(;this.accumulator>=r&&y<d;)this.internalStep(r),this.accumulator-=r,y++;const b=this.accumulator%r/r;for(let R=0;R!==this.bodies.length;R++){const k=this.bodies[R];k.previousPosition.lerp(k.position,b,k.interpolatedPosition),k.previousQuaternion.slerp(k.quaternion,b,k.interpolatedQuaternion),k.previousQuaternion.normalize()}this.time+=h}}internalStep(r){this.dt=r;const h=this.contacts,d=eh,y=wa,b=this.numObjects(),R=this.bodies,k=this.solver,M=this.gravity,H=this.doProfiling,X=this.profile,oe=at.DYNAMIC;let ne=-1/0;const ge=this.constraints,we=Ku,Se=(M.length(),M.x),Ce=M.y,Pe=M.z;let Re=0;for(H&&(ne=performance.now()),Re=0;Re!==b;Re++){const zt=R[Re];if(zt.type===oe){const Bt=zt.force,$t=zt.mass;Bt.x+=$t*Se,Bt.y+=$t*Ce,Bt.z+=$t*Pe}}for(let zt=0,Bt=this.subsystems.length;zt!==Bt;zt++)this.subsystems[zt].update();H&&(ne=performance.now()),d.length=0,y.length=0,this.broadphase.collisionPairs(this,d,y),H&&(X.broadphase=performance.now()-ne);let Oe=ge.length;for(Re=0;Re!==Oe;Re++){const zt=ge[Re];if(!zt.collideConnected)for(let Bt=d.length-1;Bt>=0;Bt-=1)(zt.bodyA===d[Bt]&&zt.bodyB===y[Bt]||zt.bodyB===d[Bt]&&zt.bodyA===y[Bt])&&(d.splice(Bt,1),y.splice(Bt,1))}this.collisionMatrixTick(),H&&(ne=performance.now());const Ge=xa,ke=h.length;for(Re=0;Re!==ke;Re++)Ge.push(h[Re]);h.length=0;const et=this.frictionEquations.length;for(Re=0;Re!==et;Re++)we.push(this.frictionEquations[Re]);for(this.frictionEquations.length=0,this.narrowphase.getContacts(d,y,this,h,Ge,this.frictionEquations,we),H&&(X.narrowphase=performance.now()-ne),H&&(ne=performance.now()),Re=0;Re<this.frictionEquations.length;Re++)k.addEquation(this.frictionEquations[Re]);const rt=h.length;for(let zt=0;zt!==rt;zt++){const Bt=h[zt],$t=Bt.bi,ht=Bt.bj,Tt=Bt.si,Zt=Bt.sj;let un;un=$t.material&&ht.material&&this.getContactMaterial($t.material,ht.material)||this.defaultContactMaterial;let Mn=un.friction;$t.material&&ht.material&&($t.material.friction>=0&&ht.material.friction>=0&&(Mn=$t.material.friction*ht.material.friction),$t.material.restitution>=0&&ht.material.restitution>=0&&(Bt.restitution=$t.material.restitution*ht.material.restitution)),k.addEquation(Bt),$t.allowSleep&&$t.type===at.DYNAMIC&&$t.sleepState===at.SLEEPING&&ht.sleepState===at.AWAKE&&ht.type!==at.STATIC&&ht.velocity.lengthSquared()+ht.angularVelocity.lengthSquared()>=2*ht.sleepSpeedLimit**2&&($t.wakeUpAfterNarrowphase=!0),ht.allowSleep&&ht.type===at.DYNAMIC&&ht.sleepState===at.SLEEPING&&$t.sleepState===at.AWAKE&&$t.type!==at.STATIC&&$t.velocity.lengthSquared()+$t.angularVelocity.lengthSquared()>=2*$t.sleepSpeedLimit**2&&(ht.wakeUpAfterNarrowphase=!0),this.collisionMatrix.set($t,ht,!0),this.collisionMatrixPrevious.get($t,ht)||(Cp.body=ht,Cp.contact=Bt,$t.dispatchEvent(Cp),Cp.body=$t,ht.dispatchEvent(Cp)),this.bodyOverlapKeeper.set($t.id,ht.id),this.shapeOverlapKeeper.set(Tt.id,Zt.id)}for(this.emitContactEvents(),H&&(X.makeContactConstraints=performance.now()-ne,ne=performance.now()),Re=0;Re!==b;Re++){const zt=R[Re];zt.wakeUpAfterNarrowphase&&(zt.wakeUp(),zt.wakeUpAfterNarrowphase=!1)}for(Oe=ge.length,Re=0;Re!==Oe;Re++){const zt=ge[Re];zt.update();for(let Bt=0,$t=zt.equations.length;Bt!==$t;Bt++)k.addEquation(zt.equations[Bt])}k.solve(r,this),H&&(X.solve=performance.now()-ne),k.removeAllEquations();const ut=Math.pow;for(Re=0;Re!==b;Re++){const zt=R[Re];if(zt.type&oe){const Bt=ut(1-zt.linearDamping,r),$t=zt.velocity;$t.scale(Bt,$t);const ht=zt.angularVelocity;if(ht){const Tt=ut(1-zt.angularDamping,r);ht.scale(Tt,ht)}}}for(this.dispatchEvent(jd),Re=0;Re!==b;Re++){const zt=R[Re];zt.preStep&&zt.preStep.call(zt)}H&&(ne=performance.now());const vt=this.stepnumber%(this.quatNormalizeSkip+1)==0,Lt=this.quatNormalizeFast;for(Re=0;Re!==b;Re++)R[Re].integrate(r,vt,Lt);for(this.clearForces(),this.broadphase.dirty=!0,H&&(X.integrate=performance.now()-ne),this.time+=r,this.stepnumber+=1,this.dispatchEvent(zi),Re=0;Re!==b;Re++){const zt=R[Re],Bt=zt.postStep;Bt&&Bt.call(zt)}let Kt=!0;if(this.allowSleep)for(Kt=!1,Re=0;Re!==b;Re++){const zt=R[Re];zt.sleepTick(this.time),zt.sleepState!==at.SLEEPING&&(Kt=!0)}this.hasActiveBodies=Kt}clearForces(){const r=this.bodies,h=r.length;for(let d=0;d!==h;d++){const y=r[d];y.force.set(0,0,0),y.torque.set(0,0,0)}}}new te;const Ml=new Nr;if(typeof performance>"u"&&(performance={}),!performance.now){let a=Date.now();performance.timing&&performance.timing.navigationStart&&(a=performance.timing.navigationStart),performance.now=()=>Date.now()-a}const zi={type:"postStep"},jd={type:"preStep"},Cp={type:at.COLLIDE_EVENT_NAME,body:null,contact:null},xa=[],Ku=[],eh=[],wa=[];function oi(){this.pressed=!1,this.justPressed=!1,this.justReleased=!1}function Yr(a,r){this._keys=new Array(5),this._position=new l.Vector2(0,0),this._positionUpdated=!1,this._delta=new l.Vector2(0,0),this._wheel=0,this._wheelUpdated=!1,this._doubleClicked=new Array(5),this.keys=new Array(5),this.position=new l.Vector2(0,0),this.delta=new l.Vector2(0,0),this.wheel=0,this.doubleClicked=new Array(5),this.domElement=void 0!==a?a:window,this.canvas=null,this.events=new dn;for(var h=0;h<5;h++)this._doubleClicked[h]=!1,this.doubleClicked[h]=!1,this._keys[h]=new oi,this.keys[h]=new oi;var d=this;if(void 0!==window.onmousewheel?this.events.add(this.domElement,"mousewheel",function(b){d._wheel=b.deltaY,d._wheelUpdated=!0}):void 0!==window.addEventListener?this.events.add(this.domElement,"DOMMouseScroll",function(b){d._wheel=30*b.detail,d._wheelUpdated=!0}):this.events.add(this.domElement,"wheel",function(b){d._wheel=b.deltaY,d._wheelUpdated=!0}),"ontouchstart"in window||navigator.msMaxTouchPoints>0){var y=new l.Vector2(0,0);this.events.add(this.domElement,"touchstart",function(b){var R=b.touches[0];d.updatePosition(R.screenX,R.screenY,0,0),d.updateKey(Yr.LEFT,oi.DOWN),y.set(R.screenX,R.screenY)}),this.events.add(this.domElement,"touchend",function(b){d.updateKey(Yr.LEFT,oi.UP)}),this.events.add(this.domElement,"touchcancel",function(b){d.updateKey(Yr.LEFT,oi.UP)}),this.events.add(document.body,"touchmove",function(b){var R=b.touches[0];d.updatePosition(R.screenX,R.screenY,R.screenX-y.x,R.screenY-y.y),y.set(R.screenX,R.screenY)})}this.events.add(this.domElement,"mousemove",function(b){d.updatePosition(b.clientX,b.clientY,b.movementX,b.movementY)}),this.events.add(this.domElement,"mousedown",function(b){d.updateKey(b.which-1,oi.DOWN)}),this.events.add(this.domElement,"mouseup",function(b){d.updateKey(b.which-1,oi.UP)}),this.events.add(this.domElement,"dragstart",function(b){d.updateKey(b.which-1,oi.UP)}),this.events.add(this.domElement,"dblclick",function(b){d._doubleClicked[b.which-1]=!0}),!0!==r&&this.create()}function dn(){this.events=[]}function Gc(){}function ai(){}function aa(){}function Fa(){}function Bn(){}Fn.prototype.emitContactEvents=(()=>{const a=[],r=[],h={type:"beginContact",bodyA:null,bodyB:null},d={type:"endContact",bodyA:null,bodyB:null},y={type:"beginShapeContact",bodyA:null,bodyB:null,shapeA:null,shapeB:null},b={type:"endShapeContact",bodyA:null,bodyB:null,shapeA:null,shapeB:null};return function(){const R=this.hasAnyEventListener("beginContact"),k=this.hasAnyEventListener("endContact");if((R||k)&&this.bodyOverlapKeeper.getDiff(a,r),R){for(let X=0,oe=a.length;X<oe;X+=2)h.bodyA=this.getBodyById(a[X]),h.bodyB=this.getBodyById(a[X+1]),this.dispatchEvent(h);h.bodyA=h.bodyB=null}if(k){for(let X=0,oe=r.length;X<oe;X+=2)d.bodyA=this.getBodyById(r[X]),d.bodyB=this.getBodyById(r[X+1]),this.dispatchEvent(d);d.bodyA=d.bodyB=null}a.length=r.length=0;const M=this.hasAnyEventListener("beginShapeContact"),H=this.hasAnyEventListener("endShapeContact");if((M||H)&&this.shapeOverlapKeeper.getDiff(a,r),M){for(let X=0,oe=a.length;X<oe;X+=2){const ne=this.getShapeById(a[X]),ge=this.getShapeById(a[X+1]);y.shapeA=ne,y.shapeB=ge,y.bodyA=ne.body,y.bodyB=ge.body,this.dispatchEvent(y)}y.bodyA=y.bodyB=y.shapeA=y.shapeB=null}if(H){for(let X=0,oe=r.length;X<oe;X+=2){const ne=this.getShapeById(r[X]),ge=this.getShapeById(r[X+1]);b.shapeA=ne,b.shapeB=ge,b.bodyA=ne.body,b.bodyB=ge.body,this.dispatchEvent(b)}b.bodyA=b.bodyB=b.shapeA=b.shapeB=null}}})(),oi.DOWN=-1,oi.UP=1,oi.RESET=0,oi.prototype.constructor=oi,oi.prototype.update=function(a){this.justPressed=!1,this.justReleased=!1,a===oi.DOWN?(!1===this.pressed&&(this.justPressed=!0),this.pressed=!0):a===oi.UP?(this.pressed&&(this.justReleased=!0),this.pressed=!1):a===oi.RESET&&(this.justReleased=!1,this.justPressed=!1)},oi.prototype.set=function(a,r,h){this.justPressed=a,this.pressed=r,this.justReleased=h},oi.prototype.reset=function(){this.justPressed=!1,this.pressed=!1,this.justReleased=!1},(Yr.prototype=Yr).constructor=Yr,Yr.LEFT=0,Yr.MIDDLE=1,Yr.RIGHT=2,Yr.BACK=3,Yr.FORWARD=4,Yr.setCanvas=function(a){this.canvas=a,a.pointerInside=!1,a.addEventListener("mouseenter",function(){this.pointerInside=!0}),a.addEventListener("mouseleave",function(){this.pointerInside=!1})},Yr.insideCanvas=function(){return null!==this.canvas&&this.canvas.pointerInside},Yr.setLock=function(a){null!==this.canvas&&(a?(this.canvas.requestPointerLock=this.canvas.requestPointerLock||this.canvas.mozRequestPointerLock||this.canvas.webkitRequestPointerLock,void 0!==this.canvas.requestPointerLock&&this.canvas.requestPointerLock()):void 0!==document.exitPointerLock?document.exitPointerLock():void 0!==document.mozExitPointerLock?document.mozExitPointerLock():void 0!==document.webkitExitPointerLock&&document.webkitExitPointerLock())},Yr.buttonPressed=function(a){return this.keys[a].pressed},Yr.buttonDoubleClicked=function(a){return this.doubleClicked[a]},Yr.buttonJustPressed=function(a){return this.keys[a].justPressed},Yr.buttonJustReleased=function(a){return this.keys[a].justReleased},Yr.updatePosition=function(a,r,h,d){if(null!==this.canvas){var y=this.canvas.getBoundingClientRect();a-=y.left,r-=y.top}this._position.set(a,r),this._delta.x+=h,this._delta.y+=d,this._positionUpdated=!0},Yr.updateKey=function(a,r){a>-1&&this._keys[a].update(r)},Yr.update=function(){for(var a=0;a<5;a++)this._keys[a].justPressed&&this.keys[a].justPressed&&(this._keys[a].justPressed=!1),this._keys[a].justReleased&&this.keys[a].justReleased&&(this._keys[a].justReleased=!1),this.keys[a].set(this._keys[a].justPressed,this._keys[a].pressed,this._keys[a].justReleased),!0===this._doubleClicked[a]?(this.doubleClicked[a]=!0,this._doubleClicked[a]=!1):this.doubleClicked[a]=!1;this._wheelUpdated?(this.wheel=this._wheel,this._wheelUpdated=!1):this.wheel=0,this._positionUpdated?(this.delta.copy(this._delta),this.position.copy(this._position),this._delta.set(0,0),this._positionUpdated=!1):(this.delta.x=0,this.delta.y=0)},Yr.create=function(){this.events.create()},Yr.dispose=function(){this.events.destroy()},dn.prototype.addAndCreate=function(a,r,h){var d=[a,r,h,!0];d[0].addEventListener(d[1],d[2]),d[3]=!0,this.events.push(d)},dn.prototype.remove=function(a,r){for(var h=this.events.length-1;h>=0;h--)this.events[h][0]===a&&this.events[h][1]===r&&(this.events[h][3]&&(this.events[h][0].removeEventListener(this.events[h][1],this.events[h][2]),this.events[h][3]=!1),this.events.splice(h,1))},dn.prototype.add=function(a,r,h){this.events.push([a,r,h,!1])},dn.prototype.clear=function(){this.destroy(),this.events=[]},dn.prototype.create=function(){for(var a=0;a<this.events.length;a++){var r=this.events[a];r[0].addEventListener(r[1],r[2]),r[3]=!0}},dn.prototype.destroy=function(){for(var a=0;a<this.events.length;a++){var r=this.events[a];r[0].removeEventListener(r[1],r[2]),r[3]=!1}},dn.prototype.addScrollEvent=function(a,r){void 0!==window.onmousewheel?this.add(a,"mousewheel",r):void 0!==window.addEventListener?this.add(a,"DOMMouseScroll",function(h){h.deltaY=30*h.detail,r(h)}):this.add(a,"wheel",r)},Gc.PI2=2*Math.PI,Gc.PID3=Math.PI/3,Gc.PID2=Math.PI/2,Gc.randomColor=function(){for(var a="#",r=0;r<6;r++)a+="0123456789ABCDEF"[Math.floor(16*Math.random())];return a},ai.encoding="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ai.isBase64=function(a){if("string"!=typeof a)return!1;if(a.startsWith("data:"))return!0;for(var r=0;r<a.length;r++)if(!ai.encoding.includes(a.charAt(r)))return!1;return!0},ai.removeHeader=function(a){return a.slice(a.search(";base64,")+8)},ai.getFileFormat=function(a){var r=a.indexOf("/")+1,h=a.indexOf(";");return a.substr(r,h-r)},ai.fromArraybuffer=function(a){for(var r,b,R="",k=new Uint8Array(a),M=k.byteLength%3,H=k.byteLength-M,X=0;X<H;X+=3)r=(16515072&(b=k[X]<<16|k[X+1]<<8|k[X+2]))>>18,R+=ai.encoding[r]+ai.encoding[(258048&b)>>12]+ai.encoding[(4032&b)>>6]+ai.encoding[63&b];return 1===M?(r=(252&(b=k[H]))>>2,R+=ai.encoding[r]+ai.encoding[(3&b)<<4]+"=="):2===M&&(r=(64512&(b=k[H]<<8|k[H+1]))>>10,R+=ai.encoding[r]+ai.encoding[(1008&b)>>4]+ai.encoding[(15&b)<<2]+"="),R},ai.fromBinaryString=function(a){for(var r,h,d,y="",b=a.length%3,R=a.length-b,k=0;k<R;k+=3)r=255&a.charCodeAt(k),h=a.charCodeAt(k+1),d=a.charCodeAt(k+2),y+=ai.encoding.charAt(r>>2),y+=ai.encoding.charAt((3&r)<<4|(240&h)>>4),y+=ai.encoding.charAt((15&h)<<2|(192&d)>>6),y+=ai.encoding.charAt(63&d);return 1===b?(r=255&a.charCodeAt(k),y+=ai.encoding.charAt(r>>2),y+=ai.encoding.charAt((3&r)<<4),y+="=="):2===b&&(r=255&a.charCodeAt(k),h=a.charCodeAt(k+1),y+=ai.encoding.charAt(r>>2),y+=ai.encoding.charAt((3&r)<<4|(240&h)>>4),y+=ai.encoding.charAt((15&h)<<2),y+="="),y},aa.fromBinaryString=function(a){for(var r=a.length,h=new ArrayBuffer(r),d=new Uint8Array(h),y=0;y<r;y++)d[y]=a.charCodeAt(y);return h},aa.fromBase64=function(a){for(var r,h,d,y,b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",R=a.length/4*3,k=new ArrayBuffer(R),M=new Uint8Array(k),H=0,X=0;H<R;H+=3)r=b.indexOf(a.charAt(X++)),h=b.indexOf(a.charAt(X++)),d=b.indexOf(a.charAt(X++)),y=b.indexOf(a.charAt(X++)),M[H]=r<<2|h>>4,64!==d&&(M[H+1]=(15&h)<<4|d>>2),64!==y&&(M[H+2]=(3&d)<<6|y);return k},aa.fromBuffer=function(a){for(var r=new ArrayBuffer(a.length),h=new Uint8Array(r),d=0;d<a.length;d++)h[d]=a[d];return r},Fa.fromArrayBuffer=function(a){for(var r=new Buffer(a.byteLength),h=new Uint8Array(a),d=0;d<r.length;d++)r[d]=h[d];return r};try{Bn.fs=window.require?window.require("fs"):null}catch{}function vi(a,r){this.name=a,this.uuid=l.Math.generateUUID(),this.type=r,this.format="",this.encoding="",this.data=null}function gs(a,r){if(vi.call(this,"image","Image"),this.width=-1,this.height=-1,void 0!==a)if(a instanceof ArrayBuffer)this.loadArrayBufferData(a,r);else if(ai.isBase64(a))this.encoding=ai.getFileFormat(a),this.format="base64",this.data=a;else if(a.startsWith("blob")){var h=Bn.readFileArrayBuffer(a,!0);this.loadArrayBufferData(h)}else this.encoding=Bn.getFileExtension(a),this.format="url",this.data=a;else this.createSolidColor()}function vs(a,r,h,d,y,b,R,k,M,H){this.source="string"==typeof a?new gs(a):void 0===a?new gs:a,l.Texture.call(this,document.createElement("img"),r,h,d,y,b,R,k,M,H);var X=this;if(this.name="texture",this.category="Image",this.disposed=!1,this.format=this.source.hasTransparency()?l.RGBAFormat:l.RGBFormat,this.updateSource(),"gif"===this.source.encoding){let oe=function(){X.disposed||(X.needsUpdate=!0,requestAnimationFrame(oe))};this.generateMipmaps=!1,this.magFilter=l.LinearFilter,this.minFilter=l.LinearFilter,oe()}}function $s(a){l.AmbientLight.call(this,a),this.name="ambient",this.matrixAutoUpdate=!1}function ni(a){l.Object3D.call(this),this.name="audio",this.type="Audio",this.listener=new l.AudioListener,this.context=this.listener.context,this.matrixAutoUpdate=!1,this.gain=this.context.createGain(),this.gain.connect(this.listener.getInput()),this.buffer=null,this.filters=[],this.sourceType="empty",this.audio=void 0!==a?a:null,this.autoplay=!0,this.volume=1,this.playbackRate=1,this.startTime=0,this.loop=!0,this.detune=0,this.isPlaying=!1,this.hasPlaybackControl=!0,this.filters=[]}function Tr(a,r,h,d,y,b,R,k,M,H){void 0===r&&(r=l.CubeReflectionMapping);for(var X=[],oe=0;oe<6;oe++)X.push(document.createElement("canvas"));l.Texture.call(this,X,r,h,d,y,b,R,k,M,H),this.images=void 0!==a?a:[],this.size=512,this.flipY=!1,this.mode=6===this.images.length?Tr.CUBE:Tr.CROSS,this.images.length>0&&this.updateImages(),this.name="cubetexture",this.category="Cube"}function br(a,r,h,d){l.Object3D.call(this),this.name="cubecamera",this.type="CubeCamera",this.near=void 0!==a?a:.01,this.far=void 0!==r?r:1e4,this.resolution=void 0!==h?h:256,this.autoUpdate=void 0!==d&&d,this.cameras=[];for(var y=0;y<6;y++){var b=new l.PerspectiveCamera(90,1,this.near,this.far);b.parent=this,this.cameras.push(b)}this.cameras[0].up.set(0,-1,0),this.cameras[0].lookAt(new l.Vector3(1,0,0)),this.cameras[1].up.set(0,-1,0),this.cameras[1].lookAt(new l.Vector3(-1,0,0)),this.cameras[2].up.set(0,0,1),this.cameras[2].lookAt(new l.Vector3(0,1,0)),this.cameras[3].up.set(0,0,-1),this.cameras[3].lookAt(new l.Vector3(0,-1,0)),this.cameras[4].up.set(0,-1,0),this.cameras[4].lookAt(new l.Vector3(0,0,1)),this.cameras[5].up.set(0,-1,0),this.cameras[5].lookAt(new l.Vector3(0,0,-1)),this.renderTarget=new l.WebGLCubeRenderTarget(this.resolution,{format:l.RGBFormat,magFilter:l.LinearFilter,minFilter:l.LinearFilter,generateMipmaps:!1});var R=this;Object.defineProperties(this,{cube:{get:function(){return R.renderTarget.texture},set:function(){}}}),this.scene=null,this.renderer=null}function rl(a,r){l.DirectionalLight.call(this,a,r),this.name="directional",this.castShadow=!0,this.shadow.camera.near=.5,this.shadow.camera.far=1e4}Bn.isLocalFile=function(a){return!(a.startsWith("http")||a.startsWith("blob")||a.startsWith("data"))},Bn.readFile=function(a,r,h,d,y){if(void 0===r&&(r=!0),Bn.fs&&Bn.isLocalFile(a)){if(!0===r){var b=Bn.fs.readFileSync(a,"utf8");return void 0!==h&&h(b),b}return Bn.fs.readFile(a,"utf8",function(k,M){null!==k?void 0!==y&&y(k):void 0!==h&&h(M)}),null}var R=new XMLHttpRequest;return R.overrideMimeType("text/plain"),R.open("GET",a,!r),void 0!==h&&(R.onload=function(){h(R.response)}),void 0!==d&&(R.onprogress=d),void 0!==y&&(R.onerror=y),R.send(null),!0===r?R.response:null},Bn.readFileArrayBuffer=function(a,r,h,d,y){if(void 0===r&&(r=!0),Bn.fs&&Bn.isLocalFile(a)){if(!0===r){var b=Bn.fs.readFileSync(a);return aa.fromBuffer(b)}return Bn.fs.readFile(a,function(k,M){null!==k?void 0!==y&&y(k):void 0!==h&&h(aa.fromBuffer(M))}),null}var R=new XMLHttpRequest;return R.open("GET",a,!r),R.overrideMimeType("text/plain; charset=x-user-defined"),void 0!==h&&(R.onload=function(){h(aa.fromBinaryString(R.response))}),void 0!==d&&(R.onprogress=d),void 0!==y&&(R.onerror=y),R.send(null),!0===r?aa.fromBinaryString(R.response):null},Bn.readFileBase64=function(a,r,h,d,y){if(void 0===r&&(r=!0),Bn.fs&&Bn.isLocalFile(a)){if(!0===r){var b=Bn.fs.readFileSync(a);return new Buffer(b).toString("base64")}return Bn.fs.readFile(a,function(k,M){null!==k?void 0!==y&&y(k):void 0!==h&&h(new Buffer(M).toString("base64"))}),null}var R=new XMLHttpRequest;return R.open("GET",a,!r),R.overrideMimeType("text/plain; charset=x-user-defined"),void 0!==h&&(R.onload=function(){h(ai.fromBinaryString(R.response))}),void 0!==d&&(R.onprogress=d),void 0!==y&&(R.onerror=y),R.send(null),!0===r?ai.fromBinaryString(R.response):null},Bn.writeFile=function(a,r,h,d){if(Bn.fs)if(void 0!==Bn.fs.writeFileSync)!1!==h?(Bn.fs.writeFileSync(a,r,"utf8"),void 0!==d&&d()):Bn.fs.writeFile(a,r,"utf8",d);else{var y=Bn.fs.createWriteStream(a,"utf8");y.write(r),y.end()}else{var b=new Blob([r],{type:"octet/stream"}),R=document.createElement("a");R.download=a,R.href=window.URL.createObjectURL(b),R.style.display="none",R.onclick=function(){document.body.removeChild(this)},document.body.appendChild(R),R.click(),void 0!==d&&d()}},Bn.writeFileBase64=function(a,r,h,d){if(Bn.fs){var y=Buffer.from(ai.removeHeader(r),"base64");if(void 0!==Bn.fs.writeFile)!1!==h?(Bn.fs.writeFileSync(a,y),void 0!==d&&d()):Bn.fs.writeFile(a,y,d);else{var b=Bn.fs.createWriteStream(a);b.write(y),b.end()}}else{var R=aa.fromBase64(ai.removeHeader(r)),k=new Blob([R]),M=document.createElement("a");M.download=a,M.href=window.URL.createObjectURL(k),M.onclick=function(){document.body.removeChild(this)},M.style.display="none",document.body.appendChild(M),M.click(),void 0!==d&&d()}},Bn.writeFileArrayBuffer=function(a,r,h,d){if(Bn.fs){var y=Fa.fromArrayBuffer(r);if(void 0!==Bn.fs.writeFileSync)!1!==h?(Bn.fs.writeFileSync(a,y),void 0!==d&&d()):Bn.fs.writeFile(a,y,d);else{var b=Bn.fs.createWriteStream(a);b.write(y),b.end()}}else{var R=new Blob([r]),k=document.createElement("a");k.download=a,k.href=window.URL.createObjectURL(R),k.onclick=function(){document.body.removeChild(this)},k.style.display="none",document.body.appendChild(k),k.click(),void 0!==d&&d()}},Bn.chooseFileWrite=function(a,r){ho.runningOnDesktop()?Bn.chooseFile(function(h){h.length>0&&a(h[0].path)},r,!0):Bn.chooseFileName(function(h){a(h)},r)},Bn.chooseDirectory=function(){return new Promise(function(a,r){var h=document.createElement("input");h.type="file",h.style.display="none",h.nwdirectory=!0,document.body.appendChild(h),h.onchange=function(){a(h.value),document.body.removeChild(h)},h.onerror=r,h.onabort=r,h.click()})},Bn.chooseFile=function(a,r,h,d){var y=document.createElement("input");y.type="file",y.style.display="none",document.body.appendChild(y),void 0!==r&&(y.accept=r),!0===d&&(y.multiple=!0),y.onchange=function(){void 0!==a&&a(y.files),document.body.removeChild(y)},void 0!==h&&(y.nwsaveas=!0!==h?h:"file"),y.click()},Bn.chooseFileName=function(a,r,h){var d=prompt("Save As",void 0!==h?h:"file");null!==d&&(void 0===r||d.endsWith(r)||(d+=r),void 0!==a&&a(d))},Bn.copyFile=function(a,r){Bn.fs&&(void 0!==Bn.fs.copyFileSync?Bn.fs.copyFileSync(a,r):(a.replace(new RegExp("/","g"),"\\"),r.replace(new RegExp("/","g"),"\\"),Bn.fs.createReadStream(a).pipe(Bn.fs.createWriteStream(r))))},Bn.makeDirectory=function(a){Bn.fs&&(a.replace(new RegExp("/","g"),"\\"),Bn.fs.mkdirSync(a,{recursive:!0}))},Bn.getFilesDirectory=function(a){if(Bn.fs)try{return a.replace(new RegExp("/","g"),"\\"),Bn.fs.readdirSync(a)}catch{return[]}return[]},Bn.deleteFolder=function(a){Bn.fs&&Bn.fs.existsSync(a)&&(Bn.fs.readdirSync(a).forEach(function(r){var h=a+"/"+r;Bn.fs.lstatSync(h).isDirectory()?Bn.deleteFolder(h):Bn.fs.unlinkSync(h)}),Bn.fs.rmdirSync(a))},Bn.copyFolder=function(a,r){if(Bn.fs){a.replace(new RegExp("/","g"),"\\"),r.replace(new RegExp("/","g"),"\\"),Bn.makeDirectory(r);for(var h=Bn.fs.readdirSync(a),d=0;d<h.length;d++){var y=a+"\\"+h[d],b=r+"\\"+h[d],R=Bn.fs.statSync(y);R.isDirectory()?Bn.copyFolder(y,b):R.isSymbolicLink()?Bn.fs.symlinkSync(Bn.fs.readlinkSync(y),b):Bn.copyFile(y,b)}}},Bn.fileExists=function(a){return!!Bn.fs&&(a.replace(new RegExp("/","g"),"\\"),Bn.fs.existsSync(a))},Bn.getFileName=function(a){if(void 0!==a){a instanceof File&&(a=a.name);var r=a.lastIndexOf("\\"),h=a.lastIndexOf("/");return a.substring(r>h?r+1:h+1,a.lastIndexOf("."))}return""},Bn.getFileNameWithExtension=function(a){if(void 0!==a){a instanceof File&&(a=a.name);var r=a.lastIndexOf("\\"),h=a.lastIndexOf("/");return a.substring(r>h?r+1:h+1,a.length)}return""},Bn.getNameWithoutExtension=function(a){return void 0!==a?(a instanceof File&&(a=a.name),a.substring(0,a.lastIndexOf("."))):""},Bn.getFilePath=function(a){if(void 0!==a){a instanceof File&&(a=a.name);var r=a.lastIndexOf("\\"),h=a.lastIndexOf("/");return a.substring(0,r>h?r+1:h+1)}return""},Bn.getFileExtension=function(a){return void 0!==a?(a instanceof File&&(a=a.name),a.substring(a.lastIndexOf(".")+1,a.length).toLowerCase()):""},vi.prototype.export=function(a){"base64"===this.format?Bn.writeFileBase64(a,this.data):"arraybuffer"===this.format?Bn.writeFileArrayBuffer(a,void 0!==this.arraybuffer?this.arraybuffer:this.data):"string"===this.format?Bn.writeFile(a,this.data):"json"===this.format?Bn.writeFile(a,JSON.stringify(this.data)):"url"===this.format&&Bn.writeFileArrayBuffer(a,Bn.readFileArrayBuffer(this.data))},vi.prototype.dispose=function(){},vi.prototype.toJSON=function(a){var r={};return r.name=this.name,r.uuid=this.uuid,r.type=this.type,r},gs.prototype=Object.create(vi.prototype),gs.fileIsImage=function(a){return void 0!==a&&(!!a.type.startsWith("image")||(a=a.name.toLocaleLowerCase()).endsWith("tga")||a.endsWith("dds")||a.endsWith("pvr")||a.endsWith("ktx")||a.endsWith("basis"))},gs.prototype.getImageSize=function(a){if(this.width>-1&&this.height>-1)a(this.width,this.height);else{var r=this,h=document.createElement("img");h.src=this.data,h.onload=function(){r.width=h.naturalWidth,r.height=h.naturalHeight,a(r.width,r.height)}}},gs.prototype.getImageData=function(a){var r=this,h=document.createElement("img");h.src=this.data,h.onload=function(){r.width=h.naturalWidth,r.height=h.naturalHeight;var d=document.createElement("canvas");d.width=h.naturalWidth,d.height=h.naturalWidth;var y=d.getContext("2d");y.drawImage(h,0,0,h.width,h.height),a(y.getImageData(0,0,h.width,h.height),r.width,r.height)}},gs.prototype.createSolidColor=function(a){var r=document.createElement("canvas");r.width=1,r.height=1;var h=r.getContext("2d");h.fillStyle=void 0!==a?a:Gc.randomColor(),h.fillRect(0,0,1,1),this.data=r.toDataURL("image/png"),this.format="base64",this.encoding="png"},gs.prototype.loadArrayBufferData=function(a,r){var h=new Uint8Array(a),d=new Blob([h],{type:"image/"+r});this.data=URL.createObjectURL(d),this.arraybuffer=a,this.encoding=void 0!==r?r:"",this.format="arraybuffer"},gs.prototype.hasTransparency=function(a){if(!0===a&&this.width>-1&&this.height>-1){var r=document.createElement("img"),h=document.createElement("canvas");h.width=r.width,h.height=r.height;var d=h.getContext("2d");d.drawImage(r,0,0,r.width,r.height);for(var y=d.getImageData(0,0,r.width,r.height).data,b=3;b<y.length;b+=4)if(255!==y[b])return!0;return!1}return"png"===this.encoding||"gif"===this.encoding},gs.prototype.compressJPEG=function(a){var r=document.createElement("img");r.src=this.data;var h=document.createElement("canvas");h.width=r.width,h.height=r.height,h.getContext("2d").drawImage(r,0,0,r.width,r.height);var d=this;h.toBlob(function(y){var b=new FileReader;b.onload=function(){d.encoding="jpeg",d.format="arraybuffer",d.data=b.result},b.readAsArrayBuffer(y)},"image/jpeg",void 0!==a?a:.7)},gs.prototype.dispose=function(){"arraybuffer"===this.format&&URL.revokeObjectURL(this.data)},gs.prototype.toJSON=function(a){if(void 0!==a.images[this.uuid])return a.images[this.uuid];var r=vi.prototype.toJSON.call(this,a);return"url"===this.format&&this.loadArrayBufferData(Bn.readFileArrayBuffer(this.data),this.encoding),r.width=this.width,r.height=this.height,r.encoding=this.encoding,"arraybuffer"===this.format?(r.format=this.format,r.data=this.arraybuffer):"base64"===this.format?(r.format="arraybuffer",r.data=aa.fromBase64(ai.removeHeader(this.data))):(r.format=this.format,r.data=this.data),a.images[this.uuid]=r,r},vs.prototype=Object.create(l.Texture.prototype),vs.isTexture=!0,vs.prototype.updateSource=function(){if(null!==this.source){var a=this;this.image.crossOrigin="anonymous",this.image.src=this.source.data,this.image.onload=function(){a.needsUpdate=!0},this.image.onerror=function(){console.log("nunuStudio: Failed to load image "+a.source.uuid+" data."),a.source.createSolidColor(),a.image.src=a.source.data,a.needsUpdate=!0}}else console.warn("nunuStudio: Texture source is null."),this.source.createSolidColor(),this.image.src=a.source.data,this.needsUpdate=!0},vs.prototype.dispose=function(){l.Texture.prototype.dispose.call(this),this.disposed=!0},vs.prototype.toJSON=function(a){var r=l.Texture.prototype.toJSON.call(this,a),h=this.source.toJSON(a);return r.image=h.uuid,r},$s.prototype=Object.create(l.AmbientLight.prototype),ni.prototype=Object.create(l.Object3D.prototype),ni.SOURCE={EMPTY:"empty",BUFFER:"buffer",NODE:"audioNode"},ni.prototype.onEnded=function(){this.isPlaying=!1},ni.prototype.connect=function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var a=1,r=this.filters.length;a<r;a++)this.filters[a-1].connect(this.filters[a]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},ni.prototype.disconnect=function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var a=1,r=this.filters.length;a<r;a++)this.filters[a-1].disconnect(this.filters[a]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},ni.prototype.initialize=function(){if(null!==this.audio){var a=this;this.audio.getAudioBuffer(this.context,function(r){a.setBuffer(r)})}else console.warn("nunuStudio: AudioEmitter audio is null.");this.setVolume(this.volume),this.setPlaybackRate(this.playbackRate),l.Object3D.prototype.initialize.call(this)},ni.prototype.setBuffer=function(a){return this.buffer=a,this.sourceType="buffer",!0===this.autoplay&&this.play(),this},ni.prototype.play=function(){if(null!==this.buffer){this.isPlaying&&console.warn("nunuStudio: Audio is already playing, its only possible to control the last playing instance.");var a=this.context.createBufferSource();return a.buffer=this.buffer,a.detune.value=this.detune,a.loop=this.loop,a.onended=this.onEnded.bind(this),a.playbackRate.setValueAtTime(this.playbackRate,this.startTime),a.start(0,this.startTime),this.isPlaying=!0,this.source=a,this.connect()}console.warn("nunuStudio: Audio buffer not ready, audio will not play.")},ni.prototype.pause=function(){return this.source.stop(),this.startTime=this.context.currentTime,this.isPlaying=!1,this},ni.prototype.stop=function(){return this.source.stop(),this.startTime=0,this.isPlaying=!1,this},ni.prototype.setAudio=function(a){this.audio=a,null!==this.buffer&&(this.isPlaying&&this.stop(),this.disconnect());var r=this;this.audio.getAudioBuffer(this.context,function(h){r.setBuffer(h)})},ni.prototype.getVolume=function(){return this.gain.gain.value},ni.prototype.setVolume=function(a){return this.volume=a,this.gain.gain.value=a,this},ni.prototype.setLoop=function(a){return this.loop=a,this.isPlaying&&(this.source.loop=this.loop),this},ni.prototype.setDetune=function(a){return this.detune=a,!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},ni.prototype.getLoop=function(){return this.loop},ni.prototype.setPlaybackRate=function(a){return this.playbackRate=a,this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this},ni.prototype.getPlaybackRate=function(){return this.playbackRate},ni.prototype.getFilters=function(){return this.filters},ni.prototype.setFilters=function(a){return a||(a=[]),this.isPlaying?(this.disconnect(),this.filters=a,this.connect()):this.filters=a,this},ni.prototype.getFilter=function(a){return this.getFilters()[void 0!==a?a:0]},ni.prototype.setFilter=function(a){return this.setFilters(a?[a]:[])},ni.prototype.setNodeSource=function(a){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=a,this.connect(),this},ni.prototype.getOutput=function(){return this.gain},ni.prototype.dispose=function(){this.isPlaying&&(this.stop(),this.disconnect()),l.Object3D.prototype.dispose.call(this)},ni.prototype.toJSON=function(a){var r=this.audio,h=l.Object3D.prototype.toJSON.call(this,a,function(d,y){r=r.toJSON(d)});return h.object.audio=r.uuid,h.object.volume=this.volume,h.object.autoplay=this.autoplay,h.object.startTime=this.startTime,h.object.playbackRate=this.playbackRate,h.object.loop=this.loop,h},(Tr.prototype=Object.create(l.Texture.prototype)).constructor=Tr,Tr.prototype.isCubeTexture=!0,Tr.RIGHT=0,Tr.LEFT=1,Tr.TOP=2,Tr.BOTTOM=3,Tr.FRONT=4,Tr.BACK=5,Tr.CUBE=20,Tr.CROSS=21,Tr.EQUIRECTANGULAR=22,Tr.prototype.setSize=function(a){a&a-1?console.warn("nunuStudio: CubeTexture new size is not a power of two."):this.size=a},Tr.prototype.setImages=function(a,r){this.mode=void 0!==r?r:Tr.CUBE,this.images=a},Tr.prototype.updateImages=function(){var a=this;if(this.mode===Tr.CUBE)for(var r=0;r<this.images.length;r++)"string"==typeof this.images[r]&&(this.images[r]=new gs(this.images[r])),(h=document.createElement("img")).crossOrigin="anonymous",h.index=r,h.src=this.images[r].data,h.onload=function(){a.image[this.index].width=a.size,a.image[this.index].height=a.size,a.image[this.index].getContext("2d").drawImage(this,0,0,a.size,a.size),a.needsUpdate=!0};else if(this.mode===Tr.CROSS){for(r=0;r<this.image.length;r++)this.image[r].width=this.size,this.image[r].height=this.size;(h=document.createElement("img")).src=this.images[0].data,h.onload=function(){var d=this.naturalWidth/4,y=this.naturalHeight/3;a.image[Tr.LEFT].getContext("2d").drawImage(this,0,y,d,y,0,0,a.size,a.size),a.image[Tr.FRONT].getContext("2d").drawImage(this,d,y,d,y,0,0,a.size,a.size),a.image[Tr.RIGHT].getContext("2d").drawImage(this,2*d,y,d,y,0,0,a.size,a.size),a.image[Tr.BACK].getContext("2d").drawImage(this,3*d,y,d,y,0,0,a.size,a.size),a.image[Tr.TOP].getContext("2d").drawImage(this,d,0,d,y,0,0,a.size,a.size),a.image[Tr.BOTTOM].getContext("2d").drawImage(this,d,2*y,d,y,0,0,a.size,a.size),a.needsUpdate=!0}}else if(this.mode===Tr.EQUIRECTANGULAR){for(r=0;r<this.image.length;r++)this.image[r].width=this.size,this.image[r].height=this.size;var h;(h=document.createElement("img")).src=this.images[0].data,h.onload=function(){var d=document.createElement("canvas");d.width=h.naturalWidth,d.height=h.naturalHeight;var y=d.getContext("2d");y.drawImage(h,0,0);for(var b=y.getImageData(0,0,d.width,d.height),R=0;R<6;R++){var k=Tr.renderEquirectFace(b,R,Math.PI,a.size);a.image[R].getContext("2d").putImageData(k,0,0)}a.needsUpdate=!0}}},Tr.resampleBilinear=function(a,r,h,d,y){for(var b=a.width,R=a.height,k=a.data,M=l.Math.clamp(Math.floor(h),0,b-1),H=l.Math.clamp(Math.ceil(h),0,b-1),X=h-M,oe=l.Math.clamp(Math.floor(d),0,R-1),ne=l.Math.clamp(Math.ceil(d),0,R-1),ge=d-oe,we=4*(oe*b+M),Se=4*(oe*b+H),Ce=4*(ne*b+M),Pe=4*(ne*b+H),Re=0;Re<3;Re++)r.data[y+Re]=Math.ceil((k[we+Re]*(1-X)+k[Se+Re]*X)*(1-ge)+(k[Ce+Re]*(1-X)+k[Pe+Re]*X)*ge)},Tr.renderEquirectFace=function(a,r,h,d){for(var y=new ImageData(d,d),b=Tr.faces[r],R=0;R<d;R++)for(var k=0;k<d;k++){var M=4*(k*d+R);y.data[M+3]=255;var H=b(2*(R+.5)/d-1,2*(k+.5)/d-1),X=Math.sqrt(H.x*H.x+H.y*H.y+H.z*H.z),oe=l.Math.euclideanModulo(Math.atan2(H.y,H.x)+h,2*Math.PI),ne=Math.acos(H.z/X),ge=a.width*oe/Math.PI/2-.5,we=a.height*ne/Math.PI-.5;Tr.resampleBilinear(a,y,ge,we,M)}return y},Tr.faces=[function(a,r){return new l.Vector3(a,-1,-r)},function(a,r){return new l.Vector3(-a,1,-r)},function(a,r){return new l.Vector3(-r,-a,1)},function(a,r){return new l.Vector3(r,-a,-1)},function(a,r){return new l.Vector3(-1,-a,-r)},function(a,r){return new l.Vector3(1,a,-r)}],Tr.prototype.toJSON=function(a){var r=l.Texture.prototype.toJSON.call(this,a);if(r.size=this.size,r.mode=this.mode,r.images=[],this.mode===Tr.EQUIRECTANGULAR||this.mode===Tr.CROSS){var h=this.images[0].toJSON(a);r.images.push(h.uuid)}else for(var d=0;d<this.images.length;d++)h=this.images[d].toJSON(a),r.images.push(h.uuid);return r},(br.prototype=Object.create(l.Object3D.prototype)).initialize=function(){for(var a=this;null!==a.parent;)(a=a.parent)instanceof bs?this.scene=a:a instanceof Qr&&(this.renderer=a.renderer);l.Object3D.prototype.initialize.call(this)},br.prototype.update=function(a){this.autoUpdate&&this.updateCubeMap(this.renderer,this.scene),l.Object3D.prototype.update.call(this,a)},br.prototype.setResolution=function(a){this.resolution=a,this.renderTarget.setSize(a,a)},br.prototype.clear=function(a,r,h,d){for(var y=a.getRenderTarget(),b=0;b<6;b++)a.setRenderTarget(this.renderTarget,b),a.clear(r,h,d);a.setRenderTarget(y)},br.prototype.updateCubeMap=function(a,r){var h=a.autoClear;a.autoClear=!1;var d=a.getRenderTarget(),y=this.renderTarget.texture.generateMipmaps;this.renderTarget.texture.generateMipmaps=!1;for(var b=0;b<6;b++)5===b&&(this.renderTarget.texture.generateMipmaps=y),this.cameras[b].updateMatrixWorld(),a.setRenderTarget(this.renderTarget,b),a.clear(!0,!0,!0),a.render(r,this.cameras[b]);a.autoClear=h,a.setRenderTarget(d)},br.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);return r.object.near=this.near,r.object.far=this.far,r.object.resolution=this.resolution,r.object.autoUpdate=this.autoUpdate,r},(rl.prototype=Object.create(l.DirectionalLight.prototype)).updateShadowMap=function(){this.shadow.map.dispose(),this.shadow.map=null,this.shadow.camera.updateProjectionMatrix()};var bc,th,Da,ts={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tgl_FragColor = opacity * texel;","}"].join("\n")};function Bi(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}Object.assign(Bi.prototype,{setSize:function(){},render:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}),Bi.FullScreenQuad=(bc=new l.OrthographicCamera(-1,1,1,-1,0,1),th=new l.PlaneBufferGeometry(2,2),Da=function(a){this._mesh=new l.Mesh(th,a)},Object.defineProperty(Da.prototype,"material",{get:function(){return this._mesh.material},set:function(a){this._mesh.material=a}}),Object.assign(Da.prototype,{dispose:function(){this._mesh.geometry.dispose()},render:function(a){a.render(this._mesh,bc)}}),Da);var tp=function(a,r){Bi.call(this),this.scene=a,this.camera=r,this.clear=!0,this.needsSwap=!1,this.inverse=!1};tp.prototype=Object.assign(Object.create(Bi.prototype),{constructor:tp,render:function(a,r,h){var d,y,b=a.getContext(),R=a.state;R.buffers.color.setMask(!1),R.buffers.depth.setMask(!1),R.buffers.color.setLocked(!0),R.buffers.depth.setLocked(!0),this.inverse?(d=0,y=1):(d=1,y=0),R.buffers.stencil.setTest(!0),R.buffers.stencil.setOp(b.REPLACE,b.REPLACE,b.REPLACE),R.buffers.stencil.setFunc(b.ALWAYS,d,4294967295),R.buffers.stencil.setClear(y),R.buffers.stencil.setLocked(!0),a.setRenderTarget(h),this.clear&&a.clear(),a.render(this.scene,this.camera),a.setRenderTarget(r),this.clear&&a.clear(),a.render(this.scene,this.camera),R.buffers.color.setLocked(!1),R.buffers.depth.setLocked(!1),R.buffers.stencil.setLocked(!1),R.buffers.stencil.setFunc(b.EQUAL,1,4294967295),R.buffers.stencil.setOp(b.KEEP,b.KEEP,b.KEEP),R.buffers.stencil.setLocked(!0)}});var Mh=function(){Bi.call(this),this.needsSwap=!1};function np(){this.autoClear=!1,this.autoClearColor=!1,this.autoClearStencil=!1,this.autoClearDepth=!1,this.sortObjects=!0,this.clearColor=new l.Color,this.clearAlpha=1}function fr(){this.uuid=l.Math.generateUUID(),this.type="Pass",this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1,this.copyToScreen=!1}function qo(a,r){fr.call(this),this.type="Shader",this.textureID=void 0!==r?r:"tDiffuse",a instanceof l.ShaderMaterial?(this.uniforms=a.uniforms,this.material=a):a&&(this.uniforms=l.UniformsUtils.clone(a.uniforms),this.material=new l.ShaderMaterial({defines:Object.assign({},a.defines),uniforms:this.uniforms,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader})),this.createQuadScene()}function il(){fr.call(this),this.type="Render",this.clear=!0}Mh.prototype=Object.create(Bi.prototype),Object.assign(Mh.prototype,{render:function(a){a.state.buffers.stencil.setLocked(!1),a.state.buffers.stencil.setTest(!1)}}),np.prototype.backup=function(a){this.autoClear=a.autoClear,this.autoClearColor=a.autoClearColor,this.autoClearStencil=a.autoClearStencil,this.autoClearDepth=a.autoClearDepth,this.sortObjects=a.sortObjects,this.clearColor.copy(a.getClearColor()),this.clearAlpha=a.getClearAlpha()},np.prototype.restore=function(a){a.autoClear=this.autoClear,a.autoClearColor=this.autoClearColor,a.autoClearStencil=this.autoClearStencil,a.autoClearDepth=this.autoClearDepth,a.sortObjects=this.sortObjects,a.setClearColor(this.clearColor),a.setClearAlpha(this.clearAlpha)},fr.RGBALinear={minFilter:l.LinearFilter,magFilter:l.LinearFilter,format:l.RGBAFormat},fr.RGBLinear={minFilter:l.LinearFilter,magFilter:l.LinearFilter,format:l.RGBFormat},fr.RGBANearest={minFilter:l.NearestFilter,magFilter:l.NearestFilter,format:l.RGBAFormat},fr.prototype.createQuadScene=function(){this.camera=new l.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new l.Scene,this.quad=new l.Mesh(new l.PlaneBufferGeometry(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)},fr.prototype.setSize=function(a,r){},fr.prototype.render=function(a,r,h,d,y,b,R){},fr.prototype.dispose=function(){},fr.prototype.toJSON=function(a){var r={};return r.uuid=this.uuid,r.type=this.type,r.clear=this.clear,r.enabled=this.enabled,r.needsSwap=this.needsSwap,r.renderToScreen=this.renderToScreen,r.copyToScreen=this.copyToScreen,r},(qo.prototype=Object.create(fr.prototype)).render=function(a,r,h,d,y,b,R){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=h.texture),this.quad.material=this.material,a.setRenderTarget(this.renderToScreen?null:r),this.clear&&a.clear(),a.render(this.scene,this.camera)},(il.prototype=Object.create(fr.prototype)).render=function(a,r,h,d,y,b,R){this.clear?(a.autoClear=!0,a.autoClearColor=!0,a.autoClearDepth=!0,a.autoClearStencil=!0):a.autoClear=!1,a.setRenderTarget(this.renderToScreen?null:r),a.render(b,R)};var Fr={shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new l.Color(0)},defaultOpacity:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec3 defaultColor;","uniform float defaultOpacity;","uniform float luminosityThreshold;","uniform float smoothWidth;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tvec3 luma = vec3( 0.299, 0.587, 0.114 );","\tfloat v = dot( texel.xyz, luma );","\tvec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );","\tfloat alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );","\tgl_FragColor = mix( outputColor, texel, alpha );","}"].join("\n")};function Cs(a,r,h){fr.call(this),this.type="UnrealBloom",this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5;for(var d=0;d<this.nMips;d++){var y;(y=new l.WebGLRenderTarget(0,0,fr.RGBALinear)).texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(y),(y=new l.WebGLRenderTarget(0,0,fr.RGBALinear)).texture.generateMipmaps=!1,this.renderTargetsVertical.push(y)}this.renderTargetBright=new l.WebGLRenderTarget(0,0,fr.RGBALinear),this.renderTargetBright.texture.generateMipmaps=!1;var b=Fr;this.highPassUniforms=l.UniformsUtils.clone(b.uniforms),this.materialHighPassFilter=new l.ShaderMaterial({uniforms:this.highPassUniforms,vertexShader:b.vertexShader,fragmentShader:b.fragmentShader,defines:{}}),this.separableBlurMaterials=[];var R=[3,5,7,9,11];for(d=0;d<this.nMips;d++)this.separableBlurMaterials.push(Cs.getSeperableBlurMaterial(R[d])),this.separableBlurMaterials[d].uniforms.texSize.value=new l.Vector2(0,0);this.compositeMaterial=Cs.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.highPassUniforms.luminosityThreshold.value=void 0!==h?h:.7,this.highPassUniforms.smoothWidth.value=.01,this.compositeMaterial.uniforms.bloomStrength.value=void 0!==a?a:.8,this.compositeMaterial.uniforms.bloomRadius.value=void 0!==r?r:.3,this.compositeMaterial.uniforms.bloomFactors.value=[1,.8,.6,.4,.2],this.compositeMaterial.uniforms.bloomTintColors.value=[new l.Vector3(1,1,1),new l.Vector3(1,1,1),new l.Vector3(1,1,1),new l.Vector3(1,1,1),new l.Vector3(1,1,1)],this.compositeMaterial.needsUpdate=!0,this.copyUniforms=l.UniformsUtils.clone(ts.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new l.ShaderMaterial({uniforms:this.copyUniforms,vertexShader:ts.vertexShader,fragmentShader:ts.fragmentShader,blending:l.AdditiveBlending,depthTest:!1,depthWrite:!1,transparent:!0}),this.createQuadScene(),this.basic=new l.MeshBasicMaterial,Object.defineProperties(this,{strength:{get:function(){return this.compositeMaterial.uniforms.bloomStrength.value},set:function(k){this.compositeMaterial.uniforms.bloomStrength.value=k}},radius:{get:function(){return this.compositeMaterial.uniforms.bloomRadius.value},set:function(k){this.compositeMaterial.uniforms.bloomRadius.value=k}},threshold:{get:function(){return this.highPassUniforms.luminosityThreshold.value},set:function(k){}},smooth:{get:function(){return this.highPassUniforms.smoothWidth.value},set:function(k){}},bloomFactors:{get:function(){return this.compositeMaterial.uniforms.bloomFactors.value},set:function(k){}},bloomTintColors:{get:function(){return this.compositeMaterial.uniforms.bloomTintColors.value},set:function(k){this.compositeMaterial.uniforms.bloomTintColors.value=k}}})}Cs.prototype=Object.create(fr.prototype),Cs.BlurDirectionX=new l.Vector2(1,0),Cs.BlurDirectionY=new l.Vector2(0,1),Cs.prototype.dispose=function(){for(var a=0;a<this.renderTargetsHorizontal.length;a++)this.renderTargetsHorizontal[a].dispose();for(a=0;a<this.renderTargetsVertical.length;a++)this.renderTargetsVertical[a].dispose();this.renderTargetBright.dispose()},Cs.prototype.setSize=function(a,r){var h=Math.round(a/2),d=Math.round(r/2);this.renderTargetBright.setSize(h,d);for(var y=0;y<this.nMips;y++)this.renderTargetsHorizontal[y].setSize(h,d),this.renderTargetsVertical[y].setSize(h,d),this.separableBlurMaterials[y].uniforms.texSize.value.set(h,d),h=Math.round(h/2),d=Math.round(d/2)},Cs.prototype.render=function(a,r,h,d,y,b,R){a.autoClear=!1,a.setClearColor(new l.Color(0,0,0),0),y&&a.context.disable(a.context.STENCIL_TEST),this.renderToScreen&&(this.quad.material=this.basic,this.basic.map=h.texture,a.setRenderTarget(null),a.clear(),a.render(this.scene,this.camera)),this.highPassUniforms.tDiffuse.value=h.texture,this.quad.material=this.materialHighPassFilter,a.setRenderTarget(this.renderTargetBright),a.clear(),a.render(this.scene,this.camera);for(var k=this.renderTargetBright,M=0;M<this.nMips;M++)this.quad.material=this.separableBlurMaterials[M],this.separableBlurMaterials[M].uniforms.colorTexture.value=k.texture,this.separableBlurMaterials[M].uniforms.direction.value=Cs.BlurDirectionX,a.setRenderTarget(this.renderTargetsHorizontal[M]),a.clear(),a.render(this.scene,this.camera),this.separableBlurMaterials[M].uniforms.colorTexture.value=this.renderTargetsHorizontal[M].texture,this.separableBlurMaterials[M].uniforms.direction.value=Cs.BlurDirectionY,a.setRenderTarget(this.renderTargetsVertical[M]),a.clear(),a.render(this.scene,this.camera),k=this.renderTargetsVertical[M];this.quad.material=this.compositeMaterial,a.setRenderTarget(this.renderTargetsHorizontal[0]),a.render(this.scene,this.camera),this.quad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,y&&a.context.enable(a.context.STENCIL_TEST),a.setRenderTarget(this.renderToScreen?null:h),a.render(this.scene,this.camera)},Cs.prototype.toJSON=function(a){var r=fr.prototype.toJSON.call(this,a);r.strength=this.strength,r.radius=this.radius,r.threshold=this.threshold,r.bloomFactors=this.bloomFactors,r.bloomTintColors=[];for(var h=0;h<this.bloomTintColors.length;h++)r.bloomTintColors.push(this.bloomTintColors[h].toArray());return r},Cs.getSeperableBlurMaterial=function(a){return new l.ShaderMaterial({defines:{KERNEL_RADIUS:a,SIGMA:a},uniforms:{colorTexture:{value:null},texSize:{value:new l.Vector2(.5,.5)},direction:{value:new l.Vector2(.5,.5)}},vertexShader:"\n\t\t\tvarying vec2 vUv;\n\t\t\tvoid main()\n\t\t\t{\n\t\t\t\tvUv = uv;\n\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\t\t\t}",fragmentShader:"\n\t\t\t#include <common>\n\t\t\tvarying vec2 vUv;\n\t\t\tuniform sampler2D colorTexture;\n\t\t\tuniform vec2 texSize;\n\t\t\tuniform vec2 direction;\n\t\t\t\n\t\t\tfloat gaussianPdf(in float x, in float sigma)\n\t\t\t{\n\t\t\t\treturn 0.39894 * exp(-0.5 * x * x / (sigma * sigma)) / sigma;\n\t\t\t}\n\t\t\t\n\t\t\tvoid main()\n\t\t\t{\n\t\t\t\tvec2 invSize = 1.0 / texSize;\n\t\t\t\tfloat fSigma = float(SIGMA);\n\t\t\t\tfloat weightSum = gaussianPdf(0.0, fSigma);\n\t\t\t\tvec3 diffuseSum = texture2D(colorTexture, vUv).rgb * weightSum;\n\t\t\t\tfor(int i = 1; i < KERNEL_RADIUS; i++)\n\t\t\t\t{\n\t\t\t\t\tfloat x = float(i);\n\t\t\t\t\tfloat w = gaussianPdf(x, fSigma);\n\t\t\t\t\tvec2 uvOffset = direction * invSize * x;\n\t\t\t\t\tvec3 sample1 = texture2D(colorTexture, vUv + uvOffset).rgb;\n\t\t\t\t\tvec3 sample2 = texture2D(colorTexture, vUv - uvOffset).rgb;\n\t\t\t\t\tdiffuseSum += (sample1 + sample2) * w;\n\t\t\t\t\tweightSum += 2.0 * w;\n\t\t\t\t}\n\t\t\t\tgl_FragColor = vec4(diffuseSum/weightSum, 1.0);\n\t\t\t}"})},Cs.getCompositeMaterial=function(a){return new l.ShaderMaterial({defines:{NUM_MIPS:a},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},dirtTexture:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:"\n\t\t\tvarying vec2 vUv;\n\t\t\tvoid main()\n\t\t\t{\n\t\t\t\tvUv = uv;\n\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\t\t\t}",fragmentShader:"\n\t\t\tvarying vec2 vUv;\n\t\t\tuniform sampler2D blurTexture1;\n\t\t\tuniform sampler2D blurTexture2;\n\t\t\tuniform sampler2D blurTexture3;\n\t\t\tuniform sampler2D blurTexture4;\n\t\t\tuniform sampler2D blurTexture5;\n\t\t\tuniform sampler2D dirtTexture;\n\t\t\tuniform float bloomStrength;\n\t\t\tuniform float bloomRadius;\n\t\t\tuniform float bloomFactors[NUM_MIPS];\n\t\t\tuniform vec3 bloomTintColors[NUM_MIPS];\n\t\t\t\n\t\t\tfloat lerpBloomFactor(const in float factor)\n\t\t\t{\n\t\t\t\tfloat mirrorFactor = 1.2 - factor;\n\t\t\t\treturn mix(factor, mirrorFactor, bloomRadius);\n\t\t\t}\n\t\t\t\n\t\t\tvoid main()\n\t\t\t{\n\t\t\t\tgl_FragColor = bloomStrength * (lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) + \n\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) + \n\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) + \n\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) + \n\t\t\t\t\t\t\t\t\t\t\t\t lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv));\n\t\t\t}"})};var nh={uniforms:{tDiffuse:{value:null}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 tex = texture2D( tDiffuse, vec2( vUv.x, vUv.y ) );","\tvec4 newTex = vec4(tex.r, (tex.g + tex.b) * .5, (tex.g + tex.b) * .5, 1.0);","\tgl_FragColor = newTex;","}"].join("\n")};function Hc(){qo.call(this,nh),this.type="Technicolor"}Hc.prototype=Object.create(qo.prototype);var Ls={uniforms:{tDiffuse:{value:null},tDepth:{value:null},size:{value:new l.Vector2(512,512)},cameraNear:{value:1},cameraFar:{value:100},radius:{value:32},onlyAO:{value:0},aoClamp:{value:.25},lumInfluence:{value:.7}},vertexShader:"varying vec2 vUv;\r\n\r\nvoid main()\r\n{\r\n\tvUv = uv;\r\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\r\n}",fragmentShader:"uniform float cameraNear;\r\nuniform float cameraFar;\r\n\r\n#ifdef USE_LOGDEPTHBUF\r\n\tuniform float logDepthBufFC;\r\n#endif\r\n\r\nuniform float radius; // ao radius \r\nuniform bool onlyAO; // use only ambient occlusion pass?\r\n\r\nuniform vec2 size; // texture width, height\r\nuniform float aoClamp; // depth clamp - reduces haloing at screen edges\r\n\r\nuniform float lumInfluence; // how much luminance affects occlusion\r\n\r\nuniform sampler2D tDiffuse;\r\nuniform sampler2D tDepth;\r\n\r\nvarying vec2 vUv;\r\n\r\n#define DL 2.399963229728653 // PI *(3.0 - sqrt(5.0))\r\n#define EULER 2.718281828459045\r\n\r\n// user variables\r\nconst int samples = 64; // ao sample count\r\nconst bool useNoise = true; // use noise instead of pattern for sample dithering\r\nconst float noiseAmount = 0.0004; // dithering amount\r\nconst float diffArea = 0.4; // self-shadowing reduction\r\nconst float gDisplace = 0.4; // gauss bell center\r\n\r\n// RGBA depth\r\n#include <packing>\r\n\r\n// generating noise / pattern texture for dithering\r\nvec2 rand(const vec2 coord)\r\n{\r\n\tvec2 noise;\r\n\r\n\tif(useNoise)\r\n\t{\r\n\t\tfloat nx = dot(coord, vec2(12.9898, 78.233));\r\n\t\tfloat ny = dot(coord, vec2(12.9898, 78.233) * 2.0);\r\n\t\tnoise = clamp(fract(43758.5453 * sin(vec2(nx, ny))), 0.0, 1.0);\r\n\t}\r\n\telse\r\n\t{\r\n\t\tfloat ff = fract(1.0 - coord.s *(size.x / 2.0));\r\n\t\tfloat gg = fract(coord.t *(size.y / 2.0));\r\n\t\tnoise = vec2(0.25, 0.75) * vec2(ff) + vec2(0.75, 0.25) * gg;\r\n\t}\r\n\r\n\treturn(noise * 2.0  - 1.0) * noiseAmount;\r\n}\r\n\r\nfloat readDepth(const in vec2 coord) {\r\n\r\n\tfloat cameraFarPlusNear = cameraFar + cameraNear;\r\n\tfloat cameraFarMinusNear = cameraFar - cameraNear;\r\n\tfloat cameraCoef = 2.0 * cameraNear;\r\n\r\n\t#ifdef USE_LOGDEPTHBUF\r\n\t\tfloat logz = unpackRGBAToDepth(texture2D(tDepth, coord));\r\n\t\tfloat w = pow(2.0, (logz / logDepthBufFC)) - 1.0;\r\n\t\tfloat z = (logz / w) + 1.0;\r\n\t#else\r\n\t\tfloat z = unpackRGBAToDepth(texture2D(tDepth, coord));\r\n\t#endif\r\n\r\n\treturn cameraCoef /(cameraFarPlusNear - z * cameraFarMinusNear);\r\n}\r\n\r\nfloat compareDepths(const in float depth1, const in float depth2, inout int far)\r\n{\r\n\tfloat garea = 8.0; // gauss bell width\r\n\tfloat diff =(depth1 - depth2) * 100.0; // depth difference (0-100)\r\n\r\n\t// reduce left bell width to avoid self-shadowing\r\n\tif(diff < gDisplace)\r\n\t{\r\n\t\tgarea = diffArea;\r\n\r\n\t}\r\n\telse\r\n\t{\r\n\t\tfar = 1;\r\n\t}\r\n\r\n\tfloat dd = diff - gDisplace;\r\n\tfloat gauss = pow(EULER, -2.0 *(dd * dd) /(garea * garea));\r\n\treturn gauss;\r\n}\r\n\r\nfloat calcAO(float depth, float dw, float dh)\r\n{\r\n\tvec2 vv = vec2(dw, dh);\r\n\tvec2 coord1 = vUv + radius * vv;\r\n\tvec2 coord2 = vUv - radius * vv;\r\n\r\n\tfloat temp1 = 0.0;\r\n\tfloat temp2 = 0.0;\r\n\r\n\tint far = 0;\r\n\ttemp1 = compareDepths(depth, readDepth(coord1), far);\r\n\r\n\t// DEPTH EXTRAPOLATION\r\n\tif(far > 0)\r\n\t{\r\n\t\ttemp2 = compareDepths(readDepth(coord2), depth, far);\r\n\t\ttemp1 +=(1.0 - temp1) * temp2;\r\n\t}\r\n\r\n\treturn temp1;\r\n}\r\n\r\nvoid main()\r\n{\r\n\tvec2 noise = rand(vUv);\r\n\tfloat depth = readDepth(vUv);\r\n\r\n\tfloat tt = clamp(depth, aoClamp, 1.0);\r\n\r\n\tfloat w =(1.0 / size.x) / tt +(noise.x *(1.0 - noise.x));\r\n\tfloat h =(1.0 / size.y) / tt +(noise.y *(1.0 - noise.y));\r\n\r\n\tfloat ao = 0.0;\r\n\r\n\tfloat dz = 1.0 / float(samples);\r\n\tfloat l = 0.0;\r\n\tfloat z = 1.0 - dz / 2.0;\r\n\r\n\tfor(int i = 0; i <= samples; i ++)\r\n\t{\r\n\t\tfloat r = sqrt(1.0 - z);\r\n\r\n\t\tfloat pw = cos(l) * r;\r\n\t\tfloat ph = sin(l) * r;\r\n\t\tao += calcAO(depth, pw * w, ph * h);\r\n\t\tz = z - dz;\r\n\t\tl = l + DL;\r\n\t}\r\n\r\n\tao /= float(samples);\r\n\tao = 1.0 - ao;\r\n\r\n\tvec3 color = texture2D(tDiffuse, vUv).rgb;\r\n\r\n\tvec3 lumcoeff = vec3(0.299, 0.587, 0.114);\r\n\tfloat lum = dot(color.rgb, lumcoeff);\r\n\tvec3 luminance = vec3(lum);\r\n\r\n\tvec3 final = vec3(color * mix(vec3(ao), vec3(1.0), luminance * lumInfluence)); // mix(color * ao, white, luminance)\r\n\r\n\tif(onlyAO)\r\n\t{\r\n\t\tfinal = vec3(mix(vec3(ao), vec3(1.0), luminance * lumInfluence)); // ambient occlusion only\r\n\t}\r\n\r\n\tgl_FragColor = vec4(final, 1.0);\r\n}"};function Po(){qo.call(this,Ls),this.type="SSAO",this.depthMaterial=new l.MeshDepthMaterial,this.depthMaterial.depthPacking=l.RGBADepthPacking,this.depthMaterial.blending=l.NoBlending,this.depthRenderTarget=new l.WebGLRenderTarget(2,2,{minFilter:l.LinearFilter,magFilter:l.LinearFilter}),this.uniforms.tDepth.value=this.depthRenderTarget.texture,this.uniforms.size.value.set(2,2),Object.defineProperties(this,{radius:{get:function(){return this.uniforms.radius.value},set:function(a){this.uniforms.radius.value=a}},onlyAO:{get:function(){return this.uniforms.onlyAO.value},set:function(a){this.uniforms.onlyAO.value=a}},aoClamp:{get:function(){return this.uniforms.aoClamp.value},set:function(a){this.uniforms.aoClamp.value=a}},lumInfluence:{get:function(){return this.uniforms.lumInfluence.value},set:function(a){this.uniforms.lumInfluence.value=a}}}),this.radius=4,this.onlyAO=!1,this.aoClamp=.25,this.lumInfluence=.7}(Po.prototype=Object.create(qo.prototype)).render=function(a,r,h,d,y,b,R){this.uniforms.cameraNear.value=R.near,this.uniforms.cameraFar.value=R.far,b.overrideMaterial=this.depthMaterial,a.setRenderTarget(this.depthRenderTarget),a.clear(!0,!0,!0),a.render(b,R),b.overrideMaterial=null,qo.prototype.render.call(this,a,r,h,d,y)},Po.prototype.setSize=function(a,r){this.uniforms.size.value.set(a,r),this.depthRenderTarget.setSize(a,r)},Po.prototype.toJSON=function(a){var r=fr.prototype.toJSON.call(this,a);return r.onlyAO=this.onlyAO,r.radius=this.radius,r.aoClamp=this.aoClamp,r.lumInfluence=this.lumInfluence,r};var rp={defines:{PERSPECTIVE_CAMERA:1,KERNEL_SIZE:32},uniforms:{tDiffuse:{value:null},tNormal:{value:null},tDepth:{value:null},tNoise:{value:null},kernel:{value:null},cameraNear:{value:null},cameraFar:{value:null},resolution:{value:new l.Vector2},cameraProjectionMatrix:{value:new l.Matrix4},cameraInverseProjectionMatrix:{value:new l.Matrix4},kernelRadius:{value:8},minDistance:{value:.005},maxDistance:{value:.05}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform sampler2D tNormal;","uniform sampler2D tDepth;","uniform sampler2D tNoise;","uniform vec3 kernel[ KERNEL_SIZE ];","uniform vec2 resolution;","uniform float cameraNear;","uniform float cameraFar;","uniform mat4 cameraProjectionMatrix;","uniform mat4 cameraInverseProjectionMatrix;","uniform float kernelRadius;","uniform float minDistance;","uniform float maxDistance;","varying vec2 vUv;","#include <packing>","float getDepth( const in vec2 screenPosition ) {","\treturn texture2D( tDepth, screenPosition ).x;","}","float getLinearDepth( const in vec2 screenPosition ) {","\t#if PERSPECTIVE_CAMERA == 1","\t\tfloat fragCoordZ = texture2D( tDepth, screenPosition ).x;","\t\tfloat viewZ = perspectiveDepthToViewZ( fragCoordZ, cameraNear, cameraFar );","\t\treturn viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );","\t#else","\t\treturn texture2D( depthSampler, coord ).x;","\t#endif","}","float getViewZ( const in float depth ) {","\t#if PERSPECTIVE_CAMERA == 1","\t\treturn perspectiveDepthToViewZ( depth, cameraNear, cameraFar );","\t#else","\t\treturn orthographicDepthToViewZ( depth, cameraNear, cameraFar );","\t#endif","}","vec3 getViewPosition( const in vec2 screenPosition, const in float depth, const in float viewZ ) {","\tfloat clipW = cameraProjectionMatrix[2][3] * viewZ + cameraProjectionMatrix[3][3];","\tvec4 clipPosition = vec4( ( vec3( screenPosition, depth ) - 0.5 ) * 2.0, 1.0 );","\tclipPosition *= clipW; // unprojection.","\treturn ( cameraInverseProjectionMatrix * clipPosition ).xyz;","}","vec3 getViewNormal( const in vec2 screenPosition ) {","\treturn unpackRGBToNormal( texture2D( tNormal, screenPosition ).xyz );","}","void main() {","\tfloat depth = getDepth( vUv );","\tfloat viewZ = getViewZ( depth );","\tvec3 viewPosition = getViewPosition( vUv, depth, viewZ );","\tvec3 viewNormal = getViewNormal( vUv );"," vec2 noiseScale = vec2( resolution.x / 4.0, resolution.y / 4.0 );","\tvec3 random = texture2D( tNoise, vUv * noiseScale ).xyz;","\tvec3 tangent = normalize( random - viewNormal * dot( random, viewNormal ) );","\tvec3 bitangent = cross( viewNormal, tangent );","\tmat3 kernelMatrix = mat3( tangent, bitangent, viewNormal );"," float occlusion = 0.0;"," for ( int i = 0; i < KERNEL_SIZE; i ++ ) {","\t\tvec3 sampleVector = kernelMatrix * kernel[ i ];","\t\tvec3 samplePoint = viewPosition + ( sampleVector * kernelRadius );","\t\tvec4 samplePointNDC = cameraProjectionMatrix * vec4( samplePoint, 1.0 );","\t\tsamplePointNDC /= samplePointNDC.w;","\t\tvec2 samplePointUv = samplePointNDC.xy * 0.5 + 0.5;","\t\tfloat realDepth = getLinearDepth( samplePointUv );","\t\tfloat sampleDepth = viewZToOrthographicDepth( samplePoint.z, cameraNear, cameraFar );","\t\tfloat delta = sampleDepth - realDepth;","\t\tif ( delta > minDistance && delta < maxDistance ) {","\t\t\tocclusion += 1.0;","\t\t}","\t}","\tocclusion = clamp( occlusion / float( KERNEL_SIZE ), 0.0, 1.0 );","\tgl_FragColor = vec4( vec3( 1.0 - occlusion ), 1.0 );","}"].join("\n")},Wl=(["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),["uniform sampler2D tDepth;","uniform float cameraNear;","uniform float cameraFar;","varying vec2 vUv;","#include <packing>","float getLinearDepth( const in vec2 screenPosition ) {","\t#if PERSPECTIVE_CAMERA == 1","\t\tfloat fragCoordZ = texture2D( tDepth, screenPosition ).x;","\t\tfloat viewZ = perspectiveDepthToViewZ( fragCoordZ, cameraNear, cameraFar );","\t\treturn viewZToOrthographicDepth( viewZ, cameraNear, cameraFar );","\t#else","\t\treturn texture2D( depthSampler, coord ).x;","\t#endif","}","void main() {","\tfloat depth = getLinearDepth( vUv );","\tgl_FragColor = vec4( vec3( 1.0 - depth ), 1.0 );","}"].join("\n"),{uniforms:{tDiffuse:{value:null},resolution:{value:new l.Vector2}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec2 resolution;","varying vec2 vUv;","void main() {","\tvec2 texelSize = ( 1.0 / resolution );","\tfloat result = 0.0;","\tfor ( int i = - 2; i <= 2; i ++ ) {","\t\tfor ( int j = - 2; j <= 2; j ++ ) {","\t\t\tvec2 offset = ( vec2( float( i ), float( j ) ) ) * texelSize;","\t\t\tresult += texture2D( tDiffuse, vUv + offset ).r;","\t\t}","\t}","\tgl_FragColor = vec4( vec3( result / ( 5.0 * 5.0 ) ), 1.0 );","}"].join("\n")});function uo(a){void 0===a&&(a=Math),this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],this.grad4=[[0,1,1,1],[0,1,1,-1],[0,1,-1,1],[0,1,-1,-1],[0,-1,1,1],[0,-1,1,-1],[0,-1,-1,1],[0,-1,-1,-1],[1,0,1,1],[1,0,1,-1],[1,0,-1,1],[1,0,-1,-1],[-1,0,1,1],[-1,0,1,-1],[-1,0,-1,1],[-1,0,-1,-1],[1,1,0,1],[1,1,0,-1],[1,-1,0,1],[1,-1,0,-1],[-1,1,0,1],[-1,1,0,-1],[-1,-1,0,1],[-1,-1,0,-1],[1,1,1,0],[1,1,-1,0],[1,-1,1,0],[1,-1,-1,0],[-1,1,1,0],[-1,1,-1,0],[-1,-1,1,0],[-1,-1,-1,0]],this.p=[];for(var r=0;r<256;r++)this.p[r]=Math.floor(256*a.random());for(this.perm=[],r=0;r<512;r++)this.perm[r]=this.p[255&r];this.simplex=[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]}function Mi(){fr.call(this),this.type="SSAONOH",this.kernel=[],this.noiseTexture=null,this.createQuadScene(),this.depthTexture=new l.DepthTexture,this.depthTexture.type=l.UnsignedShortType,this.depthTexture.minFilter=l.NearestFilter,this.depthTexture.maxFilter=l.NearestFilter,this.normalMaterial=new l.MeshNormalMaterial,this.normalMaterial.blending=l.NoBlending,this.normalRenderTarget=new l.WebGLRenderTarget(1,1,{minFilter:l.LinearFilter,magFilter:l.LinearFilter,format:l.RGBAFormat,depthTexture:this.depthTexture,depthBuffer:!0}),this.ssaoRenderTarget=new l.WebGLRenderTarget(1,1,fr.RGBALinear),this.blurRenderTarget=new l.WebGLRenderTarget(1,1,fr.RGBALinear),this.blurMaterial=new l.ShaderMaterial({defines:Object.assign({},Wl.defines),uniforms:l.UniformsUtils.clone(Wl.uniforms),vertexShader:Wl.vertexShader,fragmentShader:Wl.fragmentShader}),this.blurMaterial.uniforms.tDiffuse.value=this.ssaoRenderTarget.texture,this.ssaoMaterial=new l.ShaderMaterial({defines:Object.assign({},rp.defines),uniforms:l.UniformsUtils.clone(rp.uniforms),vertexShader:rp.vertexShader,fragmentShader:rp.fragmentShader,blending:l.NoBlending}),this.ssaoMaterial.uniforms.tNormal.value=this.normalRenderTarget.texture,this.copyMaterial=new l.ShaderMaterial({uniforms:l.UniformsUtils.clone(ts.uniforms),vertexShader:ts.vertexShader,fragmentShader:ts.fragmentShader,transparent:!0,depthTest:!1,depthWrite:!1,blendSrc:l.DstColorFactor,blendDst:l.ZeroFactor,blendEquation:l.AddEquation,blendSrcAlpha:l.DstAlphaFactor,blendDstAlpha:l.ZeroFactor,blendEquationAlpha:l.AddEquation}),this._kernelSize=0;var a=this;Object.defineProperties(this,{kernelRadius:{get:function(){return a.ssaoMaterial.uniforms.kernelRadius.value},set:function(r){a.ssaoMaterial.uniforms.kernelRadius.value=r}},minDistance:{get:function(){return a.ssaoMaterial.uniforms.minDistance.value},set:function(r){a.ssaoMaterial.uniforms.minDistance.value=r}},maxDistance:{get:function(){return a.ssaoMaterial.uniforms.maxDistance.value},set:function(r){a.ssaoMaterial.uniforms.maxDistance.value=r}},kernelSize:{get:function(){return a._kernelSize},set:function(r){a._kernelSize=r,a.generateSampleKernel(),a.generateRandomKernelRotations(),a.ssaoMaterial.uniforms.tNoise.value=a.noiseTexture,a.ssaoMaterial.uniforms.kernel.value=a.kernel}}}),this.kernelSize=64,this.kernelRadius=8,this.minDistance=.1,this.maxDistance=1e3}uo.prototype.dot=function(a,r,h){return a[0]*r+a[1]*h},uo.prototype.dot3=function(a,r,h,d){return a[0]*r+a[1]*h+a[2]*d},uo.prototype.dot4=function(a,r,h,d,y){return a[0]*r+a[1]*h+a[2]*d+a[3]*y},uo.prototype.noise=function(a,r){var h,d,y=(a+r)*(.5*(Math.sqrt(3)-1)),b=Math.floor(a+y),R=Math.floor(r+y),k=(3-Math.sqrt(3))/6,M=(b+R)*k,H=a-(b-M),X=r-(R-M);H>X?(h=1,d=0):(h=0,d=1);var oe=H-h+k,ne=X-d+k,ge=H-1+2*k,we=X-1+2*k,Se=255&b,Ce=255&R,Re=this.perm[Se+h+this.perm[Ce+d]]%12,Oe=this.perm[Se+1+this.perm[Ce+1]]%12,Ge=.5-H*H-X*X,ke=.5-oe*oe-ne*ne,et=.5-ge*ge-we*we;return 70*((Ge<0?0:(Ge*=Ge)*Ge*this.dot(this.grad3[this.perm[Se+this.perm[Ce]]%12],H,X))+(ke<0?0:(ke*=ke)*ke*this.dot(this.grad3[Re],oe,ne))+(et<0?0:(et*=et)*et*this.dot(this.grad3[Oe],ge,we)))},uo.prototype.noise3d=function(a,r,h){var d,y,b,R,k,M,H=.3333333333333333*(a+r+h),X=Math.floor(a+H),oe=Math.floor(r+H),ne=Math.floor(h+H),ge=1/6,we=(X+oe+ne)*ge,Se=a-(X-we),Ce=r-(oe-we),Pe=h-(ne-we);Se>=Ce?Ce>=Pe?(d=1,y=0,b=0,R=1,k=1,M=0):Se>=Pe?(d=1,y=0,b=0,R=1,k=0,M=1):(d=0,y=0,b=1,R=1,k=0,M=1):Ce<Pe?(d=0,y=0,b=1,R=0,k=1,M=1):Se<Pe?(d=0,y=1,b=0,R=0,k=1,M=1):(d=0,y=1,b=0,R=1,k=1,M=0);var Re=Se-d+ge,Oe=Ce-y+ge,Ge=Pe-b+ge,ke=Se-R+2*ge,et=Ce-k+2*ge,rt=Pe-M+2*ge,ut=Se-1+.5,vt=Ce-1+.5,Lt=Pe-1+.5,Kt=255&X,zt=255&oe,Bt=255&ne,ht=this.perm[Kt+d+this.perm[zt+y+this.perm[Bt+b]]]%12,Tt=this.perm[Kt+R+this.perm[zt+k+this.perm[Bt+M]]]%12,Zt=this.perm[Kt+1+this.perm[zt+1+this.perm[Bt+1]]]%12,un=.6-Se*Se-Ce*Ce-Pe*Pe,Mn=.6-Re*Re-Oe*Oe-Ge*Ge,wr=.6-ke*ke-et*et-rt*rt,Yn=.6-ut*ut-vt*vt-Lt*Lt;return 32*((un<0?0:(un*=un)*un*this.dot3(this.grad3[this.perm[Kt+this.perm[zt+this.perm[Bt]]]%12],Se,Ce,Pe))+(Mn<0?0:(Mn*=Mn)*Mn*this.dot3(this.grad3[ht],Re,Oe,Ge))+(wr<0?0:(wr*=wr)*wr*this.dot3(this.grad3[Tt],ke,et,rt))+(Yn<0?0:(Yn*=Yn)*Yn*this.dot3(this.grad3[Zt],ut,vt,Lt)))},uo.prototype.noise4d=function(a,r,h,d){var y,b,R,k,M,H,X,oe,ne,ge,we,Se,Ce=this.grad4,Pe=this.simplex,Re=this.perm,Oe=(Math.sqrt(5)-1)/4,Ge=(5-Math.sqrt(5))/20,ke=(a+r+h+d)*Oe,et=Math.floor(a+ke),rt=Math.floor(r+ke),ut=Math.floor(h+ke),vt=Math.floor(d+ke),Lt=(et+rt+ut+vt)*Ge,Kt=a-(et-Lt),zt=r-(rt-Lt),Bt=h-(ut-Lt),$t=d-(vt-Lt),ht=(Kt>zt?32:0)+(Kt>Bt?16:0)+(zt>Bt?8:0)+(Kt>$t?4:0)+(zt>$t?2:0)+(Bt>$t?1:0),Tt=Kt-(y=Pe[ht][0]>=3?1:0)+Ge,Zt=zt-(b=Pe[ht][1]>=3?1:0)+Ge,un=Bt-(R=Pe[ht][2]>=3?1:0)+Ge,Mn=$t-(k=Pe[ht][3]>=3?1:0)+Ge,wr=Kt-(M=Pe[ht][0]>=2?1:0)+2*Ge,Yn=zt-(H=Pe[ht][1]>=2?1:0)+2*Ge,On=Bt-(X=Pe[ht][2]>=2?1:0)+2*Ge,Kn=$t-(oe=Pe[ht][3]>=2?1:0)+2*Ge,dr=Kt-(ne=Pe[ht][0]>=1?1:0)+3*Ge,Mr=zt-(ge=Pe[ht][1]>=1?1:0)+3*Ge,di=Bt-(we=Pe[ht][2]>=1?1:0)+3*Ge,so=$t-(Se=Pe[ht][3]>=1?1:0)+3*Ge,ao=Kt-1+4*Ge,Do=zt-1+4*Ge,Uo=Bt-1+4*Ge,hs=$t-1+4*Ge,is=255&et,Bo=255&rt,qa=255&ut,Ou=255&vt,cd=Re[is+y+Re[Bo+b+Re[qa+R+Re[Ou+k]]]]%32,Dh=Re[is+M+Re[Bo+H+Re[qa+X+Re[Ou+oe]]]]%32,ud=Re[is+ne+Re[Bo+ge+Re[qa+we+Re[Ou+Se]]]]%32,hd=Re[is+1+Re[Bo+1+Re[qa+1+Re[Ou+1]]]]%32,au=.6-Kt*Kt-zt*zt-Bt*Bt-$t*$t,lu=.6-Tt*Tt-Zt*Zt-un*un-Mn*Mn,nc=.6-wr*wr-Yn*Yn-On*On-Kn*Kn,cu=.6-dr*dr-Mr*Mr-di*di-so*so,Bd=.6-ao*ao-Do*Do-Uo*Uo-hs*hs;return 27*((au<0?0:(au*=au)*au*this.dot4(Ce[Re[is+Re[Bo+Re[qa+Re[Ou]]]]%32],Kt,zt,Bt,$t))+(lu<0?0:(lu*=lu)*lu*this.dot4(Ce[cd],Tt,Zt,un,Mn))+(nc<0?0:(nc*=nc)*nc*this.dot4(Ce[Dh],wr,Yn,On,Kn))+(cu<0?0:(cu*=cu)*cu*this.dot4(Ce[ud],dr,Mr,di,so))+(Bd<0?0:(Bd*=Bd)*Bd*this.dot4(Ce[hd],ao,Do,Uo,hs)))},(Mi.prototype=Object.create(fr.prototype)).generateSampleKernel=function(){for(var a=0;a<this._kernelSize;a++){var r=new l.Vector3;r.x=2*Math.random()-1,r.y=2*Math.random()-1,r.z=Math.random(),r.normalize();var h=a/this._kernelSize;h=l.Math.lerp(.1,1,h*h),r.multiplyScalar(h),this.kernel.push(r)}},Mi.prototype.generateRandomKernelRotations=function(){for(var a=new uo,r=new Float32Array(16),h=0;h<16;h++){var d=2*Math.random()-1,y=2*Math.random()-1;r[h]=a.noise3d(d,y,0)}this.noiseTexture=new l.DataTexture(r,4,4,l.LuminanceFormat,l.FloatType),this.noiseTexture.wrapS=l.RepeatWrapping,this.noiseTexture.wrapT=l.RepeatWrapping,this.noiseTexture.needsUpdate=!0},Mi.prototype.render=function(a,r,h,d,y,b,R){a.autoClear=!1,a.setClearColor(7829503),a.setClearAlpha(1),b.overrideMaterial=this.normalMaterial,a.setRenderTarget(this.normalRenderTarget),a.clear(!0,!0,!0),a.render(b,R),b.overrideMaterial=null,this.ssaoMaterial.uniforms.tDepth.value=this.depthTexture,this.ssaoMaterial.uniforms.tDiffuse.value=h.texture,this.ssaoMaterial.uniforms.cameraNear.value=R.near,this.ssaoMaterial.uniforms.cameraFar.value=R.far,this.ssaoMaterial.uniforms.cameraProjectionMatrix.value.copy(R.projectionMatrix),this.ssaoMaterial.uniforms.cameraInverseProjectionMatrix.value.getInverse(R.projectionMatrix),this.renderPass(a,this.ssaoMaterial,this.ssaoRenderTarget),this.renderPass(a,this.blurMaterial,this.blurRenderTarget),this.renderToScreen?(this.copyMaterial.uniforms.tDiffuse.value=h.texture,this.copyMaterial.blending=l.NoBlending,this.renderPass(a,this.copyMaterial,null,this.clear),this.copyMaterial.uniforms.tDiffuse.value=this.blurRenderTarget.texture,this.copyMaterial.blending=l.CustomBlending,this.renderPass(a,this.copyMaterial,null,!1)):(this.copyMaterial.uniforms.tDiffuse.value=h.texture,this.copyMaterial.blending=l.NoBlending,this.renderPass(a,this.copyMaterial,r,this.clear),this.copyMaterial.uniforms.tDiffuse.value=this.blurRenderTarget.texture,this.copyMaterial.blending=l.CustomBlending,this.renderPass(a,this.copyMaterial,r,!1))},Mi.prototype.renderPass=function(a,r,h,d){this.quad.material=r,a.autoClear=!1,a.setRenderTarget(h),d&&a.clear(!0,!0,!0),a.render(this.scene,this.camera)},Mi.prototype.dispose=function(){this.normalRenderTarget.dispose(),this.ssaoRenderTarget.dispose(),this.blurRenderTarget.dispose(),this.quad.geometry.dispose(),this.normalMaterial.dispose(),this.blurMaterial.dispose(),this.copyMaterial.dispose()},Mi.prototype.setSize=function(a,r){this.ssaoMaterial.uniforms.resolution.value.set(a,r),this.blurMaterial.uniforms.resolution.value.set(a,r),this.normalRenderTarget.setSize(a,r),this.ssaoRenderTarget.setSize(a,r),this.blurRenderTarget.setSize(a,r)},Mi.prototype.toJSON=function(a){var r=fr.prototype.toJSON.call(this,a);return r.kernelSize=this.kernelSize,r.kernelRadius=this.kernelRadius,r.minDistance=this.minDistance,r.maxDistance=this.maxDistance,r};var Bs={uniforms:{tDiffuse:{value:null},resolution:{value:new l.Vector2}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform vec2 resolution;","varying vec2 vUv;","void main() {","\tvec2 texel = vec2( 1.0 / resolution.x, 1.0 / resolution.y );","\tconst mat3 Gx = mat3( -1, -2, -1, 0, 0, 0, 1, 2, 1 );","\tconst mat3 Gy = mat3( -1, 0, 1, -2, 0, 2, -1, 0, 1 );","\tfloat tx0y0 = texture2D( tDiffuse, vUv + texel * vec2( -1, -1 ) ).r;","\tfloat tx0y1 = texture2D( tDiffuse, vUv + texel * vec2( -1,  0 ) ).r;","\tfloat tx0y2 = texture2D( tDiffuse, vUv + texel * vec2( -1,  1 ) ).r;","\tfloat tx1y0 = texture2D( tDiffuse, vUv + texel * vec2(  0, -1 ) ).r;","\tfloat tx1y1 = texture2D( tDiffuse, vUv + texel * vec2(  0,  0 ) ).r;","\tfloat tx1y2 = texture2D( tDiffuse, vUv + texel * vec2(  0,  1 ) ).r;","\tfloat tx2y0 = texture2D( tDiffuse, vUv + texel * vec2(  1, -1 ) ).r;","\tfloat tx2y1 = texture2D( tDiffuse, vUv + texel * vec2(  1,  0 ) ).r;","\tfloat tx2y2 = texture2D( tDiffuse, vUv + texel * vec2(  1,  1 ) ).r;","\tfloat valueGx = Gx[0][0] * tx0y0 + Gx[1][0] * tx1y0 + Gx[2][0] * tx2y0 + ","\t\tGx[0][1] * tx0y1 + Gx[1][1] * tx1y1 + Gx[2][1] * tx2y1 + ","\t\tGx[0][2] * tx0y2 + Gx[1][2] * tx1y2 + Gx[2][2] * tx2y2; ","\tfloat valueGy = Gy[0][0] * tx0y0 + Gy[1][0] * tx1y0 + Gy[2][0] * tx2y0 + ","\t\tGy[0][1] * tx0y1 + Gy[1][1] * tx1y1 + Gy[2][1] * tx2y1 + ","\t\tGy[0][2] * tx0y2 + Gy[1][2] * tx1y2 + Gy[2][2] * tx2y2; ","\tfloat G = sqrt( ( valueGx * valueGx ) + ( valueGy * valueGy ) );","\tgl_FragColor = vec4( vec3( G ), 1 );","}"].join("\n")};function Ns(){qo.call(this,Bs),this.type="Sobel"}(Ns.prototype=Object.create(qo.prototype)).setSize=function(a,r){this.uniforms.resolution.value.set(a,r)};var Al={uniforms:{tDiffuse:{value:null},hue:{value:0},saturation:{value:0}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float hue;","uniform float saturation;","varying vec2 vUv;","void main() {","\tgl_FragColor = texture2D( tDiffuse, vUv );","\tfloat angle = hue * 3.14159265;","\tfloat s = sin(angle), c = cos(angle);","\tvec3 weights = (vec3(2.0 * c, -sqrt(3.0) * s - c, sqrt(3.0) * s - c) + 1.0) / 3.0;","\tfloat len = length(gl_FragColor.rgb);","\tgl_FragColor.rgb = vec3(","\t\tdot(gl_FragColor.rgb, weights.xyz),","\t\tdot(gl_FragColor.rgb, weights.zxy),","\t\tdot(gl_FragColor.rgb, weights.yzx)","\t);","\tfloat average = (gl_FragColor.r + gl_FragColor.g + gl_FragColor.b) / 3.0;","\tif (saturation > 0.0) {","\t\tgl_FragColor.rgb += (average - gl_FragColor.rgb) * (1.0 - 1.0 / (1.001 - saturation));","\t} else {","\t\tgl_FragColor.rgb += (average - gl_FragColor.rgb) * (-saturation);","\t}","}"].join("\n")};function Io(a,r){qo.call(this,Al),this.type="HueSaturation",Object.defineProperties(this,{hue:{get:function(){return this.uniforms.hue.value},set:function(h){this.uniforms.hue.value=h}},saturation:{get:function(){return this.uniforms.saturation.value},set:function(h){this.uniforms.saturation.value=h}}}),this.hue=void 0!==a?a:0,this.saturation=void 0!==r?r:0}(Io.prototype=Object.create(qo.prototype)).toJSON=function(a){var r=fr.prototype.toJSON.call(this,a);return r.hue=this.hue,r.saturation=this.saturation,r};var $l={uniforms:{tDiffuse:{value:null},time:{value:0},nIntensity:{value:.5},sIntensity:{value:.05},sCount:{value:4096},grayscale:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","uniform float time;","uniform bool grayscale;","uniform float nIntensity;","uniform float sIntensity;","uniform float sCount;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 cTextureScreen = texture2D( tDiffuse, vUv );","\tfloat dx = rand( vUv + time );","\tvec3 cResult = cTextureScreen.rgb + cTextureScreen.rgb * clamp( 0.1 + dx, 0.0, 1.0 );","\tvec2 sc = vec2( sin( vUv.y * sCount ), cos( vUv.y * sCount ) );","\tcResult += cTextureScreen.rgb * vec3( sc.x, sc.y, sc.x ) * sIntensity;","\tcResult = cTextureScreen.rgb + clamp( nIntensity, 0.0,1.0 ) * ( cResult - cTextureScreen.rgb );","\tif( grayscale ) {","\t\tcResult = vec3( cResult.r * 0.3 + cResult.g * 0.59 + cResult.b * 0.11 );","\t}","\tgl_FragColor =  vec4( cResult, cTextureScreen.a );","}"].join("\n")};function ol(a,r,h,d){fr.call(this),this.type="Film",this.createQuadScene(),this.uniforms=l.UniformsUtils.clone($l.uniforms),this.material=new l.ShaderMaterial({uniforms:this.uniforms,vertexShader:$l.vertexShader,fragmentShader:$l.fragmentShader});var y=this;Object.defineProperties(this,{grayscale:{get:function(){return y.uniforms.grayscale.value},set:function(b){y.uniforms.grayscale.value=b}},noiseIntensity:{get:function(){return y.uniforms.nIntensity.value},set:function(b){y.uniforms.nIntensity.value=b}},scanlinesIntensity:{get:function(){return y.uniforms.sIntensity.value},set:function(b){y.uniforms.sIntensity.value=b}},scanlinesCount:{get:function(){return y.uniforms.sCount.value},set:function(b){y.uniforms.sCount.value=b}}}),this.grayscale=void 0!==d&&d,this.noiseIntensity=void 0!==a?a:.35,this.scanlinesIntensity=void 0!==r?r:.5,this.scanlinesCount=void 0!==h?h:512}(ol.prototype=Object.create(fr.prototype)).render=function(a,r,h,d,y,b,R){this.uniforms.time.value+=d,this.uniforms.tDiffuse.value=h.texture,this.quad.material=this.material,this.clear?(a.autoClear=!0,a.autoClearColor=!0,a.autoClearDepth=!0,a.autoClearStencil=!0):a.autoClear=!1,a.setRenderTarget(this.renderToScreen?null:r),a.render(this.scene,this.camera)},ol.prototype.toJSON=function(a){var r=fr.prototype.toJSON.call(this,a);return r.grayscale=this.grayscale,r.noiseIntensity=this.noiseIntensity,r.scanlinesIntensity=this.scanlinesIntensity,r.scanlinesCount=this.scanlinesCount,r};var ql={uniforms:{tDiffuse:{value:null},tSize:{value:new l.Vector2(256,256)},center:{value:new l.Vector2(.5,.5)},angle:{value:1.57},scale:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec2 center;","uniform float angle;","uniform float scale;","uniform vec2 tSize;","uniform sampler2D tDiffuse;","varying vec2 vUv;","float pattern() {","\tfloat s = sin( angle ), c = cos( angle );","\tvec2 tex = vUv * tSize - center;","\tvec2 point = vec2( c * tex.x - s * tex.y, s * tex.x + c * tex.y ) * scale;","\treturn ( sin( point.x ) * sin( point.y ) ) * 4.0;","}","void main() {","\tvec4 color = texture2D( tDiffuse, vUv );","\tfloat average = ( color.r + color.g + color.b ) / 3.0;","\tgl_FragColor = vec4( vec3( average * 10.0 - 5.0 + pattern() ), color.a );","}"].join("\n")};function xc(a,r,h){fr.call(this),this.type="DotScreen",this.createQuadScene(),this.uniforms=l.UniformsUtils.clone(ql.uniforms),this.material=new l.ShaderMaterial({uniforms:this.uniforms,vertexShader:ql.vertexShader,fragmentShader:ql.fragmentShader}),Object.defineProperties(this,{center:{get:function(){return this.uniforms.center.value},set:function(d){this.uniforms.center.value=d}},angle:{get:function(){return this.uniforms.angle.value},set:function(d){this.uniforms.angle.value=d}},scale:{get:function(){return this.uniforms.scale.value},set:function(d){this.uniforms.scale.value=d}}}),void 0!==a&&this.center.copy(a),this.angle=void 0!==r?r:.5,this.scale=void 0!==h?h:.8}function Vc(){qo.call(this,ts),this.type="Copy"}(xc.prototype=Object.create(fr.prototype)).render=function(a,r,h,d,y,b,R){this.uniforms.tDiffuse.value=h.texture,this.uniforms.tSize.value.set(h.width,h.height),this.quad.material=this.material,this.clear?(a.autoClear=!0,a.autoClearColor=!0,a.autoClearDepth=!0,a.autoClearStencil=!0):a.autoClear=!1,a.setRenderTarget(this.renderToScreen?null:r),a.render(this.scene,this.camera)},xc.prototype.toJSON=function(a){var r=fr.prototype.toJSON.call(this,a);return r.center=this.center.toArray(),r.angle=this.angle,r.scale=this.scale,r},Vc.prototype=Object.create(qo.prototype);var pr={uniforms:{tDiffuse:{value:null},color:{value:new l.Color(16777215)}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec3 color;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tvec3 luma = vec3( 0.299, 0.587, 0.114 );","\tfloat v = dot( texel.xyz, luma );","\tgl_FragColor = vec4( v * color, texel.w );","}"].join("\n")};function Lp(){qo.call(this,pr),this.type="Colorify",Object.defineProperties(this,{color:{get:function(){return this.uniforms.color.value},set:function(a){this.uniforms.color.value=a}}})}(Lp.prototype=Object.create(qo.prototype)).toJSON=function(a){var r=fr.prototype.toJSON.call(this,a);return r.color=this.color.getHex(),r};var Sa={defines:{DEPTH_PACKING:1,PERSPECTIVE_CAMERA:1},uniforms:{tColor:{value:null},tDepth:{value:null},focus:{value:1},aspect:{value:1},aperture:{value:.025},maxblur:{value:.01},nearClip:{value:1},farClip:{value:1e3}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","varying vec2 vUv;","uniform sampler2D tColor;","uniform sampler2D tDepth;","uniform float maxblur;","uniform float aperture;","uniform float nearClip;","uniform float farClip;","uniform float focus;","uniform float aspect;","#include <packing>","float getDepth( const in vec2 screenPosition ) {","\t#if DEPTH_PACKING == 1","\treturn unpackRGBAToDepth( texture2D( tDepth, screenPosition ) );","\t#else","\treturn texture2D( tDepth, screenPosition ).x;","\t#endif","}","float getViewZ( const in float depth ) {","\t#if PERSPECTIVE_CAMERA == 1","\treturn perspectiveDepthToViewZ( depth, nearClip, farClip );","\t#else","\treturn orthographicDepthToViewZ( depth, nearClip, farClip );","\t#endif","}","void main() {","\tvec2 aspectcorrect = vec2( 1.0, aspect );","\tfloat viewZ = getViewZ( getDepth( vUv ) );","\tfloat factor = ( focus + viewZ );","\tvec2 dofblur = vec2 ( clamp( factor * aperture, -maxblur, maxblur ) );","\tvec2 dofblur9 = dofblur * 0.9;","\tvec2 dofblur7 = dofblur * 0.7;","\tvec2 dofblur4 = dofblur * 0.4;","\tvec4 col = vec4( 0.0 );","\tcol += texture2D( tColor, vUv.xy );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15,  0.37 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37,  0.15 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37, -0.15 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15, -0.37 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.15,  0.37 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.37,  0.15 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.37, -0.15 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.15, -0.37 ) * aspectcorrect ) * dofblur9 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.40,  0.0  ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur7 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29,  0.29 ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.4,   0.0  ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.29, -0.29 ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,  -0.4  ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29,  0.29 ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.4,   0.0  ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2( -0.29, -0.29 ) * aspectcorrect ) * dofblur4 );","\tcol += texture2D( tColor, vUv.xy + ( vec2(  0.0,   0.4  ) * aspectcorrect ) * dofblur4 );","\tgl_FragColor = col / 41.0;","\tgl_FragColor.a = 1.0;","}"].join("\n")};function Ua(a,r,h){fr.call(this),this.type="Bokeh",this.renderTargetColor=new l.WebGLRenderTarget(0,0,fr.RGBLinear),this.renderTargetDepth=this.renderTargetColor.clone(),this.materialDepth=new l.MeshDepthMaterial,this.materialDepth.depthPacking=l.RGBADepthPacking,this.materialDepth.blending=l.NoBlending,this.uniforms=l.UniformsUtils.clone(Sa.uniforms),this.uniforms.tDepth.value=this.renderTargetDepth.texture,this.materialBokeh=new l.ShaderMaterial({defines:Sa.defines,uniforms:this.uniforms,vertexShader:Sa.vertexShader,fragmentShader:Sa.fragmentShader}),this.createQuadScene(),this.quad.material=this.materialBokeh;var d=this;Object.defineProperties(this,{aperture:{get:function(){return d.uniforms.aperture.value},set:function(y){d.uniforms.aperture.value=y}},focus:{get:function(){return d.uniforms.focus.value},set:function(y){d.uniforms.focus.value=y}},maxblur:{get:function(){return d.uniforms.maxblur.value},set:function(y){d.uniforms.maxblur.value=y}}}),this.focus=void 0!==a?a:1,this.aperture=void 0!==r?r:1,this.maxblur=void 0!==h?h:.2}(Ua.prototype=Object.create(fr.prototype)).render=function(a,r,h,d,y,b,R){b.overrideMaterial=this.materialDepth,a.autoClear=!1,a.setClearColor(16777215),a.setClearAlpha(1),a.setRenderTarget(this.renderTargetDepth),a.clear(!0,!0,!0),a.render(b,R),this.uniforms.tColor.value=h.texture,this.uniforms.nearClip.value=R.near,this.uniforms.farClip.value=R.far,this.uniforms.aspect.value=R.aspect,this.clear?(a.autoClear=!0,a.autoClearColor=!0,a.autoClearDepth=!0,a.autoClearStencil=!0):a.autoClear=!1,a.setRenderTarget(this.renderToScreen?null:r),a.render(this.scene,this.camera),b.overrideMaterial=null},Ua.prototype.setSize=function(a,r){this.renderTargetColor.setSize(a,r),this.renderTargetDepth.setSize(a,r)},Ua.prototype.toJSON=function(a){var r=fr.prototype.toJSON.call(this,a);return r.aperture=this.aperture,r.focus=this.focus,r.maxblur=this.maxblur,r};var Cl={defines:{KERNEL_SIZE_FLOAT:"25.0",KERNEL_SIZE_INT:"25"},uniforms:{tDiffuse:{value:null},uImageIncrement:{value:new l.Vector2(.001953125,0)},cKernel:{value:[]}},vertexShader:["uniform vec2 uImageIncrement;","varying vec2 vUv;","void main() {","\tvUv = uv - ( ( KERNEL_SIZE_FLOAT - 1.0 ) / 2.0 ) * uImageIncrement;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float cKernel[ KERNEL_SIZE_INT ];","uniform sampler2D tDiffuse;","uniform vec2 uImageIncrement;","varying vec2 vUv;","void main() {","\tvec2 imageCoord = vUv;","\tvec4 sum = vec4( 0.0, 0.0, 0.0, 0.0 );","\tfor( int i = 0; i < KERNEL_SIZE_INT; i ++ ) {","\t\tsum += texture2D( tDiffuse, imageCoord ) * cKernel[ i ];","\t\timageCoord += uImageIncrement;","\t}","\tgl_FragColor = sum;","}"].join("\n"),buildKernel:function(a){var h,d,y,b,k,M,R=2*Math.ceil(3*a)+1;for(R>25&&(R=25),b=.5*(R-1),d=new Array(R),y=0,h=0;h<R;++h)d[h]=(k=h-b,M=a,Math.exp(-k*k/(2*M*M))),y+=d[h];for(h=0;h<R;++h)d[h]/=y;return d}};function Dr(a,r,h,d){fr.call(this),this.type="Bloom",this.copyToScreen=!0,this.createQuadScene(),a=void 0!==a?a:1,r=void 0!==r?r:25,h=void 0!==h?h:4,this.renderTargetX=new l.WebGLRenderTarget(d=void 0!==d?d:256,d,fr.RGBALinear),this.renderTargetY=new l.WebGLRenderTarget(d,d,fr.RGBALinear),this.copyUniforms=l.UniformsUtils.clone(ts.uniforms),this.copyUniforms.opacity.value=a,this.materialCopy=new l.ShaderMaterial({uniforms:this.copyUniforms,vertexShader:ts.vertexShader,fragmentShader:ts.fragmentShader,blending:l.AdditiveBlending,transparent:!0}),this.convolutionUniforms=l.UniformsUtils.clone(Cl.uniforms),this.convolutionUniforms.uImageIncrement.value=Dr.blurX,this.convolutionUniforms.cKernel.value=Cl.buildKernel(h),this.materialConvolution=new l.ShaderMaterial({uniforms:this.convolutionUniforms,vertexShader:Cl.vertexShader,fragmentShader:Cl.fragmentShader,defines:{KERNEL_SIZE_FLOAT:r.toFixed(1),KERNEL_SIZE_INT:r.toFixed(0)}})}Dr.blurX=new l.Vector2(.001953125,0),Dr.blurY=new l.Vector2(0,.001953125),(Dr.prototype=Object.create(fr.prototype)).render=function(a,r,h,d,y,b,R){y&&a.context.disable(a.context.STENCIL_TEST),this.quad.material=this.materialConvolution,this.convolutionUniforms.tDiffuse.value=h.texture,this.convolutionUniforms.uImageIncrement.value=Dr.blurX,a.setRenderTarget(this.renderTargetX),a.clear(!0,!0,!0),a.render(this.scene,this.camera),this.convolutionUniforms.tDiffuse.value=this.renderTargetX.texture,this.convolutionUniforms.uImageIncrement.value=Dr.blurY,a.setRenderTarget(this.renderTargetY),a.clear(!0,!0,!0),a.render(this.scene,this.camera),this.quad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetY.texture,y&&a.context.enable(a.context.STENCIL_TEST),a.setRenderTarget(r),a.render(this.scene,this.camera)},Dr.prototype.toJSON=function(a){var r=fr.prototype.toJSON.call(this,a);return r.strength=this.strength,r.kernelSize=this.kernelSize,r.sigma=this.sigma,r.resolution=this.resolution,r};var wc={uniforms:{tDiffuse:{value:null},resolution:{value:new l.Vector2(1/1024,1/512)}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","","uniform sampler2D tDiffuse;","","uniform vec2 resolution;","","varying vec2 vUv;","","// FXAA 3.11 implementation by NVIDIA, ported to WebGL by Agost Biro (biro@archilogic.com)","","//----------------------------------------------------------------------------------","// File:        es3-keplerFXAAassetsshaders/FXAA_DefaultES.frag","// SDK Version: v3.00","// Email:       gameworks@nvidia.com","// Site:        http://developer.nvidia.com/","//","// Copyright (c) 2014-2015, NVIDIA CORPORATION. All rights reserved.","//","// Redistribution and use in source and binary forms, with or without","// modification, are permitted provided that the following conditions","// are met:","//  * Redistributions of source code must retain the above copyright","//    notice, this list of conditions and the following disclaimer.","//  * Redistributions in binary form must reproduce the above copyright","//    notice, this list of conditions and the following disclaimer in the","//    documentation and/or other materials provided with the distribution.","//  * Neither the name of NVIDIA CORPORATION nor the names of its","//    contributors may be used to endorse or promote products derived","//    from this software without specific prior written permission.","//","// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ``AS IS'' AND ANY","// EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE","// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR","// PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR","// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,","// EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,","// PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR","// PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY","// OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT","// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE","// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.","//","//----------------------------------------------------------------------------------","","#define FXAA_PC 1","#define FXAA_GLSL_100 1","#define FXAA_QUALITY_PRESET 12","","#define FXAA_GREEN_AS_LUMA 1","","/*--------------------------------------------------------------------------*/","#ifndef FXAA_PC_CONSOLE","    //","    // The console algorithm for PC is included","    // for developers targeting really low spec machines.","    // Likely better to just run FXAA_PC, and use a really low preset.","    //","    #define FXAA_PC_CONSOLE 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GLSL_120","    #define FXAA_GLSL_120 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GLSL_130","    #define FXAA_GLSL_130 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_3","    #define FXAA_HLSL_3 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_4","    #define FXAA_HLSL_4 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_5","    #define FXAA_HLSL_5 0","#endif","/*==========================================================================*/","#ifndef FXAA_GREEN_AS_LUMA","    //","    // For those using non-linear color,","    // and either not able to get luma in alpha, or not wanting to,","    // this enables FXAA to run using green as a proxy for luma.","    // So with this enabled, no need to pack luma in alpha.","    //","    // This will turn off AA on anything which lacks some amount of green.","    // Pure red and blue or combination of only R and B, will get no AA.","    //","    // Might want to lower the settings for both,","    //    fxaaConsoleEdgeThresholdMin","    //    fxaaQualityEdgeThresholdMin","    // In order to insure AA does not get turned off on colors","    // which contain a minor amount of green.","    //","    // 1 = On.","    // 0 = Off.","    //","    #define FXAA_GREEN_AS_LUMA 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_EARLY_EXIT","    //","    // Controls algorithm's early exit path.","    // On PS3 turning this ON adds 2 cycles to the shader.","    // On 360 turning this OFF adds 10ths of a millisecond to the shader.","    // Turning this off on console will result in a more blurry image.","    // So this defaults to on.","    //","    // 1 = On.","    // 0 = Off.","    //","    #define FXAA_EARLY_EXIT 1","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_DISCARD","    //","    // Only valid for PC OpenGL currently.","    // Probably will not work when FXAA_GREEN_AS_LUMA = 1.","    //","    // 1 = Use discard on pixels which don't need AA.","    //     For APIs which enable concurrent TEX+ROP from same surface.","    // 0 = Return unchanged color on pixels which don't need AA.","    //","    #define FXAA_DISCARD 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_FAST_PIXEL_OFFSET","    //","    // Used for GLSL 120 only.","    //","    // 1 = GL API supports fast pixel offsets","    // 0 = do not use fast pixel offsets","    //","    #ifdef GL_EXT_gpu_shader4","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifndef FXAA_FAST_PIXEL_OFFSET","        #define FXAA_FAST_PIXEL_OFFSET 0","    #endif","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GATHER4_ALPHA","    //","    // 1 = API supports gather4 on alpha channel.","    // 0 = API does not support gather4 on alpha channel.","    //","    #if (FXAA_HLSL_5 == 1)","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifndef FXAA_GATHER4_ALPHA","        #define FXAA_GATHER4_ALPHA 0","    #endif","#endif","","","/*============================================================================","                        FXAA QUALITY - TUNING KNOBS","------------------------------------------------------------------------------","NOTE the other tuning knobs are now in the shader function inputs!","============================================================================*/","#ifndef FXAA_QUALITY_PRESET","    //","    // Choose the quality preset.","    // This needs to be compiled into the shader as it effects code.","    // Best option to include multiple presets is to","    // in each shader define the preset, then include this file.","    //","    // OPTIONS","    // -----------------------------------------------------------------------","    // 10 to 15 - default medium dither (10=fastest, 15=highest quality)","    // 20 to 29 - less dither, more expensive (20=fastest, 29=highest quality)","    // 39       - no dither, very expensive","    //","    // NOTES","    // -----------------------------------------------------------------------","    // 12 = slightly faster then FXAA 3.9 and higher edge quality (default)","    // 13 = about same speed as FXAA 3.9 and better than 12","    // 23 = closest to FXAA 3.9 visually and performance wise","    //  _ = the lowest digit is directly related to performance","    // _  = the highest digit is directly related to style","    //","    #define FXAA_QUALITY_PRESET 12","#endif","","","/*============================================================================","","                           FXAA QUALITY - PRESETS","","============================================================================*/","","/*============================================================================","                     FXAA QUALITY - MEDIUM DITHER PRESETS","============================================================================*/","#if (FXAA_QUALITY_PRESET == 10)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 3.0","    #define FXAA_QUALITY_P2 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 11)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 3.0","    #define FXAA_QUALITY_P3 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 12)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 4.0","    #define FXAA_QUALITY_P4 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 13)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 4.0","    #define FXAA_QUALITY_P5 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 14)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 4.0","    #define FXAA_QUALITY_P6 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 15)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 12.0","#endif","","/*============================================================================","                     FXAA QUALITY - LOW DITHER PRESETS","============================================================================*/","#if (FXAA_QUALITY_PRESET == 20)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 2.0","    #define FXAA_QUALITY_P2 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 21)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 22)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 23)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 24)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 3.0","    #define FXAA_QUALITY_P6 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 25)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 26)","    #define FXAA_QUALITY_PS 9","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 4.0","    #define FXAA_QUALITY_P8 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 27)","    #define FXAA_QUALITY_PS 10","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 4.0","    #define FXAA_QUALITY_P9 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 28)","    #define FXAA_QUALITY_PS 11","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 4.0","    #define FXAA_QUALITY_P10 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 29)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","","/*============================================================================","                     FXAA QUALITY - EXTREME QUALITY","============================================================================*/","#if (FXAA_QUALITY_PRESET == 39)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.0","    #define FXAA_QUALITY_P2 1.0","    #define FXAA_QUALITY_P3 1.0","    #define FXAA_QUALITY_P4 1.0","    #define FXAA_QUALITY_P5 1.5","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","","","","/*============================================================================","","                                API PORTING","","============================================================================*/","#if (FXAA_GLSL_100 == 1) || (FXAA_GLSL_120 == 1) || (FXAA_GLSL_130 == 1)","    #define FxaaBool bool","    #define FxaaDiscard discard","    #define FxaaFloat float","    #define FxaaFloat2 vec2","    #define FxaaFloat3 vec3","    #define FxaaFloat4 vec4","    #define FxaaHalf float","    #define FxaaHalf2 vec2","    #define FxaaHalf3 vec3","    #define FxaaHalf4 vec4","    #define FxaaInt2 ivec2","    #define FxaaSat(x) clamp(x, 0.0, 1.0)","    #define FxaaTex sampler2D","#else","    #define FxaaBool bool","    #define FxaaDiscard clip(-1)","    #define FxaaFloat float","    #define FxaaFloat2 float2","    #define FxaaFloat3 float3","    #define FxaaFloat4 float4","    #define FxaaHalf half","    #define FxaaHalf2 half2","    #define FxaaHalf3 half3","    #define FxaaHalf4 half4","    #define FxaaSat(x) saturate(x)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_100 == 1)","  #define FxaaTexTop(t, p) texture2D(t, p, 0.0)","  #define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r), 0.0)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_120 == 1)","    // Requires,","    //  #version 120","    // And at least,","    //  #extension GL_EXT_gpu_shader4 : enable","    //  (or set FXAA_FAST_PIXEL_OFFSET 1 to work like DX9)","    #define FxaaTexTop(t, p) texture2DLod(t, p, 0.0)","    #if (FXAA_FAST_PIXEL_OFFSET == 1)","        #define FxaaTexOff(t, p, o, r) texture2DLodOffset(t, p, 0.0, o)","    #else","        #define FxaaTexOff(t, p, o, r) texture2DLod(t, p + (o * r), 0.0)","    #endif","    #if (FXAA_GATHER4_ALPHA == 1)","        // use #extension GL_ARB_gpu_shader5 : enable","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_130 == 1)",'    // Requires "#version 130" or better',"    #define FxaaTexTop(t, p) textureLod(t, p, 0.0)","    #define FxaaTexOff(t, p, o, r) textureLodOffset(t, p, 0.0, o)","    #if (FXAA_GATHER4_ALPHA == 1)","        // use #extension GL_ARB_gpu_shader5 : enable","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_3 == 1)","    #define FxaaInt2 float2","    #define FxaaTex sampler2D","    #define FxaaTexTop(t, p) tex2Dlod(t, float4(p, 0.0, 0.0))","    #define FxaaTexOff(t, p, o, r) tex2Dlod(t, float4(p + (o * r), 0, 0))","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_4 == 1)","    #define FxaaInt2 int2","    struct FxaaTex { SamplerState smpl; Texture2D tex; };","    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)","    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_5 == 1)","    #define FxaaInt2 int2","    struct FxaaTex { SamplerState smpl; Texture2D tex; };","    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)","    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)","    #define FxaaTexAlpha4(t, p) t.tex.GatherAlpha(t.smpl, p)","    #define FxaaTexOffAlpha4(t, p, o) t.tex.GatherAlpha(t.smpl, p, o)","    #define FxaaTexGreen4(t, p) t.tex.GatherGreen(t.smpl, p)","    #define FxaaTexOffGreen4(t, p, o) t.tex.GatherGreen(t.smpl, p, o)","#endif","","","/*============================================================================","                   GREEN AS LUMA OPTION SUPPORT FUNCTION","============================================================================*/","#if (FXAA_GREEN_AS_LUMA == 0)","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.w; }","#else","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.y; }","#endif","","","","","/*============================================================================","","                             FXAA3 QUALITY - PC","","============================================================================*/","#if (FXAA_PC == 1)","/*--------------------------------------------------------------------------*/","FxaaFloat4 FxaaPixelShader(","    //","    // Use noperspective interpolation here (turn off perspective interpolation).","    // {xy} = center of pixel","    FxaaFloat2 pos,","    //","    // Used only for FXAA Console, and not used on the 360 version.","    // Use noperspective interpolation here (turn off perspective interpolation).","    // {xy_} = upper left of pixel","    // {_zw} = lower right of pixel","    FxaaFloat4 fxaaConsolePosPos,","    //","    // Input color texture.","    // {rgb_} = color in linear or perceptual color space","    // if (FXAA_GREEN_AS_LUMA == 0)","    //     {__a} = luma in perceptual color space (not linear)","    FxaaTex tex,","    //","    // Only used on the optimized 360 version of FXAA Console.",'    // For everything but 360, just use the same input here as for "tex".',"    // For 360, same texture, just alias with a 2nd sampler.","    // This sampler needs to have an exponent bias of -1.","    FxaaTex fxaaConsole360TexExpBiasNegOne,","    //","    // Only used on the optimized 360 version of FXAA Console.",'    // For everything but 360, just use the same input here as for "tex".',"    // For 360, same texture, just alias with a 3nd sampler.","    // This sampler needs to have an exponent bias of -2.","    FxaaTex fxaaConsole360TexExpBiasNegTwo,","    //","    // Only used on FXAA Quality.","    // This must be from a constant/uniform.","    // {x_} = 1.0/screenWidthInPixels","    // {_y} = 1.0/screenHeightInPixels","    FxaaFloat2 fxaaQualityRcpFrame,","    //","    // Only used on FXAA Console.","    // This must be from a constant/uniform.","    // This effects sub-pixel AA quality and inversely sharpness.","    //   Where N ranges between,","    //     N = 0.50 (default)","    //     N = 0.33 (sharper)","    // {x__} = -N/screenWidthInPixels","    // {_y_} = -N/screenHeightInPixels","    // {_z_} =  N/screenWidthInPixels","    // {__w} =  N/screenHeightInPixels","    FxaaFloat4 fxaaConsoleRcpFrameOpt,","    //","    // Only used on FXAA Console.","    // Not used on 360, but used on PS3 and PC.","    // This must be from a constant/uniform.","    // {x__} = -2.0/screenWidthInPixels","    // {_y_} = -2.0/screenHeightInPixels","    // {_z_} =  2.0/screenWidthInPixels","    // {__w} =  2.0/screenHeightInPixels","    FxaaFloat4 fxaaConsoleRcpFrameOpt2,","    //","    // Only used on FXAA Console.","    // Only used on 360 in place of fxaaConsoleRcpFrameOpt2.","    // This must be from a constant/uniform.","    // {x__} =  8.0/screenWidthInPixels","    // {_y_} =  8.0/screenHeightInPixels","    // {_z_} = -4.0/screenWidthInPixels","    // {__w} = -4.0/screenHeightInPixels","    FxaaFloat4 fxaaConsole360RcpFrameOpt2,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_SUBPIX define.","    // It is here now to allow easier tuning.","    // Choose the amount of sub-pixel aliasing removal.","    // This can effect sharpness.","    //   1.00 - upper limit (softer)","    //   0.75 - default amount of filtering","    //   0.50 - lower limit (sharper, less sub-pixel aliasing removal)","    //   0.25 - almost off","    //   0.00 - completely off","    FxaaFloat fxaaQualitySubpix,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD define.","    // It is here now to allow easier tuning.","    // The minimum amount of local contrast required to apply algorithm.","    //   0.333 - too little (faster)","    //   0.250 - low quality","    //   0.166 - default","    //   0.125 - high quality","    //   0.063 - overkill (slower)","    FxaaFloat fxaaQualityEdgeThreshold,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD_MIN define.","    // It is here now to allow easier tuning.","    // Trims the algorithm from processing darks.","    //   0.0833 - upper limit (default, the start of visible unfiltered edges)","    //   0.0625 - high quality (faster)","    //   0.0312 - visible limit (slower)","    // Special notes when using FXAA_GREEN_AS_LUMA,","    //   Likely want to set this to zero.","    //   As colors that are mostly not-green","    //   will appear very dark in the green channel!","    //   Tune by looking at mostly non-green content,","    //   then start at zero and increase until aliasing is a problem.","    FxaaFloat fxaaQualityEdgeThresholdMin,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_SHARPNESS define.","    // It is here now to allow easier tuning.","    // This does not effect PS3, as this needs to be compiled in.","    //   Use FXAA_CONSOLE_PS3_EDGE_SHARPNESS for PS3.","    //   Due to the PS3 being ALU bound,","    //   there are only three safe values here: 2 and 4 and 8.","    //   These options use the shaders ability to a free *|/ by 2|4|8.","    // For all other platforms can be a non-power of two.","    //   8.0 is sharper (default!!!)","    //   4.0 is softer","    //   2.0 is really soft (good only for vector graphics inputs)","    FxaaFloat fxaaConsoleEdgeSharpness,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD define.","    // It is here now to allow easier tuning.","    // This does not effect PS3, as this needs to be compiled in.","    //   Use FXAA_CONSOLE_PS3_EDGE_THRESHOLD for PS3.","    //   Due to the PS3 being ALU bound,","    //   there are only two safe values here: 1/4 and 1/8.","    //   These options use the shaders ability to a free *|/ by 2|4|8.","    // The console setting has a different mapping than the quality setting.","    // Other platforms can use other values.","    //   0.125 leaves less aliasing, but is softer (default!!!)","    //   0.25 leaves more aliasing, and is sharper","    FxaaFloat fxaaConsoleEdgeThreshold,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD_MIN define.","    // It is here now to allow easier tuning.","    // Trims the algorithm from processing darks.","    // The console setting has a different mapping than the quality setting.","    // This only applies when FXAA_EARLY_EXIT is 1.","    // This does not apply to PS3,","    // PS3 was simplified to avoid more shader instructions.","    //   0.06 - faster but more aliasing in darks","    //   0.05 - default","    //   0.04 - slower and less aliasing in darks","    // Special notes when using FXAA_GREEN_AS_LUMA,","    //   Likely want to set this to zero.","    //   As colors that are mostly not-green","    //   will appear very dark in the green channel!","    //   Tune by looking at mostly non-green content,","    //   then start at zero and increase until aliasing is a problem.","    FxaaFloat fxaaConsoleEdgeThresholdMin,","    //","    // Extra constants for 360 FXAA Console only.","    // Use zeros or anything else for other platforms.","    // These must be in physical constant registers and NOT immediates.","    // Immediates will result in compiler un-optimizing.","    // {xyzw} = float4(1.0, -1.0, 0.25, -0.25)","    FxaaFloat4 fxaaConsole360ConstDir",") {","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posM;","    posM.x = pos.x;","    posM.y = pos.y;","    #if (FXAA_GATHER4_ALPHA == 1)","        #if (FXAA_DISCARD == 0)","            FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","            #if (FXAA_GREEN_AS_LUMA == 0)","                #define lumaM rgbyM.w","            #else","                #define lumaM rgbyM.y","            #endif","        #endif","        #if (FXAA_GREEN_AS_LUMA == 0)","            FxaaFloat4 luma4A = FxaaTexAlpha4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffAlpha4(tex, posM, FxaaInt2(-1, -1));","        #else","            FxaaFloat4 luma4A = FxaaTexGreen4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffGreen4(tex, posM, FxaaInt2(-1, -1));","        #endif","        #if (FXAA_DISCARD == 1)","            #define lumaM luma4A.w","        #endif","        #define lumaE luma4A.z","        #define lumaS luma4A.x","        #define lumaSE luma4A.y","        #define lumaNW luma4B.w","        #define lumaN luma4B.z","        #define lumaW luma4B.x","    #else","        FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","        #if (FXAA_GREEN_AS_LUMA == 0)","            #define lumaM rgbyM.w","        #else","            #define lumaM rgbyM.y","        #endif","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 0.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 0.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 0), fxaaQualityRcpFrame.xy));","        #endif","    #endif","/*--------------------------------------------------------------------------*/","    FxaaFloat maxSM = max(lumaS, lumaM);","    FxaaFloat minSM = min(lumaS, lumaM);","    FxaaFloat maxESM = max(lumaE, maxSM);","    FxaaFloat minESM = min(lumaE, minSM);","    FxaaFloat maxWN = max(lumaN, lumaW);","    FxaaFloat minWN = min(lumaN, lumaW);","    FxaaFloat rangeMax = max(maxWN, maxESM);","    FxaaFloat rangeMin = min(minWN, minESM);","    FxaaFloat rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;","    FxaaFloat range = rangeMax - rangeMin;","    FxaaFloat rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);","    FxaaBool earlyExit = range < rangeMaxClamped;","/*--------------------------------------------------------------------------*/","    if(earlyExit)","        #if (FXAA_DISCARD == 1)","            FxaaDiscard;","        #else","            return rgbyM;","        #endif","/*--------------------------------------------------------------------------*/","    #if (FXAA_GATHER4_ALPHA == 0)","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 1.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","        #endif","    #else","        FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(1, -1), fxaaQualityRcpFrame.xy));","        FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","    #endif","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNS = lumaN + lumaS;","    FxaaFloat lumaWE = lumaW + lumaE;","    FxaaFloat subpixRcpRange = 1.0/range;","    FxaaFloat subpixNSWE = lumaNS + lumaWE;","    FxaaFloat edgeHorz1 = (-2.0 * lumaM) + lumaNS;","    FxaaFloat edgeVert1 = (-2.0 * lumaM) + lumaWE;","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNESE = lumaNE + lumaSE;","    FxaaFloat lumaNWNE = lumaNW + lumaNE;","    FxaaFloat edgeHorz2 = (-2.0 * lumaE) + lumaNESE;","    FxaaFloat edgeVert2 = (-2.0 * lumaN) + lumaNWNE;","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNWSW = lumaNW + lumaSW;","    FxaaFloat lumaSWSE = lumaSW + lumaSE;","    FxaaFloat edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);","    FxaaFloat edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);","    FxaaFloat edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;","    FxaaFloat edgeVert3 = (-2.0 * lumaS) + lumaSWSE;","    FxaaFloat edgeHorz = abs(edgeHorz3) + edgeHorz4;","    FxaaFloat edgeVert = abs(edgeVert3) + edgeVert4;","/*--------------------------------------------------------------------------*/","    FxaaFloat subpixNWSWNESE = lumaNWSW + lumaNESE;","    FxaaFloat lengthSign = fxaaQualityRcpFrame.x;","    FxaaBool horzSpan = edgeHorz >= edgeVert;","    FxaaFloat subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;","/*--------------------------------------------------------------------------*/","    if(!horzSpan) lumaN = lumaW;","    if(!horzSpan) lumaS = lumaE;","    if(horzSpan) lengthSign = fxaaQualityRcpFrame.y;","    FxaaFloat subpixB = (subpixA * (1.0/12.0)) - lumaM;","/*--------------------------------------------------------------------------*/","    FxaaFloat gradientN = lumaN - lumaM;","    FxaaFloat gradientS = lumaS - lumaM;","    FxaaFloat lumaNN = lumaN + lumaM;","    FxaaFloat lumaSS = lumaS + lumaM;","    FxaaBool pairN = abs(gradientN) >= abs(gradientS);","    FxaaFloat gradient = max(abs(gradientN), abs(gradientS));","    if(pairN) lengthSign = -lengthSign;","    FxaaFloat subpixC = FxaaSat(abs(subpixB) * subpixRcpRange);","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posB;","    posB.x = posM.x;","    posB.y = posM.y;","    FxaaFloat2 offNP;","    offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;","    offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;","    if(!horzSpan) posB.x += lengthSign * 0.5;","    if( horzSpan) posB.y += lengthSign * 0.5;","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posN;","    posN.x = posB.x - offNP.x * FXAA_QUALITY_P0;","    posN.y = posB.y - offNP.y * FXAA_QUALITY_P0;","    FxaaFloat2 posP;","    posP.x = posB.x + offNP.x * FXAA_QUALITY_P0;","    posP.y = posB.y + offNP.y * FXAA_QUALITY_P0;","    FxaaFloat subpixD = ((-2.0)*subpixC) + 3.0;","    FxaaFloat lumaEndN = FxaaLuma(FxaaTexTop(tex, posN));","    FxaaFloat subpixE = subpixC * subpixC;","    FxaaFloat lumaEndP = FxaaLuma(FxaaTexTop(tex, posP));","/*--------------------------------------------------------------------------*/","    if(!pairN) lumaNN = lumaSS;","    FxaaFloat gradientScaled = gradient * 1.0/4.0;","    FxaaFloat lumaMM = lumaM - lumaNN * 0.5;","    FxaaFloat subpixF = subpixD * subpixE;","    FxaaBool lumaMLTZero = lumaMM < 0.0;","/*--------------------------------------------------------------------------*/","    lumaEndN -= lumaNN * 0.5;","    lumaEndP -= lumaNN * 0.5;","    FxaaBool doneN = abs(lumaEndN) >= gradientScaled;","    FxaaBool doneP = abs(lumaEndP) >= gradientScaled;","    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P1;","    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P1;","    FxaaBool doneNP = (!doneN) || (!doneP);","    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P1;","    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P1;","/*--------------------------------------------------------------------------*/","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P2;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P2;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P2;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P2;","/*--------------------------------------------------------------------------*/","        #if (FXAA_QUALITY_PS > 3)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P3;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P3;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P3;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P3;","/*--------------------------------------------------------------------------*/","            #if (FXAA_QUALITY_PS > 4)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P4;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P4;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P4;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P4;","/*--------------------------------------------------------------------------*/","                #if (FXAA_QUALITY_PS > 5)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P5;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P5;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P5;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P5;","/*--------------------------------------------------------------------------*/","                    #if (FXAA_QUALITY_PS > 6)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P6;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P6;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P6;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P6;","/*--------------------------------------------------------------------------*/","                        #if (FXAA_QUALITY_PS > 7)","                        if(doneNP) {","                            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                            doneN = abs(lumaEndN) >= gradientScaled;","                            doneP = abs(lumaEndP) >= gradientScaled;","                            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P7;","                            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P7;","                            doneNP = (!doneN) || (!doneP);","                            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P7;","                            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P7;","/*--------------------------------------------------------------------------*/","    #if (FXAA_QUALITY_PS > 8)","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P8;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P8;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P8;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P8;","/*--------------------------------------------------------------------------*/","        #if (FXAA_QUALITY_PS > 9)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P9;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P9;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P9;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P9;","/*--------------------------------------------------------------------------*/","            #if (FXAA_QUALITY_PS > 10)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P10;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P10;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P10;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P10;","/*--------------------------------------------------------------------------*/","                #if (FXAA_QUALITY_PS > 11)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P11;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P11;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P11;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P11;","/*--------------------------------------------------------------------------*/","                    #if (FXAA_QUALITY_PS > 12)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P12;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P12;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P12;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P12;","/*--------------------------------------------------------------------------*/","                    }","                    #endif","/*--------------------------------------------------------------------------*/","                }","                #endif","/*--------------------------------------------------------------------------*/","            }","            #endif","/*--------------------------------------------------------------------------*/","        }","        #endif","/*--------------------------------------------------------------------------*/","    }","    #endif","/*--------------------------------------------------------------------------*/","                        }","                        #endif","/*--------------------------------------------------------------------------*/","                    }","                    #endif","/*--------------------------------------------------------------------------*/","                }","                #endif","/*--------------------------------------------------------------------------*/","            }","            #endif","/*--------------------------------------------------------------------------*/","        }","        #endif","/*--------------------------------------------------------------------------*/","    }","/*--------------------------------------------------------------------------*/","    FxaaFloat dstN = posM.x - posN.x;","    FxaaFloat dstP = posP.x - posM.x;","    if(!horzSpan) dstN = posM.y - posN.y;","    if(!horzSpan) dstP = posP.y - posM.y;","/*--------------------------------------------------------------------------*/","    FxaaBool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;","    FxaaFloat spanLength = (dstP + dstN);","    FxaaBool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;","    FxaaFloat spanLengthRcp = 1.0/spanLength;","/*--------------------------------------------------------------------------*/","    FxaaBool directionN = dstN < dstP;","    FxaaFloat dst = min(dstN, dstP);","    FxaaBool goodSpan = directionN ? goodSpanN : goodSpanP;","    FxaaFloat subpixG = subpixF * subpixF;","    FxaaFloat pixelOffset = (dst * (-spanLengthRcp)) + 0.5;","    FxaaFloat subpixH = subpixG * fxaaQualitySubpix;","/*--------------------------------------------------------------------------*/","    FxaaFloat pixelOffsetGood = goodSpan ? pixelOffset : 0.0;","    FxaaFloat pixelOffsetSubpix = max(pixelOffsetGood, subpixH);","    if(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;","    if( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;","    #if (FXAA_DISCARD == 1)","        return FxaaTexTop(tex, posM);","    #else","        return FxaaFloat4(FxaaTexTop(tex, posM).xyz, lumaM);","    #endif","}","/*==========================================================================*/","#endif","","void main() {","  gl_FragColor = FxaaPixelShader(","    vUv,","    vec4(0.0),","    tDiffuse,","    tDiffuse,","    tDiffuse,","    resolution,","    vec4(0.0),","    vec4(0.0),","    vec4(0.0),","    0.75,","    0.166,","    0.0833,","    0.0,","    0.0,","    0.0,","    vec4(0.0)","  );","","  // TODO avoid querying texture twice for same texel","  gl_FragColor.a = texture2D(tDiffuse, vUv).a;","}"].join("\n")};function ed(){qo.call(this,wc),this.type="FXAA"}(ed.prototype=Object.create(qo.prototype)).setSize=function(a,r){this.uniforms.resolution.value.set(1/a,1/r)};var Su={uniforms:{damp:{value:.96},tOld:{value:null},tNew:{value:null}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float damp;","uniform sampler2D tOld;","uniform sampler2D tNew;","varying vec2 vUv;","vec4 when_gt( vec4 x, float y ) {","\treturn max( sign( x - y ), 0.0 );","}","void main() {","\tvec4 texelOld = texture2D( tOld, vUv );","\tvec4 texelNew = texture2D( tNew, vUv );","\ttexelOld *= damp * when_gt( texelOld, 0.1 );","\tgl_FragColor = max(texelNew, texelOld);","}"].join("\n")};function li(a){fr.call(this),this.type="Afterimage",this.uniforms=l.UniformsUtils.clone(Su.uniforms),this.textureComp=new l.WebGLRenderTarget(1,1,{minFilter:l.LinearFilter,magFilter:l.NearestFilter,format:l.RGBAFormat}),this.textureOld=new l.WebGLRenderTarget(1,1,{minFilter:l.LinearFilter,magFilter:l.NearestFilter,format:l.RGBAFormat}),this.shaderMaterial=new l.ShaderMaterial({uniforms:this.uniforms,vertexShader:Su.vertexShader,fragmentShader:Su.fragmentShader}),this.basicMaterial=new l.MeshBasicMaterial,this.createQuadScene(),Object.defineProperties(this,{damp:{get:function(){return this.uniforms.damp.value},set:function(r){this.uniforms.damp.value=r}}}),this.damp=void 0!==a?a:.96}(li.prototype=Object.create(fr.prototype)).render=function(a,r,h,d,y,b,R){var k=this.textureOld;this.textureOld=this.textureComp,this.textureComp=k,this.uniforms.tNew.value=h.texture,this.uniforms.tOld.value=this.textureOld.texture,this.quad.material=this.shaderMaterial,a.autoClear=!1,a.setRenderTarget(this.textureComp),a.render(this.scene,this.camera),this.basicMaterial.map=this.textureComp.texture,this.clear?(a.autoClear=!0,a.autoClearColor=!0,a.autoClearDepth=!0,a.autoClearStencil=!0):a.autoClear=!1,this.quad.material=this.basicMaterial,a.setRenderTarget(this.renderToScreen?null:r),a.render(this.scene,this.camera)},li.prototype.setSize=function(a,r){this.textureComp.setSize(a,r),this.textureOld.setSize(a,r)},li.prototype.toJSON=function(a){var r=fr.prototype.toJSON.call(this,a);return r.damp=this.damp,r};var ar={uniforms:{tDiffuse:{value:null}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tfloat l = linearToRelativeLuminance( texel.rgb );","\tgl_FragColor = vec4( l, l, l, texel.w );","}"].join("\n")},Ll={uniforms:{tDiffuse:{value:null},averageLuminance:{value:1},luminanceMap:{value:null},maxLuminance:{value:16},minLuminance:{value:.01},middleGrey:{value:.6}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["#include <common>","uniform sampler2D tDiffuse;","varying vec2 vUv;","uniform float middleGrey;","uniform float minLuminance;","uniform float maxLuminance;","#ifdef ADAPTED_LUMINANCE","\tuniform sampler2D luminanceMap;","#else","\tuniform float averageLuminance;","#endif","vec3 ToneMap( vec3 vColor ) {","\t#ifdef ADAPTED_LUMINANCE","\t\tfloat fLumAvg = texture2D(luminanceMap, vec2(0.5, 0.5)).r;","\t#else","\t\tfloat fLumAvg = averageLuminance;","\t#endif","\tfloat fLumPixel = linearToRelativeLuminance( vColor );","\tfloat fLumScaled = (fLumPixel * middleGrey) / max( minLuminance, fLumAvg );","\tfloat fLumCompressed = (fLumScaled * (1.0 + (fLumScaled / (maxLuminance * maxLuminance)))) / (1.0 + fLumScaled);","\treturn fLumCompressed * vColor;","}","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tgl_FragColor = vec4( ToneMap( texel.xyz ), texel.w );","}"].join("\n")};function Wc(a,r){fr.call(this);var h=this;this.type="AdaptiveToneMapping",this.needsInit=!0,this.resolution=void 0!==r?r:256,this._adaptive=void 0===a||a,this.luminanceRT=null,this.previousLuminanceRT=null,this.currentLuminanceRT=null,this.copyUniforms=l.UniformsUtils.clone(ts.uniforms),this.materialCopy=new l.ShaderMaterial({uniforms:this.copyUniforms,vertexShader:ts.vertexShader,fragmentShader:ts.fragmentShader,blending:l.NoBlending,depthTest:!1}),this.materialLuminance=new l.ShaderMaterial({uniforms:l.UniformsUtils.clone(ar.uniforms),vertexShader:ar.vertexShader,fragmentShader:ar.fragmentShader,blending:l.NoBlending}),this.createShader(),void 0===Ll&&console.error("nunuStudio: AdaptiveToneMappingPass relies on ToneMapShader"),this.materialToneMap=new l.ShaderMaterial({uniforms:l.UniformsUtils.clone(Ll.uniforms),vertexShader:Ll.vertexShader,fragmentShader:Ll.fragmentShader,blending:l.NoBlending}),this.createQuadScene(),Object.defineProperties(this,{minLuminance:{get:function(){return h.adaptLuminanceShader.uniforms.minLuminance.value},set:function(d){h.adaptLuminanceShader.uniforms.minLuminance.value=d}},tau:{get:function(){return h.adaptLuminanceShader.uniforms.tau.value},set:function(d){h.adaptLuminanceShader.uniforms.tau.value=d}},adaptive:{get:function(){return h._adaptive},set:function(d){d?(this._adaptive=!0,this.materialToneMap.defines.ADAPTED_LUMINANCE="",this.materialToneMap.uniforms.luminanceMap.value=this.luminanceRT.texture):(this._adaptive=!1,delete this.materialToneMap.defines.ADAPTED_LUMINANCE,this.materialToneMap.uniforms.luminanceMap.value=null),this.materialToneMap.needsUpdate=!0}}})}function Mo(){this.uuid=l.Math.generateUUID(),this.width=1,this.height=1,this.passes=[],this.writeBuffer=new l.WebGLRenderTarget(this.width,this.height,Mo.bufferParameters),this.readBuffer=new l.WebGLRenderTarget(this.width,this.height,Mo.bufferParameters),this.copyPass=new qo(ts),this.rendererState=new np}function Xn(a){this.keys=[],this.actions=[];var r=this,h=this.actions;this.events=new dn,this.events.add(window,"keydown",function(d){h.push(d.keyCode),h.push(oi.DOWN)}),this.events.add(window,"keyup",function(d){h.push(d.keyCode),h.push(oi.UP)}),this.events.add(window,"focus",function(d){r.reset()}),!0!==a&&this.create()}function qc(){l.Group.call(this),this.name="controls",this.type="FirstPersonControls",this.sensitivity=.005,this.needsButtonPressed=!0,this.movementEnabled=!0,this.moveSpeed=.05,this.moveOnPlane=!1,this.moveKeys=[Xn.W,Xn.S,Xn.A,Xn.D],this.vector=new l.Vector2(0,0),this.mouse=null,this.keyboard=null,this.tempVector=new l.Vector3}function Eu(){l.Group.call(this),this.name="group",this.type="Group"}function sl(a){l.Object3D.call(this),this.element=a,this.element.style.position="absolute",this.addEventListener("removed",function(){null!==this.element.parentNode&&this.element.parentNode.removeChild(this.element)});var r=this,h=!0;Object.defineProperties(this,{visible:{get:function(){return h},set:function(d){h=d,r.element.style.display=d?"block":"none"}}})}function Xl(a){var r=document.createElement("iframe");r.style.border="none",sl.call(this,r),this.type="HTMLView",this.name="webview";var h,d,y=this;Object.defineProperties(this,{url:{get:function(){return a},set:function(b){a=void 0!==b?Xl.processURL(b):"",y.element.src=a}},width:{get:function(){return h},set:function(b){y.element.style.width=(h=b)+"px"}},height:{get:function(){return d},set:function(b){y.element.style.height=(d=b)+"px"}}}),this.width=512,this.height=512,this.url=void 0!==a?a:""}function Tu(a,r,h){l.HemisphereLight.call(this,a,r,h),this.name="hemisphere"}function ls(a,r,h){l.InstancedMesh.call(this,a,r,h),this.name="instanced",this.type="InstancedMesh",this.receiveShadow=!0,this.castShadow=!0,Object.defineProperties(this,{count:{get:function(){return h},set:function(d){d>h&&(this.instanceMatrix=new l.BufferAttribute(new Float32Array(16*d),16)),h=d}}})}(Wc.prototype=Object.create(fr.prototype)).constructor=Wc,Wc.prototype.render=function(a,r,h,d,y){this.needsInit&&(this.reset(),this.luminanceRT.texture.type=h.texture.type,this.previousLuminanceRT.texture.type=h.texture.type,this.currentLuminanceRT.texture.type=h.texture.type,this.needsInit=!1),this._adaptive&&(this.quad.material=this.materialLuminance,this.materialLuminance.uniforms.tDiffuse.value=h.texture,a.setRenderTarget(this.currentLuminanceRT),a.render(this.scene,this.camera),this.quad.material=this.materialAdaptiveLum,this.materialAdaptiveLum.uniforms.delta.value=d,this.materialAdaptiveLum.uniforms.lastLum.value=this.previousLuminanceRT.texture,this.materialAdaptiveLum.uniforms.currentLum.value=this.currentLuminanceRT.texture,a.setRenderTarget(this.luminanceRT),a.render(this.scene,this.camera),this.quad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.luminanceRT.texture,a.setRenderTarget(this.previousLuminanceRT),a.render(this.scene,this.camera)),this.quad.material=this.materialToneMap,this.materialToneMap.uniforms.tDiffuse.value=h.texture,this.clear?(a.autoClear=!0,a.autoClearColor=!0,a.autoClearDepth=!0,a.autoClearStencil=!0):a.autoClear=!1,a.setRenderTarget(this.renderToScreen?null:r),a.render(this.scene,this.camera)},Wc.prototype.createShader=function(){this.adaptLuminanceShader={defines:{MIP_LEVEL_1X1:(Math.log(this.resolution)/Math.log(2)).toFixed(1)},uniforms:{lastLum:{value:null},currentLum:{value:null},minLuminance:{value:.01},delta:{value:.016},tau:{value:1}},vertexShader:"varying vec2 vUv;\n\t\tvoid main(){\n\t\t\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\t\t\n\t\t}",fragmentShader:"varying vec2 vUv;\n\t\t\n\t\tuniform sampler2D lastLum;\n\t\tuniform sampler2D currentLum;\n\t\tuniform float minLuminance;\n\t\tuniform float delta;\n\t\tuniform float tau;\n\t\t\n\t\tvoid main()\n\t\t{\n\t\t\tvec4 lastLum = texture2D(lastLum, vUv, MIP_LEVEL_1X1);\n\t\t\tvec4 currentLum = texture2D(currentLum, vUv, MIP_LEVEL_1X1);\n\t\t\t\n\t\t\tfloat fLastLum = max(minLuminance, lastLum.r);\n\t\t\tfloat fCurrentLum = max(minLuminance, currentLum.r);\n\t\t\t\n\t\t\t// The adaption seems to work better in extreme lighting differences if the input luminance is squared.\t\t\tfCurrentLum *= fCurrentLum;\n\t\t\t\n\t\t\t// Adapt the luminance using Pattanaik's technique\t\t\tfloat fAdaptedLum = fLastLum + (fCurrentLum - fLastLum) * (1.0 - exp(-delta * tau));\n\t\t\tgl_FragColor.r = fAdaptedLum;\n\t\t}"},this.materialAdaptiveLum=new l.ShaderMaterial({uniforms:l.UniformsUtils.clone(this.adaptLuminanceShader.uniforms),vertexShader:this.adaptLuminanceShader.vertexShader,fragmentShader:this.adaptLuminanceShader.fragmentShader,defines:this.adaptLuminanceShader.defines,blending:l.NoBlending})},Wc.prototype.reset=function(){this.luminanceRT&&this.luminanceRT.dispose(),this.currentLuminanceRT&&this.currentLuminanceRT.dispose(),this.previousLuminanceRT&&this.previousLuminanceRT.dispose(),this.luminanceRT=new l.WebGLRenderTarget(this.resolution,this.resolution,fr.RGBALinear),this.luminanceRT.texture.generateMipmaps=!1,this.previousLuminanceRT=new l.WebGLRenderTarget(this.resolution,this.resolution,fr.RGBALinear),this.previousLuminanceRT.texture.generateMipmaps=!1,this.currentLuminanceRT=new l.WebGLRenderTarget(this.resolution,this.resolution,{minFilter:l.LinearMipMapLinearFilter,magFilter:l.LinearFilter,format:l.RGBAFormat}),this._adaptive&&(this.materialToneMap.defines.ADAPTED_LUMINANCE="",this.materialToneMap.uniforms.luminanceMap.value=this.luminanceRT.texture),this.quad.material=new l.MeshBasicMaterial({color:7829367}),this.materialLuminance.needsUpdate=!0,this.materialAdaptiveLum.needsUpdate=!0,this.materialToneMap.needsUpdate=!0},Wc.prototype.dispose=function(){this.luminanceRT&&this.luminanceRT.dispose(),this.previousLuminanceRT&&this.previousLuminanceRT.dispose(),this.currentLuminanceRT&&this.currentLuminanceRT.dispose(),this.materialLuminance&&this.materialLuminance.dispose(),this.materialAdaptiveLum&&this.materialAdaptiveLum.dispose(),this.materialCopy&&this.materialCopy.dispose(),this.materialToneMap&&this.materialToneMap.dispose()},Wc.prototype.toJSON=function(a){var r=fr.prototype.toJSON.call(this,a);return r.minLuminance=this.minLuminance,r.tau=this.tau,r.adaptive=this._adaptive,r},Mo.bufferParameters={minFilter:l.LinearFilter,magFilter:l.LinearFilter,format:l.RGBAFormat,stencilBuffer:!1},Mo.prototype.swapBuffers=function(){var a=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=a},Mo.prototype.addPass=function(a){this.passes.push(a)},Mo.prototype.moveBack=function(a){var r=this.passes.indexOf(a);if(r>0){for(var h=r;h!==r-1;h-=1)this.passes[h]=this.passes[h-1];return this.passes[r-1]=a,!0}return!1},Mo.prototype.moveForward=function(a){var r=this.passes.indexOf(a);if(-1!==r&&r<this.passes.length-1){for(var h=r;h!==r+1;h+=1)this.passes[h]=this.passes[h+1];return this.passes[r+1]=a,!0}return!1},Mo.prototype.removePass=function(a){var r=this.passes.indexOf(a);-1!==r&&this.passes.splice(r,1)},Mo.prototype.insertPass=function(a,r){this.passes.splice(r,0,a)},Mo.prototype.render=function(a,r,h,d){var y=!1;this.rendererState.backup(a);for(var b=0;b<this.passes.length;b++){var R=this.passes[b];if(R.enabled){if(R.render(a,this.writeBuffer,this.readBuffer,d,y,r,h),R.renderToScreen){R.copyToScreen&&(this.copyPass.renderToScreen=!0,this.copyPass.render(a,this.readBuffer,this.writeBuffer,d));break}R.needsSwap&&(y&&(a.context.stencilFunc(a.context.NOTEQUAL,1,4294967295),this.copyPass.renderToScreen=!1,this.copyPass.render(a,this.writeBuffer,this.readBuffer,d),a.context.stencilFunc(a.context.EQUAL,1,4294967295)),this.swapBuffers()),void 0!==tp&&(R instanceof tp?y=!0:R instanceof Mh&&(y=!1))}}this.rendererState.restore(a)},Mo.prototype.setSize=function(a,r){a=Math.floor(a),r=Math.floor(r),this.width=a,this.height=r,this.writeBuffer.setSize(a,r),this.readBuffer.setSize(a,r);for(var h=0;h<this.passes.length;h++)this.passes[h].setSize(a,r)},Mo.prototype.reset=function(){this.dispose(),this.writeBuffer=new l.WebGLRenderTarget(this.width,this.height,Mo.bufferParameters),this.readBuffer=new l.WebGLRenderTarget(this.width,this.height,Mo.bufferParameters)},Mo.prototype.dispose=function(){this.writeBuffer.dispose(),this.readBuffer.dispose(),this.writeBuffer=null,this.readBuffer=null},Mo.prototype.toJSON=function(){var a={};a.uuid=this.uuid,a.passes=[];for(var r=0;r<this.passes.length;r++)a.passes.push(this.passes[r].toJSON());return a},Mo.fromJSON=function(a){var r=new Mo;r.uuid=a.uuid;for(var h=0;h<a.passes.length;h++){var d=a.passes[h],y=null;if("Render"===d.type)y=new il;else if("UnrealBloom"===d.type)for((y=new Cs).strength=d.strength,y.radius=d.radius,y.threshold=d.threshold,y.bloomFactors=d.bloomFactors,h=0;h<y.bloomTintColors.length;h++)y.bloomTintColors[h].fromArray(d.bloomTintColors[h]);else"Bloom"===d.type?y=new Dr(d.strength,d.kernelSize,d.sigma,d.resolution):"SSAONOH"===d.type?((y=new Mi).kernelRadius=d.kernelRadius,y.minDistance=d.minDistance,y.maxDistance=d.maxDistance,y.kernelSize=d.kernelSize):"SSAO"===d.type?((y=new Po).onlyAO=d.onlyAO,y.radius=d.radius,y.aoClamp=d.aoClamp,y.lumInfluence=d.lumInfluence):"Bokeh"===d.type?y=new Ua(d.focus,d.aperture,d.maxblur):"FXAA"===d.type?y=new ed:"Copy"===d.type?y=new Vc:"Film"===d.type?((y=new ol).grayscale=d.grayscale,y.noiseIntensity=d.noiseIntensity,y.scanlinesIntensity=d.scanlinesIntensity,y.scanlinesCount=d.scanlinesCount):"DotScreen"===d.type?((y=new xc).center.fromArray(d.center),y.angle=d.angle,y.scale=d.scale):"Colorify"===d.type?(y=new Lp).color.setHex(d.color):"Sobel"===d.type?y=new Ns:"Technicolor"===d.type?y=new Hc:"HueSaturation"===d.type?((y=new Io).hue=d.hue,y.saturation=d.saturation):"AdaptiveToneMapping"===d.type?((y=new Wc(d.adaptive)).tau=d.tau,y.minLuminance=d.minLuminance):"Afterimage"===d.type?(y=new li).damp=d.damp:y=new il;y.uuid=d.uuid,y.enabled=d.enabled,y.needsSwap=d.needsSwap,y.renderToScreen=d.renderToScreen,y.clear=d.clear,y.copyToScreen=!0===d.copyToScreen,r.addPass(y)}return r},(Xn.prototype=Xn).constructor=Xn,Xn.update=function(){for(var a=0;this.actions.length>a;){var r=this.actions.shift(),h=this.actions.shift();void 0===this.keys[r]&&(this.keys[r]=new oi),this.keys[r].update(h),(this.keys[r].justReleased||this.keys[r].justPressed)&&(this.actions.push(r),this.actions.push(oi.RESET),a+=2)}},Xn.reset=function(){for(var a=0;a<this.keys.length;a++)void 0!==this.keys[a]&&this.keys[a].reset()},Xn.keyPressed=function(a){return void 0!==this.keys[a]&&this.keys[a].pressed},Xn.keyJustPressed=function(a){return void 0!==this.keys[a]&&this.keys[a].justPressed},Xn.keyJustReleased=function(a){return void 0!==this.keys[a]&&this.keys[a].justReleased},Xn.create=function(){this.events.create()},Xn.dispose=function(){this.events.destroy()},Xn.TAB=9,Xn.ENTER=13,Xn.SHIFT=16,Xn.CTRL=17,Xn.ALT=18,Xn.CAPS_LOCK=20,Xn.ESC=27,Xn.SPACEBAR=32,Xn.PAGE_UP=33,Xn.PAGE_DOWN=34,Xn.END=35,Xn.HOME=36,Xn.INSERT=45,Xn.DEL=46,Xn.LEFT=37,Xn.RIGHT=39,Xn.UP=38,Xn.DOWN=40,Xn.NUM0=48,Xn.NUM1=49,Xn.NUM2=50,Xn.NUM3=51,Xn.NUM4=52,Xn.NUM5=53,Xn.NUM6=54,Xn.NUM7=55,Xn.NUM8=56,Xn.NUM9=57,Xn.A=65,Xn.B=66,Xn.C=67,Xn.D=68,Xn.E=69,Xn.F=70,Xn.G=71,Xn.H=72,Xn.I=73,Xn.J=74,Xn.K=75,Xn.L=76,Xn.M=77,Xn.N=78,Xn.O=79,Xn.P=80,Xn.Q=81,Xn.R=82,Xn.S=83,Xn.T=84,Xn.U=85,Xn.V=86,Xn.W=87,Xn.X=88,Xn.Y=89,Xn.Z=90,Xn.F1=112,Xn.F2=113,Xn.F3=114,Xn.F4=115,Xn.F5=116,Xn.F6=117,Xn.F7=118,Xn.F8=119,Xn.F9=120,Xn.F10=121,Xn.F11=122,Xn.F12=123,qc.UP=new l.Vector3(0,1,0),(qc.prototype=Object.create(l.Group.prototype)).initialize=function(){for(var a=this;null!==a.parent;)(a=a.parent)instanceof Qr&&(this.mouse=a.mouse,this.keyboard=a.keyboard);this.updateControls(),l.Group.prototype.initialize.call(this)},qc.prototype.update=function(a){if(this.needsButtonPressed&&!this.mouse.buttonPressed(Yr.LEFT)||(this.vector.y-=this.sensitivity*this.mouse.delta.y,this.vector.x-=this.sensitivity*this.mouse.delta.x,this.vector.y<-1.57?this.vector.y=-1.57:this.vector.y>1.57&&(this.vector.y=1.57),this.updateControls()),this.movementEnabled){if(this.keyboard.keyPressed(this.moveKeys[0])){var r=this.getWorldDirection(this.tempVector);this.moveOnPlane&&(r.y=0),r.normalize(),r.multiplyScalar(this.moveSpeed),this.position.sub(r)}this.keyboard.keyPressed(this.moveKeys[1])&&(r=this.getWorldDirection(this.tempVector),this.moveOnPlane&&(r.y=0),r.normalize(),r.multiplyScalar(this.moveSpeed),this.position.add(r)),this.keyboard.keyPressed(this.moveKeys[2])&&((r=new l.Vector3(Math.sin(this.vector.x-1.57),0,Math.cos(this.vector.x-1.57))).normalize(),r.multiplyScalar(this.moveSpeed),this.position.sub(r)),this.keyboard.keyPressed(this.moveKeys[3])&&((r=new l.Vector3(Math.sin(this.vector.x+1.57),0,Math.cos(this.vector.x+1.57))).normalize(),r.multiplyScalar(this.moveSpeed),this.position.sub(r))}l.Object3D.prototype.update.call(this,a)},qc.prototype.updateControls=function(){var a=Math.cos(this.vector.y),r=new l.Vector3(Math.sin(this.vector.x)*a,Math.sin(this.vector.y),Math.cos(this.vector.x)*a);r.add(this.position);var h=new l.Matrix4;h.lookAt(this.position,r,qc.UP),this.quaternion.setFromRotationMatrix(h)},qc.prototype.getDirection=function(){var a=this.getWorldDirection(this.tempVector);return a.normalize(),a},qc.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);return r.object.moveSpeed=this.moveSpeed,r.object.sensitivity=this.sensitivity,r.object.needsButtonPressed=this.needsButtonPressed,r.object.movementEnabled=this.movementEnabled,r.object.moveOnPlane=this.moveOnPlane,r.object.moveKeys=this.moveKeys,r},(Eu.prototype=Object.create(l.Group.prototype)).constructor=Eu,(sl.prototype=Object.create(l.Object3D.prototype)).constructor=sl,sl.prototype.isCSS3DObject=!0,(Xl.prototype=Object.create(sl.prototype)).constructor=Xl,Xl.processURL=function(a){return a.replace("watch?v=","embed/")},Xl.prototype.toJSON=function(a){var r=sl.prototype.toJSON.call(this,a);return r.object.height=this.height,r.object.width=this.width,r.object.url=this.url,r},Tu.prototype=Object.create(l.HemisphereLight.prototype),(ls.prototype=Object.create(l.InstancedMesh.prototype)).dispose=function(){null!==this.material&&void 0!==this.material.dispose&&this.material.dispose(),null!==this.geometry&&void 0!==this.geometry.dispose&&this.geometry.dispose(),l.Object3D.prototype.dispose.call(this)},ls.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);return r.object.instanceMatrix=this.instanceMatrix.toJSON(),r.object.count=this.count,r};var za=function(){l.Mesh.call(this,za.Geometry,new l.MeshBasicMaterial({opacity:0,transparent:!0})),this.type="Lensflare",this.frustumCulled=!1,this.renderOrder=1/0;var a=new l.Vector3,r=new l.Vector3,h=new l.DataTexture(new Uint8Array(768),16,16,l.RGBFormat);h.minFilter=l.NearestFilter,h.magFilter=l.NearestFilter,h.wrapS=l.ClampToEdgeWrapping,h.wrapT=l.ClampToEdgeWrapping;var d=new l.DataTexture(new Uint8Array(768),16,16,l.RGBFormat);d.minFilter=l.NearestFilter,d.magFilter=l.NearestFilter,d.wrapS=l.ClampToEdgeWrapping,d.wrapT=l.ClampToEdgeWrapping;var y=za.Geometry,b=new l.RawShaderMaterial({uniforms:{scale:{value:null},screenPosition:{value:null}},vertexShader:["precision highp float;","uniform vec3 screenPosition;","uniform vec2 scale;","attribute vec3 position;","void main() {","\tgl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","void main() {","\tgl_FragColor = vec4( 1.0, 0.0, 1.0, 1.0 );","}"].join("\n"),depthTest:!0,depthWrite:!1,transparent:!1}),R=new l.RawShaderMaterial({uniforms:{map:{value:h},scale:{value:null},screenPosition:{value:null}},vertexShader:["precision highp float;","uniform vec3 screenPosition;","uniform vec2 scale;","attribute vec3 position;","attribute vec2 uv;","varying vec2 vUV;","void main() {","\tvUV = uv;","\tgl_Position = vec4( position.xy * scale + screenPosition.xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","uniform sampler2D map;","varying vec2 vUV;","void main() {","\tgl_FragColor = texture2D( map, vUV );","}"].join("\n"),depthTest:!1,depthWrite:!1,transparent:!1}),k=new l.Mesh(y,b),M=[],H=Mu.Shader,X=new l.RawShaderMaterial({uniforms:{map:{value:null},occlusionMap:{value:d},color:{value:new l.Color(16777215)},scale:{value:new l.Vector2},screenPosition:{value:new l.Vector3}},vertexShader:H.vertexShader,fragmentShader:H.fragmentShader,blending:l.AdditiveBlending,transparent:!0,depthWrite:!1}),oe=new l.Mesh(y,X);this.addElement=function(Ce){M.push(Ce)};var ne=new l.Vector2,ge=new l.Vector2,we=new l.Box2,Se=new l.Vector4;this.onBeforeRender=function(Ce,Pe,Re){Ce.getCurrentViewport(Se);var Oe=Se.w/Se.z,Ge=Se.z/2,ke=Se.w/2,et=16/Se.w;if(ne.set(et*Oe,et),we.min.set(Se.x,Se.y),we.max.set(Se.x+(Se.z-16),Se.y+(Se.w-16)),r.setFromMatrixPosition(this.matrixWorld),r.applyMatrix4(Re.matrixWorldInverse),!(r.z>0)&&(a.copy(r).applyMatrix4(Re.projectionMatrix),ge.x=Se.x+a.x*Ge+Ge-8,ge.y=Se.y+a.y*ke+ke-8,we.containsPoint(ge))){Ce.copyFramebufferToTexture(ge,h),(Kt=b.uniforms).scale.value=ne,Kt.screenPosition.value=a,Ce.renderBufferDirect(Re,null,y,b,k,null),Ce.copyFramebufferToTexture(ge,d),(Kt=R.uniforms).scale.value=ne,Kt.screenPosition.value=a,Ce.renderBufferDirect(Re,null,y,R,k,null);for(var rt=2*-a.x,ut=2*-a.y,vt=0,Lt=M.length;vt<Lt;vt++){var Kt,zt=M[vt];(Kt=X.uniforms).color.value.copy(zt.color),Kt.map.value=zt.texture,Kt.screenPosition.value.x=a.x+rt*zt.distance,Kt.screenPosition.value.y=a.y+ut*zt.distance,Kt.scale.value.set((et=zt.size/Se.w)*(Oe=Se.w/Se.z),et),X.uniformsNeedUpdate=!0,Ce.renderBufferDirect(Re,null,y,X,oe,null)}}},this.dispose=function(){b.dispose(),R.dispose(),X.dispose(),h.dispose(),d.dispose();for(var Ce=0,Pe=M.length;Ce<Pe;Ce++)M[Ce].texture.dispose()}};za.prototype=Object.create(l.Mesh.prototype),za.prototype.constructor=za,za.prototype.isLensflare=!0;var a,r,h,Mu=function(a,r,h,d){this.texture=a,this.size=r||1,this.distance=h||0,this.color=d||new l.Color(16777215)};function Ea(){l.Mesh.call(this,za.Geometry,new l.MeshBasicMaterial({opacity:0,transparent:!0})),this.name="lensflare",this.type="LensFlare",this.renderOrder=1/0,this.frustumCulled=!1,this.receiveShadow=!1,this.castShadow=!1,this.elements=[];var a=new l.Vector3,r=new l.DataTexture(new Uint8Array(768),16,16,l.RGBFormat);r.minFilter=l.NearestFilter,r.magFilter=l.NearestFilter,r.wrapS=l.ClampToEdgeWrapping,r.wrapT=l.ClampToEdgeWrapping,r.needsUpdate=!0;var h=new l.DataTexture(new Uint8Array(768),16,16,l.RGBFormat);h.minFilter=l.NearestFilter,h.magFilter=l.NearestFilter,h.wrapS=l.ClampToEdgeWrapping,h.wrapT=l.ClampToEdgeWrapping,h.needsUpdate=!0;var y,d=za.Geometry,b=new l.RawShaderMaterial({uniforms:{scale:{value:null},screenPosition:{value:null}},vertexShader:"precision highp float;\n\t\t\tuniform vec3 screenPosition;\n\t\t\tuniform vec2 scale;\n\t\t\tattribute vec3 position;\n\t\t\tvoid main()\n\t\t\t{\n\t\t\t\tgl_Position = vec4(position.xy * scale + screenPosition.xy, screenPosition.z, 1.0);\n\t\t\t}",fragmentShader:"precision highp float;\n\t\t\tvoid main()\n\t\t\t{\n\t\t\t\tgl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);\n\t\t\t}",depthTest:!0,depthWrite:!1,transparent:!1}),R=new l.RawShaderMaterial({uniforms:{map:{value:r},scale:{value:null},screenPosition:{value:null}},vertexShader:"precision highp float;\n\t\t\tuniform vec3 screenPosition;\n\t\t\tuniform vec2 scale;\n\t\t\tattribute vec3 position;\n\t\t\tattribute vec2 uv;\n\t\t\tvarying vec2 vUV;\n\t\t\tvoid main()\n\t\t\t{\n\t\t\t\tvUV = uv;\n\t\t\t\tgl_Position = vec4(position.xy * scale + screenPosition.xy, screenPosition.z, 1.0);\n\t\t\t}",fragmentShader:"precision highp float;\n\t\t\tuniform sampler2D map;\n\t\t\tvarying vec2 vUV;\n\t\t\tvoid main()\n\t\t\t{\n\t\t\t\tgl_FragColor = texture2D(map, vUV);\n\t\t\t}",depthTest:!1,depthWrite:!1,transparent:!1}),k=new l.Mesh(d,b),M=(y=Mu.Shader,new l.RawShaderMaterial({uniforms:{map:{value:null},occlusionMap:{value:h},color:{value:new l.Color(16777215)},scale:{value:new l.Vector2},screenPosition:{value:new l.Vector3}},vertexShader:y.vertexShader,fragmentShader:y.fragmentShader,blending:l.AdditiveBlending,transparent:!0,depthWrite:!1})),H=new l.Mesh(d,M),X=new l.Vector2,oe=new l.Vector2,ne=new l.Box2,ge=new l.Vector4;this.onBeforeRender=function(we,Se,Ce){we.getCurrentViewport(ge);var Pe=ge.w/ge.z,Re=ge.z/2,Oe=ge.w/2,Ge=16/ge.w;if(X.set(Ge*Pe,Ge),ne.min.set(ge.x,ge.y),ne.max.set(ge.x+(ge.z-16),ge.y+(ge.w-16)),a.setFromMatrixPosition(this.matrixWorld),a.applyMatrix4(Ce.matrixWorldInverse),a.applyMatrix4(Ce.projectionMatrix),oe.x=ge.x+a.x*Re+Re-8,oe.y=ge.y+a.y*Oe+Oe-8,ne.containsPoint(oe)){we.copyFramebufferToTexture(oe,r),(vt=b.uniforms).scale.value=X,vt.screenPosition.value=a,we.renderBufferDirect(Ce,null,d,b,k,null),we.copyFramebufferToTexture(oe,h),(vt=R.uniforms).scale.value=X,vt.screenPosition.value=a,we.renderBufferDirect(Ce,null,d,R,k,null);for(var ke=2*-a.x,et=2*-a.y,rt=0,ut=this.elements.length;rt<ut;rt++){var vt,Lt=this.elements[rt];(vt=M.uniforms).color.value.copy(Lt.color),vt.map.value=Lt.texture,vt.screenPosition.value.x=a.x+ke*Lt.distance,vt.screenPosition.value.y=a.y+et*Lt.distance,vt.scale.value.set((Ge=Lt.size/ge.w)*(Pe=ge.w/ge.z),Ge),M.uniformsNeedUpdate=!0,we.renderBufferDirect(Ce,null,d,M,H,null)}}},this.dispose=function(){b.dispose(),R.dispose(),M.dispose(),r.dispose(),h.dispose();for(var we=0;we<this.elements.length;we++)this.elements[we].texture.dispose()}}Mu.Shader={uniforms:{map:{value:null},occlusionMap:{value:null},color:{value:null},scale:{value:null},screenPosition:{value:null}},vertexShader:["precision highp float;","uniform vec3 screenPosition;","uniform vec2 scale;","uniform sampler2D occlusionMap;","attribute vec3 position;","attribute vec2 uv;","varying vec2 vUV;","varying float vVisibility;","void main() {","\tvUV = uv;","\tvec2 pos = position.xy;","\tvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.1 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.1 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.5 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.9, 0.9 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.9 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.9 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.1, 0.5 ) );","\tvisibility += texture2D( occlusionMap, vec2( 0.5, 0.5 ) );","\tvVisibility =        visibility.r / 9.0;","\tvVisibility *= 1.0 - visibility.g / 9.0;","\tvVisibility *=       visibility.b / 9.0;","\tgl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","uniform sampler2D map;","uniform vec3 color;","varying vec2 vUV;","varying float vVisibility;","void main() {","\tvec4 texture = texture2D( map, vUV );","\ttexture.a *= vVisibility;","\tgl_FragColor = texture;","\tgl_FragColor.rgb *= color;","}"].join("\n")},za.Geometry=(a=new l.BufferGeometry,r=new Float32Array([-1,-1,0,0,0,1,-1,0,1,0,1,1,0,1,1,-1,1,0,0,1]),h=new l.InterleavedBuffer(r,5),a.setIndex([0,1,2,0,2,3]),a.setAttribute("position",new l.InterleavedBufferAttribute(h,3,0,!1)),a.setAttribute("uv",new l.InterleavedBufferAttribute(h,2,3,!1)),a),(Ea.prototype=Object.create(l.Mesh.prototype)).addFlare=function(a,r,h,d){void 0===r&&(r=-1),void 0===h&&(h=0),void 0===d&&(d=new l.Color(16777215)),h=Math.min(h,Math.max(0,h)),this.addElement(new Mu(a,r,h,d))},Ea.prototype.addElement=function(a){this.elements.push(a)},Ea.prototype.toJSON=function(a){var r=this,h=[],d=l.Object3D.prototype.toJSON.call(this,a,function(y,b){for(var R=0;R<r.elements.length;R++){var k={};k.texture=r.elements[R].texture.toJSON(y).uuid,k.size=r.elements[R].size,k.distance=r.elements[R].distance,k.color=r.elements[R].color.getHex(),h.push(k)}});return d.object.elements=h,d};var td,Bp=function(a,r){switch(r){case l.sRGBEncoding:a.convertSRGBToLinear();break;case l.LinearEncoding:break;default:console.warn("WARNING: LightProbeGenerator convertColorToLinear() encountered an unsupported encoding.")}return a},ip=__webpack_require__(412);function Xc(a,r){l.LightProbe.call(this,a,r),this.type="LightProbe",this.name="probe"}function rh(a,r){l.Mesh.call(this,a,r),this.name="model",this.receiveShadow=!0,this.castShadow=!0}function ll(a,r,h,d,y,b,R,k,M,H,X){l.Texture.call(this,document.createElement("canvas"),h,d,y,b,R,k,M,H,X),this.name="canvas",this.category="Canvas",this.format=l.RGBAFormat,Object.defineProperties(this,{width:{get:function(){return this.image.width},set:function(oe){this.image.width=oe}},height:{get:function(){return this.image.height},set:function(oe){this.image.height=oe}}}),this.width=void 0!==a?a:1,this.height=void 0!==r?r:1,this.context=this.image.getContext("2d")}function Sc(){this.texture=new ll,this.canvas=this.texture.image;var a=new l.SpriteMaterial({map:this.texture,color:16777215,transparent:!0,alphaTest:.4,depthTest:!0,depthWrite:!0,sizeAttenuation:!0});l.Sprite.call(this,a),this.name="sprite",this.type="CanvasSprite",Object.defineProperties(this,{sizeAttenuation:{get:function(){return this.material.sizeAttenuation},set:function(r){this.material.sizeAttenuation=r,this.material.needsUpdate=!0}}})}function ys(){Sc.call(this),this.name="text",this.type="TextSprite";var a="",r="#FFFFFF",h=!0,d="#000000",y=1,b=32,R=ys.CENTER,k="arial";Object.defineProperties(this,{font:{get:function(){return k},set:function(M){k=M,this.drawText()}},align:{get:function(){return R},set:function(M){R=M,this.drawText()}},color:{get:function(){return r},set:function(M){r=M,this.drawText()}},text:{get:function(){return a},set:function(M){M!==a&&(a=M,this.drawText())}},outline:{get:function(){return h},set:function(M){h=M,this.drawText()}},outlineColor:{get:function(){return d},set:function(M){d=M,this.drawText()}},outlineWidth:{get:function(){return y},set:function(M){y=M,this.drawText()}},resolution:{get:function(){return b},set:function(M){b=M,this.drawText()}}}),this.text="text"}function Ie(){l.Group.call(this),this.name="measurement",this.type="Measurement",this.start=new l.Vector3(0,0,0),this.end=new l.Vector3(1,0,0),this.precision=2,this._startWorld=new l.Vector3,this._endWorld=new l.Vector3,this._midpoint=new l.Vector3,this._lastDistance=-1;var a=new l.BufferGeometry;a.setAttribute("position",new l.Float32BufferAttribute([0,0,0,1,0,0],3)),this.line=new l.Line(a,new l.LineBasicMaterial({color:16776960})),this.line.frustumCulled=!1,this.line.locked=!0,this.line.name="line",this.add(this.line),this.label=new ys,this.label.name="label",this.label.locked=!0,this.label.sizeAttenuation=!1,this.label.color="#000000",this.label.font="arial",this.label.resolution=128,this.label.outline=!1,this.label.material.depthTest=!1,this.label.material.depthWrite=!1,this.label.material.needsUpdate=!0,this.label.scale.setScalar(.03),this.add(this.label),this.updateGeometry()}function je(){l.Group.call(this),this.name="orbit",this.type="OrbitControls",this.distance=4,this.maxDistance=20,this.minDistance=2,this.sensitivity=.002,this.zoomSensitivity=.001,this.limitUp=1.57,this.limitDown=-1.57,this.needsButtonPressed=!0,this.zoomEnabled=!0,this.movementEnabled=!0,this.center=new l.Vector3(0,0,0),this.vector=new l.Vector2(Math.PI/2,0),this.smooth=!0,this.friction=.8,this.speed=.3,this.invertNavigation=!1,this.mouse=null,this.keyboard=null,this.speedDistance=0,this.speedCenter=new l.Vector3(0,0,0),this.speedOrientation=new l.Vector2(0,0),this.tempVector=new l.Vector3}function De(a){this.offset=new l.Vector2(0,0),this.size=new l.Vector2(1,1),this.mode=void 0!==a?a:De.RELATIVE,this.anchor=De.TOP_LEFT,this.width=1,this.height=1,this.viewport=new l.Vector4(0,0,1,1)}function xe(a,r,h,d,y){l.OrthographicCamera.call(this,-1,1,1,-1,d,y),this.name="camera",this.size=void 0!==a?a:10,this.aspect=void 0!==r?r:1,this.mode=void 0!==h?h:xe.RESIZE_HORIZONTAL,this.viewport=new De,this.clearColor=!0,this.clearDepth=!0,this.clearStencil=!0,this.order=0,this.updateProjectionMatrix(),this.composer=new Mo;var b=new il;b.renderToScreen=!0,this.composer.addPass(b)}function Ue(a,r,h,d){this.viewport=new De,l.PerspectiveCamera.call(this,a,r,h,d),this.name="camera",this.clearColor=!0,this.clearDepth=!0,this.clearStencil=!0,this.order=0,this.composer=new Mo;var y=new il;y.renderToScreen=!0,this.composer.addPass(y)}function Xe(){l.Group.call(this),this.name="physics",this.type="Physics",this.body=new at,this.body.type=at.DYNAMIC,this.body.mass=1,this.mode=Xe.LOCAL,this.world=null}function yt(a,r,h,d){l.PointLight.call(this,a,r,h,d),this.name="point",this.castShadow=!0,this.shadow.camera.near=.1,this.shadow.camera.far=1e3,this.shadow.bias=0}(Xc.prototype=Object.create(l.LightProbe.prototype)).generate=function(){var a=this.getScene();if(null!==a){var r=new OffscreenCanvas(256,256),h=new l.WebGLRenderer({canvas:r,alpha:!0}),d=new TCubeCamera(1,1e3,256,{format:l.RGBAFormat,magFilter:l.LinearFilter,minFilter:l.LinearFilter});d.matrixAutoUpdate=!1,d.matrix.copy(this.matrix),d.matrixWorld.copy(this.matrixWorld),d.renderTarget.texture.encoding=ip.sRGBEncoding,d.update(h,a);var y=function(b,R){for(var k,M,H,X=0,oe=new l.Vector3,ne=new l.Vector3,ge=new l.Color,we=[0,0,0,0,0,0,0,0,0],Se=new l.SphericalHarmonics3,Ce=Se.coefficients,Pe=0;Pe<6;Pe++){var Re=R.width,Oe=new Uint8Array(Re*Re*4);b.readRenderTargetPixels(R,0,0,Re,Re,Oe,Pe);for(var Ge=2/Re,ke=0,et=Oe.length;ke<et;ke+=4){ge.setRGB(Oe[ke]/255,Oe[ke+1]/255,Oe[ke+2]/255),Bp(ge,R.texture.encoding);var rt=ke/4,ut=(rt%Re+.5)*Ge-1,vt=1-(Math.floor(rt/Re)+.5)*Ge;switch(Pe){case 0:oe.set(1,vt,-ut);break;case 1:oe.set(-1,vt,ut);break;case 2:oe.set(ut,1,-vt);break;case 3:oe.set(ut,-1,vt);break;case 4:oe.set(ut,vt,1);break;case 5:oe.set(-ut,vt,-1)}M=oe.lengthSq(),X+=H=4/(Math.sqrt(M)*M),ne.copy(oe).normalize(),l.SphericalHarmonics3.getBasisAt(ne,we);for(var Lt=0;Lt<9;Lt++)Ce[Lt].x+=we[Lt]*ge.r*H,Ce[Lt].y+=we[Lt]*ge.g*H,Ce[Lt].z+=we[Lt]*ge.b*H}}for(k=4*Math.PI/X,Lt=0;Lt<9;Lt++)Ce[Lt].x*=k,Ce[Lt].y*=k,Ce[Lt].z*=k;return new l.LightProbe(Se)}(h,d.renderTarget);this.sh=y.sh}else console.warn("nunuStudio: LightProbe cannot generate, no scene.",this)},Xc.prototype.toJSON=function(a){var r=l.Light.prototype.toJSON.call(this,a);return r.object.sh=this.sh.toArray(),r},(rh.prototype=Object.create(l.Mesh.prototype)).dispose=function(){null!==this.material&&void 0!==this.material.dispose&&this.material.dispose(),null!==this.geometry&&void 0!==this.geometry.dispose&&this.geometry.dispose(),l.Object3D.prototype.dispose.call(this)},(ll.prototype=Object.create(l.Texture.prototype)).constructor=ll,ll.prototype.isCanvasTexture=!0,ll.prototype.placeholder=function(){this.context.fillStyle="#000000",this.context.fillRect(0,0,this.width,this.height),this.context.font="Normal "+Math.round(this.width/12)+"px Arial",this.context.textAlign="center",this.context.fillStyle="#FF0000",this.context.fillText("Canvas Texture",this.width/2,this.height/2),this.needsUpdate=!0},ll.prototype.clear=function(a){void 0===a?this.context.clearRect(0,0,width,height):(this.context.fillStyle=a,this.context.fillRect(0,0,this.width,this.height))},ll.prototype.toJSON=function(a){var r=l.Texture.prototype.toJSON.call(this,a);return r.width=this.width,r.height=this.height,r},Sc.prototype=Object.create(l.Sprite.prototype),ys.prototype=Object.create(Sc.prototype),ys.LEFT="left",ys.CENTER="center",ys.RIGHT="right",ys.prototype.drawText=function(){var a=this.resolution,r=.8*a,h=this.texture.context;h.font=r+"px "+this.font;var d=h.measureText(this.text).width,y=l.Math.ceilPowerOfTwo(d),b=y/a;this.texture.width=y,this.texture.height=a,h.clearRect(0,0,y,a),0!==this.text.length&&(h.font=r+"px "+this.font,h.textAlign=this.align,h.textBaseline="middle",h.fillStyle=this.color,h.fillText(this.text,y/2,a/2),!0===this.outline&&(h.lineWidth=this.outlineWidth,h.strokeStyle=this.outlineColor,h.strokeText(this.text,y/2,a/2)),this.scale.x=b*this.scale.y,this.texture.needsUpdate=!0)},ys.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);return r.object.text=this.text,r.object.color=this.color,r.object.outline=this.outline,r.object.outlineColor=this.outlineColor,r.object.outlineWidth=this.outlineWidth,r.object.resolution=this.resolution,r.object.align=this.align,r.object.font=this.font,r},ys.fromJSON=function(a){var r=new ys;return r.text=a.text,r.color=a.color,r.outline=a.outline,r.outlineColor=a.outlineColor,r.outlineWidth=a.outlineWidth,r.resolution=a.resolution,r.align=a.align,r.font=a.font,r},(Ie.prototype=Object.create(l.Group.prototype)).constructor=Ie,Ie.prototype.setPoints=function(a,r){this.position.copy(a),this.start.set(0,0,0),this.end.copy(r).sub(a),this._lastDistance=-1,this.updateGeometry()},Ie.prototype.setLocalPoints=function(a,r){this.start.copy(a),this.end.copy(r),this._lastDistance=-1,this.updateGeometry()},Ie.prototype.updateGeometry=function(){var a=this.line.geometry.attributes.position;a.setXYZ(0,this.start.x,this.start.y,this.start.z),a.setXYZ(1,this.end.x,this.end.y,this.end.z),a.needsUpdate=!0,this.line.geometry.computeBoundingSphere(),this._midpoint.copy(this.start).add(this.end).multiplyScalar(.5),this.label.position.copy(this._midpoint),this.updateLabel()},Ie.prototype.updateLabel=function(){this._startWorld.copy(this.start),this.localToWorld(this._startWorld),this._endWorld.copy(this.end),this.localToWorld(this._endWorld);var a=this._startWorld.distanceTo(this._endWorld);(this._lastDistance<0||Math.abs(this._lastDistance-a)>1e-4)&&(this._lastDistance=a,this.label.text=a.toFixed(this.precision))},Ie.prototype.updateMatrixWorld=function(a){l.Group.prototype.updateMatrixWorld.call(this,a),this.updateLabel()},Ie.prototype.toJSON=function(a){var r=l.Group.prototype.toJSON.call(this,a);return r.object.start=this.start.toArray(),r.object.end=this.end.toArray(),r.object.precision=this.precision,r.object.children=[],r},Ie.fromJSON=function(a){var r=new Ie;r.precision=void 0!==a.precision?a.precision:2;var h=new l.Vector3,d=new l.Vector3(1,0,0);return void 0!==a.start&&h.fromArray(a.start),void 0!==a.end&&d.fromArray(a.end),r.setLocalPoints(h,d),r},je.UP=new l.Vector3(0,1,0),je.ZERO=new l.Vector3(0,0,0),(je.prototype=Object.create(l.Group.prototype)).initialize=function(){for(var a=this;null!==a.parent;)(a=a.parent)instanceof Qr&&(this.mouse=a.mouse,this.keyboard=a.keyboard);this.center.copy(this.position),this.updateControls(),l.Group.prototype.initialize.call(this)},je.prototype.update=function(a){var r=!1;if(this.needsButtonPressed&&!this.mouse.buttonPressed(Yr.LEFT)||(!0===this.smooth?(this.speedOrientation.y+=this.speed*this.sensitivity*(this.invertNavigation?this.mouse.delta.y:-this.mouse.delta.y),this.speedOrientation.x-=this.speed*this.sensitivity*this.mouse.delta.x):(this.vector.y-=this.sensitivity*(this.invertNavigation?this.mouse.delta.y:-this.mouse.delta.y),this.vector.x-=this.sensitivity*this.mouse.delta.x),r=!0),this.zoomEnabled&&(this.mouse.buttonPressed(Yr.MIDDLE)&&(!0===this.smooth?this.speedCenter.y+=this.speed*this.sensitivity*this.mouse.delta.y*this.distance:this.center.y+=this.sensitivity*this.mouse.delta.y*this.distance,r=!0),0!==this.mouse.wheel&&(!0===this.smooth?this.speedDistance+=this.speed*this.mouse.wheel*this.position.distanceTo(this.center)*this.sensitivity:this.distance+=this.mouse.wheel*this.position.distanceTo(this.center)*this.sensitivity,r=!0)),this.movementEnabled&&this.mouse.buttonPressed(Yr.RIGHT)){var h=this.getWorldDirection(this.tempVector);if(h.y=0,h.normalize(),!0===this.smooth){var d=this.speed*this.mouse.delta.y*this.sensitivity*this.distance;this.speedCenter.x+=-h.x*d,this.speedCenter.z+=-h.z*d,h.applyAxisAngle(je.UP,Math.PI/2);var y=this.speed*this.mouse.delta.x*this.sensitivity*this.distance;this.speedCenter.x-=h.x*y,this.speedCenter.z-=h.z*y}else this.center.x+=-h.x*(d=this.mouse.delta.y*this.sensitivity*this.distance),this.center.z+=-h.z*d,h.applyAxisAngle(je.UP,Math.PI/2),this.center.x-=h.x*(y=this.mouse.delta.x*this.sensitivity*this.distance),this.center.z-=h.z*y;r=!0}if(!0===this.smooth)return this.distance+=this.speedDistance,this.center.add(this.speedCenter),this.vector.add(this.speedOrientation),this.speedDistance*=this.friction,this.speedOrientation.multiplyScalar(this.friction),this.speedCenter.multiplyScalar(this.friction),void this.updateControls();!0===r&&this.updateControls(),l.Object3D.prototype.update.call(this,a)},je.prototype.updateControls=function(){this.vector.y<this.limitDown?this.vector.y=this.limitDown:this.vector.y>this.limitUp&&(this.vector.y=this.limitUp),this.distance<this.minDistance?this.distance=this.minDistance:this.distance>this.maxDistance&&(this.distance=this.maxDistance);var a=this.distance*Math.cos(this.vector.y);this.position.set(Math.cos(this.vector.x)*a,this.distance*Math.sin(this.vector.y),Math.sin(this.vector.x)*a),this.position.add(this.center);var r=new l.Matrix4;r.lookAt(this.position,this.center,je.UP),this.quaternion.setFromRotationMatrix(r)},je.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);return r.object.distance=this.distance,r.object.maxDistance=this.maxDistance,r.object.minDistance=this.minDistance,r.object.sensitivity=this.sensitivity,r.object.limitUp=this.limitUp,r.object.limitDown=this.limitDown,r.object.needsButtonPressed=this.needsButtonPressed,r.object.zoomEnabled=this.zoomEnabled,r.object.movementEnabled=this.movementEnabled,r.object.smooth=this.smooth,r.object.friction=this.friction,r.object.speed=this.speed,r.object.invertNavigation=this.invertNavigation,r.object.center=this.center.toArray(),r.object.vector=this.vector.toArray(),r},De.RELATIVE=200,De.ABSOLUTE=201,De.TOP_LEFT=301,De.TOP_RIGHT=302,De.BOTTOM_LEFT=303,De.BOTTOM_RIGHT=304,De.prototype.update=function(a){var r,h,d,y,b,R;void 0===a?(d=0,y=0,r=this.width,h=this.height):(d=a.viewport.x,y=a.viewport.y,r=a.viewport.z,h=a.viewport.w),this.mode===De.RELATIVE?(b=new l.Vector2(this.offset.x*r,this.offset.y*h),R=new l.Vector2(this.size.x*r,this.size.y*h)):this.mode===De.ABSOLUTE&&(b=this.offset,R=this.size),this.anchor===De.BOTTOM_LEFT?this.viewport.set(b.x+d,b.y+y,R.x,R.y):this.anchor===De.BOTTOM_RIGHT?this.viewport.set(r-R.x-b.x+d,b.y+y,R.x,R.y):this.anchor===De.TOP_LEFT?this.viewport.set(b.x+d,h-R.y-b.y+y,R.x,R.y):this.anchor===De.TOP_RIGHT&&this.viewport.set(r-R.x-b.x+d,h-R.y-b.y+y,R.x,R.y)},De.prototype.getAspectRatio=function(){return this.viewport.z/this.viewport.w},De.prototype.isInside=function(a,r){return r.position.x>this.viewport.x&&r.position.x<this.viewport.x+this.viewport.z&&r.position.y<this.height-this.viewport.y&&r.position.y>this.height-this.viewport.y-this.viewport.w},De.prototype.getNormalized=(td=new l.Vector2,function(a,r){return td.set((r.position.x-this.viewport.z-this.viewport.x)/this.viewport.z*2+1,-(r.position.y-(this.height-(this.viewport.y+this.viewport.w)))/this.viewport.w*2+1),td}),De.prototype.enable=function(a){a.setViewport(this.viewport),a.setScissor(this.viewport)},De.prototype.toJSON=function(){return{offset:this.offset.toArray(),size:this.size.toArray(),mode:this.mode,anchor:this.anchor}},De.prototype.fromJSON=function(a){this.offset.fromArray(a.offset),this.size.fromArray(a.size),this.mode=a.mode,this.anchor=a.anchor},xe.prototype=Object.create(l.OrthographicCamera.prototype),xe.RESIZE_HORIZONTAL=0,xe.RESIZE_VERTICAL=1,xe.prototype.resize=function(a,r,h){this.viewport.width=a,this.viewport.height=r,this.viewport.update(h),this.aspect=this.viewport.getAspectRatio(),this.updateProjectionMatrix(),this.composer.setSize(this.viewport.viewport.z,this.viewport.viewport.w)},xe.prototype.setupRenderer=function(a){this.viewport.enable(a),a.clear(this.clearColor,this.clearDepth,this.clearStencil)},xe.prototype.render=function(a,r){this.composer.render(a,r,this,.016)},xe.prototype.destroy=function(){var a=this.getScene();null!==a&&a.removeCamera(this),l.Object3D.prototype.destroy.call(this)},xe.prototype.updateProjectionMatrix=function(){this.mode===xe.RESIZE_HORIZONTAL?(this.top=this.size/2,this.bottom=-this.top,this.right=this.top*this.aspect,this.left=-this.right):this.mode===xe.RESIZE_VERTICAL&&(this.right=this.size/2,this.left=-this.right,this.top=this.right/this.aspect,this.bottom=-this.top),l.OrthographicCamera.prototype.updateProjectionMatrix.call(this)},xe.prototype.toJSON=function(a){var r=l.OrthographicCamera.prototype.toJSON.call(this,a);return r.object.size=this.size,r.object.aspect=this.aspect,r.object.mode=this.mode,r.object.clearColor=this.clearColor,r.object.clearDepth=this.clearDepth,r.object.clearStencil=this.clearStencil,r.object.viewport=this.viewport.toJSON(),r.object.order=this.order,r.object.composer=this.composer.toJSON(),r},(Ue.prototype=Object.create(l.PerspectiveCamera.prototype)).resize=function(a,r,h){this.viewport.width=a,this.viewport.height=r,this.viewport.update(h),this.aspect=this.viewport.getAspectRatio(),this.updateProjectionMatrix(),this.composer.setSize(this.viewport.viewport.z,this.viewport.viewport.w)},Ue.prototype.setupRenderer=function(a){this.viewport.enable(a),a.clear(this.clearColor,this.clearDepth,this.clearStencil)},Ue.prototype.render=function(a,r){this.composer.render(a,r,this,.016)},Ue.prototype.destroy=function(){var a=this.getScene();null!==a&&a.removeCamera(this),l.Object3D.prototype.destroy.call(this)},Ue.prototype.updateProjectionMatrix=function(){var a=this.near*Math.tan(.5*l.Math.DEG2RAD*this.fov)/this.zoom,r=2*a,h=this.aspect*r,d=-.5*h;0!==this.filmOffset&&(d+=this.near*this.filmOffset/this.getFilmWidth()),this.projectionMatrix.makePerspective(d,d+h,a,a-r,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},Ue.prototype.toJSON=function(a){var r=l.PerspectiveCamera.prototype.toJSON.call(this,a);return r.object.clearColor=this.clearColor,r.object.clearDepth=this.clearDepth,r.object.clearStencil=this.clearStencil,r.object.viewport=this.viewport.toJSON(),r.object.order=this.order,r.object.composer=this.composer.toJSON(),r},Xe.prototype=Object.create(l.Group.prototype),Xe.LOCAL=100,Xe.WORLD=101,Xe.prototype.initialize=function(){if(this.mode===Xe.LOCAL)this.body.position.copy(this.position),this.body.quaternion.copy(this.quaternion);else if(this.mode===Xe.WORLD){var a=new l.Vector3;this.getWorldPosition(a),this.body.position.copy(a);var r=new l.Quaternion;this.getWorldQuaternion(r),this.body.quaternion.copy(r)}for(var h=this;null!==h.parent;)(h=h.parent)instanceof bs&&(this.world=h.world,this.world.addBody(this.body));l.Object3D.prototype.initialize.call(this)},Xe.prototype.update=function(a){if(this.mode===Xe.LOCAL)this.position.copy(this.body.position),this.body.fixedRotation||this.quaternion.copy(this.body.quaternion);else if(this.mode===Xe.WORLD){var r=new l.Matrix4;if(this.body.fixedRotation)r.setPosition(this.body.position.x,this.body.position.y,this.body.position.z);else{var h=new l.Quaternion;h.copy(this.body.quaternion),r.makeRotationFromQuaternion(h),r.setPosition(this.body.position.x,this.body.position.y,this.body.position.z)}var d=new l.Matrix4;d.getInverse(this.parent.matrixWorld);var y=new l.Vector3;d.multiply(r),d.decompose(this.position,this.quaternion,y)}l.Object3D.prototype.update.call(this,a)},Xe.prototype.addShape=function(a){a instanceof ee&&this.body.addShape(a)},Xe.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);r.object.mode=this.mode,r.object.body={},r.object.body.type=this.body.type,r.object.body.mass=this.body.mass,r.object.body.linearDamping=this.body.linearDamping,r.object.body.angularDamping=this.body.angularDamping,r.object.body.allowSleep=this.body.allowSleep,r.object.body.sleepSpeedLimit=this.body.sleepSpeedLimit,r.object.body.sleepTimeLimit=this.body.sleepTimeLimit,r.object.body.collisionFilterGroup=this.body.collisionFilterGroup,r.object.body.collisionFilterMask=this.body.collisionFilterMask,r.object.body.fixedRotation=this.body.fixedRotation,r.object.body.shapes=[];for(var h=this.body.shapes,d=0;d<h.length;d++){var y=h[d],b={};b.type=y.type,y.type===ee.types.SPHERE?b.radius=y.radius:y.type===ee.types.BOX?(b.halfExtents={},b.halfExtents.x=y.halfExtents.x,b.halfExtents.y=y.halfExtents.y,b.halfExtents.z=y.halfExtents.z):y.type===ee.types.CONVEXPOLYHEDRON?(b.vertices=y.vertices,b.faces=y.faces):y.type===ee.types.HEIGHTFIELD?(b.data=y.data,b.maxValue=y.maxValue,b.minValue=y.minValue,b.elementSize=y.elementSize):y.type===ee.types.TRIMESH&&(b.vertices=y.vertices,b.normals=y.normals,b.edges=y.edges,b.indices=y.indices),r.object.body.shapes[d]=b}return r},Xe.fromJSON=function(a){var r=new Xe;void 0!==a.mode&&(r.mode=a.mode),r.body.type=a.body.type,r.body.mass=a.body.mass,r.body.linearDamping=a.body.linearDamping,r.body.angularDamping=a.body.angularDamping,r.body.allowSleep=a.body.allowSleep,r.body.sleepSpeedLimit=a.body.sleepSpeedLimit,r.body.sleepTimeLimit=a.body.sleepTimeLimit,r.body.collisionFilterGroup=a.body.collisionFilterGroup,r.body.collisionFilterMask=a.body.collisionFilterMask,r.body.fixedRotation=a.body.fixedRotation;for(var h=a.body.shapes,d=0;d<h.length;d++){var y=h[d];if(y.type===ee.types.SPHERE)r.body.addShape(new cc(y.radius));else if(y.type===ee.types.BOX)r.body.addShape(new Fe(new A(y.halfExtents.x,y.halfExtents.y,y.halfExtents.z)));else if(y.type===ee.types.PARTICLE)r.body.addShape(new fn);else if(y.type===ee.types.PLANE)r.body.addShape(new In);else if(y.type===ee.types.HEIGHTFIELD)r.body.addShape(new xn(y.data,{maxValue:y.maxValue,minValue:y.minValue,elementSize:y.elementSize}));else if(y.type===ee.types.CONVEXPOLYHEDRON){for(var b=0;b<y.vertices.length;b++)y.vertices[b]=new A(y.vertices[b].x,y.vertices[b].y,y.vertices[b].z);r.body.addShape(new K(y.vertices,y.faces))}}return r},(yt.prototype=Object.create(l.PointLight.prototype)).updateShadowMap=function(){this.shadow.map.dispose(),this.shadow.map=null,this.shadow.camera.updateProjectionMatrix()};var Pt=__webpack_require__(759),Jt=function(a){l.Loader.call(this,a),this.reversed=!1};function An(a){vi.call(this,"font","Font"),this.reversed=!1,this.font=null,void 0!==a&&(a instanceof ArrayBuffer?(this.data=a,this.format="arraybuffer",this.loadTTF()):"object"==typeof a?(this.data=a,this.font=a,this.format="json",this.encoding="json"):(this.encoding=Bn.getFileExtension(a),this.name=Bn.getFileName(a),"json"===this.encoding?(this.data=JSON.parse(Bn.readFile(a)),this.format="json",this.font=this.data):"ttf"!==this.encoding&&"otf"!==this.encoding&&"ttc"!==this.encoding&&"otc"!==this.encoding||(this.data=Bn.readFileArrayBuffer(a),this.format="arraybuffer",this.loadTTF())))}function Wn(){vi.call(this,"model","Model")}function Dn(a,r){vi.call(this,"audio","Audio"),void 0!==a&&(a instanceof ArrayBuffer?(this.data=a,this.encoding=void 0!==r?r:"",this.format="arraybuffer"):ai.isBase64(a)?(this.encoding=void 0!==r?r:"",this.data=aa.fromBase64(a),this.format="arraybuffer"):(this.data=Bn.readFileArrayBuffer(a),this.encoding=Bn.getFileExtension(a),this.format="arraybuffer"))}function cr(a){ni.call(this,a),this.type="PositionalAudio",this.matrixAutoUpdate=!0,this.distanceModel="inverse",this.panningModel="HRTF",this.panner=this.context.createPanner(),this.panner.connect(this.gain),this.panner.panningModel=this.panningModel,this.panner.distanceModel=this.distanceModel,this.panner.refDistance=1,this.panner.maxDistance=1e4,this.panner.rolloffFactor=1,this.panner.coneInnerAngle=360,this.panner.coneOuterAngle=0,this.panner.coneOuterGain=0,this.scene=null,this.tempPosition=new l.Vector3,this.tempPositionCamera=new l.Vector3,this.tempQuaternionCamera=new l.Quaternion}function Pr(a,r,h,d){l.RectAreaLight.call(this,a,r,h,d),this.name="rectarea"}function Gn(a,r){l.Group.call(this),this.type="Script",this.name="script",this.code=void 0!==a?a:Gn.DEFAULT,this.mode=void 0!==r?r:Gn.APPEND,this.script={},this.program=null,this.scene=null}function Zi(a,r){l.SkinnedMesh.call(this,a,r),this.name="skinned",this.receiveShadow=!0,this.castShadow=!0,this.skeleton=null}Jt.prototype=Object.assign(Object.create(l.Loader.prototype),{constructor:Jt,load:function(a,r,h,d){var y=this,b=new l.FileLoader(this.manager);b.setPath(this.path),b.setResponseType("arraybuffer"),b.setRequestHeader(this.requestHeader),b.load(a,function(R){try{r(y.parse(R))}catch(k){d?d(k):console.error(k),y.manager.itemError(a)}},h,d)},parse:function(a){function r(h){var d,y=[];h.forEach(function(R){"m"===R.type.toLowerCase()?y.push(d=[R]):"z"!==R.type.toLowerCase()&&d.push(R)});var b=[];return y.forEach(function(R){var k={type:"m",x:R[R.length-1].x,y:R[R.length-1].y};b.push(k);for(var M=R.length-1;M>0;M--){var H=R[M];k={type:H.type},void 0!==H.x2&&void 0!==H.y2?(k.x1=H.x2,k.y1=H.y2,k.x2=H.x1,k.y2=H.y1):void 0!==H.x1&&void 0!==H.y1&&(k.x1=H.x1,k.y1=H.y1),k.x=R[M-1].x,k.y=R[M-1].y,b.push(k)}}),b}return void 0===Pt.U?(console.warn("THREE.TTFLoader: The loader requires opentype.js. Make sure it's included before using the loader."),null):function(h,d){for(var y=Math.round,b={},R=1e5/(72*(h.unitsPerEm||2048)),k=h.encoding.cmap.glyphIndexMap,M=Object.keys(k),H=0;H<M.length;H++){var X=M[H],oe=h.glyphs.glyphs[k[X]];if(void 0!==X){var ne={ha:y(oe.advanceWidth*R),x_min:y(oe.xMin*R),x_max:y(oe.xMax*R),o:""};d&&(oe.path.commands=r(oe.path.commands)),oe.path.commands.forEach(function(ge){"c"===ge.type.toLowerCase()&&(ge.type="b"),ne.o+=ge.type.toLowerCase()+" ",void 0!==ge.x&&void 0!==ge.y&&(ne.o+=y(ge.x*R)+" "+y(ge.y*R)+" "),void 0!==ge.x1&&void 0!==ge.y1&&(ne.o+=y(ge.x1*R)+" "+y(ge.y1*R)+" "),void 0!==ge.x2&&void 0!==ge.y2&&(ne.o+=y(ge.x2*R)+" "+y(ge.y2*R)+" ")}),b[String.fromCodePoint(oe.unicode)]=ne}}return{glyphs:b,familyName:h.getEnglishName("fullName"),ascender:y(h.ascender*R),descender:y(h.descender*R),underlinePosition:h.tables.post.underlinePosition,underlineThickness:h.tables.post.underlineThickness,boundingBox:{xMin:h.tables.head.xMin,xMax:h.tables.head.xMax,yMin:h.tables.head.yMin,yMax:h.tables.head.yMax},resolution:1e3,original_font_information:h.tables.name}}(Pt.U.parse(a),this.reversed)}}),An.prototype=Object.create(vi.prototype),An.fileIsFont=function(a){return void 0!==a&&((a=a.name.toLocaleLowerCase()).endsWith("ttf")||a.endsWith("otf")||a.endsWith("ttc")||a.endsWith("otc")||a.endsWith("json"))},An.prototype.isFont=!0,An.prototype.reverseGlyphs=function(){this.reversed=!this.reversed,this.loadTTF()},An.prototype.loadTTF=function(){var a=new Jt;a.reversed=this.reversed,this.font=a.parse(this.data)},An.prototype.toJSON=function(a){if(void 0!==a.fonts[this.uuid])return a.fonts[this.uuid];var r=vi.prototype.toJSON.call(this,a);return r.encoding=this.encoding,r.reversed=this.reversed,"arraybuffer"===this.format?(r.data=this.data,r.format=this.format):"base64"===this.format?(r.data=aa.fromBase64(this.data),r.format="arraybuffer"):(r.data=this.data,r.format=this.format),a.fonts[this.uuid]=r,r},An.prototype.generateShapes=function(a,r,h){void 0===r&&(r=100),void 0===h&&(h=10);for(var d=this.font,y=function(M){for(var H=String(M).split(""),X=r/d.resolution,oe=(d.boundingBox.yMax-d.boundingBox.yMin)*X,ne=0,ge=0,we=[],Se=0;Se<H.length;Se++){var Ce=H[Se];if("\n"===Ce)ge-=oe,ne=0;else{var Pe=k(Ce,X,ne,ge);ne+=Pe.width,we.push(Pe.path)}}return we}(a),b=[],R=0;R<y.length;R++)Array.prototype.push.apply(b,y[R].toShapes());return b;function k(M,H,X,oe){var ne=d.glyphs[M]||d.glyphs["?"];if(ne){var ge,we,Se,Ce,Pe,Re,Oe,Ge,ke,et,rt,ut=new l.ShapePath,vt=[],Lt=l.ShapeUtils.b2,Kt=l.ShapeUtils.b3;if(ne.o)for(var zt=ne._cachedOutline||(ne._cachedOutline=ne.o.split(" ")),Bt=0,$t=zt.length;Bt<$t;){var ht=zt[Bt++];if("m"===ht&&(ge=zt[Bt++]*H+X,we=zt[Bt++]*H+oe,ut.moveTo(ge,we)),"l"===ht)ge=zt[Bt++]*H+X,we=zt[Bt++]*H+oe,ut.lineTo(ge,we);else if("q"===ht){if(Se=zt[Bt++]*H+X,Ce=zt[Bt++]*H+oe,Oe=zt[Bt++]*H+X,Ge=zt[Bt++]*H+oe,ut.quadraticCurveTo(Oe,Ge,Se,Ce),rt=vt[vt.length-1]){Pe=rt.x,Re=rt.y;for(var Tt=1;Tt<=h;Tt++)Lt(Zt=Tt/h,Pe,Oe,Se),Lt(Zt,Re,Ge,Ce)}}else if("b"===ht&&(Se=zt[Bt++]*H+X,Ce=zt[Bt++]*H+oe,Oe=zt[Bt++]*H+X,Ge=zt[Bt++]*H+oe,ke=zt[Bt++]*H+X,et=zt[Bt++]*H+oe,ut.bezierCurveTo(Oe,Ge,ke,et,Se,Ce),rt=vt[vt.length-1]))for(Pe=rt.x,Re=rt.y,Tt=1;Tt<=h;Tt++){var Zt;Kt(Zt=Tt/h,Pe,Oe,ke,Se),Kt(Zt,Re,Ge,et,Ce)}}return{width:ne.ha*H,path:ut}}}},Wn.prototype=Object.create(vi.prototype),Wn.extensions=["gcode","drc","assimp","assimp.json","blend","amf","babylon","prwm","svg","obj","3ds","dae","gltf","glb","3mf","awd","ply","vtk","vtp","wrl","vrml","fbx","pcd","stl","json","x"],Wn.fileIsModel=function(a){if(void 0!==a){a=a.name.toLocaleLowerCase();for(var r=0;r<Wn.extensions.length;r++)if(a.endsWith(Wn.extensions[r]))return!0}return!1},Dn.prototype=Object.create(vi.prototype),Dn.fileIsAudio=function(a){return!(void 0===a||!a.type.startsWith("audio"))},Dn.prototype.getAudioBuffer=function(a,r){a.decodeAudioData(this.data.slice(0),r,function(h){console.error("nunuStudio: Cannot decode audio buffer ("+h+")")})},Dn.prototype.toJSON=function(a){if(void 0!==a.audio[this.uuid])return a.audio[this.uuid];var r=vi.prototype.toJSON.call(this,a);return r.encoding=this.encoding,r.data=this.data,r.format=this.format,a.audio[this.uuid]=r,r},(cr.prototype=Object.create(ni.prototype)).initialize=function(){ni.prototype.initialize.call(this);for(var a=this.parent;null!==a;){if(a instanceof bs){this.scene=a;break}a=a.parent}},cr.prototype.update=function(a){if(this.scene.cameras.length>0){var r=this.scene.cameras[0];this.getWorldPosition(this.tempPosition),r.getWorldPosition(this.tempPositionCamera),r.getWorldQuaternion(this.tempQuaternionCamera),this.tempPosition.sub(this.tempPositionCamera),this.tempPosition.z=-this.tempPosition.z,this.tempPosition.applyQuaternion(this.tempQuaternionCamera),this.panner.setPosition(this.tempPosition.x,this.tempPosition.z,this.tempPosition.y)}else this.panner.setPosition(0,0,0),this.panner.setOrientation(0,0,0);l.Object3D.prototype.update.call(this,a)},cr.prototype.getOutput=function(){return this.panner},cr.prototype.getRefDistance=function(){return this.panner.refDistance},cr.prototype.setRefDistance=function(a){this.panner.refDistance=a},cr.prototype.getRolloffFactor=function(){return this.panner.rolloffFactor},cr.prototype.setRolloffFactor=function(a){this.panner.rolloffFactor=a},cr.prototype.getDistanceModel=function(){return this.panner.distanceModel},cr.prototype.setDistanceModel=function(a){this.panner.distanceModel=a},cr.prototype.getMaxDistance=function(){return this.panner.maxDistance},cr.prototype.setMaxDistance=function(a){this.panner.maxDistance=a},cr.prototype.toJSON=function(a){var r=ni.prototype.toJSON.call(this,a);return r.object.distanceModel=this.distanceModel,r.object.panningModel=this.panningModel,r},(Pr.prototype=Object.create(l.RectAreaLight.prototype)).toJSON=function(a){var r=l.Light.prototype.toJSON.call(this,a);return r.object.width=this.width,r.object.height=this.height,r},Gn.prototype=Object.create(l.Group.prototype),Gn.includeRegex=/include[ ]*\([ \n]*["'].+?["'][ \n]*\);*/gi,Gn.includeRegexStart=/include[ ]*\([ \n]*["']/gi,Gn.includeRegexEnd=/["'][ \n]*\);*/gi,Gn.DEFAULT="function initialize() {\n\t// TODO ADD CODE\n}\n\nfunction update(delta) {\n\t// TODO ADD CODE\n}",Gn.METHODS=["initialize","update","dispose","onMouseOver","onResize","onAppData"],Gn.APPEND=100,Gn.EVALUATE=101,Gn.INCLUDE=102,Gn.getIncludes=function(a){for(var r=[],h=new RegExp(Gn.includeRegex,"gi");;){var d=h.exec(a);if(null===d)break;var y=d[0];y=(y=y.replace(Gn.includeRegexStart,"")).replace(Gn.includeRegexEnd,""),r.push(y)}return r},Gn.removeComments=function(a){return a.replace(/(\/\*([\s\S]*?)\*\/)|(\/\/(.*)$)/gm,"")},Gn.removeIncludes=function(a){return a.replace(Gn.includeRegex,"")},Gn.prototype.initialize=function(){for(var a=this;null!==a.parent;)(a=a.parent)instanceof bs?this.scene=a:a instanceof Qr&&(this.program=a);l.Object3D.prototype.initialize.call(this);var r=this;this.compileCode(this.code,function(){void 0!==r.script.initialize&&r.script.initialize.call(r)})},Gn.prototype.update=function(a){if(void 0!==this.script.onMouseOver){var r=this.scene.raycaster.intersectObjects(this.children,!0);r.length>0&&this.script.onMouseOver.call(this,r)}void 0!==this.script.update&&this.script.update.call(this,a),l.Object3D.prototype.update.call(this,a)},Gn.prototype.dispose=function(){void 0!==this.script.dispose&&this.script.dispose.call(this),l.Object3D.prototype.dispose.call(this)},Gn.prototype.resize=function(a,r){void 0!==this.script.onResize&&this.script.onResize.call(this,a,r)},Gn.prototype.appData=function(a){void 0!==this.script.onAppData&&this.script.onAppData.call(this,a)},Gn.prototype.compileCode=function(a,r){try{a=this.code;for(var h=0;h<Gn.METHODS.length;h++){var d=Gn.METHODS[h];a+="\nif(this."+d+" == undefined && typeof "+d+" !== 'undefined'){this."+d+" = "+d+";}"}if(this.mode===Gn.APPEND){a=Gn.removeComments(a);var y=Gn.getIncludes(a);for(a=Gn.removeIncludes(a),h=0;h<y.length;h++){var b=this.program.getResourceByName(y[h]);if(null===b){if(null===(b=Bn.readFile(y[h],!0)))throw new Error("Script include() library "+y[h]+" not found.");a=b+"\n"+a}else a=b.data+"\n"+a}a+='\nfunction include(name)\t\t\t{\t\t\t\tconsole.warn("nunuStudio: Script running in append mode, " + name + " cannot be included in runtime.");\t\t\t}'}else if(this.mode===Gn.EVALUATE)a+='\nfunction include(name)\t\t\t{\t\t\t\tvar text = program.getResourceByName(name);\t\t\t\tif(text === null)\t\t\t\t{\t\t\t\t\ttext = FileSystem.readFile(name, true);\t\t\t\t\tif(text !== null)\t\t\t\t\t{\t\t\t\t\t\tnew Function(text).call(this);\t\t\t\t\t}\t\t\t\t\telse\t\t\t\t\t{\t\t\t\t\t\tconsole.warn("nunuStudio: Javascript file " + name + " not found.");\t\t\t\t\t}\t\t\t\t}\t\t\t\telse\t\t\t\t{\t\t\t\t\tnew Function(text.data).call(this);\t\t\t\t}\t\t\t}';else if(this.mode===Gn.INCLUDE){y=Gn.getIncludes(a),a=Gn.removeIncludes(a);var R=0,k=[];for(h=0;h<y.length;h++){var M=this.program.getResourceByName(y[h]);if(null!==M){var H=new Blob([M.data],{type:"text/plain"});k.push(URL.createObjectURL(H))}else{var X=Bn.readFile(y[h],!0);if(null===X)throw new Error("Script include() library "+y[h]+" not found.");H=new Blob([X],{type:"text/plain"}),k.push(URL.createObjectURL(H))}}if(k.length>0)for(h=0;h<k.length;h++){var oe=document.createElement("script");oe.type="text/javascript",oe.async=!0,oe.src=url,oe.onload=function(){++R===k.length&&void 0!==r&&r()},oe.onerror=oe.onload,document.body.appendChild(oe)}else void 0!==r&&r()}var ne=new Function("__context__","for(var p in __context__){eval('var ' + p + ' = __context__[p];');}"+a);try{var ge=this.createContextObject();this.script=new ne(ge)}catch(we){throw this.script={},console.warn("nunuStudio: Error initializing script code",we),new Error("Error initializing script code")}this.mode!==Gn.INCLUDE&&r()}catch(we){throw this.script={},console.warn("nunuStudio: Error compiling script code",we),new Error("Error compiling script code")}},Gn.prototype.createContextObject=function(){var a={};Object.assign(a,n),Object.assign(a,l),Object.assign(a,o);var r={};for(var h of["E","LN2","LN10","LOG2E","LOG10E","PI","SQRT1_2","SQRT2","abs","acos","acosh","asin","asinh","atan","atan2","atanh","cbrt","ceil","clz32","cos","cosh","exp","expm1","floor","fround","hypot","imul","log","log1p","log2","log10","max","min","pow","random","round","sign","sin","sinh","sqrt","tan","tanh","trunc"])r[h]=window.Math[h];return Object.assign(r,l.Math),Object.assign(a,{self:this,program:this.program,scene:this.scene,THREE:l,CANNON:n,Math:r,Keyboard:this.program.keyboard,Mouse:this.program.mouse}),a},Gn.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);return r.object.code=this.code,r.object.mode=this.mode,r},(Zi.prototype=Object.create(l.SkinnedMesh.prototype)).dispose=function(){null!==this.material&&void 0!==this.material.dispose&&this.material.dispose(),null!==this.geometry&&void 0!==this.geometry.dispose&&this.geometry.dispose(),l.Object3D.prototype.dispose.call(this)},Zi.prototype.toJSON=function(a){var r=this,h=l.Object3D.prototype.toJSON.call(this,a,function(d,y){null!==r.skeleton&&(void 0===d.skeletons[r.skeleton.uuid]&&(d.skeletons[r.skeleton.uuid]=r.skeleton.toJSON(d)),y.skeleton=r.skeleton.uuid)});return void 0!==this.bindMode&&(h.object.bindMode=this.bindMode),void 0!==this.bindMatrix&&(h.object.bindMatrix=this.bindMatrix.toArray()),h};const Bl="uniform vec3 topColor;\r\nuniform vec3 bottomColor;\r\nuniform float offset;\r\nuniform float exponent;\r\nvarying vec3 vWorldPosition;\r\n\r\nvoid main()\r\n{\r\n\tfloat h = normalize(vWorldPosition + offset).y;\r\n\tgl_FragColor = vec4(mix(bottomColor, topColor, max(pow(max(h , 0.0), exponent), 0.0)), 1.0);\r\n}\r\n",Nl="varying vec3 vWorldPosition;\r\n\r\nvoid main()\r\n{\r\n\tvec4 worldPosition = modelMatrix * vec4(position, 1.0);\r\n\tvWorldPosition = worldPosition.xyz;\r\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\r\n}";function ns(a,r,h,d){l.Group.call(this),this.name="sky",this.type="Sky",this.colorTop=[new l.Color(7844859),new l.Color(30463),new l.Color(220086),new l.Color(9273)],this.colorBottom=[new l.Color(15461606),new l.Color(16777215),new l.Color(16705495),new l.Color(26023)],this.sunColor=16777130,this.intensity=.3,this.moonColor=5592507,this.hemisphere=new l.HemisphereLight(3310847,16764031,.5),this.hemisphere.name="hemisphere",this.hemisphere.locked=!0,this.hemisphere.matrixAutoUpdate=!1,this.add(this.hemisphere),this.sun=new rl(this.sunColor,this.intensity),this.sun.castShadow=!0,this.sun.locked=!0,this.add(this.sun);var y={topColor:{type:"c",value:new l.Color(0,.46,1)},bottomColor:{type:"c",value:new l.Color(1,1,1)},offset:{type:"f",value:20},exponent:{type:"f",value:.2}};y.topColor.value.copy(this.hemisphere.color);var b=new l.SphereBufferGeometry(1500,16,16),R=new l.ShaderMaterial({vertexShader:Nl,fragmentShader:Bl,uniforms:y,side:l.BackSide});this.sky=new l.Mesh(b,R),this.sky.locked=!0,this.sky.matrixAutoUpdate=!1,this.sky.name="sky",this.add(this.sky),this.sky.raycast=function(){return null},this.autoUpdate=void 0===a||a,this.sunDistance=void 0!==h?h:100,this.dayTime=void 0!==r?r:120,this.time=void 0!==d?d:75,this.updateSky()}(ns.prototype=Object.create(l.Group.prototype)).initialize=function(){this.updateSky(),l.Object3D.prototype.initialize.call(this)},ns.prototype.update=function(a){this.autoUpdate&&(this.time+=a,this.time>this.dayTime&&(this.time-=this.dayTime),this.updateSky()),l.Object3D.prototype.update.call(this,a)},ns.prototype.updateSky=function(){var a=this.time/this.dayTime;if(a<.25)this.sky.material.uniforms.topColor.value.setRGB(this.colorTop[3].r,this.colorTop[3].g,this.colorTop[3].b),this.sky.material.uniforms.bottomColor.value.setRGB(this.colorBottom[3].r,this.colorBottom[3].g,this.colorBottom[3].b);else if(a<.292){var r=1-(h=23.81*(a-.25));this.sky.material.uniforms.topColor.value.setRGB(r*this.colorTop[3].r+h*this.colorTop[0].r,r*this.colorTop[3].g+h*this.colorTop[0].g,r*this.colorTop[3].b+h*this.colorTop[0].b),this.sky.material.uniforms.bottomColor.value.setRGB(r*this.colorBottom[3].r+h*this.colorBottom[0].r,r*this.colorBottom[3].g+h*this.colorBottom[0].g,r*this.colorBottom[3].b+h*this.colorBottom[0].b)}else a<.4167?(this.sky.material.uniforms.topColor.value.setRGB(this.colorTop[0].r,this.colorTop[0].g,this.colorTop[0].b),this.sky.material.uniforms.bottomColor.value.setRGB(this.colorBottom[0].r,this.colorBottom[0].g,this.colorBottom[0].b)):a<.5?(r=1-(h=12*(a-.4167)),this.sky.material.uniforms.topColor.value.setRGB(r*this.colorTop[0].r+h*this.colorTop[1].r,r*this.colorTop[0].g+h*this.colorTop[1].g,r*this.colorTop[0].b+h*this.colorTop[1].b),this.sky.material.uniforms.bottomColor.value.setRGB(r*this.colorBottom[0].r+h*this.colorBottom[1].r,r*this.colorBottom[0].g+h*this.colorBottom[1].g,r*this.colorBottom[0].b+h*this.colorBottom[1].b)):a<.708?(this.sky.material.uniforms.topColor.value.setRGB(this.colorTop[1].r,this.colorTop[1].g,this.colorTop[1].b),this.sky.material.uniforms.bottomColor.value.setRGB(this.colorBottom[1].r,this.colorBottom[1].g,this.colorBottom[1].b)):a<.75?(r=1-(h=23.81*(a-.708)),this.sky.material.uniforms.topColor.value.setRGB(r*this.colorTop[1].r+h*this.colorTop[2].r,r*this.colorTop[1].g+h*this.colorTop[2].g,r*this.colorTop[1].b+h*this.colorTop[2].b),this.sky.material.uniforms.bottomColor.value.setRGB(r*this.colorBottom[1].r+h*this.colorBottom[2].r,r*this.colorBottom[1].g+h*this.colorBottom[2].g,r*this.colorBottom[1].b+h*this.colorBottom[2].b)):a<.8333?(r=1-(h=12.048*(a-.75)),this.sky.material.uniforms.topColor.value.setRGB(r*this.colorTop[2].r+h*this.colorTop[3].r,r*this.colorTop[2].g+h*this.colorTop[3].g,r*this.colorTop[2].b+h*this.colorTop[3].b),this.sky.material.uniforms.bottomColor.value.setRGB(r*this.colorBottom[2].r+h*this.colorBottom[3].r,r*this.colorBottom[2].g+h*this.colorBottom[3].g,r*this.colorBottom[2].b+h*this.colorBottom[3].b)):(this.sky.material.uniforms.topColor.value.setRGB(this.colorTop[3].r,this.colorTop[3].g,this.colorTop[3].b),this.sky.material.uniforms.bottomColor.value.setRGB(this.colorBottom[3].r,this.colorBottom[3].g,this.colorBottom[3].b));if(a<.2)this.sun.intensity=this.intensity,this.sun.color.setHex(this.moonColor);else if(a<.3)r=1-(h=10*(a-.2)),h<.5?(this.sun.intensity=(r=2-2*h)*this.intensity,this.sun.color.setHex(this.moonColor)):(this.sun.intensity=(h*=2)*this.intensity,this.sun.color.setHex(this.sunColor));else if(a<.7)this.sun.intensity=this.intensity,this.sun.color.setHex(this.sunColor);else if(a<.8){var h;(h=10*(a-.7))<.5?(this.sun.intensity=(r=2-2*h)*this.intensity,this.sun.color.setHex(this.sunColor)):(this.sun.intensity=(h*=2)*this.intensity,this.sun.color.setHex(this.moonColor))}else this.sun.intensity=this.intensity,this.sun.color.setHex(this.moonColor);var d=Gc.PI2*a-Gc.PID2;a>.25&&a<.75?(this.sun.position.x=this.sunDistance*Math.cos(d),this.sun.position.y=this.sunDistance*Math.sin(d)):(this.sun.position.x=this.sunDistance*Math.cos(d+Math.PI),this.sun.position.y=this.sunDistance*Math.sin(d+Math.PI))},ns.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);r.object.colorTop=[];for(var h=0;h<this.colorTop.length;h++)r.object.colorTop.push(this.colorTop[h].toJSON());for(r.object.colorBottom=[],h=0;h<this.colorBottom.length;h++)r.object.colorBottom.push(this.colorBottom[h].toJSON());return r.object.sunColor=this.sunColor,r.object.moonColor=this.moonColor,r.object.intensity=this.intensity,r.object.autoUpdate=this.autoUpdate,r.object.sunDistance=this.sunDistance,r.object.dayTime=this.dayTime,r.object.time=this.time,r.object.sun={},r.object.sun.castShadow=this.sun.castShadow,r.object.sun.shadow=this.sun.shadow.toJSON(),r};var ln,cl,Yl,Gd=__webpack_require__(175);if(Gd){let a=window.require;window.require=r=>a?a(r):"three"===r?Gd:void 0}class Mf{constructor(){this.entries={},this.size=0}add(r){let h=this.entries[r];return this.entries[r]=!0,!h&&(this.size++,!0)}addAll(r){let h=this.size;for(var d=0,y=r.length;d<y;d++)this.add(r[d]);return h!=this.size}contains(r){return this.entries[r]}clear(){this.entries={},this.size=0}}class xi{constructor(r=0,h=0,d=0,y=0){this.r=r,this.g=h,this.b=d,this.a=y}set(r,h,d,y){return this.r=r,this.g=h,this.b=d,this.a=y,this.clamp()}setFromColor(r){return this.r=r.r,this.g=r.g,this.b=r.b,this.a=r.a,this}setFromString(r){return r="#"==r.charAt(0)?r.substr(1):r,this.r=parseInt(r.substr(0,2),16)/255,this.g=parseInt(r.substr(2,2),16)/255,this.b=parseInt(r.substr(4,2),16)/255,this.a=8!=r.length?1:parseInt(r.substr(6,2),16)/255,this}add(r,h,d,y){return this.r+=r,this.g+=h,this.b+=d,this.a+=y,this.clamp()}clamp(){return this.r<0?this.r=0:this.r>1&&(this.r=1),this.g<0?this.g=0:this.g>1&&(this.g=1),this.b<0?this.b=0:this.b>1&&(this.b=1),this.a<0?this.a=0:this.a>1&&(this.a=1),this}static rgba8888ToColor(r,h){r.r=((4278190080&h)>>>24)/255,r.g=((16711680&h)>>>16)/255,r.b=((65280&h)>>>8)/255,r.a=(255&h)/255}static rgb888ToColor(r,h){r.r=((16711680&h)>>>16)/255,r.g=((65280&h)>>>8)/255,r.b=(255&h)/255}static fromString(r){return(new xi).setFromString(r)}}xi.WHITE=new xi(1,1,1,1),xi.RED=new xi(1,0,0,1),xi.GREEN=new xi(0,1,0,1),xi.BLUE=new xi(0,0,1,1),xi.MAGENTA=new xi(1,0,1,1);class Ln{static clamp(r,h,d){return r<h?h:r>d?d:r}static cosDeg(r){return Math.cos(r*Ln.degRad)}static sinDeg(r){return Math.sin(r*Ln.degRad)}static signum(r){return r>0?1:r<0?-1:0}static toInt(r){return r>0?Math.floor(r):Math.ceil(r)}static cbrt(r){let h=Math.pow(Math.abs(r),.3333333333333333);return r<0?-h:h}static randomTriangular(r,h){return Ln.randomTriangularWith(r,h,.5*(r+h))}static randomTriangularWith(r,h,d){let y=Math.random(),b=h-r;return y<=(d-r)/b?r+Math.sqrt(y*b*(d-r)):h-Math.sqrt((1-y)*b*(h-d))}static isPowerOfTwo(r){return r&&!(r&r-1)}}Ln.PI=3.1415927,Ln.PI2=2*Ln.PI,Ln.radiansToDegrees=180/Ln.PI,Ln.radDeg=Ln.radiansToDegrees,Ln.degreesToRadians=Ln.PI/180,Ln.degRad=Ln.degreesToRadians;class Yf{apply(r,h,d){return r+(h-r)*this.applyInternal(d)}}class Jf extends Yf{constructor(r){super(),this.power=2,this.power=r}applyInternal(r){return r<=.5?Math.pow(2*r,this.power)/2:Math.pow(2*(r-1),this.power)/(this.power%2==0?-2:2)+1}}class gr{static arrayCopy(r,h,d,y,b){for(let R=h,k=y;R<h+b;R++,k++)d[k]=r[R]}static arrayFill(r,h,d,y){for(let b=h;b<d;b++)r[b]=y}static setArraySize(r,h,d=0){let y=r.length;if(y==h)return r;if(r.length=h,y<h)for(let b=y;b<h;b++)r[b]=d;return r}static ensureArrayCapacity(r,h,d=0){return r.length>=h?r:gr.setArraySize(r,h,d)}static newArray(r,h){let d=new Array(r);for(let y=0;y<r;y++)d[y]=h;return d}static newFloatArray(r){if(gr.SUPPORTS_TYPED_ARRAYS)return new Float32Array(r);{let h=new Array(r);for(let d=0;d<h.length;d++)h[d]=0;return h}}static newShortArray(r){if(gr.SUPPORTS_TYPED_ARRAYS)return new Int16Array(r);{let h=new Array(r);for(let d=0;d<h.length;d++)h[d]=0;return h}}static toFloatArray(r){return gr.SUPPORTS_TYPED_ARRAYS?new Float32Array(r):r}static toSinglePrecision(r){return gr.SUPPORTS_TYPED_ARRAYS?Math.fround(r):r}static webkit602BugfixHelper(r,h){}static contains(r,h,d=!0){for(var y=0;y<r.length;y++)if(r[y]==h)return!0;return!1}static enumValue(r,h){return r[h[0].toUpperCase()+h.slice(1)]}}gr.SUPPORTS_TYPED_ARRAYS=typeof Float32Array<"u";class Np{constructor(r){this.items=new Array,this.instantiator=r}obtain(){return this.items.length>0?this.items.pop():this.instantiator()}free(r){r.reset&&r.reset(),this.items.push(r)}freeAll(r){for(let h=0;h<r.length;h++)this.free(r[h])}clear(){this.items.length=0}}class ul{constructor(r=0,h=0){this.x=r,this.y=h}set(r,h){return this.x=r,this.y=h,this}length(){let r=this.x,h=this.y;return Math.sqrt(r*r+h*h)}normalize(){let r=this.length();return 0!=r&&(this.x/=r,this.y/=r),this}}class hl{constructor(r){if(!r)throw new Error("name cannot be null.");this.name=r}}class Au extends hl{constructor(r){super(r),this.id=Au.nextID++,this.worldVerticesLength=0,this.deformAttachment=this}computeWorldVertices(r,h,d,y,b,R){d=b+(d>>1)*R;let k=r.bone.skeleton,M=r.deform,H=this.vertices,X=this.bones;if(!X){M.length>0&&(H=M);let we=r.bone,Se=we.worldX,Ce=we.worldY,Pe=we.a,Re=we.b,Oe=we.c,Ge=we.d;for(let ke=h,et=b;et<d;ke+=2,et+=R){let rt=H[ke],ut=H[ke+1];y[et]=rt*Pe+ut*Re+Se,y[et+1]=rt*Oe+ut*Ge+Ce}return}let oe=0,ne=0;for(let we=0;we<h;we+=2){let Se=X[oe];oe+=Se+1,ne+=Se}let ge=k.bones;if(0==M.length)for(let we=b,Se=3*ne;we<d;we+=R){let Ce=0,Pe=0,Re=X[oe++];for(Re+=oe;oe<Re;oe++,Se+=3){let Oe=ge[X[oe]],Ge=H[Se],ke=H[Se+1],et=H[Se+2];Ce+=(Ge*Oe.a+ke*Oe.b+Oe.worldX)*et,Pe+=(Ge*Oe.c+ke*Oe.d+Oe.worldY)*et}y[we]=Ce,y[we+1]=Pe}else{let we=M;for(let Se=b,Ce=3*ne,Pe=ne<<1;Se<d;Se+=R){let Re=0,Oe=0,Ge=X[oe++];for(Ge+=oe;oe<Ge;oe++,Ce+=3,Pe+=2){let ke=ge[X[oe]],et=H[Ce]+we[Pe],rt=H[Ce+1]+we[Pe+1],ut=H[Ce+2];Re+=(et*ke.a+rt*ke.b+ke.worldX)*ut,Oe+=(et*ke.c+rt*ke.d+ke.worldY)*ut}y[Se]=Re,y[Se+1]=Oe}}}copyTo(r){this.bones?(r.bones=new Array(this.bones.length),gr.arrayCopy(this.bones,0,r.bones,0,this.bones.length)):r.bones=null,this.vertices?(r.vertices=gr.newFloatArray(this.vertices.length),gr.arrayCopy(this.vertices,0,r.vertices,0,this.vertices.length)):r.vertices=null,r.worldVerticesLength=this.worldVerticesLength,r.deformAttachment=this.deformAttachment}}Au.nextID=0;class Zf{constructor(r,h,d){if(!r)throw new Error("name cannot be null.");this.name=r,this.setTimelines(h),this.duration=d}setTimelines(r){if(!r)throw new Error("timelines cannot be null.");this.timelines=r,this.timelineIds=new Mf;for(var h=0;h<r.length;h++)this.timelineIds.addAll(r[h].getPropertyIds())}hasTimeline(r){for(let h=0;h<r.length;h++)if(this.timelineIds.contains(r[h]))return!0;return!1}apply(r,h,d,y,b,R,k,M){if(!r)throw new Error("skeleton cannot be null.");y&&0!=this.duration&&(d%=this.duration,h>0&&(h%=this.duration));let H=this.timelines;for(let X=0,oe=H.length;X<oe;X++)H[X].apply(r,h,d,b,R,k,M)}}(function(a){a[a.setup=0]="setup",a[a.first=1]="first",a[a.replace=2]="replace",a[a.add=3]="add"})(ln||(ln={})),function(a){a[a.mixIn=0]="mixIn",a[a.mixOut=1]="mixOut"}(cl||(cl={}));class Ta{constructor(r,h){this.propertyIds=h,this.frames=gr.newFloatArray(r*this.getFrameEntries())}getPropertyIds(){return this.propertyIds}getFrameEntries(){return 1}getFrameCount(){return this.frames.length/this.getFrameEntries()}getDuration(){return this.frames[this.frames.length-this.getFrameEntries()]}static search1(r,h){let d=r.length;for(let y=1;y<d;y++)if(r[y]>h)return y-1;return d-1}static search(r,h,d){let y=r.length;for(let b=d;b<y;b+=d)if(r[b]>h)return b-d;return y-d}}class ih extends Ta{constructor(r,h,d){super(r,d),this.curves=gr.newFloatArray(r+18*h),this.curves[r-1]=1}setLinear(r){this.curves[r]=0}setStepped(r){this.curves[r]=1}shrink(r){let h=this.getFrameCount()+18*r;if(this.curves.length>h){let d=gr.newFloatArray(h);gr.arrayCopy(this.curves,0,d,0,h),this.curves=d}}setBezier(r,h,d,y,b,R,k,M,H,X,oe){let ne=this.curves,ge=this.getFrameCount()+18*r;0==d&&(ne[h]=2+ge);let we=.03*(y-2*R+M),Se=.03*(b-2*k+H),Ce=.006*(3*(R-M)-y+X),Pe=.006*(3*(k-H)-b+oe),Re=2*we+Ce,Oe=2*Se+Pe,Ge=.3*(R-y)+we+.16666667*Ce,ke=.3*(k-b)+Se+.16666667*Pe,et=y+Ge,rt=b+ke;for(let ut=ge+18;ge<ut;ge+=2)ne[ge]=et,ne[ge+1]=rt,Ge+=Re,ke+=Oe,Re+=Ce,Oe+=Pe,et+=Ge,rt+=ke}getBezierValue(r,h,d,y){let b=this.curves;if(b[y]>r){let H=this.frames[h],X=this.frames[h+d];return X+(r-H)/(b[y]-H)*(b[y+1]-X)}let R=y+18;for(y+=2;y<R;y+=2)if(b[y]>=r){let H=b[y-2],X=b[y-1];return X+(r-H)/(b[y]-H)*(b[y+1]-X)}h+=this.getFrameEntries();let k=b[R-2],M=b[R-1];return M+(r-k)/(this.frames[h]-k)*(this.frames[h+d]-M)}}class oh extends ih{constructor(r,h,d){super(r,h,[d])}getFrameEntries(){return 2}setFrame(r,h,d){this.frames[r<<=1]=h,this.frames[r+1]=d}getCurveValue(r){let h=this.frames,d=h.length-2;for(let b=2;b<=d;b+=2)if(h[b]>r){d=b-2;break}let y=this.curves[d>>1];switch(y){case 0:let b=h[d],R=h[d+1];return R+(r-b)/(h[d+2]-b)*(h[d+2+1]-R);case 1:return h[d+1]}return this.getBezierValue(r,d,1,y-2)}}class Hd extends ih{constructor(r,h,d,y){super(r,h,[d,y])}getFrameEntries(){return 3}setFrame(r,h,d,y){this.frames[r*=3]=h,this.frames[r+1]=d,this.frames[r+2]=y}}class cf extends oh{constructor(r,h,d){super(r,h,"0|"+d),this.boneIndex=0,this.boneIndex=d}apply(r,h,d,y,b,R,k){let M=r.bones[this.boneIndex];if(!M.active)return;if(d<this.frames[0]){switch(R){case ln.setup:return void(M.rotation=M.data.rotation);case ln.first:M.rotation+=(M.data.rotation-M.rotation)*b}return}let H=this.getCurveValue(d);switch(R){case ln.setup:M.rotation=M.data.rotation+H*b;break;case ln.first:case ln.replace:H+=M.data.rotation-M.rotation;case ln.add:M.rotation+=H*b}}}class $m extends Hd{constructor(r,h,d){super(r,h,"1|"+d,"2|"+d),this.boneIndex=0,this.boneIndex=d}apply(r,h,d,y,b,R,k){let M=r.bones[this.boneIndex];if(!M.active)return;let H=this.frames;if(d<H[0]){switch(R){case ln.setup:return M.x=M.data.x,void(M.y=M.data.y);case ln.first:M.x+=(M.data.x-M.x)*b,M.y+=(M.data.y-M.y)*b}return}let X=0,oe=0,ne=Ta.search(H,d,3),ge=this.curves[ne/3];switch(ge){case 0:let we=H[ne];X=H[ne+1],oe=H[ne+2];let Se=(d-we)/(H[ne+3]-we);X+=(H[ne+3+1]-X)*Se,oe+=(H[ne+3+2]-oe)*Se;break;case 1:X=H[ne+1],oe=H[ne+2];break;default:X=this.getBezierValue(d,ne,1,ge-2),oe=this.getBezierValue(d,ne,2,ge+18-2)}switch(R){case ln.setup:M.x=M.data.x+X*b,M.y=M.data.y+oe*b;break;case ln.first:case ln.replace:M.x+=(M.data.x+X-M.x)*b,M.y+=(M.data.y+oe-M.y)*b;break;case ln.add:M.x+=X*b,M.y+=oe*b}}}class Rp extends oh{constructor(r,h,d){super(r,h,"1|"+d),this.boneIndex=0,this.boneIndex=d}apply(r,h,d,y,b,R,k){let M=r.bones[this.boneIndex];if(!M.active)return;if(d<this.frames[0]){switch(R){case ln.setup:return void(M.x=M.data.x);case ln.first:M.x+=(M.data.x-M.x)*b}return}let H=this.getCurveValue(d);switch(R){case ln.setup:M.x=M.data.x+H*b;break;case ln.first:case ln.replace:M.x+=(M.data.x+H-M.x)*b;break;case ln.add:M.x+=H*b}}}class Qf extends oh{constructor(r,h,d){super(r,h,"2|"+d),this.boneIndex=0,this.boneIndex=d}apply(r,h,d,y,b,R,k){let M=r.bones[this.boneIndex];if(!M.active)return;if(d<this.frames[0]){switch(R){case ln.setup:return void(M.y=M.data.y);case ln.first:M.y+=(M.data.y-M.y)*b}return}let H=this.getCurveValue(d);switch(R){case ln.setup:M.y=M.data.y+H*b;break;case ln.first:case ln.replace:M.y+=(M.data.y+H-M.y)*b;break;case ln.add:M.y+=H*b}}}class Cm extends Hd{constructor(r,h,d){super(r,h,"3|"+d,"4|"+d),this.boneIndex=0,this.boneIndex=d}apply(r,h,d,y,b,R,k){let M=r.bones[this.boneIndex];if(!M.active)return;let H,X,oe=this.frames;if(d<oe[0]){switch(R){case ln.setup:return M.scaleX=M.data.scaleX,void(M.scaleY=M.data.scaleY);case ln.first:M.scaleX+=(M.data.scaleX-M.scaleX)*b,M.scaleY+=(M.data.scaleY-M.scaleY)*b}return}let ne=Ta.search(oe,d,3),ge=this.curves[ne/3];switch(ge){case 0:let we=oe[ne];H=oe[ne+1],X=oe[ne+2];let Se=(d-we)/(oe[ne+3]-we);H+=(oe[ne+3+1]-H)*Se,X+=(oe[ne+3+2]-X)*Se;break;case 1:H=oe[ne+1],X=oe[ne+2];break;default:H=this.getBezierValue(d,ne,1,ge-2),X=this.getBezierValue(d,ne,2,ge+18-2)}if(H*=M.data.scaleX,X*=M.data.scaleY,1==b)R==ln.add?(M.scaleX+=H-M.data.scaleX,M.scaleY+=X-M.data.scaleY):(M.scaleX=H,M.scaleY=X);else{let we=0,Se=0;if(k==cl.mixOut)switch(R){case ln.setup:we=M.data.scaleX,Se=M.data.scaleY,M.scaleX=we+(Math.abs(H)*Ln.signum(we)-we)*b,M.scaleY=Se+(Math.abs(X)*Ln.signum(Se)-Se)*b;break;case ln.first:case ln.replace:we=M.scaleX,Se=M.scaleY,M.scaleX=we+(Math.abs(H)*Ln.signum(we)-we)*b,M.scaleY=Se+(Math.abs(X)*Ln.signum(Se)-Se)*b;break;case ln.add:M.scaleX=(H-M.data.scaleX)*b,M.scaleY=(X-M.data.scaleY)*b}else switch(R){case ln.setup:we=Math.abs(M.data.scaleX)*Ln.signum(H),Se=Math.abs(M.data.scaleY)*Ln.signum(X),M.scaleX=we+(H-we)*b,M.scaleY=Se+(X-Se)*b;break;case ln.first:case ln.replace:we=Math.abs(M.scaleX)*Ln.signum(H),Se=Math.abs(M.scaleY)*Ln.signum(X),M.scaleX=we+(H-we)*b,M.scaleY=Se+(X-Se)*b;break;case ln.add:M.scaleX+=(H-M.data.scaleX)*b,M.scaleY+=(X-M.data.scaleY)*b}}}}class Kf extends oh{constructor(r,h,d){super(r,h,"3|"+d),this.boneIndex=0,this.boneIndex=d}apply(r,h,d,y,b,R,k){let M=r.bones[this.boneIndex];if(!M.active)return;if(d<this.frames[0]){switch(R){case ln.setup:return void(M.scaleX=M.data.scaleX);case ln.first:M.scaleX+=(M.data.scaleX-M.scaleX)*b}return}let H=this.getCurveValue(d)*M.data.scaleX;if(1==b)R==ln.add?M.scaleX+=H-M.data.scaleX:M.scaleX=H;else{let X=0;if(k==cl.mixOut)switch(R){case ln.setup:X=M.data.scaleX,M.scaleX=X+(Math.abs(H)*Ln.signum(X)-X)*b;break;case ln.first:case ln.replace:X=M.scaleX,M.scaleX=X+(Math.abs(H)*Ln.signum(X)-X)*b;break;case ln.add:M.scaleX=(H-M.data.scaleX)*b}else switch(R){case ln.setup:X=Math.abs(M.data.scaleX)*Ln.signum(H),M.scaleX=X+(H-X)*b;break;case ln.first:case ln.replace:X=Math.abs(M.scaleX)*Ln.signum(H),M.scaleX=X+(H-X)*b;break;case ln.add:M.scaleX+=(H-M.data.scaleX)*b}}}}class em extends oh{constructor(r,h,d){super(r,h,"4|"+d),this.boneIndex=0,this.boneIndex=d}apply(r,h,d,y,b,R,k){let M=r.bones[this.boneIndex];if(!M.active)return;if(d<this.frames[0]){switch(R){case ln.setup:return void(M.scaleY=M.data.scaleY);case ln.first:M.scaleY+=(M.data.scaleY-M.scaleY)*b}return}let H=this.getCurveValue(d)*M.data.scaleY;if(1==b)R==ln.add?M.scaleY+=H-M.data.scaleY:M.scaleY=H;else{let X=0;if(k==cl.mixOut)switch(R){case ln.setup:X=M.data.scaleY,M.scaleY=X+(Math.abs(H)*Ln.signum(X)-X)*b;break;case ln.first:case ln.replace:X=M.scaleY,M.scaleY=X+(Math.abs(H)*Ln.signum(X)-X)*b;break;case ln.add:M.scaleY=(H-M.data.scaleY)*b}else switch(R){case ln.setup:X=Math.abs(M.data.scaleY)*Ln.signum(H),M.scaleY=X+(H-X)*b;break;case ln.first:case ln.replace:X=Math.abs(M.scaleY)*Ln.signum(H),M.scaleY=X+(H-X)*b;break;case ln.add:M.scaleY+=(H-M.data.scaleY)*b}}}}class Vd extends Hd{constructor(r,h,d){super(r,h,"5|"+d,"6|"+d),this.boneIndex=0,this.boneIndex=d}apply(r,h,d,y,b,R,k){let M=r.bones[this.boneIndex];if(!M.active)return;let H=this.frames;if(d<H[0]){switch(R){case ln.setup:return M.shearX=M.data.shearX,void(M.shearY=M.data.shearY);case ln.first:M.shearX+=(M.data.shearX-M.shearX)*b,M.shearY+=(M.data.shearY-M.shearY)*b}return}let X=0,oe=0,ne=Ta.search(H,d,3),ge=this.curves[ne/3];switch(ge){case 0:let we=H[ne];X=H[ne+1],oe=H[ne+2];let Se=(d-we)/(H[ne+3]-we);X+=(H[ne+3+1]-X)*Se,oe+=(H[ne+3+2]-oe)*Se;break;case 1:X=H[ne+1],oe=H[ne+2];break;default:X=this.getBezierValue(d,ne,1,ge-2),oe=this.getBezierValue(d,ne,2,ge+18-2)}switch(R){case ln.setup:M.shearX=M.data.shearX+X*b,M.shearY=M.data.shearY+oe*b;break;case ln.first:case ln.replace:M.shearX+=(M.data.shearX+X-M.shearX)*b,M.shearY+=(M.data.shearY+oe-M.shearY)*b;break;case ln.add:M.shearX+=X*b,M.shearY+=oe*b}}}class Lm extends oh{constructor(r,h,d){super(r,h,"5|"+d),this.boneIndex=0,this.boneIndex=d}apply(r,h,d,y,b,R,k){let M=r.bones[this.boneIndex];if(!M.active)return;if(d<this.frames[0]){switch(R){case ln.setup:return void(M.shearX=M.data.shearX);case ln.first:M.shearX+=(M.data.shearX-M.shearX)*b}return}let H=this.getCurveValue(d);switch(R){case ln.setup:M.shearX=M.data.shearX+H*b;break;case ln.first:case ln.replace:M.shearX+=(M.data.shearX+H-M.shearX)*b;break;case ln.add:M.shearX+=H*b}}}class Bm extends oh{constructor(r,h,d){super(r,h,"6|"+d),this.boneIndex=0,this.boneIndex=d}apply(r,h,d,y,b,R,k){let M=r.bones[this.boneIndex];if(!M.active)return;if(d<this.frames[0]){switch(R){case ln.setup:return void(M.shearY=M.data.shearY);case ln.first:M.shearY+=(M.data.shearY-M.shearY)*b}return}let H=this.getCurveValue(d);switch(R){case ln.setup:M.shearY=M.data.shearY+H*b;break;case ln.first:case ln.replace:M.shearY+=(M.data.shearY+H-M.shearY)*b;break;case ln.add:M.shearY+=H*b}}}class Wd extends ih{constructor(r,h,d){super(r,h,["7|"+d,"8|"+d]),this.slotIndex=0,this.slotIndex=d}getFrameEntries(){return 5}setFrame(r,h,d,y,b,R){this.frames[r*=5]=h,this.frames[r+1]=d,this.frames[r+2]=y,this.frames[r+3]=b,this.frames[r+4]=R}apply(r,h,d,y,b,R,k){let M=r.slots[this.slotIndex];if(!M.bone.active)return;let H=this.frames,X=M.color;if(d<H[0]){let Pe=M.data.color;switch(R){case ln.setup:return void X.setFromColor(Pe);case ln.first:X.add((Pe.r-X.r)*b,(Pe.g-X.g)*b,(Pe.b-X.b)*b,(Pe.a-X.a)*b)}return}let oe=0,ne=0,ge=0,we=0,Se=Ta.search(H,d,5),Ce=this.curves[Se/5];switch(Ce){case 0:let Pe=H[Se];oe=H[Se+1],ne=H[Se+2],ge=H[Se+3],we=H[Se+4];let Re=(d-Pe)/(H[Se+5]-Pe);oe+=(H[Se+5+1]-oe)*Re,ne+=(H[Se+5+2]-ne)*Re,ge+=(H[Se+5+3]-ge)*Re,we+=(H[Se+5+4]-we)*Re;break;case 1:oe=H[Se+1],ne=H[Se+2],ge=H[Se+3],we=H[Se+4];break;default:oe=this.getBezierValue(d,Se,1,Ce-2),ne=this.getBezierValue(d,Se,2,Ce+18-2),ge=this.getBezierValue(d,Se,3,Ce+36-2),we=this.getBezierValue(d,Se,4,Ce+54-2)}1==b?X.set(oe,ne,ge,we):(R==ln.setup&&X.setFromColor(M.data.color),X.add((oe-X.r)*b,(ne-X.g)*b,(ge-X.b)*b,(we-X.a)*b))}}class tm extends ih{constructor(r,h,d){super(r,h,["7|"+d]),this.slotIndex=0,this.slotIndex=d}getFrameEntries(){return 4}setFrame(r,h,d,y,b){this.frames[r<<=2]=h,this.frames[r+1]=d,this.frames[r+2]=y,this.frames[r+3]=b}apply(r,h,d,y,b,R,k){let M=r.slots[this.slotIndex];if(!M.bone.active)return;let H=this.frames,X=M.color;if(d<H[0]){let Ce=M.data.color;switch(R){case ln.setup:return X.r=Ce.r,X.g=Ce.g,void(X.b=Ce.b);case ln.first:X.r+=(Ce.r-X.r)*b,X.g+=(Ce.g-X.g)*b,X.b+=(Ce.b-X.b)*b}return}let oe=0,ne=0,ge=0,we=Ta.search(H,d,4),Se=this.curves[we>>2];switch(Se){case 0:let Ce=H[we];oe=H[we+1],ne=H[we+2],ge=H[we+3];let Pe=(d-Ce)/(H[we+4]-Ce);oe+=(H[we+4+1]-oe)*Pe,ne+=(H[we+4+2]-ne)*Pe,ge+=(H[we+4+3]-ge)*Pe;break;case 1:oe=H[we+1],ne=H[we+2],ge=H[we+3];break;default:oe=this.getBezierValue(d,we,1,Se-2),ne=this.getBezierValue(d,we,2,Se+18-2),ge=this.getBezierValue(d,we,3,Se+36-2)}if(1==b)X.r=oe,X.g=ne,X.b=ge;else{if(R==ln.setup){let Ce=M.data.color;X.r=Ce.r,X.g=Ce.g,X.b=Ce.b}X.r+=(oe-X.r)*b,X.g+=(ne-X.g)*b,X.b+=(ge-X.b)*b}}}class nm extends oh{constructor(r,h,d){super(r,h,"8|"+d),this.slotIndex=0,this.slotIndex=d}apply(r,h,d,y,b,R,k){let M=r.slots[this.slotIndex];if(!M.bone.active)return;let H=M.color;if(d<this.frames[0]){let oe=M.data.color;switch(R){case ln.setup:return void(H.a=oe.a);case ln.first:H.a+=(oe.a-H.a)*b}return}let X=this.getCurveValue(d);1==b?H.a=X:(R==ln.setup&&(H.a=M.data.color.a),H.a+=(X-H.a)*b)}}class Nm extends ih{constructor(r,h,d){super(r,h,["7|"+d,"8|"+d,"9|"+d]),this.slotIndex=0,this.slotIndex=d}getFrameEntries(){return 8}setFrame(r,h,d,y,b,R,k,M,H){this.frames[r<<=3]=h,this.frames[r+1]=d,this.frames[r+2]=y,this.frames[r+3]=b,this.frames[r+4]=R,this.frames[r+5]=k,this.frames[r+6]=M,this.frames[r+7]=H}apply(r,h,d,y,b,R,k){let M=r.slots[this.slotIndex];if(!M.bone.active)return;let H=this.frames,X=M.color,oe=M.darkColor;if(d<H[0]){let ke=M.data.color,et=M.data.darkColor;switch(R){case ln.setup:return X.setFromColor(ke),oe.r=et.r,oe.g=et.g,void(oe.b=et.b);case ln.first:X.add((ke.r-X.r)*b,(ke.g-X.g)*b,(ke.b-X.b)*b,(ke.a-X.a)*b),oe.r+=(et.r-oe.r)*b,oe.g+=(et.g-oe.g)*b,oe.b+=(et.b-oe.b)*b}return}let ne=0,ge=0,we=0,Se=0,Ce=0,Pe=0,Re=0,Oe=Ta.search(H,d,8),Ge=this.curves[Oe>>3];switch(Ge){case 0:let ke=H[Oe];ne=H[Oe+1],ge=H[Oe+2],we=H[Oe+3],Se=H[Oe+4],Ce=H[Oe+5],Pe=H[Oe+6],Re=H[Oe+7];let et=(d-ke)/(H[Oe+8]-ke);ne+=(H[Oe+8+1]-ne)*et,ge+=(H[Oe+8+2]-ge)*et,we+=(H[Oe+8+3]-we)*et,Se+=(H[Oe+8+4]-Se)*et,Ce+=(H[Oe+8+5]-Ce)*et,Pe+=(H[Oe+8+6]-Pe)*et,Re+=(H[Oe+8+7]-Re)*et;break;case 1:ne=H[Oe+1],ge=H[Oe+2],we=H[Oe+3],Se=H[Oe+4],Ce=H[Oe+5],Pe=H[Oe+6],Re=H[Oe+7];break;default:ne=this.getBezierValue(d,Oe,1,Ge-2),ge=this.getBezierValue(d,Oe,2,Ge+18-2),we=this.getBezierValue(d,Oe,3,Ge+36-2),Se=this.getBezierValue(d,Oe,4,Ge+54-2),Ce=this.getBezierValue(d,Oe,5,Ge+72-2),Pe=this.getBezierValue(d,Oe,6,Ge+90-2),Re=this.getBezierValue(d,Oe,7,Ge+108-2)}if(1==b)X.set(ne,ge,we,Se),oe.r=Ce,oe.g=Pe,oe.b=Re;else{if(R==ln.setup){X.setFromColor(M.data.color);let ke=M.data.darkColor;oe.r=ke.r,oe.g=ke.g,oe.b=ke.b}X.add((ne-X.r)*b,(ge-X.g)*b,(we-X.b)*b,(Se-X.a)*b),oe.r+=(Ce-oe.r)*b,oe.g+=(Pe-oe.g)*b,oe.b+=(Re-oe.b)*b}}}class Af extends ih{constructor(r,h,d){super(r,h,["7|"+d,"9|"+d]),this.slotIndex=0,this.slotIndex=d}getFrameEntries(){return 7}setFrame(r,h,d,y,b,R,k,M){this.frames[r*=7]=h,this.frames[r+1]=d,this.frames[r+2]=y,this.frames[r+3]=b,this.frames[r+4]=R,this.frames[r+5]=k,this.frames[r+6]=M}apply(r,h,d,y,b,R,k){let M=r.slots[this.slotIndex];if(!M.bone.active)return;let H=this.frames,X=M.color,oe=M.darkColor;if(d<H[0]){let Ge=M.data.color,ke=M.data.darkColor;switch(R){case ln.setup:return X.r=Ge.r,X.g=Ge.g,X.b=Ge.b,oe.r=ke.r,oe.g=ke.g,void(oe.b=ke.b);case ln.first:X.r+=(Ge.r-X.r)*b,X.g+=(Ge.g-X.g)*b,X.b+=(Ge.b-X.b)*b,oe.r+=(ke.r-oe.r)*b,oe.g+=(ke.g-oe.g)*b,oe.b+=(ke.b-oe.b)*b}return}let ne=0,ge=0,we=0,Se=0,Ce=0,Pe=0,Re=Ta.search(H,d,7),Oe=this.curves[Re/7];switch(Oe){case 0:let Ge=H[Re];ne=H[Re+1],ge=H[Re+2],we=H[Re+3],Se=H[Re+4],Ce=H[Re+5],Pe=H[Re+6];let ke=(d-Ge)/(H[Re+7]-Ge);ne+=(H[Re+7+1]-ne)*ke,ge+=(H[Re+7+2]-ge)*ke,we+=(H[Re+7+3]-we)*ke,Se+=(H[Re+7+4]-Se)*ke,Ce+=(H[Re+7+5]-Ce)*ke,Pe+=(H[Re+7+6]-Pe)*ke;break;case 1:ne=H[Re+1],ge=H[Re+2],we=H[Re+3],Se=H[Re+4],Ce=H[Re+5],Pe=H[Re+6];break;default:ne=this.getBezierValue(d,Re,1,Oe-2),ge=this.getBezierValue(d,Re,2,Oe+18-2),we=this.getBezierValue(d,Re,3,Oe+36-2),Se=this.getBezierValue(d,Re,4,Oe+54-2),Ce=this.getBezierValue(d,Re,5,Oe+72-2),Pe=this.getBezierValue(d,Re,6,Oe+90-2)}if(1==b)X.r=ne,X.g=ge,X.b=we,oe.r=Se,oe.g=Ce,oe.b=Pe;else{if(R==ln.setup){let Ge=M.data.color,ke=M.data.darkColor;X.r=Ge.r,X.g=Ge.g,X.b=Ge.b,oe.r=ke.r,oe.g=ke.g,oe.b=ke.b}X.r+=(ne-X.r)*b,X.g+=(ge-X.g)*b,X.b+=(we-X.b)*b,oe.r+=(Se-oe.r)*b,oe.g+=(Ce-oe.g)*b,oe.b+=(Pe-oe.b)*b}}}class qd extends Ta{constructor(r,h){super(r,["10|"+h]),this.slotIndex=0,this.slotIndex=h,this.attachmentNames=new Array(r)}getFrameCount(){return this.frames.length}setFrame(r,h,d){this.frames[r]=h,this.attachmentNames[r]=d}apply(r,h,d,y,b,R,k){let M=r.slots[this.slotIndex];M.bone.active&&(k!=cl.mixOut?d<this.frames[0]?R!=ln.setup&&R!=ln.first||this.setAttachment(r,M,M.data.attachmentName):this.setAttachment(r,M,this.attachmentNames[Ta.search1(this.frames,d)]):R==ln.setup&&this.setAttachment(r,M,M.data.attachmentName))}setAttachment(r,h,d){h.setAttachment(d?r.getAttachment(this.slotIndex,d):null)}}class Rm extends ih{constructor(r,h,d,y){super(r,h,["11|"+d+"|"+y.id]),this.slotIndex=0,this.slotIndex=d,this.attachment=y,this.vertices=new Array(r)}getFrameCount(){return this.frames.length}setFrame(r,h,d){this.frames[r]=h,this.vertices[r]=d}setBezier(r,h,d,y,b,R,k,M,H,X,oe){let ne=this.curves,ge=this.getFrameCount()+18*r;0==d&&(ne[h]=2+ge);let we=.03*(y-2*R+M),Se=.03*H-.06*k,Ce=.006*(3*(R-M)-y+X),Pe=.018*(k-H+.33333333),Re=2*we+Ce,Oe=2*Se+Pe,Ge=.3*(R-y)+we+.16666667*Ce,ke=.3*k+Se+.16666667*Pe,et=y+Ge,rt=ke;for(let ut=ge+18;ge<ut;ge+=2)ne[ge]=et,ne[ge+1]=rt,Ge+=Re,ke+=Oe,Re+=Ce,Oe+=Pe,et+=Ge,rt+=ke}getCurvePercent(r,h){let d=this.curves,y=d[h];switch(y){case 0:let M=this.frames[h];return(r-M)/(this.frames[h+this.getFrameEntries()]-M);case 1:return 0}if(y-=2,d[y]>r){let M=this.frames[h];return d[y+1]*(r-M)/(d[y]-M)}let b=y+18;for(y+=2;y<b;y+=2)if(d[y]>=r){let M=d[y-2],H=d[y-1];return H+(r-M)/(d[y]-M)*(d[y+1]-H)}let R=d[b-2],k=d[b-1];return k+(1-k)*(r-R)/(this.frames[h+this.getFrameEntries()]-R)}apply(r,h,d,y,b,R,k){let M=r.slots[this.slotIndex];if(!M.bone.active)return;let H=M.getAttachment();if(!(H instanceof Au)||H.deformAttachment!=this.attachment)return;let X=M.deform;0==X.length&&(R=ln.setup);let oe=this.vertices,ne=oe[0].length,ge=this.frames;if(d<ge[0]){let Oe=H;switch(R){case ln.setup:return void(X.length=0);case ln.first:if(1==b)return void(X.length=0);if(X.length=ne,Oe.bones)for(b=1-b,we=0;we<ne;we++)X[we]*=b;else{let Ge=Oe.vertices;for(var we=0;we<ne;we++)X[we]+=(Ge[we]-X[we])*b}}return}if(X.length=ne,d>=ge[ge.length-1]){let Oe=oe[ge.length-1];if(1==b)if(R==ln.add){let Ge=H;if(Ge.bones)for(let ke=0;ke<ne;ke++)X[ke]+=Oe[ke];else{let ke=Ge.vertices;for(let et=0;et<ne;et++)X[et]+=Oe[et]-ke[et]}}else gr.arrayCopy(Oe,0,X,0,ne);else switch(R){case ln.setup:{let ke=H;if(ke.bones)for(let et=0;et<ne;et++)X[et]=Oe[et]*b;else{let et=ke.vertices;for(let rt=0;rt<ne;rt++){let ut=et[rt];X[rt]=ut+(Oe[rt]-ut)*b}}break}case ln.first:case ln.replace:for(let ke=0;ke<ne;ke++)X[ke]+=(Oe[ke]-X[ke])*b;break;case ln.add:let Ge=H;if(Ge.bones)for(let ke=0;ke<ne;ke++)X[ke]+=Oe[ke]*b;else{let ke=Ge.vertices;for(let et=0;et<ne;et++)X[et]+=(Oe[et]-ke[et])*b}}return}let Se=Ta.search1(ge,d),Ce=this.getCurvePercent(d,Se),Pe=oe[Se],Re=oe[Se+1];if(1==b)if(R==ln.add){let Oe=H;if(Oe.bones)for(let Ge=0;Ge<ne;Ge++){let ke=Pe[Ge];X[Ge]+=ke+(Re[Ge]-ke)*Ce}else{let Ge=Oe.vertices;for(let ke=0;ke<ne;ke++){let et=Pe[ke];X[ke]+=et+(Re[ke]-et)*Ce-Ge[ke]}}}else for(let Oe=0;Oe<ne;Oe++){let Ge=Pe[Oe];X[Oe]=Ge+(Re[Oe]-Ge)*Ce}else switch(R){case ln.setup:{let Ge=H;if(Ge.bones)for(let ke=0;ke<ne;ke++){let et=Pe[ke];X[ke]=(et+(Re[ke]-et)*Ce)*b}else{let ke=Ge.vertices;for(let et=0;et<ne;et++){let rt=Pe[et],ut=ke[et];X[et]=ut+(rt+(Re[et]-rt)*Ce-ut)*b}}break}case ln.first:case ln.replace:for(let Ge=0;Ge<ne;Ge++){let ke=Pe[Ge];X[Ge]+=(ke+(Re[Ge]-ke)*Ce-X[Ge])*b}break;case ln.add:let Oe=H;if(Oe.bones)for(let Ge=0;Ge<ne;Ge++){let ke=Pe[Ge];X[Ge]+=(ke+(Re[Ge]-ke)*Ce)*b}else{let Ge=Oe.vertices;for(let ke=0;ke<ne;ke++){let et=Pe[ke];X[ke]+=(et+(Re[ke]-et)*Ce-Ge[ke])*b}}}}}class Xd extends Ta{constructor(r){super(r,Xd.propertyIds),this.events=new Array(r)}getFrameCount(){return this.frames.length}setFrame(r,h){this.frames[r]=h.time,this.events[r]=h}apply(r,h,d,y,b,R,k){if(!y)return;let M=this.frames,H=this.frames.length;if(h>d)this.apply(r,h,Number.MAX_VALUE,y,b,R,k),h=-1;else if(h>=M[H-1])return;if(d<M[0])return;let X=0;if(h<M[0])X=0;else{X=Ta.search1(M,h)+1;let oe=M[X];for(;X>0&&M[X-1]==oe;)X--}for(;X<H&&d>=M[X];X++)y.push(this.events[X])}}Xd.propertyIds=["12"];class Pp extends Ta{constructor(r){super(r,Pp.propertyIds),this.drawOrders=new Array(r)}getFrameCount(){return this.frames.length}setFrame(r,h,d){this.frames[r]=h,this.drawOrders[r]=d}apply(r,h,d,y,b,R,k){if(k==cl.mixOut)return void(R==ln.setup&&gr.arrayCopy(r.slots,0,r.drawOrder,0,r.slots.length));if(d<this.frames[0])return void(R!=ln.setup&&R!=ln.first||gr.arrayCopy(r.slots,0,r.drawOrder,0,r.slots.length));let M=this.drawOrders[Ta.search1(this.frames,d)];if(M){let H=r.drawOrder,X=r.slots;for(let oe=0,ne=M.length;oe<ne;oe++)H[oe]=X[M[oe]]}else gr.arrayCopy(r.slots,0,r.drawOrder,0,r.slots.length)}}Pp.propertyIds=["13"];class Pm extends ih{constructor(r,h,d){super(r,h,["14|"+d]),this.ikConstraintIndex=d}getFrameEntries(){return 6}setFrame(r,h,d,y,b,R,k){this.frames[r*=6]=h,this.frames[r+1]=d,this.frames[r+2]=y,this.frames[r+3]=b,this.frames[r+4]=R?1:0,this.frames[r+5]=k?1:0}apply(r,h,d,y,b,R,k){let M=r.ikConstraints[this.ikConstraintIndex];if(!M.active)return;let H=this.frames;if(d<H[0]){switch(R){case ln.setup:return M.mix=M.data.mix,M.softness=M.data.softness,M.bendDirection=M.data.bendDirection,M.compress=M.data.compress,void(M.stretch=M.data.stretch);case ln.first:M.mix+=(M.data.mix-M.mix)*b,M.softness+=(M.data.softness-M.softness)*b,M.bendDirection=M.data.bendDirection,M.compress=M.data.compress,M.stretch=M.data.stretch}return}let X=0,oe=0,ne=Ta.search(H,d,6),ge=this.curves[ne/6];switch(ge){case 0:let we=H[ne];X=H[ne+1],oe=H[ne+2];let Se=(d-we)/(H[ne+6]-we);X+=(H[ne+6+1]-X)*Se,oe+=(H[ne+6+2]-oe)*Se;break;case 1:X=H[ne+1],oe=H[ne+2];break;default:X=this.getBezierValue(d,ne,1,ge-2),oe=this.getBezierValue(d,ne,2,ge+18-2)}R==ln.setup?(M.mix=M.data.mix+(X-M.data.mix)*b,M.softness=M.data.softness+(oe-M.data.softness)*b,k==cl.mixOut?(M.bendDirection=M.data.bendDirection,M.compress=M.data.compress,M.stretch=M.data.stretch):(M.bendDirection=H[ne+3],M.compress=0!=H[ne+4],M.stretch=0!=H[ne+5])):(M.mix+=(X-M.mix)*b,M.softness+=(oe-M.softness)*b,k==cl.mixIn&&(M.bendDirection=H[ne+3],M.compress=0!=H[ne+4],M.stretch=0!=H[ne+5]))}}class rm extends ih{constructor(r,h,d){super(r,h,["15|"+d]),this.transformConstraintIndex=d}getFrameEntries(){return 7}setFrame(r,h,d,y,b,R,k,M){let H=this.frames;H[r*=7]=h,H[r+1]=d,H[r+2]=y,H[r+3]=b,H[r+4]=R,H[r+5]=k,H[r+6]=M}apply(r,h,d,y,b,R,k){let M=r.transformConstraints[this.transformConstraintIndex];if(!M.active)return;let H,X,oe,ne,ge,we,Se=this.frames;if(d<Se[0]){let Re=M.data;switch(R){case ln.setup:return M.mixRotate=Re.mixRotate,M.mixX=Re.mixX,M.mixY=Re.mixY,M.mixScaleX=Re.mixScaleX,M.mixScaleY=Re.mixScaleY,void(M.mixShearY=Re.mixShearY);case ln.first:M.mixRotate+=(Re.mixRotate-M.mixRotate)*b,M.mixX+=(Re.mixX-M.mixX)*b,M.mixY+=(Re.mixY-M.mixY)*b,M.mixScaleX+=(Re.mixScaleX-M.mixScaleX)*b,M.mixScaleY+=(Re.mixScaleY-M.mixScaleY)*b,M.mixShearY+=(Re.mixShearY-M.mixShearY)*b}return}let Ce=Ta.search(Se,d,7),Pe=this.curves[Ce/7];switch(Pe){case 0:let Re=Se[Ce];H=Se[Ce+1],X=Se[Ce+2],oe=Se[Ce+3],ne=Se[Ce+4],ge=Se[Ce+5],we=Se[Ce+6];let Oe=(d-Re)/(Se[Ce+7]-Re);H+=(Se[Ce+7+1]-H)*Oe,X+=(Se[Ce+7+2]-X)*Oe,oe+=(Se[Ce+7+3]-oe)*Oe,ne+=(Se[Ce+7+4]-ne)*Oe,ge+=(Se[Ce+7+5]-ge)*Oe,we+=(Se[Ce+7+6]-we)*Oe;break;case 1:H=Se[Ce+1],X=Se[Ce+2],oe=Se[Ce+3],ne=Se[Ce+4],ge=Se[Ce+5],we=Se[Ce+6];break;default:H=this.getBezierValue(d,Ce,1,Pe-2),X=this.getBezierValue(d,Ce,2,Pe+18-2),oe=this.getBezierValue(d,Ce,3,Pe+36-2),ne=this.getBezierValue(d,Ce,4,Pe+54-2),ge=this.getBezierValue(d,Ce,5,Pe+72-2),we=this.getBezierValue(d,Ce,6,Pe+90-2)}if(R==ln.setup){let Re=M.data;M.mixRotate=Re.mixRotate+(H-Re.mixRotate)*b,M.mixX=Re.mixX+(X-Re.mixX)*b,M.mixY=Re.mixY+(oe-Re.mixY)*b,M.mixScaleX=Re.mixScaleX+(ne-Re.mixScaleX)*b,M.mixScaleY=Re.mixScaleY+(ge-Re.mixScaleY)*b,M.mixShearY=Re.mixShearY+(we-Re.mixShearY)*b}else M.mixRotate+=(H-M.mixRotate)*b,M.mixX+=(X-M.mixX)*b,M.mixY+=(oe-M.mixY)*b,M.mixScaleX+=(ne-M.mixScaleX)*b,M.mixScaleY+=(ge-M.mixScaleY)*b,M.mixShearY+=(we-M.mixShearY)*b}}class im extends oh{constructor(r,h,d){super(r,h,"16|"+d),this.pathConstraintIndex=d}apply(r,h,d,y,b,R,k){let M=r.pathConstraints[this.pathConstraintIndex];if(!M.active)return;if(d<this.frames[0]){switch(R){case ln.setup:return void(M.position=M.data.position);case ln.first:M.position+=(M.data.position-M.position)*b}return}let H=this.getCurveValue(d);R==ln.setup?M.position=M.data.position+(H-M.data.position)*b:M.position+=(H-M.position)*b}}class Im extends oh{constructor(r,h,d){super(r,h,"17|"+d),this.pathConstraintIndex=0,this.pathConstraintIndex=d}apply(r,h,d,y,b,R,k){let M=r.pathConstraints[this.pathConstraintIndex];if(!M.active)return;if(d<this.frames[0]){switch(R){case ln.setup:return void(M.spacing=M.data.spacing);case ln.first:M.spacing+=(M.data.spacing-M.spacing)*b}return}let H=this.getCurveValue(d);R==ln.setup?M.spacing=M.data.spacing+(H-M.data.spacing)*b:M.spacing+=(H-M.spacing)*b}}class Om extends ih{constructor(r,h,d){super(r,h,["18|"+d]),this.pathConstraintIndex=0,this.pathConstraintIndex=d}getFrameEntries(){return 4}setFrame(r,h,d,y,b){let R=this.frames;R[r<<=2]=h,R[r+1]=d,R[r+2]=y,R[r+3]=b}apply(r,h,d,y,b,R,k){let M=r.pathConstraints[this.pathConstraintIndex];if(!M.active)return;let H,X,oe,ne=this.frames;if(d<ne[0]){switch(R){case ln.setup:return M.mixRotate=M.data.mixRotate,M.mixX=M.data.mixX,void(M.mixY=M.data.mixY);case ln.first:M.mixRotate+=(M.data.mixRotate-M.mixRotate)*b,M.mixX+=(M.data.mixX-M.mixX)*b,M.mixY+=(M.data.mixY-M.mixY)*b}return}let ge=Ta.search(ne,d,4),we=this.curves[ge>>2];switch(we){case 0:let Se=ne[ge];H=ne[ge+1],X=ne[ge+2],oe=ne[ge+3];let Ce=(d-Se)/(ne[ge+4]-Se);H+=(ne[ge+4+1]-H)*Ce,X+=(ne[ge+4+2]-X)*Ce,oe+=(ne[ge+4+3]-oe)*Ce;break;case 1:H=ne[ge+1],X=ne[ge+2],oe=ne[ge+3];break;default:H=this.getBezierValue(d,ge,1,we-2),X=this.getBezierValue(d,ge,2,we+18-2),oe=this.getBezierValue(d,ge,3,we+36-2)}if(R==ln.setup){let Se=M.data;M.mixRotate=Se.mixRotate+(H-Se.mixRotate)*b,M.mixX=Se.mixX+(X-Se.mixX)*b,M.mixY=Se.mixY+(oe-Se.mixY)*b}else M.mixRotate+=(H-M.mixRotate)*b,M.mixX+=(X-M.mixX)*b,M.mixY+=(oe-M.mixY)*b}}class uf{constructor(r){this.tracks=new Array,this.timeScale=1,this.unkeyedState=0,this.events=new Array,this.listeners=new Array,this.queue=new Fm(this),this.propertyIDs=new Mf,this.animationsChanged=!1,this.trackEntryPool=new Np(()=>new km),this.data=r}static emptyAnimation(){return sh||(sh=new Zf("<empty>",[],0)),sh}update(r){r*=this.timeScale;let h=this.tracks;for(let d=0,y=h.length;d<y;d++){let b=h[d];if(!b)continue;b.animationLast=b.nextAnimationLast,b.trackLast=b.nextTrackLast;let R=r*b.timeScale;if(b.delay>0){if(b.delay-=R,b.delay>0)continue;R=-b.delay,b.delay=0}let k=b.next;if(k){let M=b.trackLast-k.delay;if(M>=0){for(k.delay=0,k.trackTime+=0==b.timeScale?0:(M/b.timeScale+r)*k.timeScale,b.trackTime+=R,this.setCurrent(d,k,!0);k.mixingFrom;)k.mixTime+=r,k=k.mixingFrom;continue}}else if(b.trackLast>=b.trackEnd&&!b.mixingFrom){h[d]=null,this.queue.end(b),this.clearNext(b);continue}if(b.mixingFrom&&this.updateMixingFrom(b,r)){let M=b.mixingFrom;for(b.mixingFrom=null,M&&(M.mixingTo=null);M;)this.queue.end(M),M=M.mixingFrom}b.trackTime+=R}this.queue.drain()}updateMixingFrom(r,h){let d=r.mixingFrom;if(!d)return!0;let y=this.updateMixingFrom(d,h);return d.animationLast=d.nextAnimationLast,d.trackLast=d.nextTrackLast,r.mixTime>0&&r.mixTime>=r.mixDuration?(0!=d.totalAlpha&&0!=r.mixDuration||(r.mixingFrom=d.mixingFrom,d.mixingFrom&&(d.mixingFrom.mixingTo=r),r.interruptAlpha=d.interruptAlpha,this.queue.end(d)),y):(d.trackTime+=h*d.timeScale,r.mixTime+=h,!1)}apply(r){if(!r)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();let h=this.events,d=this.tracks,y=!1;for(let ne=0,ge=d.length;ne<ge;ne++){let we=d[ne];if(!we||we.delay>0)continue;y=!0;let Se=0==ne?ln.first:we.mixBlend,Ce=we.alpha;we.mixingFrom?Ce*=this.applyMixingFrom(we,r,Se):we.trackTime>=we.trackEnd&&!we.next&&(Ce=0);let Pe=we.animationLast,Re=we.getAnimationTime(),Oe=Re,Ge=h;we.reverse&&(Oe=we.animation.duration-Oe,Ge=null);let ke=we.animation.timelines,et=ke.length;if(0==ne&&1==Ce||Se==ln.add)for(let rt=0;rt<et;rt++){gr.webkit602BugfixHelper(Ce,Se);var b=ke[rt];b instanceof qd?this.applyAttachmentTimeline(b,r,Oe,Se,!0):b.apply(r,Pe,Oe,Ge,Ce,Se,cl.mixIn)}else{let rt=we.timelineMode,ut=we.timelinesRotation.length!=et<<1;ut&&(we.timelinesRotation.length=et<<1);for(let vt=0;vt<et;vt++){let Lt=ke[vt],Kt=rt[vt]==$f?Se:ln.setup;Lt instanceof cf?this.applyRotateTimeline(Lt,r,Oe,Ce,Kt,we.timelinesRotation,vt<<1,ut):Lt instanceof qd?this.applyAttachmentTimeline(Lt,r,Oe,Se,!0):(gr.webkit602BugfixHelper(Ce,Se),Lt.apply(r,Pe,Oe,Ge,Ce,Kt,cl.mixIn))}}this.queueEvents(we,Re),h.length=0,we.nextAnimationLast=Re,we.nextTrackLast=we.trackTime}for(var R=this.unkeyedState+hf,k=r.slots,M=0,H=r.slots.length;M<H;M++){var X=k[M];if(X.attachmentState==R){var oe=X.data.attachmentName;X.setAttachment(oe?r.getAttachment(X.data.index,oe):null)}}return this.unkeyedState+=2,this.queue.drain(),y}applyMixingFrom(r,h,d){let y=r.mixingFrom;y.mixingFrom&&this.applyMixingFrom(y,h,d);let b=0;0==r.mixDuration?(b=1,d==ln.first&&(d=ln.setup)):(b=r.mixTime/r.mixDuration,b>1&&(b=1),d!=ln.first&&(d=y.mixBlend));let R=b<y.attachmentThreshold,k=b<y.drawOrderThreshold,M=y.animation.timelines,H=M.length,X=y.alpha*r.interruptAlpha,oe=X*(1-b),ne=y.animationLast,ge=y.getAnimationTime(),we=ge,Se=null;if(y.reverse?we=y.animation.duration-we:b<y.eventThreshold&&(Se=this.events),d==ln.add)for(let Ce=0;Ce<H;Ce++)M[Ce].apply(h,ne,we,Se,oe,d,cl.mixOut);else{let Ce=y.timelineMode,Pe=y.timelineHoldMix,Re=y.timelinesRotation.length!=H<<1;Re&&(y.timelinesRotation.length=H<<1),y.totalAlpha=0;for(let Oe=0;Oe<H;Oe++){let Ge,ke=M[Oe],et=cl.mixOut,rt=0;switch(Ce[Oe]){case $f:if(!k&&ke instanceof Pp)continue;Ge=d,rt=oe;break;case om:Ge=ln.setup,rt=oe;break;case sm:Ge=d,rt=X;break;case Cf:Ge=ln.setup,rt=X;break;default:Ge=ln.setup;let ut=Pe[Oe];rt=X*Math.max(0,1-ut.mixTime/ut.mixDuration)}y.totalAlpha+=rt,ke instanceof cf?this.applyRotateTimeline(ke,h,we,rt,Ge,y.timelinesRotation,Oe<<1,Re):ke instanceof qd?this.applyAttachmentTimeline(ke,h,we,Ge,R):(gr.webkit602BugfixHelper(rt,d),k&&ke instanceof Pp&&Ge==ln.setup&&(et=cl.mixIn),ke.apply(h,ne,we,Se,rt,Ge,et))}}return r.mixDuration>0&&this.queueEvents(y,ge),this.events.length=0,y.nextAnimationLast=ge,y.nextTrackLast=y.trackTime,b}applyAttachmentTimeline(r,h,d,y,b){var R=h.slots[r.slotIndex];R.bone.active&&(d<r.frames[0]?y!=ln.setup&&y!=ln.first||this.setAttachment(h,R,R.data.attachmentName,b):this.setAttachment(h,R,r.attachmentNames[Ta.search1(r.frames,d)],b),R.attachmentState<=this.unkeyedState&&(R.attachmentState=this.unkeyedState+hf))}setAttachment(r,h,d,y){h.setAttachment(d?r.getAttachment(h.data.index,d):null),y&&(h.attachmentState=this.unkeyedState+Lf)}applyRotateTimeline(r,h,d,y,b,R,k,M){if(M&&(R[k]=0),1==y)return void r.apply(h,0,d,null,1,b,cl.mixIn);let H=h.bones[r.boneIndex];if(!H.active)return;let X=0,oe=0;if(d<r.frames[0])switch(b){case ln.setup:H.rotation=H.data.rotation;default:return;case ln.first:X=H.rotation,oe=H.data.rotation}else X=b==ln.setup?H.data.rotation:H.rotation,oe=H.data.rotation+r.getCurveValue(d);let ne=0,ge=oe-X;if(ge-=360*(16384-(16384.499999999996-ge/360|0)),0==ge)ne=R[k];else{let we=0,Se=0;M?(we=0,Se=ge):(we=R[k],Se=R[k+1]);let Ce=ge>0,Pe=we>=0;Ln.signum(Se)!=Ln.signum(ge)&&Math.abs(Se)<=90&&(Math.abs(we)>180&&(we+=360*Ln.signum(we)),Pe=Ce),ne=ge+we-we%360,Pe!=Ce&&(ne+=360*Ln.signum(we)),R[k]=ne}R[k+1]=ge,H.rotation=X+ne*y}queueEvents(r,h){let d=r.animationStart,y=r.animationEnd,b=y-d,R=r.trackLast%b,k=this.events,M=0,H=k.length;for(;M<H;M++){let oe=k[M];if(oe.time<R)break;oe.time>y||this.queue.event(r,oe)}let X=!1;for(X=r.loop?0==b||R>r.trackTime%b:h>=y&&r.animationLast<y,X&&this.queue.complete(r);M<H;M++){let oe=k[M];oe.time<d||this.queue.event(r,oe)}}clearTracks(){let r=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let h=0,d=this.tracks.length;h<d;h++)this.clearTrack(h);this.tracks.length=0,this.queue.drainDisabled=r,this.queue.drain()}clearTrack(r){if(r>=this.tracks.length)return;let h=this.tracks[r];if(!h)return;this.queue.end(h),this.clearNext(h);let d=h;for(;;){let y=d.mixingFrom;if(!y)break;this.queue.end(y),d.mixingFrom=null,d.mixingTo=null,d=y}this.tracks[h.trackIndex]=null,this.queue.drain()}setCurrent(r,h,d){let y=this.expandToIndex(r);this.tracks[r]=h,h.previous=null,y&&(d&&this.queue.interrupt(y),h.mixingFrom=y,y.mixingTo=h,h.mixTime=0,y.mixingFrom&&y.mixDuration>0&&(h.interruptAlpha*=Math.min(1,y.mixTime/y.mixDuration)),y.timelinesRotation.length=0),this.queue.start(h)}setAnimation(r,h,d=!1){let y=this.data.skeletonData.findAnimation(h);if(!y)throw new Error("Animation not found: "+h);return this.setAnimationWith(r,y,d)}setAnimationWith(r,h,d=!1){if(!h)throw new Error("animation cannot be null.");let y=!0,b=this.expandToIndex(r);b&&(-1==b.nextTrackLast?(this.tracks[r]=b.mixingFrom,this.queue.interrupt(b),this.queue.end(b),this.clearNext(b),b=b.mixingFrom,y=!1):this.clearNext(b));let R=this.trackEntry(r,h,d,b);return this.setCurrent(r,R,y),this.queue.drain(),R}addAnimation(r,h,d=!1,y=0){let b=this.data.skeletonData.findAnimation(h);if(!b)throw new Error("Animation not found: "+h);return this.addAnimationWith(r,b,d,y)}addAnimationWith(r,h,d=!1,y=0){if(!h)throw new Error("animation cannot be null.");let b=this.expandToIndex(r);if(b)for(;b.next;)b=b.next;let R=this.trackEntry(r,h,d,b);return b?(b.next=R,R.previous=b,y<=0&&(y+=b.getTrackComplete()-R.mixDuration)):(this.setCurrent(r,R,!0),this.queue.drain()),R.delay=y,R}setEmptyAnimation(r,h=0){let d=this.setAnimationWith(r,uf.emptyAnimation(),!1);return d.mixDuration=h,d.trackEnd=h,d}addEmptyAnimation(r,h=0,d=0){let y=this.addAnimationWith(r,uf.emptyAnimation(),!1,d);return d<=0&&(y.delay+=y.mixDuration-h),y.mixDuration=h,y.trackEnd=h,y}setEmptyAnimations(r=0){let h=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(let d=0,y=this.tracks.length;d<y;d++){let b=this.tracks[d];b&&this.setEmptyAnimation(b.trackIndex,r)}this.queue.drainDisabled=h,this.queue.drain()}expandToIndex(r){return r<this.tracks.length?this.tracks[r]:(gr.ensureArrayCapacity(this.tracks,r+1,null),this.tracks.length=r+1,null)}trackEntry(r,h,d,y){let b=this.trackEntryPool.obtain();return b.trackIndex=r,b.animation=h,b.loop=d,b.holdPrevious=!1,b.eventThreshold=0,b.attachmentThreshold=0,b.drawOrderThreshold=0,b.animationStart=0,b.animationEnd=h.duration,b.animationLast=-1,b.nextAnimationLast=-1,b.delay=0,b.trackTime=0,b.trackLast=-1,b.nextTrackLast=-1,b.trackEnd=Number.MAX_VALUE,b.timeScale=1,b.alpha=1,b.interruptAlpha=1,b.mixTime=0,b.mixDuration=y?this.data.getMix(y.animation,h):0,b.mixBlend=ln.replace,b}clearNext(r){let h=r.next;for(;h;)this.queue.dispose(h),h=h.next;r.next=null}_animationsChanged(){this.animationsChanged=!1,this.propertyIDs.clear();let r=this.tracks;for(let h=0,d=r.length;h<d;h++){let y=r[h];if(y){for(;y.mixingFrom;)y=y.mixingFrom;do{y.mixingTo&&y.mixBlend==ln.add||this.computeHold(y),y=y.mixingTo}while(y)}}}computeHold(r){let h=r.mixingTo,d=r.animation.timelines,y=r.animation.timelines.length,b=r.timelineMode;b.length=y;let R=r.timelineHoldMix;R.length=0;let k=this.propertyIDs;if(h&&h.holdPrevious)for(let M=0;M<y;M++)b[M]=k.addAll(d[M].getPropertyIds())?Cf:sm;else e:for(let M=0;M<y;M++){let H=d[M],X=H.getPropertyIds();if(k.addAll(X))if(!h||H instanceof qd||H instanceof Pp||H instanceof Xd||!h.animation.hasTimeline(X))b[M]=om;else{for(let oe=h.mixingTo;oe;oe=oe.mixingTo)if(!oe.animation.hasTimeline(X)){if(r.mixDuration>0){b[M]=am,R[M]=oe;continue e}break}b[M]=Cf}else b[M]=$f}}getCurrent(r){return r>=this.tracks.length?null:this.tracks[r]}addListener(r){if(!r)throw new Error("listener cannot be null.");this.listeners.push(r)}removeListener(r){let h=this.listeners.indexOf(r);h>=0&&this.listeners.splice(h,1)}clearListeners(){this.listeners.length=0}clearListenerNotifications(){this.queue.clear()}}class km{constructor(){this.mixBlend=ln.replace,this.timelineMode=new Array,this.timelineHoldMix=new Array,this.timelinesRotation=new Array}reset(){this.next=null,this.previous=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0}getAnimationTime(){if(this.loop){let r=this.animationEnd-this.animationStart;return 0==r?this.animationStart:this.trackTime%r+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)}setAnimationLast(r){this.animationLast=r,this.nextAnimationLast=r}isComplete(){return this.trackTime>=this.animationEnd-this.animationStart}resetRotationDirections(){this.timelinesRotation.length=0}getTrackComplete(){let r=this.animationEnd-this.animationStart;if(0!=r){if(this.loop)return r*(1+(this.trackTime/r|0));if(this.trackTime<r)return r}return this.trackTime}}class Fm{constructor(r){this.objects=[],this.drainDisabled=!1,this.animState=r}start(r){this.objects.push(Yl.start),this.objects.push(r),this.animState.animationsChanged=!0}interrupt(r){this.objects.push(Yl.interrupt),this.objects.push(r)}end(r){this.objects.push(Yl.end),this.objects.push(r),this.animState.animationsChanged=!0}dispose(r){this.objects.push(Yl.dispose),this.objects.push(r)}complete(r){this.objects.push(Yl.complete),this.objects.push(r)}event(r,h){this.objects.push(Yl.event),this.objects.push(r),this.objects.push(h)}drain(){if(this.drainDisabled)return;this.drainDisabled=!0;let r=this.objects,h=this.animState.listeners;for(let d=0;d<r.length;d+=2){let b=r[d+1];switch(r[d]){case Yl.start:b.listener&&b.listener.start&&b.listener.start(b);for(let k=0;k<h.length;k++)h[k].start&&h[k].start(b);break;case Yl.interrupt:b.listener&&b.listener.interrupt&&b.listener.interrupt(b);for(let k=0;k<h.length;k++)h[k].interrupt&&h[k].interrupt(b);break;case Yl.end:b.listener&&b.listener.end&&b.listener.end(b);for(let k=0;k<h.length;k++)h[k].end&&h[k].end(b);case Yl.dispose:b.listener&&b.listener.dispose&&b.listener.dispose(b);for(let k=0;k<h.length;k++)h[k].dispose&&h[k].dispose(b);this.animState.trackEntryPool.free(b);break;case Yl.complete:b.listener&&b.listener.complete&&b.listener.complete(b);for(let k=0;k<h.length;k++)h[k].complete&&h[k].complete(b);break;case Yl.event:let R=r[2+d++];b.listener&&b.listener.event&&b.listener.event(b,R);for(let k=0;k<h.length;k++)h[k].event&&h[k].event(b,R)}}this.clear(),this.drainDisabled=!1}clear(){this.objects.length=0}}!function(a){a[a.start=0]="start",a[a.interrupt=1]="interrupt",a[a.end=2]="end",a[a.dispose=3]="dispose",a[a.complete=4]="complete",a[a.event=5]="event"}(Yl||(Yl={}));const $f=0,om=1,sm=2,Cf=3,am=4,hf=1,Lf=2;let sh=null;class Ip{constructor(r){if(this.animationToMixTime={},this.defaultMix=0,!r)throw new Error("skeletonData cannot be null.");this.skeletonData=r}setMix(r,h,d){let y=this.skeletonData.findAnimation(r);if(!y)throw new Error("Animation not found: "+r);let b=this.skeletonData.findAnimation(h);if(!b)throw new Error("Animation not found: "+h);this.setMixWith(y,b,d)}setMixWith(r,h,d){if(!r)throw new Error("from cannot be null.");if(!h)throw new Error("to cannot be null.");this.animationToMixTime[r.name+"."+h.name]=d}getMix(r,h){let y=this.animationToMixTime[r.name+"."+h.name];return void 0===y?this.defaultMix:y}}class Ah extends Au{constructor(r){super(r),this.color=new xi(1,1,1,1)}copy(){let r=new Ah(this.name);return this.copyTo(r),r.color.setFromColor(this.color),r}}class Yd extends Au{constructor(r){super(r),this.color=new xi(.2275,.2275,.8078,1)}copy(){let r=new Yd(this.name);return this.copyTo(r),r.endSlot=this.endSlot,r.color.setFromColor(this.color),r}}class lm{constructor(r){this._image=r}getImage(){return this._image}}var Yc,$h,la,Ch,Ys,Ec,Jd,Bf,$u,Op,Sd;(function(a){a[a.Nearest=9728]="Nearest",a[a.Linear=9729]="Linear",a[a.MipMap=9987]="MipMap",a[a.MipMapNearestNearest=9984]="MipMapNearestNearest",a[a.MipMapLinearNearest=9985]="MipMapLinearNearest",a[a.MipMapNearestLinear=9986]="MipMapNearestLinear",a[a.MipMapLinearLinear=9987]="MipMapLinearLinear"})(Yc||(Yc={})),function(a){a[a.MirroredRepeat=33648]="MirroredRepeat",a[a.ClampToEdge=33071]="ClampToEdge",a[a.Repeat=10497]="Repeat"}($h||($h={}));class pf{constructor(){this.u=0,this.v=0,this.u2=0,this.v2=0,this.width=0,this.height=0,this.degrees=0,this.offsetX=0,this.offsetY=0,this.originalWidth=0,this.originalHeight=0}}class Jc{constructor(r){this.pages=new Array,this.regions=new Array;let h=new kp(r),d=new Array(4),y=null,b=null,R={size:()=>{y.width=parseInt(d[1]),y.height=parseInt(d[2])},format:()=>{},filter:()=>{y.minFilter=gr.enumValue(Yc,d[1]),y.magFilter=gr.enumValue(Yc,d[2])},repeat:()=>{-1!=d[1].indexOf("x")&&(y.uWrap=$h.Repeat),-1!=d[1].indexOf("y")&&(y.vWrap=$h.Repeat)},pma:()=>{y.pma="true"==d[1]}};var k={xy:()=>{b.x=parseInt(d[1]),b.y=parseInt(d[2])},size:()=>{b.width=parseInt(d[1]),b.height=parseInt(d[2])},bounds:()=>{b.x=parseInt(d[1]),b.y=parseInt(d[2]),b.width=parseInt(d[3]),b.height=parseInt(d[4])},offset:()=>{b.offsetX=parseInt(d[1]),b.offsetY=parseInt(d[2])},orig:()=>{b.originalWidth=parseInt(d[1]),b.originalHeight=parseInt(d[2])},offsets:()=>{b.offsetX=parseInt(d[1]),b.offsetY=parseInt(d[2]),b.originalWidth=parseInt(d[3]),b.originalHeight=parseInt(d[4])},rotate:()=>{let oe=d[1];"true"==oe?b.degrees=90:"false"!=oe&&(b.degrees=parseInt(oe))},index:()=>{b.index=parseInt(d[1])}};let M=h.readLine();for(;M&&0==M.trim().length;)M=h.readLine();for(;M&&0!=M.trim().length&&0!=h.readEntry(d,M);)M=h.readLine();let H=null,X=null;for(;null!==M;)if(0==M.trim().length)y=null,M=h.readLine();else if(y){for(b=new Lh,b.page=y,b.name=M;;){let oe=h.readEntry(d,M=h.readLine());if(0==oe)break;let ne=k[d[0]];if(ne)ne();else{H||(H=[],X=[]),H.push(d[0]);let ge=[];for(let we=0;we<oe;we++)ge.push(parseInt(d[we+1]));X.push(ge)}}0==b.originalWidth&&0==b.originalHeight&&(b.originalWidth=b.width,b.originalHeight=b.height),H&&H.length>0&&(b.names=H,b.values=X,H=null,X=null),b.u=b.x/y.width,b.v=b.y/y.height,90==b.degrees?(b.u2=(b.x+b.height)/y.width,b.v2=(b.y+b.width)/y.height):(b.u2=(b.x+b.width)/y.width,b.v2=(b.y+b.height)/y.height),this.regions.push(b)}else{for(y=new Fp,y.name=M.trim();0!=h.readEntry(d,M=h.readLine());){let oe=R[d[0]];oe&&oe()}this.pages.push(y)}}findRegion(r){for(let h=0;h<this.regions.length;h++)if(this.regions[h].name==r)return this.regions[h];return null}setTextures(r,h=""){for(let d of this.pages)d.setTexture(r.get(h+d.name))}dispose(){for(let r=0;r<this.pages.length;r++)this.pages[r].texture.dispose()}}class kp{constructor(r){this.index=0,this.lines=r.split(/\r\n|\r|\n/)}readLine(){return this.index>=this.lines.length?null:this.lines[this.index++]}readEntry(r,h){if(!h||0==(h=h.trim()).length)return 0;let d=h.indexOf(":");if(-1==d)return 0;r[0]=h.substr(0,d).trim();for(let y=1,b=d+1;;y++){let R=h.indexOf(",",b);if(-1==R)return r[y]=h.substr(b).trim(),y;if(r[y]=h.substr(b,R-b).trim(),b=R+1,4==y)return 4}}}class Fp{constructor(){this.minFilter=Yc.Nearest,this.magFilter=Yc.Nearest,this.uWrap=$h.ClampToEdge,this.vWrap=$h.ClampToEdge}setTexture(r){this.texture=r,r.setFilters(this.minFilter,this.magFilter),r.setWraps(this.uWrap,this.vWrap)}}class Lh extends pf{}class Zc extends Au{constructor(r){super(r),this.color=new xi(1,1,1,1),this.tempColor=new xi(0,0,0,0)}updateUVs(){let r=this.regionUVs;this.uvs&&this.uvs.length==r.length||(this.uvs=gr.newFloatArray(r.length));let h=this.uvs,d=this.uvs.length,y=this.region.u,b=this.region.v,R=0,k=0;if(this.region instanceof Lh){let M=this.region,H=M.page.texture.getImage(),X=H.width,oe=H.height;switch(M.degrees){case 90:y-=(M.originalHeight-M.offsetY-M.height)/X,b-=(M.originalWidth-M.offsetX-M.width)/oe,R=M.originalHeight/X,k=M.originalWidth/oe;for(let ne=0;ne<d;ne+=2)h[ne]=y+r[ne+1]*R,h[ne+1]=b+(1-r[ne])*k;return;case 180:y-=(M.originalWidth-M.offsetX-M.width)/X,b-=M.offsetY/oe,R=M.originalWidth/X,k=M.originalHeight/oe;for(let ne=0;ne<d;ne+=2)h[ne]=y+(1-r[ne])*R,h[ne+1]=b+(1-r[ne+1])*k;return;case 270:y-=M.offsetY/X,b-=M.offsetX/oe,R=M.originalHeight/X,k=M.originalWidth/oe;for(let ne=0;ne<d;ne+=2)h[ne]=y+(1-r[ne+1])*R,h[ne+1]=b+r[ne]*k;return}y-=M.offsetX/X,b-=(M.originalHeight-M.offsetY-M.height)/oe,R=M.originalWidth/X,k=M.originalHeight/oe}else this.region?(R=this.region.u2-y,k=this.region.v2-b):(y=b=0,R=k=1);for(let M=0;M<d;M+=2)h[M]=y+r[M]*R,h[M+1]=b+r[M+1]*k}getParentMesh(){return this.parentMesh}setParentMesh(r){this.parentMesh=r,r&&(this.bones=r.bones,this.vertices=r.vertices,this.worldVerticesLength=r.worldVerticesLength,this.regionUVs=r.regionUVs,this.triangles=r.triangles,this.hullLength=r.hullLength,this.worldVerticesLength=r.worldVerticesLength)}copy(){if(this.parentMesh)return this.newLinkedMesh();let r=new Zc(this.name);return r.region=this.region,r.path=this.path,r.color.setFromColor(this.color),this.copyTo(r),r.regionUVs=new Array(this.regionUVs.length),gr.arrayCopy(this.regionUVs,0,r.regionUVs,0,this.regionUVs.length),r.uvs=new Array(this.uvs.length),gr.arrayCopy(this.uvs,0,r.uvs,0,this.uvs.length),r.triangles=new Array(this.triangles.length),gr.arrayCopy(this.triangles,0,r.triangles,0,this.triangles.length),r.hullLength=this.hullLength,this.edges&&(r.edges=new Array(this.edges.length),gr.arrayCopy(this.edges,0,r.edges,0,this.edges.length)),r.width=this.width,r.height=this.height,r}newLinkedMesh(){let r=new Zc(this.name);return r.region=this.region,r.path=this.path,r.color.setFromColor(this.color),r.deformAttachment=this.deformAttachment,r.setParentMesh(this.parentMesh?this.parentMesh:this),r.updateUVs(),r}}class Bh extends Au{constructor(r){super(r),this.closed=!1,this.constantSpeed=!1,this.color=new xi(1,1,1,1)}copy(){let r=new Bh(this.name);return this.copyTo(r),r.lengths=new Array(this.lengths.length),gr.arrayCopy(this.lengths,0,r.lengths,0,this.lengths.length),r.closed=closed,r.constantSpeed=this.constantSpeed,r.color.setFromColor(this.color),r}}class Dp extends Au{constructor(r){super(r),this.color=new xi(.38,.94,0,1)}computeWorldPosition(r,h){return h.x=this.x*r.a+this.y*r.b+r.worldX,h.y=this.x*r.c+this.y*r.d+r.worldY,h}computeWorldRotation(r){let h=Ln.cosDeg(this.rotation),d=Ln.sinDeg(this.rotation);return Math.atan2(h*r.c+d*r.d,h*r.a+d*r.b)*Ln.radDeg}copy(){let r=new Dp(this.name);return r.x=this.x,r.y=this.y,r.rotation=this.rotation,r.color.setFromColor(this.color),r}}class wi extends hl{constructor(r){super(r),this.x=0,this.y=0,this.scaleX=1,this.scaleY=1,this.rotation=0,this.width=0,this.height=0,this.color=new xi(1,1,1,1),this.offset=gr.newFloatArray(8),this.uvs=gr.newFloatArray(8),this.tempColor=new xi(1,1,1,1)}updateOffset(){let r=this.width/this.region.originalWidth*this.scaleX,h=this.height/this.region.originalHeight*this.scaleY,d=-this.width/2*this.scaleX+this.region.offsetX*r,y=-this.height/2*this.scaleY+this.region.offsetY*h,b=d+this.region.width*r,R=y+this.region.height*h,k=this.rotation*Math.PI/180,M=Math.cos(k),H=Math.sin(k),X=this.x,oe=this.y,ne=d*M+X,ge=d*H,we=y*M+oe,Se=y*H,Ce=b*M+X,Pe=b*H,Re=R*M+oe,Oe=R*H,Ge=this.offset;Ge[0]=ne-Se,Ge[1]=we+ge,Ge[2]=ne-Oe,Ge[3]=Re+ge,Ge[4]=Ce-Oe,Ge[5]=Re+Pe,Ge[6]=Ce-Se,Ge[7]=we+Pe}setRegion(r){this.region=r;let h=this.uvs;90==r.degrees?(h[2]=r.u,h[3]=r.v2,h[4]=r.u,h[5]=r.v,h[6]=r.u2,h[7]=r.v,h[0]=r.u2,h[1]=r.v2):(h[0]=r.u,h[1]=r.v2,h[2]=r.u,h[3]=r.v,h[4]=r.u2,h[5]=r.v,h[6]=r.u2,h[7]=r.v2)}computeWorldVertices(r,h,d,y){let b=this.offset,R=r.worldX,k=r.worldY,M=r.a,H=r.b,X=r.c,oe=r.d,ne=0,ge=0;ne=b[0],ge=b[1],h[d]=ne*M+ge*H+R,h[d+1]=ne*X+ge*oe+k,ne=b[2],ge=b[3],h[d+=y]=ne*M+ge*H+R,h[d+1]=ne*X+ge*oe+k,ne=b[4],ge=b[5],h[d+=y]=ne*M+ge*H+R,h[d+1]=ne*X+ge*oe+k,ne=b[6],ge=b[7],h[d+=y]=ne*M+ge*H+R,h[d+1]=ne*X+ge*oe+k}copy(){let r=new wi(this.name);return r.region=this.region,r.rendererObject=this.rendererObject,r.path=this.path,r.x=this.x,r.y=this.y,r.scaleX=this.scaleX,r.scaleY=this.scaleY,r.rotation=this.rotation,r.width=this.width,r.height=this.height,gr.arrayCopy(this.uvs,0,r.uvs,0,8),gr.arrayCopy(this.offset,0,r.offset,0,8),r.color.setFromColor(this.color),r}}wi.X1=0,wi.Y1=1,wi.C1R=2,wi.C1G=3,wi.C1B=4,wi.C1A=5,wi.U1=6,wi.V1=7,wi.X2=8,wi.Y2=9,wi.C2R=10,wi.C2G=11,wi.C2B=12,wi.C2A=13,wi.U2=14,wi.V2=15,wi.X3=16,wi.Y3=17,wi.C3R=18,wi.C3G=19,wi.C3B=20,wi.C3A=21,wi.U3=22,wi.V3=23,wi.X4=24,wi.Y4=25,wi.C4R=26,wi.C4G=27,wi.C4B=28,wi.C4A=29,wi.U4=30,wi.V4=31;class Ed{constructor(r){this.atlas=r}newRegionAttachment(r,h,d){let y=this.atlas.findRegion(d);if(!y)throw new Error("Region not found in atlas: "+d+" (region attachment: "+h+")");y.renderObject=y;let b=new wi(h);return b.setRegion(y),b}newMeshAttachment(r,h,d){let y=this.atlas.findRegion(d);if(!y)throw new Error("Region not found in atlas: "+d+" (mesh attachment: "+h+")");y.renderObject=y;let b=new Zc(h);return b.region=y,b}newBoundingBoxAttachment(r,h){return new Ah(h)}newPathAttachment(r,h){return new Bh(h)}newPointAttachment(r,h){return new Dp(h)}newClippingAttachment(r,h){return new Yd(h)}}class Td{constructor(r,h,d){if(this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=la.Normal,this.skinRequired=!1,this.color=new xi,r<0)throw new Error("index must be >= 0.");if(!h)throw new Error("name cannot be null.");this.index=r,this.name=h,this.parent=d}}!function(a){a[a.Normal=0]="Normal",a[a.OnlyTranslation=1]="OnlyTranslation",a[a.NoRotationOrReflection=2]="NoRotationOrReflection",a[a.NoScale=3]="NoScale",a[a.NoScaleOrReflection=4]="NoScaleOrReflection"}(la||(la={}));class df{constructor(r,h,d){if(this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.a=0,this.b=0,this.c=0,this.d=0,this.worldY=0,this.worldX=0,this.sorted=!1,this.active=!1,!r)throw new Error("data cannot be null.");if(!h)throw new Error("skeleton cannot be null.");this.data=r,this.skeleton=h,this.parent=d,this.setToSetupPose()}isActive(){return this.active}update(){this.updateWorldTransformWith(this.ax,this.ay,this.arotation,this.ascaleX,this.ascaleY,this.ashearX,this.ashearY)}updateWorldTransform(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}updateWorldTransformWith(r,h,d,y,b,R,k){this.ax=r,this.ay=h,this.arotation=d,this.ascaleX=y,this.ascaleY=b,this.ashearX=R,this.ashearY=k;let M=this.parent;if(!M){let ge=this.skeleton,we=d+90+k,Se=ge.scaleX,Ce=ge.scaleY;return this.a=Ln.cosDeg(d+R)*y*Se,this.b=Ln.cosDeg(we)*b*Se,this.c=Ln.sinDeg(d+R)*y*Ce,this.d=Ln.sinDeg(we)*b*Ce,this.worldX=r*Se+ge.x,void(this.worldY=h*Ce+ge.y)}let H=M.a,X=M.b,oe=M.c,ne=M.d;switch(this.worldX=H*r+X*h+M.worldX,this.worldY=oe*r+ne*h+M.worldY,this.data.transformMode){case la.Normal:{let ge=d+90+k,we=Ln.cosDeg(d+R)*y,Se=Ln.cosDeg(ge)*b,Ce=Ln.sinDeg(d+R)*y,Pe=Ln.sinDeg(ge)*b;return this.a=H*we+X*Ce,this.b=H*Se+X*Pe,this.c=oe*we+ne*Ce,void(this.d=oe*Se+ne*Pe)}case la.OnlyTranslation:{let ge=d+90+k;this.a=Ln.cosDeg(d+R)*y,this.b=Ln.cosDeg(ge)*b,this.c=Ln.sinDeg(d+R)*y,this.d=Ln.sinDeg(ge)*b;break}case la.NoRotationOrReflection:{let ge=H*H+oe*oe,we=0;ge>1e-4?(ge=Math.abs(H*ne-X*oe)/ge,H/=this.skeleton.scaleX,oe/=this.skeleton.scaleY,X=oe*ge,ne=H*ge,we=Math.atan2(oe,H)*Ln.radDeg):(H=0,oe=0,we=90-Math.atan2(ne,X)*Ln.radDeg);let Se=d+R-we,Ce=d+k-we+90,Pe=Ln.cosDeg(Se)*y,Re=Ln.cosDeg(Ce)*b,Oe=Ln.sinDeg(Se)*y,Ge=Ln.sinDeg(Ce)*b;this.a=H*Pe-X*Oe,this.b=H*Re-X*Ge,this.c=oe*Pe+ne*Oe,this.d=oe*Re+ne*Ge;break}case la.NoScale:case la.NoScaleOrReflection:{let ge=Ln.cosDeg(d),we=Ln.sinDeg(d),Se=(H*ge+X*we)/this.skeleton.scaleX,Ce=(oe*ge+ne*we)/this.skeleton.scaleY,Pe=Math.sqrt(Se*Se+Ce*Ce);Pe>1e-5&&(Pe=1/Pe),Se*=Pe,Ce*=Pe,Pe=Math.sqrt(Se*Se+Ce*Ce),this.data.transformMode==la.NoScale&&H*ne-X*oe<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY<0)&&(Pe=-Pe);let Re=Math.PI/2+Math.atan2(Ce,Se),Oe=Math.cos(Re)*Pe,Ge=Math.sin(Re)*Pe,ke=Ln.cosDeg(R)*y,et=Ln.cosDeg(90+k)*b,rt=Ln.sinDeg(R)*y,ut=Ln.sinDeg(90+k)*b;this.a=Se*ke+Oe*rt,this.b=Se*et+Oe*ut,this.c=Ce*ke+Ge*rt,this.d=Ce*et+Ge*ut;break}}this.a*=this.skeleton.scaleX,this.b*=this.skeleton.scaleX,this.c*=this.skeleton.scaleY,this.d*=this.skeleton.scaleY}setToSetupPose(){let r=this.data;this.x=r.x,this.y=r.y,this.rotation=r.rotation,this.scaleX=r.scaleX,this.scaleY=r.scaleY,this.shearX=r.shearX,this.shearY=r.shearY}getWorldRotationX(){return Math.atan2(this.c,this.a)*Ln.radDeg}getWorldRotationY(){return Math.atan2(this.d,this.b)*Ln.radDeg}getWorldScaleX(){return Math.sqrt(this.a*this.a+this.c*this.c)}getWorldScaleY(){return Math.sqrt(this.b*this.b+this.d*this.d)}updateAppliedTransform(){let r=this.parent;if(!r)return this.ax=this.worldX-this.skeleton.x,this.ay=this.worldY-this.skeleton.y,this.arotation=Math.atan2(this.c,this.a)*Ln.radDeg,this.ascaleX=Math.sqrt(this.a*this.a+this.c*this.c),this.ascaleY=Math.sqrt(this.b*this.b+this.d*this.d),this.ashearX=0,void(this.ashearY=Math.atan2(this.a*this.b+this.c*this.d,this.a*this.d-this.b*this.c)*Ln.radDeg);let h=r.a,d=r.b,y=r.c,b=r.d,R=1/(h*b-d*y),k=this.worldX-r.worldX,M=this.worldY-r.worldY;this.ax=k*b*R-M*d*R,this.ay=M*h*R-k*y*R;let H=R*b,X=R*h,oe=R*d,ne=R*y,ge=H*this.a-oe*this.c,we=H*this.b-oe*this.d,Se=X*this.c-ne*this.a,Ce=X*this.d-ne*this.b;if(this.ashearX=0,this.ascaleX=Math.sqrt(ge*ge+Se*Se),this.ascaleX>1e-4){let Pe=ge*Ce-we*Se;this.ascaleY=Pe/this.ascaleX,this.ashearY=Math.atan2(ge*we+Se*Ce,Pe)*Ln.radDeg,this.arotation=Math.atan2(Se,ge)*Ln.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(we*we+Ce*Ce),this.ashearY=0,this.arotation=90-Math.atan2(Ce,we)*Ln.radDeg}worldToLocal(r){let h=1/(this.a*this.d-this.b*this.c),d=r.x-this.worldX,y=r.y-this.worldY;return r.x=d*this.d*h-y*this.b*h,r.y=y*this.a*h-d*this.c*h,r}localToWorld(r){let h=r.x,d=r.y;return r.x=h*this.a+d*this.b+this.worldX,r.y=h*this.c+d*this.d+this.worldY,r}worldToLocalRotation(r){let h=Ln.sinDeg(r),d=Ln.cosDeg(r);return Math.atan2(this.a*h-this.c*d,this.d*d-this.b*h)*Ln.radDeg+this.rotation-this.shearX}localToWorldRotation(r){let h=Ln.sinDeg(r-=this.rotation-this.shearX),d=Ln.cosDeg(r);return Math.atan2(d*this.c+h*this.d,d*this.a+h*this.b)*Ln.radDeg}rotateWorld(r){let h=this.a,d=this.b,y=this.c,b=this.d,R=Ln.cosDeg(r),k=Ln.sinDeg(r);this.a=R*h-k*y,this.b=R*d-k*b,this.c=k*h+R*y,this.d=k*d+R*b}}class ff{constructor(r,h){if(this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,this.softness=0,this.active=!1,!r)throw new Error("data cannot be null.");if(!h)throw new Error("skeleton cannot be null.");this.data=r,this.mix=r.mix,this.softness=r.softness,this.bendDirection=r.bendDirection,this.compress=r.compress,this.stretch=r.stretch,this.bones=new Array;for(let d=0;d<r.bones.length;d++)this.bones.push(h.findBone(r.bones[d].name));this.target=h.findBone(r.target.name)}isActive(){return this.active}update(){if(0==this.mix)return;let r=this.target,h=this.bones;switch(h.length){case 1:this.apply1(h[0],r.worldX,r.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(h[0],h[1],r.worldX,r.worldY,this.bendDirection,this.stretch,this.data.uniform,this.softness,this.mix)}}apply1(r,h,d,y,b,R,k){let M=r.parent,H=M.a,X=M.b,oe=M.c,ne=M.d,ge=-r.ashearX-r.arotation,we=0,Se=0;switch(r.data.transformMode){case la.OnlyTranslation:we=h-r.worldX,Se=d-r.worldY;break;case la.NoRotationOrReflection:let Re=Math.abs(H*ne-X*oe)/(H*H+oe*oe),Oe=H/r.skeleton.scaleX,Ge=oe/r.skeleton.scaleY;X=-Ge*Re*r.skeleton.scaleX,ne=Oe*Re*r.skeleton.scaleY,ge+=Math.atan2(Ge,Oe)*Ln.radDeg;default:let ke=h-M.worldX,et=d-M.worldY,rt=H*ne-X*oe;we=(ke*ne-et*X)/rt-r.ax,Se=(et*H-ke*oe)/rt-r.ay}ge+=Math.atan2(Se,we)*Ln.radDeg,r.ascaleX<0&&(ge+=180),ge>180?ge-=360:ge<-180&&(ge+=360);let Ce=r.ascaleX,Pe=r.ascaleY;if(y||b){switch(r.data.transformMode){case la.NoScale:case la.NoScaleOrReflection:we=h-r.worldX,Se=d-r.worldY}let Re=r.data.length*Ce,Oe=Math.sqrt(we*we+Se*Se);if(y&&Oe<Re||b&&Oe>Re&&Re>1e-4){let Ge=(Oe/Re-1)*k+1;Ce*=Ge,R&&(Pe*=Ge)}}r.updateWorldTransformWith(r.ax,r.ay,r.arotation+ge*k,Ce,Pe,r.ashearX,r.ashearY)}apply2(r,h,d,y,b,R,k,M,H){let X=r.ax,oe=r.ay,ne=r.ascaleX,ge=r.ascaleY,we=ne,Se=ge,Ce=h.ascaleX,Pe=0,Re=0,Oe=0;ne<0?(ne=-ne,Pe=180,Oe=-1):(Pe=0,Oe=1),ge<0&&(ge=-ge,Oe=-Oe),Ce<0?(Ce=-Ce,Re=180):Re=0;let Ge=h.ax,ke=0,et=0,rt=0,ut=r.a,vt=r.b,Lt=r.c,Kt=r.d,zt=Math.abs(ne-ge)<=1e-4;!zt||R?(ke=0,et=ut*Ge+r.worldX,rt=Lt*Ge+r.worldY):(ke=h.ay,et=ut*Ge+vt*ke+r.worldX,rt=Lt*Ge+Kt*ke+r.worldY);let Bt=r.parent;ut=Bt.a,vt=Bt.b,Lt=Bt.c,Kt=Bt.d;let $t,ht,Tt=1/(ut*Kt-vt*Lt),Zt=et-Bt.worldX,un=rt-Bt.worldY,Mn=(Zt*Kt-un*vt)*Tt-X,wr=(un*ut-Zt*Lt)*Tt-oe,Yn=Math.sqrt(Mn*Mn+wr*wr),On=h.data.length*Ce;if(Yn<1e-4)return this.apply1(r,d,y,!1,R,!1,H),void h.updateWorldTransformWith(Ge,ke,0,h.ascaleX,h.ascaleY,h.ashearX,h.ashearY);Zt=d-Bt.worldX,un=y-Bt.worldY;let Kn=(Zt*Kt-un*vt)*Tt-X,dr=(un*ut-Zt*Lt)*Tt-oe,Mr=Kn*Kn+dr*dr;if(0!=M){M*=ne*(Ce+1)*.5;let ao=Math.sqrt(Mr),Do=ao-Yn-On*ne+M;if(Do>0){let Uo=Math.min(1,Do/(2*M))-1;Uo=(Do-M*(1-Uo*Uo))/ao,Kn-=Uo*Kn,dr-=Uo*dr,Mr=Kn*Kn+dr*dr}}e:if(zt){On*=ne;let ao=(Mr-Yn*Yn-On*On)/(2*Yn*On);ao<-1?(ao=-1,ht=Math.PI*b):ao>1?(ao=1,ht=0,R&&(ut=(Math.sqrt(Mr)/(Yn+On)-1)*H+1,we*=ut,k&&(Se*=ut))):ht=Math.acos(ao)*b,ut=Yn+On*ao,vt=On*Math.sin(ht),$t=Math.atan2(dr*ut-Kn*vt,Kn*ut+dr*vt)}else{ut=ne*On,vt=ge*On;let ao=ut*ut,Do=vt*vt,Uo=Math.atan2(dr,Kn);Lt=Do*Yn*Yn+ao*Mr-ao*Do;let hs=-2*Do*Yn,is=Do-ao;if(Kt=hs*hs-4*is*Lt,Kt>=0){let au=Math.sqrt(Kt);hs<0&&(au=-au),au=.5*-(hs+au);let lu=au/is,nc=Lt/au,cu=Math.abs(lu)<Math.abs(nc)?lu:nc;if(cu*cu<=Mr){un=Math.sqrt(Mr-cu*cu)*b,$t=Uo-Math.atan2(un,cu),ht=Math.atan2(un/ge,(cu-Yn)/ne);break e}}let Bo=Ln.PI,qa=Yn-ut,Ou=qa*qa,qp=0,cd=0,Dh=Yn+ut,ud=Dh*Dh,hd=0;Lt=-ut*Yn/(ao-Do),Lt>=-1&&Lt<=1&&(Lt=Math.acos(Lt),Zt=ut*Math.cos(Lt)+Yn,un=vt*Math.sin(Lt),Kt=Zt*Zt+un*un,Kt<Ou&&(Bo=Lt,Ou=Kt,qa=Zt,qp=un),Kt>ud&&(cd=Lt,ud=Kt,Dh=Zt,hd=un)),Mr<=.5*(Ou+ud)?($t=Uo-Math.atan2(qp*b,qa),ht=Bo*b):($t=Uo-Math.atan2(hd*b,Dh),ht=cd*b)}let di=Math.atan2(ke,Ge)*Oe,so=r.arotation;$t=($t-di)*Ln.radDeg+Pe-so,$t>180?$t-=360:$t<-180&&($t+=360),r.updateWorldTransformWith(X,oe,so+$t*H,we,Se,0,0),so=h.arotation,ht=((ht+di)*Ln.radDeg-h.ashearX)*Oe+Re-so,ht>180?ht-=360:ht<-180&&(ht+=360),h.updateWorldTransformWith(Ge,ke,so+ht*H,h.ascaleX,h.ascaleY,h.ashearX,h.ashearY)}}class nd{constructor(r,h,d){this.name=r,this.order=h,this.skinRequired=d}}class mf extends nd{constructor(r){super(r,0,!1),this.bones=new Array,this.mixRotate=0,this.mixX=0,this.mixY=0}}(Op=Ch||(Ch={}))[Op.Fixed=0]="Fixed",Op[Op.Percent=1]="Percent",($u=Ys||(Ys={}))[$u.Length=0]="Length",$u[$u.Fixed=1]="Fixed",$u[$u.Percent=2]="Percent",$u[$u.Proportional=3]="Proportional",function(a){a[a.Tangent=0]="Tangent",a[a.Chain=1]="Chain",a[a.ChainScale=2]="ChainScale"}(Ec||(Ec={}));class Jl{constructor(r,h){if(this.position=0,this.spacing=0,this.mixRotate=0,this.mixX=0,this.mixY=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,this.active=!1,!r)throw new Error("data cannot be null.");if(!h)throw new Error("skeleton cannot be null.");this.data=r,this.bones=new Array;for(let d=0,y=r.bones.length;d<y;d++)this.bones.push(h.findBone(r.bones[d].name));this.target=h.findSlot(r.target.name),this.position=r.position,this.spacing=r.spacing,this.mixRotate=r.mixRotate,this.mixX=r.mixX,this.mixY=r.mixY}isActive(){return this.active}update(){let r=this.target.getAttachment();if(!(r instanceof Bh))return;let h=this.mixRotate,d=this.mixX,y=this.mixY;if(0==h&&0==d&&0==y)return;let b=this.data,R=b.rotateMode==Ec.Tangent,k=b.rotateMode==Ec.ChainScale,M=this.bones,H=M.length,X=R?H:H+1,oe=gr.setArraySize(this.spaces,X),ne=k?this.lengths=gr.setArraySize(this.lengths,H):null,ge=this.spacing;switch(b.spacingMode){case Ys.Percent:if(k)for(let ke=0,et=X-1;ke<et;ke++){let rt=M[ke],ut=rt.data.length;if(ut<Jl.epsilon)ne[ke]=0;else{let vt=ut*rt.a,Lt=ut*rt.c;ne[ke]=Math.sqrt(vt*vt+Lt*Lt)}}gr.arrayFill(oe,1,X,ge);break;case Ys.Proportional:let Oe=0;for(let ke=0,et=X-1;ke<et;){let rt=M[ke],ut=rt.data.length;if(ut<Jl.epsilon)k&&(ne[ke]=0),oe[++ke]=ge;else{let vt=ut*rt.a,Lt=ut*rt.c,Kt=Math.sqrt(vt*vt+Lt*Lt);k&&(ne[ke]=Kt),oe[++ke]=Kt,Oe+=Kt}}if(Oe>0){Oe=X/Oe*ge;for(let ke=1;ke<X;ke++)oe[ke]*=Oe}break;default:let Ge=b.spacingMode==Ys.Length;for(let ke=0,et=X-1;ke<et;){let rt=M[ke],ut=rt.data.length;if(ut<Jl.epsilon)k&&(ne[ke]=0),oe[++ke]=ge;else{let vt=ut*rt.a,Lt=ut*rt.c,Kt=Math.sqrt(vt*vt+Lt*Lt);k&&(ne[ke]=Kt),oe[++ke]=(Ge?ut+ge:ge)*Kt/ut}}}let we=this.computeWorldPositions(r,X,R),Se=we[0],Ce=we[1],Pe=b.offsetRotation,Re=!1;if(0==Pe)Re=b.rotateMode==Ec.Chain;else{Re=!1;let Oe=this.target.bone;Pe*=Oe.a*Oe.d-Oe.b*Oe.c>0?Ln.degRad:-Ln.degRad}for(let Oe=0,Ge=3;Oe<H;Oe++,Ge+=3){let ke=M[Oe];ke.worldX+=(Se-ke.worldX)*d,ke.worldY+=(Ce-ke.worldY)*y;let et=we[Ge],rt=we[Ge+1],ut=et-Se,vt=rt-Ce;if(k){let Lt=ne[Oe];if(0!=Lt){let Kt=(Math.sqrt(ut*ut+vt*vt)/Lt-1)*h+1;ke.a*=Kt,ke.c*=Kt}}if(Se=et,Ce=rt,h>0){let Lt=ke.a,Kt=ke.b,zt=ke.c,Bt=ke.d,$t=0,ht=0,Tt=0;if($t=R?we[Ge-1]:0==oe[Oe+1]?we[Ge+2]:Math.atan2(vt,ut),$t-=Math.atan2(zt,Lt),Re){ht=Math.cos($t),Tt=Math.sin($t);let Zt=ke.data.length;Se+=(Zt*(ht*Lt-Tt*zt)-ut)*h,Ce+=(Zt*(Tt*Lt+ht*zt)-vt)*h}else $t+=Pe;$t>Ln.PI?$t-=Ln.PI2:$t<-Ln.PI&&($t+=Ln.PI2),$t*=h,ht=Math.cos($t),Tt=Math.sin($t),ke.a=ht*Lt-Tt*zt,ke.b=ht*Kt-Tt*Bt,ke.c=Tt*Lt+ht*zt,ke.d=Tt*Kt+ht*Bt}ke.updateAppliedTransform()}}computeWorldPositions(r,h,d){let y=this.target,b=this.position,R=this.spaces,k=gr.setArraySize(this.positions,3*h+2),M=null,H=r.closed,X=r.worldVerticesLength,oe=X/6,ne=Jl.NONE;if(!r.constantSpeed){let un=r.lengths;oe-=H?1:2;let Mn,wr=un[oe];switch(this.data.positionMode==Ch.Percent&&(b*=wr),this.data.spacingMode){case Ys.Percent:Mn=wr;break;case Ys.Proportional:Mn=wr/h;break;default:Mn=1}M=gr.setArraySize(this.world,8);for(let Yn=0,On=0,Kn=0;Yn<h;Yn++,On+=3){let dr=R[Yn]*Mn;b+=dr;let Mr=b;if(H)Mr%=wr,Mr<0&&(Mr+=wr),Kn=0;else{if(Mr<0){ne!=Jl.BEFORE&&(ne=Jl.BEFORE,r.computeWorldVertices(y,2,4,M,0,2)),this.addBeforePosition(Mr,M,0,k,On);continue}if(Mr>wr){ne!=Jl.AFTER&&(ne=Jl.AFTER,r.computeWorldVertices(y,X-6,4,M,0,2)),this.addAfterPosition(Mr-wr,M,0,k,On);continue}}for(;;Kn++){let di=un[Kn];if(!(Mr>di)){if(0==Kn)Mr/=di;else{let so=un[Kn-1];Mr=(Mr-so)/(di-so)}break}}Kn!=ne&&(ne=Kn,H&&Kn==oe?(r.computeWorldVertices(y,X-4,4,M,0,2),r.computeWorldVertices(y,0,4,M,4,2)):r.computeWorldVertices(y,6*Kn+2,8,M,0,2)),this.addCurvePosition(Mr,M[0],M[1],M[2],M[3],M[4],M[5],M[6],M[7],k,On,d||Yn>0&&0==dr)}return k}H?(X+=2,M=gr.setArraySize(this.world,X),r.computeWorldVertices(y,2,X-4,M,0,2),r.computeWorldVertices(y,0,2,M,X-4,2),M[X-2]=M[0],M[X-1]=M[1]):(oe--,X-=4,M=gr.setArraySize(this.world,X),r.computeWorldVertices(y,2,X,M,0,2));let ge,we=gr.setArraySize(this.curves,oe),Se=0,Ce=M[0],Pe=M[1],Re=0,Oe=0,Ge=0,ke=0,et=0,rt=0,ut=0,vt=0,Lt=0,Kt=0,zt=0,Bt=0,$t=0,ht=0;for(let un=0,Mn=2;un<oe;un++,Mn+=6)Re=M[Mn],Oe=M[Mn+1],Ge=M[Mn+2],ke=M[Mn+3],et=M[Mn+4],rt=M[Mn+5],ut=.1875*(Ce-2*Re+Ge),vt=.1875*(Pe-2*Oe+ke),Lt=.09375*(3*(Re-Ge)-Ce+et),Kt=.09375*(3*(Oe-ke)-Pe+rt),zt=2*ut+Lt,Bt=2*vt+Kt,$t=.75*(Re-Ce)+ut+.16666667*Lt,ht=.75*(Oe-Pe)+vt+.16666667*Kt,Se+=Math.sqrt($t*$t+ht*ht),$t+=zt,ht+=Bt,zt+=Lt,Bt+=Kt,Se+=Math.sqrt($t*$t+ht*ht),$t+=zt,ht+=Bt,Se+=Math.sqrt($t*$t+ht*ht),$t+=zt+Lt,ht+=Bt+Kt,Se+=Math.sqrt($t*$t+ht*ht),we[un]=Se,Ce=et,Pe=rt;switch(this.data.positionMode==Ch.Percent&&(b*=Se),this.data.spacingMode){case Ys.Percent:ge=Se;break;case Ys.Proportional:ge=Se/h;break;default:ge=1}let Tt=this.segments,Zt=0;for(let un=0,Mn=0,wr=0,Yn=0;un<h;un++,Mn+=3){let On=R[un]*ge;b+=On;let Kn=b;if(H)Kn%=Se,Kn<0&&(Kn+=Se),wr=0;else{if(Kn<0){this.addBeforePosition(Kn,M,0,k,Mn);continue}if(Kn>Se){this.addAfterPosition(Kn-Se,M,X-4,k,Mn);continue}}for(;;wr++){let dr=we[wr];if(!(Kn>dr)){if(0==wr)Kn/=dr;else{let Mr=we[wr-1];Kn=(Kn-Mr)/(dr-Mr)}break}}if(wr!=ne){ne=wr;let dr=6*wr;for(Ce=M[dr],Pe=M[dr+1],Re=M[dr+2],Oe=M[dr+3],Ge=M[dr+4],ke=M[dr+5],et=M[dr+6],rt=M[dr+7],ut=.03*(Ce-2*Re+Ge),vt=.03*(Pe-2*Oe+ke),Lt=.006*(3*(Re-Ge)-Ce+et),Kt=.006*(3*(Oe-ke)-Pe+rt),zt=2*ut+Lt,Bt=2*vt+Kt,$t=.3*(Re-Ce)+ut+.16666667*Lt,ht=.3*(Oe-Pe)+vt+.16666667*Kt,Zt=Math.sqrt($t*$t+ht*ht),Tt[0]=Zt,dr=1;dr<8;dr++)$t+=zt,ht+=Bt,zt+=Lt,Bt+=Kt,Zt+=Math.sqrt($t*$t+ht*ht),Tt[dr]=Zt;$t+=zt,ht+=Bt,Zt+=Math.sqrt($t*$t+ht*ht),Tt[8]=Zt,$t+=zt+Lt,ht+=Bt+Kt,Zt+=Math.sqrt($t*$t+ht*ht),Tt[9]=Zt,Yn=0}for(Kn*=Zt;;Yn++){let dr=Tt[Yn];if(!(Kn>dr)){if(0==Yn)Kn/=dr;else{let Mr=Tt[Yn-1];Kn=Yn+(Kn-Mr)/(dr-Mr)}break}}this.addCurvePosition(.1*Kn,Ce,Pe,Re,Oe,Ge,ke,et,rt,k,Mn,d||un>0&&0==On)}return k}addBeforePosition(r,h,d,y,b){let R=h[d],k=h[d+1],X=Math.atan2(h[d+3]-k,h[d+2]-R);y[b]=R+r*Math.cos(X),y[b+1]=k+r*Math.sin(X),y[b+2]=X}addAfterPosition(r,h,d,y,b){let R=h[d+2],k=h[d+3],X=Math.atan2(k-h[d+1],R-h[d]);y[b]=R+r*Math.cos(X),y[b+1]=k+r*Math.sin(X),y[b+2]=X}addCurvePosition(r,h,d,y,b,R,k,M,H,X,oe,ne){if(0==r||isNaN(r))return X[oe]=h,X[oe+1]=d,void(X[oe+2]=Math.atan2(b-d,y-h));let ge=r*r,we=ge*r,Se=1-r,Ce=Se*Se,Pe=Ce*Se,Re=Se*r,Oe=3*Re,Ge=Se*Oe,ke=Oe*r,et=h*Pe+y*Ge+R*ke+M*we,rt=d*Pe+b*Ge+k*ke+H*we;X[oe]=et,X[oe+1]=rt,ne&&(X[oe+2]=r<.001?Math.atan2(b-d,y-h):Math.atan2(rt-(d*Ce+b*Re*2+k*ge),et-(h*Ce+y*Re*2+R*ge)))}}Jl.NONE=-1,Jl.BEFORE=-2,Jl.AFTER=-3,Jl.epsilon=1e-5;class Nf{constructor(r,h){if(this.deform=new Array,!r)throw new Error("data cannot be null.");if(!h)throw new Error("bone cannot be null.");this.data=r,this.bone=h,this.color=new xi,this.darkColor=r.darkColor?new xi:null,this.setToSetupPose()}getSkeleton(){return this.bone.skeleton}getAttachment(){return this.attachment}setAttachment(r){this.attachment!=r&&(r instanceof Au&&this.attachment instanceof Au&&r.deformAttachment==this.attachment.deformAttachment||(this.deform.length=0),this.attachment=r,this.attachmentTime=this.bone.skeleton.time)}setAttachmentTime(r){this.attachmentTime=this.bone.skeleton.time-r}getAttachmentTime(){return this.bone.skeleton.time-this.attachmentTime}setToSetupPose(){this.color.setFromColor(this.data.color),this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),this.data.attachmentName?(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName))):this.attachment=null}}class Rf{constructor(r,h){if(this.mixRotate=0,this.mixX=0,this.mixY=0,this.mixScaleX=0,this.mixScaleY=0,this.mixShearY=0,this.temp=new ul,this.active=!1,!r)throw new Error("data cannot be null.");if(!h)throw new Error("skeleton cannot be null.");this.data=r,this.mixRotate=r.mixRotate,this.mixX=r.mixX,this.mixY=r.mixY,this.mixScaleX=r.mixScaleX,this.mixScaleY=r.mixScaleY,this.mixShearY=r.mixShearY,this.bones=new Array;for(let d=0;d<r.bones.length;d++)this.bones.push(h.findBone(r.bones[d].name));this.target=h.findBone(r.target.name)}isActive(){return this.active}update(){0==this.mixRotate&&0==this.mixX&&0==this.mixY&&0==this.mixScaleX&&0==this.mixScaleX&&0==this.mixShearY||(this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld())}applyAbsoluteWorld(){let r=this.mixRotate,h=this.mixX,d=this.mixY,y=this.mixScaleX,b=this.mixScaleY,R=this.mixShearY,k=0!=h||0!=d,M=this.target,H=M.a,X=M.b,oe=M.c,ne=M.d,ge=H*ne-X*oe>0?Ln.degRad:-Ln.degRad,we=this.data.offsetRotation*ge,Se=this.data.offsetShearY*ge,Ce=this.bones;for(let Pe=0,Re=Ce.length;Pe<Re;Pe++){let Oe=Ce[Pe];if(0!=r){let Ge=Oe.a,ke=Oe.b,et=Oe.c,rt=Oe.d,ut=Math.atan2(oe,H)-Math.atan2(et,Ge)+we;ut>Ln.PI?ut-=Ln.PI2:ut<-Ln.PI&&(ut+=Ln.PI2),ut*=r;let vt=Math.cos(ut),Lt=Math.sin(ut);Oe.a=vt*Ge-Lt*et,Oe.b=vt*ke-Lt*rt,Oe.c=Lt*Ge+vt*et,Oe.d=Lt*ke+vt*rt}if(k){let Ge=this.temp;M.localToWorld(Ge.set(this.data.offsetX,this.data.offsetY)),Oe.worldX+=(Ge.x-Oe.worldX)*h,Oe.worldY+=(Ge.y-Oe.worldY)*d}if(0!=y){let Ge=Math.sqrt(Oe.a*Oe.a+Oe.c*Oe.c);0!=Ge&&(Ge=(Ge+(Math.sqrt(H*H+oe*oe)-Ge+this.data.offsetScaleX)*y)/Ge),Oe.a*=Ge,Oe.c*=Ge}if(0!=b){let Ge=Math.sqrt(Oe.b*Oe.b+Oe.d*Oe.d);0!=Ge&&(Ge=(Ge+(Math.sqrt(X*X+ne*ne)-Ge+this.data.offsetScaleY)*b)/Ge),Oe.b*=Ge,Oe.d*=Ge}if(R>0){let Ge=Oe.b,ke=Oe.d,et=Math.atan2(ke,Ge),rt=Math.atan2(ne,X)-Math.atan2(oe,H)-(et-Math.atan2(Oe.c,Oe.a));rt>Ln.PI?rt-=Ln.PI2:rt<-Ln.PI&&(rt+=Ln.PI2),rt=et+(rt+Se)*R;let ut=Math.sqrt(Ge*Ge+ke*ke);Oe.b=Math.cos(rt)*ut,Oe.d=Math.sin(rt)*ut}Oe.updateAppliedTransform()}}applyRelativeWorld(){let r=this.mixRotate,h=this.mixX,d=this.mixY,y=this.mixScaleX,b=this.mixScaleY,R=this.mixShearY,k=0!=h||0!=d,M=this.target,H=M.a,X=M.b,oe=M.c,ne=M.d,ge=H*ne-X*oe>0?Ln.degRad:-Ln.degRad,we=this.data.offsetRotation*ge,Se=this.data.offsetShearY*ge,Ce=this.bones;for(let Pe=0,Re=Ce.length;Pe<Re;Pe++){let Oe=Ce[Pe];if(0!=r){let Ge=Oe.a,ke=Oe.b,et=Oe.c,rt=Oe.d,ut=Math.atan2(oe,H)+we;ut>Ln.PI?ut-=Ln.PI2:ut<-Ln.PI&&(ut+=Ln.PI2),ut*=r;let vt=Math.cos(ut),Lt=Math.sin(ut);Oe.a=vt*Ge-Lt*et,Oe.b=vt*ke-Lt*rt,Oe.c=Lt*Ge+vt*et,Oe.d=Lt*ke+vt*rt}if(k){let Ge=this.temp;M.localToWorld(Ge.set(this.data.offsetX,this.data.offsetY)),Oe.worldX+=Ge.x*h,Oe.worldY+=Ge.y*d}if(0!=y){let Ge=(Math.sqrt(H*H+oe*oe)-1+this.data.offsetScaleX)*y+1;Oe.a*=Ge,Oe.c*=Ge}if(0!=b){let Ge=(Math.sqrt(X*X+ne*ne)-1+this.data.offsetScaleY)*b+1;Oe.b*=Ge,Oe.d*=Ge}if(R>0){let Ge=Math.atan2(ne,X)-Math.atan2(oe,H);Ge>Ln.PI?Ge-=Ln.PI2:Ge<-Ln.PI&&(Ge+=Ln.PI2);let ke=Oe.b,et=Oe.d;Ge=Math.atan2(et,ke)+(Ge-Ln.PI/2+Se)*R;let rt=Math.sqrt(ke*ke+et*et);Oe.b=Math.cos(Ge)*rt,Oe.d=Math.sin(Ge)*rt}Oe.updateAppliedTransform()}}applyAbsoluteLocal(){let r=this.mixRotate,h=this.mixX,d=this.mixY,y=this.mixScaleX,b=this.mixScaleY,R=this.mixShearY,k=this.target,M=this.bones;for(let H=0,X=M.length;H<X;H++){let oe=M[H],ne=oe.arotation;if(0!=r){let Re=k.arotation-ne+this.data.offsetRotation;Re-=360*(16384-(16384.499999999996-Re/360|0)),ne+=Re*r}let ge=oe.ax,we=oe.ay;ge+=(k.ax-ge+this.data.offsetX)*h,we+=(k.ay-we+this.data.offsetY)*d;let Se=oe.ascaleX,Ce=oe.ascaleY;0!=y&&0!=Se&&(Se=(Se+(k.ascaleX-Se+this.data.offsetScaleX)*y)/Se),0!=b&&0!=Ce&&(Ce=(Ce+(k.ascaleY-Ce+this.data.offsetScaleY)*b)/Ce);let Pe=oe.ashearY;if(0!=R){let Re=k.ashearY-Pe+this.data.offsetShearY;Re-=360*(16384-(16384.499999999996-Re/360|0)),Pe+=Re*R}oe.updateWorldTransformWith(ge,we,ne,Se,Ce,oe.ashearX,Pe)}}applyRelativeLocal(){let r=this.mixRotate,h=this.mixX,d=this.mixY,y=this.mixScaleX,b=this.mixScaleY,R=this.mixShearY,k=this.target,M=this.bones;for(let H=0,X=M.length;H<X;H++){let oe=M[H];oe.updateWorldTransformWith(oe.ax+(k.ax+this.data.offsetX)*h,oe.ay+(k.ay+this.data.offsetY)*d,oe.arotation+(k.arotation+this.data.offsetRotation)*r,oe.ascaleX*((k.ascaleX-1+this.data.offsetScaleX)*y+1),oe.ascaleY*((k.ascaleY-1+this.data.offsetScaleY)*b+1),oe.ashearX,oe.ashearY+(k.ashearY+this.data.offsetShearY)*R)}}}class Zd{constructor(r){if(this._updateCache=new Array,this.time=0,this.scaleX=1,this.scaleY=1,this.x=0,this.y=0,!r)throw new Error("data cannot be null.");this.data=r,this.bones=new Array;for(let h=0;h<r.bones.length;h++){let d,y=r.bones[h];if(y.parent){let b=this.bones[y.parent.index];d=new df(y,this,b),b.children.push(d)}else d=new df(y,this,null);this.bones.push(d)}this.slots=new Array,this.drawOrder=new Array;for(let h=0;h<r.slots.length;h++){let d=r.slots[h],b=new Nf(d,this.bones[d.boneData.index]);this.slots.push(b),this.drawOrder.push(b)}this.ikConstraints=new Array;for(let h=0;h<r.ikConstraints.length;h++)this.ikConstraints.push(new ff(r.ikConstraints[h],this));this.transformConstraints=new Array;for(let h=0;h<r.transformConstraints.length;h++)this.transformConstraints.push(new Rf(r.transformConstraints[h],this));this.pathConstraints=new Array;for(let h=0;h<r.pathConstraints.length;h++)this.pathConstraints.push(new Jl(r.pathConstraints[h],this));this.color=new xi(1,1,1,1),this.updateCache()}updateCache(){this._updateCache.length=0;let r=this.bones;for(let H=0,X=r.length;H<X;H++){let oe=r[H];oe.sorted=oe.data.skinRequired,oe.active=!oe.sorted}if(this.skin){let H=this.skin.bones;for(let X=0,oe=this.skin.bones.length;X<oe;X++){let ne=this.bones[H[X].index];do{ne.sorted=!1,ne.active=!0,ne=ne.parent}while(ne)}}let h=this.ikConstraints,d=this.transformConstraints,y=this.pathConstraints,b=h.length,R=d.length,k=y.length,M=b+R+k;e:for(let H=0;H<M;H++){for(let X=0;X<b;X++){let oe=h[X];if(oe.data.order==H){this.sortIkConstraint(oe);continue e}}for(let X=0;X<R;X++){let oe=d[X];if(oe.data.order==H){this.sortTransformConstraint(oe);continue e}}for(let X=0;X<k;X++){let oe=y[X];if(oe.data.order==H){this.sortPathConstraint(oe);continue e}}}for(let H=0,X=r.length;H<X;H++)this.sortBone(r[H])}sortIkConstraint(r){if(r.active=r.target.isActive()&&(!r.data.skinRequired||this.skin&&gr.contains(this.skin.constraints,r.data,!0)),!r.active)return;this.sortBone(r.target);let d=r.bones,y=d[0];if(this.sortBone(y),1==d.length)this._updateCache.push(r),this.sortReset(y.children);else{let b=d[d.length-1];this.sortBone(b),this._updateCache.push(r),this.sortReset(y.children),b.sorted=!0}}sortPathConstraint(r){if(r.active=r.target.bone.isActive()&&(!r.data.skinRequired||this.skin&&gr.contains(this.skin.constraints,r.data,!0)),!r.active)return;let h=r.target,d=h.data.index,y=h.bone;this.skin&&this.sortPathConstraintAttachment(this.skin,d,y),this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,d,y);for(let M=0,H=this.data.skins.length;M<H;M++)this.sortPathConstraintAttachment(this.data.skins[M],d,y);let b=h.getAttachment();b instanceof Bh&&this.sortPathConstraintAttachmentWith(b,y);let R=r.bones,k=R.length;for(let M=0;M<k;M++)this.sortBone(R[M]);this._updateCache.push(r);for(let M=0;M<k;M++)this.sortReset(R[M].children);for(let M=0;M<k;M++)R[M].sorted=!0}sortTransformConstraint(r){if(r.active=r.target.isActive()&&(!r.data.skinRequired||this.skin&&gr.contains(this.skin.constraints,r.data,!0)),!r.active)return;this.sortBone(r.target);let h=r.bones,d=h.length;if(r.data.local)for(let y=0;y<d;y++){let b=h[y];this.sortBone(b.parent),this.sortBone(b)}else for(let y=0;y<d;y++)this.sortBone(h[y]);this._updateCache.push(r);for(let y=0;y<d;y++)this.sortReset(h[y].children);for(let y=0;y<d;y++)h[y].sorted=!0}sortPathConstraintAttachment(r,h,d){let y=r.attachments[h];if(y)for(let b in y)this.sortPathConstraintAttachmentWith(y[b],d)}sortPathConstraintAttachmentWith(r,h){if(!(r instanceof Bh))return;let d=r.bones;if(d){let y=this.bones;for(let b=0,R=d.length;b<R;){let k=d[b++];for(k+=b;b<k;)this.sortBone(y[d[b++]])}}else this.sortBone(h)}sortBone(r){if(r.sorted)return;let h=r.parent;h&&this.sortBone(h),r.sorted=!0,this._updateCache.push(r)}sortReset(r){for(let h=0,d=r.length;h<d;h++){let y=r[h];y.active&&(y.sorted&&this.sortReset(y.children),y.sorted=!1)}}updateWorldTransform(){let r=this.bones;for(let d=0,y=r.length;d<y;d++){let b=r[d];b.ax=b.x,b.ay=b.y,b.arotation=b.rotation,b.ascaleX=b.scaleX,b.ascaleY=b.scaleY,b.ashearX=b.shearX,b.ashearY=b.shearY}let h=this._updateCache;for(let d=0,y=h.length;d<y;d++)h[d].update()}updateWorldTransformWith(r){let h=this.getRootBone(),d=r.a,y=r.b,b=r.c,R=r.d;h.worldX=d*this.x+y*this.y+r.worldX,h.worldY=b*this.x+R*this.y+r.worldY;let k=h.rotation+90+h.shearY,M=Ln.cosDeg(h.rotation+h.shearX)*h.scaleX,H=Ln.cosDeg(k)*h.scaleY,X=Ln.sinDeg(h.rotation+h.shearX)*h.scaleX,oe=Ln.sinDeg(k)*h.scaleY;h.a=(d*M+y*X)*this.scaleX,h.b=(d*H+y*oe)*this.scaleX,h.c=(b*M+R*X)*this.scaleY,h.d=(b*H+R*oe)*this.scaleY;let ne=this._updateCache;for(let ge=0,we=ne.length;ge<we;ge++){let Se=ne[ge];Se!=h&&Se.update()}}setToSetupPose(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()}setBonesToSetupPose(){let r=this.bones;for(let b=0,R=r.length;b<R;b++)r[b].setToSetupPose();let h=this.ikConstraints;for(let b=0,R=h.length;b<R;b++){let k=h[b];k.mix=k.data.mix,k.softness=k.data.softness,k.bendDirection=k.data.bendDirection,k.compress=k.data.compress,k.stretch=k.data.stretch}let d=this.transformConstraints;for(let b=0,R=d.length;b<R;b++){let k=d[b],M=k.data;k.mixRotate=M.mixRotate,k.mixX=M.mixX,k.mixY=M.mixY,k.mixScaleX=M.mixScaleX,k.mixScaleY=M.mixScaleY,k.mixShearY=M.mixShearY}let y=this.pathConstraints;for(let b=0,R=y.length;b<R;b++){let k=y[b],M=k.data;k.position=M.position,k.spacing=M.spacing,k.mixRotate=M.mixRotate,k.mixX=M.mixX,k.mixY=M.mixY}}setSlotsToSetupPose(){let r=this.slots;gr.arrayCopy(r,0,this.drawOrder,0,r.length);for(let h=0,d=r.length;h<d;h++)r[h].setToSetupPose()}getRootBone(){return 0==this.bones.length?null:this.bones[0]}findBone(r){if(!r)throw new Error("boneName cannot be null.");let h=this.bones;for(let d=0,y=h.length;d<y;d++){let b=h[d];if(b.data.name==r)return b}return null}findSlot(r){if(!r)throw new Error("slotName cannot be null.");let h=this.slots;for(let d=0,y=h.length;d<y;d++){let b=h[d];if(b.data.name==r)return b}return null}setSkinByName(r){let h=this.data.findSkin(r);if(!h)throw new Error("Skin not found: "+r);this.setSkin(h)}setSkin(r){if(r!=this.skin){if(r)if(this.skin)r.attachAll(this,this.skin);else{let h=this.slots;for(let d=0,y=h.length;d<y;d++){let b=h[d],R=b.data.attachmentName;if(R){let k=r.getAttachment(d,R);k&&b.setAttachment(k)}}}this.skin=r,this.updateCache()}}getAttachmentByName(r,h){return this.getAttachment(this.data.findSlot(r).index,h)}getAttachment(r,h){if(!h)throw new Error("attachmentName cannot be null.");if(this.skin){let d=this.skin.getAttachment(r,h);if(d)return d}return this.data.defaultSkin?this.data.defaultSkin.getAttachment(r,h):null}setAttachment(r,h){if(!r)throw new Error("slotName cannot be null.");let d=this.slots;for(let y=0,b=d.length;y<b;y++){let R=d[y];if(R.data.name==r){let k=null;if(h&&(k=this.getAttachment(y,h),!k))throw new Error("Attachment not found: "+h+", for slot: "+r);return void R.setAttachment(k)}}throw new Error("Slot not found: "+r)}findIkConstraint(r){if(!r)throw new Error("constraintName cannot be null.");let h=this.ikConstraints;for(let d=0,y=h.length;d<y;d++){let b=h[d];if(b.data.name==r)return b}return null}findTransformConstraint(r){if(!r)throw new Error("constraintName cannot be null.");let h=this.transformConstraints;for(let d=0,y=h.length;d<y;d++){let b=h[d];if(b.data.name==r)return b}return null}findPathConstraint(r){if(!r)throw new Error("constraintName cannot be null.");let h=this.pathConstraints;for(let d=0,y=h.length;d<y;d++){let b=h[d];if(b.data.name==r)return b}return null}getBounds(r,h,d=new Array(2)){if(!r)throw new Error("offset cannot be null.");if(!h)throw new Error("size cannot be null.");let y=this.drawOrder,b=Number.POSITIVE_INFINITY,R=Number.POSITIVE_INFINITY,k=Number.NEGATIVE_INFINITY,M=Number.NEGATIVE_INFINITY;for(let H=0,X=y.length;H<X;H++){let oe=y[H];if(!oe.bone.active)continue;let ne=0,ge=null,we=oe.getAttachment();if(we instanceof wi)ne=8,ge=gr.setArraySize(d,ne,0),we.computeWorldVertices(oe.bone,ge,0,2);else if(we instanceof Zc){let Se=we;ne=Se.worldVerticesLength,ge=gr.setArraySize(d,ne,0),Se.computeWorldVertices(oe,0,ne,ge,0,2)}if(ge)for(let Se=0,Ce=ge.length;Se<Ce;Se+=2){let Pe=ge[Se],Re=ge[Se+1];b=Math.min(b,Pe),R=Math.min(R,Re),k=Math.max(k,Pe),M=Math.max(M,Re)}}r.set(b,R),h.set(k-b,M-R)}update(r){this.time+=r}}class Up{constructor(r,h,d){this.slotIndex=r,this.name=h,this.attachment=d}}class rd{constructor(r){if(this.attachments=new Array,this.bones=Array(),this.constraints=new Array,!r)throw new Error("name cannot be null.");this.name=r}setAttachment(r,h,d){if(!d)throw new Error("attachment cannot be null.");let y=this.attachments;r>=y.length&&(y.length=r+1),y[r]||(y[r]={}),y[r][h]=d}addSkin(r){for(let y=0;y<r.bones.length;y++){let b=r.bones[y],R=!1;for(let k=0;k<this.bones.length;k++)if(this.bones[k]==b){R=!0;break}R||this.bones.push(b)}for(let y=0;y<r.constraints.length;y++){let b=r.constraints[y],R=!1;for(let k=0;k<this.constraints.length;k++)if(this.constraints[k]==b){R=!0;break}R||this.constraints.push(b)}let h=r.getAttachments();for(let y=0;y<h.length;y++){var d=h[y];this.setAttachment(d.slotIndex,d.name,d.attachment)}}copySkin(r){for(let y=0;y<r.bones.length;y++){let b=r.bones[y],R=!1;for(let k=0;k<this.bones.length;k++)if(this.bones[k]==b){R=!0;break}R||this.bones.push(b)}for(let y=0;y<r.constraints.length;y++){let b=r.constraints[y],R=!1;for(let k=0;k<this.constraints.length;k++)if(this.constraints[k]==b){R=!0;break}R||this.constraints.push(b)}let h=r.getAttachments();for(let y=0;y<h.length;y++){var d=h[y];d.attachment&&(d.attachment instanceof Zc?(d.attachment=d.attachment.newLinkedMesh(),this.setAttachment(d.slotIndex,d.name,d.attachment)):(d.attachment=d.attachment.copy(),this.setAttachment(d.slotIndex,d.name,d.attachment)))}}getAttachment(r,h){let d=this.attachments[r];return d?d[h]:null}removeAttachment(r,h){let d=this.attachments[r];d&&(d[h]=null)}getAttachments(){let r=new Array;for(var h=0;h<this.attachments.length;h++){let d=this.attachments[h];if(d)for(let y in d){let b=d[y];b&&r.push(new Up(h,y,b))}}return r}getAttachmentsForSlot(r,h){let d=this.attachments[r];if(d)for(let y in d){let b=d[y];b&&h.push(new Up(r,y,b))}}clear(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0}attachAll(r,h){let d=0;for(let y=0;y<r.slots.length;y++){let b=r.slots[y],R=b.getAttachment();if(R&&d<h.attachments.length){let k=h.attachments[d];for(let M in k)if(R==k[M]){let H=this.getAttachment(d,M);H&&b.setAttachment(H);break}}d++}}}class cm{constructor(r,h,d){if(this.color=new xi(1,1,1,1),r<0)throw new Error("index must be >= 0.");if(!h)throw new Error("name cannot be null.");if(!d)throw new Error("boneData cannot be null.");this.index=r,this.name=h,this.boneData=d}}(function(a){a[a.Normal=0]="Normal",a[a.Additive=1]="Additive",a[a.Multiply=2]="Multiply",a[a.Screen=3]="Screen"})(Jd||(Jd={})),function(a){a[a.Region=0]="Region",a[a.BoundingBox=1]="BoundingBox",a[a.Mesh=2]="Mesh",a[a.LinkedMesh=3]="LinkedMesh",a[a.Path=4]="Path",a[a.Point=5]="Point",a[a.Clipping=6]="Clipping"}(Bf||(Bf={}));class ja{constructor(){this.convexPolygons=new Array,this.convexPolygonsIndices=new Array,this.indicesArray=new Array,this.isConcaveArray=new Array,this.triangles=new Array,this.polygonPool=new Np(()=>new Array),this.polygonIndicesPool=new Np(()=>new Array)}triangulate(r){let h=r,d=r.length>>1,y=this.indicesArray;y.length=0;for(let k=0;k<d;k++)y[k]=k;let b=this.isConcaveArray;b.length=0;for(let k=0,M=d;k<M;++k)b[k]=ja.isConcave(k,d,h,y);let R=this.triangles;for(R.length=0;d>3;){let k=d-1,M=0,H=1;for(;;){e:if(!b[M]){let ne=y[k]<<1,ge=y[M]<<1,we=y[H]<<1,Se=h[ne],Ce=h[ne+1],Pe=h[ge],Re=h[ge+1],Oe=h[we],Ge=h[we+1];for(let ke=(H+1)%d;ke!=k;ke=(ke+1)%d){if(!b[ke])continue;let et=y[ke]<<1,rt=h[et],ut=h[et+1];if(ja.positiveArea(Oe,Ge,Se,Ce,rt,ut)&&ja.positiveArea(Se,Ce,Pe,Re,rt,ut)&&ja.positiveArea(Pe,Re,Oe,Ge,rt,ut))break e}break}if(0==H){do{if(!b[M])break;M--}while(M>0);break}k=M,M=H,H=(H+1)%d}R.push(y[(d+M-1)%d]),R.push(y[M]),R.push(y[(M+1)%d]),y.splice(M,1),b.splice(M,1),d--;let X=(d+M-1)%d,oe=M==d?0:M;b[X]=ja.isConcave(X,d,h,y),b[oe]=ja.isConcave(oe,d,h,y)}return 3==d&&(R.push(y[2]),R.push(y[0]),R.push(y[1])),R}decompose(r,h){let d=r,y=this.convexPolygons;this.polygonPool.freeAll(y),y.length=0;let b=this.convexPolygonsIndices;this.polygonIndicesPool.freeAll(b),b.length=0;let R=this.polygonIndicesPool.obtain();R.length=0;let k=this.polygonPool.obtain();k.length=0;let M=-1,H=0;for(let X=0,oe=h.length;X<oe;X+=3){let ne=h[X]<<1,ge=h[X+1]<<1,we=h[X+2]<<1,Se=d[ne],Ce=d[ne+1],Pe=d[ge],Re=d[ge+1],Oe=d[we],Ge=d[we+1],ke=!1;if(M==ne){let et=k.length-4,rt=ja.winding(k[et],k[et+1],k[et+2],k[et+3],Oe,Ge),ut=ja.winding(Oe,Ge,k[0],k[1],k[2],k[3]);rt==H&&ut==H&&(k.push(Oe),k.push(Ge),R.push(we),ke=!0)}ke||(k.length>0?(y.push(k),b.push(R)):(this.polygonPool.free(k),this.polygonIndicesPool.free(R)),k=this.polygonPool.obtain(),k.length=0,k.push(Se),k.push(Ce),k.push(Pe),k.push(Re),k.push(Oe),k.push(Ge),R=this.polygonIndicesPool.obtain(),R.length=0,R.push(ne),R.push(ge),R.push(we),H=ja.winding(Se,Ce,Pe,Re,Oe,Ge),M=ne)}k.length>0&&(y.push(k),b.push(R));for(let X=0,oe=y.length;X<oe;X++){if(R=b[X],0==R.length)continue;let ne=R[0],ge=R[R.length-1];k=y[X];let we=k.length-4,Se=k[we],Ce=k[we+1],Pe=k[we+2],Re=k[we+3],Oe=k[0],Ge=k[1],ke=k[2],et=k[3],rt=ja.winding(Se,Ce,Pe,Re,Oe,Ge);for(let ut=0;ut<oe;ut++){if(ut==X)continue;let vt=b[ut];if(3!=vt.length)continue;let zt=vt[2],Bt=y[ut],$t=Bt[Bt.length-2],ht=Bt[Bt.length-1];if(vt[0]!=ne||vt[1]!=ge)continue;let Tt=ja.winding(Se,Ce,Pe,Re,$t,ht),Zt=ja.winding($t,ht,Oe,Ge,ke,et);Tt==rt&&Zt==rt&&(Bt.length=0,vt.length=0,k.push($t),k.push(ht),R.push(zt),Se=Pe,Ce=Re,Pe=$t,Re=ht,ut=0)}}for(let X=y.length-1;X>=0;X--)k=y[X],0==k.length&&(y.splice(X,1),this.polygonPool.free(k),R=b[X],b.splice(X,1),this.polygonIndicesPool.free(R));return y}static isConcave(r,h,d,y){let b=y[(h+r-1)%h]<<1,R=y[r]<<1,k=y[(r+1)%h]<<1;return!this.positiveArea(d[b],d[b+1],d[R],d[R+1],d[k],d[k+1])}static positiveArea(r,h,d,y,b,R){return r*(R-y)+d*(h-R)+b*(y-h)>=0}static winding(r,h,d,y,b,R){let k=d-r,M=y-h;return b*M-R*k+k*h-r*M>=0?1:-1}}class zp{constructor(){this.triangulator=new ja,this.clippingPolygon=new Array,this.clipOutput=new Array,this.clippedVertices=new Array,this.clippedTriangles=new Array,this.scratch=new Array}clipStart(r,h){if(this.clipAttachment)return 0;this.clipAttachment=h;let d=h.worldVerticesLength,y=gr.setArraySize(this.clippingPolygon,d);h.computeWorldVertices(r,0,d,y,0,2);let b=this.clippingPolygon;zp.makeClockwise(b);let R=this.clippingPolygons=this.triangulator.decompose(b,this.triangulator.triangulate(b));for(let k=0,M=R.length;k<M;k++){let H=R[k];zp.makeClockwise(H),H.push(H[0]),H.push(H[1])}return R.length}clipEndWithSlot(r){this.clipAttachment&&this.clipAttachment.endSlot==r.data&&this.clipEnd()}clipEnd(){this.clipAttachment&&(this.clipAttachment=null,this.clippingPolygons=null,this.clippedVertices.length=0,this.clippedTriangles.length=0,this.clippingPolygon.length=0)}isClipping(){return null!=this.clipAttachment}clipTriangles(r,h,d,y,b,R,k,M){let H=this.clipOutput,X=this.clippedVertices,oe=this.clippedTriangles,ne=this.clippingPolygons,ge=this.clippingPolygons.length,we=M?12:8,Se=0;X.length=0,oe.length=0;e:for(let Ce=0;Ce<y;Ce+=3){let Pe=d[Ce]<<1,Re=r[Pe],Oe=r[Pe+1],Ge=b[Pe],ke=b[Pe+1];Pe=d[Ce+1]<<1;let et=r[Pe],rt=r[Pe+1],ut=b[Pe],vt=b[Pe+1];Pe=d[Ce+2]<<1;let Lt=r[Pe],Kt=r[Pe+1],zt=b[Pe],Bt=b[Pe+1];for(let $t=0;$t<ge;$t++){let ht=X.length;if(!this.clip(Re,Oe,et,rt,Lt,Kt,ne[$t],H)){let Tt=gr.setArraySize(X,ht+3*we);Tt[ht]=Re,Tt[ht+1]=Oe,Tt[ht+2]=R.r,Tt[ht+3]=R.g,Tt[ht+4]=R.b,Tt[ht+5]=R.a,M?(Tt[ht+6]=Ge,Tt[ht+7]=ke,Tt[ht+8]=k.r,Tt[ht+9]=k.g,Tt[ht+10]=k.b,Tt[ht+11]=k.a,Tt[ht+12]=et,Tt[ht+13]=rt,Tt[ht+14]=R.r,Tt[ht+15]=R.g,Tt[ht+16]=R.b,Tt[ht+17]=R.a,Tt[ht+18]=ut,Tt[ht+19]=vt,Tt[ht+20]=k.r,Tt[ht+21]=k.g,Tt[ht+22]=k.b,Tt[ht+23]=k.a,Tt[ht+24]=Lt,Tt[ht+25]=Kt,Tt[ht+26]=R.r,Tt[ht+27]=R.g,Tt[ht+28]=R.b,Tt[ht+29]=R.a,Tt[ht+30]=zt,Tt[ht+31]=Bt,Tt[ht+32]=k.r,Tt[ht+33]=k.g,Tt[ht+34]=k.b,Tt[ht+35]=k.a):(Tt[ht+6]=Ge,Tt[ht+7]=ke,Tt[ht+8]=et,Tt[ht+9]=rt,Tt[ht+10]=R.r,Tt[ht+11]=R.g,Tt[ht+12]=R.b,Tt[ht+13]=R.a,Tt[ht+14]=ut,Tt[ht+15]=vt,Tt[ht+16]=Lt,Tt[ht+17]=Kt,Tt[ht+18]=R.r,Tt[ht+19]=R.g,Tt[ht+20]=R.b,Tt[ht+21]=R.a,Tt[ht+22]=zt,Tt[ht+23]=Bt),ht=oe.length;let Zt=gr.setArraySize(oe,ht+3);Zt[ht]=Se,Zt[ht+1]=Se+1,Zt[ht+2]=Se+2,Se+=3;continue e}{let Tt=H.length;if(0==Tt)continue;let Zt=rt-Kt,un=Lt-et,Mn=Re-Lt,wr=Kt-Oe,Yn=1/(Zt*Mn+un*(Oe-Kt)),On=Tt>>1,Kn=this.clipOutput,dr=gr.setArraySize(X,ht+On*we);for(let di=0;di<Tt;di+=2){let so=Kn[di],ao=Kn[di+1];dr[ht]=so,dr[ht+1]=ao,dr[ht+2]=R.r,dr[ht+3]=R.g,dr[ht+4]=R.b,dr[ht+5]=R.a;let Do=so-Lt,Uo=ao-Kt,hs=(Zt*Do+un*Uo)*Yn,is=(wr*Do+Mn*Uo)*Yn,Bo=1-hs-is;dr[ht+6]=Ge*hs+ut*is+zt*Bo,dr[ht+7]=ke*hs+vt*is+Bt*Bo,M&&(dr[ht+8]=k.r,dr[ht+9]=k.g,dr[ht+10]=k.b,dr[ht+11]=k.a),ht+=we}ht=oe.length;let Mr=gr.setArraySize(oe,ht+3*(On-2));On--;for(let di=1;di<On;di++)Mr[ht]=Se,Mr[ht+1]=Se+di,Mr[ht+2]=Se+di+1,ht+=3;Se+=On+1}}}}clip(r,h,d,y,b,R,k,M){let H=M,X=!1,oe=null;k.length%4>=2?(oe=M,M=this.scratch):oe=this.scratch,oe.length=0,oe.push(r),oe.push(h),oe.push(d),oe.push(y),oe.push(b),oe.push(R),oe.push(r),oe.push(h),M.length=0;let ne=k,ge=k.length-4;for(let we=0;;we+=2){let Se=ne[we],Ce=ne[we+1],Pe=ne[we+2],Re=ne[we+3],Oe=Se-Pe,Ge=Ce-Re,ke=oe,et=oe.length-2,rt=M.length;for(let vt=0;vt<et;vt+=2){let Lt=ke[vt],Kt=ke[vt+1],zt=ke[vt+2],Bt=ke[vt+3],$t=Oe*(Bt-Re)-Ge*(zt-Pe)>0;if(Oe*(Kt-Re)-Ge*(Lt-Pe)>0){if($t){M.push(zt),M.push(Bt);continue}let ht=Bt-Kt,Tt=zt-Lt,Zt=ht*(Pe-Se)-Tt*(Re-Ce);if(Math.abs(Zt)>1e-6){let un=(Tt*(Ce-Kt)-ht*(Se-Lt))/Zt;M.push(Se+(Pe-Se)*un),M.push(Ce+(Re-Ce)*un)}else M.push(Se),M.push(Ce)}else if($t){let ht=Bt-Kt,Tt=zt-Lt,Zt=ht*(Pe-Se)-Tt*(Re-Ce);if(Math.abs(Zt)>1e-6){let un=(Tt*(Ce-Kt)-ht*(Se-Lt))/Zt;M.push(Se+(Pe-Se)*un),M.push(Ce+(Re-Ce)*un)}else M.push(Se),M.push(Ce);M.push(zt),M.push(Bt)}X=!0}if(rt==M.length)return H.length=0,!0;if(M.push(M[0]),M.push(M[1]),we==ge)break;let ut=M;(M=oe).length=0,oe=ut}if(H!=M){H.length=0;for(let we=0,Se=M.length-2;we<Se;we++)H[we]=M[we]}else H.length=H.length-2;return X}static makeClockwise(r){let h=r,d=r.length,y=h[d-2]*h[1]-h[0]*h[d-1],b=0,R=0,k=0,M=0;for(let H=0,X=d-3;H<X;H+=2)b=h[H],R=h[H+1],k=h[H+2],M=h[H+3],y+=b*M-k*R;if(!(y<0))for(let H=0,X=d-2,oe=d>>1;H<oe;H+=2){let ne=h[H],ge=h[H+1],we=X-H;h[H]=h[we],h[H+1]=h[we+1],h[we]=ne,h[we+1]=ge}}}class um{constructor(r){this.name=r}}class Dm{constructor(r,h){if(!h)throw new Error("data cannot be null.");this.time=r,this.data=h}}class Qd extends nd{constructor(r){super(r,0,!1),this.bones=new Array,this.bendDirection=1,this.compress=!1,this.stretch=!1,this.uniform=!1,this.mix=1,this.softness=0}}class Kd{constructor(){this.bones=new Array,this.slots=new Array,this.skins=new Array,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.fps=0}findBone(r){if(!r)throw new Error("boneName cannot be null.");let h=this.bones;for(let d=0,y=h.length;d<y;d++){let b=h[d];if(b.name==r)return b}return null}findSlot(r){if(!r)throw new Error("slotName cannot be null.");let h=this.slots;for(let d=0,y=h.length;d<y;d++){let b=h[d];if(b.name==r)return b}return null}findSkin(r){if(!r)throw new Error("skinName cannot be null.");let h=this.skins;for(let d=0,y=h.length;d<y;d++){let b=h[d];if(b.name==r)return b}return null}findEvent(r){if(!r)throw new Error("eventDataName cannot be null.");let h=this.events;for(let d=0,y=h.length;d<y;d++){let b=h[d];if(b.name==r)return b}return null}findAnimation(r){if(!r)throw new Error("animationName cannot be null.");let h=this.animations;for(let d=0,y=h.length;d<y;d++){let b=h[d];if(b.name==r)return b}return null}findIkConstraint(r){if(!r)throw new Error("constraintName cannot be null.");let h=this.ikConstraints;for(let d=0,y=h.length;d<y;d++){let b=h[d];if(b.name==r)return b}return null}findTransformConstraint(r){if(!r)throw new Error("constraintName cannot be null.");let h=this.transformConstraints;for(let d=0,y=h.length;d<y;d++){let b=h[d];if(b.name==r)return b}return null}findPathConstraint(r){if(!r)throw new Error("constraintName cannot be null.");let h=this.pathConstraints;for(let d=0,y=h.length;d<y;d++){let b=h[d];if(b.name==r)return b}return null}}class jp extends nd{constructor(r){super(r,0,!1),this.bones=new Array,this.mixRotate=0,this.mixX=0,this.mixY=0,this.mixScaleX=0,this.mixScaleY=0,this.mixShearY=0,this.offsetRotation=0,this.offsetX=0,this.offsetY=0,this.offsetScaleX=0,this.offsetScaleY=0,this.offsetShearY=0,this.relative=!1,this.local=!1}}class hm{constructor(r){this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=r}readSkeletonData(r){let h=this.scale,d=new Kd,y="string"==typeof r?JSON.parse(r):r,b=y.skeleton;if(b&&(d.hash=b.hash,d.version=b.spine,d.x=b.x,d.y=b.y,d.width=b.width,d.height=b.height,d.fps=b.fps,d.imagesPath=b.images),y.bones)for(let R=0;R<y.bones.length;R++){let k=y.bones[R],M=null,H=cn(k,"parent",null);H&&(M=d.findBone(H));let X=new Td(d.bones.length,k.name,M);X.length=cn(k,"length",0)*h,X.x=cn(k,"x",0)*h,X.y=cn(k,"y",0)*h,X.rotation=cn(k,"rotation",0),X.scaleX=cn(k,"scaleX",1),X.scaleY=cn(k,"scaleY",1),X.shearX=cn(k,"shearX",0),X.shearY=cn(k,"shearY",0),X.transformMode=gr.enumValue(la,cn(k,"transform","Normal")),X.skinRequired=cn(k,"skin",!1);let oe=cn(k,"color",null);oe&&X.color.setFromString(oe),d.bones.push(X)}if(y.slots)for(let R=0;R<y.slots.length;R++){let k=y.slots[R],M=d.findBone(k.bone),H=new cm(d.slots.length,k.name,M),X=cn(k,"color",null);X&&H.color.setFromString(X);let oe=cn(k,"dark",null);oe&&(H.darkColor=xi.fromString(oe)),H.attachmentName=cn(k,"attachment",null),H.blendMode=gr.enumValue(Jd,cn(k,"blend","normal")),d.slots.push(H)}if(y.ik)for(let R=0;R<y.ik.length;R++){let k=y.ik[R],M=new Qd(k.name);M.order=cn(k,"order",0),M.skinRequired=cn(k,"skin",!1);for(let H=0;H<k.bones.length;H++)M.bones.push(d.findBone(k.bones[H]));M.target=d.findBone(k.target),M.mix=cn(k,"mix",1),M.softness=cn(k,"softness",0)*h,M.bendDirection=cn(k,"bendPositive",!0)?1:-1,M.compress=cn(k,"compress",!1),M.stretch=cn(k,"stretch",!1),M.uniform=cn(k,"uniform",!1),d.ikConstraints.push(M)}if(y.transform)for(let R=0;R<y.transform.length;R++){let k=y.transform[R],M=new jp(k.name);M.order=cn(k,"order",0),M.skinRequired=cn(k,"skin",!1);for(let X=0;X<k.bones.length;X++)M.bones.push(d.findBone(k.bones[X]));M.target=d.findBone(k.target),M.local=cn(k,"local",!1),M.relative=cn(k,"relative",!1),M.offsetRotation=cn(k,"rotation",0),M.offsetX=cn(k,"x",0)*h,M.offsetY=cn(k,"y",0)*h,M.offsetScaleX=cn(k,"scaleX",0),M.offsetScaleY=cn(k,"scaleY",0),M.offsetShearY=cn(k,"shearY",0),M.mixRotate=cn(k,"mixRotate",1),M.mixX=cn(k,"mixX",1),M.mixY=cn(k,"mixY",M.mixX),M.mixScaleX=cn(k,"mixScaleX",1),M.mixScaleY=cn(k,"mixScaleY",M.mixScaleX),M.mixShearY=cn(k,"mixShearY",1),d.transformConstraints.push(M)}if(y.path)for(let R=0;R<y.path.length;R++){let k=y.path[R],M=new mf(k.name);M.order=cn(k,"order",0),M.skinRequired=cn(k,"skin",!1);for(let X=0;X<k.bones.length;X++)M.bones.push(d.findBone(k.bones[X]));M.target=d.findSlot(k.target),M.positionMode=gr.enumValue(Ch,cn(k,"positionMode","Percent")),M.spacingMode=gr.enumValue(Ys,cn(k,"spacingMode","Length")),M.rotateMode=gr.enumValue(Ec,cn(k,"rotateMode","Tangent")),M.offsetRotation=cn(k,"rotation",0),M.position=cn(k,"position",0),M.positionMode==Ch.Fixed&&(M.position*=h),M.spacing=cn(k,"spacing",0),M.spacingMode!=Ys.Length&&M.spacingMode!=Ys.Fixed||(M.spacing*=h),M.mixRotate=cn(k,"mixRotate",1),M.mixX=cn(k,"mixX",1),M.mixY=cn(k,"mixY",M.mixX),d.pathConstraints.push(M)}if(y.skins)for(let R=0;R<y.skins.length;R++){let k=y.skins[R],M=new rd(k.name);if(k.bones)for(let H=0;H<k.bones.length;H++)M.bones.push(d.findBone(k.bones[H]));if(k.ik)for(let H=0;H<k.ik.length;H++)M.constraints.push(d.findIkConstraint(k.ik[H]));if(k.transform)for(let H=0;H<k.transform.length;H++)M.constraints.push(d.findTransformConstraint(k.transform[H]));if(k.path)for(let H=0;H<k.path.length;H++)M.constraints.push(d.findPathConstraint(k.path[H]));for(let H in k.attachments){let X=d.findSlot(H),oe=k.attachments[H];for(let ne in oe){let ge=this.readAttachment(oe[ne],M,X.index,ne,d);ge&&M.setAttachment(X.index,ne,ge)}}d.skins.push(M),"default"==M.name&&(d.defaultSkin=M)}for(let R=0,k=this.linkedMeshes.length;R<k;R++){let M=this.linkedMeshes[R],H=(M.skin?d.findSkin(M.skin):d.defaultSkin).getAttachment(M.slotIndex,M.parent);M.mesh.deformAttachment=M.inheritDeform?H:M.mesh,M.mesh.setParentMesh(H),M.mesh.updateUVs()}if(this.linkedMeshes.length=0,y.events)for(let R in y.events){let k=y.events[R],M=new um(R);M.intValue=cn(k,"int",0),M.floatValue=cn(k,"float",0),M.stringValue=cn(k,"string",""),M.audioPath=cn(k,"audio",null),M.audioPath&&(M.volume=cn(k,"volume",1),M.balance=cn(k,"balance",0)),d.events.push(M)}if(y.animations)for(let R in y.animations)this.readAnimation(y.animations[R],R,d);return d}readAttachment(r,h,d,y,b){let R=this.scale;switch(y=cn(r,"name",y),cn(r,"type","region")){case"region":{let k=cn(r,"path",y),M=this.attachmentLoader.newRegionAttachment(h,y,k);if(!M)return null;M.path=k,M.x=cn(r,"x",0)*R,M.y=cn(r,"y",0)*R,M.scaleX=cn(r,"scaleX",1),M.scaleY=cn(r,"scaleY",1),M.rotation=cn(r,"rotation",0),M.width=r.width*R,M.height=r.height*R;let H=cn(r,"color",null);return H&&M.color.setFromString(H),M.updateOffset(),M}case"boundingbox":{let k=this.attachmentLoader.newBoundingBoxAttachment(h,y);if(!k)return null;this.readVertices(r,k,r.vertexCount<<1);let M=cn(r,"color",null);return M&&k.color.setFromString(M),k}case"mesh":case"linkedmesh":{let k=cn(r,"path",y),M=this.attachmentLoader.newMeshAttachment(h,y,k);if(!M)return null;M.path=k;let H=cn(r,"color",null);H&&M.color.setFromString(H),M.width=cn(r,"width",0)*R,M.height=cn(r,"height",0)*R;let X=cn(r,"parent",null);if(X)return this.linkedMeshes.push(new Md(M,cn(r,"skin",null),d,X,cn(r,"deform",!0))),M;let oe=r.uvs;return this.readVertices(r,M,oe.length),M.triangles=r.triangles,M.regionUVs=oe,M.updateUVs(),M.edges=cn(r,"edges",null),M.hullLength=2*cn(r,"hull",0),M}case"path":{let k=this.attachmentLoader.newPathAttachment(h,y);if(!k)return null;k.closed=cn(r,"closed",!1),k.constantSpeed=cn(r,"constantSpeed",!0);let M=r.vertexCount;this.readVertices(r,k,M<<1);let H=gr.newArray(M/3,0);for(let oe=0;oe<r.lengths.length;oe++)H[oe]=r.lengths[oe]*R;k.lengths=H;let X=cn(r,"color",null);return X&&k.color.setFromString(X),k}case"point":{let k=this.attachmentLoader.newPointAttachment(h,y);if(!k)return null;k.x=cn(r,"x",0)*R,k.y=cn(r,"y",0)*R,k.rotation=cn(r,"rotation",0);let M=cn(r,"color",null);return M&&k.color.setFromString(M),k}case"clipping":{let k=this.attachmentLoader.newClippingAttachment(h,y);if(!k)return null;let M=cn(r,"end",null);M&&(k.endSlot=b.findSlot(M)),this.readVertices(r,k,r.vertexCount<<1);let X=cn(r,"color",null);return X&&k.color.setFromString(X),k}}return null}readVertices(r,h,d){let y=this.scale;h.worldVerticesLength=d;let b=r.vertices;if(d==b.length){let M=gr.toFloatArray(b);if(1!=y)for(let H=0,X=b.length;H<X;H++)M[H]*=y;return void(h.vertices=M)}let R=new Array,k=new Array;for(let M=0,H=b.length;M<H;){let X=b[M++];k.push(X);for(let oe=M+4*X;M<oe;M+=4)k.push(b[M]),R.push(b[M+1]*y),R.push(b[M+2]*y),R.push(b[M+3])}h.bones=k,h.vertices=gr.toFloatArray(R)}readAnimation(r,h,d){let y=this.scale,b=new Array;if(r.slots)for(let k in r.slots){let M=r.slots[k],H=d.findSlot(k).index;for(let X in M){let oe=M[X];if(!oe)continue;let ne=oe.length;if("attachment"==X){let ge=new qd(ne,H);for(let we=0;we<ne;we++){let Se=oe[we];ge.setFrame(we,cn(Se,"time",0),Se.name)}b.push(ge)}else if("rgba"==X){let ge=new Wd(ne,ne<<2,H),we=oe[0],Se=cn(we,"time",0),Ce=xi.fromString(we.color);for(let Pe=0,Re=0;;Pe++){ge.setFrame(Pe,Se,Ce.r,Ce.g,Ce.b,Ce.a);let Oe=oe[Pe+1];if(!Oe){ge.shrink(Re);break}let Ge=cn(Oe,"time",0),ke=xi.fromString(Oe.color),et=we.curve;et&&(Re=Qn(et,ge,Re,Pe,0,Se,Ge,Ce.r,ke.r,1),Re=Qn(et,ge,Re,Pe,1,Se,Ge,Ce.g,ke.g,1),Re=Qn(et,ge,Re,Pe,2,Se,Ge,Ce.b,ke.b,1),Re=Qn(et,ge,Re,Pe,3,Se,Ge,Ce.a,ke.a,1)),Se=Ge,Ce=ke,we=Oe}b.push(ge)}else if("rgb"==X){let ge=new tm(ne,3*ne,H),we=oe[0],Se=cn(we,"time",0),Ce=xi.fromString(we.color);for(let Pe=0,Re=0;;Pe++){ge.setFrame(Pe,Se,Ce.r,Ce.g,Ce.b);let Oe=oe[Pe+1];if(!Oe){ge.shrink(Re);break}let Ge=cn(Oe,"time",0),ke=xi.fromString(Oe.color),et=we.curve;et&&(Re=Qn(et,ge,Re,Pe,0,Se,Ge,Ce.r,ke.r,1),Re=Qn(et,ge,Re,Pe,1,Se,Ge,Ce.g,ke.g,1),Re=Qn(et,ge,Re,Pe,2,Se,Ge,Ce.b,ke.b,1)),Se=Ge,Ce=ke,we=Oe}b.push(ge)}else if("alpha"==X)b.push(Tc(oe,new nm(ne,ne,H),0,1));else if("rgba2"==X){let ge=new Nm(ne,7*ne,H),we=oe[0],Se=cn(we,"time",0),Ce=xi.fromString(we.light),Pe=xi.fromString(we.dark);for(let Re=0,Oe=0;;Re++){ge.setFrame(Re,Se,Ce.r,Ce.g,Ce.b,Ce.a,Pe.r,Pe.g,Pe.b);let Ge=oe[Re+1];if(!Ge){ge.shrink(Oe);break}let ke=cn(Ge,"time",0),et=xi.fromString(Ge.light),rt=xi.fromString(Ge.dark),ut=we.curve;ut&&(Oe=Qn(ut,ge,Oe,Re,0,Se,ke,Ce.r,et.r,1),Oe=Qn(ut,ge,Oe,Re,1,Se,ke,Ce.g,et.g,1),Oe=Qn(ut,ge,Oe,Re,2,Se,ke,Ce.b,et.b,1),Oe=Qn(ut,ge,Oe,Re,3,Se,ke,Ce.a,et.a,1),Oe=Qn(ut,ge,Oe,Re,4,Se,ke,Pe.r,rt.r,1),Oe=Qn(ut,ge,Oe,Re,5,Se,ke,Pe.g,rt.g,1),Oe=Qn(ut,ge,Oe,Re,6,Se,ke,Pe.b,rt.b,1)),Se=ke,Ce=et,Pe=rt,we=Ge}b.push(ge)}else if("rgb2"==X){let ge=new Af(ne,6*ne,H),we=oe[0],Se=cn(we,"time",0),Ce=xi.fromString(we.light),Pe=xi.fromString(we.dark);for(let Re=0,Oe=0;;Re++){ge.setFrame(Re,Se,Ce.r,Ce.g,Ce.b,Pe.r,Pe.g,Pe.b);let Ge=oe[Re+1];if(!Ge){ge.shrink(Oe);break}let ke=cn(Ge,"time",0),et=xi.fromString(Ge.light),rt=xi.fromString(Ge.dark),ut=we.curve;ut&&(Oe=Qn(ut,ge,Oe,Re,0,Se,ke,Ce.r,et.r,1),Oe=Qn(ut,ge,Oe,Re,1,Se,ke,Ce.g,et.g,1),Oe=Qn(ut,ge,Oe,Re,2,Se,ke,Ce.b,et.b,1),Oe=Qn(ut,ge,Oe,Re,3,Se,ke,Pe.r,rt.r,1),Oe=Qn(ut,ge,Oe,Re,4,Se,ke,Pe.g,rt.g,1),Oe=Qn(ut,ge,Oe,Re,5,Se,ke,Pe.b,rt.b,1)),Se=ke,Ce=et,Pe=rt,we=Ge}b.push(ge)}}}if(r.bones)for(let k in r.bones){let M=r.bones[k],H=d.findBone(k).index;for(let X in M){let oe=M[X],ne=oe.length;if(0!=ne)if("rotate"===X)b.push(Tc(oe,new cf(ne,ne,H),0,1));else if("translate"===X){let ge=new $m(ne,ne<<1,H);b.push(Ad(oe,ge,"x","y",0,y))}else if("translatex"===X){let ge=new Rp(ne,ne,H);b.push(Tc(oe,ge,0,y))}else if("translatey"===X){let ge=new Qf(ne,ne,H);b.push(Tc(oe,ge,0,y))}else if("scale"===X){let ge=new Cm(ne,ne<<1,H);b.push(Ad(oe,ge,"x","y",1,1))}else if("scalex"===X){let ge=new Kf(ne,ne,H);b.push(Tc(oe,ge,1,1))}else if("scaley"===X){let ge=new em(ne,ne,H);b.push(Tc(oe,ge,1,1))}else if("shear"===X){let ge=new Vd(ne,ne<<1,H);b.push(Ad(oe,ge,"x","y",0,1))}else if("shearx"===X){let ge=new Lm(ne,ne,H);b.push(Tc(oe,ge,0,1))}else if("sheary"===X){let ge=new Bm(ne,ne,H);b.push(Tc(oe,ge,0,1))}}}if(r.ik)for(let k in r.ik){let M=r.ik[k],H=M[0];if(!H)continue;let X=d.findIkConstraint(k),oe=d.ikConstraints.indexOf(X),ne=new Pm(M.length,M.length<<1,oe),ge=cn(H,"time",0),we=cn(H,"mix",1),Se=cn(H,"softness",0)*y;for(let Ce=0,Pe=0;;Ce++){ne.setFrame(Ce,ge,we,Se,cn(H,"bendPositive",!0)?1:-1,cn(H,"compress",!1),cn(H,"stretch",!1));let Re=M[Ce+1];if(!Re){ne.shrink(Pe);break}let Oe=cn(Re,"time",0),Ge=cn(Re,"mix",1),ke=cn(Re,"softness",0)*y,et=H.curve;et&&(Pe=Qn(et,ne,Pe,Ce,0,ge,Oe,we,Ge,1),Pe=Qn(et,ne,Pe,Ce,1,ge,Oe,Se,ke,y)),ge=Oe,we=Ge,Se=ke,H=Re}b.push(ne)}if(r.transform)for(let k in r.transform){let M=r.transform[k],H=M[0];if(!H)continue;let X=d.findTransformConstraint(k),oe=d.transformConstraints.indexOf(X),ne=new rm(M.length,6*M.length,oe),ge=cn(H,"time",0),we=cn(H,"mixRotate",1),Se=cn(H,"mixX",1),Ce=cn(H,"mixY",Se),Pe=cn(H,"mixScaleX",1),Re=cn(H,"mixScaleY",Pe),Oe=cn(H,"mixShearY",1);for(let Ge=0,ke=0;;Ge++){ne.setFrame(Ge,ge,we,Se,Ce,Pe,Re,Oe);let et=M[Ge+1];if(!et){ne.shrink(ke);break}let rt=cn(et,"time",0),ut=cn(et,"mixRotate",1),vt=cn(et,"mixX",1),Lt=cn(et,"mixY",vt),Kt=cn(et,"mixScaleX",1),zt=cn(et,"mixScaleY",Kt),Bt=cn(et,"mixShearY",1),$t=H.curve;$t&&(ke=Qn($t,ne,ke,Ge,0,ge,rt,we,ut,1),ke=Qn($t,ne,ke,Ge,1,ge,rt,Se,vt,1),ke=Qn($t,ne,ke,Ge,2,ge,rt,Ce,Lt,1),ke=Qn($t,ne,ke,Ge,3,ge,rt,Pe,Kt,1),ke=Qn($t,ne,ke,Ge,4,ge,rt,Re,zt,1),ke=Qn($t,ne,ke,Ge,5,ge,rt,Oe,Bt,1)),ge=rt,we=ut,Se=vt,Ce=Lt,Pe=Kt,Re=zt,Pe=Kt,H=et}b.push(ne)}if(r.path)for(let k in r.path){let M=r.path[k],H=d.findPathConstraint(k),X=d.pathConstraints.indexOf(H);for(let oe in M){let ne=M[oe],ge=ne[0];if(!ge)continue;let we=ne.length;if("position"===oe){let Se=new im(we,we,X);b.push(Tc(ne,Se,0,H.positionMode==Ch.Fixed?y:1))}else if("spacing"===oe){let Se=new Im(we,we,X);b.push(Tc(ne,Se,0,H.spacingMode==Ys.Length||H.spacingMode==Ys.Fixed?y:1))}else if("mix"===oe){let Se=new Om(we,3*we,X),Ce=cn(ge,"time",0),Pe=cn(ge,"mixRotate",1),Re=cn(ge,"mixX",1),Oe=cn(ge,"mixY",Re);for(let Ge=0,ke=0;;Ge++){Se.setFrame(Ge,Ce,Pe,Re,Oe);let et=ne[Ge+1];if(!et){Se.shrink(ke);break}let rt=cn(et,"time",0),ut=cn(et,"mixRotate",1),vt=cn(et,"mixX",1),Lt=cn(et,"mixY",vt),Kt=ge.curve;Kt&&(ke=Qn(Kt,Se,ke,Ge,0,Ce,rt,Pe,ut,1),ke=Qn(Kt,Se,ke,Ge,1,Ce,rt,Re,vt,1),ke=Qn(Kt,Se,ke,Ge,2,Ce,rt,Oe,Lt,1)),Ce=rt,Pe=ut,Re=vt,Oe=Lt,ge=et}b.push(Se)}}}if(r.deform)for(let k in r.deform){let M=r.deform[k],H=d.findSkin(k);for(let X in M){let oe=M[X],ne=d.findSlot(X).index;for(let ge in oe){let we=oe[ge],Se=we[0];if(!Se)continue;let Ce=H.getAttachment(ne,ge),Pe=Ce.bones,Re=Ce.vertices,Oe=Pe?Re.length/3*2:Re.length,Ge=new Rm(we.length,we.length,ne,Ce),ke=cn(Se,"time",0);for(let et=0,rt=0;;et++){let ut,vt=cn(Se,"vertices",null);if(vt){ut=gr.newFloatArray(Oe);let Bt=cn(Se,"offset",0);if(gr.arrayCopy(vt,0,ut,Bt,vt.length),1!=y)for(let $t=Bt,ht=$t+vt.length;$t<ht;$t++)ut[$t]*=y;if(!Pe)for(let $t=0;$t<Oe;$t++)ut[$t]+=Re[$t]}else ut=Pe?gr.newFloatArray(Oe):Re;Ge.setFrame(et,ke,ut);let Lt=we[et+1];if(!Lt){Ge.shrink(rt);break}let Kt=cn(Lt,"time",0),zt=Se.curve;zt&&(rt=Qn(zt,Ge,rt,et,0,ke,Kt,0,1,1)),ke=Kt,Se=Lt}b.push(Ge)}}}if(r.drawOrder){let k=new Pp(r.drawOrder.length),M=d.slots.length,H=0;for(let X=0;X<r.drawOrder.length;X++,H++){let oe=r.drawOrder[X],ne=null,ge=cn(oe,"offsets",null);if(ge){ne=gr.newArray(M,-1);let we=gr.newArray(M-ge.length,0),Se=0,Ce=0;for(let Pe=0;Pe<ge.length;Pe++){let Re=ge[Pe],Oe=d.findSlot(Re.slot).index;for(;Se!=Oe;)we[Ce++]=Se++;ne[Se+Re.offset]=Se++}for(;Se<M;)we[Ce++]=Se++;for(let Pe=M-1;Pe>=0;Pe--)-1==ne[Pe]&&(ne[Pe]=we[--Ce])}k.setFrame(H,cn(oe,"time",0),ne)}b.push(k)}if(r.events){let k=new Xd(r.events.length),M=0;for(let H=0;H<r.events.length;H++,M++){let X=r.events[H],oe=d.findEvent(X.name),ne=new Dm(gr.toSinglePrecision(cn(X,"time",0)),oe);ne.intValue=cn(X,"int",oe.intValue),ne.floatValue=cn(X,"float",oe.floatValue),ne.stringValue=cn(X,"string",oe.stringValue),ne.data.audioPath&&(ne.volume=cn(X,"volume",1),ne.balance=cn(X,"balance",0)),k.setFrame(M,ne)}b.push(k)}let R=0;for(let k=0,M=b.length;k<M;k++)R=Math.max(R,b[k].getDuration());d.animations.push(new Zf(h,b,R))}}class Md{constructor(r,h,d,y,b){this.mesh=r,this.skin=h,this.slotIndex=d,this.parent=y,this.inheritDeform=b}}function Tc(a,r,h,d){let y=a[0],b=cn(y,"time",0),R=cn(y,"value",h)*d,k=0;for(let M=0;;M++){r.setFrame(M,b,R);let H=a[M+1];if(!H)return r.shrink(k),r;let X=cn(H,"time",0),oe=cn(H,"value",h)*d;y.curve&&(k=Qn(y.curve,r,k,M,0,b,X,R,oe,d)),b=X,R=oe,y=H}}function Ad(a,r,h,d,y,b){let R=a[0],k=cn(R,"time",0),M=cn(R,h,y)*b,H=cn(R,d,y)*b,X=0;for(let oe=0;;oe++){r.setFrame(oe,k,M,H);let ne=a[oe+1];if(!ne)return r.shrink(X),r;let ge=cn(ne,"time",0),we=cn(ne,h,y)*b,Se=cn(ne,d,y)*b,Ce=R.curve;Ce&&(X=Qn(Ce,r,X,oe,0,k,ge,M,we,b),X=Qn(Ce,r,X,oe,1,k,ge,H,Se,b)),k=ge,M=we,H=Se,R=ne}}function Qn(a,r,h,d,y,b,R,k,M,H){if("stepped"==a)return r.setStepped(d),h;let X=y<<2;return r.setBezier(h,d,y,b,k,a[X],a[X+1]*H,a[X+2],a[X+3]*H,R,M),h+1}function cn(a,r,h){return void 0!==a[r]?a[r]:h}void 0===Math.fround&&(Math.fround=(Sd=new Float32Array(1),function(a){return Sd[0]=a,Sd[0]}));class Gp{constructor(r){this.centerX=0,this.centerY=0,this.radius=0,this.angle=0,this.worldX=0,this.worldY=0,this.radius=r}begin(r){this.worldX=r.x+this.centerX,this.worldY=r.y+this.centerY}transform(r,h,d,y){let b=this.angle*Ln.degreesToRadians,R=r.x-this.worldX,k=r.y-this.worldY,M=Math.sqrt(R*R+k*k);if(M<this.radius){let H=Gp.interpolation.apply(0,b,(this.radius-M)/this.radius),X=Math.cos(H),oe=Math.sin(H);r.x=X*R-oe*k+this.worldX,r.y=oe*R+X*k+this.worldY}}end(){}}Gp.interpolation=new class extends Jf{constructor(a){super(a)}applyInternal(a){return Math.pow(a-1,this.power)*(this.power%2==0?-1:1)+1}}(2);var Xo=__webpack_require__(175);class Qc extends lm{constructor(r){super(r),this.texture=new Xo.Texture(r),this.texture.flipY=!1,this.texture.needsUpdate=!0}setFilters(r,h){this.texture.minFilter=Qc.toThreeJsTextureFilter(r),this.texture.magFilter=Qc.toThreeJsTextureFilter(h)}setWraps(r,h){this.texture.wrapS=Qc.toThreeJsTextureWrap(r),this.texture.wrapT=Qc.toThreeJsTextureWrap(h)}dispose(){this.texture.dispose()}static toThreeJsTextureFilter(r){if(r===Yc.Linear)return Xo.LinearFilter;if(r===Yc.MipMap)return Xo.LinearMipMapLinearFilter;if(r===Yc.MipMapLinearNearest)return Xo.LinearMipMapNearestFilter;if(r===Yc.MipMapNearestLinear)return Xo.NearestMipMapLinearFilter;if(r===Yc.MipMapNearestNearest)return Xo.NearestMipMapNearestFilter;if(r===Yc.Nearest)return Xo.NearestFilter;throw new Error("Unknown texture filter: "+r)}static toThreeJsTextureWrap(r){if(r===$h.ClampToEdge)return Xo.ClampToEdgeWrapping;if(r===$h.MirroredRepeat)return Xo.MirroredRepeatWrapping;if(r===$h.Repeat)return Xo.RepeatWrapping;throw new Error("Unknown texture wrap: "+r)}}class Nh extends Xo.ShaderMaterial{constructor(r){let h={uniforms:{map:{type:"t",value:null}},vertexShader:"\n\t\t\t\tattribute vec4 color;\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tvarying vec4 vColor;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tvColor = color;\n\t\t\t\t\tgl_Position = projectionMatrix*modelViewMatrix*vec4(position,1.0);\n\t\t\t\t}\n\t\t\t",fragmentShader:"\n\t\t\t\tuniform sampler2D map;\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tvarying vec4 vColor;\n\t\t\t\tvoid main(void) {\n\t\t\t\t\tgl_FragColor = texture2D(map, vUv)*vColor;\n\t\t\t\t}\n\t\t\t",side:Xo.DoubleSide,transparent:!0,alphaTest:.5};r(h),super(h)}}class Ni extends Xo.Object3D{constructor(r,h=d=>{}){super(),this.tempPos=new ul,this.tempUv=new ul,this.tempLight=new xi,this.tempDark=new xi,this.zOffset=.1,this.batches=new Array,this.nextBatchIndex=0,this.clipper=new zp,this.vertices=gr.newFloatArray(1024),this.tempColor=new xi,this.materialCustomizer=h,this.skeleton=new Zd(r);let d=new Ip(r);this.state=new uf(d)}update(r){let h=this.state,d=this.skeleton;h.update(r),h.apply(d),d.updateWorldTransform(),this.updateGeometry()}dispose(){for(var r=0;r<this.batches.length;r++)this.batches[r].dispose()}clearBatches(){for(var r=0;r<this.batches.length;r++)this.batches[r].clear(),this.batches[r].visible=!1;this.nextBatchIndex=0}nextBatch(){if(this.batches.length==this.nextBatchIndex){let h=new Rl(10920,this.materialCustomizer);this.add(h),this.batches.push(h)}let r=this.batches[this.nextBatchIndex++];return r.visible=!0,r}updateGeometry(){this.clearBatches();let r=this.tempPos,h=this.tempUv,d=this.tempLight,y=this.tempDark,b=this.clipper,R=this.vertices,k=null,M=null,H=this.skeleton.drawOrder,X=this.nextBatch();X.begin();let oe=0,ne=this.zOffset;for(let ge=0,we=H.length;ge<we;ge++){let Se=b.isClipping()?2:Ni.VERTEX_SIZE,Ce=H[ge];if(!Ce.bone.active){b.clipEndWithSlot(Ce);continue}let Pe=Ce.getAttachment(),Re=null,Oe=null,Ge=0;if(Pe instanceof wi){let ke=Pe;Re=ke.color,R=this.vertices,Ge=4*Se,ke.computeWorldVertices(Ce.bone,R,0,Se),k=Ni.QUAD_TRIANGLES,M=ke.uvs,Oe=ke.region.renderObject.page.texture}else{if(!(Pe instanceof Zc)){if(Pe instanceof Yd){b.clipStart(Ce,Pe);continue}b.clipEndWithSlot(Ce);continue}{let ke=Pe;Re=ke.color,R=this.vertices,Ge=(ke.worldVerticesLength>>1)*Se,Ge>R.length&&(R=this.vertices=gr.newFloatArray(Ge)),ke.computeWorldVertices(Ce,0,ke.worldVerticesLength,R,0,Se),k=ke.triangles,M=ke.uvs,Oe=ke.region.renderObject.page.texture}}if(Oe){let ke,et,rt,ut,vt=Ce.bone.skeleton.color,Lt=Ce.color,zt=this.tempColor;if(zt.set(vt.r*Lt.r*Re.r,vt.g*Lt.g*Re.g,vt.b*Lt.b*Re.b,vt.a*Lt.a*Re.a),b.isClipping()){b.clipTriangles(R,Ge,k,k.length,M,zt,null,!1);let $t=b.clippedVertices,ht=b.clippedTriangles;if(this.vertexEffect){let Tt=this.vertexEffect,Zt=$t;for(let un=0,Mn=$t.length;un<Mn;un+=Se)r.x=Zt[un],r.y=Zt[un+1],d.setFromColor(zt),y.set(0,0,0,0),h.x=Zt[un+6],h.y=Zt[un+7],Tt.transform(r,h,d,y),Zt[un]=r.x,Zt[un+1]=r.y,Zt[un+2]=d.r,Zt[un+3]=d.g,Zt[un+4]=d.b,Zt[un+5]=d.a,Zt[un+6]=h.x,Zt[un+7]=h.y}ke=$t,et=$t.length,rt=ht,ut=ht.length}else{let $t=R;if(this.vertexEffect){let ht=this.vertexEffect;for(let Tt=0,Zt=0,un=Ge;Tt<un;Tt+=Se,Zt+=2)r.x=$t[Tt],r.y=$t[Tt+1],d.setFromColor(zt),y.set(0,0,0,0),h.x=M[Zt],h.y=M[Zt+1],ht.transform(r,h,d,y),$t[Tt]=r.x,$t[Tt+1]=r.y,$t[Tt+2]=d.r,$t[Tt+3]=d.g,$t[Tt+4]=d.b,$t[Tt+5]=d.a,$t[Tt+6]=h.x,$t[Tt+7]=h.y}else for(let ht=2,Tt=0,Zt=Ge;ht<Zt;ht+=Se,Tt+=2)$t[ht]=zt.r,$t[ht+1]=zt.g,$t[ht+2]=zt.b,$t[ht+3]=zt.a,$t[ht+4]=M[Tt],$t[ht+5]=M[Tt+1];ke=R,et=Ge,rt=k,ut=k.length}if(0==et||0==ut){b.clipEndWithSlot(Ce);continue}X.canBatch(et,ut)||(X.end(),X=this.nextBatch(),X.begin());let Bt=X.material;Bt.uniforms.map.value||(Bt.uniforms.map.value=Oe.texture),Bt.uniforms.map.value!=Oe.texture&&(X.end(),X=this.nextBatch(),X.begin(),Bt=X.material,Bt.uniforms.map.value=Oe.texture),Bt.needsUpdate=!0,X.batch(ke,et,rt,ut,oe),oe+=ne}b.clipEndWithSlot(Ce)}b.clipEnd(),X.end()}}Ni.QUAD_TRIANGLES=[0,1,2,2,3,0],Ni.VERTEX_SIZE=8;class Rl extends Xo.Mesh{constructor(r=10920,h=d=>{}){if(super(),this.verticesLength=0,this.indicesLength=0,r>10920)throw new Error("Can't have more than 10920 triangles per batch: "+r);let d=this.vertices=new Float32Array(r*Rl.VERTEX_SIZE),y=this.indices=new Uint16Array(3*r),b=new Xo.BufferGeometry,R=this.vertexBuffer=new Xo.InterleavedBuffer(d,Rl.VERTEX_SIZE);R.usage=WebGLRenderingContext.DYNAMIC_DRAW,b.setAttribute("position",new Xo.InterleavedBufferAttribute(R,3,0,!1)),b.setAttribute("color",new Xo.InterleavedBufferAttribute(R,4,3,!1)),b.setAttribute("uv",new Xo.InterleavedBufferAttribute(R,2,7,!1)),b.setIndex(new Xo.BufferAttribute(y,1)),b.getIndex().usage=WebGLRenderingContext.DYNAMIC_DRAW,b.drawRange.start=0,b.drawRange.count=0,this.geometry=b,this.material=new Nh(h)}dispose(){if(this.geometry.dispose(),this.material instanceof Xo.Material)this.material.dispose();else if(this.material)for(let r=0;r<this.material.length;r++){let h=this.material[r];h instanceof Xo.Material&&h.dispose()}}clear(){let r=this.geometry;return r.drawRange.start=0,r.drawRange.count=0,this.material.uniforms.map.value=null,this}begin(){this.verticesLength=0,this.indicesLength=0}canBatch(r,h){return!(this.indicesLength+h>=this.indices.byteLength/2||this.verticesLength+r>=this.vertices.byteLength/2)}batch(r,h,d,y,b=0){let R=this.verticesLength/Rl.VERTEX_SIZE,k=this.vertices,M=this.verticesLength,H=0;for(;H<h;)k[M++]=r[H++],k[M++]=r[H++],k[M++]=b,k[M++]=r[H++],k[M++]=r[H++],k[M++]=r[H++],k[M++]=r[H++],k[M++]=r[H++],k[M++]=r[H++];this.verticesLength=M;let X=this.indices;for(M=this.indicesLength,H=0;H<y;M++,H++)X[M]=d[H]+R;this.indicesLength+=y}end(){this.vertexBuffer.needsUpdate=this.verticesLength>0,this.vertexBuffer.updateRange.offset=0,this.vertexBuffer.updateRange.count=this.verticesLength;let r=this.geometry;r.getIndex().needsUpdate=this.indicesLength>0,r.getIndex().updateRange.offset=0,r.getIndex().updateRange.count=this.indicesLength,r.drawRange.start=0,r.drawRange.count=this.indicesLength}}function ah(a){Qc.call(this,a.image),this.texture=a,this.texture.flipY=!1}function Wi(a,r,h,d){void 0===d&&(d=[]);var y=new Jc(r,function(k){for(var M=0;M<d.length;M++)if(d[M].name===k){var H=new ah(d[M].texture);break}M===d.length&&(H=new ah(new vs(new gs(h+"/"+k))),d.push({name:k,texture:H.texture}));var X=H.texture.image,oe=H.texture.source;if(oe.width>0&&oe.height>0)X.width=oe.width,X.height=oe.height;else if(0!==X.naturalWidth&&0!==X.naturalHeight)X.width=X.naturalWidth,X.height=X.naturalHeight,oe.width=X.width,oe.height=X.height;else{var ne=r.search("size: "),ge=r.search("\nformat"),we=r.substring(ne+6,ge);we=we.split(","),X.width=parseInt(we[0]),X.height=parseInt(we[1])}return H}),b=new Ed(y),R=new hm(b).readSkeletonData(a);Ni.call(this,R),this.name="spine",this.type="SpineAnimation",this.scale.set(.01,.01,.01),this.json=a,this.atlas=r,this.textures=d,this.skin=this.getSkins().length>0?this.getSkins()[0].name:null,this.animation=this.getAnimations().length>0?this.getAnimations()[0].name:null,this.track=0,this.loop=!0,this.clock=new l.Clock,this.play()}function Mc(a,r,h,d,y,b){l.SpotLight.call(this,a,r,h,d,y,b),this.name="spotlight",this.castShadow=!0,this.shadow.camera.near=.05,this.shadow.camera.far=5e3,this.shadow.mapSize.width=512,this.shadow.mapSize.height=512}function ca(a){l.Sprite.call(this,a),this.name="sprite"}Rl.VERTEX_SIZE=9,ah.prototype=Object.create(Qc.prototype),(Wi.prototype=Object.create(Ni.prototype)).update=function(a){Ni.prototype.update.call(this,a),l.Object3D.prototype.update.call(this)},Wi.prototype.onBeforeRender=function(){this.state.update(this.clock.getDelta()),this.state.apply(this.skeleton),this.skeleton.updateWorldTransform(),this.updateGeometry()},Wi.prototype.play=function(){null!==this.animation&&this.setAnimation(this.track,this.animation,this.loop),null!==this.skin&&this.setSkin(this.skin)},Wi.prototype.getAnimations=function(){return this.state.data.skeletonData.animations},Wi.prototype.setAnimation=function(a,r,h){try{void 0!==a&&(this.track=a),void 0!==r&&(this.animation=r),void 0!==h&&(this.loop=h),this.state.setAnimation(this.track,this.animation,this.loop)}catch{this.animation=null,console.warn("nunuStudio: Error setting spine animation "+name+" on track "+a)}},Wi.prototype.getSkins=function(){return this.state.data.skeletonData.skins},Wi.prototype.setSkin=function(a){try{this.skeleton.setSkinByName(a),this.skin=a}catch{this.skin=null,console.warn("nunuStudio: Error setting spine skin "+a)}},Wi.prototype.toJSON=function(a){var r=[],h=this,d=l.Object3D.prototype.toJSON.call(this,a,function(y){for(var b=0;b<h.textures.length;b++){var R=h.textures[b].texture.toJSON(y);r.push({name:h.textures[b].name,texture:R.uuid})}});return d.object.json=this.json,d.object.atlas=this.atlas,d.object.textures=r,null!==this.animation&&(d.object.animation=this.animation,d.object.track=this.track,d.object.loop=this.loop),null!==this.skin&&(d.object.skin=this.skin),d},(Mc.prototype=Object.create(l.SpotLight.prototype)).setTarget=function(a){this.target=a},Mc.prototype.updateShadowMap=function(){this.shadow.map.dispose(),this.shadow.map=null,this.shadow.camera.updateProjectionMatrix()},Mc.prototype.toJSON=function(a){var r=l.Light.prototype.toJSON.call(this,a);return r.object.target=this.target.uuid,r},(ca.prototype=Object.create(l.Sprite.prototype)).dispose=function(){null!==this.material&&void 0!==this.material.dispose&&this.material.dispose(),l.Object3D.prototype.dispose.call(this)};var od=__webpack_require__(980);function Ga(a){l.Group.call(this),this.type="PythonScript",this.name="script",this.code=void 0!==a?a:Ga.DEFAULT,this.script={},this.program=null,this.scene=null}Ga.prototype=Object.create(l.Group.prototype),Ga.DEFAULT="def initialize(obj, scene, program, keyboard, mouse):\n\t# TODO <ADD CODE HERE>\n\tpass\n\ndef update(delta, obj, scene, program, keyboard, mouse):\n\t# TODO <ADD CODE HERE>\n\tpass",Ga.prototype.initialize=function(){for(var a=this;null!==a.parent;)(a=a.parent)instanceof bs?this.scene=a:a instanceof Qr&&(this.program=a);l.Object3D.prototype.initialize.call(this),this.compileCode(this.code),void 0!==this.script.initialize&&this.script.initialize.call(this,this,this.scene,this.program,this.program.keyboard,this.program.mouse)},Ga.prototype.update=function(a){if(void 0!==this.script.onMouseOver){var r=this.scene.raycaster.intersectObjects(this.children,!0);r.length>0&&this.script.onMouseOver.call(this,r)}void 0!==this.script.update&&this.script.update.call(this,a,this,this.scene,this.program,this.program.keyboard,this.program.mouse),l.Object3D.prototype.update.call(this,a)},Ga.prototype.dispose=function(){void 0!==this.script.dispose&&this.script.dispose.call(this,this,this.scene,this.program,this.program.keyboard,this.program.mouse),l.Object3D.prototype.dispose.call(this)},Ga.prototype.resize=function(a,r){void 0!==this.script.onResize&&this.script.onResize.call(this,a,r,this,this.scene,this.program,this.program.keyboard,this.program.mouse)},Ga.prototype.appData=function(a){void 0!==this.script.onAppData&&this.script.onAppData.call(this,a,this,this.scene,this.program,this.program.keyboard,this.program.mouse)},Ga.prototype.compileCode=function(a){var r;try{r=(r=od.python_to_js(a)).substring(r.indexOf("\n")+1,r.lastIndexOf("\n"))}catch(b){throw new Error("Failed to transpile python into javascript code.",b)}for(var h=0;h<Gn.METHODS.length;h++){var d=Gn.METHODS[h];r+="\nif(this."+d+' == undefined && typeof $locals___main__["'+d+"\"] !== 'undefined'){this."+d+' = $locals___main__["'+d+'"];}'}var y=new Function(r);try{this.script=new y}catch(b){throw this.script={},console.warn("nunuStudio: Error initializing script code",b),new Error("Error initializing script code")}},Ga.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);return r.object.code=this.code,r};var Hp=__webpack_require__(573),ef=__webpack_require__.n(Hp);function wo(a,r,h,d){if(void 0===a.font)throw new Error("TextBitmap configuration font is required.");void 0===a.width&&(a.width=500),void 0===a.align&&(a.align=wo.CENTER),void 0===a.lineHeight&&(a.lineHeight=a.font.common.lineHeight),void 0===a.letterSpacing&&(a.letterSpacing=5),void 0===a.text&&(a.text=""),this.config=a,this.uniforms={map:{type:"t",value:r},color:{type:"v3",value:new l.Color(void 0!==d?d:16777215)},smoothing:{type:"f",value:0},threshold:{type:"f",value:.4}},l.Mesh.call(this,ef()(this.config),null),this.name="text",this.type="TextBitmap",h=void 0!==h?h:wo.BITMAP;var y=.01;Object.defineProperties(this,{fontScale:{get:function(){return y},set:function(b){y=b,this.updateGeometry()}},shader:{get:function(){return h},set:function(b){h=b,this.updateShader()}},texture:{get:function(){return this.uniforms.map.value},set:function(b){this.uniforms.map.value=b,this.material.needsUpdate=!0}},font:{get:function(){return this.config.font},set:function(b){this.config.font=b,this.updateGeometry()}},text:{get:function(){return this.config.text},set:function(b){this.config.text!==b&&(this.config.text=b,this.updateGeometry())}},lineHeight:{get:function(){return this.config.lineHeight},set:function(b){this.config.lineHeight=b,this.updateGeometry()}},letterSpacing:{get:function(){return this.config.letterSpacing},set:function(b){this.config.letterSpacing=b,this.updateGeometry()}},align:{get:function(){return this.config.align},set:function(b){this.config.align=b,this.updateGeometry()}},width:{get:function(){return this.config.width},set:function(b){this.config.width=b,this.updateGeometry()}},color:{get:function(){return this.uniforms.color.value},set:function(b){this.uniforms.color.value=b}},threshold:{get:function(){return this.uniforms.threshold.value},set:function(b){this.uniforms.threshold.value=b}},smoothing:{get:function(){return this.uniforms.smoothing.value},set:function(b){this.uniforms.smoothing.value=b}}}),this.updateGeometry(),this.updateShader(r)}function Zl(a,r){vi.call(this,"text","TextFile"),this.format="string",this.encoding=void 0!==r?r:"txt",this.data=void 0!==a?a:""}function Ha(a,r,h,d,y,b,R,k,M,H){rh.call(this,Ha.EMPTY_GEOMETRY,r),this.name="text",this.type="TextMesh",this.font=void 0!==h?h:null,this.extruded=void 0===H||H,this.size=void 0!==k?k:1,this.height=void 0!==d?d:.5,this.curveSegments=void 0!==M?M:15,this.bevel=void 0!==y&&y,this.bevelThickness=void 0!==b?b:.1,this.bevelSize=void 0!==R?R:.05,void 0!==a&&(a="text"),Object.defineProperties(this,{text:{get:function(){return a},set:function(X){a!==X&&(a=X,this.updateGeometry())}}}),this.updateGeometry()}(wo.prototype=Object.create(l.Mesh.prototype)).constructor=wo,wo.BITMAP=100,wo.SDF=101,wo.MSDF=102,wo.LEFT="left",wo.CENTER="center",wo.RIGHT="right",wo.prototype.setText=function(a){this.text=a},wo.prototype.updateShader=function(){this.material=new l.ShaderMaterial({uniforms:this.uniforms,fragmentShader:this.shader===wo.SDF?"/**\r\n * Shader object used to render single channel SDF data.\r\n *\r\n * Contains only the fragment shader code, the vertex is the same for every render mode.\r\n * \r\n * Details about signed distance fields for vetorial shapes rendering.\r\n *    - https:// steamcdn-a.akamaihd.net/apps/valve/2007/SIGGRAPH2007_AlphaTestedMagnification.pdf\r\n */\r\nvarying vec2 vUv;\r\nuniform sampler2D map;\r\nuniform vec3 color;\r\nuniform float smoothing;\r\nuniform float threshold;\r\n\r\nvoid main()\r\n{\r\n\tfloat distance = texture2D(map, vUv).a;\r\n\tfloat alpha = smoothstep(threshold - smoothing, threshold + smoothing, distance);\r\n\tgl_FragColor = vec4(color, alpha);\r\n}":this.shader===wo.MSDF?"/*\r\n * Shader object used to render single channel MSDF data.\r\n *\r\n * Contains only the fragment shader code, the vertex is the same for every render mode.\r\n * \r\n * Details about Multi\u2010Channel Signed Distance Fields for vetorial shapes rendering.\r\n *    - https:// onlinelibrary.wiley.com/doi/full/10.1111/cgf.13265\r\n */\r\n\r\nvarying vec2 vUv;\r\nuniform sampler2D map;\r\nuniform vec3 color;\r\nuniform float smoothing;\r\nuniform float threshold;\r\n\r\nfloat median(float r, float g, float b)\r\n{\r\n\treturn max(min(r, g), min(max(r, g), b));\r\n}\r\n\r\nvoid main()\r\n{\r\n\tvec3 smpl = texture2D(map, vUv).rgb;\r\n\tfloat sigDist = median(smpl.r, smpl.g, smpl.b) - 0.5;\r\n\tfloat alpha = clamp(sigDist / fwidth(sigDist) + 0.5, 0.0, 1.0);\r\n\tgl_FragColor = vec4(color, 1.0 - alpha);\r\n}\r\n":"/**\r\n * Shader object used to render the bitmap directly without any processing.\r\n *\r\n * Contains only the fragment shader code, the vertex is the same for every render mode.\r\n */\r\nvarying vec2 vUv;\r\nuniform sampler2D map;\r\n\r\nvoid main()\r\n{\r\n\tgl_FragColor = texture2D(map, vUv);\r\n}\r\n",vertexShader:"/**\r\n * Vertex shader used to draw the text, is responsible for applying the billboard effect by removing the rotation from the transformation matrix.\r\n */\r\n#define BILLBOARD 0 \r\n\r\nvarying vec2 vUv;\r\n\r\nvoid main()\r\n{\r\n\tvUv = uv;\r\n\t\r\n\t#if BILLBOARD\r\n\t\tmat4 model = modelViewMatrix; \r\n\t\tmodel[0][0] = 1.0;\r\n\t\tmodel[0][1] = 0.0;\r\n\t\tmodel[0][2] = 0.0;\r\n\t\t\r\n\t\tmodel[1][0] = 0.0;\r\n\t\tmodel[1][1] = 1.0;\r\n\t\tmodel[1][2] = 0.0;\r\n\t\t\r\n\t\tmodel[2][0] = 0.0;\r\n\t\tmodel[2][1] = 0.0;\r\n\t\tmodel[2][2] = 1.0;\r\n\t\t\r\n\t\tgl_Position = projectionMatrix * model * vec4(position, 1.0);\r\n\t#else\r\n\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\r\n\t#endif\r\n\t\r\n}",side:l.DoubleSide,transparent:!0,depthTest:!0}),this.material.extensions.derivatives=this.shader===wo.MSDF},wo.prototype.updateGeometry=function(){if(this.geometry.update(this.config),1!==this.fontScale)for(var a=this.geometry.attributes.position.array,r=0;r<a.length;r++)a[r]*=this.fontScale},wo.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);return r.object.texture=this.texture.toJSON(a).uuid,r.object.fontScale=this.fontScale,r.object.shader=this.shader,r.object.text=this.text,r.object.font=this.font,r.object.lineHeight=this.lineHeight,r.object.letterSpacing=this.letterSpacing,r.object.align=this.align,r.object.width=this.width,r.object.color=this.color,r.object.threshold=this.threshold,r.object.smoothing=this.smoothing,r},wo.fromJSON=function(a,r){var h=new wo(a,r,a.shader);return h.color=a.color,h.threshold=a.threshold,h.smoothing=a.smoothing,h.fontScale=a.fontScale,h},Zl.prototype=Object.create(vi.prototype),Zl.extensions=[".js",".txt",".glsl",".json",".xml",".yaml",".csv",".css",".html"],Zl.fileIsText=function(a){a=a.name.toLocaleLowerCase();for(var r=0;r<Zl.extensions.length;r++)if(a.endsWith(Zl.extensions[r]))return!0;return!1},Zl.prototype.toJSON=function(a){if(void 0!==a.resources[this.uuid])return a.resources[this.uuid];var r=vi.prototype.toJSON.call(this,a);return r.encoding=this.encoding,r.data=this.data,r.format=this.format,a.resources[this.uuid]=r,r},Ha.prototype=Object.create(rh.prototype),Ha.EMPTY_GEOMETRY=new l.Geometry,Ha.prototype.setFont=function(a){this.font!==a&&(this.font=a,this.updateGeometry())},Ha.prototype.setText=function(a){this.text=a},Ha.prototype.updateGeometry=function(){if(null!==this.font){if(void 0!==this.geometry&&this.geometry.dispose(),!0!==this.font.isFont)return console.warn("nunuStudio: Font parameter is not an instance of Font."),void(this.geometry=Ha.EMPTY_GEOMETRY);var a=this.font.generateShapes(this.text,this.size);this.extruded?(this.geometry=new l.ExtrudeBufferGeometry(a,{curveSegments:this.curveSegments,depth:this.height,bevelEnabled:this.bevel,bevelSize:this.bevelSize,bevelThickness:this.bevelThickness}),this.geometry.computeVertexNormals()):this.geometry=new l.ShapeBufferGeometry(a,this.curveSegments)}},Ha.prototype.clone=function(){return new Ha(this.text,this.material,this.font,this.height,this.bevel,this.bevelThickness,this.bevelSize,this.size,this.curveSegments)},Ha.prototype.toJSON=function(a){var r=this.geometry;this.geometry=void 0;var h=this.font,d=l.Object3D.prototype.toJSON.call(this,a,function(y,b){h=h.toJSON(y)});return d.object.text=this.text,d.object.font=h.uuid,d.object.size=this.size,d.object.curveSegments=this.curveSegments,d.object.height=this.height,d.object.bevel=this.bevel,d.object.bevelThickness=this.bevelThickness,d.object.bevelSize=this.bevelSize,d.object.extruded=this.extruded,this.geometry=r,d};var sd=__webpack_require__(412);function Cu(){l.Mesh.call(this,new l.BufferGeometry,new l.MeshBasicMaterial({depthWrite:!1,colorWrite:!1})),this.name="billboard",this.type="BillboardGroup"}function lh(a){this.manager=void 0!==a?a:l.DefaultLoadingManager,this.textures={}}function Ql(a){this.manager=void 0!==a?a:l.DefaultLoadingManager,this.path="",this.crossOrigin="Anonymous"}function Kl(a,r,h,d,y,b){l.BufferGeometry.call(this),this.type="TerrainBufferGeometry",this.parameters={width:a||1,height:r||1,widthSegments:h||10,heightSegments:d||10,scale:y||1},this.image=b,this.generate()}function Ac(a,r,h,d,y){l.BufferGeometry.call(this),this.type="RoundedBoxBufferGeometry",y=isNaN(y)?1:Math.max(1,Math.floor(y)),a=isNaN(a)?1:a,r=isNaN(r)?1:r,h=isNaN(h)?1:h,d=isNaN(d)?.15:d;var b=a/2-(d=Math.min(d,Math.min(a,Math.min(r,Math.min(h)))/2)),R=r/2-d,k=h/2-d;this.parameters={width:a,height:r,depth:h,radius:d,radiusSegments:y};var et,rt,ut,M=y+1,H=M*y+1<<3,X=new l.BufferAttribute(new Float32Array(3*H),3),oe=new l.BufferAttribute(new Float32Array(3*H),3),ne=[],ge=[],we=(new l.Vector3,new l.Vector3),Se=[],Ce=[],Pe=[],Re=M*y,Oe=Re+1;(function(){for(var et=[new l.Vector3(1,1,1),new l.Vector3(1,1,-1),new l.Vector3(-1,1,-1),new l.Vector3(-1,1,1),new l.Vector3(1,-1,1),new l.Vector3(1,-1,-1),new l.Vector3(-1,-1,-1),new l.Vector3(-1,-1,1)],rt=0;rt<8;rt++)ne.push([]),ge.push([]);for(var ut=Math.PI/2,vt=new l.Vector3(b,R,k),Lt=0;Lt<=y;Lt++){var Kt=Lt/y*ut,zt=Math.cos(Kt),Bt=Math.sin(Kt);if(Lt!==y)for(var $t=0;$t<=y;$t++){var ht=$t/y*ut;we.x=zt*Math.cos(ht),we.y=Bt,we.z=zt*Math.sin(ht),Tt=we.clone().multiplyScalar(d).add(vt),ne[0].push(Tt),Se.push(Tt),Zt=we.clone().normalize(),ge[0].push(Zt),Ce.push(Zt)}else{we.set(0,1,0);var Tt=we.clone().multiplyScalar(d).add(vt);ne[0].push(Tt),Se.push(Tt);var Zt=we.clone();ge[0].push(Zt),Ce.push(Zt)}}for(var un=1;un<8;un++)for(rt=0;rt<ne[0].length;rt++)Tt=ne[0][rt].clone().multiply(et[un]),ne[un].push(Tt),Se.push(Tt),Zt=ge[0][rt].clone().multiply(et[un]),ge[un].push(Zt),Ce.push(Zt)})(),Pe.push(et=Re,rt=Re+Oe,ut=Re+2*Oe,et,ut,Re+3*Oe),Pe.push(et=Re+4*Oe,ut=Re+6*Oe,rt=Re+5*Oe,et,Re+7*Oe,ut),Pe.push(et=0,ut=4*Oe,rt=Oe,rt,ut,5*Oe),Pe.push(et=2*Oe,ut=6*Oe,rt=3*Oe,rt,ut,7*Oe),Pe.push(et=y,rt=y+3*Oe,ut=y+4*Oe,rt,y+7*Oe,ut),Pe.push(et=y+Oe,ut=y+5*Oe,rt=y+2*Oe,rt,ut,y+6*Oe),function(){for(var et=[!0,!1,!0,!1,!1,!0,!1,!0],rt=M*(y-1),ut=0;ut<8;ut++){for(var vt=Oe*ut,Lt=0;Lt<y-1;Lt++)for(var Kt=Lt*M,zt=(Lt+1)*M,Bt=0;Bt<y;Bt++){var $t=Bt+1,ht=vt+Kt+Bt,Tt=vt+Kt+$t,Zt=vt+zt+Bt,un=vt+zt+$t;et[ut]?Pe.push(ht,Zt,Tt,Tt,Zt,un):Pe.push(ht,Tt,Zt,Tt,un,Zt)}for(Bt=0;Bt<y;Bt++)ht=vt+rt+Bt,Tt=vt+rt+Bt+1,Zt=vt+Re,et[ut]?Pe.push(ht,Zt,Tt):Pe.push(ht,Tt,Zt)}}(),function(){for(var et=0;et<4;et++)for(var rt=et*Oe,ut=4*Oe+rt,vt=!0&et,Lt=0;Lt<y;Lt++){var Kt=Lt+1,zt=rt+Lt,Bt=rt+Kt,$t=ut+Lt,ht=ut+Kt;vt?Pe.push(zt,$t,Bt,Bt,$t,ht):Pe.push(zt,Bt,$t,Bt,ht,$t)}}(),function(){for(var et=y-1,rt=[0,1,4,5],ut=[3,2,7,6],vt=[0,1,1,0],Lt=0;Lt<4;Lt++)for(var Kt=rt[Lt]*Oe,zt=ut[Lt]*Oe,Bt=0;Bt<=et;Bt++){var $t=Kt+y+Bt*M,ht=Kt+(Bt!==et?y+(Bt+1)*M:Oe-1),Tt=zt+y+Bt*M,Zt=zt+(Bt!==et?y+(Bt+1)*M:Oe-1);vt[Lt]?Pe.push($t,Tt,ht,ht,Tt,Zt):Pe.push($t,ht,Tt,ht,Zt,Tt)}}(),function(){for(var et=[0,2,4,6],rt=[1,3,5,7],ut=0;ut<4;ut++)for(var vt=Oe*et[ut],Lt=Oe*rt[ut],Kt=1>=ut,zt=0;zt<y;zt++){var Bt=zt*M,$t=(zt+1)*M,ht=vt+Bt,Tt=vt+$t,Zt=Lt+Bt,un=Lt+$t;Kt?Pe.push(ht,Zt,Tt,Tt,Zt,un):Pe.push(ht,Tt,Zt,Tt,un,Zt)}}();for(var Ge=0,ke=0;ke<Se.length;ke++)X.setXYZ(Ge,Se[ke].x,Se[ke].y,Se[ke].z),oe.setXYZ(Ge,Ce[ke].x,Ce[ke].y,Ce[ke].z),Ge++;this.setIndex(new l.BufferAttribute(new Uint16Array(Pe),1)),this.addAttribute("position",X),this.addAttribute("normal",oe)}function ch(a,r,h,d,y,b,R,k,M){l.BufferGeometry.call(this),this.type="CapsuleBufferGeometry",this.parameters={radiusTop:a,radiusBottom:r,height:h,radialSegments:d,heightSegments:y,capsTopSegments:b,capsBottomSegments:R,thetaStart:k,thetaLength:M},a=void 0!==a?a:1,r=void 0!==r?r:1,h=void 0!==h?h:2,d=Math.floor(d)||8,y=Math.floor(y)||1,b=Math.floor(b)||2,R=Math.floor(R)||2,k=void 0!==k?k:0,M=void 0!==M?M:2*Math.PI;var H=Math.acos((r-a)/h),X=(d+1)*(y+1+R+b),oe=d*(y+R+b)*2*3,ne=new l.BufferAttribute(new(oe>65535?Uint32Array:Uint16Array)(oe),1),ge=new l.BufferAttribute(new Float32Array(3*X),3),we=new l.BufferAttribute(new Float32Array(3*X),3),Se=new l.BufferAttribute(new Float32Array(2*X),2),Ce=0,Pe=0,Re=[],Oe=h/2;(function(){var Ge,ke,et=new l.Vector3,rt=new l.Vector3,ut=Math.cos(H),vt=Math.sin(H),Lt=new l.Vector2(a*vt,Oe+a*ut).sub(new l.Vector2(r*vt,r*ut-Oe)).length(),Kt=a*H+Lt+r*(Math.PI/2-H),zt=0;for(ke=0;ke<=b;ke++){var Bt=[],$t=Math.PI/2-H*(ke/b);zt+=a*H/b;var ht=Math.cos($t),Tt=Math.sin($t),Zt=ht*a;for(Ge=0;Ge<=d;Ge++){var un=(Kn=Ge/d)*M+k,Mn=Math.sin(un),wr=Math.cos(un);rt.x=Zt*Mn,rt.y=Oe+Tt*a,rt.z=Zt*wr,ge.setXYZ(Ce,rt.x,rt.y,rt.z),et.set(ht*Mn,Tt,ht*wr),we.setXYZ(Ce,et.x,et.y,et.z),Se.setXY(Ce,Kn,1-zt/Kt),Bt.push(Ce),Ce++}Re.push(Bt)}var Yn=h+ut*a-ut*r,On=vt*(r-a)/Yn;for(ke=1;ke<=y;ke++){for(Bt=[],zt+=Lt/y,Zt=vt*(ke*(r-a)/y+a),Ge=0;Ge<=d;Ge++)un=(Kn=Ge/d)*M+k,Mn=Math.sin(un),wr=Math.cos(un),rt.x=Zt*Mn,rt.y=Oe+ut*a-ke*Yn/y,rt.z=Zt*wr,ge.setXYZ(Ce,rt.x,rt.y,rt.z),et.set(Mn,On,wr).normalize(),we.setXYZ(Ce,et.x,et.y,et.z),Se.setXY(Ce,Kn,1-zt/Kt),Bt.push(Ce),Ce++;Re.push(Bt)}for(ke=1;ke<=R;ke++){for(Bt=[],$t=Math.PI/2-H-(Math.PI-H)*(ke/R),zt+=r*H/R,ht=Math.cos($t),Tt=Math.sin($t),Zt=ht*r,Ge=0;Ge<=d;Ge++){var Kn;un=(Kn=Ge/d)*M+k,Mn=Math.sin(un),wr=Math.cos(un),rt.x=Zt*Mn,rt.y=Tt*r-Oe,rt.z=Zt*wr,ge.setXYZ(Ce,rt.x,rt.y,rt.z),et.set(ht*Mn,Tt,ht*wr),we.setXYZ(Ce,et.x,et.y,et.z),Se.setXY(Ce,Kn,1-zt/Kt),Bt.push(Ce),Ce++}Re.push(Bt)}for(Ge=0;Ge<d;Ge++)for(ke=0;ke<b+y+R;ke++){var Mr=Re[ke+1][Ge],di=Re[ke+1][Ge+1],so=Re[ke][Ge+1];ne.setX(Pe,Re[ke][Ge]),Pe++,ne.setX(Pe,Mr),Pe++,ne.setX(Pe,so),Pe++,ne.setX(Pe,Mr),Pe++,ne.setX(Pe,di),Pe++,ne.setX(Pe,so),Pe++}})(),this.setIndex(ne),this.setAttribute("position",ge),this.setAttribute("normal",we),this.setAttribute("uv",Se)}function Ma(a,r,h){var d=this.compile(a);l.ParametricBufferGeometry.call(this,d,r,h),this.type="ParametricBufferGeometry",this.parameters={code:a,slices:r,stacks:h}}function Kc(a){this.manager=void 0!==a?a:l.DefaultLoadingManager,this.withCredentials=!1}function eu(a){this.manager=void 0!==a?a:l.DefaultLoadingManager,this.shapes={},this.images={}}function Rh(a){this.manager=void 0!==a?a:l.DefaultLoadingManager}function uh(a){this.manager=void 0!==a?a:l.DefaultLoadingManager}function ua(a,r,h,d,y){var b=document.createElement("video");b.autoplay=!0,b.loop=!0,l.Texture.call(this,b,a,r,h,l.LinearFilter,l.LinearFilter,l.RGBFormat,d,y);var R=this;this.generateMipmaps=!1,this.disposed=!1,this.name="webcam",this.category="Webcam",this.mode=ua.USER,this.stream=null,this.connect(),requestAnimationFrame(function k(){b.readyState>=b.HAVE_CURRENT_DATA&&(R.needsUpdate=!0),R.disposed||requestAnimationFrame(k)})}function Aa(a,r){vi.call(this,"video","Video"),void 0!==a&&(a instanceof ArrayBuffer?this.loadArrayBufferData(a,r):ai.isBase64(a)?(this.encoding=ai.getFileFormat(a),this.format="base64",this.data=a):this.loadArrayBufferData(Bn.readFileArrayBuffer(a),Bn.getFileExtension(a)))}function ks(a,r,h,d,y,b){l.Texture.call(this,document.createElement("video"),r,h,d,l.LinearFilter,l.LinearFilter,l.RGBFormat,y,b),this.disposed=!1,this.generateMipmaps=!1,this.name="video",this.category="Video",this.autoplay=!0,this.loop=!0,this.playbackRate=1,this.volume=1,this.image.crossOrigin="anonymous",this.image.autoplay=this.autoplay,this.image.playbackRate=this.playbackRate,this.image.loop=this.loop,this.image.volume=this.volume,this.video=null,this.setVideo(a);var R=this;!function k(){R.disposed||(R.image.readyState>=R.image.HAVE_CURRENT_DATA&&(R.needsUpdate=!0),requestAnimationFrame(k))}()}function Fs(a,r,h,d,y,b,R){vs.call(this,a,y,l.RepeatWrapping,l.RepeatWrapping,l.LinearFilter,l.LinearFilter,l.RGBFormat,b,R),this.name="animation",this.category="SpriteSheet",this.disposed=!1,this.format=this.source.hasTransparency()?l.RGBAFormat:l.RGBFormat,this.repeat.set(1/r,1/h),this.loop=!0,this.animationSpeed=.1,this._totalFrames=d,this._beginFrame=0,this._endFrame=0,this._framesHorizontal=r,this._framesVertical=h;var k=this;Object.defineProperties(this,{framesHorizontal:{get:function(){return this._framesHorizontal},set:function(M){this._framesHorizontal=M,this.repeat.x=1/M,this.totalFrames=this._framesHorizontal*this._framesVertical}},framesVertical:{get:function(){return this._framesVertical},set:function(M){this._framesVertical=M,this.repeat.y=1/M,this.totalFrames=this._framesHorizontal*this._framesVertical}},endFrame:{get:function(){return this._endFrame},set:function(M){M>this._totalFrames&&(M=this._totalFrames),this._endFrame=M}},beginFrame:{get:function(){return this._beginFrame},set:function(M){M<0&&(M=0),this.currentFrame=M,this._beginFrame=M}},totalFrames:{get:function(){return this._totalFrames},set:function(M){this._beginFrame=0,this._endFrame=M,this._totalFrames=M}}}),this.currentFrame=0,function M(){k.disposed||(k.step(),setTimeout(M,1e3*k.animationSpeed))}()}function tu(a,r,h,d,y,b,R,k,M,H,X,oe){l.Texture.call(this,null,b,R,k,M,H,d,y,X,oe),this.category="DataTexture",this.image={data:a||null,width:r||1,height:h||1},this.magFilter=void 0!==M?M:NearestFilter,this.minFilter=void 0!==H?H:NearestFilter,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}function ec(a,r,h,d,y,b,R,k,M,H,X,oe){l.Texture.call(this,null,b,R,k,M,H,d,y,X,oe),this.category="Compressed",this.image={width:r,height:h},this.mipmaps=a,this.isCubeTexture=!1,this.flipY=!1,this.generateMipmaps=!1}function Va(a){this.manager=void 0!==a?a:l.DefaultLoadingManager,this.path="",this.crossOrigin="anonymous",this.images=[],this.videos=[],this.fonts=[]}function Pl(a){this.manager=void 0!==a?a:l.DefaultLoadingManager}function Ao(a){N.call(this),this.manager=void 0!==a?a:l.DefaultLoadingManager,this.texturePath=""}(Cu.prototype=Object.create(l.Mesh.prototype)).constructor=Cu,Cu.prototype.isScene=!0,Cu.prototype.onBeforeRender=function(a,r,h,d,y,b){var R=new sd.Quaternion;h.getWorldQuaternion(R),this.quaternion.copy(R)},lh.prototype.load=function(a,r,h,d){var y=this;new FileLoader(y.manager).load(a,function(b){r(y.parse(JSON.parse(b)))},h,d)},lh.prototype.setTextures=function(a){this.textures=a},lh.prototype.parse=function(a){var r=l.MaterialLoader.prototype.parse.call(this,a);if(void 0!==a.materials)for(var h=0,d=a.materials.length;h<d;h++)r.materials.push(this.parse(a.materials[h]));return r},Ql.prototype.setCrossOrigin=function(a){return this.crossOrigin=a,this},Ql.prototype.setPath=function(a){return this.path=a,this},Ql.prototype.loadJSON=function(a,r,h,d){var y=this;new l.FileLoader(this.manager).load(a,function(b){r(y.parse(JSON.parse(b)))},h,d)},Ql.prototype.parse=function(a){var r=new gs(void 0!==a.data.toArrayBuffer?a.data.toArrayBuffer():a.data,a.encoding);return r.name=a.name,r.uuid=a.uuid,void 0!==a.width&&(r.width=a.width,r.height=a.height),r},Kl.prototype=Object.create(l.BufferGeometry.prototype),Kl.constructor=Kl,Kl.prototype.generate=function(){var a=this.parameters.width,r=this.parameters.height,h=this.parameters.widthSegments,d=this.parameters.heightSegments,y=this.parameters.scale,b=this;this.image.getImageData(function(R,k,M){for(var Zt,un,Mn,H=a/2,X=r/2,oe=Math.floor(h)||1,ne=oe+1,ge=Math.floor(d)||1,we=a/oe,Se=r/ge,Ce=[],Pe=[],Re=[],Oe=[],Ge=k/(a+1),ke=M/(r+1),rt=0;rt<=ge;rt++)for(var ut=rt*Se-X,vt=0;vt<=oe;vt++){var Lt=vt*we-H,Kt=(Zt=ut,void 0,void 0,un=Math.round((Lt+H)*Ge),Mn=Math.round((Zt+X)*ke)*(4*k)+4*un,R.data[Mn]/255*y);Pe.push(Lt,Kt,ut),Re.push(0,1,0),Oe.push(vt/oe),Oe.push(1-rt/ge)}for(rt=0;rt<ge;rt++)for(vt=0;vt<oe;vt++){var Bt=vt+ne*(rt+1),$t=vt+1+ne*(rt+1),ht=vt+1+ne*rt;Ce.push(vt+ne*rt,Bt,ht),Ce.push(Bt,$t,ht)}b.setIndex(Ce),b.setAttribute("position",new l.Float32BufferAttribute(Pe,3)),b.setAttribute("normal",new l.Float32BufferAttribute(Re,3)),b.setAttribute("uv",new l.Float32BufferAttribute(Oe,2)),b.computeVertexNormals(),b.boundingBox=null,b.boundingSphere=null})},Kl.prototype.toJSON=function(){var a=l.BufferGeometry.prototype.toJSON.call(this);return a.image=this.image.uuid,a},Ac.prototype=Object.create(l.BufferGeometry.prototype),Ac.constructor=Ac,(ch.prototype=Object.create(l.BufferGeometry.prototype)).constructor=ch,(Ma.prototype=Object.create(l.ParametricBufferGeometry.prototype)).compile=function(a){try{return new Function("u, v, target","target = target || new Vector3();\n"+a)}catch(r){console.error("nunuStudio: Error occured while compiling ParametricBufferGeometry code.",r)}return function(r,h,d){return d||new l.Vector3}},Kc.prototype.load=function(a,r,h,d){var y=this,b=void 0===this.path?LoaderUtils.extractUrlBase(a):this.path,R=new l.FileLoader(this.manager);R.setPath(this.path),R.setWithCredentials(this.withCredentials),R.load(a,function(k){var M=JSON.parse(k),H=M.metadata;if(void 0!==H){var X=H.type;if(void 0!==X&&"object"===X.toLowerCase())return void console.error("nunuStudio: LegacyGeometryLoader: "+a+" should be loaded with ObjectLoader instead.")}var oe=y.parse(M,b);r(oe.geometry,oe.materials)},h,d)},Kc.prototype.setPath=function(a){return this.path=a,this},Kc.prototype.setResourcePath=function(a){return this.resourcePath=a,this},Kc.prototype.setCrossOrigin=function(a){return this.crossOrigin=a,this},Kc.prototype.parse=function(a,r){void 0!==a.data&&(a=a.data),a.scale=void 0!==a.scale?1/a.scale:1;var h=new l.Geometry;return function(d,y){function b(Kn,dr){return Kn&1<<dr}var R,k,M,H,X,oe,ne,ge,we,Se,Ce,Pe,Re,Oe,Ge,ke,et,rt,ut,vt,Lt,Kt,zt,Bt,$t,ht,Zt=d.faces,un=d.vertices,Mn=d.normals,wr=d.colors,Yn=d.scale,On=0;if(void 0!==d.uvs){for(R=0;R<d.uvs.length;R++)d.uvs[R].length&&On++;for(R=0;R<On;R++)y.faceVertexUvs[R]=[]}for(H=0,X=un.length;H<X;)(rt=new l.Vector3).x=un[H++]*Yn,rt.y=un[H++]*Yn,rt.z=un[H++]*Yn,y.vertices.push(rt);for(H=0,X=Zt.length;H<X;)if(Ce=b(Se=Zt[H++],0),Pe=b(Se,1),Re=b(Se,3),Oe=b(Se,4),Ge=b(Se,5),ke=b(Se,6),et=b(Se,7),Ce){if((vt=new l.Face3).a=Zt[H],vt.b=Zt[H+1],vt.c=Zt[H+3],(Lt=new l.Face3).a=Zt[H+1],Lt.b=Zt[H+2],Lt.c=Zt[H+3],H+=4,Pe&&(we=Zt[H++],vt.materialIndex=we,Lt.materialIndex=we),M=y.faces.length,Re)for(R=0;R<On;R++)for(Bt=d.uvs[R],y.faceVertexUvs[R][M]=[],y.faceVertexUvs[R][M+1]=[],k=0;k<4;k++)ht=Bt[2*(ge=Zt[H++])],$t=new l.Vector2(ht,Bt[2*ge+1]),2!==k&&y.faceVertexUvs[R][M].push($t),0!==k&&y.faceVertexUvs[R][M+1].push($t);if(Oe&&(ne=3*Zt[H++],vt.normal.set(Mn[ne++],Mn[ne++],Mn[ne]),Lt.normal.copy(vt.normal)),Ge)for(R=0;R<4;R++)ne=3*Zt[H++],zt=new l.Vector3(Mn[ne++],Mn[ne++],Mn[ne]),2!==R&&vt.vertexNormals.push(zt),0!==R&&Lt.vertexNormals.push(zt);if(ke&&(Kt=wr[oe=Zt[H++]],vt.color.setHex(Kt),Lt.color.setHex(Kt)),et)for(R=0;R<4;R++)Kt=wr[oe=Zt[H++]],2!==R&&vt.vertexColors.push(new Color(Kt)),0!==R&&Lt.vertexColors.push(new Color(Kt));y.faces.push(vt),y.faces.push(Lt)}else{if((ut=new l.Face3).a=Zt[H++],ut.b=Zt[H++],ut.c=Zt[H++],Pe&&(we=Zt[H++],ut.materialIndex=we),M=y.faces.length,Re)for(R=0;R<On;R++)for(Bt=d.uvs[R],y.faceVertexUvs[R][M]=[],k=0;k<3;k++)ht=Bt[2*(ge=Zt[H++])],$t=new l.Vector2(ht,Bt[2*ge+1]),y.faceVertexUvs[R][M].push($t);if(Oe&&(ne=3*Zt[H++],ut.normal.set(Mn[ne++],Mn[ne++],Mn[ne])),Ge)for(R=0;R<3;R++)ne=3*Zt[H++],zt=new l.Vector3(Mn[ne++],Mn[ne++],Mn[ne]),ut.vertexNormals.push(zt);if(ke&&(oe=Zt[H++],ut.color.setHex(wr[oe])),et)for(R=0;R<3;R++)oe=Zt[H++],ut.vertexColors.push(new Color(wr[oe]));y.faces.push(ut)}}(a,h),function(d,y){var b=void 0!==d.influencesPerVertex?d.influencesPerVertex:2;if(d.skinWeights)for(var R=0,k=d.skinWeights.length;R<k;R+=b)y.skinWeights.push(new Vector4(d.skinWeights[R],b>1?d.skinWeights[R+1]:0,b>2?d.skinWeights[R+2]:0,b>3?d.skinWeights[R+3]:0));if(d.skinIndices)for(R=0,k=d.skinIndices.length;R<k;R+=b)y.skinIndices.push(new Vector4(d.skinIndices[R],b>1?d.skinIndices[R+1]:0,b>2?d.skinIndices[R+2]:0,b>3?d.skinIndices[R+3]:0));y.bones=d.bones,y.bones&&y.bones.length>0&&(y.skinWeights.length!==y.skinIndices.length||y.skinIndices.length!==y.vertices.length)&&console.warn("nunuStudio: When skinning, number of vertices ("+y.vertices.length+"), skinIndices ("+y.skinIndices.length+"), and skinWeights ("+y.skinWeights.length+") should match.")}(a,h),function(d,y){var b=d.scale;if(void 0!==d.morphTargets)for(var R=0,k=d.morphTargets.length;R<k;R++){y.morphTargets[R]={},y.morphTargets[R].name=d.morphTargets[R].name,y.morphTargets[R].vertices=[];for(var M=y.morphTargets[R].vertices,H=d.morphTargets[R].vertices,X=0,oe=H.length;X<oe;X+=3){var ne=new l.Vector3;ne.x=H[X]*b,ne.y=H[X+1]*b,ne.z=H[X+2]*b,M.push(ne)}}if(void 0!==d.morphColors&&d.morphColors.length>0){var ge=y.faces,we=d.morphColors[0].colors;for(R=0,k=ge.length;R<k;R++)ge[R].color.fromArray(we,3*R)}}(a,h),function(d,y){var b=[],R=[];void 0!==d.animation&&R.push(d.animation),void 0!==d.animations&&(d.animations.length?R=R.concat(d.animations):R.push(d.animations));for(var k=0;k<R.length;k++){var M=l.AnimationClip.parseAnimation(R[k],y.bones);M&&b.push(M)}if(y.morphTargets){var H=l.AnimationClip.CreateClipsFromMorphTargetSequences(y.morphTargets,10);b=b.concat(H)}b.length>0&&(y.animations=b)}(a,h),h.computeFaceNormals(),h.computeBoundingSphere(),void 0===a.materials||0===a.materials.length?{geometry:h}:{geometry:h,materials:Loader.prototype.initMaterials(a.materials,this.resourcePath||r,this.crossOrigin)}},eu.prototype.setImages=function(a){return this.images=a,this},eu.prototype.setShapes=function(a){return this.shapes=a,this},eu.prototype.load=function(a,r,h,d){new l.FileLoader(this.manager).load(a,function(y){r(self.parse(JSON.parse(y)))},h,d)},eu.prototype.parse=function(a){var r=null;if("CapsuleBufferGeometry"===a.type)r=new ch(a.radiusTop,a.radiusBottom,a.height,a.radialSegments,a.heightSegments,a.capsTopSegments,a.capsBottomSegments,a.thetaStart,a.thetaLength);else if("RoundedBoxBufferGeometry"===a.type)r=new Ac(a.width,a.height,a.depth,a.radius,a.radiusSegments);else if("TerrainBufferGeometry"===a.type)r=new Kl(a.width,a.height,a.widthSegments,a.heightSegments,a.scale,this.images[a.image]);else if("ParametricBufferGeometry"===a.type)r=new Ma(a.code,a.slices,a.stacks);else if("Geometry"===a.type)r=(new Kc).parse(a.data).geometry;else try{var h=l.ObjectLoader.prototype.parseGeometries([a],this.shapes);for(var d in h){r=h[d];break}}catch(y){console.warn("nunuStudio: Failed to parse geometry",a.type,a.uuid,y),r=new l.BufferGeometry}return r.uuid=a.uuid,r.name=void 0!==a.name?a.name:"geometry",r},Rh.prototype.load=function(a,r,h,d){new l.FileLoader(this.manager).load(a,function(y){r(new An(JSON.parse(y)))},h,d)},Rh.prototype.parse=function(a){if(void 0!==a.data){var r=new An;return r.name=a.name,r.uuid=a.uuid,r.encoding=a.encoding,void 0!==a.reversed&&(r.reversed=a.reversed),"arraybuffer"===a.format?(r.format=a.format,r.data=void 0!==a.data.toArrayBuffer?a.data.toArrayBuffer():a.data,r.loadTTF()):"base64"===a.format?(r.format="arraybuffer",r.data=aa.fromBase64(a.data),r.loadTTF()):(r.format=a.format,r.data=a.data,r.font=a.data),r}return new An(a)},uh.prototype.load=function(a,r,h,d){new l.FileLoader(this.manager).load(a,function(y){r(self.parse(JSON.parse(y)))},h,d)},uh.prototype.parse=function(a){var r=new Dn;return r.name=a.name,r.uuid=a.uuid,r.encoding=a.encoding,"base64"===a.format?(r.format="arraybuffer",r.data=aa.fromBase64(a.data)):"arraybuffer"===a.format?(r.format=a.format,r.data=void 0!==a.data.toArrayBuffer?a.data.toArrayBuffer():a.data):(r.format=a.format,r.data=a.data),r},ua.USER=21,ua.ENVIRONMENT=22,(ua.prototype=Object.create(l.Texture.prototype)).constructor=ua,ua.isTexture=!0,ua.prototype.connect=function(){var a={facingMode:this.mode===ua.USER?"user":{exact:"environment"}},r=this;void 0!==navigator.webkitGetUserMedia&&(navigator.getUserMedia=navigator.webkitGetUserMedia),navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({video:a}).then(function(h){r.stream=h,r.image.srcObject=h,r.image.play()}).catch(function(h){console.warn("nunuStudio: No webcam available")}):navigator.getUserMedia&&navigator.getUserMedia({video:!0},function(h){r.stream=h,r.image.src=URL.createObjectURL(h)},function(h){console.warn("nunuStudio: No webcam available")})},ua.prototype.disconnect=function(){if(null!==this.stream)for(var a=this.stream.getTracks(),r=0;r<a.length;r++)a[r].stop()},ua.prototype.dispose=function(){l.Texture.prototype.dispose.call(this),this.disconnect(),this.disposed=!0,this.image.paused||this.image.pause()},ua.prototype.toJSON=function(a){var r=l.Texture.prototype.toJSON.call(this,a);return r.mode=this.mode,r},Aa.prototype=Object.create(vi.prototype),Aa.fileIsVideo=function(a){return!(void 0===a||!a.type.startsWith("video"))},Aa.prototype.loadArrayBufferData=function(a,r){var h=new Uint8Array(a),d=new Blob([h],{type:"video/"+r});this.data=URL.createObjectURL(d),this.arraybuffer=a,this.encoding=r,this.format="arraybuffer"},Aa.prototype.toJSON=function(a){if(void 0!==a.videos[this.uuid])return a.videos[this.uuid];var r=vi.prototype.toJSON.call(this,a);return r.encoding=this.encoding,"arraybuffer"===this.format?(r.format=this.format,r.data=this.arraybuffer):"base64"===this.format?(r.format="arraybuffer",r.data=aa.fromBase64(ai.removeHeader(this.data))):(r.format=this.format,r.data=this.data),a.videos[this.uuid]=r,r},ks.prototype=Object.create(l.Texture.prototype),ks.isVideoTexture=!0,ks.prototype.setVideo=function(a){if(null==a)return this.video=null,void(this.image.src=null);this.video="string"==typeof a?new Aa(a):a,this.image.src=this.video.data},ks.prototype.setTime=function(a){this.image.currentTime=a},ks.prototype.setLoop=function(a){this.loop=a,this.image.loop=a},ks.prototype.setVolume=function(a){this.volume=a>=0&&a<=1?a:a>=0?1:0,this.image.volume=this.volume},ks.prototype.setAutoPlay=function(a){this.autoplay=a,this.image.autoplay=this.autoplay},ks.prototype.setPlaybackRate=function(a){this.playbackRate=a,this.image.playbackRate=a},ks.prototype.pause=function(){this.image.paused||this.image.pause()},ks.prototype.play=function(){this.image.paused&&this.image.play()},ks.prototype.dispose=function(){l.Texture.prototype.dispose.call(this),this.disposed=!0,this.image.pause(),this.image.src="",this.image.load()},ks.prototype.toJSON=function(a){var r=l.Texture.prototype.toJSON.call(this,a),h=this.video.toJSON(a);return r.video=h.uuid,r.loop=this.loop,r.autoplay=this.autoplay,r.playbackRate=this.playbackRate,r.volume=this.volume,r},Fs.prototype=Object.create(vs.prototype),Fs.isTexture=!0,Fs.prototype.step=function(){this.currentFrame++,this.currentFrame>=this._endFrame&&(this.currentFrame=this._beginFrame),this.offset.x=this.currentFrame%this.framesHorizontal/this.framesHorizontal,this.offset.y=1-this.repeat.y-Math.floor(this.currentFrame/this.framesHorizontal)/this.framesVertical},Fs.prototype.setAnimationSpeed=function(a){this.animationSpeed=a},Fs.prototype.setFrameGrid=function(a,r){this._framesHorizontal=a,this._framesVertical=r,this._totalFrames=a*r,this.repeat.set(1/a,1/r)},Fs.prototype.setAnimationFrames=function(a,r){this.beginFrame=a,this.endFrame=r},Fs.prototype.dispose=function(){vs.prototype.dispose.call(this),this.disposed=!0},Fs.prototype.toJSON=function(a){var r=vs.prototype.toJSON.call(this,a),h=this.source.toJSON(a);return r.image=h.uuid,r.loop=this.loop,r.animationSpeed=this.animationSpeed,r.framesHorizontal=this._framesHorizontal,r.framesVertical=this._framesVertical,r.totalFrames=this._totalFrames,r.beginFrame=this._beginFrame,r.endFrame=this._endFrame,r},(tu.prototype=Object.create(l.Texture.prototype)).constructor=tu,tu.prototype.isDataTexture=!0,tu.prototype.toJSON=function(a){var r=l.Texture.prototype.toJSON.call(this,a);return r.image={height:this.image.height,width:this.image.width,data:Array.from(this.image.data)},r},(ec.prototype=Object.create(l.Texture.prototype)).constructor=ec,ec.prototype.isCompressedTexture=!0,ec.prototype.toJSON=function(a){var r=l.Texture.prototype.toJSON.call(this,a);if(r.isCubeTexture=this.isCubeTexture,this.isCubeTexture){r.image=[];for(var h=0;h<this.image.length;h++){for(var d={mipmaps:[],format:this.image[h].format,width:this.image[h].width,height:this.image[h].height},y=0;y<this.image[h].mipmaps.length;y++)d.mipmaps.push({width:this.image[h].mipmaps[y].width,height:this.image[h].mipmaps[y].height,data:this.image[h].mipmaps[y].data});r.image.push(d)}}else for(r.mipmaps=[],r.width=this.image.width,r.height=this.image.height,y=0;y<this.mipmaps.length;y++)r.mipmaps.push({width:this.mipmaps[y].width,height:this.mipmaps[y].height,data:this.mipmaps[y].data});return r},Va.prototype.setCrossOrigin=function(a){return this.crossOrigin=a,this},Va.prototype.setPath=function(a){return this.path=a,this},Va.prototype.setImages=function(a){return this.images=a,this},Va.prototype.setVideos=function(a){return this.videos=a,this},Va.prototype.setFonts=function(a){return this.fonts=a,this},Va.prototype.load=function(a,r,h,d){try{var y=new vs(this.path+a);return void 0!==r&&r(y),y}catch(b){return void 0!==d&&d(b),console.warn("nunuStudio: Texture not found",b),new vs}},Va.prototype.loadJSON=function(a,r,h,d){var y=this;new l.FileLoader(this.manager).load(a,function(b){y.parse(JSON.parse(b),r)},h,d)},Va.prototype.parse=function(a,r){var h=null,d=a.category;if("Video"===d)void 0===a.video&&console.warn("nunuStudio: TextureLoader, No video specified for",a.uuid),void 0===this.videos[a.video]&&console.warn("nunuStudio: TextureLoader, Undefined video",a.video),(h=new ks(this.videos[a.video])).setLoop(a.loop),h.setAutoPlay(a.autoplay),h.setPlaybackRate(a.playbackRate),h.setVolume(a.volume);else if("Webcam"===d)h=new ua,void 0!==a.mode&&(h.mode=a.mode);else if("Compressed"===d)if(a.isCubeTexture){(h=new ec).image=[],h.isCubeTexture=!0;for(var y=0;y<a.image.length;y++){for(var b=0;b<a.image[y].mipmaps.length;b++)void 0!==a.image[y].mipmaps[b].data.toArrayBuffer&&(a.image[y].mipmaps[b].data=new Uint8Array(a.image[y].mipmaps[b].data.toArrayBuffer()));h.image.push(a.image[y])}}else{for(b=0;b<a.mipmaps.length;b++)void 0!==a.mipmaps[b].data.toArrayBuffer&&(a.mipmaps[b].data=new Uint8Array(a.mipmaps[b].data.toArrayBuffer()));h=new ec(a.mipmaps,a.width,a.height)}else if("Cube"===d){var R=[];for(b=0;b<a.images.length;b++)void 0===this.images[a.images[b]]&&console.warn("nunuStudio: TextureLoader, undefined image",a.images[b]),R.push(this.images[a.images[b]]);(h=new Tr).setImages(R,a.mode),h.setSize(a.size),h.updateImages()}else"Canvas"===d?h=new ll(a.width,a.height):"DataTexture"===d?h=new tu(new Float32Array(a.image.data),a.image.width,a.image.height):(void 0===a.image&&console.warn("nunuStudio: TextureLoader, no image specified for",a.uuid),void 0===this.images[a.image]&&console.warn("nunuStudio: TextureLoader, undefined image",a.image),"SpriteSheet"===d?((h=new Fs(this.images[a.image],a.framesHorizontal,a.framesVertical,a.totalFrames)).loop=a.loop,h.animationSpeed=a.animationSpeed,h.beginFrame=a.beginFrame,h.endFrame=a.endFrame):h=new vs(this.images[a.image]));return h.needsUpdate=!0,h.uuid=a.uuid,h.name=a.name,h.mapping=a.mapping,h.repeat.set(a.repeat[0],a.repeat[1]),h.offset.set(a.offset[0],a.offset[1]),void 0!==a.center&&h.center.set(a.center[0],a.center[1]),void 0!==a.rotation&&(h.rotation=a.rotation),h.wrapS=a.wrap[0],h.wrapT=a.wrap[1],void 0!==a.format&&(h.format=a.format),void 0!==a.type&&(h.type=a.type),void 0!==a.encoding&&(h.encoding=a.encoding),h.minFilter=a.minFilter,h.magFilter=a.magFilter,h.anisotropy=a.anisotropy,h.flipY=a.flipY,void 0!==a.premultiplyAlpha&&(h.premultiplyAlpha=a.premultiplyAlpha),void 0!==a.unpackAlignment&&(h.unpackAlignment=a.unpackAlignment),void 0!==r&&r(h),h},Pl.prototype.load=function(a,r,h,d){var y=this;new l.FileLoader(this.manager).load(a,function(b){r(y.parse(JSON.parse(b)))},h,d)},Pl.prototype.parse=function(a){var r=new Aa(void 0!==a.data.toArrayBuffer?a.data.toArrayBuffer():a.data,a.encoding);return r.name=a.name,r.uuid=a.uuid,r},(Ao.prototype=Object.create(N.prototype)).load=function(a,r,h,d){""===this.texturePath&&(this.texturePath=a.substring(0,a.lastIndexOf("/")+1));var y=this;new l.FileLoader(this.manager).load(a,function(b){y.parse(JSON.parse(b),r)},h,d)},Ao.prototype.parse=function(a,r){this.parseResources(a.resources),this.parseShape(a.shapes),this.parseImages(a.images),this.parseGeometries(a.geometries),this.parseVideos(a.videos),this.parseAudio(a.audio),this.parseFonts(a.fonts),this.parseTextures(a.textures),this.parseMaterials(a.materials);var h=this.parseObject(a.object);return void 0!==a.skeletons&&(this.parseSkeletons(a.skeletons,h),this.bindSkeletons(h)),void 0!==a.images&&0!==a.images.length||void 0!==r&&r(h),h},Ao.prototype.setTexturePath=function(a){this.texturePath=a},Ao.prototype.setCrossOrigin=function(a){this.crossOrigin=a},Ao.prototype.parseResources=function(a){if(void 0!==a)for(var r in a){var h=new Zl(a[r].data,a[r].encoding);h.format=a[r].format,h.name=a[r].name,h.uuid=a[r].uuid,this.resources[h.uuid]=h}return this.resources},Ao.prototype.parseShape=function(a){if(void 0!==a)for(var r=0,h=a.length;r<h;r++){var d=(new Shape).fromJSON(a[r]);this.shapes[d.uuid]=d}return this.shapes},Ao.prototype.parseGeometries=function(a){if(void 0!==a){var r=new eu;r.setShapes(this.shapes),r.setImages(this.images);for(var h=0;h<a.length;h++)this.geometries[a[h].uuid]=r.parse(a[h])}return this.geometries},Ao.prototype.parseMaterials=function(a){if(void 0!==a){var r=new lh;for(var h in r.setTextures(this.textures),a)this.materials[a[h].uuid]=r.parse(a[h])}return this.materials},Ao.prototype.parseImages=function(a){if(void 0!==a){var r=new Ql;for(var h in a)this.images[a[h].uuid]=r.parse(a[h])}return this.images},Ao.prototype.parseVideos=function(a){if(void 0!==a){var r=new Pl;for(var h in a)this.videos[a[h].uuid]=r.parse(a[h])}return this.videos},Ao.prototype.parseAudio=function(a){if(void 0!==a){var r=new uh;for(var h in a)this.audio[a[h].uuid]=r.parse(a[h])}return this.audio},Ao.prototype.parseFonts=function(a){if(void 0!==a){var r=new Rh;for(var h in a)this.fonts[a[h].uuid]=r.parse(a[h])}return this.fonts},Ao.prototype.parseTextures=function(a){if(void 0!==a){var r=new Va;for(var h in r.setImages(this.images),r.setVideos(this.videos),a)this.textures[a[h].uuid]=r.parse(a[h])}return this.textures},Ao.prototype.parseSkeletons=function(a,r){if(void 0!==a)for(var h=0;h<a.length;h++)this.skeletons[a[h].uuid]=l.Skeleton.fromJSON(a[h],r,this);return this.skeletons},Ao.prototype.bindSkeletons=function(a){var r=this;a.traverse(function(h){if(h.isSkinnedMesh&&void 0!==h.skeletonUUID){var d=r.skeletons[h.skeletonUUID];if(void 0===d)return void console.warn("nunuStudio: ObjectLoader Skeleton not found.",h.skeletonUUID);delete h.skeletonUUID,h.bind(d,h.bindMatrix)}})},Ao.prototype.parseObject=function(a){var r;try{switch(a.type){case"SpineAnimation":for(var h=0;h<a.textures.length;h++)a.textures[h].texture=this.getTexture(a.textures[h].texture);r=new Wi(a.json,a.atlas,"",a.textures),void 0!==a.animation&&(r.animation=a.animation,r.track=a.track,r.loop=a.loop),void 0!==a.skin&&(r.skin=a.skin);break;case"Audio":(r=new ni(this.getAudio(a.audio))).autoplay=a.autoplay,r.startTime=a.startTime,r.playbackRate=a.playbackRate,r.loop=void 0!==a.source?a.source.loop:a.loop,void 0!==a.volume&&(r.volume=a.volume);break;case"PositionalAudio":(r=new cr(this.getAudio(a.audio))).autoplay=a.autoplay,r.startTime=a.startTime,r.playbackRate=a.playbackRate,r.loop=void 0!==a.source?a.source.loop:a.loop,void 0!==a.volume&&(r.volume=a.volume),r.distanceModel=a.distanceModel,r.panningModel=a.panningModel;break;case"Physics":r=Xe.fromJSON(a);break;case"ParticleEmiter":r=$o.fromJSON(a,this);break;case"LensFlare":for(r=new Ea,void 0!==a.lensFlares&&(a.elements=a.lensFlares),h=0;h<a.elements.length;h++)r.addFlare(this.getTexture(a.elements[h].texture),a.elements[h].size,a.elements[h].distance,new l.Color(a.elements[h].color));break;case"TextMesh":case"Text3D":r=new Ha(a.text,this.getMaterial(a.material),this.getFont(a.font),a.height,a.bevel,a.bevelThickness,a.bevelSize,a.size,a.curveSegments,a.extruded);break;case"Program":(r=new Qr(a.name)).description=a.description,r.author=a.author,r.version=a.version,r.ar=!0===a.ar,r.vr=a.vr,r.vrScale=a.vrScale,void 0!==a.rendererConfig?r.rendererConfig.fromJSON(a.rendererConfig):(r.rendererConfig.antialiasing=a.antialiasing,r.rendererConfig.shadows=a.shadows,r.rendererConfig.shadowsType=a.shadowsType,r.rendererConfig.toneMapping=a.toneMapping,r.rendererConfig.toneMappingExposure=a.toneMappingExposure),void 0!==a.lockPointer&&(r.lockPointer=a.lockPointer),void 0!==a.defaultScene&&(r.defaultScene=a.defaultScene),void 0!==a.handlePixelRatio&&(r.handlePixelRatio=a.handlePixelRatio);break;case"Sky":if(r=new ns(a.autoUpdate,a.dayTime,a.sunDistance,a.time),void 0!==a.sun&&(r.sun.shadow.fromJSON(a.sun.shadow),void 0!==a.sun.castShadow&&(r.sun.castShadow=a.sun.castShadow)),void 0!==a.colorTop)for(r.colorTop=[],h=0;h<a.colorTop.length;h++)r.colorTop.push(new l.Color(a.colorTop[h]));if(void 0!==a.colorBottom)for(r.colorBottom=[],h=0;h<a.colorBottom.length;h++)r.colorBottom.push(new l.Color(a.colorBottom[h]));void 0!==a.sunColor&&(r.sunColor=a.sunColor),void 0!==a.moonColor&&(r.moonColor=a.moonColor),void 0!==a.intensity&&(r.intensity=a.intensity);break;case"CubeCamera":r=new br(a.near,a.far,a.resolution,a.autoUpdate);break;case"FirstPersonControls":(r=new qc).sensitivity=a.sensitivity,r.needsButtonPressed=a.needsButtonPressed,r.movementEnabled=a.movementEnabled,r.moveSpeed=a.moveSpeed,r.moveOnPlane=a.moveOnPlane,r.moveKeys=a.moveKeys;break;case"OrbitControls":(r=new je).distance=a.distance,r.maxDistance=a.maxDistance,r.minDistance=a.minDistance,r.sensitivity=a.sensitivity,r.limitUp=a.limitUp,r.limitDown=a.limitDown,r.needsButtonPressed=a.needsButtonPressed,r.zoomEnabled=a.zoomEnabled,r.movementEnabled=a.movementEnabled,void 0!==a.smooth&&(r.smooth=a.smooth,r.friction=a.friction,r.speed=a.speed,r.invertNavigation=a.invertNavigation),void 0!==a.center&&(r.center.fromArray(a.center),r.vector.fromArray(a.vector));break;case"Scene":r=new bs,void 0!==a.background&&(r.background=Number.isInteger(a.background)?new l.Color(a.background):this.getTexture(a.background)),void 0!==a.environment&&(r.environment=this.getTexture(a.environment)),void 0!==a.fog&&("Fog"===a.fog.type?r.fog=new l.Fog(a.fog.color,a.fog.near,a.fog.far):"FogExp2"===a.fog.type&&(r.fog=new l.FogExp2(a.fog.color,a.fog.density))),void 0!==a.defaultCamera&&(r.defaultCamera=this.parse(a.defaultCamera)),void 0!==a.cameras&&(r.cameras=a.cameras),void 0!==a.usePhysics&&(r.usePhysics=a.usePhysics),void 0!==a.world&&(r.world.gravity.set(a.world.gravity.x,a.world.gravity.y,a.world.gravity.z),r.world.quatNormalizeSkip=a.world.quatNormalizeSkip,r.world.quatNormalizeFast=a.world.quatNormalizeFast,r.world.solver.tolerance=a.world.solver.tolerance,r.world.solver.iterations=a.world.solver.iterations);break;case"PerspectiveCamera":r=new Ue(a.fov,a.aspect,a.near,a.far),void 0!==a.focus&&(r.focus=a.focus),void 0!==a.zoom&&(r.zoom=a.zoom),void 0!==a.filmGauge&&(r.filmGauge=a.filmGauge),void 0!==a.filmOffset&&(r.filmOffset=a.filmOffset),void 0!==a.view&&(r.view=Object.assign({},a.view)),void 0!==a.viewport&&(a.viewport instanceof Array?(r.viewport.size.fromArray(a.viewport),r.viewport.offset.fromArray(a.offset)):r.viewport.fromJSON(a.viewport)),void 0!==a.clearColor&&(r.clearColor=a.clearColor),void 0!==a.clearDepth&&(r.clearDepth=a.clearDepth),void 0!==a.clearStencil&&(r.clearStencil=a.clearStencil),void 0!==a.order&&(r.order=a.order),void 0!==a.composer&&(r.composer=Mo.fromJSON(a.composer));break;case"OrthographicCamera":r=new xe(a.size,a.aspect,a.mode,a.near,a.far),void 0!==a.viewport&&(a.viewport instanceof Array?(r.viewport.size.fromArray(a.viewport),r.viewport.offset.fromArray(a.offset)):r.viewport.fromJSON(a.viewport)),void 0!==a.clearColor&&(r.clearColor=a.clearColor),void 0!==a.clearDepth&&(r.clearDepth=a.clearDepth),void 0!==a.clearStencil&&(r.clearStencil=a.clearStencil),void 0!==a.order&&(r.order=a.order),void 0!==a.composer&&(r.composer=Mo.fromJSON(a.composer)),void 0!==a.zoom&&(r.zoom=a.zoom),void 0!==a.view&&(r.view=Object.assign({},a.view));break;case"Script":r=new Gn(a.code,a.mode);break;case"PythonScript":r=new Ga(a.code);break;case"NodeScript":(r=new NodeScript).graph=Object2D.parse(a.graph);break;case"RectAreaLight":r=new Pr(a.color,a.intensity,a.width,a.height);break;case"AmbientLight":r=new $s(a.color,a.intensity);break;case"DirectionalLight":r=new rl(a.color,a.intensity);break;case"PointLight":r=new yt(a.color,a.intensity,a.distance,a.decay);break;case"SpotLight":r=new Mc(a.color,a.intensity,a.distance,a.angle,a.penumbra,a.decay);break;case"HemisphereLight":r=new Tu(a.color,a.groundColor,a.intensity);break;case"HTMLView":(r=new Xl).height=a.height,r.width=a.width,r.url=a.url;break;case"LightProbe":(r=new Xc).sh.fromArray(a.sh);break;case"InstancedMesh":(r=new ls(this.getGeometry(a.geometry),this.getMaterial(a.material),a.count)).instanceMatrix=new l.BufferAttribute(new Float32Array(a.instanceMatrix.array),16);break;case"SkinnedMesh":r=new Zi(this.getGeometry(a.geometry),this.getMaterial(a.material)),void 0!==a.skeleton&&(r.skeletonUUID=a.skeleton),void 0!==a.bindMode&&(r.bindMode=a.bindMode),void 0!==a.bindMatrix&&r.bindMatrix.fromArray(a.bindMatrix);break;case"Mesh":r=new rh(this.getGeometry(a.geometry),this.getMaterial(a.material));break;case"TextBitmap":r=wo.fromJSON(a,this.getTexture(a.texture));break;case"TextSprite":r=ys.fromJSON(a);break;case"LOD":r=new l.LOD;break;case"Line":r=new l.Line(this.getGeometry(a.geometry),this.getMaterial(a.material),a.mode);break;case"LineLoop":r=new l.LineLoop(this.getGeometry(a.geometry),this.getMaterial(a.material));break;case"LineSegments":r=new l.LineSegments(this.getGeometry(a.geometry),this.getMaterial(a.material));break;case"PointCloud":case"Points":r=new l.Points(this.getGeometry(a.geometry),this.getMaterial(a.material));break;case"Sprite":r=new ca(this.getMaterial(a.material));break;case"Measurement":r=Ie.fromJSON(a);break;case"Group":default:r=new Eu;break;case"BillboardGroup":r=new Cu;break;case"Bone":r=new l.Bone}}catch(H){console.error("nunuStudio: Error parsing and creating object "+a.uuid+", object skiped.",H,a),r=new Eu}if(r.uuid=a.uuid,r.name=a.name,r.locked=!0===a.locked||!0===a.hidden,r.folded=!0===a.folded,void 0!==a.frustumCulled&&(r.frustumCulled=a.frustumCulled),void 0!==a.renderOrder&&(r.renderOrder=a.renderOrder),void 0!==a.animations)for(r.animations=[],h=0;h<a.animations.length;h++){var d=l.AnimationClip.parse(a.animations[h]);void 0!==a.animations[h].uuid&&(d.uuid=a.animations[h].uuid),r.animations.push(d)}if(void 0!==a.matrix&&(r.matrix.fromArray(a.matrix),r.matrix.decompose(r.position,r.quaternion,r.scale)),void 0!==a.position&&r.position.fromArray(a.position),void 0!==a.rotation&&r.rotation.fromArray(a.rotation),void 0!==a.quaternion&&r.quaternion.fromArray(a.quaternion),void 0!==a.scale&&r.scale.fromArray(a.scale),r.castShadow=!0===a.castShadow,r.receiveShadow=!0===a.receiveShadow,void 0!==a.shadow&&r.shadow.fromJSON(a.shadow),r.visible=!0===a.visible,void 0!==a.userData&&(r.userData=a.userData),void 0!==a.layers&&(r.layers.mask=a.layers),void 0!==a.children)for(var y in a.children)r.add(this.parseObject(a.children[y]));if(void 0!==a.matrixAutoUpdate&&(r.matrixAutoUpdate=a.matrixAutoUpdate,r.matrixAutoUpdate||(r.updateMatrix(),r.updateMatrixWorld(!0))),"Program"===a.type)r.copyResources(this);else if("Scene"===a.type)for(h=0;h<r.cameras.length;h++){var b=r.getCamera(r.cameras[h]);null!==b?r.cameras[h]=b:r.cameras.splice(h,1)}else if("LOD"===a.type)for(var R=a.levels,k=0;k<R.length;k++){var M=R[k];void 0!==(y=r.getObjectByProperty("uuid",M.object))&&r.addLevel(y,M.distance)}return r};const Vp="// All uniforms used by vertex / fragment shaders\r\nuniform float deltaTime;\r\nuniform float runTime;\r\nuniform sampler2D textureSampler;\r\nuniform vec4 textureAnimation;\r\nuniform float scale;\r\n",$d="varying vec4 vColor;\r\n\r\n#ifdef SHOULD_ROTATE_TEXTURE\r\n    varying float vAngle;\r\n#endif\r\n\r\n#ifdef SHOULD_CALCULATE_SPRITE\r\n    varying vec4 vSpriteSheet;\r\n#endif",nu="// Branch-avoiding comparison fns\r\n//- http:// theorangeduck.com/page/avoiding-shader-conditionals\r\nfloat when_gt(float x, float y) {\r\n    return max(sign(x - y), 0.0);\r\n}\r\n\r\nfloat when_lt(float x, float y) {\r\n    return min(max(1.0 - sign(x - y), 0.0), 1.0);\r\n}\r\n\r\nfloat when_eq(float x, float y) {\r\n    return 1.0 - abs(sign(x - y));\r\n}\r\n\r\nfloat when_ge(float x, float y) {\r\n  return 1.0 - when_lt(x, y);\r\n}\r\n\r\nfloat when_le(float x, float y) {\r\n  return 1.0 - when_gt(x, y);\r\n}\r\n\r\n// Branch-avoiding logical operators (to be used with above comparison fns)\r\nfloat and(float a, float b) {\r\n    return a * b;\r\n}\r\n\r\nfloat or(float a, float b) {\r\n    return min(a + b, 1.0);\r\n}";var Ph={vertex:["// Register color-packing define statements.\r\n#define PACKED_COLOR_SIZE 256.0\r\n#define PACKED_COLOR_DIVISOR 255.0",Vp,"// All attributes used by the vertex shader.\r\n//\r\n// Note that some attributes are squashed into other ones\r\n//\r\n// Drag is stored in acceleration.w\r\nattribute vec4 acceleration;\r\nattribute vec3 velocity;\r\nattribute vec4 rotation;\r\nattribute vec3 rotationCenter;\r\nattribute vec4 params;\r\nattribute vec4 size;\r\nattribute vec4 angle;\r\nattribute vec4 color;\r\nattribute vec4 opacity;",$d,l.ShaderChunk.common,l.ShaderChunk.logdepthbuf_pars_vertex,l.ShaderChunk.fog_pars_vertex,nu,"// From:\r\n//- http:// stackoverflow.com/a/12553149\r\n//- https:// stackoverflow.com/questions/22895237/hexadecimal-to-rgb-values-in-webgl-shader\r\n// unpackColor\r\nvec3 unpackColor(in float hex) {\r\n    vec3 c = vec3(0.0);\r\n\r\n    float r = mod((hex / PACKED_COLOR_SIZE / PACKED_COLOR_SIZE), PACKED_COLOR_SIZE);\r\n    float g = mod((hex / PACKED_COLOR_SIZE), PACKED_COLOR_SIZE);\r\n    float b = mod(hex, PACKED_COLOR_SIZE);\r\n\r\n    c.r = r / PACKED_COLOR_DIVISOR;\r\n    c.g = g / PACKED_COLOR_DIVISOR;\r\n    c.b = b / PACKED_COLOR_DIVISOR;\r\n\r\n    return c;\r\n}\r\n\r\n// unpackRotationAxis\r\nvec3 unpackRotationAxis(in float hex) {\r\n    vec3 c = vec3(0.0);\r\n\r\n    float r = mod((hex / PACKED_COLOR_SIZE / PACKED_COLOR_SIZE), PACKED_COLOR_SIZE);\r\n    float g = mod((hex / PACKED_COLOR_SIZE), PACKED_COLOR_SIZE);\r\n    float b = mod(hex, PACKED_COLOR_SIZE);\r\n\r\n    c.r = r / PACKED_COLOR_DIVISOR;\r\n    c.g = g / PACKED_COLOR_DIVISOR;\r\n    c.b = b / PACKED_COLOR_DIVISOR;\r\n\r\n    c *= vec3(2.0);\r\n    c -= vec3(1.0);\r\n\r\n    return c;\r\n}\r\n\r\n// floatOverLifetime:\r\nfloat getFloatOverLifetime(in float positionInTime, in vec4 attr) {\r\n    highp float value = 0.0;\r\n    float deltaAge = positionInTime * float(VALUE_OVER_LIFETIME_LENGTH - 1);\r\n    float fIndex = 0.0;\r\n    float shouldApplyValue = 0.0;\r\n\r\n    // This might look a little odd, but it's faster in the testing I\"ve done than using branches. Uses basic maths to avoid branching.\r\n    //\r\n    // Take a look at the branch-avoidance functions defined above, and be sure to check out The Orange Duck site where I got this from (link above).\r\n    //\r\n    // Fix for static emitters (age is always zero).\r\n    value += attr[0] * when_eq(deltaAge, 0.0);\r\n\r\n    for(int i = 0; i < VALUE_OVER_LIFETIME_LENGTH - 1; ++i) {\r\n        fIndex = float(i);\r\n        shouldApplyValue = and(when_gt(deltaAge, fIndex), when_le(deltaAge, fIndex + 1.0));\r\n        value += shouldApplyValue * mix(attr[i], attr[i + 1], deltaAge - fIndex);\r\n    }\r\n\r\n    return value;\r\n}\r\n\r\n// colorOverLifetime\r\nvec3 getColorOverLifetime(in float positionInTime, in vec3 color1, in vec3 color2, in vec3 color3, in vec3 color4) {\r\n    vec3 value = vec3(0.0);\r\n    value.x = getFloatOverLifetime(positionInTime, vec4(color1.x, color2.x, color3.x, color4.x));\r\n    value.y = getFloatOverLifetime(positionInTime, vec4(color1.y, color2.y, color3.y, color4.y));\r\n    value.z = getFloatOverLifetime(positionInTime, vec4(color1.z, color2.z, color3.z, color4.z));\r\n    return value;\r\n}\r\n\r\n// paramFetchingFunctions\r\nfloat getAlive() {\r\n    return params.x;\r\n}\r\n\r\nfloat getAge() {\r\n    return params.y;\r\n}\r\n\r\nfloat getMaxAge() {\r\n    return params.z;\r\n}\r\n\r\nfloat getWiggle() {\r\n    return params.w;\r\n}\r\n\r\n// forceFetchingFunctions\r\nvec4 getPosition(in float age) {\r\n    return modelViewMatrix * vec4(position, 1.0);\r\n}\r\n\r\nvec3 getVelocity(in float age) {\r\n    return velocity * age;\r\n}\r\n\r\nvec3 getAcceleration(in float age) {\r\n    return acceleration.xyz * age;\r\n}\r\n\r\n\r\n// rotationFunctions\r\n// Huge thanks to:\r\n//- http:// www.neilmendoza.com/glsl-rotation-about-an-arbitrary-axis/\r\n#ifdef SHOULD_ROTATE_PARTICLES\r\nmat4 getRotationMatrix(in vec3 axis, in float angle) {\r\n   axis = normalize(axis);\r\n   float s = sin(angle);\r\n   float c = cos(angle);\r\n   float oc = 1.0 - c;\r\n\r\n   return mat4(oc * axis.x * axis.x + c,           oc * axis.x * axis.y - axis.z * s,  oc * axis.z * axis.x + axis.y * s,  0.0,\r\n               oc * axis.x * axis.y + axis.z * s,  oc * axis.y * axis.y + c,           oc * axis.y * axis.z - axis.x * s,  0.0,\r\n               oc * axis.z * axis.x - axis.y * s,  oc * axis.y * axis.z + axis.x * s,  oc * axis.z * axis.z + c,           0.0,\r\n               0.0,                                0.0,                                0.0,                                1.0);\r\n}\r\n\r\nvec3 getRotation(in vec3 pos, in float positionInTime) {\r\n  if(rotation.y == 0.0) {\r\n       return pos;\r\n  }\r\n\r\n  vec3 axis = unpackRotationAxis(rotation.x);\r\n  vec3 center = rotationCenter;\r\n  vec3 translated;\r\n  mat4 rotationMatrix;\r\n\r\n  float angle = 0.0;\r\n  angle += when_eq(rotation.z, 0.0) * rotation.y;\r\n  angle += when_gt(rotation.z, 0.0) * mix(0.0, rotation.y, positionInTime);\r\n  translated = rotationCenter - pos;\r\n  rotationMatrix = getRotationMatrix(axis, angle);\r\n  return center - vec3(rotationMatrix * vec4(translated, 0.0));\r\n}\r\n#endif\r\n","void main() {","// Setup\r\nhighp float age = getAge();\r\nhighp float alive = getAlive();\r\nhighp float maxAge = getMaxAge();\r\nhighp float positionInTime = (age / maxAge);\r\nhighp float isAlive = when_gt(alive, 0.0);\r\n#ifdef SHOULD_WIGGLE_PARTICLES\r\n\tfloat wiggleAmount = positionInTime * getWiggle();\r\n\tfloat wiggleSin = isAlive * sin(wiggleAmount);\r\n\tfloat wiggleCos = isAlive * cos(wiggleAmount);\r\n#endif\r\n\r\n// Forces\r\n// Get forces & position\r\nvec3 vel = getVelocity(age);\r\nvec3 accel = getAcceleration(age);\r\nvec3 force = vec3(0.0);\r\nvec3 pos = vec3(position);\r\n\r\n// Calculate the required drag to apply to the forces.\r\nfloat drag = 1.0 - (positionInTime * 0.5) * acceleration.w;\r\n\r\n// Integrate forces\r\nforce += vel;\r\nforce *= drag;\r\nforce += accel * age;\r\npos += force;\r\n\r\n// Wiggly wiggly wiggle!\r\n#ifdef SHOULD_WIGGLE_PARTICLES\r\n\tpos.x += wiggleSin;\r\n\tpos.y += wiggleCos;\r\n\tpos.z += wiggleSin;\r\n#endif\r\n\r\n// Rotate the emitter around it's central point\r\n#ifdef SHOULD_ROTATE_PARTICLES\r\n\tpos = getRotation(pos, positionInTime);\r\n#endif\r\n\r\n// Convert pos to a world-space value\r\nvec4 mvPosition = modelViewMatrix * vec4(pos, 1.0);\r\n\r\n// Determine point size.\r\nhighp float pointSize = getFloatOverLifetime(positionInTime, size) * isAlive;\r\n\r\n// Determine perspective\r\n#ifdef HAS_PERSPECTIVE\r\n\tfloat perspective = scale / length(mvPosition.xyz);\r\n#else\r\n\tfloat perspective = 1.0;\r\n#endif\r\n\r\n// Apply perpective to pointSize value\r\nfloat pointSizePerspective = pointSize * perspective;\r\n\r\n// Determine color and opacity for this particle\r\n#ifdef COLORIZE\r\n\tvec3 c = isAlive * getColorOverLifetime(\r\n\t\tpositionInTime,\r\n\t\tunpackColor(color.x),\r\n\t\tunpackColor(color.y),\r\n\t\tunpackColor(color.z),\r\n\t\tunpackColor(color.w)\r\n\t);\r\n#else\r\n\tvec3 c = vec3(1.0);\r\n#endif\r\n\r\nfloat o = isAlive * getFloatOverLifetime(positionInTime, opacity);\r\n\r\n// Assign color to vColor varying.\r\nvColor = vec4(c, o);\r\n\r\n// Determine angle\r\n#ifdef SHOULD_ROTATE_TEXTURE\r\n\tvAngle = isAlive * getFloatOverLifetime(positionInTime, angle);\r\n#endif\r\n\r\n// If this particle is using a sprite-sheet as a texture, we\"ll have to figure out what frame of the texture the particle is using at it's current position in time.\r\n#ifdef SHOULD_CALCULATE_SPRITE\r\n\tfloat framesX = textureAnimation.x;\r\n\tfloat framesY = textureAnimation.y;\r\n\tfloat loopCount = textureAnimation.w;\r\n\tfloat totalFrames = textureAnimation.z;\r\n\tfloat frameNumber = mod((positionInTime * loopCount) * totalFrames, totalFrames);\r\n\r\n\tfloat column = floor(mod(frameNumber, framesX));\r\n\tfloat row = floor((frameNumber - column) / framesX);\r\n\r\n\tfloat columnNorm = column / framesX;\r\n\tfloat rowNorm = row / framesY;\r\n\r\n\tvSpriteSheet.x = 1.0 / framesX;\r\n\tvSpriteSheet.y = 1.0 / framesY;\r\n\tvSpriteSheet.z = columnNorm;\r\n\tvSpriteSheet.w = rowNorm;\r\n#endif\r\n\r\n// Write values\r\n// Set PointSize according to size at current point in time.\r\ngl_PointSize = pointSizePerspective;\r\ngl_Position = projectionMatrix * mvPosition;",l.ShaderChunk.logdepthbuf_vertex,l.ShaderChunk.fog_vertex,"}"].join("\n"),fragment:[Vp,l.ShaderChunk.common,l.ShaderChunk.fog_pars_fragment,l.ShaderChunk.logdepthbuf_pars_fragment,$d,nu,"void main() {","    vec3 outgoingLight = vColor.xyz;","    ","    #ifdef ALPHATEST","       if(vColor.w < float(ALPHATEST)) discard;","    #endif","// Rotate Texture\r\nvec2 vUv = vec2(gl_PointCoord.x, 1.0 - gl_PointCoord.y);\r\n\r\n#ifdef SHOULD_ROTATE_TEXTURE\r\n   float x = gl_PointCoord.x - 0.5;\r\n   float y = 1.0 - gl_PointCoord.y - 0.5;\r\n   float c = cos(-vAngle);\r\n   float s = sin(-vAngle);\r\n\r\n   vUv = vec2(c * x + s * y + 0.5, c * y - s * x + 0.5);\r\n#endif\r\n\r\n// Spritesheets overwrite angle calculations.\r\n#ifdef SHOULD_CALCULATE_SPRITE\r\n    float framesX = vSpriteSheet.x;\r\n    float framesY = vSpriteSheet.y;\r\n    float columnNorm = vSpriteSheet.z;\r\n    float rowNorm = vSpriteSheet.w;\r\n\r\n    vUv.x = gl_PointCoord.x * framesX + columnNorm;\r\n    vUv.y = 1.0 - (gl_PointCoord.y * framesY + rowNorm);\r\n#endif\r\n\r\nvec4 rotatedTexture = texture2D(textureSampler, vUv);\r\n",l.ShaderChunk.logdepthbuf_fragment,"    outgoingLight = vColor.xyz * rotatedTexture.xyz;","    gl_FragColor = vec4(outgoingLight.xyz, rotatedTexture.w * vColor.w);",l.ShaderChunk.fog_fragment,"}"].join("\n")};function ji(a,r,h,d){this.componentSize=h||1,this.size=r||1,this.TypedArrayConstructor=a||Float32Array,this.array=new a(r*this.componentSize),this.indexOffset=d||0}function Yo(a,r,h){this.type="string"==typeof a&&Yo.typeSizeMap.hasOwnProperty(a)?a:"f",this.componentSize=Yo.typeSizeMap[this.type],this.arrayType=h||Float32Array,this.typedArray=null,this.bufferAttribute=null,this.dynamicBuffer=!!r,this.updateMin=0,this.updateMax=0}ji.constructor=ji,ji.prototype.setSize=function(a,r){var h=this.array.length;return r||(a*=this.componentSize),a<h?this.shrink(a):a>h?this.grow(a):void 0},ji.prototype.shrink=function(a){return this.array=this.array.subarray(0,a),this.size=a,this},ji.prototype.grow=function(a){var r=this.array,h=new this.TypedArrayConstructor(a);return h.set(r),this.array=h,this.size=a,this},ji.prototype.splice=function(a,r){a*=this.componentSize,r*=this.componentSize;for(var h=[],d=this.array,y=d.length,b=0;b<y;++b)(b<a||b>=r)&&h.push(d[b]);return this.setFromArray(0,h),this},ji.prototype.setFromArray=function(a,r){var h=a+r.length;return h>this.array.length?this.grow(h):h<this.array.length&&this.shrink(h),this.array.set(r,this.indexOffset+a),this},ji.prototype.setVec2=function(a,r){return this.setVec2Components(a,r.x,r.y)},ji.prototype.setVec2Components=function(a,r,h){var d=this.array,y=this.indexOffset+a*this.componentSize;return d[y]=r,d[y+1]=h,this},ji.prototype.setVec3=function(a,r){return this.setVec3Components(a,r.x,r.y,r.z)},ji.prototype.setVec3Components=function(a,r,h,d){var y=this.array,b=this.indexOffset+a*this.componentSize;return y[b]=r,y[b+1]=h,y[b+2]=d,this},ji.prototype.setVec4=function(a,r){return this.setVec4Components(a,r.x,r.y,r.z,r.w)},ji.prototype.setVec4Components=function(a,r,h,d,y){var b=this.array,R=this.indexOffset+a*this.componentSize;return b[R]=r,b[R+1]=h,b[R+2]=d,b[R+3]=y,this},ji.prototype.setMat3=function(a,r){return this.setFromArray(this.indexOffset+a*this.componentSize,r.elements)},ji.prototype.setMat4=function(a,r){return this.setFromArray(this.indexOffset+a*this.componentSize,r.elements)},ji.prototype.setColor=function(a,r){return this.setVec3Components(a,r.r,r.g,r.b)},ji.prototype.setNumber=function(a,r){return this.array[this.indexOffset+a*this.componentSize]=r,this},ji.prototype.getValueAtIndex=function(a){return this.array[this.indexOffset+a]},ji.prototype.getComponentValueAtIndex=function(a){return this.array.subarray(this.indexOffset+a*this.componentSize)},Yo.constructor=Yo,Yo.typeSizeMap={f:1,v2:2,v3:3,v4:4,c:3,m3:9,m4:16},Yo.prototype.setUpdateRange=function(a,r){this.updateMin=Math.min(a*this.componentSize,this.updateMin*this.componentSize),this.updateMax=Math.max(r*this.componentSize,this.updateMax*this.componentSize)},Yo.prototype.flagUpdate=function(){var a=this.bufferAttribute.updateRange;a.offset=this.updateMin,a.count=Math.min(this.updateMax-this.updateMin+this.componentSize,this.typedArray.array.length),this.bufferAttribute.needsUpdate=!0},Yo.prototype.resetUpdateRange=function(){this.updateMin=0,this.updateMax=0},Yo.prototype.resetDynamic=function(){this.bufferAttribute.usage=this.dynamicBuffer?l.DynamicDrawUsage:l.StaticDrawUsage},Yo.prototype.splice=function(a,r){this.typedArray.splice(a,r),this.forceUpdateAll()},Yo.prototype.forceUpdateAll=function(){this.bufferAttribute.array=this.typedArray.array,this.bufferAttribute.updateRange.offset=0,this.bufferAttribute.updateRange.count=-1,this.bufferAttribute.usage=l.StaticDrawUsage,this.bufferAttribute.needsUpdate=!0},Yo.prototype._ensureTypedArray=function(a){null!==this.typedArray&&this.typedArray.size===a*this.componentSize||(null!==this.typedArray&&this.typedArray.size!==a?this.typedArray.setSize(a):null===this.typedArray&&(this.typedArray=new ji(this.arrayType,a,this.componentSize)))},Yo.prototype._createBufferAttribute=function(a){if(this._ensureTypedArray(a),null!==this.bufferAttribute)return this.bufferAttribute.array=this.typedArray.array,this.bufferAttribute.count=this.bufferAttribute.array.length/this.bufferAttribute.itemSize,void(this.bufferAttribute.needsUpdate=!0);this.bufferAttribute=new l.BufferAttribute(this.typedArray.array,this.componentSize),this.bufferAttribute.usage=this.dynamicBuffer?l.DynamicDrawUsage:l.StaticDrawUsage},Yo.prototype.getLength=function(){return null===this.typedArray?0:this.typedArray.array.length};var ru,Ut={types:{BOOLEAN:"boolean",STRING:"string",NUMBER:"number",OBJECT:"object"},ensureTypedArg:function(a,r,h){return typeof a===r?a:h},ensureArrayTypedArg:function(a,r,h){if(Array.isArray(a)){for(var d=a.length-1;d>=0;--d)if(typeof a[d]!==r)return h;return a}return this.ensureTypedArg(a,r,h)},ensureInstanceOf:function(a,r,h){return void 0!==r&&a instanceof r?a:h},ensureArrayInstanceOf:function(a,r,h){if(Array.isArray(a)){for(var d=a.length-1;d>=0;--d)if(void 0!==r&&a[d]instanceof r==0)return h;return a}return this.ensureInstanceOf(a,r,h)},ensureValueOverLifetimeCompliance:function(a,r,h){r=r||3,h=h||3,!1===Array.isArray(a._value)&&(a._value=[a._value]),!1===Array.isArray(a._spread)&&(a._spread=[a._spread]);var d=this.clamp(a._value.length,r,h),y=this.clamp(a._spread.length,r,h),b=Math.max(d,y);a._value.length!==b&&(a._value=this.interpolateArray(a._value,b)),a._spread.length!==b&&(a._spread=this.interpolateArray(a._spread,b))},interpolateArray:function(a,r){for(var h=a.length,d=["function"==typeof a[0].clone?a[0].clone():a[0]],y=(h-1)/(r-1),b=1;b<r-1;++b){var R=b*y,k=Math.floor(R),M=Math.ceil(R);d[b]=this.lerpTypeAgnostic(a[k],a[M],R-k)}return d.push("function"==typeof a[h-1].clone?a[h-1].clone():a[h-1]),d},clamp:function(a,r,h){return Math.max(r,Math.min(a,h))},zeroToEpsilon:function(a,r){var h=1e-5,d=a;return d=r?Math.random()*h*10:h,a<0&&a>-1e-5&&(d=-d),d},lerpTypeAgnostic:function(a,r,h){var d,y=this.types;return typeof a===y.NUMBER&&typeof r===y.NUMBER?a+(r-a)*h:a instanceof l.Vector2&&r instanceof l.Vector2?((d=a.clone()).x=this.lerp(a.x,r.x,h),d.y=this.lerp(a.y,r.y,h),d):a instanceof l.Vector3&&r instanceof l.Vector3?((d=a.clone()).x=this.lerp(a.x,r.x,h),d.y=this.lerp(a.y,r.y,h),d.z=this.lerp(a.z,r.z,h),d):a instanceof l.Vector4&&r instanceof l.Vector4?((d=a.clone()).x=this.lerp(a.x,r.x,h),d.y=this.lerp(a.y,r.y,h),d.z=this.lerp(a.z,r.z,h),d.w=this.lerp(a.w,r.w,h),d):a instanceof l.Color&&r instanceof l.Color?((d=a.clone()).r=this.lerp(a.r,r.r,h),d.g=this.lerp(a.g,r.g,h),d.b=this.lerp(a.b,r.b,h),d):void console.warn("nunuStudio: Invalid argument types, or argument types do not match.",a,r)},lerp:function(a,r,h){return a+(r-a)*h},roundToNearestMultiple:function(a,r){var h;return 0===r||0==(h=Math.abs(a)%r)?a:a<0?-(Math.abs(a)-h):a+r-h},arrayValuesAreEqual:function(a){for(var r=0;r<a.length-1;++r)if(a[r]!==a[r+1])return!1;return!0},randomFloat:function(a,r){return a+r*(Math.random()-.5)},randomVector3:function(a,r,h,d,y){var b=h.x+(Math.random()*d.x-.5*d.x),R=h.y+(Math.random()*d.y-.5*d.y),k=h.z+(Math.random()*d.z-.5*d.z);y&&(b=.5*-y.x+this.roundToNearestMultiple(b,y.x),R=.5*-y.y+this.roundToNearestMultiple(R,y.y),k=.5*-y.z+this.roundToNearestMultiple(k,y.z)),a.typedArray.setVec3Components(r,b,R,k)},randomColor:function(a,r,h,d){var y=h.r+Math.random()*d.x,b=h.g+Math.random()*d.y,R=h.b+Math.random()*d.z;y=this.clamp(y,0,1),b=this.clamp(b,0,1),R=this.clamp(R,0,1),a.typedArray.setVec3Components(r,y,b,R)},randomColorAsHex:(ru=new l.Color,function(a,r,h,d){for(var y=h.length,b=[],R=0;R<y;++R){var k=d[R];ru.copy(h[R]),ru.r+=Math.random()*k.x-.5*k.x,ru.g+=Math.random()*k.y-.5*k.y,ru.b+=Math.random()*k.z-.5*k.z,ru.r=this.clamp(ru.r,0,1),ru.g=this.clamp(ru.g,0,1),ru.b=this.clamp(ru.b,0,1),b.push(ru.getHex())}a.typedArray.setVec4Components(r,b[0],b[1],b[2],b[3])}),randomVector3OnSphere:function(a,r,h,d,y,b,R,k){var M=2*Math.random()-1,H=6.2832*Math.random(),X=Math.sqrt(1-M*M),oe=this.randomFloat(d,y),ne=0,ge=0,we=0;R&&(oe=Math.round(oe/R)*R),ne=X*Math.cos(H)*oe,ge=X*Math.sin(H)*oe,we=M*oe,ne*=b.x,ge*=b.y,we*=b.z,a.typedArray.setVec3Components(r,ne+=h.x,ge+=h.y,we+=h.z)},seededRandom:function(a){var r=1e4*Math.sin(a);return r-(0|r)},randomVector3OnDisc:function(a,r,h,d,y,b,R){var k=6.2832*Math.random(),M=Math.abs(this.randomFloat(d,y)),H=0,X=0,oe=0;R&&(M=Math.round(M/R)*R),H=Math.cos(k)*M,X=Math.sin(k)*M,H*=b.x,X*=b.y,a.typedArray.setVec3Components(r,H+=h.x,X+=h.y,oe+=h.z)},randomDirectionVector3OnSphere:function(){var a=new l.Vector3;return function(r,h,d,y,b,R,k,M){a.copy(R),a.x-=d,a.y-=y,a.z-=b,a.normalize().multiplyScalar(-this.randomFloat(k,M)),r.typedArray.setVec3Components(h,a.x,a.y,a.z)}}(),randomDirectionVector3OnDisc:function(){var a=new l.Vector3;return function(r,h,d,y,b,R,k,M){a.copy(R),a.x-=d,a.y-=y,a.z-=b,a.normalize().multiplyScalar(-this.randomFloat(k,M)),r.typedArray.setVec3Components(h,a.x,a.y,0)}}(),getPackedRotationAxis:function(){var a=new l.Vector3,r=new l.Vector3,h=new l.Color,d=new l.Vector3(1,1,1);return function(y,b){return a.copy(y).normalize(),r.copy(b).normalize(),a.x+=.5*-b.x+Math.random()*b.x,a.y+=.5*-b.y+Math.random()*b.y,a.z+=.5*-b.z+Math.random()*b.z,a.normalize().add(d).multiplyScalar(.5),h.setRGB(a.x,a.y,a.z),h.getHex()}}()},sp={BOX:1,SPHERE:2,DISC:3};function Ri(a){for(var r in(a=Ut.ensureTypedArg(a,Ut.types.OBJECT,{})).position=Ut.ensureTypedArg(a.position,Ut.types.OBJECT,{}),a.velocity=Ut.ensureTypedArg(a.velocity,Ut.types.OBJECT,{}),a.acceleration=Ut.ensureTypedArg(a.acceleration,Ut.types.OBJECT,{}),a.radius=Ut.ensureTypedArg(a.radius,Ut.types.OBJECT,{}),a.drag=Ut.ensureTypedArg(a.drag,Ut.types.OBJECT,{}),a.rotation=Ut.ensureTypedArg(a.rotation,Ut.types.OBJECT,{}),a.color=Ut.ensureTypedArg(a.color,Ut.types.OBJECT,{}),a.opacity=Ut.ensureTypedArg(a.opacity,Ut.types.OBJECT,{}),a.size=Ut.ensureTypedArg(a.size,Ut.types.OBJECT,{}),a.angle=Ut.ensureTypedArg(a.angle,Ut.types.OBJECT,{}),a.wiggle=Ut.ensureTypedArg(a.wiggle,Ut.types.OBJECT,{}),a.maxAge=Ut.ensureTypedArg(a.maxAge,Ut.types.OBJECT,{}),a.onParticleSpawn&&console.warn("nunuStudio: onParticleSpawn has been removed. Please set properties directly to alter values at runtime."),this.uuid=l.Math.generateUUID(),this.type=Ut.ensureTypedArg(a.type,Ut.types.NUMBER,sp.BOX),this.position={_value:Ut.ensureInstanceOf(a.position.value,l.Vector3,new l.Vector3),_spread:Ut.ensureInstanceOf(a.position.spread,l.Vector3,new l.Vector3),_spreadClamp:Ut.ensureInstanceOf(a.position.spreadClamp,l.Vector3,new l.Vector3),_distribution:Ut.ensureTypedArg(a.position.distribution,Ut.types.NUMBER,this.type),_randomise:Ut.ensureTypedArg(a.position.randomise,Ut.types.BOOLEAN,!1),_radius:Ut.ensureTypedArg(a.position.radius,Ut.types.NUMBER,10),_radiusScale:Ut.ensureInstanceOf(a.position.radiusScale,l.Vector3,new l.Vector3(1,1,1)),_distributionClamp:Ut.ensureTypedArg(a.position.distributionClamp,Ut.types.NUMBER,0)},this.velocity={_value:Ut.ensureInstanceOf(a.velocity.value,l.Vector3,new l.Vector3),_spread:Ut.ensureInstanceOf(a.velocity.spread,l.Vector3,new l.Vector3),_distribution:Ut.ensureTypedArg(a.velocity.distribution,Ut.types.NUMBER,this.type),_randomise:Ut.ensureTypedArg(a.position.randomise,Ut.types.BOOLEAN,!1)},this.acceleration={_value:Ut.ensureInstanceOf(a.acceleration.value,l.Vector3,new l.Vector3),_spread:Ut.ensureInstanceOf(a.acceleration.spread,l.Vector3,new l.Vector3),_distribution:Ut.ensureTypedArg(a.acceleration.distribution,Ut.types.NUMBER,this.type),_randomise:Ut.ensureTypedArg(a.position.randomise,Ut.types.BOOLEAN,!1)},this.drag={_value:Ut.ensureTypedArg(a.drag.value,Ut.types.NUMBER,0),_spread:Ut.ensureTypedArg(a.drag.spread,Ut.types.NUMBER,0),_randomise:Ut.ensureTypedArg(a.position.randomise,Ut.types.BOOLEAN,!1)},this.wiggle={_value:Ut.ensureTypedArg(a.wiggle.value,Ut.types.NUMBER,0),_spread:Ut.ensureTypedArg(a.wiggle.spread,Ut.types.NUMBER,0)},this.rotation={_axis:Ut.ensureInstanceOf(a.rotation.axis,l.Vector3,new l.Vector3(0,1,0)),_axisSpread:Ut.ensureInstanceOf(a.rotation.axisSpread,l.Vector3,new l.Vector3),_angle:Ut.ensureTypedArg(a.rotation.angle,Ut.types.NUMBER,0),_angleSpread:Ut.ensureTypedArg(a.rotation.angleSpread,Ut.types.NUMBER,0),_static:Ut.ensureTypedArg(a.rotation.static,Ut.types.BOOLEAN,!1),_center:Ut.ensureInstanceOf(a.rotation.center,l.Vector3,this.position._value.clone()),_randomise:Ut.ensureTypedArg(a.position.randomise,Ut.types.BOOLEAN,!1)},this.maxAge={_value:Ut.ensureTypedArg(a.maxAge.value,Ut.types.NUMBER,2),_spread:Ut.ensureTypedArg(a.maxAge.spread,Ut.types.NUMBER,0)},this.color={_value:Ut.ensureArrayInstanceOf(a.color.value,l.Color,new l.Color),_spread:Ut.ensureArrayInstanceOf(a.color.spread,l.Vector3,new l.Vector3),_randomise:Ut.ensureTypedArg(a.position.randomise,Ut.types.BOOLEAN,!1)},this.opacity={_value:Ut.ensureArrayTypedArg(a.opacity.value,Ut.types.NUMBER,1),_spread:Ut.ensureArrayTypedArg(a.opacity.spread,Ut.types.NUMBER,0),_randomise:Ut.ensureTypedArg(a.position.randomise,Ut.types.BOOLEAN,!1)},this.size={_value:Ut.ensureArrayTypedArg(a.size.value,Ut.types.NUMBER,1),_spread:Ut.ensureArrayTypedArg(a.size.spread,Ut.types.NUMBER,0),_randomise:Ut.ensureTypedArg(a.position.randomise,Ut.types.BOOLEAN,!1)},this.angle={_value:Ut.ensureArrayTypedArg(a.angle.value,Ut.types.NUMBER,0),_spread:Ut.ensureArrayTypedArg(a.angle.spread,Ut.types.NUMBER,0),_randomise:Ut.ensureTypedArg(a.position.randomise,Ut.types.BOOLEAN,!1)},this.particleCount=Ut.ensureTypedArg(a.particleCount,Ut.types.NUMBER,100),this.duration=Ut.ensureTypedArg(a.duration,Ut.types.NUMBER,null),this.isStatic=Ut.ensureTypedArg(a.isStatic,Ut.types.BOOLEAN,!1),this.activeMultiplier=Ut.ensureTypedArg(a.activeMultiplier,Ut.types.NUMBER,1),this.direction=Ut.ensureTypedArg(a.direction,Ut.types.NUMBER,1),this.alive=Ut.ensureTypedArg(a.alive,Ut.types.BOOLEAN,!0),this.particlesPerSecond=0,this.activationIndex=0,this.attributeOffset=0,this.attributeEnd=0,this.age=0,this.activeParticleCount=0,this.group=null,this.attributes=null,this.paramsArray=null,this.resetFlags={position:Ut.ensureTypedArg(a.position.randomise,Ut.types.BOOLEAN,!1)||Ut.ensureTypedArg(a.radius.randomise,Ut.types.BOOLEAN,!1),velocity:Ut.ensureTypedArg(a.velocity.randomise,Ut.types.BOOLEAN,!1),acceleration:Ut.ensureTypedArg(a.acceleration.randomise,Ut.types.BOOLEAN,!1)||Ut.ensureTypedArg(a.drag.randomise,Ut.types.BOOLEAN,!1),rotation:Ut.ensureTypedArg(a.rotation.randomise,Ut.types.BOOLEAN,!1),rotationCenter:Ut.ensureTypedArg(a.rotation.randomise,Ut.types.BOOLEAN,!1),size:Ut.ensureTypedArg(a.size.randomise,Ut.types.BOOLEAN,!1),color:Ut.ensureTypedArg(a.color.randomise,Ut.types.BOOLEAN,!1),opacity:Ut.ensureTypedArg(a.opacity.randomise,Ut.types.BOOLEAN,!1),angle:Ut.ensureTypedArg(a.angle.randomise,Ut.types.BOOLEAN,!1)},this.updateFlags={},this.updateCounts={},this.updateMap={maxAge:"params",position:"position",velocity:"velocity",acceleration:"acceleration",drag:"acceleration",wiggle:"params",rotation:"rotation",size:"size",color:"color",opacity:"opacity",angle:"angle"},this.updateMap)this.updateMap.hasOwnProperty(r)&&(this.updateCounts[this.updateMap[r]]=0,this.updateFlags[this.updateMap[r]]=!1,this._createGetterSetters(this[r],r));this.bufferUpdateRanges={},this.attributeKeys=null,this.attributeCount=0,Ut.ensureValueOverLifetimeCompliance(this.color,$o.valueOverLifetimeLength,$o.valueOverLifetimeLength),Ut.ensureValueOverLifetimeCompliance(this.opacity,$o.valueOverLifetimeLength,$o.valueOverLifetimeLength),Ut.ensureValueOverLifetimeCompliance(this.size,$o.valueOverLifetimeLength,$o.valueOverLifetimeLength),Ut.ensureValueOverLifetimeCompliance(this.angle,$o.valueOverLifetimeLength,$o.valueOverLifetimeLength)}function Oo(a){(a=Ut.ensureTypedArg(a,Ut.types.OBJECT,{})).texture=Ut.ensureTypedArg(a.texture,Ut.types.OBJECT,{}),this.uuid=l.Math.generateUUID(),this.fixedTimeStep=Ut.ensureTypedArg(a.fixedTimeStep,Ut.types.NUMBER,.016),this.texture=Ut.ensureInstanceOf(a.texture.value,l.Texture,null),this.textureFrames=Ut.ensureInstanceOf(a.texture.frames,l.Vector2,new l.Vector2(1,1)),this.textureFrameCount=Ut.ensureTypedArg(a.texture.frameCount,Ut.types.NUMBER,this.textureFrames.x*this.textureFrames.y),this.textureLoop=Ut.ensureTypedArg(a.texture.loop,Ut.types.NUMBER,1),this.textureFrames.max(new l.Vector2(1,1)),this.hasPerspective=Ut.ensureTypedArg(a.hasPerspective,Ut.types.BOOLEAN,!0),this.colorize=Ut.ensureTypedArg(a.colorize,Ut.types.BOOLEAN,!0),this.maxParticleCount=Ut.ensureTypedArg(a.maxParticleCount,Ut.types.NUMBER,null),this.blending=Ut.ensureTypedArg(a.blending,Ut.types.NUMBER,l.AdditiveBlending),this.transparent=Ut.ensureTypedArg(a.transparent,Ut.types.BOOLEAN,!0),this.alphaTest=parseFloat(Ut.ensureTypedArg(a.alphaTest,Ut.types.NUMBER,0)),this.depthWrite=Ut.ensureTypedArg(a.depthWrite,Ut.types.BOOLEAN,!1),this.depthTest=Ut.ensureTypedArg(a.depthTest,Ut.types.BOOLEAN,!0),this.fog=Ut.ensureTypedArg(a.fog,Ut.types.BOOLEAN,!0),this.scale=Ut.ensureTypedArg(a.scale,Ut.types.NUMBER,300),this.emitters=[],this.emitterIDs=[],this.pool=[],this.poolCreationSettings=null,this._createNewWhenPoolEmpty=0,this._attributesNeedRefresh=!1,this._attributesNeedDynamicReset=!1,this.particleCount=0,this.uniforms={textureSampler:{type:"t",value:this.texture},textureAnimation:{type:"v4",value:new l.Vector4(this.textureFrames.x,this.textureFrames.y,this.textureFrameCount,Math.max(Math.abs(this.textureLoop),1))},fogColor:{type:"c",value:null},fogNear:{type:"f",value:10},fogFar:{type:"f",value:200},fogDensity:{type:"f",value:.5},deltaTime:{type:"f",value:0},runTime:{type:"f",value:0},scale:{type:"f",value:this.scale}},this.defines={HAS_PERSPECTIVE:this.hasPerspective,COLORIZE:this.colorize,VALUE_OVER_LIFETIME_LENGTH:$o.valueOverLifetimeLength,SHOULD_ROTATE_TEXTURE:!1,SHOULD_ROTATE_PARTICLES:!1,SHOULD_WIGGLE_PARTICLES:!1,SHOULD_CALCULATE_SPRITE:this.textureFrames.x>1||this.textureFrames.y>1},this.attributes={position:new Yo("v3",!0),acceleration:new Yo("v4",!0),velocity:new Yo("v3",!0),rotation:new Yo("v4",!0),rotationCenter:new Yo("v3",!0),params:new Yo("v4",!0),size:new Yo("v4",!0),angle:new Yo("v4",!0),color:new Yo("v4",!0),opacity:new Yo("v4",!0)},this.attributeKeys=Object.keys(this.attributes),this.attributeCount=this.attributeKeys.length,this.material=new l.ShaderMaterial({uniforms:this.uniforms,vertexShader:Ph.vertex,fragmentShader:Ph.fragment,blending:this.blending,transparent:this.transparent,alphaTest:this.alphaTest,depthWrite:this.depthWrite,depthTest:this.depthTest,defines:this.defines,fog:this.fog}),this.geometry=new l.BufferGeometry,this.mesh=new l.Points(this.geometry,this.material),null===this.maxParticleCount&&console.warn("nunuStudio: No maxParticleCount specified. Adding emitters after rendering will probably cause errors.")}function $o(a,r){this.group=new Oo(void 0!==a?a:$o.defaultGroup),this.emitter=new Ri(void 0!==r?r:$o.defaultEmitter),this.group.addEmitter(this.emitter),l.Points.call(this,this.group.geometry,this.group.material),this.type="ParticleEmiter",this.name="particle",this.frustumCulled=!1,this.dynamicEmitter=!1,this.clock=new l.Clock,this.temp=new l.Vector4;var h=this;Object.defineProperties(this,{texture:{get:function(){return h.group.texture},set:function(d){h.group.texture=d}}})}function ko(){l.Object3D.call(this),N.call(this)}function Fo(a){if(this.backgroundColor=null,this.backend=Fo.WEBGL2,this.autoClear=!1,this.autoClearColor=!1,this.autoClearDepth=!1,this.autoClearStencil=!1,this.antialiasing=!0,this.shadows=!0,this.stencil=!0,this.shadowsType=l.PCFSoftShadowMap,this.shadowsAutoUpdate=!0,this.toneMapping=l.NoToneMapping,this.toneMappingExposure=1,this.sortObjects=!0,this.gammaFactor=2,this.precision="highp",this.alpha=!0,this.premultipliedAlpha=!0,this.preserveDrawingBuffer=!1,this.powerPreference="high-performance",this.logarithmicDepthBuffer=!1,this.physicallyCorrectLights=!1,this.checkShaderErrors=!0,this.maxMorphTargets=8,this.maxMorphNormals=4,void 0!==a)for(var r in this)void 0!==a[r]&&(this[r]=a[r])}function tf(){this.desktop={fullscreen:!1,frame:!0,resizable:!0}}Ri.constructor=Ri,Ri.prototype._createGetterSetters=function(a,r){var h=this;for(var d in a)if(a.hasOwnProperty(d)){var y=d.replace("_","");Object.defineProperty(a,y,{get:function(b){return function(){return this[b]}}(d),set:function(b){return function(R){var k=h.updateMap[r],M=this[b],H=$o.valueOverLifetimeLength;"_rotationCenter"===b?(h.updateFlags.rotationCenter=!0,h.updateCounts.rotationCenter=0):"_randomise"===b?h.resetFlags[k]=R:(h.updateFlags[k]=!0,h.updateCounts[k]=0),h.group._updateDefines(),this[b]=R,Array.isArray(M)&&Ut.ensureValueOverLifetimeCompliance(h[r],H,H)}}(d)})}},Ri.prototype._setBufferUpdateRanges=function(a){this.attributeKeys=a,this.attributeCount=a.length;for(var r=this.attributeCount-1;r>=0;--r)this.bufferUpdateRanges[a[r]]={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY}},Ri.prototype._calculatePPSValue=function(a){var r=this.particleCount;this.particlesPerSecond=this.duration?r/(a<this.duration?a:this.duration):r/a},Ri.prototype._setAttributeOffset=function(a){this.attributeOffset=a,this.activationIndex=a,this.activationEnd=a+this.particleCount},Ri.prototype._assignValue=function(a,r){switch(a){case"position":this._assignPositionValue(r);break;case"velocity":case"acceleration":this._assignForceValue(r,a);break;case"size":case"opacity":this._assignAbsLifetimeValue(r,a);break;case"angle":this._assignAngleValue(r);break;case"params":this._assignParamsValue(r);break;case"rotation":this._assignRotationValue(r);break;case"color":this._assignColorValue(r)}},Ri.prototype._assignPositionValue=function(a){var r=this.position,h=this.attributes.position,d=r._value,y=r._spread;switch(r._distribution){case sp.BOX:Ut.randomVector3(h,a,d,y,r._spreadClamp);break;case sp.SPHERE:Ut.randomVector3OnSphere(h,a,d,r._radius,r._spread.x,r._radiusScale,r._spreadClamp.x,r._distributionClamp||this.particleCount);break;case sp.DISC:Ut.randomVector3OnDisc(h,a,d,r._radius,r._spread.x,r._radiusScale,r._spreadClamp.x)}},Ri.prototype._assignForceValue=function(a,r){var h,d,R,k=this[r],M=k._value,H=k._spread;switch(k._distribution){case sp.BOX:Ut.randomVector3(this.attributes[r],a,M,H);break;case sp.SPHERE:d=(h=this.attributes.position.typedArray.array)[R=3*a],Ut.randomDirectionVector3OnSphere(this.attributes[r],a,d,h[R+1],h[R+2],this.position._value,k._value.x,k._spread.x);break;case sp.DISC:d=(h=this.attributes.position.typedArray.array)[R=3*a],Ut.randomDirectionVector3OnDisc(this.attributes[r],a,d,h[R+1],h[R+2],this.position._value,k._value.x,k._spread.x)}if("acceleration"===r){var X=Ut.clamp(Ut.randomFloat(this.drag._value,this.drag._spread),0,1);this.attributes.acceleration.typedArray.array[4*a+3]=X}},Ri.prototype._assignAbsLifetimeValue=function(a,r){var h,d=this.attributes[r].typedArray,y=this[r];Ut.arrayValuesAreEqual(y._value)&&Ut.arrayValuesAreEqual(y._spread)?(h=Math.abs(Ut.randomFloat(y._value[0],y._spread[0])),d.setVec4Components(a,h,h,h,h)):d.setVec4Components(a,Math.abs(Ut.randomFloat(y._value[0],y._spread[0])),Math.abs(Ut.randomFloat(y._value[1],y._spread[1])),Math.abs(Ut.randomFloat(y._value[2],y._spread[2])),Math.abs(Ut.randomFloat(y._value[3],y._spread[3])))},Ri.prototype._assignAngleValue=function(a){var r,h=this.attributes.angle.typedArray,d=this.angle;Ut.arrayValuesAreEqual(d._value)&&Ut.arrayValuesAreEqual(d._spread)?(r=Ut.randomFloat(d._value[0],d._spread[0]),h.setVec4Components(a,r,r,r,r)):h.setVec4Components(a,Ut.randomFloat(d._value[0],d._spread[0]),Ut.randomFloat(d._value[1],d._spread[1]),Ut.randomFloat(d._value[2],d._spread[2]),Ut.randomFloat(d._value[3],d._spread[3]))},Ri.prototype._assignParamsValue=function(a){this.attributes.params.typedArray.setVec4Components(a,this.isStatic?1:0,0,Math.abs(Ut.randomFloat(this.maxAge._value,this.maxAge._spread)),Ut.randomFloat(this.wiggle._value,this.wiggle._spread))},Ri.prototype._assignRotationValue=function(a){this.attributes.rotation.typedArray.setVec3Components(a,Ut.getPackedRotationAxis(this.rotation._axis,this.rotation._axisSpread),Ut.randomFloat(this.rotation._angle,this.rotation._angleSpread),this.rotation._static?0:1),this.attributes.rotationCenter.typedArray.setVec3(a,this.rotation._center)},Ri.prototype._assignColorValue=function(a){Ut.randomColorAsHex(this.attributes.color,a,this.color._value,this.color._spread)},Ri.prototype._resetParticle=function(a){for(var r,h,d=this.resetFlags,y=this.updateFlags,b=this.updateCounts,R=this.attributeKeys,k=this.attributeCount-1;k>=0;--k)h=y[r=R[k]],!0!==d[r]&&!0!==h||(this._assignValue(r,a),this._updateAttributeUpdateRange(r,a),!0===h&&b[r]===this.particleCount?(y[r]=!1,b[r]=0):!0===h&&++b[r])},Ri.prototype._updateAttributeUpdateRange=function(a,r){var h=this.bufferUpdateRanges[a];h.min=Math.min(r,h.min),h.max=Math.max(r,h.max)},Ri.prototype._resetBufferRanges=function(){for(var a=this.bufferUpdateRanges,r=this.bufferUpdateKeys,h=this.bufferUpdateCount-1;h>=0;--h){var d=r[h];a[d].min=Number.POSITIVE_INFINITY,a[d].max=Number.NEGATIVE_INFINITY}},Ri.prototype._onRemove=function(){this.particlesPerSecond=0,this.attributeOffset=0,this.activationIndex=0,this.activeParticleCount=0,this.group=null,this.attributes=null,this.paramsArray=null,this.age=0},Ri.prototype._decrementParticleCount=function(){--this.activeParticleCount},Ri.prototype._incrementParticleCount=function(){++this.activeParticleCount},Ri.prototype._checkParticleAges=function(a,r,h,d){for(var y,b,R,k,M=r-1;M>=a;--M)0!==(k=h[y=4*M])&&(R=h[y+1],b=h[y+2],1===this.direction?(R+=d)>=b&&(R=0,k=0,this._decrementParticleCount()):(R-=d)<=0&&(R=b,k=0,this._decrementParticleCount()),h[y]=k,h[y+1]=R,this._updateAttributeUpdateRange("params",M))},Ri.prototype._activateParticles=function(a,r,h,d){for(var y,b,R=this.direction,k=a;k<r;++k)0!==h[y=4*k]&&1!==this.particleCount||(this._incrementParticleCount(),h[y]=1,this._resetParticle(k),b=d*(k-a),h[y+1]=-1===R?h[y+2]-b:b,this._updateAttributeUpdateRange("params",k))},Ri.prototype.tick=function(a){if(!this.isStatic){null===this.paramsArray&&(this.paramsArray=this.attributes.params.typedArray.array);var r=this.attributeOffset,h=r+this.particleCount,d=this.paramsArray,y=this.particlesPerSecond*this.activeMultiplier*a,b=this.activationIndex;if(this._resetBufferRanges(),this._checkParticleAges(r,h,d,a),!1!==this.alive){if(null!==this.duration&&this.age>this.duration)return this.alive=!1,void(this.age=0);var R=1===this.particleCount?b:0|b,k=Math.min(R+y,this.activationEnd),M=k-this.activationIndex|0;this._activateParticles(R,k,d,M>0?a/M:0),this.activationIndex+=y,this.activationIndex>h&&(this.activationIndex=r),this.age+=a}else this.age=0}},Ri.prototype.reset=function(a){if(this.age=0,this.alive=!1,!0===a){for(var r,h=this.attributeOffset,y=this.paramsArray,b=this.attributes.params.bufferAttribute,R=h+this.particleCount-1;R>=h;--R)y[r=4*R]=0,y[r+1]=0;b.updateRange.offset=0,b.updateRange.count=-1,b.needsUpdate=!0}return this},Ri.prototype.enable=function(){return this.alive=!0,this},Ri.prototype.disable=function(){return this.alive=!1,this},Ri.prototype.remove=function(){return null!==this.group?this.group.removeEmitter(this):console.error("nunuStudio: ParticleEmitterControl does not belong to a group, cannot remove."),this},Ri.prototype.toJSON=function(a){var r={};r.uuid=this.uuid,r.type=this.type,r.direction=this.direction,r.particleCount=this.particleCount,r.duration=this.duration,r.isStatic=this.isStatic,r.maxAge={},r.maxAge.value=this.maxAge.value,r.maxAge.spread=this.maxAge.spread,r.position={},r.position.value=this.position.value.toArray(),r.position.spread=this.position.spread.toArray(),r.position.radius=this.position.radius,r.position.radiusScale=this.position.radiusScale.toArray(),r.velocity={},r.velocity.value=this.velocity.value.toArray(),r.velocity.spread=this.velocity.spread.toArray(),r.acceleration={},r.acceleration.value=this.acceleration.value.toArray(),r.acceleration.spread=this.acceleration.spread.toArray(),r.wiggle={},r.wiggle.value=this.wiggle.value,r.wiggle.spread=this.wiggle.spread,r.opacity={},r.opacity.value=this.opacity.value.slice(0),r.opacity.spread=this.opacity.spread,r.size={},r.size.value=this.size.value.slice(0),r.size.spread=this.size.spread,r.angle={},r.angle.value=this.angle.value.slice(0),r.angle.spread=this.angle.spread,r.color={},r.color.value=[];for(var h=0;h<this.color.value.length;h++)r.color.value.push(this.color.value[h].getHex());for(r.color.spread=[],h=0;h<this.color.spread.length;h++)r.color.spread.push(this.color.spread[h].toArray());return r},Oo.constructor=Oo,Oo.prototype._updateDefines=function(){for(var a,r=this.emitters,h=this.defines,d=r.length-1;d>=0;--d)a=r[d],h.SHOULD_CALCULATE_SPRITE||(h.SHOULD_ROTATE_TEXTURE=h.SHOULD_ROTATE_TEXTURE||!!Math.max(Math.max.apply(null,a.angle.value),Math.max.apply(null,a.angle.spread))),h.SHOULD_ROTATE_PARTICLES=h.SHOULD_ROTATE_PARTICLES||!!Math.max(a.rotation.angle,a.rotation.angleSpread),h.SHOULD_WIGGLE_PARTICLES=h.SHOULD_WIGGLE_PARTICLES||!!Math.max(a.wiggle.value,a.wiggle.spread);this.material.needsUpdate=!0},Oo.prototype._applyAttributesToGeometry=function(){var a,r,h=this.attributes,d=this.geometry,y=d.attributes;for(var b in h)h.hasOwnProperty(b)&&(a=h[b],(r=y[b])?r.array=a.typedArray.array:d.setAttribute(b,a.bufferAttribute),a.bufferAttribute.needsUpdate=!0);this.geometry.setDrawRange(0,this.particleCount)},Oo.prototype.addEmitter=function(a){if(a instanceof Ri!=0)if(this.emitterIDs.indexOf(a.uuid)>-1)console.error("nunuStudio: ParticleEmitterControl already exists in this group.");else{if(null===a.group){var r=this.attributes,h=this.particleCount,d=h+a.particleCount;for(var y in this.particleCount=d,null!==this.maxParticleCount&&this.particleCount>this.maxParticleCount&&console.warn("nunuStudio: ParticleGroup maxParticleCount exceeded. Requesting",this.particleCount,"particles, can support only",this.maxParticleCount),a._calculatePPSValue(a.maxAge._value+a.maxAge._spread),a._setBufferUpdateRanges(this.attributeKeys),a._setAttributeOffset(h),a.group=this,a.attributes=this.attributes,r)r.hasOwnProperty(y)&&r[y]._createBufferAttribute(null!==this.maxParticleCount?this.maxParticleCount:this.particleCount);for(var b=h;b<d;++b)a._assignPositionValue(b),a._assignForceValue(b,"velocity"),a._assignForceValue(b,"acceleration"),a._assignAbsLifetimeValue(b,"opacity"),a._assignAbsLifetimeValue(b,"size"),a._assignAngleValue(b),a._assignRotationValue(b),a._assignParamsValue(b),a._assignColorValue(b);return this._applyAttributesToGeometry(),this.emitters.push(a),this.emitterIDs.push(a.uuid),this._updateDefines(a),this.material.needsUpdate=!0,this.geometry.needsUpdate=!0,this._attributesNeedRefresh=!0,this}console.error("nunuStudio: ParticleEmitterControl already belongs to another group.")}else console.error("nunuStudio: emitter argument must be instance of ParticleEmitterControl.",a)},Oo.prototype.removeEmitter=function(a){var r=this.emitterIDs.indexOf(a.uuid);if(a instanceof Ri!=0)if(-1!==r){for(var h=a.attributeOffset,d=h+a.particleCount,y=this.attributes.params.typedArray,b=h;b<d;++b)y.array[4*b]=0,y.array[4*b+1]=0;for(var R in this.emitters.splice(r,1),this.emitterIDs.splice(r,1),this.attributes)this.attributes.hasOwnProperty(R)&&this.attributes[R].splice(h,d);this.particleCount-=a.particleCount,a._onRemove(),this._attributesNeedRefresh=!0}else console.error("nunuStudio: ParticleEmitterControl does not exist in this group. Will not remove.");else console.error("nunuStudio: emitter argument must be instance of ParticleEmitterControl. Was provided with:",a)},Oo.prototype.getFromPool=function(){var a=this.pool,r=this._createNewWhenPoolEmpty;if(a.length)return a.pop();if(r){var h=new Ri(this.poolCreationSettings);return this.addEmitter(h),h}return null},Oo.prototype.releaseIntoPool=function(a){if(a instanceof Ri!=0)return a.reset(),this.pool.unshift(a),this;console.error("nunuStudio: Argument is not instanceof ParticleEmitterControl:",a)},Oo.prototype.getPool=function(){return this.pool},Oo.prototype.addPool=function(a,r,h){var d;this.poolCreationSettings=r,this._createNewWhenPoolEmpty=!!h;for(var y=0;y<a;++y)d=Array.isArray(r)?new Ri(r[y]):new Ri(r),this.addEmitter(d),this.releaseIntoPool(d);return this},Oo.prototype._triggerSingleEmitter=function(a){var r=this.getFromPool(),h=this;if(null!==r)return a instanceof l.Vector3&&(r.position.value.copy(a),r.position.value=r.position.value),r.enable(),setTimeout(function(){r.disable(),h.releaseIntoPool(r)},1e3*Math.max(r.duration,r.maxAge.value+r.maxAge.spread)),this;console.log("nunuStudio: ParticleGroup pool ran out.")},Oo.prototype.triggerEmitter=function(a,r){if("number"==typeof a&&a>1)for(var h=0;h<a;++h)this._triggerSingleEmitter(r);else this._triggerSingleEmitter(r);return this},Oo.prototype._updateUniforms=function(a){this.uniforms.runTime.value+=a,this.uniforms.deltaTime.value=a},Oo.prototype._resetBufferRanges=function(){for(var a=this.attributeKeys,r=this.attributeCount-1;r>=0;--r)this.attributes[a[r]].resetUpdateRange()},Oo.prototype._updateBuffers=function(a){for(var r,h,d,y=this.attributeKeys,b=this.attributes,R=a.bufferUpdateRanges,k=this.attributeCount-1;k>=0;--k)h=R[r=y[k]],(d=b[r]).setUpdateRange(h.min,h.max),d.flagUpdate()},Oo.prototype.tick=function(a){var r=this.emitters,h=r.length,d=a||this.fixedTimeStep,y=this.attributeKeys,b=this.attributes;if(this._updateUniforms(d),this._resetBufferRanges(),0!==h||!1!==this._attributesNeedRefresh||!1!==this._attributesNeedDynamicReset){for(var R,k=0;k<h;++k)(R=r[k]).tick(d),this._updateBuffers(R);if(!0===this._attributesNeedDynamicReset){for(k=this.attributeCount-1;k>=0;--k)b[y[k]].resetDynamic();this._attributesNeedDynamicReset=!1}if(!0===this._attributesNeedRefresh){for(k=this.attributeCount-1;k>=0;--k)b[y[k]].forceUpdateAll();this._attributesNeedRefresh=!1,this._attributesNeedDynamicReset=!0}}},Oo.prototype.dispose=function(){return this.geometry.dispose(),this.material.dispose(),this},Oo.prototype.toJSON=function(a){var r={texture:{}};return r.texture.value=this.texture.uuid,r.texture.frames=this.textureFrames.toArray(),r.texture.frameCount=this.textureFrameCount,r.texture.loop=this.textureLoop,r.fixedTimeStep=this.fixedTimeStep,r.hasPerspective=this.hasPerspective,r.colorize=this.colorize,r.maxParticleCount=this.maxParticleCount,r.transparent=this.transparent,r.blending=this.blending,r.alphaTest=this.alphaTest,r.depthWrite=this.depthWrite,r.depthTest=this.depthTest,r.fog=this.fog,r.scale=this.scale,r},$o.valueOverLifetimeLength=4,$o.prototype=Object.create(l.Points.prototype),$o.defaultEmitter={particleCount:200,velocity:{value:new l.Vector3(0,0,0),spread:new l.Vector3(3,3,3)},acceleration:{value:new l.Vector3(0,0,0),spread:new l.Vector3(0,0,0)}},$o.defaultGroup={texture:{value:null},maxParticleCount:200,blending:l.AdditiveBlending,fog:!1,depthWrite:!1,depthTest:!0,transparent:!0,hasPerspective:!0},$o.prototype.reload=function(){this.dispose();var a=this.children;this.children=[];var r=(new Ao).parse(this.toJSON());this.children=a,this.group=r.group,this.emitter=r.emitter,this.geometry=this.group.geometry,this.material=this.group.material},$o.prototype.updateMatrix=function(){this.dynamicEmitter?(this.matrix.makeRotationFromQuaternion(this.quaternion),this.matrix.scale(this.scale)):this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},$o.prototype.onBeforeRender=function(a,r,h,d){this.group.uniforms.scale.value=a.getCurrentViewport(this.temp).w,this.group.tick(this.clock.getDelta()),!0===this.dynamicEmitter&&(this.emitter.position.value=this.position)},$o.prototype.dispose=function(){this.group.dispose(),l.Object3D.prototype.dispose.call(this)},$o.prototype.toJSON=function(a){var r=this.material,h=this.geometry;this.material=void 0,this.geometry=void 0;var d=this.group.texture,y=l.Object3D.prototype.toJSON.call(this,a,function(b,R){d=d.toJSON(b)});return this.material=r,this.geometry=h,y.object.group=this.group.toJSON(a),y.object.emitter=this.emitter.toJSON(a),y},$o.fromJSON=function(a,r){function h(R){return Array.isArray(R)?(new l.Vector3).fromArray(R):new l.Vector3(R.x,R.y,R.z)}if(void 0!==a.group){var d=a.group;d.texture.value=r.getTexture(d.texture.value),d.texture.frames=(new l.Vector2).fromArray(d.texture.frames||[1,1])}if(void 0!==a.emitter){var y=a.emitter;y.position.value=h(y.position.value),y.position.spread=h(y.position.spread),y.velocity.value=h(y.velocity.value),y.velocity.spread=h(y.velocity.spread),y.acceleration.value=h(y.acceleration.value),y.acceleration.spread=h(y.acceleration.spread);for(var b=0;b<y.color.value.length;b++)y.color.value[b]=new l.Color(y.color.value[b]),y.color.spread[b]=h(y.color.spread[b])}return new $o(a.group,a.emitter)},ko.prototype=Object.create(l.Object3D.prototype),Object.assign(ko.prototype,N.prototype),ko.prototype.dispose=function(){for(var a=0;a<N.libraries.length;a++){var r=N.libraries[a];for(var h in this[r])this[r][h].dispose instanceof Function&&this[r][h].dispose()}},ko.prototype.removeGeometry=function(a,r){this.traverse(function(h){void 0!==h.geometry&&h.geometry.uuid===a.uuid&&(h.geometry=r)}),delete this.geometries[a.uuid]},ko.prototype.getResourceByName=function(a){for(var r in this.resources)if(this.resources[r].name===a)return this.resources[r];return console.warn("nunuStudio: Resource "+a+" not found"),null},ko.prototype.addResource=function(a){a instanceof vi&&(this.resources[a.uuid]=a)},ko.prototype.removeResource=function(a){delete this.resources[a.uuid]},ko.prototype.getImageByName=function(a){for(var r in this.images)if(this.images[r].name===a)return this.images[r];return console.warn("nunuStudio: Resource "+a+" not found"),null},ko.prototype.removeImage=function(a){a instanceof gs&&delete this.images[a.uuid]},ko.prototype.getVideoByName=function(a){for(var r in this.videos)if(this.videos[r].name===a)return this.videos[r];return console.warn("nunuStudio: Resource "+a+" not found"),null},ko.prototype.removeVideo=function(a){a instanceof Aa&&delete this.videos[a.uuid]},ko.prototype.getMaterialByName=function(a){for(var r in this.materials)if(this.materials[r].name===a)return this.materials[r];return console.warn("nunuStudio: Resource "+a+" not found"),null},ko.prototype.addMaterial=function(a){a instanceof l.Material&&(this.materials[a.uuid]=a)},ko.prototype.removeMaterial=function(a,r,h){void 0===r&&(r=new l.MeshBasicMaterial),void 0===h&&(h=new l.SpriteMaterial),a instanceof l.Material&&(delete this.materials[a.uuid],this.traverse(function(d){void 0!==d.material&&d.material.uuid===a.uuid&&(d.material=d instanceof l.Sprite?h:r)}))},ko.prototype.getTextureByName=function(a){for(var r in this.textures)if(this.textures[r].name===a)return this.textures[r];return console.warn("nunuStudio: Resource "+a+" not found"),null},ko.prototype.addTexture=function(a){material instanceof l.Texture&&(this.textures[a.uuid]=a)},ko.prototype.removeTexture=function(a,r){void 0===r&&(r=new l.Texture),a instanceof l.Texture&&(delete this.textures[a.uuid],this.traverse(function(h){if(void 0!==h.material){var d=h.material;d.map&&d.map.uuid===a.uuid&&(d.map=r,d.needsUpdate=!0),d.bumpMap&&d.bumpMap.uuid===a.uuid&&(d.bumpMap=r,d.needsUpdate=!0),d.normalMap&&d.normalMap.uuid===a.uuid&&(d.normalMap=r,d.needsUpdate=!0),d.displacementMap&&d.displacementMap.uuid===a.uuid&&(d.displacementMap=r,d.needsUpdate=!0),d.specularMap&&d.specularMap.uuid===a.uuid&&(d.specularMap=r,d.needsUpdate=!0),d.emissiveMap&&d.emissiveMap.uuid===a.uuid&&(d.emissiveMap=r,d.needsUpdate=!0),d.alphaMap&&d.alphaMap.uuid===a.uuid&&(d.alphaMap=r,d.needsUpdate=!0),d.roughnessMap&&d.roughnessMap.uuid===a.uuid&&(d.roughnessMap=r,d.needsUpdate=!0),d.metalnessMap&&d.metalnessMap.uuid===a.uuid&&(d.metalnessMap=r,d.needsUpdate=!0),d.envMap&&d.envMap.uuid===a.uuid&&(d.envMap=null,d.needsUpdate=!0)}else h instanceof $o&&h.group.texture.uuid===a.uuid&&(h.group.texture=r)}))},ko.prototype.getFontByName=function(a){for(var r in this.fonts)if(this.fonts[r].name===a)return this.fonts[r];return console.warn("nunuStudio: Resource "+a+" not found"),null},ko.prototype.addFont=function(a){a instanceof An&&(this.fonts[a.uuid]=a)},ko.prototype.removeFont=function(a,r){void 0===r&&(r=new An),a instanceof An&&(delete this.fonts[a.uuid],this.traverse(function(h){void 0!==h.font&&h.font.uuid===a.uuid&&h.setFont(r)}))},ko.prototype.getAudioByName=function(a){for(var r in this.audio)if(this.audio[r].name===a)return this.audio[r];return console.warn("nunuStudio: Resource "+a+" not found"),null},ko.prototype.addAudio=function(a){a instanceof Dn&&(this.audio[a.uuid]=a)},ko.prototype.removeAudio=function(a,r){void 0===r&&(r=new Dn),a instanceof Dn&&(delete this.audio[a.uuid],this.traverse(function(h){void 0!==h.audio&&h.audio.uuid===a.uuid&&h.setAudio(r)}))},Fo.WEBGL=1,Fo.WEBGL2=2,Fo.prototype.createRenderer=function(a){var r=null;if(this.backend===Fo.WEBGL2)try{r=a.getContext("webgl2",{xrCompatible:!0})}catch(y){console.warn("nunuStudio: Failed to create WebGL2 context",y)}var d=new l.WebGLRenderer({canvas:a,context:r,precision:this.precision,alpha:this.alpha,premultipliedAlpha:this.premultipliedAlpha,antialias:this.antialiasing,stencil:this.stencil,preserveDrawingBuffer:this.preserveDrawingBuffer,powerPreference:this.powerPreference,logarithmicDepthBuffer:this.logarithmicDepthBuffer});return this.apply(d),null!==this.backgroundColor&&(a.style.backgroundColor=this.backgroundColor),d},Fo.prototype.apply=function(a){a.autoClear=this.autoClear,a.autoClearColor=this.autoClearColor,a.autoClearDepth=this.autoClearDepth,a.autoClearStencil=this.autoClearStencil,a.shadowMap.enabled=this.shadows,a.shadowMap.type=this.shadowsType,a.shadowMap.autoUpdate=this.shadowsAutoUpdate,a.shadowMap.needsUpdate=!0,a.toneMapping=this.toneMapping,a.toneMappingExposure=this.toneMappingExposure,a.debug.checkShaderErrors=this.checkShaderErrors,a.sortObjects=this.sortObjects,a.gammaFactor=this.gammaFactor,a.physicallyCorrectLights=this.physicallyCorrectLights,a.maxMorphTargets=this.maxMorphTargets,a.maxMorphNormals=this.maxMorphNormals},Fo.prototype.toJSON=function(){return{backgroundColor:this.backgroundColor,backend:this.backend,autoClear:this.autoClear,autoClearColor:this.autoClearColor,autoClearDepth:this.autoClearDepth,autoClearStencil:this.autoClearStencil,antialiasing:this.antialiasing,shadows:this.shadows,stencil:this.stencil,shadowsType:this.shadowsType,shadowsAutoUpdate:this.shadowsAutoUpdate,toneMapping:this.toneMapping,toneMappingExposure:this.toneMappingExposure,sortObjects:this.sortObjects,checkShaderErrors:this.checkShaderErrors,gammaFactor:this.gammaFactor,precision:this.precision,alpha:this.alpha,premultipliedAlpha:this.premultipliedAlpha,preserveDrawingBuffer:this.preserveDrawingBuffer,powerPreference:this.powerPreference,logarithmicDepthBuffer:this.logarithmicDepthBuffer,physicallyCorrectLights:this.physicallyCorrectLights,maxMorphTargets:this.maxMorphTargets,maxMorphNormals:this.maxMorphNormals}},Fo.prototype.fromJSON=function(a){this.backgroundColor=a.backgroundColor,this.backend=a.backend,this.autoClear=a.autoClear,this.autoClearColor=a.autoClearColor,this.autoClearDepth=a.autoClearDepth,this.autoClearStencil=a.autoClearStencil,this.antialiasing=a.antialiasing,this.shadows=a.shadows,this.stencil=a.stencil,this.shadowsType=a.shadowsType,this.shadowsAutoUpdate=a.shadowsAutoUpdate,this.toneMapping=a.toneMapping,this.toneMappingExposure=a.toneMappingExposure,this.sortObjects=a.sortObjects,this.checkShaderErrors=a.checkShaderErrors,this.gammaFactor=a.gammaFactor,this.precision=a.precision,this.alpha=a.alpha,this.premultipliedAlpha=a.premultipliedAlpha,this.preserveDrawingBuffer=a.preserveDrawingBuffer,this.powerPreference=a.powerPreference,this.logarithmicDepthBuffer=a.logarithmicDepthBuffer,this.physicallyCorrectLights=a.physicallyCorrectLights,this.maxMorphTargets=a.maxMorphTargets,this.maxMorphNormals=a.maxMorphNormals};var Co=__webpack_require__(872);function Ai(a,r){this.element=document.createElement(void 0!==r?r:"div"),this.element.style.position="absolute",this.element.style.overflow="hidden",this.event=new dn,this.parent=null,void 0!==a&&this.attachTo(a),this.visible=!0,this.size=new l.Vector2(0,0),this.position=new l.Vector2(0,0),this._mode=Ai.TOP_LEFT}function cs(a){this.program=null,this.renderer=null,this.running=!1,this.canvasFitWindow=!1,this.canvas=a,this.events=new dn,void 0===a&&(this.canvas=document.createElement("canvas"),this.canvas.style.position="absolute",this.canvas.style.left="0px",this.canvas.style.top="0px",this.canvasFitWindow=!0,document.body.appendChild(this.canvas))}function mi(){}function Lo(){}function Qr(){ko.call(this),this.type="Program",this.matrixAutoUpdate=!1,this.app=null,this.name="program",this.description="",this.author="",this.version="0.0.0",this.lockPointer=!1,this.handlePixelRatio=!0,this.ar=!0,this.vr=!0,this.vrScale=1,this.rendererConfig=new Fo,this.targetConfig=new tf,this.defaultScene=null,this.defaultCamera=null,this.scene=null,this.keyboard=null,this.mouse=null,this.renderer=null,this.canvas=null,this.division=null,this.manager=new dn,this.clock=new l.Clock,this.xrEnabled=!1,this.xrMode=Qr.XR_NONE}function bs(){l.Scene.call(this),this.name="scene",this.matrixAutoUpdate=!1,this.usePhysics=!0,this.world=new Fn,this.world.defaultContactMaterial.contactEquationStiffness=1e9,this.world.defaultContactMaterial.contactEquationRelaxation=4,this.world.quatNormalizeSkip=0,this.world.quatNormalizeFast=!1,this.world.gravity.set(0,-9.8,0),this.world.broadphase=new vr,this.world.solver=new Ts(new vu),this.world.solver.tolerance=.05,this.world.solver.iterations=7,this.background=null,this.alpha=1,this.cameras=[],this.defaultCamera=null,this.delta=0,this.raycaster=new l.Raycaster,this.useOctree=!1,this.octree=null,this.octreeUpdateScheduled=!1,this.octreeMatches=[],this.program=null,this.canvas=null,this.mouse=new l.Vector2(0,0)}function iu(a){l.AnimationMixer.call(this,a),this.playing=!1}Ai.prototype.constructor=Ai,Ai.prototype.isComponent=!0,Ai.TOP_LEFT=0,Ai.TOP_RIGHT=1,Ai.BOTTOM_LEFT=2,Ai.BOTTOM_RIGHT=3,Ai.preventDefault=function(a){a.preventDefault()},Ai.prototype.addEvent=function(a,r){this.event.addAndCreate(this.element,a,r)},Ai.prototype.removeEvent=function(a){this.event.remove(this.element,a)},Ai.prototype.replaceEvent=function(a,r){this.event.remove(this.element,a),this.event.addAndCreate(this.element,a,r)},Ai.prototype.addClass=function(a){this.element.classList.add(a)},Ai.prototype.removeClass=function(a){this.element.classList.contains(a)&&this.element.classList.remove(a)},Ai.prototype.setStyle=function(a,r){this.element.style[a]=r},Ai.prototype.setStyles=function(a){for(var r in a)this.element.style[r]=a[r]},Ai.prototype.preventDragEvents=function(){this.element.ondrop=Ai.preventDefault,this.element.ondragover=Ai.preventDefault},Ai.prototype.setAltText=function(a){var r=document.createElement("div");r.style.position="absolute",r.style.display="none",r.style.alignItems="center",r.style.zIndex="10000",r.style.border="3px solid",r.style.borderRadius="5px",r.style.color="var(--color-light)",r.style.backgroundColor="var(--bar-color)",r.style.borderColor="var(--bar-color)",r.style.height="fit-content",document.body.appendChild(r);var h=document.createTextNode(a);r.appendChild(h);var d=this.destroy;return this.destroy=function(){d.call(this),document.body.contains(r)&&document.body.removeChild(r)},this.element.style.pointerEvents="auto",this.addEvent("mousemove",function(y){r.style.display="flex",r.style.left=y.clientX+8+"px",r.style.top=y.clientY-20+"px"}),this.addEvent("mouseout",function(){r.style.display="none"}),r},Ai.prototype.setOnClick=function(a){this.addEvent("click",a)},Ai.prototype.removeAllChildren=function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild)},Ai.prototype.attachTo=function(a){this.parent!==a&&void 0!==a&&(null!==this.parent&&Ai.prototype.destroy.call(this),this.parent=a,!0===a.isComponent?a.element.appendChild(this.element):(console.warn("nunuStudio: Parent is not a Component.",this),this.parent.appendChild(this.element)))},Ai.prototype.watchPointer=function(){var a=this;this.pointerInside=!1,this.element.addEventListener("mouseenter",function(){a.pointerInside=!0}),this.element.addEventListener("mouseleave",function(){a.pointerInside=!1})},Ai.prototype.destroy=function(){null!==this.parent&&(!0===this.parent.isComponent?this.parent.element.contains(this.element)&&(this.parent.element.removeChild(this.element),this.parent=null):(console.warn("nunuStudio: Parent is not a Component.",this),this.parent.contains(this.element)&&(this.parent.removeChild(this.element),this.parent=null)))},Ai.prototype.setMode=function(a){this._mode=a,this.element.style.bottom=null,this.element.style.top=null,this.element.style.right=null,this.element.style.left=null},Ai.prototype.center=function(){this.position.set((this.parent.size.x-this.size.x)/2,(this.parent.size.y-this.size.y)/2)},Ai.prototype.setVisibility=function(a){this.visible=a,this.updateVisibility()},Ai.prototype.updateVisibility=function(){this.element.style.display=this.visible?"block":"none"},Ai.prototype.updatePosition=function(a){void 0!==a&&(this._mode=a),this._mode===Ai.TOP_LEFT||this._mode===Ai.TOP_RIGHT?this.element.style.top=this.position.y+"px":this.element.style.bottom=this.position.y+"px",this._mode===Ai.TOP_LEFT||this._mode===Ai.BOTTOM_LEFT?this.element.style.left=this.position.x+"px":this.element.style.right=this.position.x+"px"},Ai.prototype.updateSize=function(){this.element.style.width=this.size.x+"px",this.element.style.height=this.size.y+"px"},Ai.prototype.updateInterface=function(){this.updateVisibility(),this.visible&&(this.updateSize(),this.updatePosition())},cs.loadApp=function(a,r){"string"==typeof r&&(r=document.getElementById(r));var h=new cs(r);h.loadRunProgram(a),window.addEventListener("resize",function(){ho.isFullscreen()?(h.canvas.width=window.innerWidth,h.canvas.height=window.innerHeight):h.canvas.parentElement&&(h.canvas.width=h.canvas.parentElement.offsetWidth,h.canvas.height=h.canvas.parentElement.offsetHeight),h.resize()})},cs.prototype.run=function(){if(null!==this.program){if(this.renderer=this.program.rendererConfig.createRenderer(this.canvas),this.program.app=this,this.program.defaultCamera=new Ue(60,1,.1,1e5),this.program.defaultCamera.position.set(0,5,-5),this.program.setRenderer(this.renderer),this.program.initialize(),this.program.lockPointer){var r=this.mouse;this.events.add(this.canvas,"click",function(){r.setLock(!0)})}var h=this;this.events.add(window,"beforeunload",function(){h.exit()}),this.events.create(),this.resize(),this.resume()}else console.warn("nunuStudio: no program is loaded [app.loadPogram(fname)]")},cs.prototype.loadRunProgram=function(a,r,h){this.loadProgramAsync(a,function(d){d.run(),void 0!==r&&r(d)},h)},cs.prototype.loadProgram=function(a){if(a.endsWith(".isp")){var r=new Ao,h=Bn.readFile(a);this.program=r.parse(JSON.parse(h))}else if(a.endsWith(".nsp")){r=new Ao,h=Bn.readFileArrayBuffer(a);var d=new Co.fG}this.program=r.parse(d.decode(h))},cs.prototype.loadProgramAsync=function(a,r,h){var d=this;a.endsWith(".isp")?Bn.readFile(a,!1,function(y){var b=new Ao;d.program=b.parse(JSON.parse(y)),void 0!==r&&r(d)},function(y){h(y.lengthComputable?y.loaded/y.total*100:0,y)}):a.endsWith(".nsp")&&Bn.readFileArrayBuffer(a,!1,function(y){var b=new Ao,R=new Co.fG;d.program=b.parse(R.decode(y)),void 0!==r&&r(d)},function(y){h(y.lengthComputable?y.loaded/y.total*100:0,y)})},cs.prototype.update=function(){this.program.update(),this.program.render(this.renderer)},cs.prototype.exit=function(){this.events.destroy(),null!==this.program&&(this.program.dispose(),this.program=null),null!==this.renderer&&(this.renderer.dispose(),this.renderer=null),void 0!==this.onExit&&this.onExit()},cs.prototype.resume=function(){if(null!==this.program&&!this.running){var a=this;this.renderer.setAnimationLoop(function(){a.update()}),this.running=!0}},cs.prototype.pause=function(){this.running=!1,this.renderer.setAnimationLoop(null)},cs.prototype.setCanvas=function(a){this.canvas=a,this.canvasFitWindow=!1},cs.prototype.resize=function(){if(null!==this.canvas&&null!==this.program&&null!==this.renderer){var a=1,r=1;this.canvasFitWindow?(this.canvas.style.width=window.innerWidth+"px",this.canvas.style.height=window.innerHeight+"px",a=window.innerWidth,r=window.innerHeight):(a=this.canvas.offsetWidth,r=this.canvas.offsetHeight),this.program.handlePixelRatio&&(a*=window.devicePixelRatio,r*=window.devicePixelRatio),this.renderer.setSize(a,r,!1),this.program.resize(a,r)}},cs.prototype.sendData=function(a){null!==this.program&&this.program.receiveDataApp(a)},cs.prototype.setOnDataReceived=function(a){this.onDataReceived=a},cs.prototype.setOnExit=function(a){this.onExit=a},cs.prototype.vrAvailable=function(){return null!==this.program&&this.program.vrAvailable()},cs.prototype.toggleVR=function(){this.vrAvailable()?this.program.xrEnabled?this.program.exitVR():this.program.enterVR():console.warn("nunuStudio: Loaded program is not VR enabled.")},cs.prototype.arAvailable=function(){return null!==this.program&&this.program.arAvailable()},cs.prototype.toggleAR=function(){this.arAvailable()?this.program.xrEnabled?this.program.exitAR():this.program.enterAR():console.warn("nunuStudio: Loaded program is not AR enabled.")},cs.prototype.toggleFullscreen=function(a){var r=ho.isFullscreen();void 0===a&&(a=this.canvas),ho.setFullscreen(!r,a)},mi.webXRAvailable=!1,mi.webXRSession=null,mi.webVRAvailable=!1,mi.webVRDisplay=null,mi.vrAvailable=function(){return mi.webXRAvailable||mi.webVRAvailable},mi.enterVR=function(a,r){mi.webXRAvailable?mi.getWebXRSession().then(function(h){a.xr.enabled=!0,a.xr.setSession(h),mi.webXRSession=h,void 0!==r&&r()}).catch(function(h){console.warn("nunuStudio: Failed to start VR WebXR session.",h)}):mi.webVRAvailable?mi.getWebVRDisplay().then(function(h){displays.length>0&&((mi.webVRDisplay=displays[0]).isPresenting||(a.xr.enabled=!0,a.xr.setDevice(mi.webVRDisplay),mi.webVRDisplay.requestPresent([{source:a.domElement}]),void 0!==r&&r()))}).catch(function(h){console.warn("nunuStudio: Failed to start VR WebVR session.",h)}):console.warn("nunuStudio: VR support is not available.")},mi.exitVR=function(a){mi.webXRAvailable&&null!==mi.webXRSession?(a.xr.enabled=!1,a.xr.setSession(null),mi.webXRSession.end(),mi.webXRSession=null):mi.webVRAvailable&&null!==mi.webVRDisplay&&mi.webVRDisplay.isPresenting&&(a.xr.enabled=!1,a.xr.setDevice(null),mi.webVRDisplay.exitPresent(),mi.webVRDisplay=null)},mi.getWebXRSession=function(){return mi.webXRAvailable?navigator.xr.requestSession("immersive-vr",{optionalFeatures:["local-floor","bounded-floor"]}):Promise.reject("WebXR support is not available.")},mi.getWebVRDisplay=function(a){return mi.webVRAvailable?navigator.getVRDisplays():Promise.reject("WebVR support is not available.")},void 0!==navigator.xr&&void 0!==navigator.xr.isSessionSupported?navigator.xr.isSessionSupported("immersive-vr").then(function(a){mi.webXRAvailable=a}):void 0!==navigator.getVRDisplays&&navigator.getVRDisplays().then(function(a){mi.webVRAvailable=a.length>0}),Lo.OPAQUE="opaque",Lo.ADDITIVE="additive",Lo.ALPHA_BLEND="alpha-blend",Lo.webXRAvailable=!1,Lo.webXRSession=null,Lo.arAvailable=function(){return Lo.webXRAvailable},Lo.enterAR=function(a,r){Lo.webXRAvailable?Lo.getWebXRSession().then(function(h){a.xr.enabled=!0,a.xr.setReferenceSpaceType("local"),a.xr.setSession(h),console.log("nunuStudio: New AR WebXR session created",h),Lo.webXRSession=h,void 0!==r&&r()}).catch(function(h){console.warn("nunuStudio: Failed to start AR WebXR session.",h)}):console.warn("nunuStudio: AR support is not available.")},Lo.exitAR=function(a){Lo.webXRAvailable&&null!==Lo.webXRSession&&(a.xr.enabled=!1,a.xr.setSession(null),Lo.webXRSession.end(),Lo.webXRSession=null)},Lo.getWebXRSession=function(){return Lo.webXRAvailable?navigator.xr.requestSession("immersive-ar",{}):Promise.reject("WebXR support is not available.")},void 0!==navigator.xr&&void 0!==navigator.xr.isSessionSupported&&navigator.xr.isSessionSupported("immersive-ar").then(function(a){Lo.webXRAvailable=a}),Qr.XR_NONE=0,Qr.XR_VR=1,Qr.XR_AR=2,(Qr.prototype=Object.create(ko.prototype)).initialize=function(){if(null===this.mouse&&(this.mouse=new Yr,this.mouse.setCanvas(this.canvas),this.mouse.create()),null===this.keyboard&&(this.keyboard=new Xn,this.keyboard.create()),this.manager.create(),null!==this.defaultScene){for(var a=0;a<this.children.length;a++)if(this.children[a].uuid===this.defaultScene){this.setScene(this.children[a]);break}}else this.children.length>0&&this.setScene(this.children[0]);this.lockPointer&&null!==this.mouse&&this.mouse.setLock(!0),this.clock.start()},Qr.prototype.setMouseKeyboard=function(a,r){this.mouse!==a&&(null!==this.mouse&&this.mouse.dispose(),this.mouse=a),this.keyboard!==r&&(null!==this.keyboard&&this.keyboard.dispose(),this.keyboard=r)},Qr.prototype.setRenderer=function(a,r){this.renderer=a,this.renderer.autoClear=!1,this.canvas=a.domElement,this.division=this.canvas.parentElement,r&&this.updateRenderer()},Qr.prototype.update=function(){var a=this.clock.getDelta();this.mouse.update(),this.keyboard.update(),this.scene.update(a)},Qr.prototype.render=function(a){this.scene.render(a)},Qr.prototype.resize=function(a,r){null!==this.defaultCamera&&this.defaultCamera.resize(a,r),this.scene.resize(a,r)},Qr.prototype.updateRenderer=function(){null!==this.renderer&&this.rendererConfig.apply(this.renderer)},Qr.prototype.arAvailable=function(){return this.ar&&Lo.arAvailable()},Qr.prototype.enterAR=function(){if(this.arAvailable()&&!this.xrEnabled){var a=this;Lo.enterAR(this.renderer,function(){a.xrMode=Qr.XR_AR,a.xrEnabled=!0})}},Qr.prototype.exitAR=function(){this.xrEnabled&&(Lo.exitAR(this.renderer),this.xrMode=Qr.XR_NONE,this.xrEnabled=!1)},Qr.prototype.vrAvailable=function(){return this.vr&&mi.vrAvailable()},Qr.prototype.enterVR=function(){if(this.vrAvailable()&&!this.xrEnabled){var a=this;mi.enterVR(this.renderer,function(){a.xrMode=Qr.XR_VR,a.xrEnabled=!0})}},Qr.prototype.exitVR=function(){this.vr&&(mi.exitVR(this.renderer),this.xrMode=Qr.XR_NONE,this.xrEnabled=!1)},Qr.prototype.setScene=function(a){"string"==typeof a&&(a=this.getObjectByName(a)),null!==this.scene&&this.scene.dispose(),this.scene=a,null!==this.scene?(null===this.scene.defaultCamera&&(this.scene.defaultCamera=this.defaultCamera),this.scene.initialize(),null!==this.canvas&&this.scene.resize(this.canvas.width,this.canvas.height)):console.warn("nunuStudio: Program setScene scene is null.")},Qr.prototype.remove=function(a){if(a instanceof l.Scene){var r=this.children.indexOf(a);r>-1&&(this.children.splice(r,1),a.parent=null),a===this.scene&&(this.scene.dispose(),this.scene=null),0===this.children.length&&(this.scene=null)}else console.warn("nunuStudio: Trying to remove Object3D from program, only Scene objects allowed.")},Qr.prototype.add=function(a){a instanceof l.Scene?(a.parent=this,this.children.push(a)):console.warn("nunuStudio: Trying to add Object3D to program, only Scene objects allowed.")},Qr.prototype.clone=function(){return(new Ao).parse(this.toJSON())},Qr.prototype.setInitialScene=function(a){this.defaultScene=a.uuid},Qr.prototype.dispose=function(){null!==this.mouse&&(this.lockPointer&&this.mouse.setLock(!1),this.mouse.dispose()),null!==this.keyboard&&this.keyboard.dispose(),this.manager.destroy(),null!==this.scene?this.scene.dispose():console.warn("nunuStudio: Program dispose() scene is null.",this),ko.prototype.dispose.call(this),l.Object3D.prototype.dispose.call(this)},Qr.prototype.receiveDataApp=function(a){var r=!1;this.traverse(function(h){h instanceof Gn&&(h.appData(a),r=!0)}),r||console.warn("nunuStudio: No script with onAppData found",a)},Qr.prototype.sendDataApp=function(a){null!==this.app?void 0!==this.app.onDataReceived?this.app.onDataReceived(a):console.warn("nunuStudio: Send app data communication",a):console.warn("nunuStudio: Data sent to app",a)},Qr.prototype.toJSON=function(a,r){var h=this,d=l.Object3D.prototype.toJSON.call(this,a,function(y){if(!1!==r)for(var b=0;b<N.libraries.length;b++){var R=h[N.libraries[b]];for(var k in R){var M=R[k];void 0===y[N.libraries[b]][M.uuid]&&(y[N.libraries[b]][M.uuid]=M.toJSON(y))}}});return null!==this.defaultScene&&(d.object.defaultScene=this.defaultScene),d.object.author=this.author,d.object.description=this.description,d.object.version=this.version,d.object.lockPointer=this.lockPointer,d.object.handlePixelRatio=this.handlePixelRatio,d.object.ar=this.ar,d.object.vr=this.vr,d.object.vrScale=this.vrScale,d.object.rendererConfig=this.rendererConfig.toJSON(),d},(bs.prototype=Object.create(l.Scene.prototype)).initialize=function(){this.program=this.parent,this.canvas=this.parent.canvas,l.Object3D.prototype.initialize.call(this);for(var a=0;a<this.children.length;a++)this.children[a].traverse(function(r){r.initialize()})},bs.prototype.update=function(a){this.mouse.set(this.program.mouse.position.x/this.canvas.width*2-1,-2*this.program.mouse.position.y/this.canvas.height+1),this.cameras.length>0?this.raycaster.setFromCamera(this.mouse,this.cameras[0]):null!==this.defaultCamera&&this.raycaster.setFromCamera(this.mouse,this.defaultCamera),this.usePhysics&&this.world.step(a<.05?a:.05);for(var r=0;r<this.children.length;r++)this.children[r].traverse(function(h){h.update(a)})},bs.prototype.resize=function(a,r){null!==this.defaultCamera&&this.defaultCamera.resize(a,r);for(var h=0;h<this.cameras.length;h++)this.cameras[h].resize(a,r);for(h=0;h<this.children.length;h++)this.children[h].traverse(function(d){d.resize(a,r)})},bs.prototype.dispose=function(){for(var a=0;a<this.children.length;a++)this.children[a].traverse(function(r){r.dispose()})},bs.prototype.render=function(a){if(a.setClearColor(this.background,this.alpha),this.cameras.length>0)if(this.program.xrEnabled){if(this.program.xrMode===Qr.XR_VR)for(var r=0;r<this.cameras.length;r++)this.cameras[r].render(a,this);else if(this.program.xrMode===Qr.XR_AR)for(a.setClearColor(null),r=0;r<this.cameras.length;r++)a.render(this,this.cameras[r])}else{for(a.setScissorTest(!0),r=0;r<this.cameras.length;r++)this.cameras[r].setupRenderer(a),this.cameras[r].render(a,this);a.setScissorTest(!1)}else null!==this.defaultCamera&&(this.program.xrMode===Qr.XR_AR?(a.setClearColor(null),a.render(this,this.defaultCamera)):this.defaultCamera.render(a,this))},bs.prototype.getCamera=function(a,r){if(void 0===r&&(r=this),a===r.uuid)return r;for(var h=r.children,d=0;d<h.length;d++){var y=this.getCamera(a,h[d]);if(null!==y)return y}return null},bs.prototype.addCamera=function(a){-1===this.cameras.indexOf(a)&&(this.cameras.push(a),this.updateCameraOrder())},bs.prototype.updateCameraOrder=function(){this.cameras.sort(function(a,r){return a.order>r.order})},bs.prototype.removeCamera=function(a){var r=this.cameras.indexOf(a);r>-1&&this.cameras.splice(r,1)},bs.prototype.isCameraActive=function(a){return this.cameras.indexOf(a)>-1},bs.prototype.setFogMode=function(a){var r=null!==this.fog?this.fog.color.getHex():"#FFFFFF";a===l.Fog.LINEAR?this.fog=new l.Fog(r,5,20):a===l.Fog.EXPONENTIAL?this.fog=new l.FogExp2(r,.01):a===l.Fog.NONE&&(this.fog=null)},bs.prototype.toJSON=function(a){if(!this.parent||"Program"!==this.parent.type)return console.warn("nunuStudio: Scene is not on top level serializing as Group."),this.type="Group",l.Object3D.prototype.toJSON.call(this,a);var r=this,h=l.Object3D.prototype.toJSON.call(this,a,function(M,H){r.background instanceof l.Color?H.background=r.background.toJSON(M):r.background instanceof l.Texture&&(H.background=r.background.toJSON(M).uuid),r.environment instanceof l.Texture&&(H.environment=r.environment.toJSON(M).uuid)});if(null!==this.defaultCamera){var d=new l.Vector3,y=new l.Quaternion,b=new l.Vector3;this.defaultCamera.matrixWorld.decompose(d,y,b);var R=this.defaultCamera.toJSON(a);R.object.position=d.toArray(),R.object.quaternion=y.toArray(),R.object.scale=b.toArray(),h.object.defaultCamera=R}null!==this.fog&&(h.object.fog=this.fog.toJSON()),h.object.usePhysics=this.usePhysics,h.object.cameras=[];for(var k=0;k<this.cameras.length;k++)h.object.cameras.push(this.cameras[k].uuid);return h.object.world={},h.object.world.gravity=this.world.gravity,h.object.world.quatNormalizeSkip=this.world.quatNormalizeSkip,h.object.world.quatNormalizeFast=this.world.quatNormalizeFast,h.object.world.solver={},h.object.world.solver.tolerance=this.world.solver.tolerance,h.object.world.solver.iterations=this.world.solver.iterations,h},(iu.prototype=Object.create(l.AnimationMixer.prototype)).createActions=function(a){for(var r=0;r<a.length;r++){var h=this.clipAction(a[r]);h.setLoop(a[r].loop),h.weight=a[r].weight,h.timeScale=a[r].timeScale,h.enabled=a[r].enabled,h.play()}return this._actions},iu.prototype.setTime=function(a){this.time=a;for(var r=0;r<this._actions.length;r++)this._actions[r].time=a;this.update(0,!0)},iu.prototype.play=function(){this.playing=!0},iu.prototype.stop=function(){this.setTime(0),this.playing=!1},iu.prototype.pause=function(){this.playing=!1},iu.prototype.dispose=function(){this.stopAllAction(),this.uncacheRoot(this._root)},iu.prototype.update=function(a,r){if(this.playing||r){this.time+=a;for(var h=Math.sign(a),d=0;d<this._actions.length;d++)this._actions[d]._update(this.time,a,h,this._accuIndex);for(d=0;d<this._bindings.length;d++)this._bindings[d].apply(this._accuIndex)}return this};var Ds=__webpack_require__(412);Ds.Object3D.prototype.folded=!1,Ds.Object3D.prototype.locked=!1,Ds.Object3D.prototype.contains=function(a){for(var r=0;r<this.children.length;r++)if(this.children[r].uuid===a.uuid||this.children[r].contains(a))return!0;return!1},Ds.Object3D.prototype.playAnimation=function(){void 0!==this.mixer&&this.mixer.play()},Ds.Object3D.prototype.stopAnimation=function(){void 0!==this.mixer&&this.mixer.stop()},Ds.Object3D.prototype.initialize=function(){void 0!==this.animations&&(this.mixer=new iu(this),this.mixer.createActions(this.animations),this.mixer.play())},Ds.Object3D.prototype.update=function(a){void 0!==this.mixer&&this.mixer.update(a)},Ds.Object3D.prototype.resize=function(a,r){},Ds.Object3D.prototype.dispose=function(){void 0!==this.mixer&&this.mixer.dispose()},Ds.Object3D.prototype.addAbove=function(a,r){if(a===this)return console.error("Object3D.add: object can't be added as a child of itself.",a),this;if(a&&a.isTHREE.Object3D){null!==a.parent&&a.parent.remove(a),a.parent=this,a.dispatchEvent({type:"added"});var h=this.children.indexOf(r);this.children.splice(h,0,a)}else console.error("Object3D.add: object not an instance of THREE.Object3D.",a);return this},Ds.Object3D.prototype.addBellow=function(a,r){if(a===this)return console.error("Object3D.add: object can't be added as a child of itself.",a),this;if(a&&a.isTHREE.Object3D){null!==a.parent&&a.parent.remove(a),a.parent=this,a.dispatchEvent({type:"added"});var h=this.children.indexOf(r)+1;this.children.splice(h,0,a)}else console.error("Object3D.add: object not an instance of THREE.Object3D.",a);return this},Ds.Object3D.prototype.getScene=function(){for(var a=this;null!==a.parent;)if((a=a.parent)instanceof bs)return a;return null},Ds.Object3D.prototype.removeAll=function(){for(;this.children.length>0;)this.remove(this.children[0])},Ds.Object3D.prototype.isEmpty=function(){return 0===this.children.length},Ds.Object3D.prototype.destroy=function(){for(;this.children.length>0;)this.children[0].destroy();null!==this.parent&&(this.dispose&&this.dispose(),this.parent.remove(this),this.parent=null)},Ds.Object3D.prototype.toJSON=function(a,r,h){var d=void 0===a,y={};d&&(a=new N,y.metadata={version:VERSION,type:"Object3D"});var b={};if(b.uuid=this.uuid,b.type=this.type,b.name=this.name,b.folded=this.folded,b.locked=this.locked,b.castShadow=this.castShadow,b.receiveShadow=this.receiveShadow,b.visible=this.visible,b.matrixAutoUpdate=this.matrixAutoUpdate,b.frustumCulled=this.frustumCulled,b.renderOrder=this.renderOrder,b.position=this.position.toArray(),b.quaternion=this.quaternion.toArray(),b.scale=this.scale.toArray(),b.layers=this.layers.mask,b.userData=this.userData,void 0!==this.geometry){b.geometry=ne(a.geometries,this.geometry);var R=this.geometry.parameters;if(void 0!==R&&void 0!==R.shapes){var k=R.shapes;if(Array.isArray(k))for(var M=0,H=k.length;M<H;M++)ne(a.shapes,k[M]);else ne(a.shapes,k)}}if(void 0!==this.material)if(this.material instanceof l.Material)b.material=ne(a.materials,this.material);else if(this.material instanceof Array){var oe=[];for(M=0;M<this.material.length;M++)oe.push(ne(a.materials,this.material[M]));b.material=oe}if(void 0!==this.animations&&this.animations.length>0)for(b.animations=[],M=0;M<this.animations.length;M++)b.animations.push(l.AnimationClip.toJSON(this.animations[M]));if(y.object=b,void 0!==r&&r(a,b,y),!1!==h&&this.children.length>0)for(b.children=[],M=0;M<this.children.length;M++)this.children[M].locked||b.children.push(this.children[M].toJSON(a).object);return d&&(y.geometries=ge(a.geometries),y.materials=ge(a.materials),y.textures=ge(a.textures),y.images=ge(a.images),y.videos=ge(a.videos),y.audio=ge(a.audio),y.fonts=ge(a.fonts),y.skeletons=ge(a.skeletons),y.resources=ge(a.resources),y.shapes=ge(a.shapes)),y;function ne(we,Se){return void 0===we[Se.uuid]&&(we[Se.uuid]=Se.toJSON(a)),Se.uuid}function ge(we){var Se=[];for(var Ce in we){var Pe=we[Ce];delete Pe.metadata,Se.push(Pe)}return Se}},__webpack_require__(870);var _f=__webpack_require__(412),$c={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array},Wp=function(a){if(void 0!==a.array){var r=new $c[a.type](a.array),h=new(a.isInstancedBufferAttribute?l.InstancedBufferAttribute:l.BufferAttribute)(r,a.itemSize,a.normalized);return void 0!==a.name&&(h.name=a.name),h}if("BufferAttribute"===a.type)r=new $c[a.typedArray.type](a.typedArray.array),h=new l.BufferAttribute(r,a.itemSize,a.normalized);else if("InstancedBufferAttribute"===a.type)r=new $c[a.typedArray.type](a.typedArray.array),h=new l.InstancedBufferAttribute(r,a.itemSize,a.normalized,a.meshPerAttribute);else if("InterleavedBufferAttribute"===a.type){r=new $c[a.data.typedArray.type](a.data.typedArray.array);var d=new l.InterleavedBuffer(r,a.data.stride);d.setUsage(a.data.usage),d.count=a.data.count,h=new l.InterleavedBufferAttribute(d,a.itemSize,a.offset,a.normalized)}return void 0!==a.name&&(h.name=a.name),h};_f.BufferGeometryLoader.prototype.parse=function(a){var r=a.isInstancedBufferGeometry?new l.InstancedBufferGeometry:new l.BufferGeometry,h=a.data.index;if(void 0!==h){var d=new $c[h.type](h.array);r.setIndex(new l.BufferAttribute(d,1))}var y=a.data.attributes;for(var b in y)r.setAttribute(b,Wp(y[b]));var R=a.data.morphAttributes;if(R)for(var b in R){for(var k=R[b],M=[],H=0,X=k.length;H<X;H++)M.push(Wp(k[H]));r.morphAttributes[b]=M}a.data.morphTargetsRelative&&(r.morphTargetsRelative=!0);var oe=a.data.groups||a.data.drawcalls||a.data.offsets;if(void 0!==oe){H=0;for(var ne=oe.length;H!==ne;++H){var ge=oe[H];r.addGroup(ge.start,ge.count,ge.materialIndex)}}var we=a.data.boundingSphere;if(void 0!==we){var Se=new l.Vector3;void 0!==we.center&&Se.fromArray(we.center),r.boundingSphere=new l.Sphere(Se,we.radius)}return a.name&&(r.name=a.name),a.userData&&(r.userData=a.userData),r};var Ih=__webpack_require__(412);Ih.Material.prototype.dispose=function(){function a(r){r?.dispose()}this.dispatchEvent({type:"dispose"}),a(this.map),a(this.bumpMap),a(this.normalMap),a(this.displacementMap),a(this.specularMap),a(this.emissiveMap),a(this.alphaMap),a(this.roughnessMap),a(this.metalnessMap),a(this.envMap)},Ih.Material.prototype.toJSON=function(a){void 0===a&&(a={textures:{},images:{},videos:{}});var r={};function h(R){var k=[];for(var M in R){var H=R[M];delete H.metadata,k.push(H)}return k}if(r.uuid=this.uuid,r.type=this.type,r.name=this.name,r.toneMapped=this.toneMapped,r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,this.color&&this.color.isColor&&(r.color=this.color.getHex()),void 0!==this.roughness&&(r.roughness=this.roughness),void 0!==this.metalness&&(r.metalness=this.metalness),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),void 0!==this.shininess&&(r.shininess=this.shininess),void 0!==this.clearcoat&&(r.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(r.clearcoatRoughness=this.clearcoatRoughness),void 0!==this.transmission&&(r.transmission=this.transmission),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(a).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(a).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(a).uuid),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(a).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(a).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(a).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(a).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(a).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(a).uuid),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),1!==this.emissiveIntensity&&(r.emissiveIntensity=this.emissiveIntensity),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(a).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(a).uuid),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(a).uuid),this.aoMapIntensity&&(r.aoMapIntensity=this.aoMapIntensity),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(a).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(a).uuid,r.reflectivity=this.reflectivity,this.combine&&(r.combine=this.combine),this.envMapIntensity&&(r.envMapIntensity=this.envMapIntensity),this.refractionRatio&&(r.refractionRatio=this.refractionRatio)),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(a).uuid),void 0!==this.size&&(r.size=this.size),void 0!==this.sizeAttenuation&&(r.sizeAttenuation=this.sizeAttenuation),void 0!==this.rotation&&(r.rotation=this.rotation),void 0!==this.linewidth&&(r.linewidth=this.linewidth),void 0!==this.dashSize&&(r.dashSize=this.dashSize),void 0!==this.gapSize&&(r.gapSize=this.gapSize),void 0!==this.scale&&(r.scale=this.scale),this.blending!==l.NormalBlending&&(r.blending=this.blending),this.side!==l.FrontSide&&(r.side=this.side),this.vertexColors!==l.NoColors&&(r.vertexColors=this.vertexColors),r.flatShading=this.flatShading,this.opacity<1&&(r.opacity=this.opacity),!0===this.transparent&&(r.transparent=this.transparent),!0===this.dithering&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(r.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(r.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(r.wireframeLinejoin=this.wireframeLinejoin),r.skinning=this.skinning,r.morphTargets=this.morphTargets,void 0!==this.morphNormals&&(r.morphNormals=this.morphNormals),void 0===a){var d=h(a.textures),y=h(a.images),b=h(a.videos);d.length>0&&(r.textures=d),y.length>0&&(r.images=y),b.length>0&&(r.videos=b)}return r},__webpack_require__(412).Points.prototype.raycast=function(a,r){null===this.geometry.boundingBox&&this.geometry.computeBoundingBox();var h=new l.Box3;h.copy(this.geometry.boundingBox),h.applyMatrix4(this.matrixWorld),null!==a.ray.intersectBox(h,new l.Vector3)&&r.push({object:this})};var Cc,ha,ad,Cd,Oh=__webpack_require__(412);function ho(){}function Cr(){}function Hr(){this.vendor=-1,this.product=-1,this.connected=!1,this.gamepad=null,this.buttons=[];for(var a=navigator.getGamepads(),r=0;r<a.length;r++)if(null!==a[r]){this.setGamepad(a[r]);break}null===this.gamepad&&console.warn("nunuStudio: No gamepad found")}function pa(){this.alpha=0,this.beta=0,this.gamma=0,this.orientation=0,this.events=new dn;var a=this;this.events.add(window,"orientationchange",function(r){a.orientation=l.Math.degToRad(window.orientation)}),this.events.add(window,"deviceorientation",function(r){a.alpha=l.Math.degToRad(r.alpha),a.beta=l.Math.degToRad(r.beta),a.gamma=l.Math.degToRad(r.gamma)}),this.events.create()}function Lc(a){this.size=new l.Vector2(2,2),this.halfSize=new l.Vector2(1,1),this.matrix=new l.Matrix4,this.cache={camera:{fov:0,style:""},objects:new WeakMap},this.domElement=void 0!==a?a:document.createElement("div"),this.domElement.style.overflow="hidden",this.domElement.style.pointerEvents="none",this.cameraElement=document.createElement("div"),this.cameraElement.style.WebkitTransformStyle="preserve-3d",this.cameraElement.style.transformStyle="preserve-3d",this.domElement.appendChild(this.cameraElement)}function Lu(a){sl.call(this,a)}function kh(a){Aa.call(this),this.format="url",this.encoding=Bn.getFileExtension(a),this.data=a}function Bu(a,r,h){this.bufferGeometry=!1,this.direction=new l.Vector3(0,1,0),this.angle=void 0!==a?a:Math.PI,this.start=void 0!==r?r:0,this.end=void 0!==h?h:1}function ou(){this.events=[]}function nr(a,r){this.x=a||0,this.y=r||0}function Si(a){void 0!==a?this.m=a:this.identity()}function hh(){}function Nn(){this.uuid=hh.generate(),this.children=[],this.parent=null,this.level=0,this.position=new nr(0,0),this.origin=new nr(0,0),this.scale=new nr(1,1),this.rotation=0,this.visible=!0,this.layer=0,this.matrix=new Si,this.globalMatrix=new Si,this.inverseGlobalMatrix=new Si,this.masks=[],this.matrixAutoUpdate=!0,this.matrixNeedsUpdate=!0,this.draggable=!1,this.pointerEvents=!0,this.ignoreViewport=!1,this.saveContextState=!0,this.restoreContextState=!0,this.pointerInside=!1,this.beingDragged=!1,this.serializable=!0}function Jo(){this.pressed=!1,this.justPressed=!1,this.justReleased=!1}function Pi(a,r){this._keys=new Array(5),this._position=new nr(0,0),this._positionUpdated=!1,this._delta=new nr(0,0),this._wheel=0,this._wheelUpdated=!1,this._doubleClicked=new Array(5),this.keys=new Array(5),this.position=new nr(0,0),this.delta=new nr(0,0),this.wheel=0,this.doubleClicked=new Array(5),this.domElement=void 0!==a?a:window,this.canvas=null,void 0!==r&&this.setCanvas(r),this.events=new ou;for(var h=0;h<5;h++)this._doubleClicked[h]=!1,this.doubleClicked[h]=!1,this._keys[h]=new Jo,this.keys[h]=new Jo;var d=this;if(void 0!==window.onmousewheel?this.events.add(this.domElement,"mousewheel",function(b){d._wheel=b.deltaY,d._wheelUpdated=!0}):void 0!==window.addEventListener?this.events.add(this.domElement,"DOMMouseScroll",function(b){d._wheel=30*b.detail,d._wheelUpdated=!0}):this.events.add(this.domElement,"wheel",function(b){d._wheel=b.deltaY,d._wheelUpdated=!0}),void 0!==window.ontouchstart||navigator.msMaxTouchPoints>0){var y=new nr(0,0);this.events.add(this.domElement,"touchstart",function(b){var R=b.touches[0];d.updatePosition(R.clientX,R.clientY,0,0),d.updateKey(Pi.LEFT,Jo.DOWN),y.set(R.clientX,R.clientY)}),this.events.add(this.domElement,"touchend",function(b){d.updateKey(Pi.LEFT,Jo.UP)}),this.events.add(this.domElement,"touchcancel",function(b){d.updateKey(Pi.LEFT,Jo.UP)}),this.events.add(document.body,"touchmove",function(b){var R=b.touches[0];d.updatePosition(R.clientX,R.clientY,R.clientX-y.x,R.clientY-y.y),y.set(R.clientX,R.clientY)})}this.events.add(this.domElement,"mousemove",function(b){d.updatePosition(b.clientX,b.clientY,b.movementX,b.movementY)}),this.events.add(this.domElement,"mousedown",function(b){d.updateKey(b.which-1,Jo.DOWN)}),this.events.add(this.domElement,"mouseup",function(b){d.updateKey(b.which-1,Jo.UP)}),this.events.add(this.domElement,"dragstart",function(b){d.updateKey(b.which-1,Jo.UP)}),this.events.add(this.domElement,"dblclick",function(b){d._doubleClicked[b.which-1]=!0}),this.create()}function ap(a){this.uuid=hh.generate(),this.canvas=a,this.position=new nr(0,0),this.scale=1,this.rotation=0,this.matrix=new Si,this.inverseMatrix=new Si,this.matrixNeedsUpdate=!0,this.moveOnScale=!1,this.rotationPoint=null}function lp(a){this.viewport=a,this.dragButton=Pi.RIGHT,this.allowScale=!0,this.moveOnScale=!1,this.allowRotation=!0,this.rotationPoint=null,this.rotationInitial=0}function Js(a){this.callback=a,this.running=!1,this.id=-1}function ph(a,r){void 0===r&&(r={alpha:!0,imageSmoothingEnabled:!0,imageSmoothingQuality:"low",globalCompositeOperation:"source-over"}),this.canvas=a,this.container=null,this.context=this.canvas.getContext("2d",{alpha:r.alpha}),this.context.imageSmoothingEnabled=r.imageSmoothingEnabled,this.context.imageSmoothingQuality=r.imageSmoothingQuality,this.context.globalCompositeOperation=r.globalCompositeOperation,this.pointer=new Pi(window,this.canvas),this.autoClear=!0}function qi(a,r){this.min=void 0!==a?a:new nr,this.max=void 0!==r?r:new nr}function da(){Nn.call(this)}function pl(){da.call(this),this.box=new qi(new nr(-50,-35),new nr(50,35)),this.invert=!1}function po(){this.cache=null,this.needsUpdate=!0}function us(a){po.call(this),this.color=a||"#000000"}function Go(){Nn.call(this),this.box=new qi(new nr(-50,-50),new nr(50,50)),this.strokeStyle=new us("#000000"),this.lineWidth=1,this.fillStyle=new us("#FFFFFF")}function to(){Nn.call(this),this.radius=10,this.strokeStyle=new us("#000000"),this.lineWidth=1,this.fillStyle=new us("#FFFFFF")}function Zo(){Nn.call(this),this.from=new nr,this.to=new nr,this.dashPattern=[5,5],this.strokeStyle=new us("#000000"),this.lineWidth=1}function $a(){Nn.call(this),this.text="",this.font="16px Arial",this.strokeStyle=null,this.lineWidth=1,this.fillStyle=new us("#000000"),this.textAlign="center",this.textBaseline="middle"}function Fh(a){Nn.call(this),this.box=new qi,this.image=document.createElement("img"),void 0!==a&&this.setImage(a)}function oo(a){Nn.call(this),this.parentElement=null,this.element=document.createElement(a||"div"),this.element.style.transformStyle="preserve-3d",this.element.style.position="absolute",this.element.style.top="0px",this.element.style.bottom="0px",this.element.style.transformOrigin="0px 0px",this.element.style.overflow="auto",this.element.style.pointerEvents="none",this.size=new nr(100,100)}function Us(a){Nn.call(this),this.box=new qi,this.image=document.createElement("img"),this.repetition="repeat",void 0!==a&&this.setImage(a)}function dh(){$a.call(this),this.maxWidth=null,this.lineHeight=null}function Wa(){Zo.call(this),this.fromCp=new nr,this.toCp=new nr}function Bc(){Zo.call(this),this.controlPoint=new nr}function fo(){Go.call(this),this.radius=5}function dl(){Nn.call(this),this.box=new qi(new nr(-50,-35),new nr(50,35)),this.strokeStyle=new us("rgb(0, 153, 255)"),this.lineWidth=1,this.fillStyle=new us("rgba(0, 153, 255, 0.3)"),this.min=0,this.max=10,this.data=[]}function nf(a,r){this.offset=a,this.color=r}function $i(){po.call(this),this.colors=[]}function Nu(){$i.call(this),this.start=new nr(-100,0),this.end=new nr(100,0)}function Nc(){Nn.call(this),this.value=50,this.min=0,this.max=100,this.radius=80,this.lineWidth=10,this.startAngle=Math.PI,this.endAngle=2*Math.PI,this.dial=!1,this.baseStyle=new us("#e9ecf1"),this.barStyle=new Nu,this.barStyle.start.set(-100,0),this.barStyle.end.set(100,0),this.barStyle.addColorStop(0,"#e5ff50"),this.barStyle.addColorStop(.5,"#50ff67"),this.barStyle.addColorStop(1,"#32adff")}function Ru(a){po.call(this),this.source=a||document.createElement("img"),this.repetition="repeat",this.matrix=new Si}function su(){$i.call(this),this.start=new nr(0,0),this.startRadius=10,this.end=new nr(0,0),this.endRadius=50}function zs(){Nn.call(this)}function Pu(){Wa.call(this),this.lineWidth=2,this.outputSocket=null,this.inputSocket=null}function Ei(a,r,h,d){to.call(this),this.draggable=!0,this.radius=6,this.layer=1,this.name=void 0!==d?d:"",this.category=void 0!==h?h:"",this.multiple=!0,this.direction=r,this.node=a,this.connectors=[],this.creatingConnection=!1,this.text=new $a,this.text.text=this.name,this.direction===Ei.INPUT?(this.text.position.x-=10,this.text.textAlign="right"):this.direction===Ei.OUTPUT&&(this.text.position.x+=10,this.text.textAlign="left"),this.add(this.text)}function fa(){fo.call(this),this.draggable=!0,this.inputs=[],this.outputs=[]}function rf(){}function Ci(){}function ma(){l.Group.call(this),this.type="NodeScript",this.name="script",this.graph=new zs}function tc(a,r){this.uuid=l.Math.generateUUID(),this.data=a,this.callback=r}function Il(a,r){this.size=r,this.file=a,this.workers=[],this.next=0,this.createWorkers(),this.tasks={}}function Ld(a,r){this.callback=a,this.time=r,this.running=!1,this.id=-1}function Iu(a){this.callback=a,this.running=!1,this.id=-1}function Ol(){}function fl(){}Oh.Skeleton.prototype.toJSON=function(){var a={};void 0===this.uuid&&(this.uuid=l.Math.generateUUID()),a.uuid=this.uuid,a.bones=[];for(var r=0;r<this.bones.length;r++)a.bones.push(this.bones[r].uuid);for(a.boneInverses=[],r=0;r<this.boneInverses.length;r++)a.boneInverses.push(this.boneInverses[r].toArray());return a},Oh.Skeleton.fromJSON=function(a,r){for(var h=[],d=[],y=0;y<a.bones.length;y++){var b=r.getObjectByProperty("uuid",a.bones[y]);void 0===b&&(console.warn("Skeleton.fromJSON: Not found Bone with uuid "+a.bones[y]),b=new l.Bone),h.push(b),d.push((new l.Matrix4).fromArray(a.boneInverses[y]))}var R=new Oh.Skeleton(h,d);return R.uuid=a.uuid,R},__webpack_require__(819),__webpack_require__(412).Texture.prototype.toJSON=function(a){if(void 0!==a.textures[this.uuid])return a.textures[this.uuid];var r={metadata:{version:VERSION,type:"Texture"},uuid:this.uuid,name:this.name,category:this.category,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return a.textures[this.uuid]=r,r},ho.NAME="nunuStudio",ho.NWJS=200,ho.BROWSER=201,ho.CORDOVA=202,ho.copyNamespace=function(a,r){for(var h in void 0===r&&(r=window),a)h in r||(r[h]=a[h])},ho.getQueryParameters=function(){for(var a=location.search.substring(1).split("&"),r={},h=0;h<a.length;h++){var d=a[h].split("=");if(d.length>1){var y=unescape(d[0]).replace(new RegExp('"',"g"),""),b=unescape(d[1]).replace(new RegExp('"',"g"),"");r[y]=b}}return r},ho.createWorker=function(a,r){var h=new Blob([a],{type:"application/javascript"}),d=new Worker(URL.createObjectURL(h));return void 0!==r&&(d.onmessage=r),d},ho.webAudioAvailable=function(){return void 0!==window.AudioContext||void 0!==window.webkitAudioContext},ho.webGLAvailable=function(){try{var a=document.createElement("canvas");return(a.getContext("webgl")||a.getContext("experimental-webgl")).getSupportedExtensions(),!0}catch{}return!1},ho.getPlatform=function(){return void 0!==window.nw?ho.NWJS:void 0!==window.cordova?ho.CORDOVA:ho.BROWSER},ho.runningOnDesktop=function(){return void 0!==window.nw},ho.openWebpage=function(a){ho.runningOnDesktop()?window.require("nw.gui").Shell.openExternal(a):window.open(a)},ho.isFullscreen=function(){return!0===document.webkitIsFullScreen||!0===document.mozFullScreen||!0===document.webkitIsFullScreen||!0===document.webkitIsFullScreen||!0===document.fullscreen||!1},ho.setFullscreen=function(a,r){var h=ho.isFullscreen();void 0===a&&(a=!h),!0===a?(void 0===r&&(r=document.body),!1===h&&(r.requestFullscreen=r.requestFullscreen||r.mozRequestFullScreen||r.webkitRequestFullscreen||r.msRequestFullscreen,void 0!==r.requestFullscreen&&r.requestFullscreen())):!0===h&&(document.exitFullscreen=document.exitFullscreen||document.mozCancelFullScreen||document.webkitExitFullscreen,void 0!==document.exitFullscreen&&document.exitFullscreen())},Cr.ARROW_LEFT=37,Cr.ARROW_UP=38,Cr.ARROW_RIGHT=39,Cr.ARROW_DOWN=40,Cr.ENTER=13,Cr.BACK=10009,Cr.VOLUME_UP=447,Cr.VOLUME_DOWN=448,Cr.VOLUME_MUTE=449,Cr.CHANNEL_UP=427,Cr.CHANNEL_DOWN=428,Cr.F0_RED=403,Cr.F1_GREEN=404,Cr.F2_YELLOW=405,Cr.F3_BLUE=406,Cr.NUM_0=48,Cr.NUM_1=49,Cr.NUM_2=50,Cr.NUM_3=51,Cr.NUM_4=52,Cr.NUM_5=53,Cr.NUM_6=54,Cr.NUM_7=55,Cr.NUM_8=56,Cr.NUM_9=57,Cr.MINUS=189,Cr.E_MANUAL=10146,Cr.PREVIOUS_CHANNEL=10190,Cr.PICTURE_SIZE=10140,Cr.SOCCER=10228,Cr.TELETEXT=10200,Cr.SEARCH=10225,Cr.GUIDE=458,Cr.SOURCE=10072,Cr.EXTRA=10253,Cr.MTS=10195,Cr.MEDIA_PLAY_PAUSE=10252,Cr.MENU=18,Cr.MEDIA_REWIND=412,Cr.TOOLS=10135,Cr.MEDIA_FAST_FORWARD=417,Cr.INFO=457,Cr.MEDIA_PLAY=415,Cr.EXIT=10182,Cr.MEDIA_PAUSE=19,Cr.MEDIA_STOP=413,Cr.CAPTION=10221,Cr.MEDIA_RECORD=416,Cr.CHANNEL_LIST=10073,Cr.MEDIA_TRACK_PREVIOUS=10232,Cr.MEDIA_TRACK_NEXT=10233,Cr.MEDIA_3D=10199,(Hr.prototype=Hr).constructor=Hr,Hr.prototype.setGamepad=function(a){if(null!=a){this.index=a.index,this.gamepad=a,this.buttons=[];for(var r=0;r<a.buttons.length;r++)this.buttons.push(new oi);this.setProductVendor(a),this.connected=!0}else console.warn("nunuStudio: No gamepad found"),this.disconnect()},Hr.prototype.disconnect=function(){this.vendor=-1,this.product=-1,this.connected=!1,this.gamepad=null,this.buttons=[]},Hr.prototype.setProductVendor=function(a){try{var r=a.id.split(":");return this.vendor=r[1].split(" ")[1],void(this.product=r[2].replace(" ","").replace(")",""))}catch{}try{return r=a.id.split("-"),this.vendor=r[0],void(this.product=r[1])}catch{}},Hr.prototype.update=function(a){if(this.gamepad=navigator.getGamepads()[this.index],void 0!==this.gamepad)for(var r=0;r<this.buttons.length;r++)this.buttons[r].update(this.gamepad.buttons[r].pressed?oi.DOWN:oi.UP)},Hr.prototype.getAnalogueButton=function(a){return a>this.buttons.length||a<0?0:this.gamepad.buttons[a].value},Hr.prototype.getAxis=function(a){return a>this.gamepad.axes.length||a<0?0:this.gamepad.axes[a]},Hr.prototype.buttonExists=function(a){return a>=0&&a<this.buttons.length},Hr.prototype.buttonPressed=function(a){return!!this.buttons[a]&&this.buttons[a].pressed},Hr.prototype.buttonJustPressed=function(a){return!!this.buttons[a]&&this.buttons[a].justPressed},Hr.prototype.buttonJustReleased=function(a){return!!this.buttons[a]&&this.buttons[a].justReleased},Hr.LEFT=14,Hr.RIGHT=15,Hr.DOWN=13,Hr.UP=12,Hr.SELECT=8,Hr.START=9,Hr.HOME=16,Hr.LEFT_TRIGGER_A=4,Hr.LEFT_TRIGGER_B=6,Hr.RIGHT_TRIGGER_A=5,Hr.RIGHT_TRIGGER_B=7,Hr.L1=4,Hr.L2=6,Hr.L3=6,Hr.R1=5,Hr.R2=7,Hr.R3=11,Hr.A=0,Hr.B=1,Hr.C=2,Hr.D=3,Hr.X=2,Hr.Y=3,Hr.LEFT_ANALOGUE_BUT=10,Hr.LEFT_ANALOGUE_HOR=0,Hr.LEFT_ANALOGUE_VERT=1,Hr.RIGHT_ANALOGUE_BUT=11,Hr.RIGHT_ANALOGUE_HOR=2,Hr.RIGHT_ANALOGUE_VERT=3,pa.prototype.setObjectQuaternion=(Cc=new l.Euler,ha=new l.Quaternion,ad=new l.Vector3(0,0,1),Cd=new l.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5)),function(a){Cc.set(this.beta,this.alpha,-this.gamma,"YXZ"),a.quaternion.setFromEuler(Cc),a.quaternion.multiply(Cd),a.quaternion.multiply(ha.setFromAxisAngle(ad,-this.orientation))}),pa.prototype.dispose=function(){this.events.destroy()},Lc.prototype.getSize=function(){return{width:this.size.x,height:this.size.y}},Lc.prototype.setSize=function(a,r){this.size.set(a,r),this.halfSize.set(a/2,r/2),this.domElement.style.width=a+"px",this.domElement.style.height=r+"px",this.cameraElement.style.width=a+"px",this.cameraElement.style.height=r+"px"},Lc.prototype.render=function(a,r){function h(M){var H=M.elements;return"matrix3d("+H[0]+","+-H[1]+","+H[2]+","+H[3]+","+H[4]+","+-H[5]+","+H[6]+","+H[7]+","+H[8]+","+-H[9]+","+H[10]+","+H[11]+","+H[12]+","+-H[13]+","+H[14]+","+H[15]+")"}function d(M,H){var X=M.elements;return"translate(-50%,-50%)matrix3d("+X[0]+","+X[1]+","+X[2]+","+X[3]+","+-X[4]+","+-X[5]+","+-X[6]+","+-X[7]+","+X[8]+","+X[9]+","+X[10]+","+X[11]+","+X[12]+","+X[13]+","+X[14]+","+X[15]+")"}var y,b=this,R=r.projectionMatrix.elements[5]*this.halfSize.y;this.cache.camera.fov!==R&&(r.isPerspectiveCamera&&(this.domElement.style.WebkitPerspective=R+"px",this.domElement.style.perspective=R+"px"),this.cache.camera.fov=R),a.updateMatrixWorld(),null===r.parent&&r.updateMatrixWorld();var k=(y=r.isOrthographicCamera?"scale("+R+")translate("+-(r.right+r.left)/2+"px,"+(r.top+r.bottom)/2+"px)"+h(r.matrixWorldInverse):"translateZ("+R+"px)"+h(r.matrixWorldInverse))+"translate("+this.halfSize.x+"px,"+this.halfSize.y+"px)";this.cache.camera.style!==k&&(this.cameraElement.style.WebkitTransform=k,this.cameraElement.style.transform=k,this.cache.camera.style=k),function M(H,X,oe){if(!0===H.isCSS3DObject){var ne;!0===H.isCSS3DSprite?(matrix.copy(X.matrixWorldInverse),matrix.transpose(),matrix.copyPosition(H.matrixWorld),matrix.scale(H.scale),matrix.elements[3]=0,matrix.elements[7]=0,matrix.elements[11]=0,matrix.elements[15]=1,ne=d(matrix)):ne=d(H.matrixWorld);var ge=H.element,we=b.cache.objects.get(H);void 0!==we&&we.style===ne||(ge.style.WebkitTransform=ne,ge.style.transform=ne,b.cache.objects.set(H,{style:ne})),ge.parentNode!==b.cameraElement&&b.cameraElement.appendChild(ge)}for(var Se=0,Ce=H.children.length;Se<Ce;Se++)M(H.children[Se],X,oe)}(a,r,y)},(Lu.prototype=Object.create(sl.prototype)).constructor=Lu,Lu.prototype.isCSS3DSprite=!0,kh.prototype=Object.create(Aa.prototype),Bu.prototype.modify=function(a){a instanceof l.BufferGeometry?((a=new l.Geometry).fromBufferGeometry(Editor.selection[0].geometry),a.mergeVertices()):a=a.clone();for(var r=new l.Quaternion,h=0;h<a.vertices.length;h++){var d=a.vertices[h].y;d>=this.start&&d<=this.end?(r.setFromAxisAngle(this.direction,this.angle*((d-this.start)/(this.end-this.start))),a.vertices[h].applyQuaternion(r)):d>this.end&&(r.setFromAxisAngle(this.direction,this.angle),a.vertices[h].applyQuaternion(r))}if(a.computeVertexNormals(),a.verticesNeedUpdate=!0,this.bufferGeometry){var b=new l.BufferGeometry;return b.fromGeometry(a),b}return a},ou.prototype.add=function(a,r,h){this.events.push([a,r,h,!1])},ou.prototype.clear=function(){this.destroy(),this.events=[]},ou.prototype.create=function(){for(var a=0;a<this.events.length;a++){var r=this.events[a];r[0].addEventListener(r[1],r[2]),r[3]=!0}},ou.prototype.destroy=function(){for(var a=0;a<this.events.length;a++){var r=this.events[a];r[0].removeEventListener(r[1],r[2]),r[3]=!1}},nr.prototype.set=function(a,r){this.x=a,this.y=r},nr.prototype.setScalar=function(a){this.x=a,this.y=a},nr.prototype.clone=function(){return new nr(this.x,this.y)},nr.prototype.copy=function(a){this.x=a.x,this.y=a.y},nr.prototype.add=function(a){this.x+=a.x,this.y+=a.y},nr.prototype.addScalar=function(a){this.x+=a,this.y+=a},nr.prototype.addVectors=function(a,r){this.x=a.x+r.x,this.y=a.y+r.y},nr.prototype.addScaledVector=function(a,r){this.x+=a.x*r,this.y+=a.y*r},nr.prototype.sub=function(a){this.x-=a.x,this.y-=a.y},nr.prototype.subScalar=function(a){this.x-=a,this.y-=a},nr.prototype.subVectors=function(a,r){this.x=a.x-r.x,this.y=a.y-r.y},nr.prototype.multiply=function(a){this.x*=a.x,this.y*=a.y},nr.prototype.multiplyScalar=function(a){this.x*=a,this.y*=a},nr.prototype.divide=function(a){this.x/=a.x,this.y/=a.y},nr.prototype.divideScalar=function(a){return this.multiplyScalar(1/a)},nr.prototype.min=function(a){this.x=Math.min(this.x,a.x),this.y=Math.min(this.y,a.y)},nr.prototype.max=function(a){this.x=Math.max(this.x,a.x),this.y=Math.max(this.y,a.y)},nr.prototype.clamp=function(a,r){this.x=Math.max(a.x,Math.min(r.x,this.x)),this.y=Math.max(a.y,Math.min(r.y,this.y))},nr.prototype.clampScalar=function(a,r){this.x=Math.max(a,Math.min(r,this.x)),this.y=Math.max(a,Math.min(r,this.y))},nr.prototype.clampLength=function(a,r){var h=this.length();return this.divideScalar(h||1).multiplyScalar(Math.max(a,Math.min(r,h)))},nr.prototype.floor=function(){this.x=Math.floor(this.x),this.y=Math.floor(this.y)},nr.prototype.ceil=function(){this.x=Math.ceil(this.x),this.y=Math.ceil(this.y)},nr.prototype.round=function(){this.x=Math.round(this.x),this.y=Math.round(this.y)},nr.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},nr.prototype.dot=function(a){return this.x*a.x+this.y*a.y},nr.prototype.cross=function(a){return this.x*a.y-this.y*a.x},nr.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},nr.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},nr.prototype.manhattanLength=function(){return Math.abs(this.x)+Math.abs(this.y)},nr.prototype.normalize=function(){return this.divideScalar(this.length()||1)},nr.prototype.angle=function(){var a=Math.atan2(this.y,this.x);return a<0&&(a+=2*Math.PI),a},nr.prototype.distanceTo=function(a){return Math.sqrt(this.distanceToSquared(a))},nr.prototype.distanceToSquared=function(a){var r=this.x-a.x,h=this.y-a.y;return r*r+h*h},nr.prototype.manhattanDistanceTo=function(a){return Math.abs(this.x-a.x)+Math.abs(this.y-a.y)},nr.prototype.setLength=function(a){return this.normalize().multiplyScalar(a)},nr.prototype.lerp=function(a,r){this.x+=(a.x-this.x)*r,this.y+=(a.y-this.y)*r},nr.prototype.lerpVectors=function(a,r,h){return this.subVectors(r,a).multiplyScalar(h).add(a)},nr.prototype.equals=function(a){return a.x===this.x&&a.y===this.y},nr.prototype.fromArray=function(a){this.set(a[0],a[1])},nr.prototype.toArray=function(){return[this.x,this.y]},nr.prototype.rotateAround=function(a,r){var h=Math.cos(r),d=Math.sin(r),y=this.x-a.x,b=this.y-a.y;this.x=y*h-b*d+a.x,this.y=y*d+b*h+a.y},Si.prototype.copy=function(a){this.m=a.m.slice(0)},Si.prototype.clone=function(){return new Si(this.m.slice(0))},Si.prototype.identity=function(){this.m=[1,0,0,1,0,0]},Si.prototype.multiply=function(a){this.m=[this.m[0]*a.m[0]+this.m[2]*a.m[1],this.m[1]*a.m[0]+this.m[3]*a.m[1],this.m[0]*a.m[2]+this.m[2]*a.m[3],this.m[1]*a.m[2]+this.m[3]*a.m[3],this.m[0]*a.m[4]+this.m[2]*a.m[5]+this.m[4],this.m[1]*a.m[4]+this.m[3]*a.m[5]+this.m[5]]},Si.prototype.premultiply=function(a){this.m=[a.m[0]*this.m[0]+a.m[2]*this.m[1],a.m[1]*this.m[0]+a.m[3]*this.m[1],a.m[0]*this.m[2]+a.m[2]*this.m[3],a.m[1]*this.m[2]+a.m[3]*this.m[3],a.m[0]*this.m[4]+a.m[2]*this.m[5]+a.m[4],a.m[1]*this.m[4]+a.m[3]*this.m[5]+a.m[5]]},Si.prototype.compose=function(a,r,h,d,y,b,R){if(this.m=[1,0,0,1,a,r],0!==R){var k=Math.cos(R),M=Math.sin(R);this.multiply(new Si([k,M,-M,k,0,0]))}1===h&&1===d||this.scale(h,d),0===y&&0===b||this.multiply(new Si([1,0,0,1,-y,-b]))},Si.prototype.translate=function(a,r){this.m[4]+=this.m[0]*a+this.m[2]*r,this.m[5]+=this.m[1]*a+this.m[3]*r},Si.prototype.rotate=function(a){var r=Math.cos(a),h=Math.sin(a),y=this.m[1]*r+this.m[3]*h,b=this.m[0]*-h+this.m[2]*r,R=this.m[1]*-h+this.m[3]*r;this.m[0]=this.m[0]*r+this.m[2]*h,this.m[1]=y,this.m[2]=b,this.m[3]=R},Si.prototype.scale=function(a,r){this.m[0]*=a,this.m[1]*=a,this.m[2]*=r,this.m[3]*=r},Si.prototype.setPosition=function(a,r){this.m[4]=a,this.m[5]=r},Si.prototype.getScale=function(){return new nr(this.m[0],this.m[3])},Si.prototype.getPosition=function(){return new nr(this.m[4],this.m[5])},Si.prototype.skew=function(a,r){this.multiply(new Si([1,Math.tan(r),Math.tan(a),1,0,0]))},Si.prototype.determinant=function(){return 1/(this.m[0]*this.m[3]-this.m[1]*this.m[2])},Si.prototype.getInverse=function(){var a=this.determinant();return new Si([this.m[3]*a,-this.m[1]*a,-this.m[2]*a,this.m[0]*a,a*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),a*(this.m[1]*this.m[4]-this.m[0]*this.m[5])])},Si.prototype.transformPoint=function(a){return new nr(a.x*this.m[0]+a.y*this.m[2]+this.m[4],a.x*this.m[1]+a.y*this.m[3]+this.m[5])},Si.prototype.setContextTransform=function(a){a.setTransform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])},Si.prototype.tranformContext=function(a){a.transform(this.m[0],this.m[1],this.m[2],this.m[3],this.m[4],this.m[5])},Si.prototype.cssTransform=function(){return"matrix("+this.m[0]+","+this.m[1]+","+this.m[2]+","+this.m[3]+","+this.m[4]+","+this.m[5]+")"},hh.generate=function(){for(var a=[],r=0;r<256;r++)a[r]=(r<16?"0":"")+r.toString(16);return function(){var h=4294967295*Math.random()|0,d=4294967295*Math.random()|0,y=4294967295*Math.random()|0,b=4294967295*Math.random()|0;return(a[255&h]+a[h>>8&255]+a[h>>16&255]+a[h>>24&255]+"-"+a[255&d]+a[d>>8&255]+"-"+a[d>>16&15|64]+a[d>>24&255]+"-"+a[63&y|128]+a[y>>8&255]+"-"+a[y>>16&255]+a[y>>24&255]+a[255&b]+a[b>>8&255]+a[b>>16&255]+a[b>>24&255]).toUpperCase()}}(),Nn.prototype.constructor=Nn,Nn.prototype.type="Object2D",Nn.types=new Map([[Nn.prototype.type,Nn]]),Nn.register=function(a,r){Nn.types.set(r,a)},Nn.prototype.getWorldPointIntersections=function(a,r){void 0===r&&(r=[]);var h=this.inverseGlobalMatrix.transformPoint(a);this.isInside(h)&&r.push(this);for(var d=0;d<this.children.length;d++)this.children[d].getWorldPointIntersections(a,r);return r},Nn.prototype.isWorldPointInside=function(a,r){var h=this.inverseGlobalMatrix.transformPoint(a);if(this.isInside(h))return!0;if(r)for(var d=0;d<this.children.length;d++)if(this.children[d].isWorldPointInside(a,!0))return!0;return!1},Nn.prototype.destroy=function(){null!==this.parent&&this.parent.remove(this)},Nn.prototype.traverse=function(a){a(this);for(var r=0;r<this.children.length;r++)this.children[r].traverse(a)},Nn.prototype.getChildByUUID=function(a){var r=null;return this.traverse(function(h){h.uuid===a&&(r=h)}),r},Nn.prototype.add=function(a){a.parent=this,a.level=this.level+1,a.traverse(function(r){null!==r.onAdd&&r.onAdd(this)}),this.children.push(a)},Nn.prototype.remove=function(a){var r=this.children.indexOf(a);if(-1!==r){var h=this.children[r];h.parent=null,h.level=0,h.traverse(function(d){null!==d.onRemove&&d.onRemove(this)}),this.children.splice(r,1)}},Nn.prototype.isInside=function(a){return!1},Nn.prototype.updateMatrix=function(a){(this.matrixAutoUpdate||this.matrixNeedsUpdate)&&(this.matrix.compose(this.position.x,this.position.y,this.scale.x,this.scale.y,this.origin.x,this.origin.y,this.rotation),this.globalMatrix.copy(this.matrix),null!==this.parent&&this.globalMatrix.premultiply(this.parent.globalMatrix),this.inverseGlobalMatrix=this.globalMatrix.getInverse(),this.matrixNeedsUpdate=!1)},Nn.prototype.transform=function(a,r,h,d){this.globalMatrix.tranformContext(a)},Nn.prototype.style=null,Nn.prototype.draw=null,Nn.prototype.onPointerDrag=function(a,r,h,d){this.position.add(h)},Nn.prototype.onPointerDragStart=null,Nn.prototype.onPointerDragEnd=null,Nn.prototype.onAdd=null,Nn.prototype.onRemove=null,Nn.prototype.onUpdate=null,Nn.prototype.onPointerEnter=null,Nn.prototype.onPointerLeave=null,Nn.prototype.onPointerOver=null,Nn.prototype.onButtonPressed=null,Nn.prototype.onDoubleClick=null,Nn.prototype.onButtonDown=null,Nn.prototype.onButtonUp=null,Nn.prototype.serialize=function(a){var r={uuid:this.uuid,type:this.type,position:this.position.toArray(),origin:this.origin.toArray(),scale:this.scale.toArray(),rotation:this.rotation,visible:this.visible,layer:this.layer,matrix:this.matrix.m,globalMatrix:this.globalMatrix.m,inverseGlobalMatrix:this.inverseGlobalMatrix.m,matrixAutoUpdate:this.matrixAutoUpdate,draggable:this.draggable,pointerEvents:this.pointerEvents,ignoreViewport:this.ignoreViewport,saveContextState:this.saveContextState,restoreContextState:this.restoreContextState,children:[],masks:[]};if(!1!==a)for(var h=0;h<this.children.length;h++)this.children[h].serializable&&r.children.push(this.children[h].serialize());for(h=0;h<this.masks.length;h++)r.masks.push(this.masks[h].uuid);return r},Nn.prototype.parse=function(a,r){this.uuid=a.uuid,this.position.fromArray(a.position),this.origin.fromArray(a.origin),this.scale.fromArray(a.scale),this.rotation=a.rotation,this.visible=a.visible,this.layer=a.layer,this.matrix=new Si(a.matrix),this.globalMatrix=new Si(a.globalMatrix),this.inverseGlobalMatrix=new Si(a.inverseGlobalMatrix),this.matrixAutoUpdate=a.matrixAutoUpdate,this.draggable=a.draggable,this.pointerEvents=a.pointerEvents,this.ignoreViewport=a.ignoreViewport,this.saveContextState=a.saveContextState,this.restoreContextState=a.restoreContextState;for(var h=0;h<this.masks.length;h++)a.masks.push(r.getChildByUUID(a.masks[h]))},Nn.parse=function(a){for(var r=[],h=function y(b){if(!Nn.types.has(b.type))throw new Error("Object type "+b.type+" unknown. Cannot parse data.");var R=new(Nn.types.get(b.type));R.uuid=b.uuid,r.push({object:R,data:b});for(var k=0;k<b.children.length;k++)R.add(y(b.children[k]));return R}(a),d=0;d<r.length;d++)r[d].object.parse(r[d].data,h);return h},Jo.DOWN=-1,Jo.UP=1,Jo.RESET=0,Jo.prototype.constructor=Jo,Jo.prototype.update=function(a){this.justPressed=!1,this.justReleased=!1,a===Jo.DOWN?(!1===this.pressed&&(this.justPressed=!0),this.pressed=!0):a===Jo.UP?(this.pressed&&(this.justReleased=!0),this.pressed=!1):a===Jo.RESET&&(this.justReleased=!1,this.justPressed=!1)},Jo.prototype.set=function(a,r,h){this.justPressed=a,this.pressed=r,this.justReleased=h},Jo.prototype.reset=function(){this.justPressed=!1,this.pressed=!1,this.justReleased=!1},(Pi.prototype=Pi).constructor=Pi,Pi.LEFT=0,Pi.MIDDLE=1,Pi.RIGHT=2,Pi.BACK=3,Pi.FORWARD=4,Pi.setCanvas=function(a){this.canvas=a,a.pointerInside=!1,a.addEventListener("mouseenter",function(){this.pointerInside=!0}),a.addEventListener("mouseleave",function(){this.pointerInside=!1})},Pi.insideCanvas=function(){return null!==this.canvas&&this.canvas.pointerInside},Pi.buttonPressed=function(a){return this.keys[a].pressed},Pi.buttonDoubleClicked=function(a){return this.doubleClicked[a]},Pi.buttonJustPressed=function(a){return this.keys[a].justPressed},Pi.buttonJustReleased=function(a){return this.keys[a].justReleased},Pi.updatePosition=function(a,r,h,d){if(null!==this.canvas){var y=this.canvas.getBoundingClientRect();a-=y.left,r-=y.top}this._position.set(a,r),this._delta.x+=h,this._delta.y+=d,this._positionUpdated=!0},Pi.updateKey=function(a,r){a>-1&&this._keys[a].update(r)},Pi.update=function(){for(var a=0;a<5;a++)this._keys[a].justPressed&&this.keys[a].justPressed&&(this._keys[a].justPressed=!1),this._keys[a].justReleased&&this.keys[a].justReleased&&(this._keys[a].justReleased=!1),this.keys[a].set(this._keys[a].justPressed,this._keys[a].pressed,this._keys[a].justReleased),!0===this._doubleClicked[a]?(this.doubleClicked[a]=!0,this._doubleClicked[a]=!1):this.doubleClicked[a]=!1;this._wheelUpdated?(this.wheel=this._wheel,this._wheelUpdated=!1):this.wheel=0,this._positionUpdated?(this.delta.copy(this._delta),this.position.copy(this._position),this._delta.set(0,0),this._positionUpdated=!1):(this.delta.x=0,this.delta.y=0)},Pi.create=function(){this.events.create()},Pi.dispose=function(){this.events.destroy()},ap.prototype.updateMatrix=function(){if(this.matrixNeedsUpdate){if(this.matrix.m=[1,0,0,1,this.position.x,this.position.y],0!==this.rotation){var a=Math.cos(this.rotation),r=Math.sin(this.rotation);this.matrix.multiply(new Si([a,r,-r,a,0,0]))}1!==this.scale&&this.matrix.scale(this.scale,this.scale),this.inverseMatrix=this.matrix.getInverse(),this.matrixNeedsUpdate=!1}},ap.prototype.centerObject=function(a,r){var h=a.globalMatrix.transformPoint(new nr);h.multiplyScalar(-this.scale),h.x+=r.width/2,h.y+=r.height/2,this.position.copy(h),this.matrixNeedsUpdate=!0},lp.prototype.update=function(a){if(this.allowScale&&0!==a.wheel&&(this.viewport.scale-=.001*a.wheel*this.viewport.scale,this.viewport.matrixNeedsUpdate=!0,this.moveOnScale&&null!==a.canvas)){this.viewport.updateMatrix();var h=this.viewport.inverseMatrix.transformPoint(a.position),d=new nr(a.canvas.width/2,a.canvas.height/2);d=this.viewport.inverseMatrix.transformPoint(d);var y=h.clone();y.sub(d),y.multiplyScalar(.1),this.viewport.position.sub(y),this.viewport.matrixNeedsUpdate=!0}if(this.allowRotation&&a.buttonPressed(Pi.RIGHT)&&a.buttonPressed(Pi.LEFT))if(null===this.rotationPoint)this.rotationPoint=a.position.clone(),this.rotationInitial=this.viewport.rotation;else{var b=a.position.clone();b.sub(this.rotationPoint),this.viewport.rotation=this.rotationInitial+b.angle(),this.viewport.matrixNeedsUpdate=!0}else this.rotationPoint=null,a.buttonPressed(this.dragButton)&&(this.viewport.position.x+=a.delta.x,this.viewport.position.y+=a.delta.y,this.viewport.matrixNeedsUpdate=!0)},Js.prototype.start=function(){if(!this.running){this.running=!0;var a=this;!function r(){a.callback(),a.running&&(a.id=requestAnimationFrame(r))}()}},Js.prototype.stop=function(){this.running=!1,cancelAnimationFrame(this.id)},ph.prototype.getDomContainer=function(){return null!==this.container?this.container:this.canvas.parentElement},ph.prototype.createRenderLoop=function(a,r,h){var d=this,y=new lp(r),b=new Js(function(){void 0!==h&&h(),y.update(d.pointer),d.update(a,r)});return b.start(),b},ph.prototype.dispose=function(a,r,h){this.pointer.dispose()},ph.prototype.update=function(a,r){var h=[];a.traverse(function(Se){Se.visible&&h.push(Se)}),h.sort(function(Se,Ce){return Ce.layer===Se.layer?Ce.level-Se.level:Ce.layer-Se.layer});var d=this.pointer;d.update(),r.updateMatrix();for(var y=d.position.clone(),b=r.inverseMatrix.transformPoint(y),R=0;R<h.length;R++)if((M=h[R]).pointerEvents){var k=M.inverseGlobalMatrix.transformPoint(M.ignoreViewport?y:b);if(M.isInside(k)){if(M.pointerInside||null===M.onPointerEnter||M.onPointerEnter(d,r),null!==M.onPointerOver&&M.onPointerOver(d,r),d.buttonDoubleClicked(Pi.LEFT)&&null!==M.onDoubleClick&&M.onDoubleClick(d,r),d.buttonPressed(Pi.LEFT)&&null!==M.onButtonPressed&&M.onButtonPressed(d,r),d.buttonJustReleased(Pi.LEFT)&&null!==M.onButtonUp&&M.onButtonUp(d,r),d.buttonJustPressed(Pi.LEFT)&&(null!==M.onButtonDown&&M.onButtonDown(d,r),M.draggable)){M.beingDragged=!0,null!==M.onPointerDragStart&&M.onPointerDragStart(d,r);break}M.pointerInside=!0}else M.pointerInside&&(null!==M.onPointerLeave&&M.onPointerLeave(d,r),M.pointerInside=!1);d.buttonJustReleased(Pi.LEFT)&&M.draggable&&(!0===M.beingDragged&&null!==M.onPointerDragEnd&&M.onPointerDragEnd(d,r),M.beingDragged=!1)}for(R=0;R<h.length;R++){var M;if((M=h[R]).beingDragged&&null!==M.onPointerDrag){var H=d.position.clone();H.sub(d.delta);var X=r.inverseMatrix.transformPoint(d.position),oe=r.inverseMatrix.transformPoint(H),ne=X.clone();ne.sub(oe),M.onPointerDrag(d,r,ne,X)}null!==M.onUpdate&&M.onUpdate()}for(a.traverse(function(Se){Se.updateMatrix()}),this.context.setTransform(1,0,0,1,0,0),this.autoClear&&this.context.clearRect(0,0,this.canvas.width,this.canvas.height),R=h.length-1;R>=0;R--)if(!h[R].isMask){h[R].saveContextState&&this.context.save();for(var ge=h[R].masks,we=0;we<ge.length;we++)ge[we].ignoreViewport||r.matrix.setContextTransform(this.context),ge[we].transform(this.context,r,this.canvas,this),ge[we].clip(this.context,r,this.canvas);h[R].ignoreViewport?ge.length>0&&this.context.setTransform(1,0,0,1,0,0):r.matrix.setContextTransform(this.context),h[R].transform(this.context,r,this.canvas,this),null!==h[R].style&&h[R].style(this.context,r,this.canvas),null!==h[R].draw&&h[R].draw(this.context,r,this.canvas),h[R].restoreContextState&&this.context.restore()}},qi.prototype.set=function(a,r){return this.min.copy(a),this.max.copy(r),this},qi.prototype.setFromPoints=function(a){this.min=new nr(1/0,1/0),this.max=new nr(-1/0,-1/0);for(var r=0,h=a.length;r<h;r++)this.expandByPoint(a[r]);return this},qi.prototype.setFromCenterAndSize=function(a,r){var h=(new nr).copy(r).multiplyScalar(.5);return this.min.copy(a).sub(h),this.max.copy(a).add(h),this},qi.prototype.clone=function(){var a=new qi;return a.copy(this),a},qi.prototype.copy=function(a){this.min.copy(a.min),this.max.copy(a.max)},qi.prototype.isEmpty=function(){return this.max.x<this.min.x||this.max.y<this.min.y},qi.prototype.getCenter=function(a){return void 0===a&&(a=new nr),this.isEmpty()?a.set(0,0):a.addVectors(this.min,this.max).multiplyScalar(.5),a},qi.prototype.getSize=function(a){return void 0===a&&(a=new nr),this.isEmpty()?a.set(0,0):a.subVectors(this.max,this.min),a},qi.prototype.expandByPoint=function(a){return this.min.min(a),this.max.max(a),this},qi.prototype.expandByVector=function(a){this.min.sub(a),this.max.add(a)},qi.prototype.expandByScalar=function(a){this.min.addScalar(-a),this.max.addScalar(a)},qi.prototype.containsPoint=function(a){return!(a.x<this.min.x||a.x>this.max.x||a.y<this.min.y||a.y>this.max.y)},qi.prototype.containsBox=function(a){return this.min.x<=a.min.x&&a.max.x<=this.max.x&&this.min.y<=a.min.y&&a.max.y<=this.max.y},qi.prototype.intersectsBox=function(a){return!(a.max.x<this.min.x||a.min.x>this.max.x||a.max.y<this.min.y||a.min.y>this.max.y)},qi.prototype.distanceToPoint=function(a){return(new nr).copy(a).clamp(this.min,this.max).sub(a).length()},qi.prototype.intersect=function(a){this.min.max(a.min),this.max.min(a.max)},qi.prototype.union=function(a){this.min.min(a.min),this.max.max(a.max)},qi.prototype.translate=function(a){this.min.add(a),this.max.add(a)},qi.prototype.equals=function(a){return a.min.equals(this.min)&&a.max.equals(this.max)},qi.prototype.toArray=function(){return[this.min.x,this.min.y,this.max.x,this.max.y]},qi.prototype.fromArray=function(a){this.min.set(a[0],a[1]),this.max.set(a[2],a[3])},(da.prototype=Object.create(Nn.prototype)).constructor=da,da.prototype.type="Mask",Nn.register(da,"Mask"),da.prototype.isMask=!0,da.prototype.clip=function(a,r,h){},(pl.prototype=Object.create(da.prototype)).constructor=pl,pl.prototype.type="BoxMask",Nn.register(pl,"BoxMask"),pl.prototype.isInside=function(a){return this.box.containsPoint(a)},pl.prototype.clip=function(a,r,h){a.beginPath();var d=this.box.max.x-this.box.min.x;this.invert?(a.rect(this.box.min.x-1e4,-5e3,1e4,1e4),a.rect(this.box.max.x,-5e3,1e4,1e4),a.rect(this.box.min.x,this.box.min.y-1e4,d,1e4),a.rect(this.box.min.x,this.box.max.y,d,1e4)):a.fillRect(this.box.min.x,this.box.min.y,d,this.box.max.y-this.box.min.y),a.clip()},po.prototype.get=function(a){},po.prototype.serialize=function(){},po.prototype.parse=function(a){},po.types=new Map([]),po.register=function(a,r){po.types.set(r,a)},po.parse=function(a){var r=new(po.types.get(a.type));return r.parse(a),r},us.prototype=Object.create(po.prototype),po.register(us,"Color"),us.prototype.get=function(a){return this.color},us.prototype.serialize=function(){return{type:"Color",color:this.color}},us.prototype.parse=function(a){this.color=a.color},(Go.prototype=Object.create(Nn.prototype)).constructor=Go,Go.prototype.type="Box",Nn.register(Go,"Box"),Go.prototype.onPointerEnter=function(a,r){this.fillStyle=new us("#CCCCCC")},Go.prototype.onPointerLeave=function(a,r){this.fillStyle=new us("#FFFFFF")},Go.prototype.isInside=function(a){return this.box.containsPoint(a)},Go.prototype.draw=function(a,r,h){var d=this.box.max.x-this.box.min.x,y=this.box.max.y-this.box.min.y;null!==this.fillStyle&&(a.fillStyle=this.fillStyle.get(a),a.fillRect(this.box.min.x,this.box.min.y,d,y)),null!==this.strokeStyle&&(a.lineWidth=this.lineWidth,a.strokeStyle=this.strokeStyle.get(a),a.strokeRect(this.box.min.x,this.box.min.y,d,y))},Go.prototype.serialize=function(a){var r=Nn.prototype.serialize.call(this,a);return r.box=this.box.toArray(),r.strokeStyle=null!==this.strokeStyle?this.strokeStyle.serialize():null,r.lineWidth=this.lineWidth,r.fillStyle=null!==this.fillStyle?this.fillStyle.serialize():null,r},Go.prototype.parse=function(a,r){Nn.prototype.parse.call(this,a,r),this.box.fromArray(a.box),this.strokeStyle=null!==a.strokeStyle?po.parse(a.strokeStyle):null,this.lineWidth=a.lineWidth,this.fillStyle=null!==a.fillStyle?po.parse(a.fillStyle):null},(to.prototype=Object.create(Nn.prototype)).constructor=to,to.prototype.type="Circle",Nn.register(to,"Circle"),to.prototype.isInside=function(a){return a.length()<=this.radius},to.prototype.onPointerEnter=function(a,r){this.fillStyle=new us("#CCCCCC")},to.prototype.onPointerLeave=function(a,r){this.fillStyle=new us("#FFFFFF")},to.prototype.draw=function(a,r,h){a.beginPath(),a.arc(0,0,this.radius,0,2*Math.PI),null!==this.fillStyle&&(a.fillStyle=this.fillStyle.get(a),a.fill()),null!==this.strokeStyle&&(a.lineWidth=this.lineWidth,a.strokeStyle=this.strokeStyle.get(a),a.stroke())},to.prototype.serialize=function(a){var r=Nn.prototype.serialize.call(this,a);return r.radius=this.radius,r.strokeStyle=null!==this.strokeStyle?this.strokeStyle.serialize():null,r.lineWidth=this.lineWidth,r.fillStyle=null!==this.fillStyle?this.fillStyle.serialize():null,r},to.prototype.parse=function(a,r){Nn.prototype.parse.call(this,a,r),this.radius=a.radius,this.strokeStyle=null!==a.strokeStyle?po.parse(a.strokeStyle):null,this.lineWidth=a.lineWidth,this.fillStyle=null!==a.fillStyle?po.parse(a.fillStyle):null},(Zo.prototype=Object.create(Nn.prototype)).constructor=Zo,Zo.prototype.type="Line",Nn.register(Zo,"Line"),Zo.prototype.style=function(a,r,h){a.lineWidth=this.lineWidth,a.strokeStyle=this.strokeStyle.get(a),a.setLineDash(this.dashPattern)},Zo.prototype.draw=function(a,r,h){a.beginPath(),a.moveTo(this.from.x,this.from.y),a.lineTo(this.to.x,this.to.y),a.stroke()},Zo.prototype.serialize=function(a){var r=Nn.prototype.serialize.call(this,a);return r.from=this.from.toArray(),r.to=this.to.toArray(),r.dashPattern=this.dashPattern,r.strokeStyle=null!==this.strokeStyle?this.strokeStyle.serialize():null,r.lineWidth=this.lineWidth,r},Zo.prototype.parse=function(a,r){Nn.prototype.parse.call(this,a,r),this.to.fromArray(a.to),this.from.fromArray(a.from),this.dashPattern=a.dashPattern,this.strokeStyle=null!==a.strokeStyle?po.parse(a.strokeStyle):null,this.lineWidth=a.lineWidth},($a.prototype=Object.create(Nn.prototype)).constructor=$a,$a.prototype.type="Text",Nn.register($a,"Text"),$a.prototype.draw=function(a,r,h){a.font=this.font,a.textAlign=this.textAlign,a.textBaseline=this.textBaseline,null!==this.fillStyle&&(a.fillStyle=this.fillStyle.get(a),a.fillText(this.text,0,0)),null!==this.strokeStyle&&(a.strokeStyle=this.strokeStyle.get(a),a.strokeText(this.text,0,0))},$a.prototype.serialize=function(a){var r=Nn.prototype.serialize.call(this,a);return r.text=this.text,r.font=this.font,r.strokeStyle=null!==this.strokeStyle?this.strokeStyle.serialize():null,r.lineWidth=this.lineWidth,r.fillStyle=null!==this.fillStyle?this.fillStyle.serialize():null,r.textAlign=this.textAlign,r.textBaseline=this.textBaseline,r},$a.prototype.parse=function(a,r){Nn.prototype.parse.call(this,a,r),this.text=a.text,this.font=a.font,this.strokeStyle=null!==a.strokeStyle?Style.parse(a.strokeStyle):null,this.lineWidth=a.lineWidth,this.fillStyle=null!==a.fillStyle?Style.parse(a.fillStyle):null,this.textAlign=a.textAlign,this.textBaseline=a.textBaseline},(Fh.prototype=Object.create(Nn.prototype)).constructor=Fh,Fh.prototype.type="Image",Nn.register(Fh,"Image"),Fh.prototype.setImage=function(a){var r=this;this.image.onload=function(){r.box.min.set(0,0),r.box.max.set(this.naturalWidth,this.naturalHeight)},this.image.src=a},Fh.prototype.isInside=function(a){return this.box.containsPoint(a)},Fh.prototype.draw=function(a,r,h){this.image.src.length>0&&a.drawImage(this.image,0,0,this.image.naturalWidth,this.image.naturalHeight,this.box.min.x,this.box.min.y,this.box.max.x-this.box.min.x,this.box.max.y-this.box.min.y)},Fh.prototype.serialize=function(a){var r=Nn.prototype.serialize.call(this,a);return r.box=this.box.toArray(),r.image=this.image.src,r},Fh.prototype.parse=function(a,r){Nn.prototype.parse.call(this,a,r),this.box.fromArray(a.box),this.image.src=a.image},(oo.prototype=Object.create(Nn.prototype)).constructor=oo,oo.prototype.type="DOM",Nn.register(oo,"DOM"),oo.prototype.onAdd=function(){null!==this.parentElement&&this.parentElement.appendChild(this.element)},oo.prototype.onRemove=function(){null!==this.parentElement&&this.parentElement.removeChild(this.element)},oo.prototype.transform=function(a,r,h,d){if(null===this.parentElement&&(this.parentElement=d.getDomContainer(),this.parentElement.appendChild(this.element)),this.ignoreViewport)this.element.style.transform=this.globalMatrix.cssTransform();else{var y=r.matrix.clone();y.multiply(this.globalMatrix),this.element.style.transform=y.cssTransform()}this.element.style.width=this.size.x+"px",this.element.style.height=this.size.y+"px",this.element.style.display=this.visible?"block":"none"},oo.prototype.serialize=function(a){var r=Nn.prototype.serialize.call(this,a);return r.size=this.size.toArray(),r.element=this.element.outerHTML,r},oo.prototype.parse=function(a,r){Nn.prototype.parse.call(this,a,r),this.size.fromArray(a.size);var h=(new DOMParser).parseFromString(this.element.outerHTML,"text/html");this.element=h.body.children[0]},(Us.prototype=Object.create(Nn.prototype)).constructor=Us,Us.prototype.type="Pattern",Nn.register(Us,"Pattern"),Us.prototype.setImage=function(a){var r=this;this.image.onload=function(){r.box.min.set(0,0),r.box.max.set(this.naturalWidth,this.naturalHeight)},this.image.src=a},Us.prototype.isInside=function(a){return this.box.containsPoint(a)},Us.prototype.draw=function(a,r,h){var d=this.box.max.x-this.box.min.x,y=this.box.max.y-this.box.min.y;if(this.image.src.length>0){var b=a.createPattern(this.image,this.repetition);a.fillStyle=b,a.fillRect(this.box.min.x,this.box.min.y,d,y)}},Us.prototype.serialize=function(a){var r=Nn.prototype.serialize.call(this,a);return r.box=this.box.toArray(),r.image=this.image.src,r.repetition=this.repetition,r},Us.prototype.parse=function(a,r){Nn.prototype.parse.call(this,a,r),this.box.fromArray(a.box),this.image.src=a.image,this.repetition=a.repetition},(dh.prototype=Object.create($a.prototype)).constructor=dh,dh.prototype.type="MultiLineText",Nn.register(dh,"MultiLineText"),dh.prototype.draw=function(a,r,h){a.font=this.font,a.textAlign=this.textAlign,a.textBaseline=this.textBaseline;for(var d=this.lineHeight||Number.parseFloat(this.font),y=this.text.split("\n"),b=0,R=0;R<y.length;R++){var k=y[R],M=a.measureText(k),H=[];if(null!==this.maxWidth&&M.width>this.maxWidth)for(;k.length>0;){for(var X="",oe=a.measureText(X+k[0]);oe.width<this.maxWidth&&k.length>0;)X+=k[0],k=k.substr(1),oe=a.measureText(X+k[0]);H.push(X)}else H=[k];for(var ne=0;ne<H.length;ne++)null!==this.fillStyle&&(a.fillStyle=this.fillStyle.get(a),a.fillText(H[ne],this.position.x,this.position.y+b)),null!==this.strokeStyle&&(a.lineWidth=this.lineWidth,a.strokeStyle=this.strokeStyle.get(a),a.strokeText(H[ne],this.position.x,this.position.y+b)),b+=d}},dh.prototype.serialize=function(a){var r=$a.prototype.serialize.call(this,a);return r.maxWidth=this.maxWidth,r.lineHeight=this.lineHeight,r},dh.prototype.parse=function(a,r){$a.prototype.parse.call(this,a,r),this.maxWidth=a.maxWidth,this.lineHeight=a.lineHeight},(Wa.prototype=Object.create(Zo.prototype)).constructor=Wa,Wa.prototype.type="BezierCurve",Nn.register(Wa,"BezierCurve"),Wa.curveHelper=function(a){var r=new to;r.radius=3,r.layer=a.layer+1,r.draggable=!0,r.onPointerDrag=function(b,R,k){Nn.prototype.onPointerDrag.call(this,b,R,k),a.fromCp.copy(r.position)},a.parent.add(r);var h=new Zo;h.from=a.from,h.to=a.fromCp,a.parent.add(h);var d=new to;d.radius=3,d.layer=a.layer+1,d.draggable=!0,d.onPointerDrag=function(b,R,k){Nn.prototype.onPointerDrag.call(this,b,R,k),a.toCp.copy(d.position)},a.parent.add(d);var y=new Zo;y.from=a.to,y.to=a.toCp,a.parent.add(y)},Wa.prototype.draw=function(a,r,h){a.beginPath(),a.moveTo(this.from.x,this.from.y),a.bezierCurveTo(this.fromCp.x,this.fromCp.y,this.toCp.x,this.toCp.y,this.to.x,this.to.y),a.stroke()},Wa.prototype.serialize=function(a){var r=Zo.prototype.serialize.call(this,a);return r.fromCp=this.fromCp.toArray(),r.toCp=this.toCp.toArray(),r},Wa.prototype.parse=function(a,r){Zo.prototype.parse.call(this,a,r),this.fromCp.fromArray(a.fromCp),this.toCp.fromArray(a.toCp)},(Bc.prototype=Object.create(Zo.prototype)).constructor=Bc,Bc.prototype.type="QuadraticCurve",Nn.register(Bc,"QuadraticCurve"),Bc.curveHelper=function(a){var r=new Zo;r.from=a.from,r.to=a.controlPoint,a.parent.add(r);var h=new to;h.radius=3,h.layer=a.layer+1,h.draggable=!0,h.position=a.controlPoint,h.onPointerDrag=function(y,b,R){Nn.prototype.onPointerDrag.call(this,y,b,R),a.controlPoint.copy(h.position)},a.parent.add(h);var d=new Zo;d.from=a.to,d.to=a.controlPoint,a.parent.add(d)},Bc.prototype.draw=function(a,r,h){a.beginPath(),a.moveTo(this.from.x,this.from.y),a.quadraticCurveTo(this.controlPoint.x,this.controlPoint.y,this.to.x,this.to.y),a.stroke()},Bc.prototype.serialize=function(a){var r=Zo.prototype.serialize.call(this,a);return r.controlPoint=this.controlPoint.toArray(),r},Bc.prototype.parse=function(a,r){Zo.prototype.parse.call(this,a,r),this.controlPoint.fromArray(a.controlPoint)},(fo.prototype=Object.create(Go.prototype)).constructor=fo,fo.prototype.type="RoundedBox",Nn.register(fo,"RoundedBox"),fo.roundRect=function(a,r,h,d,y,b){a.beginPath(),a.moveTo(r+b,h),a.lineTo(r+d-b,h),a.quadraticCurveTo(r+d,h,r+d,h+b),a.lineTo(r+d,h+y-b),a.quadraticCurveTo(r+d,h+y,r+d-b,h+y),a.lineTo(r+b,h+y),a.quadraticCurveTo(r,h+y,r,h+y-b),a.lineTo(r,h+b),a.quadraticCurveTo(r,h,r+b,h),a.closePath()},fo.prototype.draw=function(a,r,h){var d=this.box.max.x-this.box.min.x,y=this.box.max.y-this.box.min.y;null!==this.fillStyle&&(a.fillStyle=this.fillStyle.get(a),fo.roundRect(a,this.box.min.x,this.box.min.y,d,y,this.radius),a.fill()),null!==this.strokeStyle&&(a.lineWidth=this.lineWidth,a.strokeStyle=this.strokeStyle.get(a),fo.roundRect(a,this.box.min.x,this.box.min.y,d,y,this.radius),a.stroke())},fo.prototype.serialize=function(a){var r=Go.prototype.serialize.call(this,a);return r.radius=this.radius,r},fo.prototype.parse=function(a,r){Go.prototype.parse.call(this,a,r),this.radius=a.radius},(dl.prototype=Object.create(Nn.prototype)).constructor=dl,dl.prototype.type="Graph",Nn.register(dl,"Graph"),dl.prototype.isInside=function(a){return this.box.containsPoint(a)},dl.prototype.draw=function(a,r,h){if(0!==this.data.length){var d=this.box.max.x-this.box.min.x,y=this.box.max.y-this.box.min.y;a.lineWidth=this.lineWidth,a.strokeStyle=this.strokeStyle.get(a),a.beginPath();var b=d/(this.data.length-1),R=this.max-this.min;a.moveTo(this.box.min.x,this.box.max.y-(this.data[0]-this.min)/R*y);for(var k=1,M=b;k<this.data.length;M+=b,k++)a.lineTo(this.box.min.x+M,this.box.max.y-(this.data[k]-this.min)/R*y);a.stroke(),null!==this.fillStyle&&(a.fillStyle=this.fillStyle.get(a),a.lineTo(this.box.max.x,this.box.max.y),a.lineTo(this.box.min.x,this.box.max.y),a.fill())}},dl.prototype.serialize=function(a){var r=Nn.prototype.serialize.call(this,a);return r.box=this.box.toArray(),r.strokeStyle=null!==this.strokeStyle?this.strokeStyle.serialize():null,r.lineWidth=this.lineWidth,r.fillStyle=null!==this.fillStyle?this.fillStyle.serialize():null,r.min=this.min,r.max=this.max,r.data=this.data,r},dl.prototype.parse=function(a,r){Nn.prototype.parse.call(this,a,r),this.box.fromArray(a.box),this.strokeStyle=null!==a.strokeStyle?Style.parse(a.strokeStyle):null,this.lineWidth=a.lineWidth,this.fillStyle=null!==a.fillStyle?Style.parse(a.fillStyle):null,this.min=a.min,this.max=a.max,this.data=a.data},($i.prototype=Object.create(po.prototype)).addColorStop=function(a,r){this.colors.push(new nf(a,r))},$i.prototype.serialize=function(){return{colors:this.colors}},$i.prototype.parse=function(a){for(var r=[],h=0;h<a.colors.length;h++)r.push(new nf(a.colors[h].offset,a.colors[h].color));this.colors=r},Nu.prototype=Object.create($i.prototype),po.register(Nu,"LinearGradient"),Nu.prototype.get=function(a){for(var r=a.createLinearGradient(this.start.x,this.start.y,this.end.x,this.end.y),h=0;h<this.colors.length;h++)r.addColorStop(this.colors[h].offset,this.colors[h].color);return r},Nu.prototype.serialize=function(){var a=$i.prototype.serialize.call(this);return Object.assign(a,{type:"LinearGradient",start:this.start.toArray(),end:this.end.toArray()}),a},Nu.prototype.parse=function(a){$i.prototype.parse.call(this,a),this.start.fromArray(a.start),this.end.fromArray(a.end)},(Nc.prototype=Object.create(Nn.prototype)).constructor=Nc,Nc.prototype.type="Gauge",Nn.register(Nc,"Gauge"),Nc.prototype.isInside=function(a){return a.length()<=this.radius},Nc.prototype.draw=function(a,r,h){var d=this.value/(this.max-this.min),y=[this.startAngle,this.endAngle],b=y[0]+(y[1]-y[0])*d,R=[0,0];a.lineWidth=this.lineWidth,a.lineCap="round",a.strokeStyle=this.baseStyle.get(a),a.beginPath(),a.arc(R[0],R[1],this.radius,y[0],y[1]),a.stroke();var k=a.createLinearGradient(-this.radius,0,this.radius,0);if(a.strokeStyle=this.barStyle.get(a),a.lineWidth=this.lineWidth,a.beginPath(),a.arc(R[0],R[1],this.radius,y[0],b),a.stroke(),this.dial){var M=(this.startAngle-this.endAngle)*d,H=[Math.cos(M)*this.radius,Math.sin(M)*this.radius];H[0]=H[0]-R[0],H[1]=H[1]-R[1],a.fillStyle="#FFFFFF",a.beginPath(),a.arc(H[0],H[1],this.lineWidth/2,0,2*Math.PI),a.fill(),a.fillStyle=k,a.beginPath(),a.arc(H[0],H[1],this.lineWidth/3,0,2*Math.PI),a.fill()}},Nc.prototype.serialize=function(a){return Nn.prototype.serialize.call(this,a)},Nc.prototype.parse=function(a,r){Nn.prototype.parse.call(this,a,r)},Ru.prototype=Object.create(po.prototype),po.register(Ru,"Pattern"),Ru.prototype.setTransform=function(a){this.matrix.m=a,this.needsUpdate=!0},Ru.prototype.get=function(a){return(this.needsUpdate||null===this.cache)&&(this.cache=a.createPattern(this.source,this.repetition),this.cache.setTransform(this.matrix.cssTransform()),this.needsUpdate=!1),this.cache},Ru.prototype.serialize=function(){var a=$i.prototype.serialize.call(this);return Object.assign(a,{type:"Pattern",matrix:this.matrix.m,repetition:this.repetition,source:this.source}),a},Ru.prototype.parse=function(a){$i.prototype.parse.call(this,a),this.matrix=new Si(a.matrix),this.repetition=a.repetition,this.source=a.source},su.prototype=Object.create($i.prototype),po.register(su,"RadialGradient"),su.prototype.get=function(a){for(var r=a.createRadialGradient(this.start.x,this.start.y,this.startRadius,this.end.x,this.end.y,this.endRadius),h=0;h<this.colors.length;h++)r.addColorStop(this.colors[h].offset,this.colors[h].color);return r},su.prototype.serialize=function(){var a=$i.prototype.serialize.call(this);return Object.assign(a,{type:"RadialGradient",start:this.start.toArray(),end:this.end.toArray(),startRadius:this.startRadius,endRadius:this.endRadius}),a},su.prototype.parse=function(a){$i.prototype.parse.call(this,a),this.start.fromArray(a.start),this.end.fromArray(a.end),this.startRadius=a.startRadius,this.endRadius=a.endRadius},(zs.prototype=Object.create(Nn.prototype)).constructor=zs,zs.prototype.type="NodeGraph",Nn.register(zs,"NodeGraph"),zs.prototype.addNode=function(a){for(var r=0,h=0,d=0;d<this.children.length;d++)this.children[d].position.x>r&&(r=this.children[d].position.x),this.children[d].position.y>h&&(h=this.children[d].position.y);return a.position.set(r+200,h/2),this.add(a),null!==a.registerSockets&&a.registerSockets(),a},(Pu.prototype=Object.create(Wa.prototype)).constructor=Pu,Pu.prototype.type="NodeConnector",Nn.register(Pu,"NodeConnector"),Pu.prototype.destroy=function(){Wa.prototype.destroy.call(this),null!==this.outputSocket&&(this.outputSocket.removeConnector(this),this.outputSocket=null),null!==this.inputSocket&&(this.inputSocket.removeConnector(this),this.inputSocket=null)},Pu.prototype.onUpdate=function(){null!==this.outputSocket&&this.from.copy(this.outputSocket.position),null!==this.inputSocket&&this.to.copy(this.inputSocket.position),this.fromCp.copy(this.from),this.fromCp.add(this.to),this.fromCp.multiplyScalar(.5),this.toCp.copy(this.fromCp);var a=.5,r=this.to.y-this.from.y,h=this.to.x-this.from.x;Math.abs(h)>Math.abs(r)?(this.toCp.x+=h*a,this.fromCp.x-=h*a):(this.toCp.y+=r*a,this.fromCp.y-=r*a)},Pu.prototype.serialize=function(a){var r=Wa.prototype.serialize.call(this,a);return r.outputSocket=null!==this.outputSocket?this.outputSocket.uuid:null,r.inputSocket=null!==this.inputSocket?this.inputSocket.uuid:null,r},Pu.prototype.parse=function(a,r){Wa.prototype.parse.call(this,a,r),null!==a.outputSocket&&(this.outputSocket=r.getChildByUUID(a.outputSocket)),null!==a.inputSocket&&(this.inputSocket=r.getChildByUUID(a.inputSocket))},(Ei.prototype=Object.create(to.prototype)).constructor=Ei,Ei.prototype.type="NodeSocket",Nn.register(Ei,"NodeSocket"),Ei.INPUT=1,Ei.OUTPUT=2,Ei.prototype.getValue=function(){return this.direction===Ei.INPUT&&this.connectors.length>0&&null!==this.connectors[0].outputSocket?this.connectors[0].outputSocket.getValue():null},Ei.prototype.connectTo=function(a){if(!this.isCompatible(a))throw new Error("Sockets are not compatible they cannot be connected.");var r=new Pu;return this.attachConnector(r),a.attachConnector(r),r},Ei.prototype.attachConnector=function(a){this.canAddConnector()||this.destroyConnectors(),this.direction===Ei.INPUT?a.inputSocket=this:this.direction===Ei.OUTPUT&&(a.outputSocket=this),this.connectors.push(a),null===a.parent&&this.parent.add(a)},Ei.prototype.isCompatible=function(a){return this.direction!==a.direction&&this.category===a.category},Ei.prototype.canAddConnector=function(){return!(this.connectors.length>0&&(this.direction===Ei.INPUT||this.direction===Ei.OUTPUT&&!this.multiple))},Ei.prototype.canConnect=function(a){return this.isCompatible(a)&&this.canAddConnector()},Ei.prototype.removeConnector=function(a){var r=this.connectors.indexOf(a);-1!==r&&(this.connectors.splice(r,1),a.destroy())},Ei.prototype.destroyConnectors=function(){for(var a=0;a<this.connectors.length;a++)this.connectors[a].destroy()},Ei.prototype.destroy=function(){to.prototype.destroy.call(this),this.destroyConnectors()},Ei.prototype.onPointerDragStart=function(a,r){this.creatingConnection=!0,this.attachConnector(new Pu)},Ei.prototype.onPointerDrag=function(a,r,h,d){this.creatingConnection&&(this.direction===Ei.INPUT?this.connectors[this.connectors.length-1].from.copy(d):this.direction===Ei.OUTPUT&&this.connectors[this.connectors.length-1].to.copy(d))},Ei.prototype.onPointerDragEnd=function(a,r){if(this.creatingConnection){for(var h=r.inverseMatrix.transformPoint(a.position),d=this.parent.getWorldPointIntersections(h),y=!1,b=0;b<d.length;b++)if(d[b]instanceof Ei&&this.isCompatible(d[b])){d[b].attachConnector(this.connectors[this.connectors.length-1]),y=!0;break}y||this.connectors[this.connectors.length-1].destroy()}this.creatingConnection=!1},Ei.prototype.serialize=function(a){var r=to.prototype.serialize.call(this,a);r.name=this.name,r.category=this.category,r.multiple=this.multiple,r.direction=this.direction,r.node=this.node.uuid,r.connectors=[];for(var h=0;h<this.connectors.length;h++)r.connectors.push(this.connectors[h].uuid);return r},Ei.prototype.parse=function(a,r){to.prototype.parse.call(this,a,r),this.name=a.name,this.category=a.category,this.multiple=a.multiple,this.direction=a.direction,this.node=r.getChildByUUID(a.node);for(var h=0;h<a.connectors.length;h++)this.connectors.push(r.getChildByUUID(a.connectors[h]))},(fa.prototype=Object.create(fo.prototype)).constructor=fa,fa.prototype.type="Node",Nn.register(fa,"Node"),fa.prototype.registerSockets=null,fa.prototype.addInput=function(a,r){var h=new Ei(this,Ei.INPUT,a,r);return this.inputs.push(h),this.parent.add(h),h},fa.prototype.addOutput=function(a,r){var h=new Ei(this,Ei.OUTPUT,a,r);return this.outputs.push(h),this.parent.add(h),h},fa.prototype.getOutput=function(a){for(var r=0;r<this.outputs.length;r++)if(this.outputs[r].name===a)return this.outputs[r];return null},fa.prototype.getInput=function(a){for(var r=0;r<this.inputs.length;r++)if(this.inputs[r].name===a)return this.inputs[r];return null},fa.prototype.destroy=function(){fo.prototype.destroy.call(this);for(var a=0;a<this.inputs.length;a++)this.inputs[a].destroy();for(a=0;a<this.outputs.length;a++)this.outputs[a].destroy()},fa.prototype.onUpdate=function(){for(var a=this.box.max.y-this.box.min.y,r=a/(this.inputs.length+1),h=this.box.min.y+r,d=0;d<this.inputs.length;d++)this.inputs[d].position.set(this.position.x+this.box.min.x,this.position.y+(h+r*d));for(h=this.box.min.y+(r=a/(this.outputs.length+1)),d=0;d<this.outputs.length;d++)this.outputs[d].position.set(this.position.x+this.box.max.x,this.position.y+(h+r*d))},fa.prototype.serialize=function(a){var r=fo.prototype.serialize.call(this,a);r.inputs=[];for(var h=0;h<this.inputs.length;h++)r.inputs.push(this.inputs[h].uuid);for(r.outputs=[],h=0;h<this.outputs.length;h++)r.outputs.push(this.outputs[h].uuid);return r},fa.prototype.parse=function(a,r){fo.prototype.parse.call(this,a,r);for(var h=0;h<a.inputs.length;h++)this.inputs.push(r.getChildByUUID(a.inputs[h]));for(h=0;h<a.outputs.length;h++)this.outputs.push(r.getChildByUUID(a.outputs[h]))},rf.rotateTool=function(a){var r=new to;r.radius=4,r.layer=a.layer+1,r.onPointerDrag=function(h,d,y){a.rotation+=.001*y.x},a.add(r)},rf.boxResizeTool=function(a){if(void 0!==a.box){var r=new to;r.radius=4,r.layer=a.layer+1,r.draggable=!0,r.onPointerDrag=function(R,k,M){Nn.prototype.onPointerDrag.call(this,R,k,M),a.box.min.copy(r.position),b()},a.add(r);var h=new to;h.radius=4,h.layer=a.layer+1,h.draggable=!0,h.onPointerDrag=function(R,k,M){Nn.prototype.onPointerDrag.call(this,R,k,M),a.box.max.x=h.position.x,a.box.min.y=h.position.y,b()},a.add(h);var d=new to;d.radius=4,d.layer=a.layer+1,d.draggable=!0,d.onPointerDrag=function(R,k,M){Nn.prototype.onPointerDrag.call(this,R,k,M),a.box.max.copy(d.position),b()},a.add(d);var y=new to;y.radius=4,y.layer=a.layer+1,y.draggable=!0,y.onPointerDrag=function(R,k,M){Nn.prototype.onPointerDrag.call(this,R,k,M),a.box.min.x=y.position.x,a.box.max.y=y.position.y,b()},a.add(y),b()}else console.warn("escher.js: Helpers.boxResizeTool(), object box property missing.");function b(){r.position.copy(a.box.min),d.position.copy(a.box.max),h.position.set(a.box.max.x,a.box.min.y),y.position.set(a.box.min.x,a.box.max.y)}},Ci.read=function(a,r,h){var d=new XMLHttpRequest;d.overrideMimeType("text/plain"),d.open("GET",a,!0),void 0!==r&&(d.onload=function(){r(d.response)}),void 0!==h&&(d.onerror=h),d.send(null)},Ci.write=function(a,r){var h=new Blob([r],{type:"octet/stream"}),d=document.createElement("a");d.download=a,d.href=window.URL.createObjectURL(h),d.style.display="none",d.onclick=function(){document.body.removeChild(this)},document.body.appendChild(d),d.click()},Ci.select=function(a,r){var h=document.createElement("input");h.type="file",h.style.display="none",document.body.appendChild(h),void 0!==r&&(h.accept=r),h.onchange=function(d){void 0!==a&&a(h.files),document.body.removeChild(h)},h.click()},(ma.prototype=Object.create(l.Group.prototype)).addNode=function(a){this.graph.addNode(a)},ma.prototype.initialize=function(){l.Object3D.prototype.initialize.call(this)},ma.prototype.update=function(a){l.Object3D.prototype.update.call(this,a)},ma.prototype.dispose=function(){l.Object3D.prototype.dispose.call(this)},ma.prototype.resize=function(a,r){},ma.prototype.toJSON=function(a){var r=l.Object3D.prototype.toJSON.call(this,a);return r.object.graph=this.graph.serialize(),r},Il.prototype.createWorkers=function(){for(var a=0;a<this.workers.length;a++)this.workers[a].terminate();var r=this;function h(y){var b=y.data.uuid;if(void 0===r.tasks[b])throw new Error("Unknown worker task "+b);r.tasks[b].callback(y.data.data),delete r.tasks[b]}for(this.workers=[],this.next=0,a=0;a<this.size;a++){var d=new Worker(this.file);d.onmessage=h,this.workers.push(d)}},Il.prototype.runTask=function(a,r){var h=new tc(a,r);this.tasks[h.uuid]=h,this.workers[this.next].postMessage({data:h.data,uuid:h.uuid}),this.next++,this.next>=this.workers.length&&(this.next=0)},Ld.prototype.start=function(){if(!this.running){this.running=!0;var a=this;!function r(){a.callback(),a.running&&(a.id=setTimeout(r,a.time))}()}},Ld.prototype.stop=function(){this.running=!1,clearTimeout(self.id)},Iu.prototype.start=function(){if(!this.running){this.running=!0;var a=this;!function r(){a.callback(),a.running&&(a.id=requestAnimationFrame(r))}()}},Iu.prototype.stop=function(){this.running=!1,cancelAnimationFrame(this.id)},Ol.set=function(a,r){"object"==typeof r?window.localStorage.setItem(a,JSON.stringify(r)):window.localStorage.setItem(a,r)},Ol.get=function(a){var r=window.localStorage.getItem(a);try{return JSON.parse(r)}catch{return r}},Ol.exists=function(a){return null!==window.localStorage.getItem(a)},Ol.delete=function(a){return window.localStorage.removeItem(a)},fl.getRoot=function(a){for(var r=a;null!==r.parent;)r=r.parent;return r},fl.centerUnitary=function(a){var r=fl.calculateBoundingBox(a);if(null!==r){var h=new l.Vector3;r.getSize(h);var d=1/(h.x>h.y?h.x>h.z?h.x:h.z:h.y>h.z?h.y:h.z),y=new l.Vector3;r.getCenter(y),y.multiplyScalar(d),a.scale.set(d,d,d),a.position.set(-y.x,-d*r.min.y,-y.z)}},fl.calculateBoundingBox=function(a){var r=null;return a.traverse(function(h){var d=null;if(!0===h.isSprite){var y=new l.Vector3;h.getWorldPosition(y),d=new l.Box3(y.clone().subScalar(.5),y.clone().addScalar(.5))}else void 0!==h.geometry&&(h.geometry.computeBoundingBox(),(d=h.geometry.boundingBox.clone()).applyMatrix4(h.matrixWorld),h.geometry.computeBoundingBox(),d=h.geometry.boundingBox);null!==d&&(null===r?r=d:(d.min.x<r.min.x&&(r.min.x=d.min.x),d.max.x>r.max.x&&(r.max.x=d.max.x),d.min.y<r.min.y&&(r.min.y=d.min.y),d.max.y>r.max.y&&(r.max.y=d.max.y),d.min.z<r.min.z&&(r.min.z=d.min.z),d.max.z>r.max.z&&(r.max.z=d.max.z)))}),r},fl.centerGeometryOrigin=function(a){a.traverse(function(r){if(void 0!==r.geometry){r.geometry.computeBoundingBox();var h=r.geometry.boundingBox.clone().getCenter(new l.Vector3);r.position.add(h);var d=new l.Matrix4;d.makeTranslation(-h.x,-h.y,-h.z),r.geometry.applyMatrix4(d)}})},fl.convertToBufferGeometry=function(a){a.traverse(function(r){void 0!==r.geometry&&!0===r.geometry.isGeometry&&(r.geometry=(new l.BufferGeometry).fromGeometry(r.geometry))})};var ld=function(){var a,r,h,d,y=new l.Vector3;function b(){this.tolerance=-1,this.faces=[],this.newFaces=[],this.assigned=new H,this.unassigned=new H,this.vertices=[]}function R(){this.normal=new l.Vector3,this.midpoint=new l.Vector3,this.area=0,this.constant=0,this.outside=null,this.mark=0,this.edge=null}function k(X,oe){this.vertex=X,this.prev=null,this.next=null,this.twin=null,this.face=oe}function M(X){this.point=X,this.prev=null,this.next=null,this.face=null}function H(){this.head=null,this.tail=null}return Object.assign(b.prototype,{setFromPoints:function(X){!0!==Array.isArray(X)&&console.error("THREE.ConvexHull: Points parameter is not an array."),X.length<4&&console.error("THREE.ConvexHull: The algorithm needs at least four points."),this.makeEmpty();for(var oe=0,ne=X.length;oe<ne;oe++)this.vertices.push(new M(X[oe]));return this.compute(),this},setFromObject:function(X){var oe=[];return X.updateMatrixWorld(!0),X.traverse(function(ne){var ge,we,Se,Ce=ne.geometry;if(void 0!==Ce)if(Ce.isGeometry){var Pe=Ce.vertices;for(ge=0,we=Pe.length;ge<we;ge++)(Se=Pe[ge].clone()).applyMatrix4(ne.matrixWorld),oe.push(Se)}else if(Ce.isBufferGeometry){var Re=Ce.attributes.position;if(void 0!==Re)for(ge=0,we=Re.count;ge<we;ge++)(Se=new l.Vector3).fromBufferAttribute(Re,ge).applyMatrix4(ne.matrixWorld),oe.push(Se)}}),this.setFromPoints(oe)},containsPoint:function(X){for(var oe=this.faces,ne=0,ge=oe.length;ne<ge;ne++)if(oe[ne].distanceToPoint(X)>this.tolerance)return!1;return!0},intersectRay:function(X,oe){for(var ne=this.faces,ge=-1/0,we=1/0,Se=0,Ce=ne.length;Se<Ce;Se++){var Pe=ne[Se],Re=Pe.distanceToPoint(X.origin),Oe=Pe.normal.dot(X.direction);if(Re>0&&Oe>=0)return null;var Ge=0!==Oe?-Re/Oe:0;if(!(Ge<=0)&&(Oe>0?we=Math.min(Ge,we):ge=Math.max(Ge,ge),ge>we))return null}return X.at(ge!==-1/0?ge:we,oe),oe},intersectsRay:function(X){return null!==this.intersectRay(X,y)},makeEmpty:function(){return this.faces=[],this.vertices=[],this},addVertexToFace:function(X,oe){return X.face=oe,null===oe.outside?this.assigned.append(X):this.assigned.insertBefore(oe.outside,X),oe.outside=X,this},removeVertexFromFace:function(X,oe){return X===oe.outside&&(oe.outside=null!==X.next&&X.next.face===oe?X.next:null),this.assigned.remove(X),this},removeAllVerticesFromFace:function(X){if(null!==X.outside){for(var oe=X.outside,ne=X.outside;null!==ne.next&&ne.next.face===X;)ne=ne.next;return this.assigned.removeSubList(oe,ne),oe.prev=ne.next=null,X.outside=null,oe}},deleteFaceVertices:function(X,oe){var ne=this.removeAllVerticesFromFace(X);if(void 0!==ne)if(void 0===oe)this.unassigned.appendChain(ne);else{var ge=ne;do{var we=ge.next;oe.distanceToPoint(ge.point)>this.tolerance?this.addVertexToFace(ge,oe):this.unassigned.append(ge),ge=we}while(null!==ge)}return this},resolveUnassignedPoints:function(X){if(!1===this.unassigned.isEmpty()){var oe=this.unassigned.first();do{for(var ne=oe.next,ge=this.tolerance,we=null,Se=0;Se<X.length;Se++){var Ce=X[Se];if(0===Ce.mark){var Pe=Ce.distanceToPoint(oe.point);if(Pe>ge&&(ge=Pe,we=Ce),ge>1e3*this.tolerance)break}}null!==we&&this.addVertexToFace(oe,we),oe=ne}while(null!==oe)}return this},computeExtremes:function(){var X,oe,ne,ge=new l.Vector3,we=new l.Vector3,Se=[],Ce=[];for(X=0;X<3;X++)Se[X]=Ce[X]=this.vertices[0];for(ge.copy(this.vertices[0].point),we.copy(this.vertices[0].point),X=0,oe=this.vertices.length;X<oe;X++){var Pe=this.vertices[X],Re=Pe.point;for(ne=0;ne<3;ne++)Re.getComponent(ne)<ge.getComponent(ne)&&(ge.setComponent(ne,Re.getComponent(ne)),Se[ne]=Pe);for(ne=0;ne<3;ne++)Re.getComponent(ne)>we.getComponent(ne)&&(we.setComponent(ne,Re.getComponent(ne)),Ce[ne]=Pe)}return this.tolerance=3*Number.EPSILON*(Math.max(Math.abs(ge.x),Math.abs(we.x))+Math.max(Math.abs(ge.y),Math.abs(we.y))+Math.max(Math.abs(ge.z),Math.abs(we.z))),{min:Se,max:Ce}},computeInitialHull:function(){void 0===a&&(a=new l.Line3,r=new l.Plane,h=new l.Vector3);var X,oe,ne,ge,we,Se,Ce,Pe,Re,Oe=this.vertices,Ge=this.computeExtremes(),ke=Ge.min,et=Ge.max,rt=0,ut=0;for(Se=0;Se<3;Se++)(Re=et[Se].point.getComponent(Se)-ke[Se].point.getComponent(Se))>rt&&(rt=Re,ut=Se);for(rt=0,a.set((oe=ke[ut]).point,(ne=et[ut]).point),Se=0,Ce=this.vertices.length;Se<Ce;Se++)(X=Oe[Se])!==oe&&X!==ne&&(a.closestPointToPoint(X.point,!0,h),(Re=h.distanceToSquared(X.point))>rt&&(rt=Re,ge=X));for(rt=-1,r.setFromCoplanarPoints(oe.point,ne.point,ge.point),Se=0,Ce=this.vertices.length;Se<Ce;Se++)(X=Oe[Se])!==oe&&X!==ne&&X!==ge&&(Re=Math.abs(r.distanceToPoint(X.point)))>rt&&(rt=Re,we=X);var vt=[];if(r.distanceToPoint(we.point)<0)for(vt.push(R.create(oe,ne,ge),R.create(we,ne,oe),R.create(we,ge,ne),R.create(we,oe,ge)),Se=0;Se<3;Se++)Pe=(Se+1)%3,vt[Se+1].getEdge(2).setTwin(vt[0].getEdge(Pe)),vt[Se+1].getEdge(1).setTwin(vt[Pe+1].getEdge(0));else for(vt.push(R.create(oe,ge,ne),R.create(we,oe,ne),R.create(we,ne,ge),R.create(we,ge,oe)),Se=0;Se<3;Se++)Pe=(Se+1)%3,vt[Se+1].getEdge(2).setTwin(vt[0].getEdge((3-Se)%3)),vt[Se+1].getEdge(0).setTwin(vt[Pe+1].getEdge(1));for(Se=0;Se<4;Se++)this.faces.push(vt[Se]);for(Se=0,Ce=Oe.length;Se<Ce;Se++)if((X=Oe[Se])!==oe&&X!==ne&&X!==ge&&X!==we){rt=this.tolerance;var Lt=null;for(Pe=0;Pe<4;Pe++)(Re=this.faces[Pe].distanceToPoint(X.point))>rt&&(rt=Re,Lt=this.faces[Pe]);null!==Lt&&this.addVertexToFace(X,Lt)}return this},reindexFaces:function(){for(var X=[],oe=0;oe<this.faces.length;oe++){var ne=this.faces[oe];0===ne.mark&&X.push(ne)}return this.faces=X,this},nextVertexToAdd:function(){if(!1===this.assigned.isEmpty()){var X,oe=0,ne=this.assigned.first().face,ge=ne.outside;do{var we=ne.distanceToPoint(ge.point);we>oe&&(oe=we,X=ge),ge=ge.next}while(null!==ge&&ge.face===ne);return X}},computeHorizon:function(X,oe,ne,ge){var we;this.deleteFaceVertices(ne),ne.mark=1,we=null===oe?oe=ne.getEdge(0):oe.next;do{var Se=we.twin,Ce=Se.face;0===Ce.mark&&(Ce.distanceToPoint(X)>this.tolerance?this.computeHorizon(X,Se,Ce,ge):ge.push(we)),we=we.next}while(we!==oe);return this},addAdjoiningFace:function(X,oe){var ne=R.create(X,oe.tail(),oe.head());return this.faces.push(ne),ne.getEdge(-1).setTwin(oe.twin),ne.getEdge(0)},addNewFaces:function(X,oe){this.newFaces=[];for(var ne=null,ge=null,we=0;we<oe.length;we++){var Ce=this.addAdjoiningFace(X,oe[we]);null===ne?ne=Ce:Ce.next.setTwin(ge),this.newFaces.push(Ce.face),ge=Ce}return ne.next.setTwin(ge),this},addVertexToHull:function(X){var oe=[];return this.unassigned.clear(),this.removeVertexFromFace(X,X.face),this.computeHorizon(X.point,null,X.face,oe),this.addNewFaces(X,oe),this.resolveUnassignedPoints(this.newFaces),this},cleanup:function(){return this.assigned.clear(),this.unassigned.clear(),this.newFaces=[],this},compute:function(){var X;for(this.computeInitialHull();void 0!==(X=this.nextVertexToAdd());)this.addVertexToHull(X);return this.reindexFaces(),this.cleanup(),this}}),Object.assign(R,{create:function(X,oe,ne){var ge=new R,we=new k(X,ge),Se=new k(oe,ge),Ce=new k(ne,ge);return we.next=Ce.prev=Se,Se.next=we.prev=Ce,Ce.next=Se.prev=we,ge.edge=we,ge.compute()}}),Object.assign(R.prototype,{getEdge:function(X){for(var oe=this.edge;X>0;)oe=oe.next,X--;for(;X<0;)oe=oe.prev,X++;return oe},compute:function(){void 0===d&&(d=new l.Triangle);var X=this.edge.tail(),oe=this.edge.head(),ne=this.edge.next.head();return d.set(X.point,oe.point,ne.point),d.getNormal(this.normal),d.getMidpoint(this.midpoint),this.area=d.getArea(),this.constant=this.normal.dot(this.midpoint),this},distanceToPoint:function(X){return this.normal.dot(X)-this.constant}}),Object.assign(k.prototype,{head:function(){return this.vertex},tail:function(){return this.prev?this.prev.vertex:null},length:function(){var X=this.head(),oe=this.tail();return null!==oe?oe.point.distanceTo(X.point):-1},lengthSquared:function(){var X=this.head(),oe=this.tail();return null!==oe?oe.point.distanceToSquared(X.point):-1},setTwin:function(X){return this.twin=X,X.twin=this,this}}),Object.assign(H.prototype,{first:function(){return this.head},last:function(){return this.tail},clear:function(){return this.head=this.tail=null,this},insertBefore:function(X,oe){return oe.prev=X.prev,oe.next=X,null===oe.prev?this.head=oe:oe.prev.next=oe,X.prev=oe,this},insertAfter:function(X,oe){return oe.prev=X,oe.next=X.next,null===oe.next?this.tail=oe:oe.next.prev=oe,X.next=oe,this},append:function(X){return null===this.head?this.head=X:this.tail.next=X,X.prev=this.tail,X.next=null,this.tail=X,this},appendChain:function(X){for(null===this.head?this.head=X:this.tail.next=X,X.prev=this.tail;null!==X.next;)X=X.next;return this.tail=X,this},remove:function(X){return null===X.prev?this.head=X.next:X.prev.next=X.next,null===X.next?this.tail=X.prev:X.next.prev=X.prev,this},removeSubList:function(X,oe){return null===X.prev?this.head=oe.next:X.prev.next=oe.next,null===oe.next?this.tail=X.prev:oe.next.prev=X.prev,this},isEmpty:function(){return null===this.head}}),b}();function Hn(){}function rs(){}Hn.Type={BOX:"Box",CYLINDER:"Cylinder",SPHERE:"Sphere",HULL:"ConvexPolyhedron"},Hn.createShape=function(a,r){if(void 0!==r)return r===Hn.Type.BOX?Hn.createBoundingBoxShape(a):r===Hn.Type.CYLINDER?Hn.createBoundingCylinderShape(a):r===Hn.Type.SPHERE?Hn.createBoundingSphereShape(a):r===Hn.Type.HULL?Hn.createConvexPolyhedron(a):null;var h=Hn.getGeometry(a);if(!h)return null;switch(h.type){case"BoxGeometry":case"BoxBufferGeometry":default:return Hn.createBoxShape(h);case"CylinderGeometry":case"CylinderBufferGeometry":return Hn.createCylinderShape(h);case"PlaneGeometry":case"PlaneBufferGeometry":return Hn.createPlaneShape(h);case"SphereGeometry":case"SphereBufferGeometry":return Hn.createSphereShape(h);case"TubeGeometry":return Hn.createTubeShape(h);case"Geometry":case"BufferGeometry":return Hn.createConvexPolyhedron(a)}},Hn.createBoxShape=function(a){if(!Hn.getVertices(a).length)return null;a.computeBoundingBox();var r=a.boundingBox;return new Fe(new A((r.max.x-r.min.x)/2,(r.max.y-r.min.y)/2,(r.max.z-r.min.z)/2))},Hn.createBoundingBoxShape=function(a){var r=new Box3;if(r.setFromObject(a),!isFinite(r.min.lengthSq()))return null;var h=new Fe(new A((r.max.x-r.min.x)/2,(r.max.y-r.min.y)/2,(r.max.z-r.min.z)/2));return a.updateMatrixWorld(),(new l.Vector3).setFromMatrixPosition(a.matrixWorld),h},Hn.createConvexPolyhedron=function(a){var r=new ld;r.setFromObject(a);for(var h=[],d=[],y=[],b=0;b<r.faces.length;b++){var R=r.faces[b],k=R.edge;do{var M=k.head().point;h.push(new A(M.x,M.y,M.z)),k=k.next}while(k!==R.edge);d.push([h.length-3,h.length-2,h.length-1]),y.push(new A(R.normal.x,R.normal.y,R.normal.z))}return new K(h,d,y)},Hn.createCylinderShape=function(a){var r=a.parameters,h=new Xt(r.radiusTop,r.radiusBottom,r.height,r.radialSegments);return h.orientation=new pe,h.orientation.setFromEuler(0,0,0,"XYZ").normalize(),h},Hn.createBoundingCylinderShape=function(a){var r=["x","y","z"],h=r.splice(r.indexOf("y"),1)&&r,d=Hn.getGeometry(a);d.computeBoundingBox(),d.computeBoundingSphere();var y=d.boundingBox.max.y-d.boundingBox.min.y,b=.5*Math.max(d.boundingBox.max[h[0]]-d.boundingBox.min[h[0]],d.boundingBox.max[h[1]]-d.boundingBox.min[h[1]]),R=new Xt(b,b,y,12);return R.orientation=new pe,R.orientation.setFromEuler(Math.PI/2,0,0,"XYZ").normalize(),R},Hn.createPlaneShape=function(a){a.computeBoundingBox();var r=a.boundingBox;return new Fe(new A((r.max.x-r.min.x)/2,(r.max.y-r.min.y)/2,(r.max.z-r.min.z)/2))},Hn.createSphereShape=function(a){return new cc(a.parameters.radius)},Hn.createBoundingSphereShape=function(a){var r=Hn.getGeometry(a);return r.computeBoundingSphere(),new cc(r.boundingSphere.radius)},Hn.createTubeShape=function(a){var r=new l.BufferGeometry;return r.fromGeometry(a),createTrimeshShape(r)},Hn.createTrimeshShape=function(a){var r=Hn.getVertices(a);if(!r||0===r.length)return null;var h=Object.keys(r).map(Number);return new el(r,h)},Hn.getGeometry=function(a){var r=Hn.getMeshes(a);if(0===r.length)return null;var h=new l.Geometry;if(1===r.length){var d=new l.Vector3,y=new l.Quaternion,b=new l.Vector3(1,1,1);return h=r[0].geometry.clone(),r[0].updateMatrixWorld(),r[0].matrixWorld.decompose(d,y,b),h.scale(b.x,b.y,b.z)}for(var R=new l.Geometry,k=r.pop();void 0!==k;)k.updateMatrixWorld(),k.geometry instanceof l.BufferGeometry?(h.fromBufferGeometry(k.geometry),R.merge(h,k.matrixWorld)):R.merge(k.geometry,k.matrixWorld),k=r.pop();var M=new l.Matrix4;return M.scale(a.scale),R.applyMatrix4(M),R},Hn.getVertices=function(a){return a instanceof l.Geometry&&(a=(new l.BufferGeometry).fromGeometry(a)),a.attributes.position.array},Hn.getMeshes=function(a){var r=[];return a.traverse(function(h){h instanceof l.Mesh&&r.push(h)}),r},rs.scales=new Map([["Y",1e24],["Z",1e21],["E",1e18],["P",1e15],["T",1e12],["G",1e9],["M",1e6],["k",1e3],["m",.001],["u",1e-6],["n",1e-9],["p",1e-12],["f",1e-15],["a",1e-18],["z",1e-21],["y",1e-24]]),rs.units=new Map([["m",new Map([["i",function(a){return a/39.3701}]])],["i",new Map([["m",function(a){return 39.3701*a}]])],["g",null],["s",null],["c",new Map([["k",function(a){return a-273.15}],["f",function(a){return(a-32)/1.8}]])],["k",new Map([["c",function(a){return a+273.15}],["f",function(a){return(a-32)/1.8+273.15}]])],["f",new Map([["c",function(a){return 1.8*a+32}],["k",function(a){return 1.8*a-459.67}]])],["d",new Map([["r",function(a){return a*(180/Math.PI)}]])],["r",new Map([["d",function(a){return a/(180/Math.PI)}]])]]),rs.convert=function(a,r,h){r.length>1&&(a*=rs.scales.get(r.charAt(0)),r=r.slice(1));var d=1;return h.length>1&&(d=rs.scales.get(h.charAt(0)),h=h.slice(1)),r===h?a/d:rs.units.get(h).get(r)(a)/d}})(),__webpack_exports__})()),function(n,o){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=n.document?o(n,!0):function(l){if(!l.document)throw new Error("jQuery requires a window with a document");return o(l)}:o(n)}(typeof window<"u"?window:this,function(n,o){"use strict";var l=[],x=Object.getPrototypeOf,N=l.slice,U=l.flat?function(W){return l.flat.call(W)}:function(W){return l.concat.apply([],W)},G=l.push,A=l.indexOf,P={},de=P.toString,be=P.hasOwnProperty,te=be.toString,ce=te.call(Object),fe={},_e=function(ue){return"function"==typeof ue&&"number"!=typeof ue.nodeType},le=function(ue){return null!=ue&&ue===ue.window},pe=n.document,T={type:!0,src:!0,nonce:!0,noModule:!0};function B(W,ue,Te){var Le,He,Ve=(Te=Te||pe).createElement("script");if(Ve.text=W,ue)for(Le in T)(He=ue[Le]||ue.getAttribute&&ue.getAttribute(Le))&&Ve.setAttribute(Le,He);Te.head.appendChild(Ve).parentNode.removeChild(Ve)}function q(W){return null==W?W+"":"object"==typeof W||"function"==typeof W?P[de.call(W)]||"object":typeof W}var F=function(W,ue){return new F.fn.init(W,ue)};function Be(W){var ue=!!W&&"length"in W&&W.length,Te=q(W);return!_e(W)&&!le(W)&&("array"===Te||0===ue||"number"==typeof ue&&ue>0&&ue-1 in W)}F.fn=F.prototype={jquery:"3.5.1",constructor:F,length:0,toArray:function(){return N.call(this)},get:function(W){return null==W?N.call(this):W<0?this[W+this.length]:this[W]},pushStack:function(W){var ue=F.merge(this.constructor(),W);return ue.prevObject=this,ue},each:function(W){return F.each(this,W)},map:function(W){return this.pushStack(F.map(this,function(ue,Te){return W.call(ue,Te,ue)}))},slice:function(){return this.pushStack(N.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(F.grep(this,function(W,ue){return(ue+1)%2}))},odd:function(){return this.pushStack(F.grep(this,function(W,ue){return ue%2}))},eq:function(W){var ue=this.length,Te=+W+(W<0?ue:0);return this.pushStack(Te>=0&&Te<ue?[this[Te]]:[])},end:function(){return this.prevObject||this.constructor()},push:G,sort:l.sort,splice:l.splice},F.extend=F.fn.extend=function(){var W,ue,Te,Le,He,Ve,Qe=arguments[0]||{},Et=1,At=arguments.length,Xt=!1;for("boolean"==typeof Qe&&(Xt=Qe,Qe=arguments[Et]||{},Et++),"object"!=typeof Qe&&!_e(Qe)&&(Qe={}),Et===At&&(Qe=this,Et--);Et<At;Et++)if(null!=(W=arguments[Et]))for(ue in W)Le=W[ue],"__proto__"!==ue&&Qe!==Le&&(Xt&&Le&&(F.isPlainObject(Le)||(He=Array.isArray(Le)))?(Te=Qe[ue],Ve=He&&!Array.isArray(Te)?[]:He||F.isPlainObject(Te)?Te:{},He=!1,Qe[ue]=F.extend(Xt,Ve,Le)):void 0!==Le&&(Qe[ue]=Le));return Qe},F.extend({expando:"jQuery"+("3.5.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(W){throw new Error(W)},noop:function(){},isPlainObject:function(W){var ue,Te;return!(!W||"[object Object]"!==de.call(W)||(ue=x(W))&&("function"!=typeof(Te=be.call(ue,"constructor")&&ue.constructor)||te.call(Te)!==ce))},isEmptyObject:function(W){var ue;for(ue in W)return!1;return!0},globalEval:function(W,ue,Te){B(W,{nonce:ue&&ue.nonce},Te)},each:function(W,ue){var Te,Le=0;if(Be(W))for(Te=W.length;Le<Te&&!1!==ue.call(W[Le],Le,W[Le]);Le++);else for(Le in W)if(!1===ue.call(W[Le],Le,W[Le]))break;return W},makeArray:function(W,ue){var Te=ue||[];return null!=W&&(Be(Object(W))?F.merge(Te,"string"==typeof W?[W]:W):G.call(Te,W)),Te},inArray:function(W,ue,Te){return null==ue?-1:A.call(ue,W,Te)},merge:function(W,ue){for(var Te=+ue.length,Le=0,He=W.length;Le<Te;Le++)W[He++]=ue[Le];return W.length=He,W},grep:function(W,ue,Te){for(var He=[],Ve=0,Qe=W.length,Et=!Te;Ve<Qe;Ve++)!ue(W[Ve],Ve)!==Et&&He.push(W[Ve]);return He},map:function(W,ue,Te){var Le,He,Ve=0,Qe=[];if(Be(W))for(Le=W.length;Ve<Le;Ve++)null!=(He=ue(W[Ve],Ve,Te))&&Qe.push(He);else for(Ve in W)null!=(He=ue(W[Ve],Ve,Te))&&Qe.push(He);return U(Qe)},guid:1,support:fe}),"function"==typeof Symbol&&(F.fn[Symbol.iterator]=l[Symbol.iterator]),F.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(W,ue){P["[object "+ue+"]"]=ue.toLowerCase()});var K=
/*!
     * Sizzle CSS Selector Engine v2.3.5
     * https://sizzlejs.com/
     *
     * Copyright JS Foundation and other contributors
     * Released under the MIT license
     * https://js.foundation/
     *
     * Date: 2020-03-14
     */function(W){var ue,Te,Le,He,Ve,Qe,Et,At,Xt,fn,In,nn,xn,Er,Kr,Ar,ms,Ko,na,_i="sizzle"+1*new Date,Lr=W.document,Ia=0,Xi=0,Yi=Oa(),Jh=Oa(),uc=Oa(),ra=Oa(),el=function(tt,bt){return tt===bt&&(In=!0),0},ia={}.hasOwnProperty,Ui=[],Ps=Ui.pop,rr=Ui.push,wn=Ui.push,jo=Ui.slice,as=function(tt,bt){for(var kt=0,vn=tt.length;kt<vn;kt++)if(tt[kt]===bt)return kt;return-1},Ki="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",jr="[\\x20\\t\\r\\n\\f]",ui="(?:\\\\[\\da-fA-F]{1,6}"+jr+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",gi="\\["+jr+"*("+ui+")(?:"+jr+"*([*^$|!~]?=)"+jr+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+ui+"))|)"+jr+"*\\]",Is=":("+ui+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+gi+")*)|.*)\\)|)",Zh=new RegExp(jr+"+","g"),yo=new RegExp("^"+jr+"+|((?:^|[^\\\\])(?:\\\\.)*)"+jr+"+$","g"),vu=new RegExp("^"+jr+"*,"+jr+"*"),Un=new RegExp("^"+jr+"*([>+~]|"+jr+")"+jr+"*"),ot=new RegExp(jr+"|>"),wl=new RegExp(Is),Ts=new RegExp("^"+ui+"$"),Tp={ID:new RegExp("^#("+ui+")"),CLASS:new RegExp("^\\.("+ui+")"),TAG:new RegExp("^("+ui+"|[*])"),ATTR:new RegExp("^"+gi),PSEUDO:new RegExp("^"+Is),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+jr+"*(even|odd|(([+-]|)(\\d*)n|)"+jr+"*(?:([+-]|)"+jr+"*(\\d+)|))"+jr+"*\\)|)","i"),bool:new RegExp("^(?:"+Ki+")$","i"),needsContext:new RegExp("^"+jr+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+jr+"*((?:-\\d)?\\d*)"+jr+"*\\)|)(?=[^-]|$)","i")},Ms=/HTML$/i,hc=/^(?:input|select|textarea|button)$/i,Hi=/^h\d$/i,io=/^[^{]+\{\s*\[native \w/,ti=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,zc=/[+~]/,Li=new RegExp("\\\\[\\da-fA-F]{1,6}"+jr+"?|\\\\([^\\r\\n\\f])","g"),lt=function(tt,bt){var kt="0x"+tt.slice(1)-65536;return bt||(kt<0?String.fromCharCode(kt+65536):String.fromCharCode(kt>>10|55296,1023&kt|56320))},yu=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,Mp=function(tt,bt){return bt?"\0"===tt?"\ufffd":tt.slice(0,-1)+"\\"+tt.charCodeAt(tt.length-1).toString(16)+" ":"\\"+tt},Vi=function(){nn()},kr=ya(function(tt){return!0===tt.disabled&&"fieldset"===tt.nodeName.toLowerCase()},{dir:"parentNode",next:"legend"});try{wn.apply(Ui=jo.call(Lr.childNodes),Lr.childNodes)}catch{wn={apply:Ui.length?function(bt,kt){rr.apply(bt,jo.call(kt))}:function(bt,kt){for(var vn=bt.length,qt=0;bt[vn++]=kt[qt++];);bt.length=vn-1}}}function Wr(tt,bt,kt,vn){var qt,_n,Qt,Jn,zn,Sr,$r,yr=bt&&bt.ownerDocument,qr=bt?bt.nodeType:9;if(kt=kt||[],"string"!=typeof tt||!tt||1!==qr&&9!==qr&&11!==qr)return kt;if(!vn&&(nn(bt),bt=bt||xn,Kr)){if(11!==qr&&(zn=ti.exec(tt)))if(qt=zn[1]){if(9===qr){if(!(Qt=bt.getElementById(qt)))return kt;if(Qt.id===qt)return kt.push(Qt),kt}else if(yr&&(Qt=yr.getElementById(qt))&&na(bt,Qt)&&Qt.id===qt)return kt.push(Qt),kt}else{if(zn[2])return wn.apply(kt,bt.getElementsByTagName(tt)),kt;if((qt=zn[3])&&Te.getElementsByClassName&&bt.getElementsByClassName)return wn.apply(kt,bt.getElementsByClassName(qt)),kt}if(Te.qsa&&!ra[tt+" "]&&(!Ar||!Ar.test(tt))&&(1!==qr||"object"!==bt.nodeName.toLowerCase())){if($r=tt,yr=bt,1===qr&&(ot.test(tt)||Un.test(tt))){for(((yr=zc.test(tt)&&er(bt.parentNode)||bt)!==bt||!Te.scope)&&((Jn=bt.getAttribute("id"))?Jn=Jn.replace(yu,Mp):bt.setAttribute("id",Jn=_i)),_n=(Sr=Qe(tt)).length;_n--;)Sr[_n]=(Jn?"#"+Jn:":scope")+" "+ka(Sr[_n]);$r=Sr.join(",")}try{return wn.apply(kt,yr.querySelectorAll($r)),kt}catch{ra(tt,!0)}finally{Jn===_i&&bt.removeAttribute("id")}}}return At(tt.replace(yo,"$1"),bt,kt,vn)}function Oa(){var tt=[];return function bt(kt,vn){return tt.push(kt+" ")>Le.cacheLength&&delete bt[tt.shift()],bt[kt+" "]=vn}}function bo(tt){return tt[_i]=!0,tt}function oa(tt){var bt=xn.createElement("fieldset");try{return!!tt(bt)}catch{return!1}finally{bt.parentNode&&bt.parentNode.removeChild(bt),bt=null}}function bu(tt,bt){for(var kt=tt.split("|"),vn=kt.length;vn--;)Le.attrHandle[kt[vn]]=bt}function pc(tt,bt){var kt=bt&&tt,vn=kt&&1===tt.nodeType&&1===bt.nodeType&&tt.sourceIndex-bt.sourceIndex;if(vn)return vn;if(kt)for(;kt=kt.nextSibling;)if(kt===bt)return-1;return tt?1:-1}function jc(tt){return function(bt){return"input"===bt.nodeName.toLowerCase()&&bt.type===tt}}function xu(tt){return function(bt){var kt=bt.nodeName.toLowerCase();return("input"===kt||"button"===kt)&&bt.type===tt}}function wh(tt){return function(bt){return"form"in bt?bt.parentNode&&!1===bt.disabled?"label"in bt?"label"in bt.parentNode?bt.parentNode.disabled===tt:bt.disabled===tt:bt.isDisabled===tt||bt.isDisabled!==!tt&&kr(bt)===tt:bt.disabled===tt:"label"in bt&&bt.disabled===tt}}function dc(tt){return bo(function(bt){return bt=+bt,bo(function(kt,vn){for(var qt,_n=tt([],kt.length,bt),Qt=_n.length;Qt--;)kt[qt=_n[Qt]]&&(kt[qt]=!(vn[qt]=kt[qt]))})})}function er(tt){return tt&&typeof tt.getElementsByTagName<"u"&&tt}for(ue in Te=Wr.support={},Ve=Wr.isXML=function(tt){var kt=(tt.ownerDocument||tt).documentElement;return!Ms.test(tt.namespaceURI||kt&&kt.nodeName||"HTML")},nn=Wr.setDocument=function(tt){var bt,kt,vn=tt?tt.ownerDocument||tt:Lr;return vn==xn||9!==vn.nodeType||!vn.documentElement||(Er=(xn=vn).documentElement,Kr=!Ve(xn),Lr!=xn&&(kt=xn.defaultView)&&kt.top!==kt&&(kt.addEventListener?kt.addEventListener("unload",Vi,!1):kt.attachEvent&&kt.attachEvent("onunload",Vi)),Te.scope=oa(function(qt){return Er.appendChild(qt).appendChild(xn.createElement("div")),typeof qt.querySelectorAll<"u"&&!qt.querySelectorAll(":scope fieldset div").length}),Te.attributes=oa(function(qt){return qt.className="i",!qt.getAttribute("className")}),Te.getElementsByTagName=oa(function(qt){return qt.appendChild(xn.createComment("")),!qt.getElementsByTagName("*").length}),Te.getElementsByClassName=io.test(xn.getElementsByClassName),Te.getById=oa(function(qt){return Er.appendChild(qt).id=_i,!xn.getElementsByName||!xn.getElementsByName(_i).length}),Te.getById?(Le.filter.ID=function(qt){var _n=qt.replace(Li,lt);return function(Qt){return Qt.getAttribute("id")===_n}},Le.find.ID=function(qt,_n){if(typeof _n.getElementById<"u"&&Kr){var Qt=_n.getElementById(qt);return Qt?[Qt]:[]}}):(Le.filter.ID=function(qt){var _n=qt.replace(Li,lt);return function(Qt){var Jn=typeof Qt.getAttributeNode<"u"&&Qt.getAttributeNode("id");return Jn&&Jn.value===_n}},Le.find.ID=function(qt,_n){if(typeof _n.getElementById<"u"&&Kr){var Qt,Jn,zn,Sr=_n.getElementById(qt);if(Sr){if((Qt=Sr.getAttributeNode("id"))&&Qt.value===qt)return[Sr];for(zn=_n.getElementsByName(qt),Jn=0;Sr=zn[Jn++];)if((Qt=Sr.getAttributeNode("id"))&&Qt.value===qt)return[Sr]}return[]}}),Le.find.TAG=Te.getElementsByTagName?function(qt,_n){return typeof _n.getElementsByTagName<"u"?_n.getElementsByTagName(qt):Te.qsa?_n.querySelectorAll(qt):void 0}:function(qt,_n){var Qt,Jn=[],zn=0,Sr=_n.getElementsByTagName(qt);if("*"===qt){for(;Qt=Sr[zn++];)1===Qt.nodeType&&Jn.push(Qt);return Jn}return Sr},Le.find.CLASS=Te.getElementsByClassName&&function(qt,_n){if(typeof _n.getElementsByClassName<"u"&&Kr)return _n.getElementsByClassName(qt)},ms=[],Ar=[],(Te.qsa=io.test(xn.querySelectorAll))&&(oa(function(qt){var _n;Er.appendChild(qt).innerHTML="<a id='"+_i+"'></a><select id='"+_i+"-\r\\' msallowcapture=''><option selected=''></option></select>",qt.querySelectorAll("[msallowcapture^='']").length&&Ar.push("[*^$]="+jr+"*(?:''|\"\")"),qt.querySelectorAll("[selected]").length||Ar.push("\\["+jr+"*(?:value|"+Ki+")"),qt.querySelectorAll("[id~="+_i+"-]").length||Ar.push("~="),(_n=xn.createElement("input")).setAttribute("name",""),qt.appendChild(_n),qt.querySelectorAll("[name='']").length||Ar.push("\\["+jr+"*name"+jr+"*="+jr+"*(?:''|\"\")"),qt.querySelectorAll(":checked").length||Ar.push(":checked"),qt.querySelectorAll("a#"+_i+"+*").length||Ar.push(".#.+[+~]"),qt.querySelectorAll("\\\f"),Ar.push("[\\r\\n\\f]")}),oa(function(qt){qt.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var _n=xn.createElement("input");_n.setAttribute("type","hidden"),qt.appendChild(_n).setAttribute("name","D"),qt.querySelectorAll("[name=d]").length&&Ar.push("name"+jr+"*[*^$|!~]?="),2!==qt.querySelectorAll(":enabled").length&&Ar.push(":enabled",":disabled"),Er.appendChild(qt).disabled=!0,2!==qt.querySelectorAll(":disabled").length&&Ar.push(":enabled",":disabled"),qt.querySelectorAll("*,:x"),Ar.push(",.*:")})),(Te.matchesSelector=io.test(Ko=Er.matches||Er.webkitMatchesSelector||Er.mozMatchesSelector||Er.oMatchesSelector||Er.msMatchesSelector))&&oa(function(qt){Te.disconnectedMatch=Ko.call(qt,"*"),Ko.call(qt,"[s!='']:x"),ms.push("!=",Is)}),Ar=Ar.length&&new RegExp(Ar.join("|")),ms=ms.length&&new RegExp(ms.join("|")),bt=io.test(Er.compareDocumentPosition),na=bt||io.test(Er.contains)?function(qt,_n){var Qt=9===qt.nodeType?qt.documentElement:qt,Jn=_n&&_n.parentNode;return qt===Jn||!(!Jn||1!==Jn.nodeType||!(Qt.contains?Qt.contains(Jn):qt.compareDocumentPosition&&16&qt.compareDocumentPosition(Jn)))}:function(qt,_n){if(_n)for(;_n=_n.parentNode;)if(_n===qt)return!0;return!1},el=bt?function(qt,_n){if(qt===_n)return In=!0,0;var Qt=!qt.compareDocumentPosition-!_n.compareDocumentPosition;return Qt||(1&(Qt=(qt.ownerDocument||qt)==(_n.ownerDocument||_n)?qt.compareDocumentPosition(_n):1)||!Te.sortDetached&&_n.compareDocumentPosition(qt)===Qt?qt==xn||qt.ownerDocument==Lr&&na(Lr,qt)?-1:_n==xn||_n.ownerDocument==Lr&&na(Lr,_n)?1:fn?as(fn,qt)-as(fn,_n):0:4&Qt?-1:1)}:function(qt,_n){if(qt===_n)return In=!0,0;var Qt,Jn=0,zn=qt.parentNode,Sr=_n.parentNode,$r=[qt],yr=[_n];if(!zn||!Sr)return qt==xn?-1:_n==xn?1:zn?-1:Sr?1:fn?as(fn,qt)-as(fn,_n):0;if(zn===Sr)return pc(qt,_n);for(Qt=qt;Qt=Qt.parentNode;)$r.unshift(Qt);for(Qt=_n;Qt=Qt.parentNode;)yr.unshift(Qt);for(;$r[Jn]===yr[Jn];)Jn++;return Jn?pc($r[Jn],yr[Jn]):$r[Jn]==Lr?-1:yr[Jn]==Lr?1:0}),xn},Wr.matches=function(tt,bt){return Wr(tt,null,null,bt)},Wr.matchesSelector=function(tt,bt){if(nn(tt),Te.matchesSelector&&Kr&&!ra[bt+" "]&&(!ms||!ms.test(bt))&&(!Ar||!Ar.test(bt)))try{var kt=Ko.call(tt,bt);if(kt||Te.disconnectedMatch||tt.document&&11!==tt.document.nodeType)return kt}catch{ra(bt,!0)}return Wr(bt,xn,null,[tt]).length>0},Wr.contains=function(tt,bt){return(tt.ownerDocument||tt)!=xn&&nn(tt),na(tt,bt)},Wr.attr=function(tt,bt){(tt.ownerDocument||tt)!=xn&&nn(tt);var kt=Le.attrHandle[bt.toLowerCase()],vn=kt&&ia.call(Le.attrHandle,bt.toLowerCase())?kt(tt,bt,!Kr):void 0;return void 0!==vn?vn:Te.attributes||!Kr?tt.getAttribute(bt):(vn=tt.getAttributeNode(bt))&&vn.specified?vn.value:null},Wr.escape=function(tt){return(tt+"").replace(yu,Mp)},Wr.error=function(tt){throw new Error("Syntax error, unrecognized expression: "+tt)},Wr.uniqueSort=function(tt){var bt,kt=[],vn=0,qt=0;if(In=!Te.detectDuplicates,fn=!Te.sortStable&&tt.slice(0),tt.sort(el),In){for(;bt=tt[qt++];)bt===tt[qt]&&(vn=kt.push(qt));for(;vn--;)tt.splice(kt[vn],1)}return fn=null,tt},He=Wr.getText=function(tt){var bt,kt="",vn=0,qt=tt.nodeType;if(qt){if(1===qt||9===qt||11===qt){if("string"==typeof tt.textContent)return tt.textContent;for(tt=tt.firstChild;tt;tt=tt.nextSibling)kt+=He(tt)}else if(3===qt||4===qt)return tt.nodeValue}else for(;bt=tt[vn++];)kt+=He(bt);return kt},(Le=Wr.selectors={cacheLength:50,createPseudo:bo,match:Tp,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(tt){return tt[1]=tt[1].replace(Li,lt),tt[3]=(tt[3]||tt[4]||tt[5]||"").replace(Li,lt),"~="===tt[2]&&(tt[3]=" "+tt[3]+" "),tt.slice(0,4)},CHILD:function(tt){return tt[1]=tt[1].toLowerCase(),"nth"===tt[1].slice(0,3)?(tt[3]||Wr.error(tt[0]),tt[4]=+(tt[4]?tt[5]+(tt[6]||1):2*("even"===tt[3]||"odd"===tt[3])),tt[5]=+(tt[7]+tt[8]||"odd"===tt[3])):tt[3]&&Wr.error(tt[0]),tt},PSEUDO:function(tt){var bt,kt=!tt[6]&&tt[2];return Tp.CHILD.test(tt[0])?null:(tt[3]?tt[2]=tt[4]||tt[5]||"":kt&&wl.test(kt)&&(bt=Qe(kt,!0))&&(bt=kt.indexOf(")",kt.length-bt)-kt.length)&&(tt[0]=tt[0].slice(0,bt),tt[2]=kt.slice(0,bt)),tt.slice(0,3))}},filter:{TAG:function(tt){var bt=tt.replace(Li,lt).toLowerCase();return"*"===tt?function(){return!0}:function(kt){return kt.nodeName&&kt.nodeName.toLowerCase()===bt}},CLASS:function(tt){var bt=Yi[tt+" "];return bt||(bt=new RegExp("(^|"+jr+")"+tt+"("+jr+"|$)"))&&Yi(tt,function(kt){return bt.test("string"==typeof kt.className&&kt.className||typeof kt.getAttribute<"u"&&kt.getAttribute("class")||"")})},ATTR:function(tt,bt,kt){return function(vn){var qt=Wr.attr(vn,tt);return null==qt?"!="===bt:!bt||(qt+="","="===bt?qt===kt:"!="===bt?qt!==kt:"^="===bt?kt&&0===qt.indexOf(kt):"*="===bt?kt&&qt.indexOf(kt)>-1:"$="===bt?kt&&qt.slice(-kt.length)===kt:"~="===bt?(" "+qt.replace(Zh," ")+" ").indexOf(kt)>-1:"|="===bt&&(qt===kt||qt.slice(0,kt.length+1)===kt+"-"))}},CHILD:function(tt,bt,kt,vn,qt){var _n="nth"!==tt.slice(0,3),Qt="last"!==tt.slice(-4),Jn="of-type"===bt;return 1===vn&&0===qt?function(zn){return!!zn.parentNode}:function(zn,Sr,$r){var yr,qr,hi,Rr,es,co,qs=_n!==Qt?"nextSibling":"previousSibling",No=zn.parentNode,Vl=Jn&&zn.nodeName.toLowerCase(),Wo=!$r&&!Jn,Ji=!1;if(No){if(_n){for(;qs;){for(Rr=zn;Rr=Rr[qs];)if(Jn?Rr.nodeName.toLowerCase()===Vl:1===Rr.nodeType)return!1;co=qs="only"===tt&&!co&&"nextSibling"}return!0}if(co=[Qt?No.firstChild:No.lastChild],Qt&&Wo){for(Ji=(es=(yr=(qr=(hi=(Rr=No)[_i]||(Rr[_i]={}))[Rr.uniqueID]||(hi[Rr.uniqueID]={}))[tt]||[])[0]===Ia&&yr[1])&&yr[2],Rr=es&&No.childNodes[es];Rr=++es&&Rr&&Rr[qs]||(Ji=es=0)||co.pop();)if(1===Rr.nodeType&&++Ji&&Rr===zn){qr[tt]=[Ia,es,Ji];break}}else if(Wo&&(Ji=es=(yr=(qr=(hi=(Rr=zn)[_i]||(Rr[_i]={}))[Rr.uniqueID]||(hi[Rr.uniqueID]={}))[tt]||[])[0]===Ia&&yr[1]),!1===Ji)for(;(Rr=++es&&Rr&&Rr[qs]||(Ji=es=0)||co.pop())&&((Jn?Rr.nodeName.toLowerCase()!==Vl:1!==Rr.nodeType)||!++Ji||(Wo&&((qr=(hi=Rr[_i]||(Rr[_i]={}))[Rr.uniqueID]||(hi[Rr.uniqueID]={}))[tt]=[Ia,Ji]),Rr!==zn)););return(Ji-=qt)===vn||Ji%vn==0&&Ji/vn>=0}}},PSEUDO:function(tt,bt){var kt,vn=Le.pseudos[tt]||Le.setFilters[tt.toLowerCase()]||Wr.error("unsupported pseudo: "+tt);return vn[_i]?vn(bt):vn.length>1?(kt=[tt,tt,"",bt],Le.setFilters.hasOwnProperty(tt.toLowerCase())?bo(function(qt,_n){for(var Qt,Jn=vn(qt,bt),zn=Jn.length;zn--;)qt[Qt=as(qt,Jn[zn])]=!(_n[Qt]=Jn[zn])}):function(qt){return vn(qt,0,kt)}):vn}},pseudos:{not:bo(function(tt){var bt=[],kt=[],vn=Et(tt.replace(yo,"$1"));return vn[_i]?bo(function(qt,_n,Qt,Jn){for(var zn,Sr=vn(qt,null,Jn,[]),$r=qt.length;$r--;)(zn=Sr[$r])&&(qt[$r]=!(_n[$r]=zn))}):function(qt,_n,Qt){return bt[0]=qt,vn(bt,null,Qt,kt),bt[0]=null,!kt.pop()}}),has:bo(function(tt){return function(bt){return Wr(tt,bt).length>0}}),contains:bo(function(tt){return tt=tt.replace(Li,lt),function(bt){return(bt.textContent||He(bt)).indexOf(tt)>-1}}),lang:bo(function(tt){return Ts.test(tt||"")||Wr.error("unsupported lang: "+tt),tt=tt.replace(Li,lt).toLowerCase(),function(bt){var kt;do{if(kt=Kr?bt.lang:bt.getAttribute("xml:lang")||bt.getAttribute("lang"))return(kt=kt.toLowerCase())===tt||0===kt.indexOf(tt+"-")}while((bt=bt.parentNode)&&1===bt.nodeType);return!1}}),target:function(tt){var bt=W.location&&W.location.hash;return bt&&bt.slice(1)===tt.id},root:function(tt){return tt===Er},focus:function(tt){return tt===xn.activeElement&&(!xn.hasFocus||xn.hasFocus())&&!!(tt.type||tt.href||~tt.tabIndex)},enabled:wh(!1),disabled:wh(!0),checked:function(tt){var bt=tt.nodeName.toLowerCase();return"input"===bt&&!!tt.checked||"option"===bt&&!!tt.selected},selected:function(tt){return!0===tt.selected},empty:function(tt){for(tt=tt.firstChild;tt;tt=tt.nextSibling)if(tt.nodeType<6)return!1;return!0},parent:function(tt){return!Le.pseudos.empty(tt)},header:function(tt){return Hi.test(tt.nodeName)},input:function(tt){return hc.test(tt.nodeName)},button:function(tt){var bt=tt.nodeName.toLowerCase();return"input"===bt&&"button"===tt.type||"button"===bt},text:function(tt){var bt;return"input"===tt.nodeName.toLowerCase()&&"text"===tt.type&&(null==(bt=tt.getAttribute("type"))||"text"===bt.toLowerCase())},first:dc(function(){return[0]}),last:dc(function(tt,bt){return[bt-1]}),eq:dc(function(tt,bt,kt){return[kt<0?kt+bt:kt]}),even:dc(function(tt,bt){for(var kt=0;kt<bt;kt+=2)tt.push(kt);return tt}),odd:dc(function(tt,bt){for(var kt=1;kt<bt;kt+=2)tt.push(kt);return tt}),lt:dc(function(tt,bt,kt){for(var vn=kt<0?kt+bt:kt>bt?bt:kt;--vn>=0;)tt.push(vn);return tt}),gt:dc(function(tt,bt,kt){for(var vn=kt<0?kt+bt:kt;++vn<bt;)tt.push(vn);return tt})}}).pseudos.nth=Le.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})Le.pseudos[ue]=jc(ue);for(ue in{submit:!0,reset:!0})Le.pseudos[ue]=xu(ue);function Sl(){}function ka(tt){for(var bt=0,kt=tt.length,vn="";bt<kt;bt++)vn+=tt[bt].value;return vn}function ya(tt,bt,kt){var vn=bt.dir,qt=bt.next,_n=qt||vn,Qt=kt&&"parentNode"===_n,Jn=Xi++;return bt.first?function(zn,Sr,$r){for(;zn=zn[vn];)if(1===zn.nodeType||Qt)return tt(zn,Sr,$r);return!1}:function(zn,Sr,$r){var yr,qr,hi,Rr=[Ia,Jn];if($r){for(;zn=zn[vn];)if((1===zn.nodeType||Qt)&&tt(zn,Sr,$r))return!0}else for(;zn=zn[vn];)if(1===zn.nodeType||Qt)if(qr=(hi=zn[_i]||(zn[_i]={}))[zn.uniqueID]||(hi[zn.uniqueID]={}),qt&&qt===zn.nodeName.toLowerCase())zn=zn[vn]||zn;else{if((yr=qr[_n])&&yr[0]===Ia&&yr[1]===Jn)return Rr[2]=yr[2];if(qr[_n]=Rr,Rr[2]=tt(zn,Sr,$r))return!0}return!1}}function Hl(tt){return tt.length>1?function(bt,kt,vn){for(var qt=tt.length;qt--;)if(!tt[qt](bt,kt,vn))return!1;return!0}:tt[0]}function ba(tt,bt,kt,vn,qt){for(var _n,Qt=[],Jn=0,zn=tt.length,Sr=null!=bt;Jn<zn;Jn++)(_n=tt[Jn])&&(!kt||kt(_n,vn,qt))&&(Qt.push(_n),Sr&&bt.push(Jn));return Qt}function xo(tt,bt,kt,vn,qt,_n){return vn&&!vn[_i]&&(vn=xo(vn)),qt&&!qt[_i]&&(qt=xo(qt,_n)),bo(function(Qt,Jn,zn,Sr){var $r,yr,qr,hi=[],Rr=[],es=Jn.length,co=Qt||function wu(tt,bt,kt){for(var vn=0,qt=bt.length;vn<qt;vn++)Wr(tt,bt[vn],kt);return kt}(bt||"*",zn.nodeType?[zn]:zn,[]),qs=!tt||!Qt&&bt?co:ba(co,hi,tt,zn,Sr),No=kt?qt||(Qt?tt:es||vn)?[]:Jn:qs;if(kt&&kt(qs,No,zn,Sr),vn)for($r=ba(No,Rr),vn($r,[],zn,Sr),yr=$r.length;yr--;)(qr=$r[yr])&&(No[Rr[yr]]=!(qs[Rr[yr]]=qr));if(Qt){if(qt||tt){if(qt){for($r=[],yr=No.length;yr--;)(qr=No[yr])&&$r.push(qs[yr]=qr);qt(null,No=[],$r,Sr)}for(yr=No.length;yr--;)(qr=No[yr])&&($r=qt?as(Qt,qr):hi[yr])>-1&&(Qt[$r]=!(Jn[$r]=qr))}}else No=ba(No===Jn?No.splice(es,No.length):No),qt?qt(null,Jn,No,Sr):wn.apply(Jn,No)})}function Os(tt){for(var bt,kt,vn,qt=tt.length,_n=Le.relative[tt[0].type],Qt=_n||Le.relative[" "],Jn=_n?1:0,zn=ya(function(yr){return yr===bt},Qt,!0),Sr=ya(function(yr){return as(bt,yr)>-1},Qt,!0),$r=[function(yr,qr,hi){var Rr=!_n&&(hi||qr!==Xt)||((bt=qr).nodeType?zn(yr,qr,hi):Sr(yr,qr,hi));return bt=null,Rr}];Jn<qt;Jn++)if(kt=Le.relative[tt[Jn].type])$r=[ya(Hl($r),kt)];else{if((kt=Le.filter[tt[Jn].type].apply(null,tt[Jn].matches))[_i]){for(vn=++Jn;vn<qt&&!Le.relative[tt[vn].type];vn++);return xo(Jn>1&&Hl($r),Jn>1&&ka(tt.slice(0,Jn-1).concat({value:" "===tt[Jn-2].type?"*":""})).replace(yo,"$1"),kt,Jn<vn&&Os(tt.slice(Jn,vn)),vn<qt&&Os(tt=tt.slice(vn)),vn<qt&&ka(tt))}$r.push(kt)}return Hl($r)}return Sl.prototype=Le.filters=Le.pseudos,Le.setFilters=new Sl,Qe=Wr.tokenize=function(tt,bt){var kt,vn,qt,_n,Qt,Jn,zn,Sr=Jh[tt+" "];if(Sr)return bt?0:Sr.slice(0);for(Qt=tt,Jn=[],zn=Le.preFilter;Qt;){for(_n in(!kt||(vn=vu.exec(Qt)))&&(vn&&(Qt=Qt.slice(vn[0].length)||Qt),Jn.push(qt=[])),kt=!1,(vn=Un.exec(Qt))&&(kt=vn.shift(),qt.push({value:kt,type:vn[0].replace(yo," ")}),Qt=Qt.slice(kt.length)),Le.filter)(vn=Tp[_n].exec(Qt))&&(!zn[_n]||(vn=zn[_n](vn)))&&(kt=vn.shift(),qt.push({value:kt,type:_n,matches:vn}),Qt=Qt.slice(kt.length));if(!kt)break}return bt?Qt.length:Qt?Wr.error(tt):Jh(tt,Jn).slice(0)},Et=Wr.compile=function(tt,bt){var kt,vn=[],qt=[],_n=uc[tt+" "];if(!_n){for(bt||(bt=Qe(tt)),kt=bt.length;kt--;)(_n=Os(bt[kt]))[_i]?vn.push(_n):qt.push(_n);_n=uc(tt,function mc(tt,bt){var kt=bt.length>0,vn=tt.length>0,qt=function(_n,Qt,Jn,zn,Sr){var $r,yr,qr,hi=0,Rr="0",es=_n&&[],co=[],qs=Xt,No=_n||vn&&Le.find.TAG("*",Sr),Vl=Ia+=null==qs?1:Math.random()||.1,Wo=No.length;for(Sr&&(Xt=Qt==xn||Qt||Sr);Rr!==Wo&&null!=($r=No[Rr]);Rr++){if(vn&&$r){for(yr=0,!Qt&&$r.ownerDocument!=xn&&(nn($r),Jn=!Kr);qr=tt[yr++];)if(qr($r,Qt||xn,Jn)){zn.push($r);break}Sr&&(Ia=Vl)}kt&&(($r=!qr&&$r)&&hi--,_n&&es.push($r))}if(hi+=Rr,kt&&Rr!==hi){for(yr=0;qr=bt[yr++];)qr(es,co,Qt,Jn);if(_n){if(hi>0)for(;Rr--;)es[Rr]||co[Rr]||(co[Rr]=Ps.call(zn));co=ba(co)}wn.apply(zn,co),Sr&&!_n&&co.length>0&&hi+bt.length>1&&Wr.uniqueSort(zn)}return Sr&&(Ia=Vl,Xt=qs),es};return kt?bo(qt):qt}(qt,vn)),_n.selector=tt}return _n},At=Wr.select=function(tt,bt,kt,vn){var qt,_n,Qt,Jn,zn,Sr="function"==typeof tt&&tt,$r=!vn&&Qe(tt=Sr.selector||tt);if(kt=kt||[],1===$r.length){if((_n=$r[0]=$r[0].slice(0)).length>2&&"ID"===(Qt=_n[0]).type&&9===bt.nodeType&&Kr&&Le.relative[_n[1].type]){if(!(bt=(Le.find.ID(Qt.matches[0].replace(Li,lt),bt)||[])[0]))return kt;Sr&&(bt=bt.parentNode),tt=tt.slice(_n.shift().value.length)}for(qt=Tp.needsContext.test(tt)?0:_n.length;qt--&&!Le.relative[Jn=(Qt=_n[qt]).type];)if((zn=Le.find[Jn])&&(vn=zn(Qt.matches[0].replace(Li,lt),zc.test(_n[0].type)&&er(bt.parentNode)||bt))){if(_n.splice(qt,1),!(tt=vn.length&&ka(_n)))return wn.apply(kt,vn),kt;break}}return(Sr||Et(tt,$r))(vn,bt,!Kr,kt,!bt||zc.test(tt)&&er(bt.parentNode)||bt),kt},Te.sortStable=_i.split("").sort(el).join("")===_i,Te.detectDuplicates=!!In,nn(),Te.sortDetached=oa(function(tt){return 1&tt.compareDocumentPosition(xn.createElement("fieldset"))}),oa(function(tt){return tt.innerHTML="<a href='#'></a>","#"===tt.firstChild.getAttribute("href")})||bu("type|href|height|width",function(tt,bt,kt){if(!kt)return tt.getAttribute(bt,"type"===bt.toLowerCase()?1:2)}),(!Te.attributes||!oa(function(tt){return tt.innerHTML="<input/>",tt.firstChild.setAttribute("value",""),""===tt.firstChild.getAttribute("value")}))&&bu("value",function(tt,bt,kt){if(!kt&&"input"===tt.nodeName.toLowerCase())return tt.defaultValue}),oa(function(tt){return null==tt.getAttribute("disabled")})||bu(Ki,function(tt,bt,kt){var vn;if(!kt)return!0===tt[bt]?bt.toLowerCase():(vn=tt.getAttributeNode(bt))&&vn.specified?vn.value:null}),Wr}(n);F.find=K,F.expr=K.selectors,F.expr[":"]=F.expr.pseudos,F.uniqueSort=F.unique=K.uniqueSort,F.text=K.getText,F.isXMLDoc=K.isXML,F.contains=K.contains,F.escapeSelector=K.escape;var ve=function(W,ue,Te){for(var Le=[],He=void 0!==Te;(W=W[ue])&&9!==W.nodeType;)if(1===W.nodeType){if(He&&F(W).is(Te))break;Le.push(W)}return Le},Ae=function(W,ue){for(var Te=[];W;W=W.nextSibling)1===W.nodeType&&W!==ue&&Te.push(W);return Te},Fe=F.expr.match.needsContext;function Ee(W,ue){return W.nodeName&&W.nodeName.toLowerCase()===ue.toLowerCase()}var qe=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function Ke(W,ue,Te){return _e(ue)?F.grep(W,function(Le,He){return!!ue.call(Le,He,Le)!==Te}):ue.nodeType?F.grep(W,function(Le){return Le===ue!==Te}):"string"!=typeof ue?F.grep(W,function(Le){return A.call(ue,Le)>-1!==Te}):F.filter(ue,W,Te)}F.filter=function(W,ue,Te){var Le=ue[0];return Te&&(W=":not("+W+")"),1===ue.length&&1===Le.nodeType?F.find.matchesSelector(Le,W)?[Le]:[]:F.find.matches(W,F.grep(ue,function(He){return 1===He.nodeType}))},F.fn.extend({find:function(W){var ue,Te,Le=this.length,He=this;if("string"!=typeof W)return this.pushStack(F(W).filter(function(){for(ue=0;ue<Le;ue++)if(F.contains(He[ue],this))return!0}));for(Te=this.pushStack([]),ue=0;ue<Le;ue++)F.find(W,He[ue],Te);return Le>1?F.uniqueSort(Te):Te},filter:function(W){return this.pushStack(Ke(this,W||[],!1))},not:function(W){return this.pushStack(Ke(this,W||[],!0))},is:function(W){return!!Ke(this,"string"==typeof W&&Fe.test(W)?F(W):W||[],!1).length}});var gt,at=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,Ct=F.fn.init=function(W,ue,Te){var Le,He;if(!W)return this;if(Te=Te||gt,"string"==typeof W){if(!(Le="<"===W[0]&&">"===W[W.length-1]&&W.length>=3?[null,W,null]:at.exec(W))||!Le[1]&&ue)return!ue||ue.jquery?(ue||Te).find(W):this.constructor(ue).find(W);if(Le[1]){if(F.merge(this,F.parseHTML(Le[1],(ue=ue instanceof F?ue[0]:ue)&&ue.nodeType?ue.ownerDocument||ue:pe,!0)),qe.test(Le[1])&&F.isPlainObject(ue))for(Le in ue)_e(this[Le])?this[Le](ue[Le]):this.attr(Le,ue[Le]);return this}return(He=pe.getElementById(Le[2]))&&(this[0]=He,this.length=1),this}return W.nodeType?(this[0]=W,this.length=1,this):_e(W)?void 0!==Te.ready?Te.ready(W):W(F):F.makeArray(W,this)};Ct.prototype=F.fn,gt=F(pe);var wt=/^(?:parents|prev(?:Until|All))/,Ft={children:!0,contents:!0,next:!0,prev:!0};function Ot(W,ue){for(;(W=W[ue])&&1!==W.nodeType;);return W}F.fn.extend({has:function(W){var ue=F(W,this),Te=ue.length;return this.filter(function(){for(var Le=0;Le<Te;Le++)if(F.contains(this,ue[Le]))return!0})},closest:function(W,ue){var Te,Le=0,He=this.length,Ve=[],Qe="string"!=typeof W&&F(W);if(!Fe.test(W))for(;Le<He;Le++)for(Te=this[Le];Te&&Te!==ue;Te=Te.parentNode)if(Te.nodeType<11&&(Qe?Qe.index(Te)>-1:1===Te.nodeType&&F.find.matchesSelector(Te,W))){Ve.push(Te);break}return this.pushStack(Ve.length>1?F.uniqueSort(Ve):Ve)},index:function(W){return W?"string"==typeof W?A.call(F(W),this[0]):A.call(this,W.jquery?W[0]:W):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(W,ue){return this.pushStack(F.uniqueSort(F.merge(this.get(),F(W,ue))))},addBack:function(W){return this.add(null==W?this.prevObject:this.prevObject.filter(W))}}),F.each({parent:function(W){var ue=W.parentNode;return ue&&11!==ue.nodeType?ue:null},parents:function(W){return ve(W,"parentNode")},parentsUntil:function(W,ue,Te){return ve(W,"parentNode",Te)},next:function(W){return Ot(W,"nextSibling")},prev:function(W){return Ot(W,"previousSibling")},nextAll:function(W){return ve(W,"nextSibling")},prevAll:function(W){return ve(W,"previousSibling")},nextUntil:function(W,ue,Te){return ve(W,"nextSibling",Te)},prevUntil:function(W,ue,Te){return ve(W,"previousSibling",Te)},siblings:function(W){return Ae((W.parentNode||{}).firstChild,W)},children:function(W){return Ae(W.firstChild)},contents:function(W){return null!=W.contentDocument&&x(W.contentDocument)?W.contentDocument:(Ee(W,"template")&&(W=W.content||W),F.merge([],W.childNodes))}},function(W,ue){F.fn[W]=function(Te,Le){var He=F.map(this,ue,Te);return"Until"!==W.slice(-5)&&(Le=Te),Le&&"string"==typeof Le&&(He=F.filter(Le,He)),this.length>1&&(Ft[W]||F.uniqueSort(He),wt.test(W)&&He.reverse()),this.pushStack(He)}});var rn=/[^\x20\t\r\n\f]+/g;function Tn(W){return W}function Cn(W){throw W}function mn(W,ue,Te,Le){var He;try{W&&_e(He=W.promise)?He.call(W).done(ue).fail(Te):W&&_e(He=W.then)?He.call(W,ue,Te):ue.apply(void 0,[W].slice(Le))}catch(Ve){Te.apply(void 0,[Ve])}}F.Callbacks=function(W){W="string"==typeof W?function ft(W){var ue={};return F.each(W.match(rn)||[],function(Te,Le){ue[Le]=!0}),ue}(W):F.extend({},W);var ue,Te,Le,He,Ve=[],Qe=[],Et=-1,At=function(){for(He=He||W.once,Le=ue=!0;Qe.length;Et=-1)for(Te=Qe.shift();++Et<Ve.length;)!1===Ve[Et].apply(Te[0],Te[1])&&W.stopOnFalse&&(Et=Ve.length,Te=!1);W.memory||(Te=!1),ue=!1,He&&(Ve=Te?[]:"")},Xt={add:function(){return Ve&&(Te&&!ue&&(Et=Ve.length-1,Qe.push(Te)),function fn(In){F.each(In,function(nn,xn){_e(xn)?(!W.unique||!Xt.has(xn))&&Ve.push(xn):xn&&xn.length&&"string"!==q(xn)&&fn(xn)})}(arguments),Te&&!ue&&At()),this},remove:function(){return F.each(arguments,function(fn,In){for(var nn;(nn=F.inArray(In,Ve,nn))>-1;)Ve.splice(nn,1),nn<=Et&&Et--}),this},has:function(fn){return fn?F.inArray(fn,Ve)>-1:Ve.length>0},empty:function(){return Ve&&(Ve=[]),this},disable:function(){return He=Qe=[],Ve=Te="",this},disabled:function(){return!Ve},lock:function(){return He=Qe=[],!Te&&!ue&&(Ve=Te=""),this},locked:function(){return!!He},fireWith:function(fn,In){return He||(In=[fn,(In=In||[]).slice?In.slice():In],Qe.push(In),ue||At()),this},fire:function(){return Xt.fireWith(this,arguments),this},fired:function(){return!!Le}};return Xt},F.extend({Deferred:function(W){var ue=[["notify","progress",F.Callbacks("memory"),F.Callbacks("memory"),2],["resolve","done",F.Callbacks("once memory"),F.Callbacks("once memory"),0,"resolved"],["reject","fail",F.Callbacks("once memory"),F.Callbacks("once memory"),1,"rejected"]],Te="pending",Le={state:function(){return Te},always:function(){return He.done(arguments).fail(arguments),this},catch:function(Ve){return Le.then(null,Ve)},pipe:function(){var Ve=arguments;return F.Deferred(function(Qe){F.each(ue,function(Et,At){var Xt=_e(Ve[At[4]])&&Ve[At[4]];He[At[1]](function(){var fn=Xt&&Xt.apply(this,arguments);fn&&_e(fn.promise)?fn.promise().progress(Qe.notify).done(Qe.resolve).fail(Qe.reject):Qe[At[0]+"With"](this,Xt?[fn]:arguments)})}),Ve=null}).promise()},then:function(Ve,Qe,Et){var At=0;function Xt(fn,In,nn,xn){return function(){var Er=this,Kr=arguments,Ar=function(){var Ko,na;if(!(fn<At)){if((Ko=nn.apply(Er,Kr))===In.promise())throw new TypeError("Thenable self-resolution");_e(na=Ko&&("object"==typeof Ko||"function"==typeof Ko)&&Ko.then)?xn?na.call(Ko,Xt(At,In,Tn,xn),Xt(At,In,Cn,xn)):(At++,na.call(Ko,Xt(At,In,Tn,xn),Xt(At,In,Cn,xn),Xt(At,In,Tn,In.notifyWith))):(nn!==Tn&&(Er=void 0,Kr=[Ko]),(xn||In.resolveWith)(Er,Kr))}},ms=xn?Ar:function(){try{Ar()}catch(Ko){F.Deferred.exceptionHook&&F.Deferred.exceptionHook(Ko,ms.stackTrace),fn+1>=At&&(nn!==Cn&&(Er=void 0,Kr=[Ko]),In.rejectWith(Er,Kr))}};fn?ms():(F.Deferred.getStackHook&&(ms.stackTrace=F.Deferred.getStackHook()),n.setTimeout(ms))}}return F.Deferred(function(fn){ue[0][3].add(Xt(0,fn,_e(Et)?Et:Tn,fn.notifyWith)),ue[1][3].add(Xt(0,fn,_e(Ve)?Ve:Tn)),ue[2][3].add(Xt(0,fn,_e(Qe)?Qe:Cn))}).promise()},promise:function(Ve){return null!=Ve?F.extend(Ve,Le):Le}},He={};return F.each(ue,function(Ve,Qe){var Et=Qe[2],At=Qe[5];Le[Qe[1]]=Et.add,At&&Et.add(function(){Te=At},ue[3-Ve][2].disable,ue[3-Ve][3].disable,ue[0][2].lock,ue[0][3].lock),Et.add(Qe[3].fire),He[Qe[0]]=function(){return He[Qe[0]+"With"](this===He?void 0:this,arguments),this},He[Qe[0]+"With"]=Et.fireWith}),Le.promise(He),W&&W.call(He,He),He},when:function(W){var ue=arguments.length,Te=ue,Le=Array(Te),He=N.call(arguments),Ve=F.Deferred(),Qe=function(Et){return function(At){Le[Et]=this,He[Et]=arguments.length>1?N.call(arguments):At,--ue||Ve.resolveWith(Le,He)}};if(ue<=1&&(mn(W,Ve.done(Qe(Te)).resolve,Ve.reject,!ue),"pending"===Ve.state()||_e(He[Te]&&He[Te].then)))return Ve.then();for(;Te--;)mn(He[Te],Qe(Te),Ve.reject);return Ve.promise()}});var Pn=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;F.Deferred.exceptionHook=function(W,ue){n.console&&n.console.warn&&W&&Pn.test(W.name)&&n.console.warn("jQuery.Deferred exception: "+W.message,W.stack,ue)},F.readyException=function(W){n.setTimeout(function(){throw W})};var $n=F.Deferred();function gn(){pe.removeEventListener("DOMContentLoaded",gn),n.removeEventListener("load",gn),F.ready()}F.fn.ready=function(W){return $n.then(W).catch(function(ue){F.readyException(ue)}),this},F.extend({isReady:!1,readyWait:1,ready:function(W){(!0===W?--F.readyWait:F.isReady)||(F.isReady=!0,!(!0!==W&&--F.readyWait>0)&&$n.resolveWith(pe,[F]))}}),F.ready.then=$n.then,"complete"===pe.readyState||"loading"!==pe.readyState&&!pe.documentElement.doScroll?n.setTimeout(F.ready):(pe.addEventListener("DOMContentLoaded",gn),n.addEventListener("load",gn));var ur=function(W,ue,Te,Le,He,Ve,Qe){var Et=0,At=W.length,Xt=null==Te;if("object"===q(Te))for(Et in He=!0,Te)ur(W,ue,Et,Te[Et],!0,Ve,Qe);else if(void 0!==Le&&(He=!0,_e(Le)||(Qe=!0),Xt&&(Qe?(ue.call(W,Le),ue=null):(Xt=ue,ue=function(fn,In,nn){return Xt.call(F(fn),nn)})),ue))for(;Et<At;Et++)ue(W[Et],Te,Qe?Le:Le.call(W[Et],Et,ue(W[Et],Te)));return He?W:Xt?ue.call(W):At?ue(W[0],Te):Ve},or=/^-ms-/,hr=/-([a-z])/g;function sr(W,ue){return ue.toUpperCase()}function ei(W){return W.replace(or,"ms-").replace(hr,sr)}var Jr=function(W){return 1===W.nodeType||9===W.nodeType||!+W.nodeType};function ci(){this.expando=F.expando+ci.uid++}ci.uid=1,ci.prototype={cache:function(W){var ue=W[this.expando];return ue||(ue={},Jr(W)&&(W.nodeType?W[this.expando]=ue:Object.defineProperty(W,this.expando,{value:ue,configurable:!0}))),ue},set:function(W,ue,Te){var Le,He=this.cache(W);if("string"==typeof ue)He[ei(ue)]=Te;else for(Le in ue)He[ei(Le)]=ue[Le];return He},get:function(W,ue){return void 0===ue?this.cache(W):W[this.expando]&&W[this.expando][ei(ue)]},access:function(W,ue,Te){return void 0===ue||ue&&"string"==typeof ue&&void 0===Te?this.get(W,ue):(this.set(W,ue,Te),void 0!==Te?Te:ue)},remove:function(W,ue){var Te,Le=W[this.expando];if(void 0!==Le){if(void 0!==ue)for((Te=(ue=Array.isArray(ue)?ue.map(ei):(ue=ei(ue))in Le?[ue]:ue.match(rn)||[]).length);Te--;)delete Le[ue[Te]];(void 0===ue||F.isEmptyObject(Le))&&(W.nodeType?W[this.expando]=void 0:delete W[this.expando])}},hasData:function(W){var ue=W[this.expando];return void 0!==ue&&!F.isEmptyObject(ue)}};var ir=new ci,vr=new ci,pi=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,go=/[A-Z]/g;function Zr(W,ue,Te){var Le;if(void 0===Te&&1===W.nodeType)if(Le="data-"+ue.replace(go,"-$&").toLowerCase(),"string"==typeof(Te=W.getAttribute(Le))){try{Te=function Nr(W){return"true"===W||"false"!==W&&("null"===W?null:W===+W+""?+W:pi.test(W)?JSON.parse(W):W)}(Te)}catch{}vr.set(W,ue,Te)}else Te=void 0;return Te}F.extend({hasData:function(W){return vr.hasData(W)||ir.hasData(W)},data:function(W,ue,Te){return vr.access(W,ue,Te)},removeData:function(W,ue){vr.remove(W,ue)},_data:function(W,ue,Te){return ir.access(W,ue,Te)},_removeData:function(W,ue){ir.remove(W,ue)}}),F.fn.extend({data:function(W,ue){var Te,Le,He,Ve=this[0],Qe=Ve&&Ve.attributes;if(void 0===W){if(this.length&&(He=vr.get(Ve),1===Ve.nodeType&&!ir.get(Ve,"hasDataAttrs"))){for(Te=Qe.length;Te--;)Qe[Te]&&0===(Le=Qe[Te].name).indexOf("data-")&&(Le=ei(Le.slice(5)),Zr(Ve,Le,He[Le]));ir.set(Ve,"hasDataAttrs",!0)}return He}return"object"==typeof W?this.each(function(){vr.set(this,W)}):ur(this,function(Et){var At;if(Ve&&void 0===Et)return void 0!==(At=vr.get(Ve,W))||void 0!==(At=Zr(Ve,W))?At:void 0;this.each(function(){vr.set(this,W,Et)})},null,ue,arguments.length>1,null,!0)},removeData:function(W){return this.each(function(){vr.remove(this,W)})}}),F.extend({queue:function(W,ue,Te){var Le;if(W)return Le=ir.get(W,ue=(ue||"fx")+"queue"),Te&&(!Le||Array.isArray(Te)?Le=ir.access(W,ue,F.makeArray(Te)):Le.push(Te)),Le||[]},dequeue:function(W,ue){var Te=F.queue(W,ue=ue||"fx"),Le=Te.length,He=Te.shift(),Ve=F._queueHooks(W,ue);"inprogress"===He&&(He=Te.shift(),Le--),He&&("fx"===ue&&Te.unshift("inprogress"),delete Ve.stop,He.call(W,function(){F.dequeue(W,ue)},Ve)),!Le&&Ve&&Ve.empty.fire()},_queueHooks:function(W,ue){var Te=ue+"queueHooks";return ir.get(W,Te)||ir.access(W,Te,{empty:F.Callbacks("once memory").add(function(){ir.remove(W,[ue+"queue",Te])})})}}),F.fn.extend({queue:function(W,ue){var Te=2;return"string"!=typeof W&&(ue=W,W="fx",Te--),arguments.length<Te?F.queue(this[0],W):void 0===ue?this:this.each(function(){var Le=F.queue(this,W,ue);F._queueHooks(this,W),"fx"===W&&"inprogress"!==Le[0]&&F.dequeue(this,W)})},dequeue:function(W){return this.each(function(){F.dequeue(this,W)})},clearQueue:function(W){return this.queue(W||"fx",[])},promise:function(W,ue){var Te,Le=1,He=F.Deferred(),Ve=this,Qe=this.length,Et=function(){--Le||He.resolveWith(Ve,[Ve])};for("string"!=typeof W&&(ue=W,W=void 0),W=W||"fx";Qe--;)(Te=ir.get(Ve[Qe],W+"queueHooks"))&&Te.empty&&(Le++,Te.empty.add(Et));return Et(),He.promise(ue)}});var Vr=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,fi=new RegExp("^(?:([+-])=|)("+Vr+")([a-z%]*)$","i"),bi=["Top","Right","Bottom","Left"],So=pe.documentElement,Gs=function(W){return F.contains(W.ownerDocument,W)},Ks={composed:!0};So.getRootNode&&(Gs=function(W){return F.contains(W.ownerDocument,W)||W.getRootNode(Ks)===W.ownerDocument});var Di=function(W,ue){return"none"===(W=ue||W).style.display||""===W.style.display&&Gs(W)&&"none"===F.css(W,"display")};function Eo(W,ue,Te,Le){var He,Ve,Qe=20,Et=Le?function(){return Le.cur()}:function(){return F.css(W,ue,"")},At=Et(),Xt=Te&&Te[3]||(F.cssNumber[ue]?"":"px"),fn=W.nodeType&&(F.cssNumber[ue]||"px"!==Xt&&+At)&&fi.exec(F.css(W,ue));if(fn&&fn[3]!==Xt){for(Xt=Xt||fn[3],fn=+(At/=2)||1;Qe--;)F.style(W,ue,fn+Xt),(1-Ve)*(1-(Ve=Et()/At||.5))<=0&&(Qe=0),fn/=Ve;F.style(W,ue,(fn*=2)+Xt),Te=Te||[]}return Te&&(fn=+fn||+At||0,He=Te[1]?fn+(Te[1]+1)*Te[2]:+Te[2],Le&&(Le.unit=Xt,Le.start=fn,Le.end=He)),He}var vo={};function Xr(W){var ue,Te=W.ownerDocument,Le=W.nodeName,He=vo[Le];return He||(ue=Te.body.appendChild(Te.createElement(Le)),He=F.css(ue,"display"),ue.parentNode.removeChild(ue),"none"===He&&(He="block"),vo[Le]=He,He)}function ss(W,ue){for(var Te,Le,He=[],Ve=0,Qe=W.length;Ve<Qe;Ve++)(Le=W[Ve]).style&&(Te=Le.style.display,ue?("none"===Te&&(He[Ve]=ir.get(Le,"display")||null,He[Ve]||(Le.style.display="")),""===Le.style.display&&Di(Le)&&(He[Ve]=Xr(Le))):"none"!==Te&&(He[Ve]="none",ir.set(Le,"display",Te)));for(Ve=0;Ve<Qe;Ve++)null!=He[Ve]&&(W[Ve].style.display=He[Ve]);return W}F.fn.extend({show:function(){return ss(this,!0)},hide:function(){return ss(this)},toggle:function(W){return"boolean"==typeof W?W?this.show():this.hide():this.each(function(){Di(this)?F(this).show():F(this).hide()})}});var ue,Te,Or=/^(?:checkbox|radio)$/i,Na=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,Fu=/^$|^module$|\/(?:java|ecma)script/i;ue=pe.createDocumentFragment().appendChild(pe.createElement("div")),(Te=pe.createElement("input")).setAttribute("type","radio"),Te.setAttribute("checked","checked"),Te.setAttribute("name","t"),ue.appendChild(Te),fe.checkClone=ue.cloneNode(!0).cloneNode(!0).lastChild.checked,ue.innerHTML="<textarea>x</textarea>",fe.noCloneChecked=!!ue.cloneNode(!0).lastChild.defaultValue,ue.innerHTML="<option></option>",fe.option=!!ue.lastChild;var ps={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function Hs(W,ue){var Te;return Te=typeof W.getElementsByTagName<"u"?W.getElementsByTagName(ue||"*"):typeof W.querySelectorAll<"u"?W.querySelectorAll(ue||"*"):[],void 0===ue||ue&&Ee(W,ue)?F.merge([W],Te):Te}function ii(W,ue){for(var Te=0,Le=W.length;Te<Le;Te++)ir.set(W[Te],"globalEval",!ue||ir.get(ue[Te],"globalEval"))}ps.tbody=ps.tfoot=ps.colgroup=ps.caption=ps.thead,ps.th=ps.td,fe.option||(ps.optgroup=ps.option=[1,"<select multiple='multiple'>","</select>"]);var Pc=/<|&#?\w+;/;function Uh(W,ue,Te,Le,He){for(var Ve,Qe,Et,At,Xt,fn,In=ue.createDocumentFragment(),nn=[],xn=0,Er=W.length;xn<Er;xn++)if((Ve=W[xn])||0===Ve)if("object"===q(Ve))F.merge(nn,Ve.nodeType?[Ve]:Ve);else if(Pc.test(Ve)){for(Qe=Qe||In.appendChild(ue.createElement("div")),Et=(Na.exec(Ve)||["",""])[1].toLowerCase(),Qe.innerHTML=(At=ps[Et]||ps._default)[1]+F.htmlPrefilter(Ve)+At[2],fn=At[0];fn--;)Qe=Qe.lastChild;F.merge(nn,Qe.childNodes),(Qe=In.firstChild).textContent=""}else nn.push(ue.createTextNode(Ve));for(In.textContent="",xn=0;Ve=nn[xn++];)if(Le&&F.inArray(Ve,Le)>-1)He&&He.push(Ve);else if(Xt=Gs(Ve),Qe=Hs(In.appendChild(Ve),"script"),Xt&&ii(Qe),Te)for(fn=0;Ve=Qe[fn++];)Fu.test(Ve.type||"")&&Te.push(Ve);return In}var Ya=/^key/,Jp=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,ea=/^([^.]*)(?:\.(.+)|)/;function kl(){return!0}function Ra(){return!1}function Ic(W,ue){return W===function Zp(){try{return pe.activeElement}catch{}}()==("focus"===ue)}function Vs(W,ue,Te,Le,He,Ve){var Qe,Et;if("object"==typeof ue){for(Et in"string"!=typeof Te&&(Le=Le||Te,Te=void 0),ue)Vs(W,Et,Te,Le,ue[Et],Ve);return W}if(null==Le&&null==He?(He=Te,Le=Te=void 0):null==He&&("string"==typeof Te?(He=Le,Le=void 0):(He=Le,Le=Te,Te=void 0)),!1===He)He=Ra;else if(!He)return W;return 1===Ve&&(Qe=He,He=function(At){return F().off(At),Qe.apply(this,arguments)},He.guid=Qe.guid||(Qe.guid=F.guid++)),W.each(function(){F.event.add(this,ue,He,Le,Te)})}function Vo(W,ue,Te){Te?(ir.set(W,ue,!1),F.event.add(W,ue,{namespace:!1,handler:function(Le){var He,Ve,Qe=ir.get(this,ue);if(1&Le.isTrigger&&this[ue]){if(Qe.length)(F.event.special[ue]||{}).delegateType&&Le.stopPropagation();else if(Qe=N.call(arguments),ir.set(this,ue,Qe),He=Te(this,ue),this[ue](),Qe!==(Ve=ir.get(this,ue))||He?ir.set(this,ue,!1):Ve={},Qe!==Ve)return Le.stopImmediatePropagation(),Le.preventDefault(),Ve.value}else Qe.length&&(ir.set(this,ue,{value:F.event.trigger(F.extend(Qe[0],F.Event.prototype),Qe.slice(1),this)}),Le.stopImmediatePropagation())}})):void 0===ir.get(W,ue)&&F.event.add(W,ue,kl)}F.event={global:{},add:function(W,ue,Te,Le,He){var Ve,Qe,Et,At,Xt,fn,In,nn,xn,Er,Kr,Ar=ir.get(W);if(Jr(W))for(Te.handler&&(Te=(Ve=Te).handler,He=Ve.selector),He&&F.find.matchesSelector(So,He),Te.guid||(Te.guid=F.guid++),(At=Ar.events)||(At=Ar.events=Object.create(null)),(Qe=Ar.handle)||(Qe=Ar.handle=function(ms){return typeof F<"u"&&F.event.triggered!==ms.type?F.event.dispatch.apply(W,arguments):void 0}),Xt=(ue=(ue||"").match(rn)||[""]).length;Xt--;)xn=Kr=(Et=ea.exec(ue[Xt])||[])[1],Er=(Et[2]||"").split(".").sort(),xn&&(In=F.event.special[xn]||{},In=F.event.special[xn=(He?In.delegateType:In.bindType)||xn]||{},fn=F.extend({type:xn,origType:Kr,data:Le,handler:Te,guid:Te.guid,selector:He,needsContext:He&&F.expr.match.needsContext.test(He),namespace:Er.join(".")},Ve),(nn=At[xn])||((nn=At[xn]=[]).delegateCount=0,(!In.setup||!1===In.setup.call(W,Le,Er,Qe))&&W.addEventListener&&W.addEventListener(xn,Qe)),In.add&&(In.add.call(W,fn),fn.handler.guid||(fn.handler.guid=Te.guid)),He?nn.splice(nn.delegateCount++,0,fn):nn.push(fn),F.event.global[xn]=!0)},remove:function(W,ue,Te,Le,He){var Ve,Qe,Et,At,Xt,fn,In,nn,xn,Er,Kr,Ar=ir.hasData(W)&&ir.get(W);if(Ar&&(At=Ar.events)){for(Xt=(ue=(ue||"").match(rn)||[""]).length;Xt--;)if(xn=Kr=(Et=ea.exec(ue[Xt])||[])[1],Er=(Et[2]||"").split(".").sort(),xn){for(In=F.event.special[xn]||{},nn=At[xn=(Le?In.delegateType:In.bindType)||xn]||[],Et=Et[2]&&new RegExp("(^|\\.)"+Er.join("\\.(?:.*\\.|)")+"(\\.|$)"),Qe=Ve=nn.length;Ve--;)fn=nn[Ve],(He||Kr===fn.origType)&&(!Te||Te.guid===fn.guid)&&(!Et||Et.test(fn.namespace))&&(!Le||Le===fn.selector||"**"===Le&&fn.selector)&&(nn.splice(Ve,1),fn.selector&&nn.delegateCount--,In.remove&&In.remove.call(W,fn));Qe&&!nn.length&&((!In.teardown||!1===In.teardown.call(W,Er,Ar.handle))&&F.removeEvent(W,xn,Ar.handle),delete At[xn])}else for(xn in At)F.event.remove(W,xn+ue[Xt],Te,Le,!0);F.isEmptyObject(At)&&ir.remove(W,"handle events")}},dispatch:function(W){var ue,Te,Le,He,Ve,Qe,Et=new Array(arguments.length),At=F.event.fix(W),Xt=(ir.get(this,"events")||Object.create(null))[At.type]||[],fn=F.event.special[At.type]||{};for(Et[0]=At,ue=1;ue<arguments.length;ue++)Et[ue]=arguments[ue];if(At.delegateTarget=this,!fn.preDispatch||!1!==fn.preDispatch.call(this,At)){for(Qe=F.event.handlers.call(this,At,Xt),ue=0;(He=Qe[ue++])&&!At.isPropagationStopped();)for(At.currentTarget=He.elem,Te=0;(Ve=He.handlers[Te++])&&!At.isImmediatePropagationStopped();)(!At.rnamespace||!1===Ve.namespace||At.rnamespace.test(Ve.namespace))&&(At.handleObj=Ve,At.data=Ve.data,void 0!==(Le=((F.event.special[Ve.origType]||{}).handle||Ve.handler).apply(He.elem,Et))&&!1===(At.result=Le)&&(At.preventDefault(),At.stopPropagation()));return fn.postDispatch&&fn.postDispatch.call(this,At),At.result}},handlers:function(W,ue){var Te,Le,He,Ve,Qe,Et=[],At=ue.delegateCount,Xt=W.target;if(At&&Xt.nodeType&&!("click"===W.type&&W.button>=1))for(;Xt!==this;Xt=Xt.parentNode||this)if(1===Xt.nodeType&&("click"!==W.type||!0!==Xt.disabled)){for(Ve=[],Qe={},Te=0;Te<At;Te++)void 0===Qe[He=(Le=ue[Te]).selector+" "]&&(Qe[He]=Le.needsContext?F(He,this).index(Xt)>-1:F.find(He,this,null,[Xt]).length),Qe[He]&&Ve.push(Le);Ve.length&&Et.push({elem:Xt,handlers:Ve})}return Xt=this,At<ue.length&&Et.push({elem:Xt,handlers:ue.slice(At)}),Et},addProp:function(W,ue){Object.defineProperty(F.Event.prototype,W,{enumerable:!0,configurable:!0,get:_e(ue)?function(){if(this.originalEvent)return ue(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[W]},set:function(Te){Object.defineProperty(this,W,{enumerable:!0,configurable:!0,writable:!0,value:Te})}})},fix:function(W){return W[F.expando]?W:new F.Event(W)},special:{load:{noBubble:!0},click:{setup:function(W){var ue=this||W;return Or.test(ue.type)&&ue.click&&Ee(ue,"input")&&Vo(ue,"click",kl),!1},trigger:function(W){var ue=this||W;return Or.test(ue.type)&&ue.click&&Ee(ue,"input")&&Vo(ue,"click"),!0},_default:function(W){var ue=W.target;return Or.test(ue.type)&&ue.click&&Ee(ue,"input")&&ir.get(ue,"click")||Ee(ue,"a")}},beforeunload:{postDispatch:function(W){void 0!==W.result&&W.originalEvent&&(W.originalEvent.returnValue=W.result)}}}},F.removeEvent=function(W,ue,Te){W.removeEventListener&&W.removeEventListener(ue,Te)},F.Event=function(W,ue){if(!(this instanceof F.Event))return new F.Event(W,ue);W&&W.type?(this.originalEvent=W,this.type=W.type,this.isDefaultPrevented=W.defaultPrevented||void 0===W.defaultPrevented&&!1===W.returnValue?kl:Ra,this.target=W.target&&3===W.target.nodeType?W.target.parentNode:W.target,this.currentTarget=W.currentTarget,this.relatedTarget=W.relatedTarget):this.type=W,ue&&F.extend(this,ue),this.timeStamp=W&&W.timeStamp||Date.now(),this[F.expando]=!0},F.Event.prototype={constructor:F.Event,isDefaultPrevented:Ra,isPropagationStopped:Ra,isImmediatePropagationStopped:Ra,isSimulated:!1,preventDefault:function(){var W=this.originalEvent;this.isDefaultPrevented=kl,W&&!this.isSimulated&&W.preventDefault()},stopPropagation:function(){var W=this.originalEvent;this.isPropagationStopped=kl,W&&!this.isSimulated&&W.stopPropagation()},stopImmediatePropagation:function(){var W=this.originalEvent;this.isImmediatePropagationStopped=kl,W&&!this.isSimulated&&W.stopImmediatePropagation(),this.stopPropagation()}},F.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(W){var ue=W.button;return null==W.which&&Ya.test(W.type)?null!=W.charCode?W.charCode:W.keyCode:!W.which&&void 0!==ue&&Jp.test(W.type)?1&ue?1:2&ue?3:4&ue?2:0:W.which}},F.event.addProp),F.each({focus:"focusin",blur:"focusout"},function(W,ue){F.event.special[W]={setup:function(){return Vo(this,W,Ic),!1},trigger:function(){return Vo(this,W),!0},delegateType:ue}}),F.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(W,ue){F.event.special[W]={delegateType:ue,bindType:ue,handle:function(Te){var Le,Ve=Te.relatedTarget,Qe=Te.handleObj;return(!Ve||Ve!==this&&!F.contains(this,Ve))&&(Te.type=Qe.origType,Le=Qe.handler.apply(this,arguments),Te.type=ue),Le}}}),F.fn.extend({on:function(W,ue,Te,Le){return Vs(this,W,ue,Te,Le)},one:function(W,ue,Te,Le){return Vs(this,W,ue,Te,Le,1)},off:function(W,ue,Te){var Le,He;if(W&&W.preventDefault&&W.handleObj)return Le=W.handleObj,F(W.delegateTarget).off(Le.namespace?Le.origType+"."+Le.namespace:Le.origType,Le.selector,Le.handler),this;if("object"==typeof W){for(He in W)this.off(He,ue,W[He]);return this}return(!1===ue||"function"==typeof ue)&&(Te=ue,ue=void 0),!1===Te&&(Te=Ra),this.each(function(){F.event.remove(this,W,Te,ue)})}});var ds=/<script|<style|<link/i,Du=/checked\s*(?:[^=]|=\s*.checked.)/i,pu=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function du(W,ue){return Ee(W,"table")&&Ee(11!==ue.nodeType?ue:ue.firstChild,"tr")&&F(W).children("tbody")[0]||W}function Es(W){return W.type=(null!==W.getAttribute("type"))+"/"+W.type,W}function dp(W){return"true/"===(W.type||"").slice(0,5)?W.type=W.type.slice(5):W.removeAttribute("type"),W}function Rs(W,ue){var Te,Le,He,Qe,Et,At;if(1===ue.nodeType){if(ir.hasData(W)&&(At=ir.get(W).events))for(He in ir.remove(ue,"handle events"),At)for(Te=0,Le=At[He].length;Te<Le;Te++)F.event.add(ue,He,At[He][Te]);vr.hasData(W)&&(Qe=vr.access(W),Et=F.extend({},Qe),vr.set(ue,Et))}}function lo(W,ue){var Te=ue.nodeName.toLowerCase();"input"===Te&&Or.test(W.type)?ue.checked=W.checked:("input"===Te||"textarea"===Te)&&(ue.defaultValue=W.defaultValue)}function Oc(W,ue,Te,Le){ue=U(ue);var He,Ve,Qe,Et,At,Xt,fn=0,In=W.length,nn=In-1,xn=ue[0],Er=_e(xn);if(Er||In>1&&"string"==typeof xn&&!fe.checkClone&&Du.test(xn))return W.each(function(Kr){var Ar=W.eq(Kr);Er&&(ue[0]=xn.call(this,Kr,Ar.html())),Oc(Ar,ue,Te,Le)});if(In&&(Ve=(He=Uh(ue,W[0].ownerDocument,!1,W,Le)).firstChild,1===He.childNodes.length&&(He=Ve),Ve||Le)){for(Et=(Qe=F.map(Hs(He,"script"),Es)).length;fn<In;fn++)At=He,fn!==nn&&(At=F.clone(At,!0,!0),Et&&F.merge(Qe,Hs(At,"script"))),Te.call(W[fn],At,fn);if(Et)for(Xt=Qe[Qe.length-1].ownerDocument,F.map(Qe,dp),fn=0;fn<Et;fn++)Fu.test((At=Qe[fn]).type||"")&&!ir.access(At,"globalEval")&&F.contains(Xt,At)&&(At.src&&"module"!==(At.type||"").toLowerCase()?F._evalUrl&&!At.noModule&&F._evalUrl(At.src,{nonce:At.nonce||At.getAttribute("nonce")},Xt):B(At.textContent.replace(pu,""),At,Xt))}return W}function Uu(W,ue,Te){for(var Le,He=ue?F.filter(ue,W):W,Ve=0;null!=(Le=He[Ve]);Ve++)!Te&&1===Le.nodeType&&F.cleanData(Hs(Le)),Le.parentNode&&(Te&&Gs(Le)&&ii(Hs(Le,"script")),Le.parentNode.removeChild(Le));return W}F.extend({htmlPrefilter:function(W){return W},clone:function(W,ue,Te){var Le,He,Ve,Qe,Et=W.cloneNode(!0),At=Gs(W);if(!(fe.noCloneChecked||1!==W.nodeType&&11!==W.nodeType||F.isXMLDoc(W)))for(Qe=Hs(Et),Le=0,He=(Ve=Hs(W)).length;Le<He;Le++)lo(Ve[Le],Qe[Le]);if(ue)if(Te)for(Ve=Ve||Hs(W),Qe=Qe||Hs(Et),Le=0,He=Ve.length;Le<He;Le++)Rs(Ve[Le],Qe[Le]);else Rs(W,Et);return(Qe=Hs(Et,"script")).length>0&&ii(Qe,!At&&Hs(W,"script")),Et},cleanData:function(W){for(var ue,Te,Le,He=F.event.special,Ve=0;void 0!==(Te=W[Ve]);Ve++)if(Jr(Te)){if(ue=Te[ir.expando]){if(ue.events)for(Le in ue.events)He[Le]?F.event.remove(Te,Le):F.removeEvent(Te,Le,ue.handle);Te[ir.expando]=void 0}Te[vr.expando]&&(Te[vr.expando]=void 0)}}}),F.fn.extend({detach:function(W){return Uu(this,W,!0)},remove:function(W){return Uu(this,W)},text:function(W){return ur(this,function(ue){return void 0===ue?F.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=ue)})},null,W,arguments.length)},append:function(){return Oc(this,arguments,function(W){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||du(this,W).appendChild(W)})},prepend:function(){return Oc(this,arguments,function(W){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var ue=du(this,W);ue.insertBefore(W,ue.firstChild)}})},before:function(){return Oc(this,arguments,function(W){this.parentNode&&this.parentNode.insertBefore(W,this)})},after:function(){return Oc(this,arguments,function(W){this.parentNode&&this.parentNode.insertBefore(W,this.nextSibling)})},empty:function(){for(var W,ue=0;null!=(W=this[ue]);ue++)1===W.nodeType&&(F.cleanData(Hs(W,!1)),W.textContent="");return this},clone:function(W,ue){return W=W??!1,ue=ue??W,this.map(function(){return F.clone(this,W,ue)})},html:function(W){return ur(this,function(ue){var Te=this[0]||{},Le=0,He=this.length;if(void 0===ue&&1===Te.nodeType)return Te.innerHTML;if("string"==typeof ue&&!ds.test(ue)&&!ps[(Na.exec(ue)||["",""])[1].toLowerCase()]){ue=F.htmlPrefilter(ue);try{for(;Le<He;Le++)1===(Te=this[Le]||{}).nodeType&&(F.cleanData(Hs(Te,!1)),Te.innerHTML=ue);Te=0}catch{}}Te&&this.empty().append(ue)},null,W,arguments.length)},replaceWith:function(){var W=[];return Oc(this,arguments,function(ue){var Te=this.parentNode;F.inArray(this,W)<0&&(F.cleanData(Hs(this)),Te&&Te.replaceChild(ue,this))},W)}}),F.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(W,ue){F.fn[W]=function(Te){for(var Le,He=[],Ve=F(Te),Qe=Ve.length-1,Et=0;Et<=Qe;Et++)Le=Et===Qe?this:this.clone(!0),F(Ve[Et])[ue](Le),G.apply(He,Le.get());return this.pushStack(He)}});var gh=new RegExp("^("+Vr+")(?!px)[a-z%]+$","i"),To=function(W){var ue=W.ownerDocument.defaultView;return(!ue||!ue.opener)&&(ue=n),ue.getComputedStyle(W)},Ws=function(W,ue,Te){var Le,He,Ve={};for(He in ue)Ve[He]=W.style[He],W.style[He]=ue[He];for(He in Le=Te.call(W),ue)W.style[He]=Ve[He];return Le},Qp=new RegExp(bi.join("|"),"i");function Ja(W,ue,Te){var Le,He,Ve,Qe,Et=W.style;return(Te=Te||To(W))&&(""===(Qe=Te.getPropertyValue(ue)||Te[ue])&&!Gs(W)&&(Qe=F.style(W,ue)),!fe.pixelBoxStyles()&&gh.test(Qe)&&Qp.test(ue)&&(Le=Et.width,He=Et.minWidth,Ve=Et.maxWidth,Et.minWidth=Et.maxWidth=Et.width=Qe,Qe=Te.width,Et.width=Le,Et.minWidth=He,Et.maxWidth=Ve)),void 0!==Qe?Qe+"":Qe}function fu(W,ue){return{get:function(){if(!W())return(this.get=ue).apply(this,arguments);delete this.get}}}!function(){function W(){if(Xt){At.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",Xt.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",So.appendChild(At).appendChild(Xt);var fn=n.getComputedStyle(Xt);Te="1%"!==fn.top,Et=12===ue(fn.marginLeft),Xt.style.right="60%",Ve=36===ue(fn.right),Le=36===ue(fn.width),Xt.style.position="absolute",He=12===ue(Xt.offsetWidth/3),So.removeChild(At),Xt=null}}function ue(fn){return Math.round(parseFloat(fn))}var Te,Le,He,Ve,Qe,Et,At=pe.createElement("div"),Xt=pe.createElement("div");Xt.style&&(Xt.style.backgroundClip="content-box",Xt.cloneNode(!0).style.backgroundClip="",fe.clearCloneStyle="content-box"===Xt.style.backgroundClip,F.extend(fe,{boxSizingReliable:function(){return W(),Le},pixelBoxStyles:function(){return W(),Ve},pixelPosition:function(){return W(),Te},reliableMarginLeft:function(){return W(),Et},scrollboxSize:function(){return W(),He},reliableTrDimensions:function(){var fn,In,nn,xn;return null==Qe&&(fn=pe.createElement("table"),In=pe.createElement("tr"),nn=pe.createElement("div"),fn.style.cssText="position:absolute;left:-11111px",In.style.height="1px",nn.style.height="9px",So.appendChild(fn).appendChild(In).appendChild(nn),xn=n.getComputedStyle(In),Qe=parseInt(xn.height)>3,So.removeChild(fn)),Qe}}))}();var fp=["Webkit","Moz","ms"],mp=pe.createElement("div").style,vh={};function ic(W){return F.cssProps[W]||vh[W]||(W in mp?W:vh[W]=function zh(W){for(var ue=W[0].toUpperCase()+W.slice(1),Te=fp.length;Te--;)if((W=fp[Te]+ue)in mp)return W}(W)||W)}var jh=/^(none|table(?!-c[ea]).+)/,yh=/^--/,Gh={position:"absolute",visibility:"hidden",display:"block"},vl={letterSpacing:"0",fontWeight:"400"};function yl(W,ue,Te){var Le=fi.exec(ue);return Le?Math.max(0,Le[2]-(Te||0))+(Le[3]||"px"):ue}function Fl(W,ue,Te,Le,He,Ve){var Qe="width"===ue?1:0,Et=0,At=0;if(Te===(Le?"border":"content"))return 0;for(;Qe<4;Qe+=2)"margin"===Te&&(At+=F.css(W,Te+bi[Qe],!0,He)),Le?("content"===Te&&(At-=F.css(W,"padding"+bi[Qe],!0,He)),"margin"!==Te&&(At-=F.css(W,"border"+bi[Qe]+"Width",!0,He))):(At+=F.css(W,"padding"+bi[Qe],!0,He),"padding"!==Te?At+=F.css(W,"border"+bi[Qe]+"Width",!0,He):Et+=F.css(W,"border"+bi[Qe]+"Width",!0,He));return!Le&&Ve>=0&&(At+=Math.max(0,Math.ceil(W["offset"+ue[0].toUpperCase()+ue.slice(1)]-Ve-At-Et-.5))||0),At}function zu(W,ue,Te){var Le=To(W),Ve=(!fe.boxSizingReliable()||Te)&&"border-box"===F.css(W,"boxSizing",!1,Le),Qe=Ve,Et=Ja(W,ue,Le),At="offset"+ue[0].toUpperCase()+ue.slice(1);if(gh.test(Et)){if(!Te)return Et;Et="auto"}return(!fe.boxSizingReliable()&&Ve||!fe.reliableTrDimensions()&&Ee(W,"tr")||"auto"===Et||!parseFloat(Et)&&"inline"===F.css(W,"display",!1,Le))&&W.getClientRects().length&&(Ve="border-box"===F.css(W,"boxSizing",!1,Le),(Qe=At in W)&&(Et=W[At])),(Et=parseFloat(Et)||0)+Fl(W,ue,Te||(Ve?"border":"content"),Qe,Le,Et)+"px"}function fs(W,ue,Te,Le,He){return new fs.prototype.init(W,ue,Te,Le,He)}F.extend({cssHooks:{opacity:{get:function(W,ue){if(ue){var Te=Ja(W,"opacity");return""===Te?"1":Te}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(W,ue,Te,Le){if(W&&3!==W.nodeType&&8!==W.nodeType&&W.style){var He,Ve,Qe,Et=ei(ue),At=yh.test(ue),Xt=W.style;if(At||(ue=ic(Et)),Qe=F.cssHooks[ue]||F.cssHooks[Et],void 0===Te)return Qe&&"get"in Qe&&void 0!==(He=Qe.get(W,!1,Le))?He:Xt[ue];if("string"==(Ve=typeof Te)&&(He=fi.exec(Te))&&He[1]&&(Te=Eo(W,ue,He),Ve="number"),null==Te||Te!=Te)return;"number"===Ve&&!At&&(Te+=He&&He[3]||(F.cssNumber[Et]?"":"px")),!fe.clearCloneStyle&&""===Te&&0===ue.indexOf("background")&&(Xt[ue]="inherit"),(!Qe||!("set"in Qe)||void 0!==(Te=Qe.set(W,Te,Le)))&&(At?Xt.setProperty(ue,Te):Xt[ue]=Te)}},css:function(W,ue,Te,Le){var He,Ve,Qe,Et=ei(ue);return yh.test(ue)||(ue=ic(Et)),(Qe=F.cssHooks[ue]||F.cssHooks[Et])&&"get"in Qe&&(He=Qe.get(W,!0,Te)),void 0===He&&(He=Ja(W,ue,Le)),"normal"===He&&ue in vl&&(He=vl[ue]),""===Te||Te?(Ve=parseFloat(He),!0===Te||isFinite(Ve)?Ve||0:He):He}}),F.each(["height","width"],function(W,ue){F.cssHooks[ue]={get:function(Te,Le,He){if(Le)return!jh.test(F.css(Te,"display"))||Te.getClientRects().length&&Te.getBoundingClientRect().width?zu(Te,ue,He):Ws(Te,Gh,function(){return zu(Te,ue,He)})},set:function(Te,Le,He){var Ve,Qe=To(Te),Et=!fe.scrollboxSize()&&"absolute"===Qe.position,Xt=(Et||He)&&"border-box"===F.css(Te,"boxSizing",!1,Qe),fn=He?Fl(Te,ue,He,Xt,Qe):0;return Xt&&Et&&(fn-=Math.ceil(Te["offset"+ue[0].toUpperCase()+ue.slice(1)]-parseFloat(Qe[ue])-Fl(Te,ue,"border",!1,Qe)-.5)),fn&&(Ve=fi.exec(Le))&&"px"!==(Ve[3]||"px")&&(Te.style[ue]=Le,Le=F.css(Te,ue)),yl(0,Le,fn)}}}),F.cssHooks.marginLeft=fu(fe.reliableMarginLeft,function(W,ue){if(ue)return(parseFloat(Ja(W,"marginLeft"))||W.getBoundingClientRect().left-Ws(W,{marginLeft:0},function(){return W.getBoundingClientRect().left}))+"px"}),F.each({margin:"",padding:"",border:"Width"},function(W,ue){F.cssHooks[W+ue]={expand:function(Te){for(var Le=0,He={},Ve="string"==typeof Te?Te.split(" "):[Te];Le<4;Le++)He[W+bi[Le]+ue]=Ve[Le]||Ve[Le-2]||Ve[0];return He}},"margin"!==W&&(F.cssHooks[W+ue].set=yl)}),F.fn.extend({css:function(W,ue){return ur(this,function(Te,Le,He){var Ve,Qe,Et={},At=0;if(Array.isArray(Le)){for(Ve=To(Te),Qe=Le.length;At<Qe;At++)Et[Le[At]]=F.css(Te,Le[At],!1,Ve);return Et}return void 0!==He?F.style(Te,Le,He):F.css(Te,Le)},W,ue,arguments.length>1)}}),F.Tween=fs,fs.prototype={constructor:fs,init:function(W,ue,Te,Le,He,Ve){this.elem=W,this.prop=Te,this.easing=He||F.easing._default,this.options=ue,this.start=this.now=this.cur(),this.end=Le,this.unit=Ve||(F.cssNumber[Te]?"":"px")},cur:function(){var W=fs.propHooks[this.prop];return W&&W.get?W.get(this):fs.propHooks._default.get(this)},run:function(W){var ue,Te=fs.propHooks[this.prop];return this.pos=ue=this.options.duration?F.easing[this.easing](W,this.options.duration*W,0,1,this.options.duration):W,this.now=(this.end-this.start)*ue+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),Te&&Te.set?Te.set(this):fs.propHooks._default.set(this),this}},fs.prototype.init.prototype=fs.prototype,fs.propHooks={_default:{get:function(W){var ue;return 1!==W.elem.nodeType||null!=W.elem[W.prop]&&null==W.elem.style[W.prop]?W.elem[W.prop]:(ue=F.css(W.elem,W.prop,""))&&"auto"!==ue?ue:0},set:function(W){F.fx.step[W.prop]?F.fx.step[W.prop](W):1!==W.elem.nodeType||!F.cssHooks[W.prop]&&null==W.elem.style[ic(W.prop)]?W.elem[W.prop]=W.now:F.style(W.elem,W.prop,W.now+W.unit)}}},fs.propHooks.scrollTop=fs.propHooks.scrollLeft={set:function(W){W.elem.nodeType&&W.elem.parentNode&&(W.elem[W.prop]=W.now)}},F.easing={linear:function(W){return W},swing:function(W){return.5-Math.cos(W*Math.PI)/2},_default:"swing"},F.fx=fs.prototype.init,F.fx.step={};var Dl,ju,_p=/^(?:toggle|show|hide)$/,gp=/queueHooks$/;function kc(){ju&&(!1===pe.hidden&&n.requestAnimationFrame?n.requestAnimationFrame(kc):n.setTimeout(kc,F.fx.interval),F.fx.tick())}function oc(){return n.setTimeout(function(){Dl=void 0}),Dl=Date.now()}function bh(W,ue){var Te,Le=0,He={height:W};for(ue=ue?1:0;Le<4;Le+=2-ue)He["margin"+(Te=bi[Le])]=He["padding"+Te]=W;return ue&&(He.opacity=He.width=W),He}function vp(W,ue,Te){for(var Le,He=(Za.tweeners[ue]||[]).concat(Za.tweeners["*"]),Ve=0,Qe=He.length;Ve<Qe;Ve++)if(Le=He[Ve].call(Te,ue,W))return Le}function Za(W,ue,Te){var Le,He,Ve=0,Qe=Za.prefilters.length,Et=F.Deferred().always(function(){delete At.elem}),At=function(){if(He)return!1;for(var In=Dl||oc(),nn=Math.max(0,Xt.startTime+Xt.duration-In),Er=1-(nn/Xt.duration||0),Kr=0,Ar=Xt.tweens.length;Kr<Ar;Kr++)Xt.tweens[Kr].run(Er);return Et.notifyWith(W,[Xt,Er,nn]),Er<1&&Ar?nn:(Ar||Et.notifyWith(W,[Xt,1,0]),Et.resolveWith(W,[Xt]),!1)},Xt=Et.promise({elem:W,props:F.extend({},ue),opts:F.extend(!0,{specialEasing:{},easing:F.easing._default},Te),originalProperties:ue,originalOptions:Te,startTime:Dl||oc(),duration:Te.duration,tweens:[],createTween:function(In,nn){var xn=F.Tween(W,Xt.opts,In,nn,Xt.opts.specialEasing[In]||Xt.opts.easing);return Xt.tweens.push(xn),xn},stop:function(In){var nn=0,xn=In?Xt.tweens.length:0;if(He)return this;for(He=!0;nn<xn;nn++)Xt.tweens[nn].run(1);return In?(Et.notifyWith(W,[Xt,1,0]),Et.resolveWith(W,[Xt,In])):Et.rejectWith(W,[Xt,In]),this}}),fn=Xt.props;for(function Hu(W,ue){var Te,Le,He,Ve,Qe;for(Te in W)if(He=ue[Le=ei(Te)],Ve=W[Te],Array.isArray(Ve)&&(He=Ve[1],Ve=W[Te]=Ve[0]),Te!==Le&&(W[Le]=Ve,delete W[Te]),(Qe=F.cssHooks[Le])&&"expand"in Qe)for(Te in Ve=Qe.expand(Ve),delete W[Le],Ve)Te in W||(W[Te]=Ve[Te],ue[Te]=He);else ue[Le]=He}(fn,Xt.opts.specialEasing);Ve<Qe;Ve++)if(Le=Za.prefilters[Ve].call(Xt,W,fn,Xt.opts))return _e(Le.stop)&&(F._queueHooks(Xt.elem,Xt.opts.queue).stop=Le.stop.bind(Le)),Le;return F.map(fn,vp,Xt),_e(Xt.opts.start)&&Xt.opts.start.call(W,Xt),Xt.progress(Xt.opts.progress).done(Xt.opts.done,Xt.opts.complete).fail(Xt.opts.fail).always(Xt.opts.always),F.fx.timer(F.extend(At,{elem:W,anim:Xt,queue:Xt.opts.queue})),Xt}F.Animation=F.extend(Za,{tweeners:{"*":[function(W,ue){var Te=this.createTween(W,ue);return Eo(Te.elem,W,fi.exec(ue),Te),Te}]},tweener:function(W,ue){_e(W)?(ue=W,W=["*"]):W=W.match(rn);for(var Te,Le=0,He=W.length;Le<He;Le++)(Za.tweeners[Te=W[Le]]=Za.tweeners[Te]||[]).unshift(ue)},prefilters:[function Gu(W,ue,Te){var Le,He,Ve,Qe,Et,At,Xt,fn,In="width"in ue||"height"in ue,nn=this,xn={},Er=W.style,Kr=W.nodeType&&Di(W),Ar=ir.get(W,"fxshow");for(Le in Te.queue||(null==(Qe=F._queueHooks(W,"fx")).unqueued&&(Qe.unqueued=0,Et=Qe.empty.fire,Qe.empty.fire=function(){Qe.unqueued||Et()}),Qe.unqueued++,nn.always(function(){nn.always(function(){Qe.unqueued--,F.queue(W,"fx").length||Qe.empty.fire()})})),ue)if(_p.test(He=ue[Le])){if(delete ue[Le],Ve=Ve||"toggle"===He,He===(Kr?"hide":"show")){if("show"!==He||!Ar||void 0===Ar[Le])continue;Kr=!0}xn[Le]=Ar&&Ar[Le]||F.style(W,Le)}if((At=!F.isEmptyObject(ue))||!F.isEmptyObject(xn))for(Le in In&&1===W.nodeType&&(Te.overflow=[Er.overflow,Er.overflowX,Er.overflowY],null==(Xt=Ar&&Ar.display)&&(Xt=ir.get(W,"display")),"none"===(fn=F.css(W,"display"))&&(Xt?fn=Xt:(ss([W],!0),Xt=W.style.display||Xt,fn=F.css(W,"display"),ss([W]))),("inline"===fn||"inline-block"===fn&&null!=Xt)&&"none"===F.css(W,"float")&&(At||(nn.done(function(){Er.display=Xt}),null==Xt&&(Xt="none"===(fn=Er.display)?"":fn)),Er.display="inline-block")),Te.overflow&&(Er.overflow="hidden",nn.always(function(){Er.overflow=Te.overflow[0],Er.overflowX=Te.overflow[1],Er.overflowY=Te.overflow[2]})),At=!1,xn)At||(Ar?"hidden"in Ar&&(Kr=Ar.hidden):Ar=ir.access(W,"fxshow",{display:Xt}),Ve&&(Ar.hidden=!Kr),Kr&&ss([W],!0),nn.done(function(){for(Le in Kr||ss([W]),ir.remove(W,"fxshow"),xn)F.style(W,Le,xn[Le])})),At=vp(Kr?Ar[Le]:0,Le,nn),Le in Ar||(Ar[Le]=At.start,Kr&&(At.end=At.start,At.start=0))}],prefilter:function(W,ue){ue?Za.prefilters.unshift(W):Za.prefilters.push(W)}}),F.speed=function(W,ue,Te){var Le=W&&"object"==typeof W?F.extend({},W):{complete:Te||!Te&&ue||_e(W)&&W,duration:W,easing:Te&&ue||ue&&!_e(ue)&&ue};return F.fx.off?Le.duration=0:"number"!=typeof Le.duration&&(Le.duration=Le.duration in F.fx.speeds?F.fx.speeds[Le.duration]:F.fx.speeds._default),(null==Le.queue||!0===Le.queue)&&(Le.queue="fx"),Le.old=Le.complete,Le.complete=function(){_e(Le.old)&&Le.old.call(this),Le.queue&&F.dequeue(this,Le.queue)},Le},F.fn.extend({fadeTo:function(W,ue,Te,Le){return this.filter(Di).css("opacity",0).show().end().animate({opacity:ue},W,Te,Le)},animate:function(W,ue,Te,Le){var He=F.isEmptyObject(W),Ve=F.speed(ue,Te,Le),Qe=function(){var Et=Za(this,F.extend({},W),Ve);(He||ir.get(this,"finish"))&&Et.stop(!0)};return Qe.finish=Qe,He||!1===Ve.queue?this.each(Qe):this.queue(Ve.queue,Qe)},stop:function(W,ue,Te){var Le=function(He){var Ve=He.stop;delete He.stop,Ve(Te)};return"string"!=typeof W&&(Te=ue,ue=W,W=void 0),ue&&this.queue(W||"fx",[]),this.each(function(){var He=!0,Ve=null!=W&&W+"queueHooks",Qe=F.timers,Et=ir.get(this);if(Ve)Et[Ve]&&Et[Ve].stop&&Le(Et[Ve]);else for(Ve in Et)Et[Ve]&&Et[Ve].stop&&gp.test(Ve)&&Le(Et[Ve]);for(Ve=Qe.length;Ve--;)Qe[Ve].elem===this&&(null==W||Qe[Ve].queue===W)&&(Qe[Ve].anim.stop(Te),He=!1,Qe.splice(Ve,1));(He||!Te)&&F.dequeue(this,W)})},finish:function(W){return!1!==W&&(W=W||"fx"),this.each(function(){var ue,Te=ir.get(this),Le=Te[W+"queue"],He=Te[W+"queueHooks"],Ve=F.timers,Qe=Le?Le.length:0;for(Te.finish=!0,F.queue(this,W,[]),He&&He.stop&&He.stop.call(this,!0),ue=Ve.length;ue--;)Ve[ue].elem===this&&Ve[ue].queue===W&&(Ve[ue].anim.stop(!0),Ve.splice(ue,1));for(ue=0;ue<Qe;ue++)Le[ue]&&Le[ue].finish&&Le[ue].finish.call(this);delete Te.finish})}}),F.each(["toggle","show","hide"],function(W,ue){var Te=F.fn[ue];F.fn[ue]=function(Le,He,Ve){return null==Le||"boolean"==typeof Le?Te.apply(this,arguments):this.animate(bh(ue,!0),Le,He,Ve)}}),F.each({slideDown:bh("show"),slideUp:bh("hide"),slideToggle:bh("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(W,ue){F.fn[W]=function(Te,Le,He){return this.animate(ue,Te,Le,He)}}),F.timers=[],F.fx.tick=function(){var W,ue=0,Te=F.timers;for(Dl=Date.now();ue<Te.length;ue++)!(W=Te[ue])()&&Te[ue]===W&&Te.splice(ue--,1);Te.length||F.fx.stop(),Dl=void 0},F.fx.timer=function(W){F.timers.push(W),F.fx.start()},F.fx.interval=13,F.fx.start=function(){ju||(ju=!0,kc())},F.fx.stop=function(){ju=null},F.fx.speeds={slow:600,fast:200,_default:400},F.fn.delay=function(W,ue){return W=F.fx&&F.fx.speeds[W]||W,this.queue(ue=ue||"fx",function(Te,Le){var He=n.setTimeout(Te,W);Le.stop=function(){n.clearTimeout(He)}})},function(){var W=pe.createElement("input"),Te=pe.createElement("select").appendChild(pe.createElement("option"));W.type="checkbox",fe.checkOn=""!==W.value,fe.optSelected=Te.selected,(W=pe.createElement("input")).value="t",W.type="radio",fe.radioValue="t"===W.value}();var Hh,Qa=F.expr.attrHandle;F.fn.extend({attr:function(W,ue){return ur(this,F.attr,W,ue,arguments.length>1)},removeAttr:function(W){return this.each(function(){F.removeAttr(this,W)})}}),F.extend({attr:function(W,ue,Te){var Le,He,Ve=W.nodeType;if(3!==Ve&&8!==Ve&&2!==Ve)return typeof W.getAttribute>"u"?F.prop(W,ue,Te):((1!==Ve||!F.isXMLDoc(W))&&(He=F.attrHooks[ue.toLowerCase()]||(F.expr.match.bool.test(ue)?Hh:void 0)),void 0!==Te?null===Te?void F.removeAttr(W,ue):He&&"set"in He&&void 0!==(Le=He.set(W,Te,ue))?Le:(W.setAttribute(ue,Te+""),Te):He&&"get"in He&&null!==(Le=He.get(W,ue))?Le:(Le=F.find.attr(W,ue))??void 0)},attrHooks:{type:{set:function(W,ue){if(!fe.radioValue&&"radio"===ue&&Ee(W,"input")){var Te=W.value;return W.setAttribute("type",ue),Te&&(W.value=Te),ue}}}},removeAttr:function(W,ue){var Te,Le=0,He=ue&&ue.match(rn);if(He&&1===W.nodeType)for(;Te=He[Le++];)W.removeAttribute(Te)}}),Hh={set:function(W,ue,Te){return!1===ue?F.removeAttr(W,Te):W.setAttribute(Te,Te),Te}},F.each(F.expr.match.bool.source.match(/\w+/g),function(W,ue){var Te=Qa[ue]||F.find.attr;Qa[ue]=function(Le,He,Ve){var Qe,Et,At=He.toLowerCase();return Ve||(Et=Qa[At],Qa[At]=Qe,Qe=null!=Te(Le,He,Ve)?At:null,Qa[At]=Et),Qe}});var Vh=/^(?:input|select|textarea|button)$/i,Vu=/^(?:a|area)$/i;function sc(W){return(W.match(rn)||[]).join(" ")}function ac(W){return W.getAttribute&&W.getAttribute("class")||""}function xh(W){return Array.isArray(W)?W:"string"==typeof W&&W.match(rn)||[]}F.fn.extend({prop:function(W,ue){return ur(this,F.prop,W,ue,arguments.length>1)},removeProp:function(W){return this.each(function(){delete this[F.propFix[W]||W]})}}),F.extend({prop:function(W,ue,Te){var Le,He,Ve=W.nodeType;if(3!==Ve&&8!==Ve&&2!==Ve)return(1!==Ve||!F.isXMLDoc(W))&&(He=F.propHooks[ue=F.propFix[ue]||ue]),void 0!==Te?He&&"set"in He&&void 0!==(Le=He.set(W,Te,ue))?Le:W[ue]=Te:He&&"get"in He&&null!==(Le=He.get(W,ue))?Le:W[ue]},propHooks:{tabIndex:{get:function(W){var ue=F.find.attr(W,"tabindex");return ue?parseInt(ue,10):Vh.test(W.nodeName)||Vu.test(W.nodeName)&&W.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),fe.optSelected||(F.propHooks.selected={get:function(W){return null},set:function(W){}}),F.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){F.propFix[this.toLowerCase()]=this}),F.fn.extend({addClass:function(W){var ue,Te,Le,He,Ve,Qe,Et,At=0;if(_e(W))return this.each(function(Xt){F(this).addClass(W.call(this,Xt,ac(this)))});if((ue=xh(W)).length)for(;Te=this[At++];)if(He=ac(Te),Le=1===Te.nodeType&&" "+sc(He)+" "){for(Qe=0;Ve=ue[Qe++];)Le.indexOf(" "+Ve+" ")<0&&(Le+=Ve+" ");He!==(Et=sc(Le))&&Te.setAttribute("class",Et)}return this},removeClass:function(W){var ue,Te,Le,He,Ve,Qe,Et,At=0;if(_e(W))return this.each(function(Xt){F(this).removeClass(W.call(this,Xt,ac(this)))});if(!arguments.length)return this.attr("class","");if((ue=xh(W)).length)for(;Te=this[At++];)if(He=ac(Te),Le=1===Te.nodeType&&" "+sc(He)+" "){for(Qe=0;Ve=ue[Qe++];)for(;Le.indexOf(" "+Ve+" ")>-1;)Le=Le.replace(" "+Ve+" "," ");He!==(Et=sc(Le))&&Te.setAttribute("class",Et)}return this},toggleClass:function(W,ue){var Te=typeof W,Le="string"===Te||Array.isArray(W);return"boolean"==typeof ue&&Le?ue?this.addClass(W):this.removeClass(W):_e(W)?this.each(function(He){F(this).toggleClass(W.call(this,He,ac(this),ue),ue)}):this.each(function(){var He,Ve,Qe,Et;if(Le)for(Ve=0,Qe=F(this),Et=xh(W);He=Et[Ve++];)Qe.hasClass(He)?Qe.removeClass(He):Qe.addClass(He);else(void 0===W||"boolean"===Te)&&((He=ac(this))&&ir.set(this,"__className__",He),this.setAttribute&&this.setAttribute("class",He||!1===W?"":ir.get(this,"__className__")||""))})},hasClass:function(W){var ue,Te,Le=0;for(ue=" "+W+" ";Te=this[Le++];)if(1===Te.nodeType&&(" "+sc(ac(Te))+" ").indexOf(ue)>-1)return!0;return!1}});var mu=/\r/g;F.fn.extend({val:function(W){var ue,Te,Le,He=this[0];return arguments.length?(Le=_e(W),this.each(function(Ve){var Qe;1===this.nodeType&&(null==(Qe=Le?W.call(this,Ve,F(this).val()):W)?Qe="":"number"==typeof Qe?Qe+="":Array.isArray(Qe)&&(Qe=F.map(Qe,function(Et){return null==Et?"":Et+""})),(!(ue=F.valHooks[this.type]||F.valHooks[this.nodeName.toLowerCase()])||!("set"in ue)||void 0===ue.set(this,Qe,"value"))&&(this.value=Qe))})):He?(ue=F.valHooks[He.type]||F.valHooks[He.nodeName.toLowerCase()])&&"get"in ue&&void 0!==(Te=ue.get(He,"value"))?Te:"string"==typeof(Te=He.value)?Te.replace(mu,""):Te??"":void 0}}),F.extend({valHooks:{option:{get:function(W){return F.find.attr(W,"value")??sc(F.text(W))}},select:{get:function(W){var ue,Te,Le,He=W.options,Ve=W.selectedIndex,Qe="select-one"===W.type,Et=Qe?null:[],At=Qe?Ve+1:He.length;for(Le=Ve<0?At:Qe?Ve:0;Le<At;Le++)if(((Te=He[Le]).selected||Le===Ve)&&!Te.disabled&&(!Te.parentNode.disabled||!Ee(Te.parentNode,"optgroup"))){if(ue=F(Te).val(),Qe)return ue;Et.push(ue)}return Et},set:function(W,ue){for(var Te,Le,He=W.options,Ve=F.makeArray(ue),Qe=He.length;Qe--;)((Le=He[Qe]).selected=F.inArray(F.valHooks.option.get(Le),Ve)>-1)&&(Te=!0);return Te||(W.selectedIndex=-1),Ve}}}}),F.each(["radio","checkbox"],function(){F.valHooks[this]={set:function(W,ue){if(Array.isArray(ue))return W.checked=F.inArray(F(W).val(),ue)>-1}},fe.checkOn||(F.valHooks[this].get=function(W){return null===W.getAttribute("value")?"on":W.value})}),fe.focusin="onfocusin"in n;var Fc=/^(?:focusinfocus|focusoutblur)$/,yp=function(W){W.stopPropagation()};F.extend(F.event,{trigger:function(W,ue,Te,Le){var He,Ve,Qe,Et,At,Xt,fn,In,nn=[Te||pe],xn=be.call(W,"type")?W.type:W,Er=be.call(W,"namespace")?W.namespace.split("."):[];if(Ve=In=Qe=Te=Te||pe,3!==Te.nodeType&&8!==Te.nodeType&&!Fc.test(xn+F.event.triggered)&&(xn.indexOf(".")>-1&&(Er=xn.split("."),xn=Er.shift(),Er.sort()),At=xn.indexOf(":")<0&&"on"+xn,(W=W[F.expando]?W:new F.Event(xn,"object"==typeof W&&W)).isTrigger=Le?2:3,W.namespace=Er.join("."),W.rnamespace=W.namespace?new RegExp("(^|\\.)"+Er.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,W.result=void 0,W.target||(W.target=Te),ue=null==ue?[W]:F.makeArray(ue,[W]),fn=F.event.special[xn]||{},Le||!fn.trigger||!1!==fn.trigger.apply(Te,ue))){if(!Le&&!fn.noBubble&&!le(Te)){for(Fc.test((Et=fn.delegateType||xn)+xn)||(Ve=Ve.parentNode);Ve;Ve=Ve.parentNode)nn.push(Ve),Qe=Ve;Qe===(Te.ownerDocument||pe)&&nn.push(Qe.defaultView||Qe.parentWindow||n)}for(He=0;(Ve=nn[He++])&&!W.isPropagationStopped();)In=Ve,W.type=He>1?Et:fn.bindType||xn,(Xt=(ir.get(Ve,"events")||Object.create(null))[W.type]&&ir.get(Ve,"handle"))&&Xt.apply(Ve,ue),(Xt=At&&Ve[At])&&Xt.apply&&Jr(Ve)&&(W.result=Xt.apply(Ve,ue),!1===W.result&&W.preventDefault());return W.type=xn,!Le&&!W.isDefaultPrevented()&&(!fn._default||!1===fn._default.apply(nn.pop(),ue))&&Jr(Te)&&At&&_e(Te[xn])&&!le(Te)&&((Qe=Te[At])&&(Te[At]=null),F.event.triggered=xn,W.isPropagationStopped()&&In.addEventListener(xn,yp),Te[xn](),W.isPropagationStopped()&&In.removeEventListener(xn,yp),F.event.triggered=void 0,Qe&&(Te[At]=Qe)),W.result}},simulate:function(W,ue,Te){var Le=F.extend(new F.Event,Te,{type:W,isSimulated:!0});F.event.trigger(Le,null,ue)}}),F.fn.extend({trigger:function(W,ue){return this.each(function(){F.event.trigger(W,ue,this)})},triggerHandler:function(W,ue){var Te=this[0];if(Te)return F.event.trigger(W,ue,Te,!0)}}),fe.focusin||F.each({focus:"focusin",blur:"focusout"},function(W,ue){var Te=function(Le){F.event.simulate(ue,Le.target,F.event.fix(Le))};F.event.special[ue]={setup:function(){var Le=this.ownerDocument||this.document||this,He=ir.access(Le,ue);He||Le.addEventListener(W,Te,!0),ir.access(Le,ue,(He||0)+1)},teardown:function(){var Le=this.ownerDocument||this.document||this,He=ir.access(Le,ue)-1;He?ir.access(Le,ue,He):(Le.removeEventListener(W,Te,!0),ir.remove(Le,ue))}}});var Dc=n.location,Wu={guid:Date.now()},Ul=/\?/;F.parseXML=function(W){var ue;if(!W||"string"!=typeof W)return null;try{ue=(new n.DOMParser).parseFromString(W,"text/xml")}catch{ue=void 0}return(!ue||ue.getElementsByTagName("parsererror").length)&&F.error("Invalid XML: "+W),ue};var bp=/\[\]$/,Wh=/\r?\n/g,xp=/^(?:submit|button|image|reset|file)$/i,wp=/^(?:input|select|textarea|keygen)/i;function qh(W,ue,Te,Le){var He;if(Array.isArray(ue))F.each(ue,function(Ve,Qe){Te||bp.test(W)?Le(W,Qe):qh(W+"["+("object"==typeof Qe&&null!=Qe?Ve:"")+"]",Qe,Te,Le)});else if(Te||"object"!==q(ue))Le(W,ue);else for(He in ue)qh(W+"["+He+"]",ue[He],Te,Le)}F.param=function(W,ue){var Te,Le=[],He=function(Ve,Qe){var Et=_e(Qe)?Qe():Qe;Le[Le.length]=encodeURIComponent(Ve)+"="+encodeURIComponent(Et??"")};if(null==W)return"";if(Array.isArray(W)||W.jquery&&!F.isPlainObject(W))F.each(W,function(){He(this.name,this.value)});else for(Te in W)qh(Te,W[Te],ue,He);return Le.join("&")},F.fn.extend({serialize:function(){return F.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var W=F.prop(this,"elements");return W?F.makeArray(W):this}).filter(function(){var W=this.type;return this.name&&!F(this).is(":disabled")&&wp.test(this.nodeName)&&!xp.test(W)&&(this.checked||!Or.test(W))}).map(function(W,ue){var Te=F(this).val();return null==Te?null:Array.isArray(Te)?F.map(Te,function(Le){return{name:ue.name,value:Le.replace(Wh,"\r\n")}}):{name:ue.name,value:Te.replace(Wh,"\r\n")}}).get()}});var Kp=/%20/g,_u=/#.*$/,Pa=/([?&])_=[^&]*/,lc=/^(.*?):[ \t]*([^\r\n]*)$/gm,jl=/^(?:GET|HEAD)$/,qu=/^\/\//,va={},ta={},xl="*/".concat("*"),Xu=pe.createElement("a");function Yu(W){return function(ue,Te){"string"!=typeof ue&&(Te=ue,ue="*");var Le,He=0,Ve=ue.toLowerCase().match(rn)||[];if(_e(Te))for(;Le=Ve[He++];)"+"===Le[0]?(Le=Le.slice(1)||"*",(W[Le]=W[Le]||[]).unshift(Te)):(W[Le]=W[Le]||[]).push(Te)}}function Xh(W,ue,Te,Le){var He={},Ve=W===ta;function Qe(Et){var At;return He[Et]=!0,F.each(W[Et]||[],function(Xt,fn){var In=fn(ue,Te,Le);return"string"!=typeof In||Ve||He[In]?Ve?!(At=In):void 0:(ue.dataTypes.unshift(In),Qe(In),!1)}),At}return Qe(ue.dataTypes[0])||!He["*"]&&Qe("*")}function Sp(W,ue){var Te,Le,He=F.ajaxSettings.flatOptions||{};for(Te in ue)void 0!==ue[Te]&&((He[Te]?W:Le||(Le={}))[Te]=ue[Te]);return Le&&F.extend(!0,W,Le),W}Xu.href=Dc.href,F.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Dc.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Dc.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":xl,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":F.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(W,ue){return ue?Sp(Sp(W,F.ajaxSettings),ue):Sp(F.ajaxSettings,W)},ajaxPrefilter:Yu(va),ajaxTransport:Yu(ta),ajax:function(W,ue){"object"==typeof W&&(ue=W,W=void 0);var Te,Le,He,Ve,Qe,Et,At,Xt,fn,In,nn=F.ajaxSetup({},ue=ue||{}),xn=nn.context||nn,Er=nn.context&&(xn.nodeType||xn.jquery)?F(xn):F.event,Kr=F.Deferred(),Ar=F.Callbacks("once memory"),ms=nn.statusCode||{},Ko={},na={},_i="canceled",Lr={readyState:0,getResponseHeader:function(Xi){var Yi;if(At){if(!Ve)for(Ve={};Yi=lc.exec(He);)Ve[Yi[1].toLowerCase()+" "]=(Ve[Yi[1].toLowerCase()+" "]||[]).concat(Yi[2]);Yi=Ve[Xi.toLowerCase()+" "]}return null==Yi?null:Yi.join(", ")},getAllResponseHeaders:function(){return At?He:null},setRequestHeader:function(Xi,Yi){return null==At&&(Xi=na[Xi.toLowerCase()]=na[Xi.toLowerCase()]||Xi,Ko[Xi]=Yi),this},overrideMimeType:function(Xi){return null==At&&(nn.mimeType=Xi),this},statusCode:function(Xi){var Yi;if(Xi)if(At)Lr.always(Xi[Lr.status]);else for(Yi in Xi)ms[Yi]=[ms[Yi],Xi[Yi]];return this},abort:function(Xi){var Yi=Xi||_i;return Te&&Te.abort(Yi),Ia(0,Yi),this}};if(Kr.promise(Lr),nn.url=((W||nn.url||Dc.href)+"").replace(qu,Dc.protocol+"//"),nn.type=ue.method||ue.type||nn.method||nn.type,nn.dataTypes=(nn.dataType||"*").toLowerCase().match(rn)||[""],null==nn.crossDomain){Et=pe.createElement("a");try{Et.href=nn.url,Et.href=Et.href,nn.crossDomain=Xu.protocol+"//"+Xu.host!=Et.protocol+"//"+Et.host}catch{nn.crossDomain=!0}}if(nn.data&&nn.processData&&"string"!=typeof nn.data&&(nn.data=F.param(nn.data,nn.traditional)),Xh(va,nn,ue,Lr),At)return Lr;for(fn in(Xt=F.event&&nn.global)&&0==F.active++&&F.event.trigger("ajaxStart"),nn.type=nn.type.toUpperCase(),nn.hasContent=!jl.test(nn.type),Le=nn.url.replace(_u,""),nn.hasContent?nn.data&&nn.processData&&0===(nn.contentType||"").indexOf("application/x-www-form-urlencoded")&&(nn.data=nn.data.replace(Kp,"+")):(In=nn.url.slice(Le.length),nn.data&&(nn.processData||"string"==typeof nn.data)&&(Le+=(Ul.test(Le)?"&":"?")+nn.data,delete nn.data),!1===nn.cache&&(Le=Le.replace(Pa,"$1"),In=(Ul.test(Le)?"&":"?")+"_="+Wu.guid+++In),nn.url=Le+In),nn.ifModified&&(F.lastModified[Le]&&Lr.setRequestHeader("If-Modified-Since",F.lastModified[Le]),F.etag[Le]&&Lr.setRequestHeader("If-None-Match",F.etag[Le])),(nn.data&&nn.hasContent&&!1!==nn.contentType||ue.contentType)&&Lr.setRequestHeader("Content-Type",nn.contentType),Lr.setRequestHeader("Accept",nn.dataTypes[0]&&nn.accepts[nn.dataTypes[0]]?nn.accepts[nn.dataTypes[0]]+("*"!==nn.dataTypes[0]?", "+xl+"; q=0.01":""):nn.accepts["*"]),nn.headers)Lr.setRequestHeader(fn,nn.headers[fn]);if(nn.beforeSend&&(!1===nn.beforeSend.call(xn,Lr,nn)||At))return Lr.abort();if(_i="abort",Ar.add(nn.complete),Lr.done(nn.success),Lr.fail(nn.error),Te=Xh(ta,nn,ue,Lr)){if(Lr.readyState=1,Xt&&Er.trigger("ajaxSend",[Lr,nn]),At)return Lr;nn.async&&nn.timeout>0&&(Qe=n.setTimeout(function(){Lr.abort("timeout")},nn.timeout));try{At=!1,Te.send(Ko,Ia)}catch(Xi){if(At)throw Xi;Ia(-1,Xi)}}else Ia(-1,"No Transport");function Ia(Xi,Yi,Jh,uc){var ra,el,ia,Ui,Ps,rr=Yi;At||(At=!0,Qe&&n.clearTimeout(Qe),Te=void 0,He=uc||"",Lr.readyState=Xi>0?4:0,ra=Xi>=200&&Xi<300||304===Xi,Jh&&(Ui=function Ep(W,ue,Te){for(var Le,He,Ve,Qe,Et=W.contents,At=W.dataTypes;"*"===At[0];)At.shift(),void 0===Le&&(Le=W.mimeType||ue.getResponseHeader("Content-Type"));if(Le)for(He in Et)if(Et[He]&&Et[He].test(Le)){At.unshift(He);break}if(At[0]in Te)Ve=At[0];else{for(He in Te){if(!At[0]||W.converters[He+" "+At[0]]){Ve=He;break}Qe||(Qe=He)}Ve=Ve||Qe}if(Ve)return Ve!==At[0]&&At.unshift(Ve),Te[Ve]}(nn,Lr,Jh)),!ra&&F.inArray("script",nn.dataTypes)>-1&&(nn.converters["text script"]=function(){}),Ui=function Qi(W,ue,Te,Le){var He,Ve,Qe,Et,At,Xt={},fn=W.dataTypes.slice();if(fn[1])for(Qe in W.converters)Xt[Qe.toLowerCase()]=W.converters[Qe];for(Ve=fn.shift();Ve;)if(W.responseFields[Ve]&&(Te[W.responseFields[Ve]]=ue),!At&&Le&&W.dataFilter&&(ue=W.dataFilter(ue,W.dataType)),At=Ve,Ve=fn.shift())if("*"===Ve)Ve=At;else if("*"!==At&&At!==Ve){if(!(Qe=Xt[At+" "+Ve]||Xt["* "+Ve]))for(He in Xt)if((Et=He.split(" "))[1]===Ve&&(Qe=Xt[At+" "+Et[0]]||Xt["* "+Et[0]])){!0===Qe?Qe=Xt[He]:!0!==Xt[He]&&(Ve=Et[0],fn.unshift(Et[1]));break}if(!0!==Qe)if(Qe&&W.throws)ue=Qe(ue);else try{ue=Qe(ue)}catch(In){return{state:"parsererror",error:Qe?In:"No conversion from "+At+" to "+Ve}}}return{state:"success",data:ue}}(nn,Ui,Lr,ra),ra?(nn.ifModified&&((Ps=Lr.getResponseHeader("Last-Modified"))&&(F.lastModified[Le]=Ps),(Ps=Lr.getResponseHeader("etag"))&&(F.etag[Le]=Ps)),204===Xi||"HEAD"===nn.type?rr="nocontent":304===Xi?rr="notmodified":(rr=Ui.state,el=Ui.data,ra=!(ia=Ui.error))):(ia=rr,(Xi||!rr)&&(rr="error",Xi<0&&(Xi=0))),Lr.status=Xi,Lr.statusText=(Yi||rr)+"",ra?Kr.resolveWith(xn,[el,rr,Lr]):Kr.rejectWith(xn,[Lr,rr,ia]),Lr.statusCode(ms),ms=void 0,Xt&&Er.trigger(ra?"ajaxSuccess":"ajaxError",[Lr,nn,ra?el:ia]),Ar.fireWith(xn,[Lr,rr]),Xt&&(Er.trigger("ajaxComplete",[Lr,nn]),--F.active||F.event.trigger("ajaxStop")))}return Lr},getJSON:function(W,ue,Te){return F.get(W,ue,Te,"json")},getScript:function(W,ue){return F.get(W,void 0,ue,"script")}}),F.each(["get","post"],function(W,ue){F[ue]=function(Te,Le,He,Ve){return _e(Le)&&(Ve=Ve||He,He=Le,Le=void 0),F.ajax(F.extend({url:Te,type:ue,dataType:Ve,data:Le,success:He},F.isPlainObject(Te)&&Te))}}),F.ajaxPrefilter(function(W){var ue;for(ue in W.headers)"content-type"===ue.toLowerCase()&&(W.contentType=W.headers[ue]||"")}),F._evalUrl=function(W,ue,Te){return F.ajax({url:W,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(Le){F.globalEval(Le,ue,Te)}})},F.fn.extend({wrapAll:function(W){var ue;return this[0]&&(_e(W)&&(W=W.call(this[0])),ue=F(W,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&ue.insertBefore(this[0]),ue.map(function(){for(var Te=this;Te.firstElementChild;)Te=Te.firstElementChild;return Te}).append(this)),this},wrapInner:function(W){return _e(W)?this.each(function(ue){F(this).wrapInner(W.call(this,ue))}):this.each(function(){var ue=F(this),Te=ue.contents();Te.length?Te.wrapAll(W):ue.append(W)})},wrap:function(W){var ue=_e(W);return this.each(function(Te){F(this).wrapAll(ue?W.call(this,Te):W)})},unwrap:function(W){return this.parent(W).not("body").each(function(){F(this).replaceWith(this.childNodes)}),this}}),F.expr.pseudos.hidden=function(W){return!F.expr.pseudos.visible(W)},F.expr.pseudos.visible=function(W){return!!(W.offsetWidth||W.offsetHeight||W.getClientRects().length)},F.ajaxSettings.xhr=function(){try{return new n.XMLHttpRequest}catch{}};var Ka={0:200,1223:204},Gl=F.ajaxSettings.xhr();fe.cors=!!Gl&&"withCredentials"in Gl,fe.ajax=Gl=!!Gl,F.ajaxTransport(function(W){var ue,Te;if(fe.cors||Gl&&!W.crossDomain)return{send:function(Le,He){var Ve,Qe=W.xhr();if(Qe.open(W.type,W.url,W.async,W.username,W.password),W.xhrFields)for(Ve in W.xhrFields)Qe[Ve]=W.xhrFields[Ve];for(Ve in W.mimeType&&Qe.overrideMimeType&&Qe.overrideMimeType(W.mimeType),!W.crossDomain&&!Le["X-Requested-With"]&&(Le["X-Requested-With"]="XMLHttpRequest"),Le)Qe.setRequestHeader(Ve,Le[Ve]);ue=function(Et){return function(){ue&&(ue=Te=Qe.onload=Qe.onerror=Qe.onabort=Qe.ontimeout=Qe.onreadystatechange=null,"abort"===Et?Qe.abort():"error"===Et?"number"!=typeof Qe.status?He(0,"error"):He(Qe.status,Qe.statusText):He(Ka[Qe.status]||Qe.status,Qe.statusText,"text"!==(Qe.responseType||"text")||"string"!=typeof Qe.responseText?{binary:Qe.response}:{text:Qe.responseText},Qe.getAllResponseHeaders()))}},Qe.onload=ue(),Te=Qe.onerror=Qe.ontimeout=ue("error"),void 0!==Qe.onabort?Qe.onabort=Te:Qe.onreadystatechange=function(){4===Qe.readyState&&n.setTimeout(function(){ue&&Te()})},ue=ue("abort");try{Qe.send(W.hasContent&&W.data||null)}catch(Et){if(ue)throw Et}},abort:function(){ue&&ue()}}}),F.ajaxPrefilter(function(W){W.crossDomain&&(W.contents.script=!1)}),F.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(W){return F.globalEval(W),W}}}),F.ajaxPrefilter("script",function(W){void 0===W.cache&&(W.cache=!1),W.crossDomain&&(W.type="GET")}),F.ajaxTransport("script",function(W){var ue,Te;if(W.crossDomain||W.scriptAttrs)return{send:function(Le,He){ue=F("<script>").attr(W.scriptAttrs||{}).prop({charset:W.scriptCharset,src:W.url}).on("load error",Te=function(Ve){ue.remove(),Te=null,Ve&&He("error"===Ve.type?404:200,Ve.type)}),pe.head.appendChild(ue[0])},abort:function(){Te&&Te()}}});var W,Uc=[],Yh=/(=)\?(?=&|$)|\?\?/;F.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var W=Uc.pop()||F.expando+"_"+Wu.guid++;return this[W]=!0,W}}),F.ajaxPrefilter("json jsonp",function(W,ue,Te){var Le,He,Ve,Qe=!1!==W.jsonp&&(Yh.test(W.url)?"url":"string"==typeof W.data&&0===(W.contentType||"").indexOf("application/x-www-form-urlencoded")&&Yh.test(W.data)&&"data");if(Qe||"jsonp"===W.dataTypes[0])return Le=W.jsonpCallback=_e(W.jsonpCallback)?W.jsonpCallback():W.jsonpCallback,Qe?W[Qe]=W[Qe].replace(Yh,"$1"+Le):!1!==W.jsonp&&(W.url+=(Ul.test(W.url)?"&":"?")+W.jsonp+"="+Le),W.converters["script json"]=function(){return Ve||F.error(Le+" was not called"),Ve[0]},W.dataTypes[0]="json",He=n[Le],n[Le]=function(){Ve=arguments},Te.always(function(){void 0===He?F(n).removeProp(Le):n[Le]=He,W[Le]&&(W.jsonpCallback=ue.jsonpCallback,Uc.push(Le)),Ve&&_e(He)&&He(Ve[0]),Ve=He=void 0}),"script"}),fe.createHTMLDocument=((W=pe.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===W.childNodes.length),F.parseHTML=function(W,ue,Te){return"string"!=typeof W?[]:("boolean"==typeof ue&&(Te=ue,ue=!1),ue||(fe.createHTMLDocument?((Le=(ue=pe.implementation.createHTMLDocument("")).createElement("base")).href=pe.location.href,ue.head.appendChild(Le)):ue=pe),Ve=!Te&&[],(He=qe.exec(W))?[ue.createElement(He[1])]:(He=Uh([W],ue,Ve),Ve&&Ve.length&&F(Ve).remove(),F.merge([],He.childNodes)));var Le,He,Ve},F.fn.load=function(W,ue,Te){var Le,He,Ve,Qe=this,Et=W.indexOf(" ");return Et>-1&&(Le=sc(W.slice(Et)),W=W.slice(0,Et)),_e(ue)?(Te=ue,ue=void 0):ue&&"object"==typeof ue&&(He="POST"),Qe.length>0&&F.ajax({url:W,type:He||"GET",dataType:"html",data:ue}).done(function(At){Ve=arguments,Qe.html(Le?F("<div>").append(F.parseHTML(At)).find(Le):At)}).always(Te&&function(At,Xt){Qe.each(function(){Te.apply(this,Ve||[At.responseText,Xt,At])})}),this},F.expr.pseudos.animated=function(W){return F.grep(F.timers,function(ue){return W===ue.elem}).length},F.offset={setOffset:function(W,ue,Te){var Le,He,Ve,Qe,Et,At,fn=F.css(W,"position"),In=F(W),nn={};"static"===fn&&(W.style.position="relative"),Et=In.offset(),Ve=F.css(W,"top"),At=F.css(W,"left"),("absolute"===fn||"fixed"===fn)&&(Ve+At).indexOf("auto")>-1?(Qe=(Le=In.position()).top,He=Le.left):(Qe=parseFloat(Ve)||0,He=parseFloat(At)||0),_e(ue)&&(ue=ue.call(W,Te,F.extend({},Et))),null!=ue.top&&(nn.top=ue.top-Et.top+Qe),null!=ue.left&&(nn.left=ue.left-Et.left+He),"using"in ue?ue.using.call(W,nn):("number"==typeof nn.top&&(nn.top+="px"),"number"==typeof nn.left&&(nn.left+="px"),In.css(nn))}},F.fn.extend({offset:function(W){if(arguments.length)return void 0===W?this:this.each(function(He){F.offset.setOffset(this,W,He)});var ue,Te,Le=this[0];return Le?Le.getClientRects().length?{top:(ue=Le.getBoundingClientRect()).top+(Te=Le.ownerDocument.defaultView).pageYOffset,left:ue.left+Te.pageXOffset}:{top:0,left:0}:void 0},position:function(){if(this[0]){var W,ue,Te,Le=this[0],He={top:0,left:0};if("fixed"===F.css(Le,"position"))ue=Le.getBoundingClientRect();else{for(ue=this.offset(),Te=Le.ownerDocument,W=Le.offsetParent||Te.documentElement;W&&(W===Te.body||W===Te.documentElement)&&"static"===F.css(W,"position");)W=W.parentNode;W&&W!==Le&&1===W.nodeType&&((He=F(W).offset()).top+=F.css(W,"borderTopWidth",!0),He.left+=F.css(W,"borderLeftWidth",!0))}return{top:ue.top-He.top-F.css(Le,"marginTop",!0),left:ue.left-He.left-F.css(Le,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var W=this.offsetParent;W&&"static"===F.css(W,"position");)W=W.offsetParent;return W||So})}}),F.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(W,ue){var Te="pageYOffset"===ue;F.fn[W]=function(Le){return ur(this,function(He,Ve,Qe){var Et;if(le(He)?Et=He:9===He.nodeType&&(Et=He.defaultView),void 0===Qe)return Et?Et[ue]:He[Ve];Et?Et.scrollTo(Te?Et.pageXOffset:Qe,Te?Qe:Et.pageYOffset):He[Ve]=Qe},W,Le,arguments.length)}}),F.each(["top","left"],function(W,ue){F.cssHooks[ue]=fu(fe.pixelPosition,function(Te,Le){if(Le)return Le=Ja(Te,ue),gh.test(Le)?F(Te).position()[ue]+"px":Le})}),F.each({Height:"height",Width:"width"},function(W,ue){F.each({padding:"inner"+W,content:ue,"":"outer"+W},function(Te,Le){F.fn[Le]=function(He,Ve){var Qe=arguments.length&&(Te||"boolean"!=typeof He),Et=Te||(!0===He||!0===Ve?"margin":"border");return ur(this,function(At,Xt,fn){var In;return le(At)?0===Le.indexOf("outer")?At["inner"+W]:At.document.documentElement["client"+W]:9===At.nodeType?(In=At.documentElement,Math.max(At.body["scroll"+W],In["scroll"+W],At.body["offset"+W],In["offset"+W],In["client"+W])):void 0===fn?F.css(At,Xt,Et):F.style(At,Xt,fn,Et)},ue,Qe?He:void 0,Qe)}})}),F.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(W,ue){F.fn[ue]=function(Te){return this.on(ue,Te)}}),F.fn.extend({bind:function(W,ue,Te){return this.on(W,null,ue,Te)},unbind:function(W,ue){return this.off(W,null,ue)},delegate:function(W,ue,Te,Le){return this.on(ue,W,Te,Le)},undelegate:function(W,ue,Te){return 1===arguments.length?this.off(W,"**"):this.off(ue,W||"**",Te)},hover:function(W,ue){return this.mouseenter(W).mouseleave(ue||W)}}),F.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(W,ue){F.fn[ue]=function(Te,Le){return arguments.length>0?this.on(ue,null,Te,Le):this.trigger(ue)}});var cc=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;F.proxy=function(W,ue){var Te,Le,He;if("string"==typeof ue&&(Te=W[ue],ue=W,W=Te),_e(W))return Le=N.call(arguments,2),He=function(){return W.apply(ue||this,Le.concat(N.call(arguments)))},He.guid=W.guid=W.guid||F.guid++,He},F.holdReady=function(W){W?F.readyWait++:F.ready(!0)},F.isArray=Array.isArray,F.parseJSON=JSON.parse,F.nodeName=Ee,F.isFunction=_e,F.isWindow=le,F.camelCase=ei,F.type=q,F.now=Date.now,F.isNumeric=function(W){var ue=F.type(W);return("number"===ue||"string"===ue)&&!isNaN(W-parseFloat(W))},F.trim=function(W){return null==W?"":(W+"").replace(cc,"")},"function"==typeof define&&define.amd&&define("jquery",[],function(){return F});var Ju=n.jQuery,gu=n.$;return F.noConflict=function(W){return n.$===F&&(n.$=gu),W&&n.jQuery===F&&(n.jQuery=Ju),F},typeof o>"u"&&(n.jQuery=n.$=F),F}),function(n,o){"object"==typeof exports&&typeof module<"u"?o(exports,require("jquery")):"function"==typeof define&&define.amd?define(["exports","jquery"],o):o((n=typeof globalThis<"u"?globalThis:n||self).bootstrap={},n.jQuery)}(this,function(n,o){"use strict";function l(Ie){return Ie&&"object"==typeof Ie&&"default"in Ie?Ie:{default:Ie}}var x=l(o);function N(Ie,je){for(var De=0;De<je.length;De++){var xe=je[De];xe.enumerable=xe.enumerable||!1,xe.configurable=!0,"value"in xe&&(xe.writable=!0),Object.defineProperty(Ie,xe.key,xe)}}function U(Ie,je,De){return je&&N(Ie.prototype,je),De&&N(Ie,De),Ie}function G(){return G=Object.assign||function(Ie){for(var je=1;je<arguments.length;je++){var De=arguments[je];for(var xe in De)Object.prototype.hasOwnProperty.call(De,xe)&&(Ie[xe]=De[xe])}return Ie},G.apply(this,arguments)}var P="transitionend";function fe(Ie){var je=this,De=!1;return x.default(this).one(le.TRANSITION_END,function(){De=!0}),setTimeout(function(){De||le.triggerTransitionEnd(je)},Ie),this}var le={TRANSITION_END:"bsTransitionEnd",getUID:function(je){do{je+=~~(1e6*Math.random())}while(document.getElementById(je));return je},getSelectorFromElement:function(je){var De=je.getAttribute("data-target");if(!De||"#"===De){var xe=je.getAttribute("href");De=xe&&"#"!==xe?xe.trim():""}try{return document.querySelector(De)?De:null}catch{return null}},getTransitionDurationFromElement:function(je){if(!je)return 0;var De=x.default(je).css("transition-duration"),xe=x.default(je).css("transition-delay"),Ue=parseFloat(De),Xe=parseFloat(xe);return Ue||Xe?(De=De.split(",")[0],xe=xe.split(",")[0],1e3*(parseFloat(De)+parseFloat(xe))):0},reflow:function(je){return je.offsetHeight},triggerTransitionEnd:function(je){x.default(je).trigger(P)},supportsTransitionEnd:function(){return!0},isElement:function(je){return(je[0]||je).nodeType},typeCheckConfig:function(je,De,xe){for(var Ue in xe)if(Object.prototype.hasOwnProperty.call(xe,Ue)){var Xe=xe[Ue],yt=De[Ue],Pt=yt&&le.isElement(yt)?"element":null===(Ie=yt)||typeof Ie>"u"?""+Ie:{}.toString.call(Ie).match(/\s([a-z]+)/i)[1].toLowerCase();if(!new RegExp(Xe).test(Pt))throw new Error(je.toUpperCase()+': Option "'+Ue+'" provided type "'+Pt+'" but expected type "'+Xe+'".')}var Ie},findShadowRoot:function(je){if(!document.documentElement.attachShadow)return null;if("function"==typeof je.getRootNode){var De=je.getRootNode();return De instanceof ShadowRoot?De:null}return je instanceof ShadowRoot?je:je.parentNode?le.findShadowRoot(je.parentNode):null},jQueryDetection:function(){if(typeof x.default>"u")throw new TypeError("Bootstrap's JavaScript requires jQuery. jQuery must be included before Bootstrap's JavaScript.");var je=x.default.fn.jquery.split(" ")[0].split(".");if(je[0]<2&&je[1]<9||1===je[0]&&9===je[1]&&je[2]<1||je[0]>=4)throw new Error("Bootstrap's JavaScript requires at least jQuery v1.9.1 but less than v4.0.0")}};le.jQueryDetection(),function _e(){x.default.fn.emulateTransitionEnd=fe,x.default.event.special[le.TRANSITION_END]=function ce(){return{bindType:P,delegateType:P,handle:function(je){if(x.default(je.target).is(this))return je.handleObj.handler.apply(this,arguments)}}}()}();var pe="alert",B="bs.alert",q="."+B,F=x.default.fn[pe],K="close"+q,ve="closed"+q,Ae="click"+q+".data-api",Ke=function(){function Ie(De){this._element=De}var je=Ie.prototype;return je.close=function(xe){var Ue=this._element;xe&&(Ue=this._getRootElement(xe)),this._triggerCloseEvent(Ue).isDefaultPrevented()||this._removeElement(Ue)},je.dispose=function(){x.default.removeData(this._element,B),this._element=null},je._getRootElement=function(xe){var Ue=le.getSelectorFromElement(xe),Xe=!1;return Ue&&(Xe=document.querySelector(Ue)),Xe||(Xe=x.default(xe).closest(".alert")[0]),Xe},je._triggerCloseEvent=function(xe){var Ue=x.default.Event(K);return x.default(xe).trigger(Ue),Ue},je._removeElement=function(xe){var Ue=this;if(x.default(xe).removeClass("show"),x.default(xe).hasClass("fade")){var Xe=le.getTransitionDurationFromElement(xe);x.default(xe).one(le.TRANSITION_END,function(yt){return Ue._destroyElement(xe,yt)}).emulateTransitionEnd(Xe)}else this._destroyElement(xe)},je._destroyElement=function(xe){x.default(xe).detach().trigger(ve).remove()},Ie._jQueryInterface=function(xe){return this.each(function(){var Ue=x.default(this),Xe=Ue.data(B);Xe||(Xe=new Ie(this),Ue.data(B,Xe)),"close"===xe&&Xe[xe](this)})},Ie._handleDismiss=function(xe){return function(Ue){Ue&&Ue.preventDefault(),xe.close(this)}},U(Ie,null,[{key:"VERSION",get:function(){return"4.5.3"}}]),Ie}();x.default(document).on(Ae,'[data-dismiss="alert"]',Ke._handleDismiss(new Ke)),x.default.fn[pe]=Ke._jQueryInterface,x.default.fn[pe].Constructor=Ke,x.default.fn[pe].noConflict=function(){return x.default.fn[pe]=F,Ke._jQueryInterface};var gt="button",Ct="bs.button",wt="."+Ct,Ft=".data-api",Ot=x.default.fn[gt],rn="active",Cn='[data-toggle^="button"]',gn='input:not([type="hidden"])',hr="click"+wt+Ft,sr="focus"+wt+Ft+" blur"+wt+Ft,ei="load"+wt+Ft,Jr=function(){function Ie(De){this._element=De,this.shouldAvoidTriggerChange=!1}var je=Ie.prototype;return je.toggle=function(){var xe=!0,Ue=!0,Xe=x.default(this._element).closest('[data-toggle="buttons"]')[0];if(Xe){var yt=this._element.querySelector(gn);if(yt){if("radio"===yt.type)if(yt.checked&&this._element.classList.contains(rn))xe=!1;else{var Pt=Xe.querySelector(".active");Pt&&x.default(Pt).removeClass(rn)}xe&&(("checkbox"===yt.type||"radio"===yt.type)&&(yt.checked=!this._element.classList.contains(rn)),this.shouldAvoidTriggerChange||x.default(yt).trigger("change")),yt.focus(),Ue=!1}}this._element.hasAttribute("disabled")||this._element.classList.contains("disabled")||(Ue&&this._element.setAttribute("aria-pressed",!this._element.classList.contains(rn)),xe&&x.default(this._element).toggleClass(rn))},je.dispose=function(){x.default.removeData(this._element,Ct),this._element=null},Ie._jQueryInterface=function(xe,Ue){return this.each(function(){var Xe=x.default(this),yt=Xe.data(Ct);yt||(yt=new Ie(this),Xe.data(Ct,yt)),yt.shouldAvoidTriggerChange=Ue,"toggle"===xe&&yt[xe]()})},U(Ie,null,[{key:"VERSION",get:function(){return"4.5.3"}}]),Ie}();x.default(document).on(hr,Cn,function(Ie){var je=Ie.target,De=je;if(x.default(je).hasClass("btn")||(je=x.default(je).closest(".btn")[0]),!je||je.hasAttribute("disabled")||je.classList.contains("disabled"))Ie.preventDefault();else{var xe=je.querySelector(gn);if(xe&&(xe.hasAttribute("disabled")||xe.classList.contains("disabled")))return void Ie.preventDefault();("INPUT"===De.tagName||"LABEL"!==je.tagName)&&Jr._jQueryInterface.call(x.default(je),"toggle","INPUT"===De.tagName)}}).on(sr,Cn,function(Ie){var je=x.default(Ie.target).closest(".btn")[0];x.default(je).toggleClass("focus",/^focus(in)?$/.test(Ie.type))}),x.default(window).on(ei,function(){for(var Ie=[].slice.call(document.querySelectorAll('[data-toggle="buttons"] .btn')),je=0,De=Ie.length;je<De;je++){var xe=Ie[je],Ue=xe.querySelector(gn);Ue.checked||Ue.hasAttribute("checked")?xe.classList.add(rn):xe.classList.remove(rn)}for(var Xe=0,yt=(Ie=[].slice.call(document.querySelectorAll('[data-toggle="button"]'))).length;Xe<yt;Xe++){var Pt=Ie[Xe];"true"===Pt.getAttribute("aria-pressed")?Pt.classList.add(rn):Pt.classList.remove(rn)}}),x.default.fn[gt]=Jr._jQueryInterface,x.default.fn[gt].Constructor=Jr,x.default.fn[gt].noConflict=function(){return x.default.fn[gt]=Ot,Jr._jQueryInterface};var ci="carousel",vr="bs.carousel",pi="."+vr,go=".data-api",Nr=x.default.fn[ci],So={interval:5e3,keyboard:!0,slide:!1,pause:"hover",wrap:!0,touch:!0},Gs={interval:"(number|boolean)",keyboard:"boolean",slide:"(boolean|string)",pause:"(string|boolean)",wrap:"boolean",touch:"boolean"},Ks="next",Di="prev",Xr="slide"+pi,ss="slid"+pi,Or="keydown"+pi,Na="mouseenter"+pi,Fu="mouseleave"+pi,ps="touchstart"+pi,Hs="touchmove"+pi,ii="touchend"+pi,Pc="pointerdown"+pi,Uh="pointerup"+pi,Ya="dragstart"+pi,Jp="load"+pi+go,ea="click"+pi+go,Ra="active",du=".active.carousel-item",gh={TOUCH:"touch",PEN:"pen"},To=function(){function Ie(De,xe){this._items=null,this._interval=null,this._activeElement=null,this._isPaused=!1,this._isSliding=!1,this.touchTimeout=null,this.touchStartX=0,this.touchDeltaX=0,this._config=this._getConfig(xe),this._element=De,this._indicatorsElement=this._element.querySelector(".carousel-indicators"),this._touchSupported="ontouchstart"in document.documentElement||navigator.maxTouchPoints>0,this._pointerEvent=!(!window.PointerEvent&&!window.MSPointerEvent),this._addEventListeners()}var je=Ie.prototype;return je.next=function(){this._isSliding||this._slide(Ks)},je.nextWhenVisible=function(){var xe=x.default(this._element);!document.hidden&&xe.is(":visible")&&"hidden"!==xe.css("visibility")&&this.next()},je.prev=function(){this._isSliding||this._slide(Di)},je.pause=function(xe){xe||(this._isPaused=!0),this._element.querySelector(".carousel-item-next, .carousel-item-prev")&&(le.triggerTransitionEnd(this._element),this.cycle(!0)),clearInterval(this._interval),this._interval=null},je.cycle=function(xe){xe||(this._isPaused=!1),this._interval&&(clearInterval(this._interval),this._interval=null),this._config.interval&&!this._isPaused&&(this._interval=setInterval((document.visibilityState?this.nextWhenVisible:this.next).bind(this),this._config.interval))},je.to=function(xe){var Ue=this;this._activeElement=this._element.querySelector(du);var Xe=this._getItemIndex(this._activeElement);if(!(xe>this._items.length-1||xe<0)){if(this._isSliding)return void x.default(this._element).one(ss,function(){return Ue.to(xe)});if(Xe===xe)return this.pause(),void this.cycle();this._slide(xe>Xe?Ks:Di,this._items[xe])}},je.dispose=function(){x.default(this._element).off(pi),x.default.removeData(this._element,vr),this._items=null,this._config=null,this._element=null,this._interval=null,this._isPaused=null,this._isSliding=null,this._activeElement=null,this._indicatorsElement=null},je._getConfig=function(xe){return xe=G({},So,xe),le.typeCheckConfig(ci,xe,Gs),xe},je._handleSwipe=function(){var xe=Math.abs(this.touchDeltaX);if(!(xe<=40)){var Ue=xe/this.touchDeltaX;this.touchDeltaX=0,Ue>0&&this.prev(),Ue<0&&this.next()}},je._addEventListeners=function(){var xe=this;this._config.keyboard&&x.default(this._element).on(Or,function(Ue){return xe._keydown(Ue)}),"hover"===this._config.pause&&x.default(this._element).on(Na,function(Ue){return xe.pause(Ue)}).on(Fu,function(Ue){return xe.cycle(Ue)}),this._config.touch&&this._addTouchEventListeners()},je._addTouchEventListeners=function(){var xe=this;if(this._touchSupported){var Ue=function(Jt){xe._pointerEvent&&gh[Jt.originalEvent.pointerType.toUpperCase()]?xe.touchStartX=Jt.originalEvent.clientX:xe._pointerEvent||(xe.touchStartX=Jt.originalEvent.touches[0].clientX)},yt=function(Jt){xe._pointerEvent&&gh[Jt.originalEvent.pointerType.toUpperCase()]&&(xe.touchDeltaX=Jt.originalEvent.clientX-xe.touchStartX),xe._handleSwipe(),"hover"===xe._config.pause&&(xe.pause(),xe.touchTimeout&&clearTimeout(xe.touchTimeout),xe.touchTimeout=setTimeout(function(An){return xe.cycle(An)},500+xe._config.interval))};x.default(this._element.querySelectorAll(".carousel-item img")).on(Ya,function(Pt){return Pt.preventDefault()}),this._pointerEvent?(x.default(this._element).on(Pc,function(Pt){return Ue(Pt)}),x.default(this._element).on(Uh,function(Pt){return yt(Pt)}),this._element.classList.add("pointer-event")):(x.default(this._element).on(ps,function(Pt){return Ue(Pt)}),x.default(this._element).on(Hs,function(Pt){var Jt;xe.touchDeltaX=(Jt=Pt).originalEvent.touches&&Jt.originalEvent.touches.length>1?0:Jt.originalEvent.touches[0].clientX-xe.touchStartX}),x.default(this._element).on(ii,function(Pt){return yt(Pt)}))}},je._keydown=function(xe){if(!/input|textarea/i.test(xe.target.tagName))switch(xe.which){case 37:xe.preventDefault(),this.prev();break;case 39:xe.preventDefault(),this.next()}},je._getItemIndex=function(xe){return this._items=xe&&xe.parentNode?[].slice.call(xe.parentNode.querySelectorAll(".carousel-item")):[],this._items.indexOf(xe)},je._getItemByDirection=function(xe,Ue){var Xe=xe===Ks,yt=xe===Di,Pt=this._getItemIndex(Ue);if((yt&&0===Pt||Xe&&Pt===this._items.length-1)&&!this._config.wrap)return Ue;var Dn=(Pt+(xe===Di?-1:1))%this._items.length;return-1===Dn?this._items[this._items.length-1]:this._items[Dn]},je._triggerSlideEvent=function(xe,Ue){var Xe=this._getItemIndex(xe),yt=this._getItemIndex(this._element.querySelector(du)),Pt=x.default.Event(Xr,{relatedTarget:xe,direction:Ue,from:yt,to:Xe});return x.default(this._element).trigger(Pt),Pt},je._setActiveIndicatorElement=function(xe){if(this._indicatorsElement){var Ue=[].slice.call(this._indicatorsElement.querySelectorAll(".active"));x.default(Ue).removeClass(Ra);var Xe=this._indicatorsElement.children[this._getItemIndex(xe)];Xe&&x.default(Xe).addClass(Ra)}},je._slide=function(xe,Ue){var Dn,cr,Pr,Xe=this,yt=this._element.querySelector(du),Pt=this._getItemIndex(yt),Jt=Ue||yt&&this._getItemByDirection(xe,yt),An=this._getItemIndex(Jt),Wn=!!this._interval;if(xe===Ks?(Dn="carousel-item-left",cr="carousel-item-next",Pr="left"):(Dn="carousel-item-right",cr="carousel-item-prev",Pr="right"),Jt&&x.default(Jt).hasClass(Ra))this._isSliding=!1;else if(!this._triggerSlideEvent(Jt,Pr).isDefaultPrevented()&&yt&&Jt){this._isSliding=!0,Wn&&this.pause(),this._setActiveIndicatorElement(Jt);var Zi=x.default.Event(ss,{relatedTarget:Jt,direction:Pr,from:Pt,to:An});if(x.default(this._element).hasClass("slide")){x.default(Jt).addClass(cr),le.reflow(Jt),x.default(yt).addClass(Dn),x.default(Jt).addClass(Dn);var Bl=parseInt(Jt.getAttribute("data-interval"),10);Bl?(this._config.defaultInterval=this._config.defaultInterval||this._config.interval,this._config.interval=Bl):this._config.interval=this._config.defaultInterval||this._config.interval;var Nl=le.getTransitionDurationFromElement(yt);x.default(yt).one(le.TRANSITION_END,function(){x.default(Jt).removeClass(Dn+" "+cr).addClass(Ra),x.default(yt).removeClass(Ra+" "+cr+" "+Dn),Xe._isSliding=!1,setTimeout(function(){return x.default(Xe._element).trigger(Zi)},0)}).emulateTransitionEnd(Nl)}else x.default(yt).removeClass(Ra),x.default(Jt).addClass(Ra),this._isSliding=!1,x.default(this._element).trigger(Zi);Wn&&this.cycle()}},Ie._jQueryInterface=function(xe){return this.each(function(){var Ue=x.default(this).data(vr),Xe=G({},So,x.default(this).data());"object"==typeof xe&&(Xe=G({},Xe,xe));var yt="string"==typeof xe?xe:Xe.slide;if(Ue||(Ue=new Ie(this,Xe),x.default(this).data(vr,Ue)),"number"==typeof xe)Ue.to(xe);else if("string"==typeof yt){if(typeof Ue[yt]>"u")throw new TypeError('No method named "'+yt+'"');Ue[yt]()}else Xe.interval&&Xe.ride&&(Ue.pause(),Ue.cycle())})},Ie._dataApiClickHandler=function(xe){var Ue=le.getSelectorFromElement(this);if(Ue){var Xe=x.default(Ue)[0];if(Xe&&x.default(Xe).hasClass("carousel")){var yt=G({},x.default(Xe).data(),x.default(this).data()),Pt=this.getAttribute("data-slide-to");Pt&&(yt.interval=!1),Ie._jQueryInterface.call(x.default(Xe),yt),Pt&&x.default(Xe).data(vr).to(Pt),xe.preventDefault()}}},U(Ie,null,[{key:"VERSION",get:function(){return"4.5.3"}},{key:"Default",get:function(){return So}}]),Ie}();x.default(document).on(ea,"[data-slide], [data-slide-to]",To._dataApiClickHandler),x.default(window).on(Jp,function(){for(var Ie=[].slice.call(document.querySelectorAll('[data-ride="carousel"]')),je=0,De=Ie.length;je<De;je++){var xe=x.default(Ie[je]);To._jQueryInterface.call(xe,xe.data())}}),x.default.fn[ci]=To._jQueryInterface,x.default.fn[ci].Constructor=To,x.default.fn[ci].noConflict=function(){return x.default.fn[ci]=Nr,To._jQueryInterface};var Ws="collapse",Ja="bs.collapse",fu="."+Ja,mp=x.default.fn[Ws],vh={toggle:!0,parent:""},zh={toggle:"boolean",parent:"(string|element)"},ic="show"+fu,jh="shown"+fu,yh="hide"+fu,Gh="hidden"+fu,vl="click"+fu+".data-api",yl="show",Fl="collapse",zu="collapsing",fs="collapsed",gp='[data-toggle="collapse"]',kc=function(){function Ie(De,xe){this._isTransitioning=!1,this._element=De,this._config=this._getConfig(xe),this._triggerArray=[].slice.call(document.querySelectorAll('[data-toggle="collapse"][href="#'+De.id+'"],[data-toggle="collapse"][data-target="#'+De.id+'"]'));for(var Ue=[].slice.call(document.querySelectorAll(gp)),Xe=0,yt=Ue.length;Xe<yt;Xe++){var Pt=Ue[Xe],Jt=le.getSelectorFromElement(Pt),An=[].slice.call(document.querySelectorAll(Jt)).filter(function(Wn){return Wn===De});null!==Jt&&An.length>0&&(this._selector=Jt,this._triggerArray.push(Pt))}this._parent=this._config.parent?this._getParent():null,this._config.parent||this._addAriaAndCollapsedClass(this._element,this._triggerArray),this._config.toggle&&this.toggle()}var je=Ie.prototype;return je.toggle=function(){x.default(this._element).hasClass(yl)?this.hide():this.show()},je.show=function(){var Ue,Xe,xe=this;if(!(this._isTransitioning||x.default(this._element).hasClass(yl)||(this._parent&&0===(Ue=[].slice.call(this._parent.querySelectorAll(".show, .collapsing")).filter(function(cr){return"string"==typeof xe._config.parent?cr.getAttribute("data-parent")===xe._config.parent:cr.classList.contains(Fl)})).length&&(Ue=null),Ue&&(Xe=x.default(Ue).not(this._selector).data(Ja),Xe&&Xe._isTransitioning)))){var yt=x.default.Event(ic);if(x.default(this._element).trigger(yt),!yt.isDefaultPrevented()){Ue&&(Ie._jQueryInterface.call(x.default(Ue).not(this._selector),"hide"),Xe||x.default(Ue).data(Ja,null));var Pt=this._getDimension();x.default(this._element).removeClass(Fl).addClass(zu),this._element.style[Pt]=0,this._triggerArray.length&&x.default(this._triggerArray).removeClass(fs).attr("aria-expanded",!0),this.setTransitioning(!0);var Wn="scroll"+(Pt[0].toUpperCase()+Pt.slice(1)),Dn=le.getTransitionDurationFromElement(this._element);x.default(this._element).one(le.TRANSITION_END,function(){x.default(xe._element).removeClass(zu).addClass(Fl+" "+yl),xe._element.style[Pt]="",xe.setTransitioning(!1),x.default(xe._element).trigger(jh)}).emulateTransitionEnd(Dn),this._element.style[Pt]=this._element[Wn]+"px"}}},je.hide=function(){var xe=this;if(!this._isTransitioning&&x.default(this._element).hasClass(yl)){var Ue=x.default.Event(yh);if(x.default(this._element).trigger(Ue),!Ue.isDefaultPrevented()){var Xe=this._getDimension();this._element.style[Xe]=this._element.getBoundingClientRect()[Xe]+"px",le.reflow(this._element),x.default(this._element).addClass(zu).removeClass(Fl+" "+yl);var yt=this._triggerArray.length;if(yt>0)for(var Pt=0;Pt<yt;Pt++){var Jt=this._triggerArray[Pt],An=le.getSelectorFromElement(Jt);null!==An&&(x.default([].slice.call(document.querySelectorAll(An))).hasClass(yl)||x.default(Jt).addClass(fs).attr("aria-expanded",!1))}this.setTransitioning(!0),this._element.style[Xe]="";var cr=le.getTransitionDurationFromElement(this._element);x.default(this._element).one(le.TRANSITION_END,function(){xe.setTransitioning(!1),x.default(xe._element).removeClass(zu).addClass(Fl).trigger(Gh)}).emulateTransitionEnd(cr)}}},je.setTransitioning=function(xe){this._isTransitioning=xe},je.dispose=function(){x.default.removeData(this._element,Ja),this._config=null,this._parent=null,this._element=null,this._triggerArray=null,this._isTransitioning=null},je._getConfig=function(xe){return(xe=G({},vh,xe)).toggle=!!xe.toggle,le.typeCheckConfig(Ws,xe,zh),xe},je._getDimension=function(){return x.default(this._element).hasClass("width")?"width":"height"},je._getParent=function(){var Ue,xe=this;le.isElement(this._config.parent)?(Ue=this._config.parent,typeof this._config.parent.jquery<"u"&&(Ue=this._config.parent[0])):Ue=document.querySelector(this._config.parent);var yt=[].slice.call(Ue.querySelectorAll('[data-toggle="collapse"][data-parent="'+this._config.parent+'"]'));return x.default(yt).each(function(Pt,Jt){xe._addAriaAndCollapsedClass(Ie._getTargetFromElement(Jt),[Jt])}),Ue},je._addAriaAndCollapsedClass=function(xe,Ue){var Xe=x.default(xe).hasClass(yl);Ue.length&&x.default(Ue).toggleClass(fs,!Xe).attr("aria-expanded",Xe)},Ie._getTargetFromElement=function(xe){var Ue=le.getSelectorFromElement(xe);return Ue?document.querySelector(Ue):null},Ie._jQueryInterface=function(xe){return this.each(function(){var Ue=x.default(this),Xe=Ue.data(Ja),yt=G({},vh,Ue.data(),"object"==typeof xe&&xe?xe:{});if(!Xe&&yt.toggle&&"string"==typeof xe&&/show|hide/.test(xe)&&(yt.toggle=!1),Xe||(Xe=new Ie(this,yt),Ue.data(Ja,Xe)),"string"==typeof xe){if(typeof Xe[xe]>"u")throw new TypeError('No method named "'+xe+'"');Xe[xe]()}})},U(Ie,null,[{key:"VERSION",get:function(){return"4.5.3"}},{key:"Default",get:function(){return vh}}]),Ie}();x.default(document).on(vl,gp,function(Ie){"A"===Ie.currentTarget.tagName&&Ie.preventDefault();var je=x.default(this),De=le.getSelectorFromElement(this),xe=[].slice.call(document.querySelectorAll(De));x.default(xe).each(function(){var Ue=x.default(this),yt=Ue.data(Ja)?"toggle":je.data();kc._jQueryInterface.call(Ue,yt)})}),x.default.fn[Ws]=kc._jQueryInterface,x.default.fn[Ws].Constructor=kc,x.default.fn[Ws].noConflict=function(){return x.default.fn[Ws]=mp,kc._jQueryInterface};var oc=typeof window<"u"&&typeof document<"u"&&typeof navigator<"u",bh=function(){for(var Ie=["Edge","Trident","Firefox"],je=0;je<Ie.length;je+=1)if(oc&&navigator.userAgent.indexOf(Ie[je])>=0)return 1;return 0}(),Za=oc&&window.Promise?function vp(Ie){var je=!1;return function(){je||(je=!0,window.Promise.resolve().then(function(){je=!1,Ie()}))}}:function Gu(Ie){var je=!1;return function(){je||(je=!0,setTimeout(function(){je=!1,Ie()},bh))}};function Hh(Ie){return Ie&&"[object Function]"==={}.toString.call(Ie)}function Qa(Ie,je){if(1!==Ie.nodeType)return[];var xe=Ie.ownerDocument.defaultView.getComputedStyle(Ie,null);return je?xe[je]:xe}function Vh(Ie){return"HTML"===Ie.nodeName?Ie:Ie.parentNode||Ie.host}function Vu(Ie){if(!Ie)return document.body;switch(Ie.nodeName){case"HTML":case"BODY":return Ie.ownerDocument.body;case"#document":return Ie.body}var je=Qa(Ie);return/(auto|scroll|overlay)/.test(je.overflow+je.overflowY+je.overflowX)?Ie:Vu(Vh(Ie))}function sc(Ie){return Ie&&Ie.referenceNode?Ie.referenceNode:Ie}var ac=oc&&!(!window.MSInputMethodContext||!document.documentMode),xh=oc&&/MSIE 10/.test(navigator.userAgent);function mu(Ie){return 11===Ie?ac:10===Ie?xh:ac||xh}function Fc(Ie){if(!Ie)return document.documentElement;for(var je=mu(10)?document.body:null,De=Ie.offsetParent||null;De===je&&Ie.nextElementSibling;)De=(Ie=Ie.nextElementSibling).offsetParent;var xe=De&&De.nodeName;return xe&&"BODY"!==xe&&"HTML"!==xe?-1!==["TH","TD","TABLE"].indexOf(De.nodeName)&&"static"===Qa(De,"position")?Fc(De):De:Ie?Ie.ownerDocument.documentElement:document.documentElement}function Dc(Ie){return null!==Ie.parentNode?Dc(Ie.parentNode):Ie}function Wu(Ie,je){if(!(Ie&&Ie.nodeType&&je&&je.nodeType))return document.documentElement;var De=Ie.compareDocumentPosition(je)&Node.DOCUMENT_POSITION_FOLLOWING,xe=De?Ie:je,Ue=De?je:Ie,Xe=document.createRange();Xe.setStart(xe,0),Xe.setEnd(Ue,0);var yt=Xe.commonAncestorContainer;if(Ie!==yt&&je!==yt||xe.contains(Ue))return function yp(Ie){var je=Ie.nodeName;return"BODY"!==je&&("HTML"===je||Fc(Ie.firstElementChild)===Ie)}(yt)?yt:Fc(yt);var Pt=Dc(Ie);return Pt.host?Wu(Pt.host,je):Wu(Ie,Dc(je).host)}function Ul(Ie){var De="top"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:"top")?"scrollTop":"scrollLeft",xe=Ie.nodeName;return"BODY"===xe||"HTML"===xe?(Ie.ownerDocument.scrollingElement||Ie.ownerDocument.documentElement)[De]:Ie[De]}function Wh(Ie,je){var De="x"===je?"Left":"Top",xe="Left"===De?"Right":"Bottom";return parseFloat(Ie["border"+De+"Width"])+parseFloat(Ie["border"+xe+"Width"])}function xp(Ie,je,De,xe){return Math.max(je["offset"+Ie],je["scroll"+Ie],De["client"+Ie],De["offset"+Ie],De["scroll"+Ie],mu(10)?parseInt(De["offset"+Ie])+parseInt(xe["margin"+("Height"===Ie?"Top":"Left")])+parseInt(xe["margin"+("Height"===Ie?"Bottom":"Right")]):0)}function wp(Ie){var je=Ie.body,De=Ie.documentElement,xe=mu(10)&&getComputedStyle(De);return{height:xp("Height",je,De,xe),width:xp("Width",je,De,xe)}}var Kp=function(){function Ie(je,De){for(var xe=0;xe<De.length;xe++){var Ue=De[xe];Ue.enumerable=Ue.enumerable||!1,Ue.configurable=!0,"value"in Ue&&(Ue.writable=!0),Object.defineProperty(je,Ue.key,Ue)}}return function(je,De,xe){return De&&Ie(je.prototype,De),xe&&Ie(je,xe),je}}(),_u=function(Ie,je,De){return je in Ie?Object.defineProperty(Ie,je,{value:De,enumerable:!0,configurable:!0,writable:!0}):Ie[je]=De,Ie},Pa=Object.assign||function(Ie){for(var je=1;je<arguments.length;je++){var De=arguments[je];for(var xe in De)Object.prototype.hasOwnProperty.call(De,xe)&&(Ie[xe]=De[xe])}return Ie};function lc(Ie){return Pa({},Ie,{right:Ie.left+Ie.width,bottom:Ie.top+Ie.height})}function zl(Ie){var je={};try{if(mu(10)){je=Ie.getBoundingClientRect();var De=Ul(Ie,"top"),xe=Ul(Ie,"left");je.top+=De,je.left+=xe,je.bottom+=De,je.right+=xe}else je=Ie.getBoundingClientRect()}catch{}var Ue={left:je.left,top:je.top,width:je.right-je.left,height:je.bottom-je.top},Xe="HTML"===Ie.nodeName?wp(Ie.ownerDocument):{},Jt=Ie.offsetWidth-(Xe.width||Ie.clientWidth||Ue.width),An=Ie.offsetHeight-(Xe.height||Ie.clientHeight||Ue.height);if(Jt||An){var Wn=Qa(Ie);Jt-=Wh(Wn,"x"),An-=Wh(Wn,"y"),Ue.width-=Jt,Ue.height-=An}return lc(Ue)}function jl(Ie,je){var De=arguments.length>2&&void 0!==arguments[2]&&arguments[2],xe=mu(10),Ue="HTML"===je.nodeName,Xe=zl(Ie),yt=zl(je),Pt=Vu(Ie),Jt=Qa(je),An=parseFloat(Jt.borderTopWidth),Wn=parseFloat(Jt.borderLeftWidth);De&&Ue&&(yt.top=Math.max(yt.top,0),yt.left=Math.max(yt.left,0));var Dn=lc({top:Xe.top-yt.top-An,left:Xe.left-yt.left-Wn,width:Xe.width,height:Xe.height});if(Dn.marginTop=0,Dn.marginLeft=0,!xe&&Ue){var cr=parseFloat(Jt.marginTop),Pr=parseFloat(Jt.marginLeft);Dn.top-=An-cr,Dn.bottom-=An-cr,Dn.left-=Wn-Pr,Dn.right-=Wn-Pr,Dn.marginTop=cr,Dn.marginLeft=Pr}return(xe&&!De?je.contains(Pt):je===Pt&&"BODY"!==Pt.nodeName)&&(Dn=function bp(Ie,je){var De=arguments.length>2&&void 0!==arguments[2]&&arguments[2],xe=Ul(je,"top"),Ue=Ul(je,"left"),Xe=De?-1:1;return Ie.top+=xe*Xe,Ie.bottom+=xe*Xe,Ie.left+=Ue*Xe,Ie.right+=Ue*Xe,Ie}(Dn,je)),Dn}function va(Ie){var je=Ie.nodeName;if("BODY"===je||"HTML"===je)return!1;if("fixed"===Qa(Ie,"position"))return!0;var De=Vh(Ie);return!!De&&va(De)}function ta(Ie){if(!Ie||!Ie.parentElement||mu())return document.documentElement;for(var je=Ie.parentElement;je&&"none"===Qa(je,"transform");)je=je.parentElement;return je||document.documentElement}function xl(Ie,je,De,xe){var Ue=arguments.length>4&&void 0!==arguments[4]&&arguments[4],Xe={top:0,left:0},yt=Ue?ta(Ie):Wu(Ie,sc(je));if("viewport"===xe)Xe=function qu(Ie){var je=arguments.length>1&&void 0!==arguments[1]&&arguments[1],De=Ie.ownerDocument.documentElement,xe=jl(Ie,De),Ue=Math.max(De.clientWidth,window.innerWidth||0),Xe=Math.max(De.clientHeight,window.innerHeight||0),yt=je?0:Ul(De),Pt=je?0:Ul(De,"left");return lc({top:yt-xe.top+xe.marginTop,left:Pt-xe.left+xe.marginLeft,width:Ue,height:Xe})}(yt,Ue);else{var Pt=void 0;"scrollParent"===xe?"BODY"===(Pt=Vu(Vh(je))).nodeName&&(Pt=Ie.ownerDocument.documentElement):Pt="window"===xe?Ie.ownerDocument.documentElement:xe;var Jt=jl(Pt,yt,Ue);if("HTML"!==Pt.nodeName||va(yt))Xe=Jt;else{var An=wp(Ie.ownerDocument),Wn=An.height,Dn=An.width;Xe.top+=Jt.top-Jt.marginTop,Xe.bottom=Wn+Jt.top,Xe.left+=Jt.left-Jt.marginLeft,Xe.right=Dn+Jt.left}}var cr="number"==typeof(De=De||0);return Xe.left+=cr?De:De.left||0,Xe.top+=cr?De:De.top||0,Xe.right-=cr?De:De.right||0,Xe.bottom-=cr?De:De.bottom||0,Xe}function Xu(Ie){return Ie.width*Ie.height}function Yu(Ie,je,De,xe,Ue){var Xe=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;if(-1===Ie.indexOf("auto"))return Ie;var yt=xl(De,xe,Xe,Ue),Pt={top:{width:yt.width,height:je.top-yt.top},right:{width:yt.right-je.right,height:yt.height},bottom:{width:yt.width,height:yt.bottom-je.bottom},left:{width:je.left-yt.left,height:yt.height}},Jt=Object.keys(Pt).map(function(cr){return Pa({key:cr},Pt[cr],{area:Xu(Pt[cr])})}).sort(function(cr,Pr){return Pr.area-cr.area}),An=Jt.filter(function(cr){return cr.width>=De.clientWidth&&cr.height>=De.clientHeight}),Wn=An.length>0?An[0].key:Jt[0].key,Dn=Ie.split("-")[1];return Wn+(Dn?"-"+Dn:"")}function Xh(Ie,je,De){var xe=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return jl(De,xe?ta(je):Wu(je,sc(De)),xe)}function Sp(Ie){var De=Ie.ownerDocument.defaultView.getComputedStyle(Ie),xe=parseFloat(De.marginTop||0)+parseFloat(De.marginBottom||0),Ue=parseFloat(De.marginLeft||0)+parseFloat(De.marginRight||0);return{width:Ie.offsetWidth+Ue,height:Ie.offsetHeight+xe}}function Ep(Ie){var je={left:"right",right:"left",bottom:"top",top:"bottom"};return Ie.replace(/left|right|bottom|top/g,function(De){return je[De]})}function Qi(Ie,je,De){De=De.split("-")[0];var xe=Sp(Ie),Ue={width:xe.width,height:xe.height},Xe=-1!==["right","left"].indexOf(De),yt=Xe?"top":"left",Pt=Xe?"left":"top",Jt=Xe?"height":"width",An=Xe?"width":"height";return Ue[yt]=je[yt]+je[Jt]/2-xe[Jt]/2,Ue[Pt]=De===Pt?je[Pt]-xe[An]:je[Ep(Pt)],Ue}function Ka(Ie,je){return Array.prototype.find?Ie.find(je):Ie.filter(je)[0]}function Uc(Ie,je,De){var xe=void 0===De?Ie:Ie.slice(0,function Gl(Ie,je,De){if(Array.prototype.findIndex)return Ie.findIndex(function(Ue){return Ue[je]===De});var xe=Ka(Ie,function(Ue){return Ue[je]===De});return Ie.indexOf(xe)}(Ie,"name",De));return xe.forEach(function(Ue){Ue.function&&console.warn("`modifier.function` is deprecated, use `modifier.fn`!");var Xe=Ue.function||Ue.fn;Ue.enabled&&Hh(Xe)&&(je.offsets.popper=lc(je.offsets.popper),je.offsets.reference=lc(je.offsets.reference),je=Xe(je,Ue))}),je}function Yh(){if(!this.state.isDestroyed){var Ie={instance:this,styles:{},arrowStyles:{},attributes:{},flipped:!1,offsets:{}};Ie.offsets.reference=Xh(this.state,this.popper,this.reference,this.options.positionFixed),Ie.placement=Yu(this.options.placement,Ie.offsets.reference,this.popper,this.reference,this.options.modifiers.flip.boundariesElement,this.options.modifiers.flip.padding),Ie.originalPlacement=Ie.placement,Ie.positionFixed=this.options.positionFixed,Ie.offsets.popper=Qi(this.popper,Ie.offsets.reference,Ie.placement),Ie.offsets.popper.position=this.options.positionFixed?"fixed":"absolute",Ie=Uc(this.modifiers,Ie),this.state.isCreated?this.options.onUpdate(Ie):(this.state.isCreated=!0,this.options.onCreate(Ie))}}function cc(Ie,je){return Ie.some(function(De){return De.enabled&&De.name===je})}function Ju(Ie){for(var je=[!1,"ms","Webkit","Moz","O"],De=Ie.charAt(0).toUpperCase()+Ie.slice(1),xe=0;xe<je.length;xe++){var Ue=je[xe],Xe=Ue?""+Ue+De:Ie;if(typeof document.body.style[Xe]<"u")return Xe}return null}function gu(){return this.state.isDestroyed=!0,cc(this.modifiers,"applyStyle")&&(this.popper.removeAttribute("x-placement"),this.popper.style.position="",this.popper.style.top="",this.popper.style.left="",this.popper.style.right="",this.popper.style.bottom="",this.popper.style.willChange="",this.popper.style[Ju("transform")]=""),this.disableEventListeners(),this.options.removeOnDestroy&&this.popper.parentNode.removeChild(this.popper),this}function W(Ie){var je=Ie.ownerDocument;return je?je.defaultView:window}function ue(Ie,je,De,xe){var Ue="BODY"===Ie.nodeName,Xe=Ue?Ie.ownerDocument.defaultView:Ie;Xe.addEventListener(je,De,{passive:!0}),Ue||ue(Vu(Xe.parentNode),je,De,xe),xe.push(Xe)}function Te(Ie,je,De,xe){De.updateBound=xe,W(Ie).addEventListener("resize",De.updateBound,{passive:!0});var Ue=Vu(Ie);return ue(Ue,"scroll",De.updateBound,De.scrollParents),De.scrollElement=Ue,De.eventsEnabled=!0,De}function Le(){this.state.eventsEnabled||(this.state=Te(this.reference,0,this.state,this.scheduleUpdate))}function Ve(){this.state.eventsEnabled&&(cancelAnimationFrame(this.scheduleUpdate),this.state=function He(Ie,je){return W(Ie).removeEventListener("resize",je.updateBound),je.scrollParents.forEach(function(De){De.removeEventListener("scroll",je.updateBound)}),je.updateBound=null,je.scrollParents=[],je.scrollElement=null,je.eventsEnabled=!1,je}(this.reference,this.state))}function Qe(Ie){return""!==Ie&&!isNaN(parseFloat(Ie))&&isFinite(Ie)}function Et(Ie,je){Object.keys(je).forEach(function(De){var xe="";-1!==["width","height","top","right","bottom","left"].indexOf(De)&&Qe(je[De])&&(xe="px"),Ie.style[De]=je[De]+xe})}var nn=oc&&/Firefox/i.test(navigator.userAgent);function Er(Ie,je,De){var xe=Ka(Ie,function(Pt){return Pt.name===je}),Ue=!!xe&&Ie.some(function(Pt){return Pt.name===De&&Pt.enabled&&Pt.order<xe.order});if(!Ue){var Xe="`"+je+"`";console.warn("`"+De+"` modifier is required by "+Xe+" modifier in order to work, be sure to include it before "+Xe+"!")}return Ue}var ms=["auto-start","auto","auto-end","top-start","top","top-end","right-start","right","right-end","bottom-end","bottom","bottom-start","left-end","left","left-start"],Ko=ms.slice(3);function na(Ie){var je=arguments.length>1&&void 0!==arguments[1]&&arguments[1],De=Ko.indexOf(Ie),xe=Ko.slice(De+1).concat(Ko.slice(0,De));return je?xe.reverse():xe}var Ps={placement:"bottom",positionFixed:!1,eventsEnabled:!0,removeOnDestroy:!1,onCreate:function(){},onUpdate:function(){},modifiers:{shift:{order:100,enabled:!0,fn:function ra(Ie){var je=Ie.placement,De=je.split("-")[0],xe=je.split("-")[1];if(xe){var Ue=Ie.offsets,Xe=Ue.reference,yt=Ue.popper,Pt=-1!==["bottom","top"].indexOf(De),Jt=Pt?"left":"top",An=Pt?"width":"height",Wn={start:_u({},Jt,Xe[Jt]),end:_u({},Jt,Xe[Jt]+Xe[An]-yt[An])};Ie.offsets.popper=Pa({},yt,Wn[xe])}return Ie}},offset:{order:200,enabled:!0,fn:function Jh(Ie,je){var Jt,De=je.offset,Ue=Ie.offsets,Xe=Ue.popper,yt=Ue.reference,Pt=Ie.placement.split("-")[0];return Jt=Qe(+De)?[+De,0]:function Yi(Ie,je,De,xe){var Ue=[0,0],Xe=-1!==["right","left"].indexOf(xe),yt=Ie.split(/(\+|\-)/).map(function(Wn){return Wn.trim()}),Pt=yt.indexOf(Ka(yt,function(Wn){return-1!==Wn.search(/,|\s/)}));yt[Pt]&&-1===yt[Pt].indexOf(",")&&console.warn("Offsets separated by white space(s) are deprecated, use a comma (,) instead.");var Jt=/\s*,\s*|\s+/,An=-1!==Pt?[yt.slice(0,Pt).concat([yt[Pt].split(Jt)[0]]),[yt[Pt].split(Jt)[1]].concat(yt.slice(Pt+1))]:[yt];return An=An.map(function(Wn,Dn){var cr=(1===Dn?!Xe:Xe)?"height":"width",Pr=!1;return Wn.reduce(function(Gn,Zi){return""===Gn[Gn.length-1]&&-1!==["+","-"].indexOf(Zi)?(Gn[Gn.length-1]=Zi,Pr=!0,Gn):Pr?(Gn[Gn.length-1]+=Zi,Pr=!1,Gn):Gn.concat(Zi)},[]).map(function(Gn){return function Xi(Ie,je,De,xe){var Ue=Ie.match(/((?:\-|\+)?\d*\.?\d*)(.*)/),Xe=+Ue[1],yt=Ue[2];return Xe?0===yt.indexOf("%")?lc("%p"===yt?De:xe)[je]/100*Xe:"vh"===yt||"vw"===yt?("vh"===yt?Math.max(document.documentElement.clientHeight,window.innerHeight||0):Math.max(document.documentElement.clientWidth,window.innerWidth||0))/100*Xe:Xe:Ie}(Gn,cr,je,De)})}),An.forEach(function(Wn,Dn){Wn.forEach(function(cr,Pr){Qe(cr)&&(Ue[Dn]+=cr*("-"===Wn[Pr-1]?-1:1))})}),Ue}(De,Xe,yt,Pt),"left"===Pt?(Xe.top+=Jt[0],Xe.left-=Jt[1]):"right"===Pt?(Xe.top+=Jt[0],Xe.left+=Jt[1]):"top"===Pt?(Xe.left+=Jt[0],Xe.top-=Jt[1]):"bottom"===Pt&&(Xe.left+=Jt[0],Xe.top+=Jt[1]),Ie.popper=Xe,Ie},offset:0},preventOverflow:{order:300,enabled:!0,fn:function uc(Ie,je){var De=je.boundariesElement||Fc(Ie.instance.popper);Ie.instance.reference===De&&(De=Fc(De));var xe=Ju("transform"),Ue=Ie.instance.popper.style,Xe=Ue.top,yt=Ue.left,Pt=Ue[xe];Ue.top="",Ue.left="",Ue[xe]="";var Jt=xl(Ie.instance.popper,Ie.instance.reference,je.padding,De,Ie.positionFixed);Ue.top=Xe,Ue.left=yt,Ue[xe]=Pt,je.boundaries=Jt;var Wn=Ie.offsets.popper,Dn={primary:function(Pr){var Gn=Wn[Pr];return Wn[Pr]<Jt[Pr]&&!je.escapeWithReference&&(Gn=Math.max(Wn[Pr],Jt[Pr])),_u({},Pr,Gn)},secondary:function(Pr){var Gn="right"===Pr?"left":"top",Zi=Wn[Gn];return Wn[Pr]>Jt[Pr]&&!je.escapeWithReference&&(Zi=Math.min(Wn[Gn],Jt[Pr]-("right"===Pr?Wn.width:Wn.height))),_u({},Gn,Zi)}};return je.priority.forEach(function(cr){var Pr=-1!==["left","top"].indexOf(cr)?"primary":"secondary";Wn=Pa({},Wn,Dn[Pr](cr))}),Ie.offsets.popper=Wn,Ie},priority:["left","right","top","bottom"],padding:5,boundariesElement:"scrollParent"},keepTogether:{order:400,enabled:!0,fn:function Ia(Ie){var je=Ie.offsets,De=je.popper,xe=je.reference,Ue=Ie.placement.split("-")[0],Xe=Math.floor,yt=-1!==["top","bottom"].indexOf(Ue),Pt=yt?"right":"bottom",Jt=yt?"left":"top",An=yt?"width":"height";return De[Pt]<Xe(xe[Jt])&&(Ie.offsets.popper[Jt]=Xe(xe[Jt])-De[An]),De[Jt]>Xe(xe[Pt])&&(Ie.offsets.popper[Jt]=Xe(xe[Pt])),Ie}},arrow:{order:500,enabled:!0,fn:function Kr(Ie,je){var De;if(!Er(Ie.instance.modifiers,"arrow","keepTogether"))return Ie;var xe=je.element;if("string"==typeof xe){if(!(xe=Ie.instance.popper.querySelector(xe)))return Ie}else if(!Ie.instance.popper.contains(xe))return console.warn("WARNING: `arrow.element` must be child of its popper element!"),Ie;var Ue=Ie.placement.split("-")[0],Xe=Ie.offsets,yt=Xe.popper,Pt=Xe.reference,Jt=-1!==["left","right"].indexOf(Ue),An=Jt?"height":"width",Wn=Jt?"Top":"Left",Dn=Wn.toLowerCase(),cr=Jt?"left":"top",Pr=Jt?"bottom":"right",Gn=Sp(xe)[An];Pt[Pr]-Gn<yt[Dn]&&(Ie.offsets.popper[Dn]-=yt[Dn]-(Pt[Pr]-Gn)),Pt[Dn]+Gn>yt[Pr]&&(Ie.offsets.popper[Dn]+=Pt[Dn]+Gn-yt[Pr]),Ie.offsets.popper=lc(Ie.offsets.popper);var Zi=Pt[Dn]+Pt[An]/2-Gn/2,Bl=Qa(Ie.instance.popper),Nl=parseFloat(Bl["margin"+Wn]),ns=parseFloat(Bl["border"+Wn+"Width"]),ln=Zi-Ie.offsets.popper[Dn]-Nl-ns;return ln=Math.max(Math.min(yt[An]-Gn,ln),0),Ie.arrowElement=xe,Ie.offsets.arrow=(_u(De={},Dn,Math.round(ln)),_u(De,cr,""),De),Ie},element:"[x-arrow]"},flip:{order:600,enabled:!0,fn:function Lr(Ie,je){if(cc(Ie.instance.modifiers,"inner")||Ie.flipped&&Ie.placement===Ie.originalPlacement)return Ie;var De=xl(Ie.instance.popper,Ie.instance.reference,je.padding,je.boundariesElement,Ie.positionFixed),xe=Ie.placement.split("-")[0],Ue=Ep(xe),Xe=Ie.placement.split("-")[1]||"",yt=[];switch(je.behavior){case"flip":yt=[xe,Ue];break;case"clockwise":yt=na(xe);break;case"counterclockwise":yt=na(xe,!0);break;default:yt=je.behavior}return yt.forEach(function(Pt,Jt){if(xe!==Pt||yt.length===Jt+1)return Ie;xe=Ie.placement.split("-")[0],Ue=Ep(xe);var An=Ie.offsets.popper,Wn=Ie.offsets.reference,Dn=Math.floor,cr="left"===xe&&Dn(An.right)>Dn(Wn.left)||"right"===xe&&Dn(An.left)<Dn(Wn.right)||"top"===xe&&Dn(An.bottom)>Dn(Wn.top)||"bottom"===xe&&Dn(An.top)<Dn(Wn.bottom),Pr=Dn(An.left)<Dn(De.left),Gn=Dn(An.right)>Dn(De.right),Zi=Dn(An.top)<Dn(De.top),Bl=Dn(An.bottom)>Dn(De.bottom),Nl="left"===xe&&Pr||"right"===xe&&Gn||"top"===xe&&Zi||"bottom"===xe&&Bl,ns=-1!==["top","bottom"].indexOf(xe),Gd=!!je.flipVariations&&(ns&&"start"===Xe&&Pr||ns&&"end"===Xe&&Gn||!ns&&"start"===Xe&&Zi||!ns&&"end"===Xe&&Bl)||!!je.flipVariationsByContent&&(ns&&"start"===Xe&&Gn||ns&&"end"===Xe&&Pr||!ns&&"start"===Xe&&Bl||!ns&&"end"===Xe&&Zi);(cr||Nl||Gd)&&(Ie.flipped=!0,(cr||Nl)&&(xe=yt[Jt+1]),Gd&&(Xe=function Ar(Ie){return"end"===Ie?"start":"start"===Ie?"end":Ie}(Xe)),Ie.placement=xe+(Xe?"-"+Xe:""),Ie.offsets.popper=Pa({},Ie.offsets.popper,Qi(Ie.instance.popper,Ie.offsets.reference,Ie.placement)),Ie=Uc(Ie.instance.modifiers,Ie,"flip"))}),Ie},behavior:"flip",padding:5,boundariesElement:"viewport",flipVariations:!1,flipVariationsByContent:!1},inner:{order:700,enabled:!1,fn:function ia(Ie){var je=Ie.placement,De=je.split("-")[0],xe=Ie.offsets,Ue=xe.popper,Xe=xe.reference,yt=-1!==["left","right"].indexOf(De),Pt=-1===["top","left"].indexOf(De);return Ue[yt?"left":"top"]=Xe[De]-(Pt?Ue[yt?"width":"height"]:0),Ie.placement=Ep(je),Ie.offsets.popper=lc(Ue),Ie}},hide:{order:800,enabled:!0,fn:function el(Ie){if(!Er(Ie.instance.modifiers,"hide","preventOverflow"))return Ie;var je=Ie.offsets.reference,De=Ka(Ie.instance.modifiers,function(xe){return"preventOverflow"===xe.name}).boundaries;if(je.bottom<De.top||je.left>De.right||je.top>De.bottom||je.right<De.left){if(!0===Ie.hide)return Ie;Ie.hide=!0,Ie.attributes["x-out-of-boundaries"]=""}else{if(!1===Ie.hide)return Ie;Ie.hide=!1,Ie.attributes["x-out-of-boundaries"]=!1}return Ie}},computeStyle:{order:850,enabled:!0,fn:function xn(Ie,je){var De=je.x,xe=je.y,Ue=Ie.offsets.popper,Xe=Ka(Ie.instance.modifiers,function(ln){return"applyStyle"===ln.name}).gpuAcceleration;void 0!==Xe&&console.warn("WARNING: `gpuAcceleration` option moved to `computeStyle` modifier and will not be supported in future versions of Popper.js!");var Gn,Zi,yt=void 0!==Xe?Xe:je.gpuAcceleration,Pt=Fc(Ie.instance.popper),Jt=zl(Pt),An={position:Ue.position},Wn=function In(Ie,je){var De=Ie.offsets,xe=De.popper,Xe=Math.round,yt=Math.floor,Pt=function(Nl){return Nl},Jt=Xe(De.reference.width),An=Xe(xe.width),Wn=-1!==["left","right"].indexOf(Ie.placement),Dn=-1!==Ie.placement.indexOf("-"),Gn=je?Wn||Dn||Jt%2==An%2?Xe:yt:Pt,Zi=je?Xe:Pt;return{left:Gn(Jt%2==1&&An%2==1&&!Dn&&je?xe.left-1:xe.left),top:Zi(xe.top),bottom:Zi(xe.bottom),right:Gn(xe.right)}}(Ie,window.devicePixelRatio<2||!nn),Dn="bottom"===De?"top":"bottom",cr="right"===xe?"left":"right",Pr=Ju("transform");if(Zi="bottom"===Dn?"HTML"===Pt.nodeName?-Pt.clientHeight+Wn.bottom:-Jt.height+Wn.bottom:Wn.top,Gn="right"===cr?"HTML"===Pt.nodeName?-Pt.clientWidth+Wn.right:-Jt.width+Wn.right:Wn.left,yt&&Pr)An[Pr]="translate3d("+Gn+"px, "+Zi+"px, 0)",An[Dn]=0,An[cr]=0,An.willChange="transform";else{var Nl="right"===cr?-1:1;An[Dn]=Zi*("bottom"===Dn?-1:1),An[cr]=Gn*Nl,An.willChange=Dn+", "+cr}return Ie.attributes=Pa({},{"x-placement":Ie.placement},Ie.attributes),Ie.styles=Pa({},An,Ie.styles),Ie.arrowStyles=Pa({},Ie.offsets.arrow,Ie.arrowStyles),Ie},gpuAcceleration:!0,x:"bottom",y:"right"},applyStyle:{order:900,enabled:!0,fn:function Xt(Ie){return Et(Ie.instance.popper,Ie.styles),function At(Ie,je){Object.keys(je).forEach(function(De){!1!==je[De]?Ie.setAttribute(De,je[De]):Ie.removeAttribute(De)})}(Ie.instance.popper,Ie.attributes),Ie.arrowElement&&Object.keys(Ie.arrowStyles).length&&Et(Ie.arrowElement,Ie.arrowStyles),Ie},onLoad:function fn(Ie,je,De,xe,Ue){var Xe=Xh(Ue,je,Ie,De.positionFixed),yt=Yu(De.placement,Xe,je,Ie,De.modifiers.flip.boundariesElement,De.modifiers.flip.padding);return je.setAttribute("x-placement",yt),Et(je,{position:De.positionFixed?"fixed":"absolute"}),De},gpuAcceleration:void 0}}},rr=function(){function Ie(je,De){var xe=this,Ue=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(function(Ie,je){if(!(Ie instanceof je))throw new TypeError("Cannot call a class as a function")})(this,Ie),this.scheduleUpdate=function(){return requestAnimationFrame(xe.update)},this.update=Za(this.update.bind(this)),this.options=Pa({},Ie.Defaults,Ue),this.state={isDestroyed:!1,isCreated:!1,scrollParents:[]},this.reference=je&&je.jquery?je[0]:je,this.popper=De&&De.jquery?De[0]:De,this.options.modifiers={},Object.keys(Pa({},Ie.Defaults.modifiers,Ue.modifiers)).forEach(function(yt){xe.options.modifiers[yt]=Pa({},Ie.Defaults.modifiers[yt]||{},Ue.modifiers?Ue.modifiers[yt]:{})}),this.modifiers=Object.keys(this.options.modifiers).map(function(yt){return Pa({name:yt},xe.options.modifiers[yt])}).sort(function(yt,Pt){return yt.order-Pt.order}),this.modifiers.forEach(function(yt){yt.enabled&&Hh(yt.onLoad)&&yt.onLoad(xe.reference,xe.popper,xe.options,yt,xe.state)}),this.update();var Xe=this.options.eventsEnabled;Xe&&this.enableEventListeners(),this.state.eventsEnabled=Xe}return Kp(Ie,[{key:"update",value:function(){return Yh.call(this)}},{key:"destroy",value:function(){return gu.call(this)}},{key:"enableEventListeners",value:function(){return Le.call(this)}},{key:"disableEventListeners",value:function(){return Ve.call(this)}}]),Ie}();rr.Utils=(typeof window<"u"?window:global).PopperUtils,rr.placements=ms,rr.Defaults=Ps;var wn="dropdown",as="bs.dropdown",Ki="."+as,jr=".data-api",ui=x.default.fn[wn],ot=new RegExp("38|40|27"),wl="hide"+Ki,Ts="hidden"+Ki,Tp="show"+Ki,Ms="shown"+Ki,hc="click"+Ki,Hi="click"+Ki+jr,io="keydown"+Ki+jr,ti="keyup"+Ki+jr,zc="disabled",Li="show",Vi="dropdown-menu-right",Wr='[data-toggle="dropdown"]',bo=".dropdown-menu",Sl={offset:0,flip:!0,boundary:"scrollParent",reference:"toggle",display:"dynamic",popperConfig:null},ka={offset:"(number|string|function)",flip:"boolean",boundary:"(string|element)",reference:"(string|element)",display:"string",popperConfig:"(null|object)"},ya=function(){function Ie(De,xe){this._element=De,this._popper=null,this._config=this._getConfig(xe),this._menu=this._getMenuElement(),this._inNavbar=this._detectNavbar(),this._addEventListeners()}var je=Ie.prototype;return je.toggle=function(){if(!this._element.disabled&&!x.default(this._element).hasClass(zc)){var xe=x.default(this._menu).hasClass(Li);Ie._clearMenus(),!xe&&this.show(!0)}},je.show=function(xe){if(void 0===xe&&(xe=!1),!(this._element.disabled||x.default(this._element).hasClass(zc)||x.default(this._menu).hasClass(Li))){var Ue={relatedTarget:this._element},Xe=x.default.Event(Tp,Ue),yt=Ie._getParentFromElement(this._element);if(x.default(yt).trigger(Xe),!Xe.isDefaultPrevented()){if(!this._inNavbar&&xe){if(typeof rr>"u")throw new TypeError("Bootstrap's dropdowns require Popper.js (https://popper.js.org/)");var Pt=this._element;"parent"===this._config.reference?Pt=yt:le.isElement(this._config.reference)&&(Pt=this._config.reference,typeof this._config.reference.jquery<"u"&&(Pt=this._config.reference[0])),"scrollParent"!==this._config.boundary&&x.default(yt).addClass("position-static"),this._popper=new rr(Pt,this._menu,this._getPopperConfig())}"ontouchstart"in document.documentElement&&0===x.default(yt).closest(".navbar-nav").length&&x.default(document.body).children().on("mouseover",null,x.default.noop),this._element.focus(),this._element.setAttribute("aria-expanded",!0),x.default(this._menu).toggleClass(Li),x.default(yt).toggleClass(Li).trigger(x.default.Event(Ms,Ue))}}},je.hide=function(){if(!this._element.disabled&&!x.default(this._element).hasClass(zc)&&x.default(this._menu).hasClass(Li)){var xe={relatedTarget:this._element},Ue=x.default.Event(wl,xe),Xe=Ie._getParentFromElement(this._element);x.default(Xe).trigger(Ue),!Ue.isDefaultPrevented()&&(this._popper&&this._popper.destroy(),x.default(this._menu).toggleClass(Li),x.default(Xe).toggleClass(Li).trigger(x.default.Event(Ts,xe)))}},je.dispose=function(){x.default.removeData(this._element,as),x.default(this._element).off(Ki),this._element=null,this._menu=null,null!==this._popper&&(this._popper.destroy(),this._popper=null)},je.update=function(){this._inNavbar=this._detectNavbar(),null!==this._popper&&this._popper.scheduleUpdate()},je._addEventListeners=function(){var xe=this;x.default(this._element).on(hc,function(Ue){Ue.preventDefault(),Ue.stopPropagation(),xe.toggle()})},je._getConfig=function(xe){return xe=G({},this.constructor.Default,x.default(this._element).data(),xe),le.typeCheckConfig(wn,xe,this.constructor.DefaultType),xe},je._getMenuElement=function(){if(!this._menu){var xe=Ie._getParentFromElement(this._element);xe&&(this._menu=xe.querySelector(bo))}return this._menu},je._getPlacement=function(){var xe=x.default(this._element.parentNode),Ue="bottom-start";return xe.hasClass("dropup")?Ue=x.default(this._menu).hasClass(Vi)?"top-end":"top-start":xe.hasClass("dropright")?Ue="right-start":xe.hasClass("dropleft")?Ue="left-start":x.default(this._menu).hasClass(Vi)&&(Ue="bottom-end"),Ue},je._detectNavbar=function(){return x.default(this._element).closest(".navbar").length>0},je._getOffset=function(){var xe=this,Ue={};return"function"==typeof this._config.offset?Ue.fn=function(Xe){return Xe.offsets=G({},Xe.offsets,xe._config.offset(Xe.offsets,xe._element)||{}),Xe}:Ue.offset=this._config.offset,Ue},je._getPopperConfig=function(){var xe={placement:this._getPlacement(),modifiers:{offset:this._getOffset(),flip:{enabled:this._config.flip},preventOverflow:{boundariesElement:this._config.boundary}}};return"static"===this._config.display&&(xe.modifiers.applyStyle={enabled:!1}),G({},xe,this._config.popperConfig)},Ie._jQueryInterface=function(xe){return this.each(function(){var Ue=x.default(this).data(as);if(Ue||(Ue=new Ie(this,"object"==typeof xe?xe:null),x.default(this).data(as,Ue)),"string"==typeof xe){if(typeof Ue[xe]>"u")throw new TypeError('No method named "'+xe+'"');Ue[xe]()}})},Ie._clearMenus=function(xe){if(!xe||3!==xe.which&&("keyup"!==xe.type||9===xe.which))for(var Ue=[].slice.call(document.querySelectorAll(Wr)),Xe=0,yt=Ue.length;Xe<yt;Xe++){var Pt=Ie._getParentFromElement(Ue[Xe]),Jt=x.default(Ue[Xe]).data(as),An={relatedTarget:Ue[Xe]};if(xe&&"click"===xe.type&&(An.clickEvent=xe),Jt){var Wn=Jt._menu;if(x.default(Pt).hasClass(Li)&&!(xe&&("click"===xe.type&&/input|textarea/i.test(xe.target.tagName)||"keyup"===xe.type&&9===xe.which)&&x.default.contains(Pt,xe.target))){var Dn=x.default.Event(wl,An);x.default(Pt).trigger(Dn),!Dn.isDefaultPrevented()&&("ontouchstart"in document.documentElement&&x.default(document.body).children().off("mouseover",null,x.default.noop),Ue[Xe].setAttribute("aria-expanded","false"),Jt._popper&&Jt._popper.destroy(),x.default(Wn).removeClass(Li),x.default(Pt).removeClass(Li).trigger(x.default.Event(Ts,An)))}}}},Ie._getParentFromElement=function(xe){var Ue,Xe=le.getSelectorFromElement(xe);return Xe&&(Ue=document.querySelector(Xe)),Ue||xe.parentNode},Ie._dataApiKeydownHandler=function(xe){if(!(/input|textarea/i.test(xe.target.tagName)?32===xe.which||27!==xe.which&&(40!==xe.which&&38!==xe.which||x.default(xe.target).closest(bo).length):!ot.test(xe.which))&&!this.disabled&&!x.default(this).hasClass(zc)){var Ue=Ie._getParentFromElement(this),Xe=x.default(Ue).hasClass(Li);if(Xe||27!==xe.which){if(xe.preventDefault(),xe.stopPropagation(),!Xe||27===xe.which||32===xe.which)return 27===xe.which&&x.default(Ue.querySelector(Wr)).trigger("focus"),void x.default(this).trigger("click");var yt=[].slice.call(Ue.querySelectorAll(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)")).filter(function(Jt){return x.default(Jt).is(":visible")});if(0!==yt.length){var Pt=yt.indexOf(xe.target);38===xe.which&&Pt>0&&Pt--,40===xe.which&&Pt<yt.length-1&&Pt++,Pt<0&&(Pt=0),yt[Pt].focus()}}}},U(Ie,null,[{key:"VERSION",get:function(){return"4.5.3"}},{key:"Default",get:function(){return Sl}},{key:"DefaultType",get:function(){return ka}}]),Ie}();x.default(document).on(io,Wr,ya._dataApiKeydownHandler).on(io,bo,ya._dataApiKeydownHandler).on(Hi+" "+ti,ya._clearMenus).on(Hi,Wr,function(Ie){Ie.preventDefault(),Ie.stopPropagation(),ya._jQueryInterface.call(x.default(this),"toggle")}).on(Hi,".dropdown form",function(Ie){Ie.stopPropagation()}),x.default.fn[wn]=ya._jQueryInterface,x.default.fn[wn].Constructor=ya,x.default.fn[wn].noConflict=function(){return x.default.fn[wn]=ui,ya._jQueryInterface};var Hl="modal",ba="bs.modal",xo="."+ba,mc=x.default.fn[Hl],bt={backdrop:!0,keyboard:!0,focus:!0,show:!0},kt={backdrop:"(boolean|string)",keyboard:"boolean",focus:"boolean",show:"boolean"},vn="hide"+xo,qt="hidePrevented"+xo,_n="hidden"+xo,Qt="show"+xo,Jn="shown"+xo,zn="focusin"+xo,Sr="resize"+xo,$r="click.dismiss"+xo,yr="keydown.dismiss"+xo,qr="mouseup.dismiss"+xo,hi="mousedown.dismiss"+xo,Rr="click"+xo+".data-api",No="modal-open",Vl="fade",Wo="show",Ji="modal-static",Sh=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",bd=".sticky-top",Eh=function(){function Ie(De,xe){this._config=this._getConfig(xe),this._element=De,this._dialog=De.querySelector(".modal-dialog"),this._backdrop=null,this._isShown=!1,this._isBodyOverflowing=!1,this._ignoreBackdropClick=!1,this._isTransitioning=!1,this._scrollbarWidth=0}var je=Ie.prototype;return je.toggle=function(xe){return this._isShown?this.hide():this.show(xe)},je.show=function(xe){var Ue=this;if(!this._isShown&&!this._isTransitioning){x.default(this._element).hasClass(Vl)&&(this._isTransitioning=!0);var Xe=x.default.Event(Qt,{relatedTarget:xe});x.default(this._element).trigger(Xe),!this._isShown&&!Xe.isDefaultPrevented()&&(this._isShown=!0,this._checkScrollbar(),this._setScrollbar(),this._adjustDialog(),this._setEscapeEvent(),this._setResizeEvent(),x.default(this._element).on($r,'[data-dismiss="modal"]',function(yt){return Ue.hide(yt)}),x.default(this._dialog).on(hi,function(){x.default(Ue._element).one(qr,function(yt){x.default(yt.target).is(Ue._element)&&(Ue._ignoreBackdropClick=!0)})}),this._showBackdrop(function(){return Ue._showElement(xe)}))}},je.hide=function(xe){var Ue=this;if(xe&&xe.preventDefault(),this._isShown&&!this._isTransitioning){var Xe=x.default.Event(vn);if(x.default(this._element).trigger(Xe),this._isShown&&!Xe.isDefaultPrevented()){this._isShown=!1;var yt=x.default(this._element).hasClass(Vl);if(yt&&(this._isTransitioning=!0),this._setEscapeEvent(),this._setResizeEvent(),x.default(document).off(zn),x.default(this._element).removeClass(Wo),x.default(this._element).off($r),x.default(this._dialog).off(hi),yt){var Pt=le.getTransitionDurationFromElement(this._element);x.default(this._element).one(le.TRANSITION_END,function(Jt){return Ue._hideModal(Jt)}).emulateTransitionEnd(Pt)}else this._hideModal()}}},je.dispose=function(){[window,this._element,this._dialog].forEach(function(xe){return x.default(xe).off(xo)}),x.default(document).off(zn),x.default.removeData(this._element,ba),this._config=null,this._element=null,this._dialog=null,this._backdrop=null,this._isShown=null,this._isBodyOverflowing=null,this._ignoreBackdropClick=null,this._isTransitioning=null,this._scrollbarWidth=null},je.handleUpdate=function(){this._adjustDialog()},je._getConfig=function(xe){return xe=G({},bt,xe),le.typeCheckConfig(Hl,xe,kt),xe},je._triggerBackdropTransition=function(){var xe=this;if("static"===this._config.backdrop){var Ue=x.default.Event(qt);if(x.default(this._element).trigger(Ue),Ue.isDefaultPrevented())return;var Xe=this._element.scrollHeight>document.documentElement.clientHeight;Xe||(this._element.style.overflowY="hidden"),this._element.classList.add(Ji);var yt=le.getTransitionDurationFromElement(this._dialog);x.default(this._element).off(le.TRANSITION_END),x.default(this._element).one(le.TRANSITION_END,function(){xe._element.classList.remove(Ji),Xe||x.default(xe._element).one(le.TRANSITION_END,function(){xe._element.style.overflowY=""}).emulateTransitionEnd(xe._element,yt)}).emulateTransitionEnd(yt),this._element.focus()}else this.hide()},je._showElement=function(xe){var Ue=this,Xe=x.default(this._element).hasClass(Vl),yt=this._dialog?this._dialog.querySelector(".modal-body"):null;(!this._element.parentNode||this._element.parentNode.nodeType!==Node.ELEMENT_NODE)&&document.body.appendChild(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),x.default(this._dialog).hasClass("modal-dialog-scrollable")&&yt?yt.scrollTop=0:this._element.scrollTop=0,Xe&&le.reflow(this._element),x.default(this._element).addClass(Wo),this._config.focus&&this._enforceFocus();var Pt=x.default.Event(Jn,{relatedTarget:xe}),Jt=function(){Ue._config.focus&&Ue._element.focus(),Ue._isTransitioning=!1,x.default(Ue._element).trigger(Pt)};if(Xe){var An=le.getTransitionDurationFromElement(this._dialog);x.default(this._dialog).one(le.TRANSITION_END,Jt).emulateTransitionEnd(An)}else Jt()},je._enforceFocus=function(){var xe=this;x.default(document).off(zn).on(zn,function(Ue){document!==Ue.target&&xe._element!==Ue.target&&0===x.default(xe._element).has(Ue.target).length&&xe._element.focus()})},je._setEscapeEvent=function(){var xe=this;this._isShown?x.default(this._element).on(yr,function(Ue){xe._config.keyboard&&27===Ue.which?(Ue.preventDefault(),xe.hide()):!xe._config.keyboard&&27===Ue.which&&xe._triggerBackdropTransition()}):this._isShown||x.default(this._element).off(yr)},je._setResizeEvent=function(){var xe=this;this._isShown?x.default(window).on(Sr,function(Ue){return xe.handleUpdate(Ue)}):x.default(window).off(Sr)},je._hideModal=function(){var xe=this;this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._showBackdrop(function(){x.default(document.body).removeClass(No),xe._resetAdjustments(),xe._resetScrollbar(),x.default(xe._element).trigger(_n)})},je._removeBackdrop=function(){this._backdrop&&(x.default(this._backdrop).remove(),this._backdrop=null)},je._showBackdrop=function(xe){var Ue=this,Xe=x.default(this._element).hasClass(Vl)?Vl:"";if(this._isShown&&this._config.backdrop){if(this._backdrop=document.createElement("div"),this._backdrop.className="modal-backdrop",Xe&&this._backdrop.classList.add(Xe),x.default(this._backdrop).appendTo(document.body),x.default(this._element).on($r,function(An){Ue._ignoreBackdropClick?Ue._ignoreBackdropClick=!1:An.target===An.currentTarget&&Ue._triggerBackdropTransition()}),Xe&&le.reflow(this._backdrop),x.default(this._backdrop).addClass(Wo),!xe)return;if(!Xe)return void xe();var yt=le.getTransitionDurationFromElement(this._backdrop);x.default(this._backdrop).one(le.TRANSITION_END,xe).emulateTransitionEnd(yt)}else if(!this._isShown&&this._backdrop){x.default(this._backdrop).removeClass(Wo);var Pt=function(){Ue._removeBackdrop(),xe&&xe()};if(x.default(this._element).hasClass(Vl)){var Jt=le.getTransitionDurationFromElement(this._backdrop);x.default(this._backdrop).one(le.TRANSITION_END,Pt).emulateTransitionEnd(Jt)}else Pt()}else xe&&xe()},je._adjustDialog=function(){var xe=this._element.scrollHeight>document.documentElement.clientHeight;!this._isBodyOverflowing&&xe&&(this._element.style.paddingLeft=this._scrollbarWidth+"px"),this._isBodyOverflowing&&!xe&&(this._element.style.paddingRight=this._scrollbarWidth+"px")},je._resetAdjustments=function(){this._element.style.paddingLeft="",this._element.style.paddingRight=""},je._checkScrollbar=function(){var xe=document.body.getBoundingClientRect();this._isBodyOverflowing=Math.round(xe.left+xe.right)<window.innerWidth,this._scrollbarWidth=this._getScrollbarWidth()},je._setScrollbar=function(){var xe=this;if(this._isBodyOverflowing){var Ue=[].slice.call(document.querySelectorAll(Sh)),Xe=[].slice.call(document.querySelectorAll(bd));x.default(Ue).each(function(Jt,An){var Wn=An.style.paddingRight,Dn=x.default(An).css("padding-right");x.default(An).data("padding-right",Wn).css("padding-right",parseFloat(Dn)+xe._scrollbarWidth+"px")}),x.default(Xe).each(function(Jt,An){var Wn=An.style.marginRight,Dn=x.default(An).css("margin-right");x.default(An).data("margin-right",Wn).css("margin-right",parseFloat(Dn)-xe._scrollbarWidth+"px")});var yt=document.body.style.paddingRight,Pt=x.default(document.body).css("padding-right");x.default(document.body).data("padding-right",yt).css("padding-right",parseFloat(Pt)+this._scrollbarWidth+"px")}x.default(document.body).addClass(No)},je._resetScrollbar=function(){var xe=[].slice.call(document.querySelectorAll(Sh));x.default(xe).each(function(yt,Pt){var Jt=x.default(Pt).data("padding-right");x.default(Pt).removeData("padding-right"),Pt.style.paddingRight=Jt||""});var Ue=[].slice.call(document.querySelectorAll(""+bd));x.default(Ue).each(function(yt,Pt){var Jt=x.default(Pt).data("margin-right");typeof Jt<"u"&&x.default(Pt).css("margin-right",Jt).removeData("margin-right")});var Xe=x.default(document.body).data("padding-right");x.default(document.body).removeData("padding-right"),document.body.style.paddingRight=Xe||""},je._getScrollbarWidth=function(){var xe=document.createElement("div");xe.className="modal-scrollbar-measure",document.body.appendChild(xe);var Ue=xe.getBoundingClientRect().width-xe.clientWidth;return document.body.removeChild(xe),Ue},Ie._jQueryInterface=function(xe,Ue){return this.each(function(){var Xe=x.default(this).data(ba),yt=G({},bt,x.default(this).data(),"object"==typeof xe&&xe?xe:{});if(Xe||(Xe=new Ie(this,yt),x.default(this).data(ba,Xe)),"string"==typeof xe){if(typeof Xe[xe]>"u")throw new TypeError('No method named "'+xe+'"');Xe[xe](Ue)}else yt.show&&Xe.show(Ue)})},U(Ie,null,[{key:"VERSION",get:function(){return"4.5.3"}},{key:"Default",get:function(){return bt}}]),Ie}();x.default(document).on(Rr,'[data-toggle="modal"]',function(Ie){var De,je=this,xe=le.getSelectorFromElement(this);xe&&(De=document.querySelector(xe));var Ue=x.default(De).data(ba)?"toggle":G({},x.default(De).data(),x.default(this).data());("A"===this.tagName||"AREA"===this.tagName)&&Ie.preventDefault();var Xe=x.default(De).one(Qt,function(yt){yt.isDefaultPrevented()||Xe.one(_n,function(){x.default(je).is(":visible")&&je.focus()})});Eh._jQueryInterface.call(x.default(De),Ue,this)}),x.default.fn[Hl]=Eh._jQueryInterface,x.default.fn[Hl].Constructor=Eh,x.default.fn[Hl].noConflict=function(){return x.default.fn[Hl]=mc,Eh._jQueryInterface};var zd=["background","cite","href","itemtype","longdesc","poster","src","xlink:href"],vc=/^(?:(?:https?|mailto|ftp|tel|file):|[^#&/:?]*(?:[#/?]|$))/gi,Xs=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[\d+/a-z]+=*$/i;function lr(Ie,je,De){if(0===Ie.length)return Ie;if(De&&"function"==typeof De)return De(Ie);for(var Ue=(new window.DOMParser).parseFromString(Ie,"text/html"),Xe=Object.keys(je),yt=[].slice.call(Ue.body.querySelectorAll("*")),Pt=function(cr,Pr){var Gn=yt[cr],Zi=Gn.nodeName.toLowerCase();if(-1===Xe.indexOf(Gn.nodeName.toLowerCase()))return Gn.parentNode.removeChild(Gn),"continue";var Bl=[].slice.call(Gn.attributes),Nl=[].concat(je["*"]||[],je[Zi]||[]);Bl.forEach(function(ns){(function $p(Ie,je){var De=Ie.nodeName.toLowerCase();if(-1!==je.indexOf(De))return-1===zd.indexOf(De)||!(!Ie.nodeValue.match(vc)&&!Ie.nodeValue.match(Xs));for(var xe=je.filter(function(yt){return yt instanceof RegExp}),Ue=0,Xe=xe.length;Ue<Xe;Ue++)if(De.match(xe[Ue]))return!0;return!1})(ns,Nl)||Gn.removeAttribute(ns.nodeName)})},Jt=0,An=yt.length;Jt<An;Jt++)Pt(Jt);return Ue.body.innerHTML}var El="tooltip",Kh="bs.tooltip",sa="."+Kh,wd=x.default.fn[El],Ur="bs-tooltip",eo=new RegExp("(^|\\s)"+Ur+"\\S+","g"),Ro=["sanitize","whiteList","sanitizeFn"],As={animation:"boolean",template:"string",title:"(string|element|function)",trigger:"string",delay:"(number|object)",html:"boolean",selector:"(string|boolean)",placement:"(string|function)",offset:"(number|string|function)",container:"(string|element|boolean)",fallbackPlacement:"(string|array)",boundary:"(string|element)",sanitize:"boolean",sanitizeFn:"(null|function)",whiteList:"object",popperConfig:"(null|object)"},Gr={AUTO:"auto",TOP:"top",RIGHT:"right",BOTTOM:"bottom",LEFT:"left"},tl={animation:!0,template:'<div class="tooltip" role="tooltip"><div class="arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,selector:!1,placement:"top",offset:0,container:!1,fallbackPlacement:"flip",boundary:"scrollParent",sanitize:!0,sanitizeFn:null,whiteList:{"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},popperConfig:null},yc="show",ep={HIDE:"hide"+sa,HIDDEN:"hidden"+sa,SHOW:"show"+sa,SHOWN:"shown"+sa,INSERTED:"inserted"+sa,CLICK:"click"+sa,FOCUSIN:"focusin"+sa,FOCUSOUT:"focusout"+sa,MOUSEENTER:"mouseenter"+sa,MOUSELEAVE:"mouseleave"+sa},Tl="fade",tr="show",Ml="hover",zi="focus",xa=function(){function Ie(De,xe){if(typeof rr>"u")throw new TypeError("Bootstrap's tooltips require Popper.js (https://popper.js.org/)");this._isEnabled=!0,this._timeout=0,this._hoverState="",this._activeTrigger={},this._popper=null,this.element=De,this.config=this._getConfig(xe),this.tip=null,this._setListeners()}var je=Ie.prototype;return je.enable=function(){this._isEnabled=!0},je.disable=function(){this._isEnabled=!1},je.toggleEnabled=function(){this._isEnabled=!this._isEnabled},je.toggle=function(xe){if(this._isEnabled)if(xe){var Ue=this.constructor.DATA_KEY,Xe=x.default(xe.currentTarget).data(Ue);Xe||(Xe=new this.constructor(xe.currentTarget,this._getDelegateConfig()),x.default(xe.currentTarget).data(Ue,Xe)),Xe._activeTrigger.click=!Xe._activeTrigger.click,Xe._isWithActiveTrigger()?Xe._enter(null,Xe):Xe._leave(null,Xe)}else{if(x.default(this.getTipElement()).hasClass(tr))return void this._leave(null,this);this._enter(null,this)}},je.dispose=function(){clearTimeout(this._timeout),x.default.removeData(this.element,this.constructor.DATA_KEY),x.default(this.element).off(this.constructor.EVENT_KEY),x.default(this.element).closest(".modal").off("hide.bs.modal",this._hideModalHandler),this.tip&&x.default(this.tip).remove(),this._isEnabled=null,this._timeout=null,this._hoverState=null,this._activeTrigger=null,this._popper&&this._popper.destroy(),this._popper=null,this.element=null,this.config=null,this.tip=null},je.show=function(){var xe=this;if("none"===x.default(this.element).css("display"))throw new Error("Please use show on visible elements");var Ue=x.default.Event(this.constructor.Event.SHOW);if(this.isWithContent()&&this._isEnabled){x.default(this.element).trigger(Ue);var Xe=le.findShadowRoot(this.element),yt=x.default.contains(null!==Xe?Xe:this.element.ownerDocument.documentElement,this.element);if(Ue.isDefaultPrevented()||!yt)return;var Pt=this.getTipElement(),Jt=le.getUID(this.constructor.NAME);Pt.setAttribute("id",Jt),this.element.setAttribute("aria-describedby",Jt),this.setContent(),this.config.animation&&x.default(Pt).addClass(Tl);var An="function"==typeof this.config.placement?this.config.placement.call(this,Pt,this.element):this.config.placement,Wn=this._getAttachment(An);this.addAttachmentClass(Wn);var Dn=this._getContainer();x.default(Pt).data(this.constructor.DATA_KEY,this),x.default.contains(this.element.ownerDocument.documentElement,this.tip)||x.default(Pt).appendTo(Dn),x.default(this.element).trigger(this.constructor.Event.INSERTED),this._popper=new rr(this.element,Pt,this._getPopperConfig(Wn)),x.default(Pt).addClass(tr),"ontouchstart"in document.documentElement&&x.default(document.body).children().on("mouseover",null,x.default.noop);var cr=function(){xe.config.animation&&xe._fixTransition();var Zi=xe._hoverState;xe._hoverState=null,x.default(xe.element).trigger(xe.constructor.Event.SHOWN),"out"===Zi&&xe._leave(null,xe)};if(x.default(this.tip).hasClass(Tl)){var Pr=le.getTransitionDurationFromElement(this.tip);x.default(this.tip).one(le.TRANSITION_END,cr).emulateTransitionEnd(Pr)}else cr()}},je.hide=function(xe){var Ue=this,Xe=this.getTipElement(),yt=x.default.Event(this.constructor.Event.HIDE),Pt=function(){Ue._hoverState!==yc&&Xe.parentNode&&Xe.parentNode.removeChild(Xe),Ue._cleanTipClass(),Ue.element.removeAttribute("aria-describedby"),x.default(Ue.element).trigger(Ue.constructor.Event.HIDDEN),null!==Ue._popper&&Ue._popper.destroy(),xe&&xe()};if(x.default(this.element).trigger(yt),!yt.isDefaultPrevented()){if(x.default(Xe).removeClass(tr),"ontouchstart"in document.documentElement&&x.default(document.body).children().off("mouseover",null,x.default.noop),this._activeTrigger.click=!1,this._activeTrigger[zi]=!1,this._activeTrigger[Ml]=!1,x.default(this.tip).hasClass(Tl)){var Jt=le.getTransitionDurationFromElement(Xe);x.default(Xe).one(le.TRANSITION_END,Pt).emulateTransitionEnd(Jt)}else Pt();this._hoverState=""}},je.update=function(){null!==this._popper&&this._popper.scheduleUpdate()},je.isWithContent=function(){return!!this.getTitle()},je.addAttachmentClass=function(xe){x.default(this.getTipElement()).addClass(Ur+"-"+xe)},je.getTipElement=function(){return this.tip=this.tip||x.default(this.config.template)[0],this.tip},je.setContent=function(){var xe=this.getTipElement();this.setElementContent(x.default(xe.querySelectorAll(".tooltip-inner")),this.getTitle()),x.default(xe).removeClass(Tl+" "+tr)},je.setElementContent=function(xe,Ue){"object"!=typeof Ue||!Ue.nodeType&&!Ue.jquery?this.config.html?(this.config.sanitize&&(Ue=lr(Ue,this.config.whiteList,this.config.sanitizeFn)),xe.html(Ue)):xe.text(Ue):this.config.html?x.default(Ue).parent().is(xe)||xe.empty().append(Ue):xe.text(x.default(Ue).text())},je.getTitle=function(){var xe=this.element.getAttribute("data-original-title");return xe||(xe="function"==typeof this.config.title?this.config.title.call(this.element):this.config.title),xe},je._getPopperConfig=function(xe){var Ue=this;return G({},{placement:xe,modifiers:{offset:this._getOffset(),flip:{behavior:this.config.fallbackPlacement},arrow:{element:".arrow"},preventOverflow:{boundariesElement:this.config.boundary}},onCreate:function(Pt){Pt.originalPlacement!==Pt.placement&&Ue._handlePopperPlacementChange(Pt)},onUpdate:function(Pt){return Ue._handlePopperPlacementChange(Pt)}},this.config.popperConfig)},je._getOffset=function(){var xe=this,Ue={};return"function"==typeof this.config.offset?Ue.fn=function(Xe){return Xe.offsets=G({},Xe.offsets,xe.config.offset(Xe.offsets,xe.element)||{}),Xe}:Ue.offset=this.config.offset,Ue},je._getContainer=function(){return!1===this.config.container?document.body:le.isElement(this.config.container)?x.default(this.config.container):x.default(document).find(this.config.container)},je._getAttachment=function(xe){return Gr[xe.toUpperCase()]},je._setListeners=function(){var xe=this;this.config.trigger.split(" ").forEach(function(Xe){if("click"===Xe)x.default(xe.element).on(xe.constructor.Event.CLICK,xe.config.selector,function(Jt){return xe.toggle(Jt)});else if("manual"!==Xe){var yt=Xe===Ml?xe.constructor.Event.MOUSEENTER:xe.constructor.Event.FOCUSIN,Pt=Xe===Ml?xe.constructor.Event.MOUSELEAVE:xe.constructor.Event.FOCUSOUT;x.default(xe.element).on(yt,xe.config.selector,function(Jt){return xe._enter(Jt)}).on(Pt,xe.config.selector,function(Jt){return xe._leave(Jt)})}}),this._hideModalHandler=function(){xe.element&&xe.hide()},x.default(this.element).closest(".modal").on("hide.bs.modal",this._hideModalHandler),this.config.selector?this.config=G({},this.config,{trigger:"manual",selector:""}):this._fixTitle()},je._fixTitle=function(){var xe=typeof this.element.getAttribute("data-original-title");(this.element.getAttribute("title")||"string"!==xe)&&(this.element.setAttribute("data-original-title",this.element.getAttribute("title")||""),this.element.setAttribute("title",""))},je._enter=function(xe,Ue){var Xe=this.constructor.DATA_KEY;(Ue=Ue||x.default(xe.currentTarget).data(Xe))||(Ue=new this.constructor(xe.currentTarget,this._getDelegateConfig()),x.default(xe.currentTarget).data(Xe,Ue)),xe&&(Ue._activeTrigger["focusin"===xe.type?zi:Ml]=!0),x.default(Ue.getTipElement()).hasClass(tr)||Ue._hoverState===yc?Ue._hoverState=yc:(clearTimeout(Ue._timeout),Ue._hoverState=yc,Ue.config.delay&&Ue.config.delay.show?Ue._timeout=setTimeout(function(){Ue._hoverState===yc&&Ue.show()},Ue.config.delay.show):Ue.show())},je._leave=function(xe,Ue){var Xe=this.constructor.DATA_KEY;if((Ue=Ue||x.default(xe.currentTarget).data(Xe))||(Ue=new this.constructor(xe.currentTarget,this._getDelegateConfig()),x.default(xe.currentTarget).data(Xe,Ue)),xe&&(Ue._activeTrigger["focusout"===xe.type?zi:Ml]=!1),!Ue._isWithActiveTrigger()){if(clearTimeout(Ue._timeout),Ue._hoverState="out",!Ue.config.delay||!Ue.config.delay.hide)return void Ue.hide();Ue._timeout=setTimeout(function(){"out"===Ue._hoverState&&Ue.hide()},Ue.config.delay.hide)}},je._isWithActiveTrigger=function(){for(var xe in this._activeTrigger)if(this._activeTrigger[xe])return!0;return!1},je._getConfig=function(xe){var Ue=x.default(this.element).data();return Object.keys(Ue).forEach(function(Xe){-1!==Ro.indexOf(Xe)&&delete Ue[Xe]}),"number"==typeof(xe=G({},this.constructor.Default,Ue,"object"==typeof xe&&xe?xe:{})).delay&&(xe.delay={show:xe.delay,hide:xe.delay}),"number"==typeof xe.title&&(xe.title=xe.title.toString()),"number"==typeof xe.content&&(xe.content=xe.content.toString()),le.typeCheckConfig(El,xe,this.constructor.DefaultType),xe.sanitize&&(xe.template=lr(xe.template,xe.whiteList,xe.sanitizeFn)),xe},je._getDelegateConfig=function(){var xe={};if(this.config)for(var Ue in this.config)this.constructor.Default[Ue]!==this.config[Ue]&&(xe[Ue]=this.config[Ue]);return xe},je._cleanTipClass=function(){var xe=x.default(this.getTipElement()),Ue=xe.attr("class").match(eo);null!==Ue&&Ue.length&&xe.removeClass(Ue.join(""))},je._handlePopperPlacementChange=function(xe){this.tip=xe.instance.popper,this._cleanTipClass(),this.addAttachmentClass(this._getAttachment(xe.placement))},je._fixTransition=function(){var xe=this.getTipElement(),Ue=this.config.animation;null===xe.getAttribute("x-placement")&&(x.default(xe).removeClass(Tl),this.config.animation=!1,this.hide(),this.show(),this.config.animation=Ue)},Ie._jQueryInterface=function(xe){return this.each(function(){var Ue=x.default(this),Xe=Ue.data(Kh),yt="object"==typeof xe&&xe;if((Xe||!/dispose|hide/.test(xe))&&(Xe||(Xe=new Ie(this,yt),Ue.data(Kh,Xe)),"string"==typeof xe)){if(typeof Xe[xe]>"u")throw new TypeError('No method named "'+xe+'"');Xe[xe]()}})},U(Ie,null,[{key:"VERSION",get:function(){return"4.5.3"}},{key:"Default",get:function(){return tl}},{key:"NAME",get:function(){return El}},{key:"DATA_KEY",get:function(){return Kh}},{key:"Event",get:function(){return ep}},{key:"EVENT_KEY",get:function(){return sa}},{key:"DefaultType",get:function(){return As}}]),Ie}();x.default.fn[El]=xa._jQueryInterface,x.default.fn[El].Constructor=xa,x.default.fn[El].noConflict=function(){return x.default.fn[El]=wd,xa._jQueryInterface};var Ku="popover",wa="bs.popover",oi="."+wa,Yr=x.default.fn[Ku],dn="bs-popover",Gc=new RegExp("(^|\\s)"+dn+"\\S+","g"),ai=G({},xa.Default,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>'}),aa=G({},xa.DefaultType,{content:"(string|element|function)"}),vs={HIDE:"hide"+oi,HIDDEN:"hidden"+oi,SHOW:"show"+oi,SHOWN:"shown"+oi,INSERTED:"inserted"+oi,CLICK:"click"+oi,FOCUSIN:"focusin"+oi,FOCUSOUT:"focusout"+oi,MOUSEENTER:"mouseenter"+oi,MOUSELEAVE:"mouseleave"+oi},$s=function(Ie){function je(){return Ie.apply(this,arguments)||this}!function A(Ie,je){Ie.prototype=Object.create(je.prototype),Ie.prototype.constructor=Ie,Ie.__proto__=je}(je,Ie);var De=je.prototype;return De.isWithContent=function(){return this.getTitle()||this._getContent()},De.addAttachmentClass=function(Ue){x.default(this.getTipElement()).addClass(dn+"-"+Ue)},De.getTipElement=function(){return this.tip=this.tip||x.default(this.config.template)[0],this.tip},De.setContent=function(){var Ue=x.default(this.getTipElement());this.setElementContent(Ue.find(".popover-header"),this.getTitle());var Xe=this._getContent();"function"==typeof Xe&&(Xe=Xe.call(this.element)),this.setElementContent(Ue.find(".popover-body"),Xe),Ue.removeClass("fade show")},De._getContent=function(){return this.element.getAttribute("data-content")||this.config.content},De._cleanTipClass=function(){var Ue=x.default(this.getTipElement()),Xe=Ue.attr("class").match(Gc);null!==Xe&&Xe.length>0&&Ue.removeClass(Xe.join(""))},je._jQueryInterface=function(Ue){return this.each(function(){var Xe=x.default(this).data(wa),yt="object"==typeof Ue?Ue:null;if((Xe||!/dispose|hide/.test(Ue))&&(Xe||(Xe=new je(this,yt),x.default(this).data(wa,Xe)),"string"==typeof Ue)){if(typeof Xe[Ue]>"u")throw new TypeError('No method named "'+Ue+'"');Xe[Ue]()}})},U(je,null,[{key:"VERSION",get:function(){return"4.5.3"}},{key:"Default",get:function(){return ai}},{key:"NAME",get:function(){return Ku}},{key:"DATA_KEY",get:function(){return wa}},{key:"Event",get:function(){return vs}},{key:"EVENT_KEY",get:function(){return oi}},{key:"DefaultType",get:function(){return aa}}]),je}(xa);x.default.fn[Ku]=$s._jQueryInterface,x.default.fn[Ku].Constructor=$s,x.default.fn[Ku].noConflict=function(){return x.default.fn[Ku]=Yr,$s._jQueryInterface};var ni="scrollspy",br="bs.scrollspy",rl="."+br,th=x.default.fn[ni],Da={offset:10,method:"auto",target:""},ts={offset:"number",method:"string",target:"(string|element)"},Bi="activate"+rl,tp="scroll"+rl,Mh="load"+rl+".data-api",fr="active",il=".nav, .list-group",Fr=".nav-link",nh=".list-group-item",Wl="position",uo=function(){function Ie(De,xe){var Ue=this;this._element=De,this._scrollElement="BODY"===De.tagName?window:De,this._config=this._getConfig(xe),this._selector=this._config.target+" "+Fr+","+this._config.target+" "+nh+","+this._config.target+" .dropdown-item",this._offsets=[],this._targets=[],this._activeTarget=null,this._scrollHeight=0,x.default(this._scrollElement).on(tp,function(Xe){return Ue._process(Xe)}),this.refresh(),this._process()}var je=Ie.prototype;return je.refresh=function(){var xe=this,Xe="auto"===this._config.method?this._scrollElement===this._scrollElement.window?"offset":Wl:this._config.method,yt=Xe===Wl?this._getScrollTop():0;this._offsets=[],this._targets=[],this._scrollHeight=this._getScrollHeight(),[].slice.call(document.querySelectorAll(this._selector)).map(function(Jt){var An,Wn=le.getSelectorFromElement(Jt);if(Wn&&(An=document.querySelector(Wn)),An){var Dn=An.getBoundingClientRect();if(Dn.width||Dn.height)return[x.default(An)[Xe]().top+yt,Wn]}return null}).filter(function(Jt){return Jt}).sort(function(Jt,An){return Jt[0]-An[0]}).forEach(function(Jt){xe._offsets.push(Jt[0]),xe._targets.push(Jt[1])})},je.dispose=function(){x.default.removeData(this._element,br),x.default(this._scrollElement).off(rl),this._element=null,this._scrollElement=null,this._config=null,this._selector=null,this._offsets=null,this._targets=null,this._activeTarget=null,this._scrollHeight=null},je._getConfig=function(xe){if("string"!=typeof(xe=G({},Da,"object"==typeof xe&&xe?xe:{})).target&&le.isElement(xe.target)){var Ue=x.default(xe.target).attr("id");Ue||(Ue=le.getUID(ni),x.default(xe.target).attr("id",Ue)),xe.target="#"+Ue}return le.typeCheckConfig(ni,xe,ts),xe},je._getScrollTop=function(){return this._scrollElement===window?this._scrollElement.pageYOffset:this._scrollElement.scrollTop},je._getScrollHeight=function(){return this._scrollElement.scrollHeight||Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)},je._getOffsetHeight=function(){return this._scrollElement===window?window.innerHeight:this._scrollElement.getBoundingClientRect().height},je._process=function(){var xe=this._getScrollTop()+this._config.offset,Ue=this._getScrollHeight(),Xe=this._config.offset+Ue-this._getOffsetHeight();if(this._scrollHeight!==Ue&&this.refresh(),xe>=Xe){var yt=this._targets[this._targets.length-1];this._activeTarget!==yt&&this._activate(yt)}else{if(this._activeTarget&&xe<this._offsets[0]&&this._offsets[0]>0)return this._activeTarget=null,void this._clear();for(var Pt=this._offsets.length;Pt--;)this._activeTarget!==this._targets[Pt]&&xe>=this._offsets[Pt]&&(typeof this._offsets[Pt+1]>"u"||xe<this._offsets[Pt+1])&&this._activate(this._targets[Pt])}},je._activate=function(xe){this._activeTarget=xe,this._clear();var Ue=this._selector.split(",").map(function(yt){return yt+'[data-target="'+xe+'"],'+yt+'[href="'+xe+'"]'}),Xe=x.default([].slice.call(document.querySelectorAll(Ue.join(","))));Xe.hasClass("dropdown-item")?(Xe.closest(".dropdown").find(".dropdown-toggle").addClass(fr),Xe.addClass(fr)):(Xe.addClass(fr),Xe.parents(il).prev(Fr+", "+nh).addClass(fr),Xe.parents(il).prev(".nav-item").children(Fr).addClass(fr)),x.default(this._scrollElement).trigger(Bi,{relatedTarget:xe})},je._clear=function(){[].slice.call(document.querySelectorAll(this._selector)).filter(function(xe){return xe.classList.contains(fr)}).forEach(function(xe){return xe.classList.remove(fr)})},Ie._jQueryInterface=function(xe){return this.each(function(){var Ue=x.default(this).data(br);if(Ue||(Ue=new Ie(this,"object"==typeof xe&&xe),x.default(this).data(br,Ue)),"string"==typeof xe){if(typeof Ue[xe]>"u")throw new TypeError('No method named "'+xe+'"');Ue[xe]()}})},U(Ie,null,[{key:"VERSION",get:function(){return"4.5.3"}},{key:"Default",get:function(){return Da}}]),Ie}();x.default(window).on(Mh,function(){for(var Ie=[].slice.call(document.querySelectorAll('[data-spy="scroll"]')),De=Ie.length;De--;){var xe=x.default(Ie[De]);uo._jQueryInterface.call(xe,xe.data())}}),x.default.fn[ni]=uo._jQueryInterface,x.default.fn[ni].Constructor=uo,x.default.fn[ni].noConflict=function(){return x.default.fn[ni]=th,uo._jQueryInterface};var Mi="tab",Ns="bs.tab",Al="."+Ns,$l=x.default.fn[Mi],ol="hide"+Al,ql="hidden"+Al,xc="show"+Al,Vc="shown"+Al,pr="click"+Al+".data-api",Sa="active",Su=".active",li="> li > .active",Mo=function(){function Ie(De){this._element=De}var je=Ie.prototype;return je.show=function(){var xe=this;if(!(this._element.parentNode&&this._element.parentNode.nodeType===Node.ELEMENT_NODE&&x.default(this._element).hasClass(Sa)||x.default(this._element).hasClass("disabled"))){var Ue,Xe,yt=x.default(this._element).closest(".nav, .list-group")[0],Pt=le.getSelectorFromElement(this._element);if(yt){var Jt="UL"===yt.nodeName||"OL"===yt.nodeName?li:Su;Xe=(Xe=x.default.makeArray(x.default(yt).find(Jt)))[Xe.length-1]}var An=x.default.Event(ol,{relatedTarget:this._element}),Wn=x.default.Event(xc,{relatedTarget:Xe});if(Xe&&x.default(Xe).trigger(An),x.default(this._element).trigger(Wn),!Wn.isDefaultPrevented()&&!An.isDefaultPrevented()){Pt&&(Ue=document.querySelector(Pt)),this._activate(this._element,yt);var Dn=function(){var Pr=x.default.Event(ql,{relatedTarget:xe._element}),Gn=x.default.Event(Vc,{relatedTarget:Xe});x.default(Xe).trigger(Pr),x.default(xe._element).trigger(Gn)};Ue?this._activate(Ue,Ue.parentNode,Dn):Dn()}}},je.dispose=function(){x.default.removeData(this._element,Ns),this._element=null},je._activate=function(xe,Ue,Xe){var yt=this,Jt=(!Ue||"UL"!==Ue.nodeName&&"OL"!==Ue.nodeName?x.default(Ue).children(Su):x.default(Ue).find(li))[0],An=Xe&&Jt&&x.default(Jt).hasClass("fade"),Wn=function(){return yt._transitionComplete(xe,Jt,Xe)};if(Jt&&An){var Dn=le.getTransitionDurationFromElement(Jt);x.default(Jt).removeClass("show").one(le.TRANSITION_END,Wn).emulateTransitionEnd(Dn)}else Wn()},je._transitionComplete=function(xe,Ue,Xe){if(Ue){x.default(Ue).removeClass(Sa);var yt=x.default(Ue.parentNode).find("> .dropdown-menu .active")[0];yt&&x.default(yt).removeClass(Sa),"tab"===Ue.getAttribute("role")&&Ue.setAttribute("aria-selected",!1)}if(x.default(xe).addClass(Sa),"tab"===xe.getAttribute("role")&&xe.setAttribute("aria-selected",!0),le.reflow(xe),xe.classList.contains("fade")&&xe.classList.add("show"),xe.parentNode&&x.default(xe.parentNode).hasClass("dropdown-menu")){var Pt=x.default(xe).closest(".dropdown")[0];if(Pt){var Jt=[].slice.call(Pt.querySelectorAll(".dropdown-toggle"));x.default(Jt).addClass(Sa)}xe.setAttribute("aria-expanded",!0)}Xe&&Xe()},Ie._jQueryInterface=function(xe){return this.each(function(){var Ue=x.default(this),Xe=Ue.data(Ns);if(Xe||(Xe=new Ie(this),Ue.data(Ns,Xe)),"string"==typeof xe){if(typeof Xe[xe]>"u")throw new TypeError('No method named "'+xe+'"');Xe[xe]()}})},U(Ie,null,[{key:"VERSION",get:function(){return"4.5.3"}}]),Ie}();x.default(document).on(pr,'[data-toggle="tab"], [data-toggle="pill"], [data-toggle="list"]',function(Ie){Ie.preventDefault(),Mo._jQueryInterface.call(x.default(this),"show")}),x.default.fn[Mi]=Mo._jQueryInterface,x.default.fn[Mi].Constructor=Mo,x.default.fn[Mi].noConflict=function(){return x.default.fn[Mi]=$l,Mo._jQueryInterface};var Xn="toast",Eu="bs.toast",sl="."+Eu,Xl=x.default.fn[Xn],Tu="click.dismiss"+sl,ls="hide"+sl,za="hidden"+sl,Mu="show"+sl,Ea="shown"+sl,ip="show",Xc="showing",rh={animation:"boolean",autohide:"boolean",delay:"number"},ll={animation:!0,autohide:!0,delay:500},ys=function(){function Ie(De,xe){this._element=De,this._config=this._getConfig(xe),this._timeout=null,this._setListeners()}var je=Ie.prototype;return je.show=function(){var xe=this,Ue=x.default.Event(Mu);if(x.default(this._element).trigger(Ue),!Ue.isDefaultPrevented()){this._clearTimeout(),this._config.animation&&this._element.classList.add("fade");var Xe=function(){xe._element.classList.remove(Xc),xe._element.classList.add(ip),x.default(xe._element).trigger(Ea),xe._config.autohide&&(xe._timeout=setTimeout(function(){xe.hide()},xe._config.delay))};if(this._element.classList.remove("hide"),le.reflow(this._element),this._element.classList.add(Xc),this._config.animation){var yt=le.getTransitionDurationFromElement(this._element);x.default(this._element).one(le.TRANSITION_END,Xe).emulateTransitionEnd(yt)}else Xe()}},je.hide=function(){if(this._element.classList.contains(ip)){var xe=x.default.Event(ls);x.default(this._element).trigger(xe),!xe.isDefaultPrevented()&&this._close()}},je.dispose=function(){this._clearTimeout(),this._element.classList.contains(ip)&&this._element.classList.remove(ip),x.default(this._element).off(Tu),x.default.removeData(this._element,Eu),this._element=null,this._config=null},je._getConfig=function(xe){return xe=G({},ll,x.default(this._element).data(),"object"==typeof xe&&xe?xe:{}),le.typeCheckConfig(Xn,xe,this.constructor.DefaultType),xe},je._setListeners=function(){var xe=this;x.default(this._element).on(Tu,'[data-dismiss="toast"]',function(){return xe.hide()})},je._close=function(){var xe=this,Ue=function(){xe._element.classList.add("hide"),x.default(xe._element).trigger(za)};if(this._element.classList.remove(ip),this._config.animation){var Xe=le.getTransitionDurationFromElement(this._element);x.default(this._element).one(le.TRANSITION_END,Ue).emulateTransitionEnd(Xe)}else Ue()},je._clearTimeout=function(){clearTimeout(this._timeout),this._timeout=null},Ie._jQueryInterface=function(xe){return this.each(function(){var Ue=x.default(this),Xe=Ue.data(Eu);if(Xe||(Xe=new Ie(this,"object"==typeof xe&&xe),Ue.data(Eu,Xe)),"string"==typeof xe){if(typeof Xe[xe]>"u")throw new TypeError('No method named "'+xe+'"');Xe[xe](this)}})},U(Ie,null,[{key:"VERSION",get:function(){return"4.5.3"}},{key:"DefaultType",get:function(){return rh}},{key:"Default",get:function(){return ll}}]),Ie}();x.default.fn[Xn]=ys._jQueryInterface,x.default.fn[Xn].Constructor=ys,x.default.fn[Xn].noConflict=function(){return x.default.fn[Xn]=Xl,ys._jQueryInterface},n.Alert=Ke,n.Button=Jr,n.Carousel=To,n.Collapse=kc,n.Dropdown=ya,n.Modal=Eh,n.Popover=$s,n.Scrollspy=uo,n.Tab=Mo,n.Toast=ys,n.Tooltip=xa,n.Util=le,Object.defineProperty(n,"__esModule",{value:!0})});